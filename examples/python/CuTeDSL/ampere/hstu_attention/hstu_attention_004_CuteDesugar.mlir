!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_3 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(64,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "(64,64,?):(?{i64 div=8},1,64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_11 = !cute.memref<bf16, gmem, align<16>, "((8,1),1):((1,0),0)">
!memref_gmem_bf16_12 = !cute.memref<bf16, gmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_gmem_bf16_13 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),1,(4,2)):((1,0),0,(16,8))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<32>, "((8,1),1,4):((1,0),0,8)">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<32>, "((8,1),(1,4)):((1,0),(0,8))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<16>, "((8,1),1):((1,0),0)">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4):(((1,32),0),4)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),(4)):(((1,32),0),(4))">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1)):(((1,32),0))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1):((1,2,4),0)">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4)):((1,2),(32,4))">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1,4):(((1,2),4),0,8)">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((1,8),1,8):((0,1),0,8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((1,8),(1,8)):((0,1),(0,8))">
!memref_rmem_bf16_31 = !cute.memref<bf16, rmem, align<16>, "((1,8)):((0,1))">
!memref_rmem_bf16_32 = !cute.memref<bf16, rmem, align<32>, "((8,1),4,2):((1,0),16,8)">
!memref_rmem_bf16_33 = !cute.memref<bf16, rmem, align<32>, "((8,1),(4,2)):((1,0),(16,8))">
!memref_rmem_bf16_34 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_35 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,1):((1,0),1024,0)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),1,((2,2),2)):((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),(2,4),((2,2),2)):((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,4,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),1):((1,0),0)">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<1024>, S<3,4,3>, "((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">
!memref_smem_bf16_25 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">
!memref_smem_bf16_26 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2))):((0,(1,512,8)))">
!memref_smem_bf16_27 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_28 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_29 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1)):((1,0))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    func.func public @kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_) attributes {cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %1 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
      %3 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %4 = cute.static : !copy_ldgsts
      %5 = cute.static : !copy_simt
      %6 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %7 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%7) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
      %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %10 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
      %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %11 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
      %12 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%12) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
      %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %15 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
      %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %16 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%16) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
      %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %19 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
      %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %20 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
      %21 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%21) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
      %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %24 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
      %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %25 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%25) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
      %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %28 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
      %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %29 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
      %30 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%30) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
      %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %33 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
      %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %34 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%34) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
      %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %37 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
      %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %38 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
      %39 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%39) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
      %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
      %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %43 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%43) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %44 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
      %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %45 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
      %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %46 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
      %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %47 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
      %48 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%48) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %49 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
      %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %50 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
      %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %51 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
      %52 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %53 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,8),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,4096))">
      %57 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %58 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_92 = cute.get_leaves(%58) : !cute.int_tuple<"0">
      %59 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %60 = cute.get_shape(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_93, %e1_94, %e2_95, %e3_96 = cute.get_leaves(%60) : !cute.shape<"((8,8),(64,2))">
      %61 = cute.get_stride(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_97, %e1_98, %e2_99, %e3_100 = cute.get_leaves(%61) : !cute.stride<"((64,512),(1,4096))">
      %62 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
      %63 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
      %e0_101 = cute.get_leaves(%63) : !cute.int_tuple<"0">
      %64 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
      %65 = cute.get_shape(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
      %e0_102, %e1_103, %e2_104, %e3_105 = cute.get_leaves(%65) : !cute.shape<"((8,8),(64,1))">
      %66 = cute.get_stride(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
      %e0_106, %e1_107, %e2_108, %e3_109 = cute.get_leaves(%66) : !cute.stride<"((64,512),(1,0))">
      %67 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %68 = cute.composed_get_offset(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_110 = cute.get_leaves(%68) : !cute.int_tuple<"0">
      %69 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %70 = cute.get_shape(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_111, %e1_112, %e2_113, %e3_114 = cute.get_leaves(%70) : !cute.shape<"((8,8),(64,2))">
      %71 = cute.get_stride(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_115, %e1_116, %e2_117, %e3_118 = cute.get_leaves(%71) : !cute.stride<"((64,512),(1,4096))">
      %72 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_119, %e1_120 = cute.get_leaves(%72) : !cute.tile<"[16:1;64:1]">
      %73 = cute.get_shape(%e0_119) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_121 = cute.get_leaves(%73) : !cute.shape<"16">
      %74 = cute.get_stride(%e0_119) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_122 = cute.get_leaves(%74) : !cute.stride<"1">
      %75 = cute.get_shape(%e1_120) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_123 = cute.get_leaves(%75) : !cute.shape<"64">
      %76 = cute.get_stride(%e1_120) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_124 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %78 = cute.get_shape(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_125, %e1_126, %e2_127 = cute.get_leaves(%78) : !cute.shape<"((8,16),8)">
      %79 = cute.get_stride(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_128, %e1_129, %e2_130 = cute.get_leaves(%79) : !cute.stride<"((128,1),16)">
      %80 = cute.static : !cute.layout<"1:0">
      %81 = cute.get_shape(%80) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_131 = cute.get_leaves(%81) : !cute.shape<"1">
      %82 = cute.get_stride(%80) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_132 = cute.get_leaves(%82) : !cute.stride<"0">
      %83 = cute.static : !cute.layout<"(1,8):(0,1)">
      %84 = cute.get_shape(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_133, %e1_134 = cute.get_leaves(%84) : !cute.shape<"(1,8)">
      %85 = cute.get_stride(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_135, %e1_136 = cute.get_leaves(%85) : !cute.stride<"(0,1)">
      %86 = cute.static : !cute.layout<"(1,8):(0,1)">
      %87 = cute.get_shape(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_137, %e1_138 = cute.get_leaves(%87) : !cute.shape<"(1,8)">
      %88 = cute.get_stride(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_139, %e1_140 = cute.get_leaves(%88) : !cute.stride<"(0,1)">
      %89 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_141, %e1_142 = cute.get_leaves(%89) : !cute.tile<"[16:1;64:1]">
      %90 = cute.get_shape(%e0_141) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_143 = cute.get_leaves(%90) : !cute.shape<"16">
      %91 = cute.get_stride(%e0_141) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_144 = cute.get_leaves(%91) : !cute.stride<"1">
      %92 = cute.get_shape(%e1_142) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_145 = cute.get_leaves(%92) : !cute.shape<"64">
      %93 = cute.get_stride(%e1_142) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_146 = cute.get_leaves(%93) : !cute.stride<"1">
      %94 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %95 = cute.get_shape(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_147, %e1_148, %e2_149 = cute.get_leaves(%95) : !cute.shape<"((8,16),8)">
      %96 = cute.get_stride(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_150, %e1_151, %e2_152 = cute.get_leaves(%96) : !cute.stride<"((128,1),16)">
      %97 = cute.static : !cute.layout<"1:0">
      %98 = cute.get_shape(%97) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_153 = cute.get_leaves(%98) : !cute.shape<"1">
      %99 = cute.get_stride(%97) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_154 = cute.get_leaves(%99) : !cute.stride<"0">
      %100 = cute.static : !cute.layout<"(1,8):(0,1)">
      %101 = cute.get_shape(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_155, %e1_156 = cute.get_leaves(%101) : !cute.shape<"(1,8)">
      %102 = cute.get_stride(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_157, %e1_158 = cute.get_leaves(%102) : !cute.stride<"(0,1)">
      %103 = cute.static : !cute.layout<"(1,8):(0,1)">
      %104 = cute.get_shape(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_159, %e1_160 = cute.get_leaves(%104) : !cute.shape<"(1,8)">
      %105 = cute.get_stride(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_161, %e1_162 = cute.get_leaves(%105) : !cute.stride<"(0,1)">
      %106 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %107 = cute.get_shape(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_163, %e1_164, %e2_165, %e3_166 = cute.get_leaves(%107) : !cute.shape<"(32,4,1,1)">
      %108 = cute.get_stride(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%108) : !cute.stride<"(1,32,0,0)">
      %109 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_171, %e1_172, %e2_173 = cute.get_leaves(%109) : !cute.tile<"[64:1;16:1;16:1]">
      %110 = cute.get_shape(%e0_171) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_174 = cute.get_leaves(%110) : !cute.shape<"64">
      %111 = cute.get_stride(%e0_171) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_175 = cute.get_leaves(%111) : !cute.stride<"1">
      %112 = cute.get_shape(%e1_172) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_176 = cute.get_leaves(%112) : !cute.shape<"16">
      %113 = cute.get_stride(%e1_172) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_177 = cute.get_leaves(%113) : !cute.stride<"1">
      %114 = cute.get_shape(%e2_173) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_178 = cute.get_leaves(%114) : !cute.shape<"16">
      %115 = cute.get_stride(%e2_173) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_179 = cute.get_leaves(%115) : !cute.stride<"1">
      %116 = cute.static : !cute.layout<"32:1">
      %117 = cute.get_shape(%116) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_180 = cute.get_leaves(%117) : !cute.shape<"32">
      %118 = cute.get_stride(%116) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_181 = cute.get_leaves(%118) : !cute.stride<"1">
      %119 = cute.static : !cute.shape<"(16,8,16)">
      %e0_182, %e1_183, %e2_184 = cute.get_leaves(%119) : !cute.shape<"(16,8,16)">
      %120 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %121 = cute.get_shape(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_185, %e1_186, %e2_187, %e3_188, %e4 = cute.get_leaves(%121) : !cute.shape<"((4,8),(2,2,2))">
      %122 = cute.get_stride(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_189, %e1_190, %e2_191, %e3_192, %e4_193 = cute.get_leaves(%122) : !cute.stride<"((32,1),(16,8,128))">
      %123 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %124 = cute.get_shape(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_194, %e1_195, %e2_196, %e3_197 = cute.get_leaves(%124) : !cute.shape<"((4,8),(2,2))">
      %125 = cute.get_stride(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_198, %e1_199, %e2_200, %e3_201 = cute.get_leaves(%125) : !cute.stride<"((16,1),(8,64))">
      %126 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %127 = cute.get_shape(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_202, %e1_203, %e2_204, %e3_205 = cute.get_leaves(%127) : !cute.shape<"((4,8),(2,2))">
      %128 = cute.get_stride(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_206, %e1_207, %e2_208, %e3_209 = cute.get_leaves(%128) : !cute.stride<"((32,1),(16,8))">
      %129 = nvvm.read.ptx.sreg.tid.x : i32
      %130 = nvvm.read.ptx.sreg.tid.y : i32
      %131 = nvvm.read.ptx.sreg.tid.z : i32
      %132 = nvvm.read.ptx.sreg.ctaid.x : i32
      %133 = nvvm.read.ptx.sreg.ctaid.y : i32
      %134 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_210 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %135 = cute.get_shape(%lay_210) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_211, %e1_212, %e2_213, %e3_214 = cute.get_leaves(%135) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_215 = cute.to_int_tuple(%e0_211) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %136 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?">
      %itup_216 = cute.to_int_tuple(%e1_212) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %137 = cute.get_scalars(%itup_216) : !cute.int_tuple<"?">
      %itup_217 = cute.to_int_tuple(%e2_213) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %138 = cute.get_scalars(%itup_217) : !cute.int_tuple<"?">
      %itup_218 = cute.to_int_tuple(%e3_214) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %139 = cute.get_scalars(%itup_218) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_216) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %140 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %141 = arith.ceildivsi %140, %c64_i32 : i32
      %int_tuple_219 = cute.make_int_tuple(%141) : (i32) -> !cute.int_tuple<"?">
      %e0_220 = cute.get_leaves(%int_tuple_219) : !cute.int_tuple<"?">
      %142 = cute.get_scalars(%e0_220) : !cute.int_tuple<"?">
      %int_tuple_221 = cute.make_int_tuple(%134) : (i32) -> !cute.int_tuple<"?">
      %sub = cute.tuple_sub(%e0_220, %int_tuple_221) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %143 = cute.get_scalars(%sub) : !cute.int_tuple<"?">
      %int_tuple_222 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_223 = cute.tuple_sub(%sub, %int_tuple_222) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %144 = cute.get_scalars(%sub_223) : !cute.int_tuple<"?">
      %lay_224 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %145 = cute.get_shape(%lay_224) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_225, %e1_226, %e2_227, %e3_228 = cute.get_leaves(%145) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_229 = cute.to_int_tuple(%e0_225) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %146 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?">
      %itup_230 = cute.to_int_tuple(%e1_226) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %147 = cute.get_scalars(%itup_230) : !cute.int_tuple<"?">
      %itup_231 = cute.to_int_tuple(%e2_227) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %148 = cute.get_scalars(%itup_231) : !cute.int_tuple<"?">
      %itup_232 = cute.to_int_tuple(%e3_228) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %149 = cute.get_scalars(%itup_232) : !cute.int_tuple<"?{div=8}">
      %int_tuple_233 = cute.make_int_tuple(%itup_230) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile_234 = cute.make_tile() : () -> !cute.tile<"64:1">
      %150 = cute.get_scalars(%int_tuple_233) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32_235 = arith.constant 64 : i32
      %151 = arith.ceildivsi %150, %c64_i32_235 : i32
      %int_tuple_236 = cute.make_int_tuple(%151) : (i32) -> !cute.int_tuple<"?">
      %e0_237 = cute.get_leaves(%int_tuple_236) : !cute.int_tuple<"?">
      %152 = cute.get_scalars(%e0_237) : !cute.int_tuple<"?">
      %int_tuple_238 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_239 = cute.tuple_sub(%e0_237, %int_tuple_238) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %153 = cute.get_scalars(%sub_239) : !cute.int_tuple<"?">
      %coord = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_240 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %slice = cute.slice(%lay_240, %coord) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx = cute.crd2idx(%coord, %lay_240) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_241 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_241, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %slice) : !memref_gmem_bf16_1
      %iter_242 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_243 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_244 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %154 = cute.get_scalars(%coord_244) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_245 = cute.make_coord(%154) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_246 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %155:3 = cute.get_scalars(%lay_246) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_247 = arith.constant 64 : i32
      %156 = arith.ceildivsi %155#0, %c64_i32_247 : i32
      %c64_i64 = arith.constant 64 : i64
      %157 = arith.muli %155#2, %c64_i64 : i64
      %c128_i32 = arith.constant 128 : i32
      %158 = arith.ceildivsi %155#1, %c128_i32 : i32
      %shape = cute.make_shape(%156, %158) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv = cute.assume(%155#2) : (i64) -> !cute.i64<divby 8>
      %iv_248 = cute.assume(%157) : (i64) -> !cute.i64<divby 512>
      %stride = cute.make_stride(%iv, %iv_248) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_249 = cute.make_layout(%shape, %stride) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_250 = cute.slice(%lay_249, %coord_245) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_251 = cute.crd2idx(%coord_245, %lay_249) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_252 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_253 = cute.add_offset(%iter_252, %idx_251) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_254 = cute.make_view(%ptr_253, %slice_250) : !memref_gmem_bf16_2
      %iter_255 = cute.get_iter(%view_254) : !memref_gmem_bf16_2
      %coord_256 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_257 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %slice_258 = cute.slice(%lay_257, %coord_256) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_259 = cute.crd2idx(%coord_256, %lay_257) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_260 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_261 = cute.add_offset(%iter_260, %idx_259) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_262 = cute.make_view(%ptr_261, %slice_258) : !memref_gmem_bf16_1
      %iter_263 = cute.get_iter(%view_262) : !memref_gmem_bf16_1
      %tile_264 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_265 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_266 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_267 = cute.get_layout(%view_262) : !memref_gmem_bf16_1
      %159:3 = cute.get_scalars(%lay_267) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_268 = arith.constant 64 : i32
      %160 = arith.ceildivsi %159#0, %c64_i32_268 : i32
      %c64_i64_269 = arith.constant 64 : i64
      %161 = arith.muli %159#2, %c64_i64_269 : i64
      %c128_i32_270 = arith.constant 128 : i32
      %162 = arith.ceildivsi %159#1, %c128_i32_270 : i32
      %shape_271 = cute.make_shape(%160, %162) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_272 = cute.assume(%159#2) : (i64) -> !cute.i64<divby 8>
      %iv_273 = cute.assume(%161) : (i64) -> !cute.i64<divby 512>
      %stride_274 = cute.make_stride(%iv_272, %iv_273) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_275 = cute.make_layout(%shape_271, %stride_274) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_276 = cute.slice(%lay_275, %coord_266) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_277 = cute.crd2idx(%coord_266, %lay_275) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_278 = cute.get_iter(%view_262) : !memref_gmem_bf16_1
      %ptr_279 = cute.add_offset(%iter_278, %idx_277) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_280 = cute.make_view(%ptr_279, %slice_276) : !memref_gmem_bf16_3
      %iter_281 = cute.get_iter(%view_280) : !memref_gmem_bf16_3
      %coord_282 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_283 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %slice_284 = cute.slice(%lay_283, %coord_282) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_285 = cute.crd2idx(%coord_282, %lay_283) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_286 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_287 = cute.add_offset(%iter_286, %idx_285) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_288 = cute.make_view(%ptr_287, %slice_284) : !memref_gmem_bf16_1
      %iter_289 = cute.get_iter(%view_288) : !memref_gmem_bf16_1
      %tile_290 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_291 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_292 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_293 = cute.get_layout(%view_288) : !memref_gmem_bf16_1
      %163:3 = cute.get_scalars(%lay_293) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_294 = arith.constant 64 : i32
      %164 = arith.ceildivsi %163#0, %c64_i32_294 : i32
      %c64_i64_295 = arith.constant 64 : i64
      %165 = arith.muli %163#2, %c64_i64_295 : i64
      %c128_i32_296 = arith.constant 128 : i32
      %166 = arith.ceildivsi %163#1, %c128_i32_296 : i32
      %shape_297 = cute.make_shape(%164, %166) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_298 = cute.assume(%163#2) : (i64) -> !cute.i64<divby 8>
      %iv_299 = cute.assume(%165) : (i64) -> !cute.i64<divby 512>
      %stride_300 = cute.make_stride(%iv_298, %iv_299) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_301 = cute.make_layout(%shape_297, %stride_300) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_302 = cute.slice(%lay_301, %coord_292) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_303 = cute.crd2idx(%coord_292, %lay_301) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_304 = cute.get_iter(%view_288) : !memref_gmem_bf16_1
      %ptr_305 = cute.add_offset(%iter_304, %idx_303) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_306 = cute.make_view(%ptr_305, %slice_302) : !memref_gmem_bf16_3
      %iter_307 = cute.get_iter(%view_306) : !memref_gmem_bf16_3
      %coord_308 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_309 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %slice_310 = cute.slice(%lay_309, %coord_308) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,?,_,_)">
      %idx_311 = cute.crd2idx(%coord_308, %lay_309) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_312 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %ptr_313 = cute.add_offset(%iter_312, %idx_311) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_314 = cute.make_view(%ptr_313, %slice_310) : !memref_gmem_bf16_1
      %iter_315 = cute.get_iter(%view_314) : !memref_gmem_bf16_1
      %tile_316 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_317 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %167 = cute.get_scalars(%coord_317) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_318 = cute.make_coord(%167) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_319 = cute.get_layout(%view_314) : !memref_gmem_bf16_1
      %168:3 = cute.get_scalars(%lay_319) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_320 = arith.constant 64 : i32
      %169 = arith.ceildivsi %168#0, %c64_i32_320 : i32
      %c64_i64_321 = arith.constant 64 : i64
      %170 = arith.muli %168#2, %c64_i64_321 : i64
      %c64_i32_322 = arith.constant 64 : i32
      %171 = arith.ceildivsi %168#1, %c64_i32_322 : i32
      %shape_323 = cute.make_shape(%169, %171) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %iv_324 = cute.assume(%168#2) : (i64) -> !cute.i64<divby 8>
      %iv_325 = cute.assume(%170) : (i64) -> !cute.i64<divby 512>
      %stride_326 = cute.make_stride(%iv_324, %iv_325) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},64))">
      %lay_327 = cute.make_layout(%shape_323, %stride_326) : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">
      %slice_328 = cute.slice(%lay_327, %coord_318) : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">, !cute.coord<"((_,_),(?,_))">
      %idx_329 = cute.crd2idx(%coord_318, %lay_327) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_330 = cute.get_iter(%view_314) : !memref_gmem_bf16_1
      %ptr_331 = cute.add_offset(%iter_330, %idx_329) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_332 = cute.make_view(%ptr_331, %slice_328) : !memref_gmem_bf16_4
      %iter_333 = cute.get_iter(%view_332) : !memref_gmem_bf16_4
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_334 = cute.make_int_tuple() : () -> !cute.int_tuple<"57344">
      %ptr_335 = cute.add_offset(%smem_ptr, %int_tuple_334) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"57344">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c57344_i32 = arith.constant 57344 : i32
      %172 = arith.cmpi sge, %smem_size, %c57344_i32 : i32
      cf.assert %172, "Allocation failed: shared memory allocation exceeds available memory set in kernel launch. Allocated bytes: 57344 bytes. Please reduce the allocation or set a larger smem size in kernel launch."
      %int_tuple_336 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_337 = cute.add_offset(%smem_ptr, %int_tuple_336) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_338 = cute.make_int_tuple() : () -> !cute.int_tuple<"16384">
      %ptr_339 = cute.add_offset(%smem_ptr, %int_tuple_338) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"16384">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_340 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_341 = cute.add_offset(%smem_ptr, %int_tuple_340) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_342 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_343 = cute.add_offset(%smem_ptr, %int_tuple_342) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_344 = cute.recast_iter(%ptr_337) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_345 = cute.make_view(%iter_344, %0) : !memref_smem_bf16_
      %iter_346 = cute.get_iter(%view_345) : !memref_smem_bf16_
      %iter_347 = cute.recast_iter(%ptr_339) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_348 = cute.make_view(%iter_347, %1) : !memref_smem_bf16_
      %iter_349 = cute.get_iter(%view_348) : !memref_smem_bf16_
      %iter_350 = cute.recast_iter(%ptr_341) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_351 = cute.make_view(%iter_350, %1) : !memref_smem_bf16_
      %iter_352 = cute.get_iter(%view_351) : !memref_smem_bf16_
      %iter_353 = cute.recast_iter(%ptr_343) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_354 = cute.make_view(%iter_353, %2) : !memref_smem_bf16_1
      %iter_355 = cute.get_iter(%view_354) : !memref_smem_bf16_1
      %shape_356 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_357 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_358 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_359 = cute.get_iter(%view_351) : !memref_smem_bf16_
      %view_360 = cute.make_view(%iter_359) : !memref_smem_bf16_2
      %iter_361 = cute.get_iter(%view_360) : !memref_smem_bf16_2
      %coord_362 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned = cute.tiled.copy.partition_S(%4, %view_254, %coord_362) : (!copy_ldgsts, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_363 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
      %coord_364 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned = cute.tiled.copy.partition_D(%4, %view_345, %coord_364) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_365 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
      %coord_366 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_367 = cute.tiled.copy.partition_S(%4, %view_280, %coord_366) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_6
      %iter_368 = cute.get_iter(%src_partitioned_367) : !memref_gmem_bf16_6
      %coord_369 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_370 = cute.tiled.copy.partition_D(%4, %view_348, %coord_369) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_371 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
      %coord_372 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_373 = cute.tiled.copy.partition_S(%4, %view_306, %coord_372) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_6
      %iter_374 = cute.get_iter(%src_partitioned_373) : !memref_gmem_bf16_6
      %coord_375 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_376 = cute.tiled.copy.partition_D(%4, %view_351, %coord_375) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_377 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
      %coord_378 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_379 = cute.tiled.copy.partition_S(%4, %view_332, %coord_378) : (!copy_ldgsts, !memref_gmem_bf16_4, !cute.coord<"?">) -> !memref_gmem_bf16_7
      %iter_380 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
      %coord_381 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_382 = cute.tiled.copy.partition_D(%4, %view_354, %coord_381) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_383 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
      %coord_384 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %ptn_A = cute.tiled.mma.partition A (%6, %view_345, %coord_384) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_5
      %iter_385 = cute.get_iter(%ptn_A) : !memref_smem_bf16_5
      %frg_A = cute.mma.make_fragment A (%6, %ptn_A) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_5) -> !memref_rmem_bf16_
      %iter_386 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %coord_387 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %ptn_B = cute.tiled.mma.partition B (%6, %view_348, %coord_387) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_6
      %iter_388 = cute.get_iter(%ptn_B) : !memref_smem_bf16_6
      %frg_B = cute.mma.make_fragment B (%6, %ptn_B) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_6) -> !memref_rmem_bf16_1
      %iter_389 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %coord_390 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %ptn_B_391 = cute.tiled.mma.partition B (%6, %view_360, %coord_390) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_7
      %iter_392 = cute.get_iter(%ptn_B_391) : !memref_smem_bf16_7
      %frg_B_393 = cute.mma.make_fragment B (%6, %ptn_B_391) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_7) -> !memref_rmem_bf16_2
      %iter_394 = cute.get_iter(%frg_B_393) : !memref_rmem_bf16_2
      %shape_395 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %173 = cute.tiled.mma.partition_shape C (%6, %shape_395) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(64,128)">) -> !cute.shape<"((2,2),1,16)">
      %e0_396, %e1_397, %e2_398, %e3_399 = cute.get_leaves(%173) : !cute.shape<"((2,2),1,16)">
      %shape_400 = cute.make_shape() : () -> !cute.shape<"((2,2),1,16)">
      %lay_401 = cute.make_layout() : !cute.layout<"((2,2),1,16):((1,2),0,4)">
      %rmem = cute.memref.alloca(%lay_401) : !memref_rmem_f32_
      %iter_402 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_403 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_404 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %sz = cute.size(%lay_404) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"64">
      %e0_405 = cute.get_leaves(%sz) : !cute.int_tuple<"64">
      %lay_406 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %174 = cute.get_shape(%lay_406) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_407, %e1_408, %e2_409, %e3_410 = cute.get_leaves(%174) : !cute.shape<"((2,2),1,16)">
      %int_tuple_411 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %res = cute.tuple.product(%int_tuple_411) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_412 = cute.get_leaves(%res) : !cute.int_tuple<"64">
      %cst = arith.constant 0.000000e+00 : f32
      %175 = vector.splat %cst : vector<64xf32>
      %int_tuple_413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_414 = cute.size(%int_tuple_413) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_415 = cute.get_leaves(%sz_414) : !cute.int_tuple<"64">
      %int_tuple_416 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_417 = cute.size(%int_tuple_416) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_418 = cute.get_leaves(%sz_417) : !cute.int_tuple<"64">
      cute.memref.store_vec %175, %rmem, row_major : !memref_rmem_f32_
      %shape_419 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_420 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_421 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_422 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_423 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %shape_424 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_425 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %176 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %177 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_426, %e1_427, %e2_428 = cute.get_leaves(%177) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_429 = cute.size(%e0_426) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_430 = cute.get_leaves(%sz_429) : !cute.int_tuple<"64">
      %178 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_431, %e1_432, %e2_433 = cute.get_leaves(%178) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_434 = cute.size(%e2_433) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_435 = cute.get_leaves(%sz_434) : !cute.int_tuple<"16">
      %tile_436 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %179 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %180 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %181 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_437, %e1_438, %e2_439 = cute.get_leaves(%181) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_440 = cute.size(%e1_438) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_441 = cute.get_leaves(%sz_440) : !cute.int_tuple<"16">
      %182 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_442, %e1_443, %e2_444 = cute.get_leaves(%182) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_445 = cute.size(%e2_444) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_446 = cute.get_leaves(%sz_445) : !cute.int_tuple<"16">
      %tile_447 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %183 = cute.make_tiled_copy(%atom_421) : !copy_ldsm_4_1
      %184 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %185 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_448, %e1_449, %e2_450 = cute.get_leaves(%185) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_451 = cute.size(%e1_449) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_452 = cute.get_leaves(%sz_451) : !cute.int_tuple<"16">
      %186 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_453, %e1_454, %e2_455 = cute.get_leaves(%186) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_456 = cute.size(%e2_455) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_457 = cute.get_leaves(%sz_456) : !cute.int_tuple<"16">
      %tile_458 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %187 = cute.make_tiled_copy(%atom_423) : !copy_ldsm_4_2
      %188 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %189 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_459, %e1_460, %e2_461 = cute.get_leaves(%189) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_462 = cute.size(%e0_459) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_463 = cute.get_leaves(%sz_462) : !cute.int_tuple<"64">
      %190 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_464, %e1_465, %e2_466 = cute.get_leaves(%190) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_467 = cute.size(%e1_465) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_468 = cute.get_leaves(%sz_467) : !cute.int_tuple<"16">
      %tile_469 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %191 = cute.make_tiled_copy(%atom_425) : !copy_ldsm_4_3
      %coord_470 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_471 = cute.tiled.copy.partition_S(%179, %view_345, %coord_470) : (!copy_ldsm_4_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_8
      %iter_472 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
      %retiled = cute.tiled.copy.retile(%179, %frg_A) : (!copy_ldsm_4_, !memref_rmem_bf16_) -> !memref_rmem_bf16_3
      %iter_473 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %coord_474 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_475 = cute.tiled.copy.partition_S(%183, %view_348, %coord_474) : (!copy_ldsm_4_1, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_9
      %iter_476 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
      %retiled_477 = cute.tiled.copy.retile(%183, %frg_B) : (!copy_ldsm_4_1, !memref_rmem_bf16_1) -> !memref_rmem_bf16_4
      %iter_478 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
      %coord_479 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_480 = cute.tiled.copy.partition_S(%187, %view_360, %coord_479) : (!copy_ldsm_4_2, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_10
      %iter_481 = cute.get_iter(%src_partitioned_480) : !memref_smem_bf16_10
      %retiled_482 = cute.tiled.copy.retile(%187, %frg_B_393) : (!copy_ldsm_4_2, !memref_rmem_bf16_2) -> !memref_rmem_bf16_5
      %iter_483 = cute.get_iter(%retiled_482) : !memref_rmem_bf16_5
      %coord_484 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_485 = cute.tiled.copy.partition_S(%191, %view_354, %coord_484) : (!copy_ldsm_4_3, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_11
      %iter_486 = cute.get_iter(%src_partitioned_485) : !memref_smem_bf16_11
      %lay_487 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %192 = cute.get_shape(%lay_487) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_488, %e1_489, %e2_490, %e3_491 = cute.get_leaves(%192) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_492 = cute.to_int_tuple(%e0_488) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %193 = cute.get_scalars(%itup_492) : !cute.int_tuple<"?">
      %itup_493 = cute.to_int_tuple(%e1_489) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %194 = cute.get_scalars(%itup_493) : !cute.int_tuple<"?">
      %itup_494 = cute.to_int_tuple(%e2_490) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %195 = cute.get_scalars(%itup_494) : !cute.int_tuple<"?">
      %itup_495 = cute.to_int_tuple(%e3_491) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %196 = cute.get_scalars(%itup_495) : !cute.int_tuple<"?{div=8}">
      %shape_496 = cute.make_shape(%itup_492, %itup_493, %itup_494, %itup_495) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %197 = cute.make_identity_tensor(%shape_496) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_497 = cute.get_iter(%197) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_498, %e1_499, %e2_500, %e3_501 = cute.get_leaves(%iter_497) : !cute.int_tuple<"(0,0,0,0)">
      %lay_502 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %198 = cute.get_shape(%lay_502) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_503, %e1_504, %e2_505, %e3_506 = cute.get_leaves(%198) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_507 = cute.to_int_tuple(%e0_503) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %199 = cute.get_scalars(%itup_507) : !cute.int_tuple<"?">
      %itup_508 = cute.to_int_tuple(%e1_504) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %200 = cute.get_scalars(%itup_508) : !cute.int_tuple<"?">
      %itup_509 = cute.to_int_tuple(%e2_505) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %201 = cute.get_scalars(%itup_509) : !cute.int_tuple<"?">
      %itup_510 = cute.to_int_tuple(%e3_506) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %202 = cute.get_scalars(%itup_510) : !cute.int_tuple<"?{div=8}">
      %shape_511 = cute.make_shape(%itup_507, %itup_508, %itup_509, %itup_510) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %203 = cute.make_identity_tensor(%shape_511) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_512 = cute.get_iter(%203) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_513, %e1_514, %e2_515, %e3_516 = cute.get_leaves(%iter_512) : !cute.int_tuple<"(0,0,0,0)">
      %lay_517 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %204 = cute.get_shape(%lay_517) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_518, %e1_519, %e2_520, %e3_521 = cute.get_leaves(%204) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_522 = cute.to_int_tuple(%e0_518) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %205 = cute.get_scalars(%itup_522) : !cute.int_tuple<"?">
      %itup_523 = cute.to_int_tuple(%e1_519) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %206 = cute.get_scalars(%itup_523) : !cute.int_tuple<"?">
      %itup_524 = cute.to_int_tuple(%e2_520) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %207 = cute.get_scalars(%itup_524) : !cute.int_tuple<"?">
      %itup_525 = cute.to_int_tuple(%e3_521) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %208 = cute.get_scalars(%itup_525) : !cute.int_tuple<"?{div=8}">
      %shape_526 = cute.make_shape(%itup_522, %itup_523, %itup_524, %itup_525) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %209 = cute.make_identity_tensor(%shape_526) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_527 = cute.get_iter(%209) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_528, %e1_529, %e2_530, %e3_531 = cute.get_leaves(%iter_527) : !cute.int_tuple<"(0,0,0,0)">
      %coord_532 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_533 = cute.get_layout(%197) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_534 = cute.slice(%lay_533, %coord_532) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_535 = cute.crd2idx(%coord_532, %lay_533) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_536 = cute.get_iter(%197) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_536, %idx_535) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_537 = cute.make_view(%tup, %slice_534) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_538 = cute.get_iter(%view_537) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_539, %e1_540, %e2_541, %e3_542 = cute.get_leaves(%iter_538) : !cute.int_tuple<"(?,0,?,0)">
      %210 = cute.get_scalars(%e0_539) : !cute.int_tuple<"?">
      %211 = cute.get_scalars(%e2_541) : !cute.int_tuple<"?">
      %tile_543 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_544 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %212 = cute.get_scalars(%coord_544) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_545 = cute.make_coord(%212) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_546 = cute.get_layout(%view_537) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %213:2 = cute.get_scalars(%lay_546) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_547 = arith.constant 64 : i32
      %214 = arith.ceildivsi %213#0, %c64_i32_547 : i32
      %c128_i32_548 = arith.constant 128 : i32
      %215 = arith.ceildivsi %213#1, %c128_i32_548 : i32
      %shape_549 = cute.make_shape(%214, %215) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_550 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_551 = cute.make_layout(%shape_549, %stride_550) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_552 = cute.crd2idx(%coord_545, %lay_551) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_553 = cute.get_iter(%view_537) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_554 = cute.add_offset(%iter_553, %idx_552) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_555 = cute.make_view(%tup_554) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_556 = cute.get_iter(%view_555) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_557, %e1_558, %e2_559, %e3_560 = cute.get_leaves(%iter_556) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %216 = cute.get_scalars(%e0_557) : !cute.int_tuple<"?">
      %217 = cute.get_scalars(%e1_558) : !cute.int_tuple<"?{div=64}">
      %218 = cute.get_scalars(%e2_559) : !cute.int_tuple<"?">
      %coord_561 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_562 = cute.get_layout(%203) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_563 = cute.slice(%lay_562, %coord_561) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_564 = cute.crd2idx(%coord_561, %lay_562) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_565 = cute.get_iter(%203) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_566 = cute.add_offset(%iter_565, %idx_564) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_567 = cute.make_view(%tup_566, %slice_563) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_568 = cute.get_iter(%view_567) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_569, %e1_570, %e2_571, %e3_572 = cute.get_leaves(%iter_568) : !cute.int_tuple<"(?,0,?,0)">
      %219 = cute.get_scalars(%e0_569) : !cute.int_tuple<"?">
      %220 = cute.get_scalars(%e2_571) : !cute.int_tuple<"?">
      %tile_573 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_574 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %221 = cute.get_scalars(%coord_574) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_575 = cute.make_coord(%221) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_576 = cute.get_layout(%view_567) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %222:2 = cute.get_scalars(%lay_576) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_577 = arith.constant 64 : i32
      %223 = arith.ceildivsi %222#0, %c64_i32_577 : i32
      %c128_i32_578 = arith.constant 128 : i32
      %224 = arith.ceildivsi %222#1, %c128_i32_578 : i32
      %shape_579 = cute.make_shape(%223, %224) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_580 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_581 = cute.make_layout(%shape_579, %stride_580) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_582 = cute.crd2idx(%coord_575, %lay_581) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_583 = cute.get_iter(%view_567) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_584 = cute.add_offset(%iter_583, %idx_582) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_585 = cute.make_view(%tup_584) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_586 = cute.get_iter(%view_585) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_587, %e1_588, %e2_589, %e3_590 = cute.get_leaves(%iter_586) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %225 = cute.get_scalars(%e0_587) : !cute.int_tuple<"?">
      %226 = cute.get_scalars(%e1_588) : !cute.int_tuple<"?{div=64}">
      %227 = cute.get_scalars(%e2_589) : !cute.int_tuple<"?">
      %coord_591 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_592 = cute.get_layout(%209) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_593 = cute.slice(%lay_592, %coord_591) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,?,_,_)">
      %idx_594 = cute.crd2idx(%coord_591, %lay_592) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,?,0,0)">
      %iter_595 = cute.get_iter(%209) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_596 = cute.add_offset(%iter_595, %idx_594) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,?,0,0)">) -> !cute.int_tuple<"(?,?,0,0)">
      %view_597 = cute.make_view(%tup_596, %slice_593) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %iter_598 = cute.get_iter(%view_597) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %e0_599, %e1_600, %e2_601, %e3_602 = cute.get_leaves(%iter_598) : !cute.int_tuple<"(?,?,0,0)">
      %228 = cute.get_scalars(%e0_599) : !cute.int_tuple<"?">
      %229 = cute.get_scalars(%e1_600) : !cute.int_tuple<"?">
      %tile_603 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_604 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %230 = cute.get_scalars(%coord_604) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_605 = cute.make_coord(%230) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_606 = cute.get_layout(%view_597) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %231:2 = cute.get_scalars(%lay_606) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@2,1@3)">
      %c64_i32_607 = arith.constant 64 : i32
      %232 = arith.ceildivsi %231#0, %c64_i32_607 : i32
      %c64_i32_608 = arith.constant 64 : i32
      %233 = arith.ceildivsi %231#1, %c64_i32_608 : i32
      %shape_609 = cute.make_shape(%232, %233) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %stride_610 = cute.make_stride() : () -> !cute.stride<"((1@2,1@3),(64@2,64@3))">
      %lay_611 = cute.make_layout(%shape_609, %stride_610) : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">
      %slice_612 = cute.slice(%lay_611, %coord_605) : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">, !cute.coord<"((_,_),(?,_))">
      %idx_613 = cute.crd2idx(%coord_605, %lay_611) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">) -> !cute.int_tuple<"(0,0,?{div=64},0)">
      %iter_614 = cute.get_iter(%view_597) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %tup_615 = cute.add_offset(%iter_614, %idx_613) : (!cute.int_tuple<"(?,?,0,0)">, !cute.int_tuple<"(0,0,?{div=64},0)">) -> !cute.int_tuple<"(?,?,?{div=64},0)">
      %view_616 = cute.make_view(%tup_615, %slice_612) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %iter_617 = cute.get_iter(%view_616) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %e0_618, %e1_619, %e2_620, %e3_621 = cute.get_leaves(%iter_617) : !cute.int_tuple<"(?,?,?{div=64},0)">
      %234 = cute.get_scalars(%e0_618) : !cute.int_tuple<"?">
      %235 = cute.get_scalars(%e1_619) : !cute.int_tuple<"?">
      %236 = cute.get_scalars(%e2_620) : !cute.int_tuple<"?{div=64}">
      %coord_622 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_623 = cute.tiled.copy.partition_S(%4, %view_555, %coord_622) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_624 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_625, %e1_626, %e2_627, %e3_628 = cute.get_leaves(%iter_624) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %237 = cute.get_scalars(%e0_625) : !cute.int_tuple<"?">
      %238 = cute.get_scalars(%e1_626) : !cute.int_tuple<"?">
      %239 = cute.get_scalars(%e2_627) : !cute.int_tuple<"?">
      %240 = cute.get_scalars(%e3_628) : !cute.int_tuple<"?{div=8}">
      %coord_629 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_630 = cute.tiled.copy.partition_S(%4, %view_585, %coord_629) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_631 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_632, %e1_633, %e2_634, %e3_635 = cute.get_leaves(%iter_631) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %241 = cute.get_scalars(%e0_632) : !cute.int_tuple<"?">
      %242 = cute.get_scalars(%e1_633) : !cute.int_tuple<"?">
      %243 = cute.get_scalars(%e2_634) : !cute.int_tuple<"?">
      %244 = cute.get_scalars(%e3_635) : !cute.int_tuple<"?{div=8}">
      %coord_636 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_637 = cute.tiled.copy.partition_S(%4, %view_616, %coord_636) : (!copy_ldgsts, !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %iter_638 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %e0_639, %e1_640, %e2_641, %e3_642 = cute.get_leaves(%iter_638) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %245 = cute.get_scalars(%e0_639) : !cute.int_tuple<"?">
      %246 = cute.get_scalars(%e1_640) : !cute.int_tuple<"?">
      %247 = cute.get_scalars(%e2_641) : !cute.int_tuple<"?">
      %248 = cute.get_scalars(%e3_642) : !cute.int_tuple<"?{div=8}">
      %lay_643 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %249 = cute.get_shape(%lay_643) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_644, %e1_645, %e2_646, %e3_647 = cute.get_leaves(%249) : !cute.shape<"((8,1),4,2)">
      %lay_648 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_649 = cute.size(%lay_648) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_650 = cute.get_leaves(%sz_649) : !cute.int_tuple<"4">
      %lay_651 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_652 = cute.size(%lay_651) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_653 = cute.get_leaves(%sz_652) : !cute.int_tuple<"2">
      %lay_654 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_655 = cute.size(%lay_654) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_656 = cute.get_leaves(%sz_655) : !cute.int_tuple<"2">
      %shape_657 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_658 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_659 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_660 = cute.memref.alloca(%lay_659) : !memref_rmem_i8_
      %iter_661 = cute.get_iter(%rmem_660) : !memref_rmem_i8_
      %iter_662 = cute.get_iter(%rmem_660) : !memref_rmem_i8_
      %lay_663 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
      %250 = cute.get_shape(%lay_663) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_664, %e1_665, %e2_666, %e3_667 = cute.get_leaves(%250) : !cute.shape<"((8,1),4,2)">
      %lay_668 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
      %sz_669 = cute.size(%lay_668) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_670 = cute.get_leaves(%sz_669) : !cute.int_tuple<"4">
      %lay_671 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
      %sz_672 = cute.size(%lay_671) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_673 = cute.get_leaves(%sz_672) : !cute.int_tuple<"2">
      %lay_674 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
      %sz_675 = cute.size(%lay_674) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_676 = cute.get_leaves(%sz_675) : !cute.int_tuple<"2">
      %shape_677 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_678 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_679 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_680 = cute.memref.alloca(%lay_679) : !memref_rmem_i8_
      %iter_681 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
      %iter_682 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
      %lay_683 = cute.get_layout(%rmem_660) : !memref_rmem_i8_
      %251 = cute.get_shape(%lay_683) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_684, %e1_685, %e2_686 = cute.get_leaves(%251) : !cute.shape<"(1,4,2)">
      %coord_687 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_688 = cute.get_layout(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_689 = cute.crd2idx(%coord_687, %lay_688) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_690 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_691 = cute.add_offset(%iter_690, %idx_689) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_692 = cute.make_view(%tup_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_693 = cute.get_iter(%view_692) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_694, %e1_695, %e2_696, %e3_697 = cute.get_leaves(%iter_693) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %252 = cute.get_scalars(%e0_694) : !cute.int_tuple<"?">
      %253 = cute.get_scalars(%e1_695) : !cute.int_tuple<"?">
      %254 = cute.get_scalars(%e2_696) : !cute.int_tuple<"?">
      %255 = cute.get_scalars(%e3_697) : !cute.int_tuple<"?{div=8}">
      %iter_698 = cute.get_iter(%view_692) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_699, %e1_700, %e2_701, %e3_702 = cute.get_leaves(%iter_698) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %256 = cute.get_scalars(%e0_699) : !cute.int_tuple<"?">
      %257 = cute.get_scalars(%e1_700) : !cute.int_tuple<"?">
      %258 = cute.get_scalars(%e2_701) : !cute.int_tuple<"?">
      %259 = cute.get_scalars(%e3_702) : !cute.int_tuple<"?{div=8}">
      %iter_703 = cute.get_iter(%view_692) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_704, %e1_705, %e2_706, %e3_707 = cute.get_leaves(%iter_703) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %260 = cute.get_scalars(%e0_704) : !cute.int_tuple<"?">
      %261 = cute.get_scalars(%e1_705) : !cute.int_tuple<"?">
      %262 = cute.get_scalars(%e2_706) : !cute.int_tuple<"?">
      %263 = cute.get_scalars(%e3_707) : !cute.int_tuple<"?{div=8}">
      %lay_708 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %264 = cute.get_shape(%lay_708) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_709, %e1_710, %e2_711, %e3_712 = cute.get_leaves(%264) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_713 = cute.to_int_tuple(%e0_709) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %265 = cute.get_scalars(%itup_713) : !cute.int_tuple<"?">
      %itup_714 = cute.to_int_tuple(%e1_710) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %266 = cute.get_scalars(%itup_714) : !cute.int_tuple<"?">
      %itup_715 = cute.to_int_tuple(%e2_711) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %267 = cute.get_scalars(%itup_715) : !cute.int_tuple<"?">
      %itup_716 = cute.to_int_tuple(%e3_712) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %268 = cute.get_scalars(%itup_716) : !cute.int_tuple<"?{div=8}">
      %coord_717 = cute.make_coord(%e3_707) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_718 = cute.make_coord(%itup_716) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %269 = cute.elem_less(%coord_717, %coord_718) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %270 = arith.extui %269 : i1 to i8
      %coord_719 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_660, %coord_719, %270) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_720 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_721 = cute.get_layout(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_722 = cute.crd2idx(%coord_720, %lay_721) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_723 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_724 = cute.add_offset(%iter_723, %idx_722) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_725 = cute.make_view(%tup_724) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_726 = cute.get_iter(%view_725) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_727, %e1_728, %e2_729, %e3_730 = cute.get_leaves(%iter_726) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %271 = cute.get_scalars(%e0_727) : !cute.int_tuple<"?">
      %272 = cute.get_scalars(%e1_728) : !cute.int_tuple<"?">
      %273 = cute.get_scalars(%e2_729) : !cute.int_tuple<"?">
      %274 = cute.get_scalars(%e3_730) : !cute.int_tuple<"?{div=8}">
      %iter_731 = cute.get_iter(%view_725) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_732, %e1_733, %e2_734, %e3_735 = cute.get_leaves(%iter_731) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %275 = cute.get_scalars(%e0_732) : !cute.int_tuple<"?">
      %276 = cute.get_scalars(%e1_733) : !cute.int_tuple<"?">
      %277 = cute.get_scalars(%e2_734) : !cute.int_tuple<"?">
      %278 = cute.get_scalars(%e3_735) : !cute.int_tuple<"?{div=8}">
      %iter_736 = cute.get_iter(%view_725) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_737, %e1_738, %e2_739, %e3_740 = cute.get_leaves(%iter_736) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %279 = cute.get_scalars(%e0_737) : !cute.int_tuple<"?">
      %280 = cute.get_scalars(%e1_738) : !cute.int_tuple<"?">
      %281 = cute.get_scalars(%e2_739) : !cute.int_tuple<"?">
      %282 = cute.get_scalars(%e3_740) : !cute.int_tuple<"?{div=8}">
      %lay_741 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %283 = cute.get_shape(%lay_741) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_742, %e1_743, %e2_744, %e3_745 = cute.get_leaves(%283) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_746 = cute.to_int_tuple(%e0_742) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %284 = cute.get_scalars(%itup_746) : !cute.int_tuple<"?">
      %itup_747 = cute.to_int_tuple(%e1_743) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %285 = cute.get_scalars(%itup_747) : !cute.int_tuple<"?">
      %itup_748 = cute.to_int_tuple(%e2_744) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %286 = cute.get_scalars(%itup_748) : !cute.int_tuple<"?">
      %itup_749 = cute.to_int_tuple(%e3_745) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %287 = cute.get_scalars(%itup_749) : !cute.int_tuple<"?{div=8}">
      %coord_750 = cute.make_coord(%e3_740) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_751 = cute.make_coord(%itup_749) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %288 = cute.elem_less(%coord_750, %coord_751) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %289 = arith.extui %288 : i1 to i8
      %coord_752 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_660, %coord_752, %289) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_753 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
      %290 = cute.get_shape(%lay_753) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_754, %e1_755, %e2_756 = cute.get_leaves(%290) : !cute.shape<"(1,4,2)">
      %coord_757 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_758 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_759 = cute.crd2idx(%coord_757, %lay_758) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_760 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_761 = cute.add_offset(%iter_760, %idx_759) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_762 = cute.make_view(%tup_761) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_763 = cute.get_iter(%view_762) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_764, %e1_765, %e2_766, %e3_767 = cute.get_leaves(%iter_763) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %291 = cute.get_scalars(%e0_764) : !cute.int_tuple<"?">
      %292 = cute.get_scalars(%e1_765) : !cute.int_tuple<"?">
      %293 = cute.get_scalars(%e2_766) : !cute.int_tuple<"?">
      %294 = cute.get_scalars(%e3_767) : !cute.int_tuple<"?{div=8}">
      %iter_768 = cute.get_iter(%view_762) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_769, %e1_770, %e2_771, %e3_772 = cute.get_leaves(%iter_768) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %295 = cute.get_scalars(%e0_769) : !cute.int_tuple<"?">
      %296 = cute.get_scalars(%e1_770) : !cute.int_tuple<"?">
      %297 = cute.get_scalars(%e2_771) : !cute.int_tuple<"?">
      %298 = cute.get_scalars(%e3_772) : !cute.int_tuple<"?{div=8}">
      %iter_773 = cute.get_iter(%view_762) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_774, %e1_775, %e2_776, %e3_777 = cute.get_leaves(%iter_773) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %299 = cute.get_scalars(%e0_774) : !cute.int_tuple<"?">
      %300 = cute.get_scalars(%e1_775) : !cute.int_tuple<"?">
      %301 = cute.get_scalars(%e2_776) : !cute.int_tuple<"?">
      %302 = cute.get_scalars(%e3_777) : !cute.int_tuple<"?{div=8}">
      %lay_778 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %303 = cute.get_shape(%lay_778) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_779, %e1_780, %e2_781, %e3_782 = cute.get_leaves(%303) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_783 = cute.to_int_tuple(%e0_779) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %304 = cute.get_scalars(%itup_783) : !cute.int_tuple<"?">
      %itup_784 = cute.to_int_tuple(%e1_780) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %305 = cute.get_scalars(%itup_784) : !cute.int_tuple<"?">
      %itup_785 = cute.to_int_tuple(%e2_781) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %306 = cute.get_scalars(%itup_785) : !cute.int_tuple<"?">
      %itup_786 = cute.to_int_tuple(%e3_782) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %307 = cute.get_scalars(%itup_786) : !cute.int_tuple<"?{div=8}">
      %coord_787 = cute.make_coord(%e3_777) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_788 = cute.make_coord(%itup_786) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %308 = cute.elem_less(%coord_787, %coord_788) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %309 = arith.extui %308 : i1 to i8
      %coord_789 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_680, %coord_789, %309) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_790 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_791 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_792 = cute.crd2idx(%coord_790, %lay_791) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_793 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_794 = cute.add_offset(%iter_793, %idx_792) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_795 = cute.make_view(%tup_794) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_796 = cute.get_iter(%view_795) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_797, %e1_798, %e2_799, %e3_800 = cute.get_leaves(%iter_796) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %310 = cute.get_scalars(%e0_797) : !cute.int_tuple<"?">
      %311 = cute.get_scalars(%e1_798) : !cute.int_tuple<"?">
      %312 = cute.get_scalars(%e2_799) : !cute.int_tuple<"?">
      %313 = cute.get_scalars(%e3_800) : !cute.int_tuple<"?{div=8}">
      %iter_801 = cute.get_iter(%view_795) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_802, %e1_803, %e2_804, %e3_805 = cute.get_leaves(%iter_801) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %314 = cute.get_scalars(%e0_802) : !cute.int_tuple<"?">
      %315 = cute.get_scalars(%e1_803) : !cute.int_tuple<"?">
      %316 = cute.get_scalars(%e2_804) : !cute.int_tuple<"?">
      %317 = cute.get_scalars(%e3_805) : !cute.int_tuple<"?{div=8}">
      %iter_806 = cute.get_iter(%view_795) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_807, %e1_808, %e2_809, %e3_810 = cute.get_leaves(%iter_806) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %318 = cute.get_scalars(%e0_807) : !cute.int_tuple<"?">
      %319 = cute.get_scalars(%e1_808) : !cute.int_tuple<"?">
      %320 = cute.get_scalars(%e2_809) : !cute.int_tuple<"?">
      %321 = cute.get_scalars(%e3_810) : !cute.int_tuple<"?{div=8}">
      %lay_811 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %322 = cute.get_shape(%lay_811) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_812, %e1_813, %e2_814, %e3_815 = cute.get_leaves(%322) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_816 = cute.to_int_tuple(%e0_812) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %323 = cute.get_scalars(%itup_816) : !cute.int_tuple<"?">
      %itup_817 = cute.to_int_tuple(%e1_813) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %324 = cute.get_scalars(%itup_817) : !cute.int_tuple<"?">
      %itup_818 = cute.to_int_tuple(%e2_814) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %325 = cute.get_scalars(%itup_818) : !cute.int_tuple<"?">
      %itup_819 = cute.to_int_tuple(%e3_815) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %326 = cute.get_scalars(%itup_819) : !cute.int_tuple<"?{div=8}">
      %coord_820 = cute.make_coord(%e3_810) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_821 = cute.make_coord(%itup_819) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %327 = cute.elem_less(%coord_820, %coord_821) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %328 = arith.extui %327 : i1 to i8
      %coord_822 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_680, %coord_822, %328) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_823 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_824 = cute.size(%int_tuple_823) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_825 = cute.get_leaves(%sz_824) : !cute.int_tuple<"4">
      %coord_826 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_827 = cute.get_layout(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_828 = cute.crd2idx(%coord_826, %lay_827) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_829 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_830 = cute.add_offset(%iter_829, %idx_828) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_831 = cute.make_view(%tup_830) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_832 = cute.get_iter(%view_831) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_833, %e1_834, %e2_835, %e3_836 = cute.get_leaves(%iter_832) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %329 = cute.get_scalars(%e0_833) : !cute.int_tuple<"?">
      %330 = cute.get_scalars(%e1_834) : !cute.int_tuple<"?">
      %331 = cute.get_scalars(%e2_835) : !cute.int_tuple<"?">
      %332 = cute.get_scalars(%e3_836) : !cute.int_tuple<"?{div=8}">
      %iter_837 = cute.get_iter(%view_831) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_838, %e1_839, %e2_840, %e3_841 = cute.get_leaves(%iter_837) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %333 = cute.get_scalars(%e0_838) : !cute.int_tuple<"?">
      %334 = cute.get_scalars(%e1_839) : !cute.int_tuple<"?">
      %335 = cute.get_scalars(%e2_840) : !cute.int_tuple<"?">
      %336 = cute.get_scalars(%e3_841) : !cute.int_tuple<"?{div=8}">
      %iter_842 = cute.get_iter(%view_831) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_843, %e1_844, %e2_845, %e3_846 = cute.get_leaves(%iter_842) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %337 = cute.get_scalars(%e0_843) : !cute.int_tuple<"?">
      %338 = cute.get_scalars(%e1_844) : !cute.int_tuple<"?">
      %339 = cute.get_scalars(%e2_845) : !cute.int_tuple<"?">
      %340 = cute.get_scalars(%e3_846) : !cute.int_tuple<"?{div=8}">
      %lay_847 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %341 = cute.get_shape(%lay_847) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_848, %e1_849, %e2_850, %e3_851 = cute.get_leaves(%341) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_852 = cute.to_int_tuple(%e0_848) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %342 = cute.get_scalars(%itup_852) : !cute.int_tuple<"?">
      %itup_853 = cute.to_int_tuple(%e1_849) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %343 = cute.get_scalars(%itup_853) : !cute.int_tuple<"?">
      %itup_854 = cute.to_int_tuple(%e2_850) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %344 = cute.get_scalars(%itup_854) : !cute.int_tuple<"?">
      %itup_855 = cute.to_int_tuple(%e3_851) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %345 = cute.get_scalars(%itup_855) : !cute.int_tuple<"?{div=8}">
      %coord_856 = cute.make_coord(%e1_844) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_857 = cute.make_coord(%itup_853) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %346 = cute.elem_less(%coord_856, %coord_857) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %346 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2060 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2062 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2069 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2074 = cute.get_layout(%rmem_660) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_660) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2062 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %coord_858 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_859 = cute.get_layout(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_860 = cute.crd2idx(%coord_858, %lay_859) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_861 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_862 = cute.add_offset(%iter_861, %idx_860) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_863 = cute.make_view(%tup_862) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_864 = cute.get_iter(%view_863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_865, %e1_866, %e2_867, %e3_868 = cute.get_leaves(%iter_864) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %347 = cute.get_scalars(%e0_865) : !cute.int_tuple<"?">
      %348 = cute.get_scalars(%e1_866) : !cute.int_tuple<"?">
      %349 = cute.get_scalars(%e2_867) : !cute.int_tuple<"?">
      %350 = cute.get_scalars(%e3_868) : !cute.int_tuple<"?{div=8}">
      %iter_869 = cute.get_iter(%view_863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_870, %e1_871, %e2_872, %e3_873 = cute.get_leaves(%iter_869) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %351 = cute.get_scalars(%e0_870) : !cute.int_tuple<"?">
      %352 = cute.get_scalars(%e1_871) : !cute.int_tuple<"?">
      %353 = cute.get_scalars(%e2_872) : !cute.int_tuple<"?">
      %354 = cute.get_scalars(%e3_873) : !cute.int_tuple<"?{div=8}">
      %iter_874 = cute.get_iter(%view_863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_875, %e1_876, %e2_877, %e3_878 = cute.get_leaves(%iter_874) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %355 = cute.get_scalars(%e0_875) : !cute.int_tuple<"?">
      %356 = cute.get_scalars(%e1_876) : !cute.int_tuple<"?">
      %357 = cute.get_scalars(%e2_877) : !cute.int_tuple<"?">
      %358 = cute.get_scalars(%e3_878) : !cute.int_tuple<"?{div=8}">
      %lay_879 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %359 = cute.get_shape(%lay_879) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_880, %e1_881, %e2_882, %e3_883 = cute.get_leaves(%359) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_884 = cute.to_int_tuple(%e0_880) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %360 = cute.get_scalars(%itup_884) : !cute.int_tuple<"?">
      %itup_885 = cute.to_int_tuple(%e1_881) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %361 = cute.get_scalars(%itup_885) : !cute.int_tuple<"?">
      %itup_886 = cute.to_int_tuple(%e2_882) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %362 = cute.get_scalars(%itup_886) : !cute.int_tuple<"?">
      %itup_887 = cute.to_int_tuple(%e3_883) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %363 = cute.get_scalars(%itup_887) : !cute.int_tuple<"?{div=8}">
      %coord_888 = cute.make_coord(%e1_876) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_889 = cute.make_coord(%itup_885) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %364 = cute.elem_less(%coord_888, %coord_889) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %364 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2060 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2062 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2069 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2074 = cute.get_layout(%rmem_660) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_660) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2062 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %coord_890 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_891 = cute.get_layout(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_892 = cute.crd2idx(%coord_890, %lay_891) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_893 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_894 = cute.add_offset(%iter_893, %idx_892) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_895 = cute.make_view(%tup_894) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_896 = cute.get_iter(%view_895) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_897, %e1_898, %e2_899, %e3_900 = cute.get_leaves(%iter_896) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %365 = cute.get_scalars(%e0_897) : !cute.int_tuple<"?">
      %366 = cute.get_scalars(%e1_898) : !cute.int_tuple<"?">
      %367 = cute.get_scalars(%e2_899) : !cute.int_tuple<"?">
      %368 = cute.get_scalars(%e3_900) : !cute.int_tuple<"?{div=8}">
      %iter_901 = cute.get_iter(%view_895) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_902, %e1_903, %e2_904, %e3_905 = cute.get_leaves(%iter_901) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %369 = cute.get_scalars(%e0_902) : !cute.int_tuple<"?">
      %370 = cute.get_scalars(%e1_903) : !cute.int_tuple<"?">
      %371 = cute.get_scalars(%e2_904) : !cute.int_tuple<"?">
      %372 = cute.get_scalars(%e3_905) : !cute.int_tuple<"?{div=8}">
      %iter_906 = cute.get_iter(%view_895) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_907, %e1_908, %e2_909, %e3_910 = cute.get_leaves(%iter_906) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %373 = cute.get_scalars(%e0_907) : !cute.int_tuple<"?">
      %374 = cute.get_scalars(%e1_908) : !cute.int_tuple<"?">
      %375 = cute.get_scalars(%e2_909) : !cute.int_tuple<"?">
      %376 = cute.get_scalars(%e3_910) : !cute.int_tuple<"?{div=8}">
      %lay_911 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %377 = cute.get_shape(%lay_911) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_912, %e1_913, %e2_914, %e3_915 = cute.get_leaves(%377) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_916 = cute.to_int_tuple(%e0_912) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %378 = cute.get_scalars(%itup_916) : !cute.int_tuple<"?">
      %itup_917 = cute.to_int_tuple(%e1_913) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %379 = cute.get_scalars(%itup_917) : !cute.int_tuple<"?">
      %itup_918 = cute.to_int_tuple(%e2_914) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %380 = cute.get_scalars(%itup_918) : !cute.int_tuple<"?">
      %itup_919 = cute.to_int_tuple(%e3_915) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %381 = cute.get_scalars(%itup_919) : !cute.int_tuple<"?{div=8}">
      %coord_920 = cute.make_coord(%e1_908) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_921 = cute.make_coord(%itup_917) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %382 = cute.elem_less(%coord_920, %coord_921) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %382 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2060 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2062 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2069 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2074 = cute.get_layout(%rmem_660) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_660) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2062 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %coord_922 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_923 = cute.get_layout(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_924 = cute.crd2idx(%coord_922, %lay_923) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_925 = cute.get_iter(%src_partitioned_623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_926 = cute.add_offset(%iter_925, %idx_924) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_927 = cute.make_view(%tup_926) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_928 = cute.get_iter(%view_927) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_929, %e1_930, %e2_931, %e3_932 = cute.get_leaves(%iter_928) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %383 = cute.get_scalars(%e0_929) : !cute.int_tuple<"?">
      %384 = cute.get_scalars(%e1_930) : !cute.int_tuple<"?">
      %385 = cute.get_scalars(%e2_931) : !cute.int_tuple<"?">
      %386 = cute.get_scalars(%e3_932) : !cute.int_tuple<"?{div=8}">
      %iter_933 = cute.get_iter(%view_927) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_934, %e1_935, %e2_936, %e3_937 = cute.get_leaves(%iter_933) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %387 = cute.get_scalars(%e0_934) : !cute.int_tuple<"?">
      %388 = cute.get_scalars(%e1_935) : !cute.int_tuple<"?">
      %389 = cute.get_scalars(%e2_936) : !cute.int_tuple<"?">
      %390 = cute.get_scalars(%e3_937) : !cute.int_tuple<"?{div=8}">
      %iter_938 = cute.get_iter(%view_927) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_939, %e1_940, %e2_941, %e3_942 = cute.get_leaves(%iter_938) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %391 = cute.get_scalars(%e0_939) : !cute.int_tuple<"?">
      %392 = cute.get_scalars(%e1_940) : !cute.int_tuple<"?">
      %393 = cute.get_scalars(%e2_941) : !cute.int_tuple<"?">
      %394 = cute.get_scalars(%e3_942) : !cute.int_tuple<"?{div=8}">
      %lay_943 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %395 = cute.get_shape(%lay_943) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_944, %e1_945, %e2_946, %e3_947 = cute.get_leaves(%395) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_948 = cute.to_int_tuple(%e0_944) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %396 = cute.get_scalars(%itup_948) : !cute.int_tuple<"?">
      %itup_949 = cute.to_int_tuple(%e1_945) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %397 = cute.get_scalars(%itup_949) : !cute.int_tuple<"?">
      %itup_950 = cute.to_int_tuple(%e2_946) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %398 = cute.get_scalars(%itup_950) : !cute.int_tuple<"?">
      %itup_951 = cute.to_int_tuple(%e3_947) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %399 = cute.get_scalars(%itup_951) : !cute.int_tuple<"?{div=8}">
      %coord_952 = cute.make_coord(%e1_940) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_953 = cute.make_coord(%itup_949) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %400 = cute.elem_less(%coord_952, %coord_953) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %400 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2060 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2062 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2069 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2074 = cute.get_layout(%rmem_660) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_660) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2062 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %int_tuple_954 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_955 = cute.size(%int_tuple_954) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_956 = cute.get_leaves(%sz_955) : !cute.int_tuple<"4">
      %coord_957 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_958 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_959 = cute.crd2idx(%coord_957, %lay_958) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_960 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_961 = cute.add_offset(%iter_960, %idx_959) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_962 = cute.make_view(%tup_961) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_963 = cute.get_iter(%view_962) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_964, %e1_965, %e2_966, %e3_967 = cute.get_leaves(%iter_963) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %401 = cute.get_scalars(%e0_964) : !cute.int_tuple<"?">
      %402 = cute.get_scalars(%e1_965) : !cute.int_tuple<"?">
      %403 = cute.get_scalars(%e2_966) : !cute.int_tuple<"?">
      %404 = cute.get_scalars(%e3_967) : !cute.int_tuple<"?{div=8}">
      %iter_968 = cute.get_iter(%view_962) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_969, %e1_970, %e2_971, %e3_972 = cute.get_leaves(%iter_968) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %405 = cute.get_scalars(%e0_969) : !cute.int_tuple<"?">
      %406 = cute.get_scalars(%e1_970) : !cute.int_tuple<"?">
      %407 = cute.get_scalars(%e2_971) : !cute.int_tuple<"?">
      %408 = cute.get_scalars(%e3_972) : !cute.int_tuple<"?{div=8}">
      %iter_973 = cute.get_iter(%view_962) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_974, %e1_975, %e2_976, %e3_977 = cute.get_leaves(%iter_973) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %409 = cute.get_scalars(%e0_974) : !cute.int_tuple<"?">
      %410 = cute.get_scalars(%e1_975) : !cute.int_tuple<"?">
      %411 = cute.get_scalars(%e2_976) : !cute.int_tuple<"?">
      %412 = cute.get_scalars(%e3_977) : !cute.int_tuple<"?{div=8}">
      %lay_978 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %413 = cute.get_shape(%lay_978) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_979, %e1_980, %e2_981, %e3_982 = cute.get_leaves(%413) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_983 = cute.to_int_tuple(%e0_979) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %414 = cute.get_scalars(%itup_983) : !cute.int_tuple<"?">
      %itup_984 = cute.to_int_tuple(%e1_980) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %415 = cute.get_scalars(%itup_984) : !cute.int_tuple<"?">
      %itup_985 = cute.to_int_tuple(%e2_981) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %416 = cute.get_scalars(%itup_985) : !cute.int_tuple<"?">
      %itup_986 = cute.to_int_tuple(%e3_982) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %417 = cute.get_scalars(%itup_986) : !cute.int_tuple<"?{div=8}">
      %coord_987 = cute.make_coord(%e1_975) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_988 = cute.make_coord(%itup_984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %418 = cute.elem_less(%coord_987, %coord_988) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %418 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_367) : !memref_gmem_bf16_6
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_2062 = cute.get_iter(%src_partitioned_367) : !memref_gmem_bf16_6
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2069 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2074 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2062 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %coord_989 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_990 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_991 = cute.crd2idx(%coord_989, %lay_990) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_992 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_993 = cute.add_offset(%iter_992, %idx_991) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_994 = cute.make_view(%tup_993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_995 = cute.get_iter(%view_994) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_996, %e1_997, %e2_998, %e3_999 = cute.get_leaves(%iter_995) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %419 = cute.get_scalars(%e0_996) : !cute.int_tuple<"?">
      %420 = cute.get_scalars(%e1_997) : !cute.int_tuple<"?">
      %421 = cute.get_scalars(%e2_998) : !cute.int_tuple<"?">
      %422 = cute.get_scalars(%e3_999) : !cute.int_tuple<"?{div=8}">
      %iter_1000 = cute.get_iter(%view_994) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1001, %e1_1002, %e2_1003, %e3_1004 = cute.get_leaves(%iter_1000) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %423 = cute.get_scalars(%e0_1001) : !cute.int_tuple<"?">
      %424 = cute.get_scalars(%e1_1002) : !cute.int_tuple<"?">
      %425 = cute.get_scalars(%e2_1003) : !cute.int_tuple<"?">
      %426 = cute.get_scalars(%e3_1004) : !cute.int_tuple<"?{div=8}">
      %iter_1005 = cute.get_iter(%view_994) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1006, %e1_1007, %e2_1008, %e3_1009 = cute.get_leaves(%iter_1005) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %427 = cute.get_scalars(%e0_1006) : !cute.int_tuple<"?">
      %428 = cute.get_scalars(%e1_1007) : !cute.int_tuple<"?">
      %429 = cute.get_scalars(%e2_1008) : !cute.int_tuple<"?">
      %430 = cute.get_scalars(%e3_1009) : !cute.int_tuple<"?{div=8}">
      %lay_1010 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %431 = cute.get_shape(%lay_1010) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1011, %e1_1012, %e2_1013, %e3_1014 = cute.get_leaves(%431) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1015 = cute.to_int_tuple(%e0_1011) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %432 = cute.get_scalars(%itup_1015) : !cute.int_tuple<"?">
      %itup_1016 = cute.to_int_tuple(%e1_1012) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %433 = cute.get_scalars(%itup_1016) : !cute.int_tuple<"?">
      %itup_1017 = cute.to_int_tuple(%e2_1013) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %434 = cute.get_scalars(%itup_1017) : !cute.int_tuple<"?">
      %itup_1018 = cute.to_int_tuple(%e3_1014) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %435 = cute.get_scalars(%itup_1018) : !cute.int_tuple<"?{div=8}">
      %coord_1019 = cute.make_coord(%e1_1007) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1020 = cute.make_coord(%itup_1016) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %436 = cute.elem_less(%coord_1019, %coord_1020) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %436 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_367) : !memref_gmem_bf16_6
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2062 = cute.get_iter(%src_partitioned_367) : !memref_gmem_bf16_6
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2069 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2074 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2062 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %coord_1021 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1022 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1023 = cute.crd2idx(%coord_1021, %lay_1022) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1024 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1025 = cute.add_offset(%iter_1024, %idx_1023) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1026 = cute.make_view(%tup_1025) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1027 = cute.get_iter(%view_1026) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1028, %e1_1029, %e2_1030, %e3_1031 = cute.get_leaves(%iter_1027) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %437 = cute.get_scalars(%e0_1028) : !cute.int_tuple<"?">
      %438 = cute.get_scalars(%e1_1029) : !cute.int_tuple<"?">
      %439 = cute.get_scalars(%e2_1030) : !cute.int_tuple<"?">
      %440 = cute.get_scalars(%e3_1031) : !cute.int_tuple<"?{div=8}">
      %iter_1032 = cute.get_iter(%view_1026) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1033, %e1_1034, %e2_1035, %e3_1036 = cute.get_leaves(%iter_1032) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %441 = cute.get_scalars(%e0_1033) : !cute.int_tuple<"?">
      %442 = cute.get_scalars(%e1_1034) : !cute.int_tuple<"?">
      %443 = cute.get_scalars(%e2_1035) : !cute.int_tuple<"?">
      %444 = cute.get_scalars(%e3_1036) : !cute.int_tuple<"?{div=8}">
      %iter_1037 = cute.get_iter(%view_1026) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1038, %e1_1039, %e2_1040, %e3_1041 = cute.get_leaves(%iter_1037) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %445 = cute.get_scalars(%e0_1038) : !cute.int_tuple<"?">
      %446 = cute.get_scalars(%e1_1039) : !cute.int_tuple<"?">
      %447 = cute.get_scalars(%e2_1040) : !cute.int_tuple<"?">
      %448 = cute.get_scalars(%e3_1041) : !cute.int_tuple<"?{div=8}">
      %lay_1042 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %449 = cute.get_shape(%lay_1042) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1043, %e1_1044, %e2_1045, %e3_1046 = cute.get_leaves(%449) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1047 = cute.to_int_tuple(%e0_1043) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %450 = cute.get_scalars(%itup_1047) : !cute.int_tuple<"?">
      %itup_1048 = cute.to_int_tuple(%e1_1044) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %451 = cute.get_scalars(%itup_1048) : !cute.int_tuple<"?">
      %itup_1049 = cute.to_int_tuple(%e2_1045) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %452 = cute.get_scalars(%itup_1049) : !cute.int_tuple<"?">
      %itup_1050 = cute.to_int_tuple(%e3_1046) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %453 = cute.get_scalars(%itup_1050) : !cute.int_tuple<"?{div=8}">
      %coord_1051 = cute.make_coord(%e1_1039) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1052 = cute.make_coord(%itup_1048) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %454 = cute.elem_less(%coord_1051, %coord_1052) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %454 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_367) : !memref_gmem_bf16_6
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2062 = cute.get_iter(%src_partitioned_367) : !memref_gmem_bf16_6
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2069 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2074 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2062 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %coord_1053 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1054 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1055 = cute.crd2idx(%coord_1053, %lay_1054) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1056 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1057 = cute.add_offset(%iter_1056, %idx_1055) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1058 = cute.make_view(%tup_1057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1059 = cute.get_iter(%view_1058) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1060, %e1_1061, %e2_1062, %e3_1063 = cute.get_leaves(%iter_1059) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %455 = cute.get_scalars(%e0_1060) : !cute.int_tuple<"?">
      %456 = cute.get_scalars(%e1_1061) : !cute.int_tuple<"?">
      %457 = cute.get_scalars(%e2_1062) : !cute.int_tuple<"?">
      %458 = cute.get_scalars(%e3_1063) : !cute.int_tuple<"?{div=8}">
      %iter_1064 = cute.get_iter(%view_1058) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1065, %e1_1066, %e2_1067, %e3_1068 = cute.get_leaves(%iter_1064) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %459 = cute.get_scalars(%e0_1065) : !cute.int_tuple<"?">
      %460 = cute.get_scalars(%e1_1066) : !cute.int_tuple<"?">
      %461 = cute.get_scalars(%e2_1067) : !cute.int_tuple<"?">
      %462 = cute.get_scalars(%e3_1068) : !cute.int_tuple<"?{div=8}">
      %iter_1069 = cute.get_iter(%view_1058) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1070, %e1_1071, %e2_1072, %e3_1073 = cute.get_leaves(%iter_1069) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %463 = cute.get_scalars(%e0_1070) : !cute.int_tuple<"?">
      %464 = cute.get_scalars(%e1_1071) : !cute.int_tuple<"?">
      %465 = cute.get_scalars(%e2_1072) : !cute.int_tuple<"?">
      %466 = cute.get_scalars(%e3_1073) : !cute.int_tuple<"?{div=8}">
      %lay_1074 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %467 = cute.get_shape(%lay_1074) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1075, %e1_1076, %e2_1077, %e3_1078 = cute.get_leaves(%467) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1079 = cute.to_int_tuple(%e0_1075) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %468 = cute.get_scalars(%itup_1079) : !cute.int_tuple<"?">
      %itup_1080 = cute.to_int_tuple(%e1_1076) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %469 = cute.get_scalars(%itup_1080) : !cute.int_tuple<"?">
      %itup_1081 = cute.to_int_tuple(%e2_1077) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %470 = cute.get_scalars(%itup_1081) : !cute.int_tuple<"?">
      %itup_1082 = cute.to_int_tuple(%e3_1078) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %471 = cute.get_scalars(%itup_1082) : !cute.int_tuple<"?{div=8}">
      %coord_1083 = cute.make_coord(%e1_1071) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1084 = cute.make_coord(%itup_1080) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %472 = cute.elem_less(%coord_1083, %coord_1084) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %472 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_367) : !memref_gmem_bf16_6
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2062 = cute.get_iter(%src_partitioned_367) : !memref_gmem_bf16_6
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_8
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_8
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2069 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_12
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_12
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2074 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_gmem_bf16_8
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_gmem_bf16_8
        %iter_2093 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %lay_2094 = cute.get_layout(%view_2092) : !memref_gmem_bf16_8
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_gmem_bf16_8
        %view_2099 = cute.make_view(%iter_2098) : !memref_gmem_bf16_9
        %iter_2100 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2101 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %lay_2102 = cute.get_layout(%view_2071) : !memref_smem_bf16_12
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_smem_bf16_12
        %iter_2107 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %lay_2108 = cute.get_layout(%view_2106) : !memref_smem_bf16_12
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_smem_bf16_12
        %view_2113 = cute.make_view(%iter_2112) : !memref_smem_bf16_13
        %iter_2114 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %iter_2115 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_gmem_bf16_9
        %iter_2144 = cute.get_iter(%view_2113) : !memref_smem_bf16_13
        %lay_2145 = cute.get_layout(%view_2099) : !memref_gmem_bf16_9
        %lay_2146 = cute.get_layout(%view_2113) : !memref_smem_bf16_13
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_gmem_bf16_10
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_smem_bf16_14
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2162, %view_2166, %view_2170) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2060 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2062 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_12
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_12
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"16">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_12
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2070, %e1_2071, %e2_2072 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %int_tuple_2073 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2074 = cute.tuple.product(%int_tuple_2073) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2075 = cute.get_leaves(%res_2074) : !cute.int_tuple<"16">
        %cst_2076 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2076 : vector<16xbf16>
        %int_tuple_2077 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2078 = cute.size(%int_tuple_2077) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2079 = cute.get_leaves(%sz_2078) : !cute.int_tuple<"16">
        %int_tuple_2080 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2081 = cute.size(%int_tuple_2080) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2082 = cute.get_leaves(%sz_2081) : !cute.int_tuple<"16">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_12
      }
      %lay_1085 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %473 = cute.get_shape(%lay_1085) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
      %e0_1086, %e1_1087, %e2_1088, %e3_1089, %e4_1090 = cute.get_leaves(%473) : !cute.shape<"((8,1),4,1,?)">
      %itup_1091 = cute.to_int_tuple(%e4_1090) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %474 = cute.get_scalars(%itup_1091) : !cute.int_tuple<"?">
      %int_tuple_1092 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1093 = cute.size(%int_tuple_1092) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1094 = cute.get_leaves(%sz_1093) : !cute.int_tuple<"4">
      %int_tuple_1095 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1096 = cute.size(%int_tuple_1095) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1097 = cute.get_leaves(%sz_1096) : !cute.int_tuple<"1">
      %coord_1098 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1099 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1100 = cute.crd2idx(%coord_1098, %lay_1099) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1101 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1102 = cute.add_offset(%iter_1101, %idx_1100) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1103 = cute.make_view(%tup_1102) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1104 = cute.get_iter(%view_1103) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1105, %e1_1106, %e2_1107, %e3_1108 = cute.get_leaves(%iter_1104) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %475 = cute.get_scalars(%e0_1105) : !cute.int_tuple<"?">
      %476 = cute.get_scalars(%e1_1106) : !cute.int_tuple<"?">
      %477 = cute.get_scalars(%e2_1107) : !cute.int_tuple<"?">
      %478 = cute.get_scalars(%e3_1108) : !cute.int_tuple<"?{div=8}">
      %iter_1109 = cute.get_iter(%view_1103) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1110, %e1_1111, %e2_1112, %e3_1113 = cute.get_leaves(%iter_1109) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %479 = cute.get_scalars(%e0_1110) : !cute.int_tuple<"?">
      %480 = cute.get_scalars(%e1_1111) : !cute.int_tuple<"?">
      %481 = cute.get_scalars(%e2_1112) : !cute.int_tuple<"?">
      %482 = cute.get_scalars(%e3_1113) : !cute.int_tuple<"?{div=8}">
      %iter_1114 = cute.get_iter(%view_1103) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1115, %e1_1116, %e2_1117, %e3_1118 = cute.get_leaves(%iter_1114) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %483 = cute.get_scalars(%e0_1115) : !cute.int_tuple<"?">
      %484 = cute.get_scalars(%e1_1116) : !cute.int_tuple<"?">
      %485 = cute.get_scalars(%e2_1117) : !cute.int_tuple<"?">
      %486 = cute.get_scalars(%e3_1118) : !cute.int_tuple<"?{div=8}">
      %lay_1119 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %487 = cute.get_shape(%lay_1119) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1120, %e1_1121, %e2_1122, %e3_1123 = cute.get_leaves(%487) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1124 = cute.to_int_tuple(%e0_1120) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %488 = cute.get_scalars(%itup_1124) : !cute.int_tuple<"?">
      %itup_1125 = cute.to_int_tuple(%e1_1121) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %489 = cute.get_scalars(%itup_1125) : !cute.int_tuple<"?">
      %itup_1126 = cute.to_int_tuple(%e2_1122) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %490 = cute.get_scalars(%itup_1126) : !cute.int_tuple<"?">
      %itup_1127 = cute.to_int_tuple(%e3_1123) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %491 = cute.get_scalars(%itup_1127) : !cute.int_tuple<"?{div=8}">
      %coord_1128 = cute.make_coord(%e1_1116) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1129 = cute.make_coord(%itup_1126) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %492 = cute.elem_less(%coord_1128, %coord_1129) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1130 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1131 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1132 = cute.crd2idx(%coord_1130, %lay_1131) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1133 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1134 = cute.add_offset(%iter_1133, %idx_1132) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1135 = cute.make_view(%tup_1134) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1136 = cute.get_iter(%view_1135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1137, %e1_1138, %e2_1139, %e3_1140 = cute.get_leaves(%iter_1136) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %493 = cute.get_scalars(%e0_1137) : !cute.int_tuple<"?">
      %494 = cute.get_scalars(%e1_1138) : !cute.int_tuple<"?">
      %495 = cute.get_scalars(%e2_1139) : !cute.int_tuple<"?">
      %496 = cute.get_scalars(%e3_1140) : !cute.int_tuple<"?{div=8}">
      %iter_1141 = cute.get_iter(%view_1135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1142, %e1_1143, %e2_1144, %e3_1145 = cute.get_leaves(%iter_1141) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %497 = cute.get_scalars(%e0_1142) : !cute.int_tuple<"?">
      %498 = cute.get_scalars(%e1_1143) : !cute.int_tuple<"?">
      %499 = cute.get_scalars(%e2_1144) : !cute.int_tuple<"?">
      %500 = cute.get_scalars(%e3_1145) : !cute.int_tuple<"?{div=8}">
      %iter_1146 = cute.get_iter(%view_1135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1147, %e1_1148, %e2_1149, %e3_1150 = cute.get_leaves(%iter_1146) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %501 = cute.get_scalars(%e0_1147) : !cute.int_tuple<"?">
      %502 = cute.get_scalars(%e1_1148) : !cute.int_tuple<"?">
      %503 = cute.get_scalars(%e2_1149) : !cute.int_tuple<"?">
      %504 = cute.get_scalars(%e3_1150) : !cute.int_tuple<"?{div=8}">
      %lay_1151 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %505 = cute.get_shape(%lay_1151) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1152, %e1_1153, %e2_1154, %e3_1155 = cute.get_leaves(%505) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1156 = cute.to_int_tuple(%e0_1152) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %506 = cute.get_scalars(%itup_1156) : !cute.int_tuple<"?">
      %itup_1157 = cute.to_int_tuple(%e1_1153) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %507 = cute.get_scalars(%itup_1157) : !cute.int_tuple<"?">
      %itup_1158 = cute.to_int_tuple(%e2_1154) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %508 = cute.get_scalars(%itup_1158) : !cute.int_tuple<"?">
      %itup_1159 = cute.to_int_tuple(%e3_1155) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %509 = cute.get_scalars(%itup_1159) : !cute.int_tuple<"?{div=8}">
      %coord_1160 = cute.make_coord(%e1_1148) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1161 = cute.make_coord(%itup_1158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %510 = cute.elem_less(%coord_1160, %coord_1161) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1162 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1163 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1164 = cute.crd2idx(%coord_1162, %lay_1163) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1165 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1166 = cute.add_offset(%iter_1165, %idx_1164) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1167 = cute.make_view(%tup_1166) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1168 = cute.get_iter(%view_1167) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1169, %e1_1170, %e2_1171, %e3_1172 = cute.get_leaves(%iter_1168) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %511 = cute.get_scalars(%e0_1169) : !cute.int_tuple<"?">
      %512 = cute.get_scalars(%e1_1170) : !cute.int_tuple<"?">
      %513 = cute.get_scalars(%e2_1171) : !cute.int_tuple<"?">
      %514 = cute.get_scalars(%e3_1172) : !cute.int_tuple<"?{div=8}">
      %iter_1173 = cute.get_iter(%view_1167) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1174, %e1_1175, %e2_1176, %e3_1177 = cute.get_leaves(%iter_1173) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %515 = cute.get_scalars(%e0_1174) : !cute.int_tuple<"?">
      %516 = cute.get_scalars(%e1_1175) : !cute.int_tuple<"?">
      %517 = cute.get_scalars(%e2_1176) : !cute.int_tuple<"?">
      %518 = cute.get_scalars(%e3_1177) : !cute.int_tuple<"?{div=8}">
      %iter_1178 = cute.get_iter(%view_1167) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1179, %e1_1180, %e2_1181, %e3_1182 = cute.get_leaves(%iter_1178) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %519 = cute.get_scalars(%e0_1179) : !cute.int_tuple<"?">
      %520 = cute.get_scalars(%e1_1180) : !cute.int_tuple<"?">
      %521 = cute.get_scalars(%e2_1181) : !cute.int_tuple<"?">
      %522 = cute.get_scalars(%e3_1182) : !cute.int_tuple<"?{div=8}">
      %lay_1183 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %523 = cute.get_shape(%lay_1183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1184, %e1_1185, %e2_1186, %e3_1187 = cute.get_leaves(%523) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1188 = cute.to_int_tuple(%e0_1184) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %524 = cute.get_scalars(%itup_1188) : !cute.int_tuple<"?">
      %itup_1189 = cute.to_int_tuple(%e1_1185) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %525 = cute.get_scalars(%itup_1189) : !cute.int_tuple<"?">
      %itup_1190 = cute.to_int_tuple(%e2_1186) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %526 = cute.get_scalars(%itup_1190) : !cute.int_tuple<"?">
      %itup_1191 = cute.to_int_tuple(%e3_1187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %527 = cute.get_scalars(%itup_1191) : !cute.int_tuple<"?{div=8}">
      %coord_1192 = cute.make_coord(%e2_1181) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1193 = cute.make_coord(%itup_1191) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %528 = cute.elem_less(%coord_1192, %coord_1193) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %529 = arith.extui %510 : i1 to i32
      %c0_i32 = arith.constant 0 : i32
      %530 = arith.cmpi ne, %529, %c0_i32 : i32
      %531 = arith.extui %510 : i1 to i32
      %532 = arith.extui %528 : i1 to i32
      %533 = arith.select %530, %532, %531 : i32
      %c0_i32_1194 = arith.constant 0 : i32
      %534 = arith.cmpi ne, %533, %c0_i32_1194 : i32
      scf.if %534 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,0,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
        %iter_2062 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_10
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_10
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2067 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2069 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_14
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_14
        %lay_2073 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %920 = cute.get_shape(%lay_2073) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2074, %e1_2075 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %lay_2076 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %921 = cute.get_shape(%lay_2076) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2077, %e1_2078 = cute.get_leaves(%921) : !cute.shape<"((8,1))">
        %lay_2079 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %shape_2080 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2081 = cute.make_layout() : !cute.layout<"1:0">
        %append_2082 = cute.append_to_rank<2> (%lay_2079, %lay_2081) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2083 = cute.make_view(%iter_2065, %append_2082) : !memref_gmem_bf16_11
        %iter_2084 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %lay_2085 = cute.get_layout(%view_2083) : !memref_gmem_bf16_11
        %922 = cute.get_shape(%lay_2085) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2086, %e1_2087, %e2_2088 = cute.get_leaves(%922) : !cute.shape<"((8,1),1)">
        %iter_2089 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %view_2090 = cute.make_view(%iter_2089) : !memref_gmem_bf16_12
        %iter_2091 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2092 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %lay_2093 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %shape_2094 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2095 = cute.make_layout() : !cute.layout<"1:0">
        %append_2096 = cute.append_to_rank<2> (%lay_2093, %lay_2095) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2097 = cute.make_view(%iter_2072, %append_2096) : !memref_smem_bf16_15
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %lay_2099 = cute.get_layout(%view_2097) : !memref_smem_bf16_15
        %923 = cute.get_shape(%lay_2099) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2100, %e1_2101, %e2_2102 = cute.get_leaves(%923) : !cute.shape<"((8,1),1)">
        %iter_2103 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %view_2104 = cute.make_view(%iter_2103) : !memref_smem_bf16_16
        %iter_2105 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %iter_2106 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2107 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %924 = cute.get_shape(%lay_2107) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2108, %e1_2109, %e2_2110 = cute.get_leaves(%924) : !cute.shape<"((8,1),(1))">
        %lay_2111 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %925 = cute.get_shape(%lay_2111) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2112, %e1_2113, %e2_2114 = cute.get_leaves(%925) : !cute.shape<"((8,1),(1))">
        %lay_2115 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %sz_2116 = cute.size(%lay_2115) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2117 = cute.get_leaves(%sz_2116) : !cute.int_tuple<"1">
        %lay_2118 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %sz_2119 = cute.size(%lay_2118) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2120 = cute.get_leaves(%sz_2119) : !cute.int_tuple<"1">
        %926 = cute.static : !cute.layout<"1:0">
        %iter_2121 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2122 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2123 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %lay_2124 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %append_2125 = cute.append_to_rank<2> (%lay_2123, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2126 = cute.append_to_rank<2> (%lay_2124, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2127 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2128 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2129 = cute.size(%lay_2127) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %927 = cute.get_scalars(%sz_2129) : !cute.int_tuple<"1">
        %c0_i32_2130 = arith.constant 0 : i32
        %c1_i32_2131 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2130 to %927 step %c1_i32_2131  : i32 {
          %coord_2132 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2133 = cute.slice(%lay_2127, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2134 = cute.crd2idx(%coord_2132, %lay_2127) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2135 = cute.add_offset(%iter_2121, %idx_2134) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2136 = cute.make_view(%ptr_2135, %slice_2133) : !memref_gmem_bf16_10
          %slice_2137 = cute.slice(%lay_2128, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2138 = cute.crd2idx(%coord_2132, %lay_2128) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2139 = cute.add_offset(%iter_2122, %idx_2138) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2140 = cute.make_view(%ptr_2139, %slice_2137) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2136, %view_2140) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2060 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2062 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_14
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_14
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"8">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2070, %e1_2071 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %int_tuple_2072 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2073 = cute.tuple.product(%int_tuple_2072) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2074 = cute.get_leaves(%res_2073) : !cute.int_tuple<"8">
        %cst_2075 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2075 : vector<8xbf16>
        %int_tuple_2076 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2077 = cute.size(%int_tuple_2076) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2078 = cute.get_leaves(%sz_2077) : !cute.int_tuple<"8">
        %int_tuple_2079 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2080 = cute.size(%int_tuple_2079) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2081 = cute.get_leaves(%sz_2080) : !cute.int_tuple<"8">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_14
      }
      %int_tuple_1195 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1196 = cute.size(%int_tuple_1195) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1197 = cute.get_leaves(%sz_1196) : !cute.int_tuple<"1">
      %coord_1198 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1199 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1200 = cute.crd2idx(%coord_1198, %lay_1199) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1201 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1202 = cute.add_offset(%iter_1201, %idx_1200) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1203 = cute.make_view(%tup_1202) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1204 = cute.get_iter(%view_1203) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1205, %e1_1206, %e2_1207, %e3_1208 = cute.get_leaves(%iter_1204) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %535 = cute.get_scalars(%e0_1205) : !cute.int_tuple<"?">
      %536 = cute.get_scalars(%e1_1206) : !cute.int_tuple<"?">
      %537 = cute.get_scalars(%e2_1207) : !cute.int_tuple<"?">
      %538 = cute.get_scalars(%e3_1208) : !cute.int_tuple<"?{div=8}">
      %iter_1209 = cute.get_iter(%view_1203) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1210, %e1_1211, %e2_1212, %e3_1213 = cute.get_leaves(%iter_1209) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %539 = cute.get_scalars(%e0_1210) : !cute.int_tuple<"?">
      %540 = cute.get_scalars(%e1_1211) : !cute.int_tuple<"?">
      %541 = cute.get_scalars(%e2_1212) : !cute.int_tuple<"?">
      %542 = cute.get_scalars(%e3_1213) : !cute.int_tuple<"?{div=8}">
      %iter_1214 = cute.get_iter(%view_1203) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1215, %e1_1216, %e2_1217, %e3_1218 = cute.get_leaves(%iter_1214) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %543 = cute.get_scalars(%e0_1215) : !cute.int_tuple<"?">
      %544 = cute.get_scalars(%e1_1216) : !cute.int_tuple<"?">
      %545 = cute.get_scalars(%e2_1217) : !cute.int_tuple<"?">
      %546 = cute.get_scalars(%e3_1218) : !cute.int_tuple<"?{div=8}">
      %lay_1219 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %547 = cute.get_shape(%lay_1219) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1220, %e1_1221, %e2_1222, %e3_1223 = cute.get_leaves(%547) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1224 = cute.to_int_tuple(%e0_1220) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %548 = cute.get_scalars(%itup_1224) : !cute.int_tuple<"?">
      %itup_1225 = cute.to_int_tuple(%e1_1221) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %549 = cute.get_scalars(%itup_1225) : !cute.int_tuple<"?">
      %itup_1226 = cute.to_int_tuple(%e2_1222) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %550 = cute.get_scalars(%itup_1226) : !cute.int_tuple<"?">
      %itup_1227 = cute.to_int_tuple(%e3_1223) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %551 = cute.get_scalars(%itup_1227) : !cute.int_tuple<"?{div=8}">
      %coord_1228 = cute.make_coord(%e1_1216) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1229 = cute.make_coord(%itup_1226) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %552 = cute.elem_less(%coord_1228, %coord_1229) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1230 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1231 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1232 = cute.crd2idx(%coord_1230, %lay_1231) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1233 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1234 = cute.add_offset(%iter_1233, %idx_1232) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1235 = cute.make_view(%tup_1234) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1236 = cute.get_iter(%view_1235) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1237, %e1_1238, %e2_1239, %e3_1240 = cute.get_leaves(%iter_1236) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %553 = cute.get_scalars(%e0_1237) : !cute.int_tuple<"?">
      %554 = cute.get_scalars(%e1_1238) : !cute.int_tuple<"?">
      %555 = cute.get_scalars(%e2_1239) : !cute.int_tuple<"?">
      %556 = cute.get_scalars(%e3_1240) : !cute.int_tuple<"?{div=8}">
      %iter_1241 = cute.get_iter(%view_1235) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1242, %e1_1243, %e2_1244, %e3_1245 = cute.get_leaves(%iter_1241) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %557 = cute.get_scalars(%e0_1242) : !cute.int_tuple<"?">
      %558 = cute.get_scalars(%e1_1243) : !cute.int_tuple<"?">
      %559 = cute.get_scalars(%e2_1244) : !cute.int_tuple<"?">
      %560 = cute.get_scalars(%e3_1245) : !cute.int_tuple<"?{div=8}">
      %iter_1246 = cute.get_iter(%view_1235) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1247, %e1_1248, %e2_1249, %e3_1250 = cute.get_leaves(%iter_1246) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %561 = cute.get_scalars(%e0_1247) : !cute.int_tuple<"?">
      %562 = cute.get_scalars(%e1_1248) : !cute.int_tuple<"?">
      %563 = cute.get_scalars(%e2_1249) : !cute.int_tuple<"?">
      %564 = cute.get_scalars(%e3_1250) : !cute.int_tuple<"?{div=8}">
      %lay_1251 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %565 = cute.get_shape(%lay_1251) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1252, %e1_1253, %e2_1254, %e3_1255 = cute.get_leaves(%565) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1256 = cute.to_int_tuple(%e0_1252) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %566 = cute.get_scalars(%itup_1256) : !cute.int_tuple<"?">
      %itup_1257 = cute.to_int_tuple(%e1_1253) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %567 = cute.get_scalars(%itup_1257) : !cute.int_tuple<"?">
      %itup_1258 = cute.to_int_tuple(%e2_1254) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %568 = cute.get_scalars(%itup_1258) : !cute.int_tuple<"?">
      %itup_1259 = cute.to_int_tuple(%e3_1255) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %569 = cute.get_scalars(%itup_1259) : !cute.int_tuple<"?{div=8}">
      %coord_1260 = cute.make_coord(%e1_1248) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1261 = cute.make_coord(%itup_1258) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %570 = cute.elem_less(%coord_1260, %coord_1261) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1262 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1263 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1264 = cute.crd2idx(%coord_1262, %lay_1263) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1265 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1266 = cute.add_offset(%iter_1265, %idx_1264) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1267 = cute.make_view(%tup_1266) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1268 = cute.get_iter(%view_1267) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1269, %e1_1270, %e2_1271, %e3_1272 = cute.get_leaves(%iter_1268) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %571 = cute.get_scalars(%e0_1269) : !cute.int_tuple<"?">
      %572 = cute.get_scalars(%e1_1270) : !cute.int_tuple<"?">
      %573 = cute.get_scalars(%e2_1271) : !cute.int_tuple<"?">
      %574 = cute.get_scalars(%e3_1272) : !cute.int_tuple<"?{div=8}">
      %iter_1273 = cute.get_iter(%view_1267) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1274, %e1_1275, %e2_1276, %e3_1277 = cute.get_leaves(%iter_1273) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %575 = cute.get_scalars(%e0_1274) : !cute.int_tuple<"?">
      %576 = cute.get_scalars(%e1_1275) : !cute.int_tuple<"?">
      %577 = cute.get_scalars(%e2_1276) : !cute.int_tuple<"?">
      %578 = cute.get_scalars(%e3_1277) : !cute.int_tuple<"?{div=8}">
      %iter_1278 = cute.get_iter(%view_1267) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1279, %e1_1280, %e2_1281, %e3_1282 = cute.get_leaves(%iter_1278) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %579 = cute.get_scalars(%e0_1279) : !cute.int_tuple<"?">
      %580 = cute.get_scalars(%e1_1280) : !cute.int_tuple<"?">
      %581 = cute.get_scalars(%e2_1281) : !cute.int_tuple<"?">
      %582 = cute.get_scalars(%e3_1282) : !cute.int_tuple<"?{div=8}">
      %lay_1283 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %583 = cute.get_shape(%lay_1283) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1284, %e1_1285, %e2_1286, %e3_1287 = cute.get_leaves(%583) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1288 = cute.to_int_tuple(%e0_1284) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %584 = cute.get_scalars(%itup_1288) : !cute.int_tuple<"?">
      %itup_1289 = cute.to_int_tuple(%e1_1285) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %585 = cute.get_scalars(%itup_1289) : !cute.int_tuple<"?">
      %itup_1290 = cute.to_int_tuple(%e2_1286) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %586 = cute.get_scalars(%itup_1290) : !cute.int_tuple<"?">
      %itup_1291 = cute.to_int_tuple(%e3_1287) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %587 = cute.get_scalars(%itup_1291) : !cute.int_tuple<"?{div=8}">
      %coord_1292 = cute.make_coord(%e2_1281) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1293 = cute.make_coord(%itup_1291) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %588 = cute.elem_less(%coord_1292, %coord_1293) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %589 = arith.extui %570 : i1 to i32
      %590 = arith.cmpi ne, %589, %c0_i32 : i32
      %591 = arith.extui %570 : i1 to i32
      %592 = arith.extui %588 : i1 to i32
      %593 = arith.select %590, %592, %591 : i32
      %594 = arith.cmpi ne, %593, %c0_i32_1194 : i32
      scf.if %594 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,0,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2062 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_10
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_10
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2067 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2069 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_14
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_14
        %lay_2073 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %920 = cute.get_shape(%lay_2073) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2074, %e1_2075 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %lay_2076 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %921 = cute.get_shape(%lay_2076) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2077, %e1_2078 = cute.get_leaves(%921) : !cute.shape<"((8,1))">
        %lay_2079 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %shape_2080 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2081 = cute.make_layout() : !cute.layout<"1:0">
        %append_2082 = cute.append_to_rank<2> (%lay_2079, %lay_2081) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2083 = cute.make_view(%iter_2065, %append_2082) : !memref_gmem_bf16_11
        %iter_2084 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %lay_2085 = cute.get_layout(%view_2083) : !memref_gmem_bf16_11
        %922 = cute.get_shape(%lay_2085) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2086, %e1_2087, %e2_2088 = cute.get_leaves(%922) : !cute.shape<"((8,1),1)">
        %iter_2089 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %view_2090 = cute.make_view(%iter_2089) : !memref_gmem_bf16_12
        %iter_2091 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2092 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %lay_2093 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %shape_2094 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2095 = cute.make_layout() : !cute.layout<"1:0">
        %append_2096 = cute.append_to_rank<2> (%lay_2093, %lay_2095) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2097 = cute.make_view(%iter_2072, %append_2096) : !memref_smem_bf16_15
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %lay_2099 = cute.get_layout(%view_2097) : !memref_smem_bf16_15
        %923 = cute.get_shape(%lay_2099) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2100, %e1_2101, %e2_2102 = cute.get_leaves(%923) : !cute.shape<"((8,1),1)">
        %iter_2103 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %view_2104 = cute.make_view(%iter_2103) : !memref_smem_bf16_16
        %iter_2105 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %iter_2106 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2107 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %924 = cute.get_shape(%lay_2107) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2108, %e1_2109, %e2_2110 = cute.get_leaves(%924) : !cute.shape<"((8,1),(1))">
        %lay_2111 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %925 = cute.get_shape(%lay_2111) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2112, %e1_2113, %e2_2114 = cute.get_leaves(%925) : !cute.shape<"((8,1),(1))">
        %lay_2115 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %sz_2116 = cute.size(%lay_2115) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2117 = cute.get_leaves(%sz_2116) : !cute.int_tuple<"1">
        %lay_2118 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %sz_2119 = cute.size(%lay_2118) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2120 = cute.get_leaves(%sz_2119) : !cute.int_tuple<"1">
        %926 = cute.static : !cute.layout<"1:0">
        %iter_2121 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2122 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2123 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %lay_2124 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %append_2125 = cute.append_to_rank<2> (%lay_2123, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2126 = cute.append_to_rank<2> (%lay_2124, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2127 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2128 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2129 = cute.size(%lay_2127) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %927 = cute.get_scalars(%sz_2129) : !cute.int_tuple<"1">
        %c0_i32_2130 = arith.constant 0 : i32
        %c1_i32_2131 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2130 to %927 step %c1_i32_2131  : i32 {
          %coord_2132 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2133 = cute.slice(%lay_2127, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2134 = cute.crd2idx(%coord_2132, %lay_2127) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2135 = cute.add_offset(%iter_2121, %idx_2134) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2136 = cute.make_view(%ptr_2135, %slice_2133) : !memref_gmem_bf16_10
          %slice_2137 = cute.slice(%lay_2128, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2138 = cute.crd2idx(%coord_2132, %lay_2128) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2139 = cute.add_offset(%iter_2122, %idx_2138) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2140 = cute.make_view(%ptr_2139, %slice_2137) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2136, %view_2140) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2060 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2062 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_14
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_14
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"8">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2070, %e1_2071 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %int_tuple_2072 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2073 = cute.tuple.product(%int_tuple_2072) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2074 = cute.get_leaves(%res_2073) : !cute.int_tuple<"8">
        %cst_2075 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2075 : vector<8xbf16>
        %int_tuple_2076 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2077 = cute.size(%int_tuple_2076) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2078 = cute.get_leaves(%sz_2077) : !cute.int_tuple<"8">
        %int_tuple_2079 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2080 = cute.size(%int_tuple_2079) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2081 = cute.get_leaves(%sz_2080) : !cute.int_tuple<"8">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_14
      }
      %int_tuple_1294 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1295 = cute.size(%int_tuple_1294) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1296 = cute.get_leaves(%sz_1295) : !cute.int_tuple<"1">
      %coord_1297 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1298 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1299 = cute.crd2idx(%coord_1297, %lay_1298) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1300 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1301 = cute.add_offset(%iter_1300, %idx_1299) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1302 = cute.make_view(%tup_1301) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1303 = cute.get_iter(%view_1302) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1304, %e1_1305, %e2_1306, %e3_1307 = cute.get_leaves(%iter_1303) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %595 = cute.get_scalars(%e0_1304) : !cute.int_tuple<"?">
      %596 = cute.get_scalars(%e1_1305) : !cute.int_tuple<"?">
      %597 = cute.get_scalars(%e2_1306) : !cute.int_tuple<"?">
      %598 = cute.get_scalars(%e3_1307) : !cute.int_tuple<"?{div=8}">
      %iter_1308 = cute.get_iter(%view_1302) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1309, %e1_1310, %e2_1311, %e3_1312 = cute.get_leaves(%iter_1308) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %599 = cute.get_scalars(%e0_1309) : !cute.int_tuple<"?">
      %600 = cute.get_scalars(%e1_1310) : !cute.int_tuple<"?">
      %601 = cute.get_scalars(%e2_1311) : !cute.int_tuple<"?">
      %602 = cute.get_scalars(%e3_1312) : !cute.int_tuple<"?{div=8}">
      %iter_1313 = cute.get_iter(%view_1302) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1314, %e1_1315, %e2_1316, %e3_1317 = cute.get_leaves(%iter_1313) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %603 = cute.get_scalars(%e0_1314) : !cute.int_tuple<"?">
      %604 = cute.get_scalars(%e1_1315) : !cute.int_tuple<"?">
      %605 = cute.get_scalars(%e2_1316) : !cute.int_tuple<"?">
      %606 = cute.get_scalars(%e3_1317) : !cute.int_tuple<"?{div=8}">
      %lay_1318 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %607 = cute.get_shape(%lay_1318) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1319, %e1_1320, %e2_1321, %e3_1322 = cute.get_leaves(%607) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1323 = cute.to_int_tuple(%e0_1319) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %608 = cute.get_scalars(%itup_1323) : !cute.int_tuple<"?">
      %itup_1324 = cute.to_int_tuple(%e1_1320) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %609 = cute.get_scalars(%itup_1324) : !cute.int_tuple<"?">
      %itup_1325 = cute.to_int_tuple(%e2_1321) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %610 = cute.get_scalars(%itup_1325) : !cute.int_tuple<"?">
      %itup_1326 = cute.to_int_tuple(%e3_1322) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %611 = cute.get_scalars(%itup_1326) : !cute.int_tuple<"?{div=8}">
      %coord_1327 = cute.make_coord(%e1_1315) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1328 = cute.make_coord(%itup_1325) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %612 = cute.elem_less(%coord_1327, %coord_1328) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1329 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1330 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1331 = cute.crd2idx(%coord_1329, %lay_1330) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1332 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1333 = cute.add_offset(%iter_1332, %idx_1331) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1334 = cute.make_view(%tup_1333) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1335 = cute.get_iter(%view_1334) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1336, %e1_1337, %e2_1338, %e3_1339 = cute.get_leaves(%iter_1335) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %613 = cute.get_scalars(%e0_1336) : !cute.int_tuple<"?">
      %614 = cute.get_scalars(%e1_1337) : !cute.int_tuple<"?">
      %615 = cute.get_scalars(%e2_1338) : !cute.int_tuple<"?">
      %616 = cute.get_scalars(%e3_1339) : !cute.int_tuple<"?{div=8}">
      %iter_1340 = cute.get_iter(%view_1334) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1341, %e1_1342, %e2_1343, %e3_1344 = cute.get_leaves(%iter_1340) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %617 = cute.get_scalars(%e0_1341) : !cute.int_tuple<"?">
      %618 = cute.get_scalars(%e1_1342) : !cute.int_tuple<"?">
      %619 = cute.get_scalars(%e2_1343) : !cute.int_tuple<"?">
      %620 = cute.get_scalars(%e3_1344) : !cute.int_tuple<"?{div=8}">
      %iter_1345 = cute.get_iter(%view_1334) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1346, %e1_1347, %e2_1348, %e3_1349 = cute.get_leaves(%iter_1345) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %621 = cute.get_scalars(%e0_1346) : !cute.int_tuple<"?">
      %622 = cute.get_scalars(%e1_1347) : !cute.int_tuple<"?">
      %623 = cute.get_scalars(%e2_1348) : !cute.int_tuple<"?">
      %624 = cute.get_scalars(%e3_1349) : !cute.int_tuple<"?{div=8}">
      %lay_1350 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %625 = cute.get_shape(%lay_1350) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1351, %e1_1352, %e2_1353, %e3_1354 = cute.get_leaves(%625) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1355 = cute.to_int_tuple(%e0_1351) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %626 = cute.get_scalars(%itup_1355) : !cute.int_tuple<"?">
      %itup_1356 = cute.to_int_tuple(%e1_1352) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %627 = cute.get_scalars(%itup_1356) : !cute.int_tuple<"?">
      %itup_1357 = cute.to_int_tuple(%e2_1353) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %628 = cute.get_scalars(%itup_1357) : !cute.int_tuple<"?">
      %itup_1358 = cute.to_int_tuple(%e3_1354) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %629 = cute.get_scalars(%itup_1358) : !cute.int_tuple<"?{div=8}">
      %coord_1359 = cute.make_coord(%e1_1347) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1360 = cute.make_coord(%itup_1357) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %630 = cute.elem_less(%coord_1359, %coord_1360) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1361 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1362 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1363 = cute.crd2idx(%coord_1361, %lay_1362) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1364 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1365 = cute.add_offset(%iter_1364, %idx_1363) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1366 = cute.make_view(%tup_1365) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1367 = cute.get_iter(%view_1366) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1368, %e1_1369, %e2_1370, %e3_1371 = cute.get_leaves(%iter_1367) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %631 = cute.get_scalars(%e0_1368) : !cute.int_tuple<"?">
      %632 = cute.get_scalars(%e1_1369) : !cute.int_tuple<"?">
      %633 = cute.get_scalars(%e2_1370) : !cute.int_tuple<"?">
      %634 = cute.get_scalars(%e3_1371) : !cute.int_tuple<"?{div=8}">
      %iter_1372 = cute.get_iter(%view_1366) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1373, %e1_1374, %e2_1375, %e3_1376 = cute.get_leaves(%iter_1372) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %635 = cute.get_scalars(%e0_1373) : !cute.int_tuple<"?">
      %636 = cute.get_scalars(%e1_1374) : !cute.int_tuple<"?">
      %637 = cute.get_scalars(%e2_1375) : !cute.int_tuple<"?">
      %638 = cute.get_scalars(%e3_1376) : !cute.int_tuple<"?{div=8}">
      %iter_1377 = cute.get_iter(%view_1366) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1378, %e1_1379, %e2_1380, %e3_1381 = cute.get_leaves(%iter_1377) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %639 = cute.get_scalars(%e0_1378) : !cute.int_tuple<"?">
      %640 = cute.get_scalars(%e1_1379) : !cute.int_tuple<"?">
      %641 = cute.get_scalars(%e2_1380) : !cute.int_tuple<"?">
      %642 = cute.get_scalars(%e3_1381) : !cute.int_tuple<"?{div=8}">
      %lay_1382 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %643 = cute.get_shape(%lay_1382) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1383, %e1_1384, %e2_1385, %e3_1386 = cute.get_leaves(%643) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1387 = cute.to_int_tuple(%e0_1383) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %644 = cute.get_scalars(%itup_1387) : !cute.int_tuple<"?">
      %itup_1388 = cute.to_int_tuple(%e1_1384) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %645 = cute.get_scalars(%itup_1388) : !cute.int_tuple<"?">
      %itup_1389 = cute.to_int_tuple(%e2_1385) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %646 = cute.get_scalars(%itup_1389) : !cute.int_tuple<"?">
      %itup_1390 = cute.to_int_tuple(%e3_1386) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %647 = cute.get_scalars(%itup_1390) : !cute.int_tuple<"?{div=8}">
      %coord_1391 = cute.make_coord(%e2_1380) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1392 = cute.make_coord(%itup_1390) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %648 = cute.elem_less(%coord_1391, %coord_1392) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %649 = arith.extui %630 : i1 to i32
      %650 = arith.cmpi ne, %649, %c0_i32 : i32
      %651 = arith.extui %630 : i1 to i32
      %652 = arith.extui %648 : i1 to i32
      %653 = arith.select %650, %652, %651 : i32
      %654 = arith.cmpi ne, %653, %c0_i32_1194 : i32
      scf.if %654 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,0,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2062 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_10
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_10
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2067 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2069 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_14
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_14
        %lay_2073 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %920 = cute.get_shape(%lay_2073) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2074, %e1_2075 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %lay_2076 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %921 = cute.get_shape(%lay_2076) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2077, %e1_2078 = cute.get_leaves(%921) : !cute.shape<"((8,1))">
        %lay_2079 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %shape_2080 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2081 = cute.make_layout() : !cute.layout<"1:0">
        %append_2082 = cute.append_to_rank<2> (%lay_2079, %lay_2081) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2083 = cute.make_view(%iter_2065, %append_2082) : !memref_gmem_bf16_11
        %iter_2084 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %lay_2085 = cute.get_layout(%view_2083) : !memref_gmem_bf16_11
        %922 = cute.get_shape(%lay_2085) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2086, %e1_2087, %e2_2088 = cute.get_leaves(%922) : !cute.shape<"((8,1),1)">
        %iter_2089 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %view_2090 = cute.make_view(%iter_2089) : !memref_gmem_bf16_12
        %iter_2091 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2092 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %lay_2093 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %shape_2094 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2095 = cute.make_layout() : !cute.layout<"1:0">
        %append_2096 = cute.append_to_rank<2> (%lay_2093, %lay_2095) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2097 = cute.make_view(%iter_2072, %append_2096) : !memref_smem_bf16_15
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %lay_2099 = cute.get_layout(%view_2097) : !memref_smem_bf16_15
        %923 = cute.get_shape(%lay_2099) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2100, %e1_2101, %e2_2102 = cute.get_leaves(%923) : !cute.shape<"((8,1),1)">
        %iter_2103 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %view_2104 = cute.make_view(%iter_2103) : !memref_smem_bf16_16
        %iter_2105 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %iter_2106 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2107 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %924 = cute.get_shape(%lay_2107) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2108, %e1_2109, %e2_2110 = cute.get_leaves(%924) : !cute.shape<"((8,1),(1))">
        %lay_2111 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %925 = cute.get_shape(%lay_2111) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2112, %e1_2113, %e2_2114 = cute.get_leaves(%925) : !cute.shape<"((8,1),(1))">
        %lay_2115 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %sz_2116 = cute.size(%lay_2115) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2117 = cute.get_leaves(%sz_2116) : !cute.int_tuple<"1">
        %lay_2118 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %sz_2119 = cute.size(%lay_2118) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2120 = cute.get_leaves(%sz_2119) : !cute.int_tuple<"1">
        %926 = cute.static : !cute.layout<"1:0">
        %iter_2121 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2122 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2123 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %lay_2124 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %append_2125 = cute.append_to_rank<2> (%lay_2123, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2126 = cute.append_to_rank<2> (%lay_2124, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2127 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2128 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2129 = cute.size(%lay_2127) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %927 = cute.get_scalars(%sz_2129) : !cute.int_tuple<"1">
        %c0_i32_2130 = arith.constant 0 : i32
        %c1_i32_2131 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2130 to %927 step %c1_i32_2131  : i32 {
          %coord_2132 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2133 = cute.slice(%lay_2127, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2134 = cute.crd2idx(%coord_2132, %lay_2127) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2135 = cute.add_offset(%iter_2121, %idx_2134) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2136 = cute.make_view(%ptr_2135, %slice_2133) : !memref_gmem_bf16_10
          %slice_2137 = cute.slice(%lay_2128, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2138 = cute.crd2idx(%coord_2132, %lay_2128) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2139 = cute.add_offset(%iter_2122, %idx_2138) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2140 = cute.make_view(%ptr_2139, %slice_2137) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2136, %view_2140) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2060 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2062 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_14
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_14
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"8">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2070, %e1_2071 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %int_tuple_2072 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2073 = cute.tuple.product(%int_tuple_2072) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2074 = cute.get_leaves(%res_2073) : !cute.int_tuple<"8">
        %cst_2075 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2075 : vector<8xbf16>
        %int_tuple_2076 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2077 = cute.size(%int_tuple_2076) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2078 = cute.get_leaves(%sz_2077) : !cute.int_tuple<"8">
        %int_tuple_2079 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2080 = cute.size(%int_tuple_2079) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2081 = cute.get_leaves(%sz_2080) : !cute.int_tuple<"8">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_14
      }
      %int_tuple_1393 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1394 = cute.size(%int_tuple_1393) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1395 = cute.get_leaves(%sz_1394) : !cute.int_tuple<"1">
      %coord_1396 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_1397 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1398 = cute.crd2idx(%coord_1396, %lay_1397) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_1399 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1400 = cute.add_offset(%iter_1399, %idx_1398) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1401 = cute.make_view(%tup_1400) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1402 = cute.get_iter(%view_1401) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1403, %e1_1404, %e2_1405, %e3_1406 = cute.get_leaves(%iter_1402) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %655 = cute.get_scalars(%e0_1403) : !cute.int_tuple<"?">
      %656 = cute.get_scalars(%e1_1404) : !cute.int_tuple<"?">
      %657 = cute.get_scalars(%e2_1405) : !cute.int_tuple<"?">
      %658 = cute.get_scalars(%e3_1406) : !cute.int_tuple<"?{div=8}">
      %iter_1407 = cute.get_iter(%view_1401) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1408, %e1_1409, %e2_1410, %e3_1411 = cute.get_leaves(%iter_1407) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %659 = cute.get_scalars(%e0_1408) : !cute.int_tuple<"?">
      %660 = cute.get_scalars(%e1_1409) : !cute.int_tuple<"?">
      %661 = cute.get_scalars(%e2_1410) : !cute.int_tuple<"?">
      %662 = cute.get_scalars(%e3_1411) : !cute.int_tuple<"?{div=8}">
      %iter_1412 = cute.get_iter(%view_1401) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1413, %e1_1414, %e2_1415, %e3_1416 = cute.get_leaves(%iter_1412) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %663 = cute.get_scalars(%e0_1413) : !cute.int_tuple<"?">
      %664 = cute.get_scalars(%e1_1414) : !cute.int_tuple<"?">
      %665 = cute.get_scalars(%e2_1415) : !cute.int_tuple<"?">
      %666 = cute.get_scalars(%e3_1416) : !cute.int_tuple<"?{div=8}">
      %lay_1417 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %667 = cute.get_shape(%lay_1417) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1418, %e1_1419, %e2_1420, %e3_1421 = cute.get_leaves(%667) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1422 = cute.to_int_tuple(%e0_1418) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %668 = cute.get_scalars(%itup_1422) : !cute.int_tuple<"?">
      %itup_1423 = cute.to_int_tuple(%e1_1419) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %669 = cute.get_scalars(%itup_1423) : !cute.int_tuple<"?">
      %itup_1424 = cute.to_int_tuple(%e2_1420) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %670 = cute.get_scalars(%itup_1424) : !cute.int_tuple<"?">
      %itup_1425 = cute.to_int_tuple(%e3_1421) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %671 = cute.get_scalars(%itup_1425) : !cute.int_tuple<"?{div=8}">
      %coord_1426 = cute.make_coord(%e1_1414) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1427 = cute.make_coord(%itup_1424) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %672 = cute.elem_less(%coord_1426, %coord_1427) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1428 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_1429 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1430 = cute.crd2idx(%coord_1428, %lay_1429) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_1431 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1432 = cute.add_offset(%iter_1431, %idx_1430) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1433 = cute.make_view(%tup_1432) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1434 = cute.get_iter(%view_1433) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1435, %e1_1436, %e2_1437, %e3_1438 = cute.get_leaves(%iter_1434) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %673 = cute.get_scalars(%e0_1435) : !cute.int_tuple<"?">
      %674 = cute.get_scalars(%e1_1436) : !cute.int_tuple<"?">
      %675 = cute.get_scalars(%e2_1437) : !cute.int_tuple<"?">
      %676 = cute.get_scalars(%e3_1438) : !cute.int_tuple<"?{div=8}">
      %iter_1439 = cute.get_iter(%view_1433) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1440, %e1_1441, %e2_1442, %e3_1443 = cute.get_leaves(%iter_1439) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %677 = cute.get_scalars(%e0_1440) : !cute.int_tuple<"?">
      %678 = cute.get_scalars(%e1_1441) : !cute.int_tuple<"?">
      %679 = cute.get_scalars(%e2_1442) : !cute.int_tuple<"?">
      %680 = cute.get_scalars(%e3_1443) : !cute.int_tuple<"?{div=8}">
      %iter_1444 = cute.get_iter(%view_1433) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1445, %e1_1446, %e2_1447, %e3_1448 = cute.get_leaves(%iter_1444) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %681 = cute.get_scalars(%e0_1445) : !cute.int_tuple<"?">
      %682 = cute.get_scalars(%e1_1446) : !cute.int_tuple<"?">
      %683 = cute.get_scalars(%e2_1447) : !cute.int_tuple<"?">
      %684 = cute.get_scalars(%e3_1448) : !cute.int_tuple<"?{div=8}">
      %lay_1449 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %685 = cute.get_shape(%lay_1449) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1450, %e1_1451, %e2_1452, %e3_1453 = cute.get_leaves(%685) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1454 = cute.to_int_tuple(%e0_1450) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %686 = cute.get_scalars(%itup_1454) : !cute.int_tuple<"?">
      %itup_1455 = cute.to_int_tuple(%e1_1451) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %687 = cute.get_scalars(%itup_1455) : !cute.int_tuple<"?">
      %itup_1456 = cute.to_int_tuple(%e2_1452) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %688 = cute.get_scalars(%itup_1456) : !cute.int_tuple<"?">
      %itup_1457 = cute.to_int_tuple(%e3_1453) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %689 = cute.get_scalars(%itup_1457) : !cute.int_tuple<"?{div=8}">
      %coord_1458 = cute.make_coord(%e1_1446) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1459 = cute.make_coord(%itup_1456) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %690 = cute.elem_less(%coord_1458, %coord_1459) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1460 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_1461 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1462 = cute.crd2idx(%coord_1460, %lay_1461) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_1463 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1464 = cute.add_offset(%iter_1463, %idx_1462) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1465 = cute.make_view(%tup_1464) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1466 = cute.get_iter(%view_1465) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1467, %e1_1468, %e2_1469, %e3_1470 = cute.get_leaves(%iter_1466) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %691 = cute.get_scalars(%e0_1467) : !cute.int_tuple<"?">
      %692 = cute.get_scalars(%e1_1468) : !cute.int_tuple<"?">
      %693 = cute.get_scalars(%e2_1469) : !cute.int_tuple<"?">
      %694 = cute.get_scalars(%e3_1470) : !cute.int_tuple<"?{div=8}">
      %iter_1471 = cute.get_iter(%view_1465) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1472, %e1_1473, %e2_1474, %e3_1475 = cute.get_leaves(%iter_1471) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %695 = cute.get_scalars(%e0_1472) : !cute.int_tuple<"?">
      %696 = cute.get_scalars(%e1_1473) : !cute.int_tuple<"?">
      %697 = cute.get_scalars(%e2_1474) : !cute.int_tuple<"?">
      %698 = cute.get_scalars(%e3_1475) : !cute.int_tuple<"?{div=8}">
      %iter_1476 = cute.get_iter(%view_1465) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1477, %e1_1478, %e2_1479, %e3_1480 = cute.get_leaves(%iter_1476) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %699 = cute.get_scalars(%e0_1477) : !cute.int_tuple<"?">
      %700 = cute.get_scalars(%e1_1478) : !cute.int_tuple<"?">
      %701 = cute.get_scalars(%e2_1479) : !cute.int_tuple<"?">
      %702 = cute.get_scalars(%e3_1480) : !cute.int_tuple<"?{div=8}">
      %lay_1481 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %703 = cute.get_shape(%lay_1481) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1482, %e1_1483, %e2_1484, %e3_1485 = cute.get_leaves(%703) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1486 = cute.to_int_tuple(%e0_1482) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %704 = cute.get_scalars(%itup_1486) : !cute.int_tuple<"?">
      %itup_1487 = cute.to_int_tuple(%e1_1483) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %705 = cute.get_scalars(%itup_1487) : !cute.int_tuple<"?">
      %itup_1488 = cute.to_int_tuple(%e2_1484) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %706 = cute.get_scalars(%itup_1488) : !cute.int_tuple<"?">
      %itup_1489 = cute.to_int_tuple(%e3_1485) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %707 = cute.get_scalars(%itup_1489) : !cute.int_tuple<"?{div=8}">
      %coord_1490 = cute.make_coord(%e2_1479) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1491 = cute.make_coord(%itup_1489) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %708 = cute.elem_less(%coord_1490, %coord_1491) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %709 = arith.extui %690 : i1 to i32
      %710 = arith.cmpi ne, %709, %c0_i32 : i32
      %711 = arith.extui %690 : i1 to i32
      %712 = arith.extui %708 : i1 to i32
      %713 = arith.select %710, %712, %711 : i32
      %714 = arith.cmpi ne, %713, %c0_i32_1194 : i32
      scf.if %714 {
        %coord_2059 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,0,?)">
        %lay_2060 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2062 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_gmem_bf16_10
        %iter_2065 = cute.get_iter(%view_2064) : !memref_gmem_bf16_10
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2067 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2069 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_smem_bf16_14
        %iter_2072 = cute.get_iter(%view_2071) : !memref_smem_bf16_14
        %lay_2073 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %920 = cute.get_shape(%lay_2073) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2074, %e1_2075 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %lay_2076 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %921 = cute.get_shape(%lay_2076) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2077, %e1_2078 = cute.get_leaves(%921) : !cute.shape<"((8,1))">
        %lay_2079 = cute.get_layout(%view_2064) : !memref_gmem_bf16_10
        %shape_2080 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2081 = cute.make_layout() : !cute.layout<"1:0">
        %append_2082 = cute.append_to_rank<2> (%lay_2079, %lay_2081) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2083 = cute.make_view(%iter_2065, %append_2082) : !memref_gmem_bf16_11
        %iter_2084 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %lay_2085 = cute.get_layout(%view_2083) : !memref_gmem_bf16_11
        %922 = cute.get_shape(%lay_2085) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2086, %e1_2087, %e2_2088 = cute.get_leaves(%922) : !cute.shape<"((8,1),1)">
        %iter_2089 = cute.get_iter(%view_2083) : !memref_gmem_bf16_11
        %view_2090 = cute.make_view(%iter_2089) : !memref_gmem_bf16_12
        %iter_2091 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2092 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %lay_2093 = cute.get_layout(%view_2071) : !memref_smem_bf16_14
        %shape_2094 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2095 = cute.make_layout() : !cute.layout<"1:0">
        %append_2096 = cute.append_to_rank<2> (%lay_2093, %lay_2095) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2097 = cute.make_view(%iter_2072, %append_2096) : !memref_smem_bf16_15
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %lay_2099 = cute.get_layout(%view_2097) : !memref_smem_bf16_15
        %923 = cute.get_shape(%lay_2099) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2100, %e1_2101, %e2_2102 = cute.get_leaves(%923) : !cute.shape<"((8,1),1)">
        %iter_2103 = cute.get_iter(%view_2097) : !memref_smem_bf16_15
        %view_2104 = cute.make_view(%iter_2103) : !memref_smem_bf16_16
        %iter_2105 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %iter_2106 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2107 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %924 = cute.get_shape(%lay_2107) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2108, %e1_2109, %e2_2110 = cute.get_leaves(%924) : !cute.shape<"((8,1),(1))">
        %lay_2111 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %925 = cute.get_shape(%lay_2111) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2112, %e1_2113, %e2_2114 = cute.get_leaves(%925) : !cute.shape<"((8,1),(1))">
        %lay_2115 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %sz_2116 = cute.size(%lay_2115) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2117 = cute.get_leaves(%sz_2116) : !cute.int_tuple<"1">
        %lay_2118 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %sz_2119 = cute.size(%lay_2118) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2120 = cute.get_leaves(%sz_2119) : !cute.int_tuple<"1">
        %926 = cute.static : !cute.layout<"1:0">
        %iter_2121 = cute.get_iter(%view_2090) : !memref_gmem_bf16_12
        %iter_2122 = cute.get_iter(%view_2104) : !memref_smem_bf16_16
        %lay_2123 = cute.get_layout(%view_2090) : !memref_gmem_bf16_12
        %lay_2124 = cute.get_layout(%view_2104) : !memref_smem_bf16_16
        %append_2125 = cute.append_to_rank<2> (%lay_2123, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2126 = cute.append_to_rank<2> (%lay_2124, %926) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2127 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2128 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2129 = cute.size(%lay_2127) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %927 = cute.get_scalars(%sz_2129) : !cute.int_tuple<"1">
        %c0_i32_2130 = arith.constant 0 : i32
        %c1_i32_2131 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2130 to %927 step %c1_i32_2131  : i32 {
          %coord_2132 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2133 = cute.slice(%lay_2127, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2134 = cute.crd2idx(%coord_2132, %lay_2127) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2135 = cute.add_offset(%iter_2121, %idx_2134) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2136 = cute.make_view(%ptr_2135, %slice_2133) : !memref_gmem_bf16_10
          %slice_2137 = cute.slice(%lay_2128, %coord_2132) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2138 = cute.crd2idx(%coord_2132, %lay_2128) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2139 = cute.add_offset(%iter_2122, %idx_2138) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2140 = cute.make_view(%ptr_2139, %slice_2137) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2136, %view_2140) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2060 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2062 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_smem_bf16_14
        %iter_2065 = cute.get_iter(%view_2064) : !memref_smem_bf16_14
        %lay_2066 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %sz_2067 = cute.size(%lay_2066) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2068 = cute.get_leaves(%sz_2067) : !cute.int_tuple<"8">
        %lay_2069 = cute.get_layout(%view_2064) : !memref_smem_bf16_14
        %920 = cute.get_shape(%lay_2069) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2070, %e1_2071 = cute.get_leaves(%920) : !cute.shape<"((8,1))">
        %int_tuple_2072 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2073 = cute.tuple.product(%int_tuple_2072) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2074 = cute.get_leaves(%res_2073) : !cute.int_tuple<"8">
        %cst_2075 = arith.constant 0.000000e+00 : bf16
        %921 = vector.splat %cst_2075 : vector<8xbf16>
        %int_tuple_2076 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2077 = cute.size(%int_tuple_2076) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2078 = cute.get_leaves(%sz_2077) : !cute.int_tuple<"8">
        %int_tuple_2079 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2080 = cute.size(%int_tuple_2079) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2081 = cute.get_leaves(%sz_2080) : !cute.int_tuple<"8">
        cute.memref.store_vec %921, %view_2064, row_major : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %int_tuple_1492 = cute.make_int_tuple() : () -> !cute.int_tuple<"-1">
      %tup_1493 = cute.add_offset(%sub_239, %int_tuple_1492) : (!cute.int_tuple<"?">, !cute.int_tuple<"-1">) -> !cute.int_tuple<"?">
      %715 = cute.get_scalars(%tup_1493) : !cute.int_tuple<"?">
      %716 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %717 = cute.get_shape(%716) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_1494, %e1_1495, %e2_1496, %e3_1497 = cute.get_leaves(%717) : !cute.shape<"(32,4,1,1)">
      %718 = cute.get_stride(%716) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_1498, %e1_1499, %e2_1500, %e3_1501 = cute.get_leaves(%718) : !cute.stride<"(1,32,0,0)">
      %719 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_1502, %e1_1503, %e2_1504 = cute.get_leaves(%719) : !cute.tile<"[64:1;16:1;16:1]">
      %720 = cute.get_shape(%e0_1502) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_1505 = cute.get_leaves(%720) : !cute.shape<"64">
      %721 = cute.get_stride(%e0_1502) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_1506 = cute.get_leaves(%721) : !cute.stride<"1">
      %722 = cute.get_shape(%e1_1503) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_1507 = cute.get_leaves(%722) : !cute.shape<"16">
      %723 = cute.get_stride(%e1_1503) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_1508 = cute.get_leaves(%723) : !cute.stride<"1">
      %724 = cute.get_shape(%e2_1504) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_1509 = cute.get_leaves(%724) : !cute.shape<"16">
      %725 = cute.get_stride(%e2_1504) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_1510 = cute.get_leaves(%725) : !cute.stride<"1">
      %726 = cute.static : !cute.layout<"32:1">
      %727 = cute.get_shape(%726) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_1511 = cute.get_leaves(%727) : !cute.shape<"32">
      %728 = cute.get_stride(%726) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_1512 = cute.get_leaves(%728) : !cute.stride<"1">
      %729 = cute.static : !cute.shape<"(16,8,16)">
      %e0_1513, %e1_1514, %e2_1515 = cute.get_leaves(%729) : !cute.shape<"(16,8,16)">
      %730 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %731 = cute.get_shape(%730) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_1516, %e1_1517, %e2_1518, %e3_1519, %e4_1520 = cute.get_leaves(%731) : !cute.shape<"((4,8),(2,2,2))">
      %732 = cute.get_stride(%730) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_1521, %e1_1522, %e2_1523, %e3_1524, %e4_1525 = cute.get_leaves(%732) : !cute.stride<"((32,1),(16,8,128))">
      %733 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %734 = cute.get_shape(%733) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_1526, %e1_1527, %e2_1528, %e3_1529 = cute.get_leaves(%734) : !cute.shape<"((4,8),(2,2))">
      %735 = cute.get_stride(%733) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_1530, %e1_1531, %e2_1532, %e3_1533 = cute.get_leaves(%735) : !cute.stride<"((16,1),(8,64))">
      %736 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %737 = cute.get_shape(%736) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_1534, %e1_1535, %e2_1536, %e3_1537 = cute.get_leaves(%737) : !cute.shape<"((4,8),(2,2))">
      %738 = cute.get_stride(%736) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_1538, %e1_1539, %e2_1540, %e3_1541 = cute.get_leaves(%738) : !cute.stride<"((32,1),(16,8))">
      %739 = cute.static : !cute.tile<"[64:1;16:1]">
      %e0_1542, %e1_1543 = cute.get_leaves(%739) : !cute.tile<"[64:1;16:1]">
      %740 = cute.get_shape(%e0_1542) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_1544 = cute.get_leaves(%740) : !cute.shape<"64">
      %741 = cute.get_stride(%e0_1542) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_1545 = cute.get_leaves(%741) : !cute.stride<"1">
      %742 = cute.get_shape(%e1_1543) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_1546 = cute.get_leaves(%742) : !cute.shape<"16">
      %743 = cute.get_stride(%e1_1543) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_1547 = cute.get_leaves(%743) : !cute.stride<"1">
      %744 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %745 = cute.get_shape(%744) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %e0_1548, %e1_1549, %e2_1550, %e3_1551, %e4_1552, %e5, %e6 = cute.get_leaves(%745) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %746 = cute.get_stride(%744) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %e0_1553, %e1_1554, %e2_1555, %e3_1556, %e4_1557, %e5_1558, %e6_1559 = cute.get_leaves(%746) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %747 = cute.static : !cute.layout<"32:1">
      %748 = cute.get_shape(%747) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_1560 = cute.get_leaves(%748) : !cute.shape<"32">
      %749 = cute.get_stride(%747) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_1561 = cute.get_leaves(%749) : !cute.stride<"1">
      %750 = cute.static : !cute.layout<"(32,8):(8,1)">
      %751 = cute.get_shape(%750) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
      %e0_1562, %e1_1563 = cute.get_leaves(%751) : !cute.shape<"(32,8)">
      %752 = cute.get_stride(%750) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
      %e0_1564, %e1_1565 = cute.get_leaves(%752) : !cute.stride<"(8,1)">
      %753 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
      %754 = cute.get_shape(%753) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
      %e0_1566, %e1_1567, %e2_1568 = cute.get_leaves(%754) : !cute.shape<"(32,(2,4))">
      %755 = cute.get_stride(%753) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
      %e0_1569, %e1_1570, %e2_1571 = cute.get_leaves(%755) : !cute.stride<"(2,(1,64))">
      %c-1_i32 = arith.constant -1 : i32
      %c1_i32 = arith.constant 1 : i32
      %756:2 = scf.for %arg5 = %c-1_i32 to %153 step %c1_i32 iter_args(%arg6 = %6, %arg7 = %191) -> (!mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3)  : i32 {
        %int_tuple_2059 = cute.make_int_tuple(%arg5) : (i32) -> !cute.int_tuple<"?">
        %sub_2060 = cute.tuple_sub(%tup_1493, %int_tuple_2059) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
        %920 = cute.get_scalars(%sub_2060) : !cute.int_tuple<"?">
        nvvm.cp.async.wait.group 0
        %c1_i32_2061 = arith.constant 1 : i32
        %c128_i32_2062 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_2061 number_of_threads = %c128_i32_2062
        %921 = arith.cmpi eq, %920, %153 : i32
        scf.if %921 {
          %lay_3259 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
          %1143 = cute.get_shape(%lay_3259) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3260, %e1_3261, %e2_3262, %e3_3263 = cute.get_leaves(%1143) : !cute.shape<"((8,1),4,2)">
          %int_tuple_3264 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_3265 = cute.size(%int_tuple_3264) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_3266 = cute.get_leaves(%sz_3265) : !cute.int_tuple<"4">
          %coord_3267 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3268 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3269 = cute.crd2idx(%coord_3267, %lay_3268) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_3270 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3271 = cute.add_offset(%iter_3270, %idx_3269) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3272 = cute.make_view(%tup_3271) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3273 = cute.get_iter(%view_3272) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3274, %e1_3275, %e2_3276, %e3_3277 = cute.get_leaves(%iter_3273) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1144 = cute.get_scalars(%e0_3274) : !cute.int_tuple<"?">
          %1145 = cute.get_scalars(%e1_3275) : !cute.int_tuple<"?">
          %1146 = cute.get_scalars(%e2_3276) : !cute.int_tuple<"?">
          %1147 = cute.get_scalars(%e3_3277) : !cute.int_tuple<"?{div=8}">
          %iter_3278 = cute.get_iter(%view_3272) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3279, %e1_3280, %e2_3281, %e3_3282 = cute.get_leaves(%iter_3278) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1148 = cute.get_scalars(%e0_3279) : !cute.int_tuple<"?">
          %1149 = cute.get_scalars(%e1_3280) : !cute.int_tuple<"?">
          %1150 = cute.get_scalars(%e2_3281) : !cute.int_tuple<"?">
          %1151 = cute.get_scalars(%e3_3282) : !cute.int_tuple<"?{div=8}">
          %iter_3283 = cute.get_iter(%view_3272) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3284, %e1_3285, %e2_3286, %e3_3287 = cute.get_leaves(%iter_3283) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1152 = cute.get_scalars(%e0_3284) : !cute.int_tuple<"?">
          %1153 = cute.get_scalars(%e1_3285) : !cute.int_tuple<"?">
          %1154 = cute.get_scalars(%e2_3286) : !cute.int_tuple<"?">
          %1155 = cute.get_scalars(%e3_3287) : !cute.int_tuple<"?{div=8}">
          %lay_3288 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1156 = cute.get_shape(%lay_3288) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3289, %e1_3290, %e2_3291, %e3_3292 = cute.get_leaves(%1156) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3293 = cute.to_int_tuple(%e0_3289) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1157 = cute.get_scalars(%itup_3293) : !cute.int_tuple<"?">
          %itup_3294 = cute.to_int_tuple(%e1_3290) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1158 = cute.get_scalars(%itup_3294) : !cute.int_tuple<"?">
          %itup_3295 = cute.to_int_tuple(%e2_3291) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1159 = cute.get_scalars(%itup_3295) : !cute.int_tuple<"?">
          %itup_3296 = cute.to_int_tuple(%e3_3292) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1160 = cute.get_scalars(%itup_3296) : !cute.int_tuple<"?{div=8}">
          %coord_3297 = cute.make_coord(%e1_3285) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3298 = cute.make_coord(%itup_3294) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1161 = cute.elem_less(%coord_3297, %coord_3298) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1161 {
            %coord_3395 = cute.make_coord(%sub_2060) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_3396 = cute.get_layout(%src_partitioned_373) : !memref_gmem_bf16_6
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_3398 = cute.get_iter(%src_partitioned_373) : !memref_gmem_bf16_6
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_gmem_bf16_8
            %iter_3401 = cute.get_iter(%view_3400) : !memref_gmem_bf16_8
            %coord_3402 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3403 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3404 = cute.crd2idx(%coord_3402, %lay_3403) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_3405 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3406 = cute.add_offset(%iter_3405, %idx_3404) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3407 = cute.make_view(%ptr_3406) : !memref_smem_bf16_12
            %iter_3408 = cute.get_iter(%view_3407) : !memref_smem_bf16_12
            %coord_3409 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3410 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
            %idx_3411 = cute.crd2idx(%coord_3409, %lay_3410) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3412 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
            %ptr_3413 = cute.add_offset(%iter_3412, %idx_3411) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3414 = cute.make_view(%ptr_3413) : !memref_rmem_i8_1
            %iter_3415 = cute.get_iter(%view_3414) : !memref_rmem_i8_1
            %lay_3416 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %1216 = cute.get_shape(%lay_3416) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3417, %e1_3418, %e2_3419 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %lay_3420 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %1217 = cute.get_shape(%lay_3420) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3421, %e1_3422, %e2_3423 = cute.get_leaves(%1217) : !cute.shape<"((8,1),2)">
            %lay_3424 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %shape_3425 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3426 = cute.make_layout() : !cute.layout<"1:0">
            %append_3427 = cute.append_to_rank<2> (%lay_3424, %lay_3426) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3428 = cute.make_view(%iter_3401, %append_3427) : !memref_gmem_bf16_8
            %iter_3429 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %lay_3430 = cute.get_layout(%view_3428) : !memref_gmem_bf16_8
            %1218 = cute.get_shape(%lay_3430) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3431, %e1_3432, %e2_3433 = cute.get_leaves(%1218) : !cute.shape<"((8,1),2)">
            %iter_3434 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %view_3435 = cute.make_view(%iter_3434) : !memref_gmem_bf16_9
            %iter_3436 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3437 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %lay_3438 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %shape_3439 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3440 = cute.make_layout() : !cute.layout<"1:0">
            %append_3441 = cute.append_to_rank<2> (%lay_3438, %lay_3440) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3442 = cute.make_view(%iter_3408, %append_3441) : !memref_smem_bf16_12
            %iter_3443 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %lay_3444 = cute.get_layout(%view_3442) : !memref_smem_bf16_12
            %1219 = cute.get_shape(%lay_3444) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3445, %e1_3446, %e2_3447 = cute.get_leaves(%1219) : !cute.shape<"((8,1),2)">
            %iter_3448 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %view_3449 = cute.make_view(%iter_3448) : !memref_smem_bf16_13
            %iter_3450 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %iter_3451 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3452 = cute.get_layout(%view_3414) : !memref_rmem_i8_1
            %shape_3453 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3454 = cute.make_layout() : !cute.layout<"1:0">
            %append_3455 = cute.append_to_rank<2> (%lay_3452, %lay_3454) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3456 = cute.make_view(%iter_3415, %append_3455) : !memref_rmem_i8_1
            %iter_3457 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %lay_3458 = cute.get_layout(%view_3456) : !memref_rmem_i8_1
            %1220 = cute.get_shape(%lay_3458) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3459, %e1_3460 = cute.get_leaves(%1220) : !cute.shape<"(1,2)">
            %iter_3461 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %view_3462 = cute.make_view(%iter_3461) : !memref_rmem_i8_2
            %iter_3463 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %iter_3464 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3465 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %1221 = cute.get_shape(%lay_3465) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3466, %e1_3467, %e2_3468 = cute.get_leaves(%1221) : !cute.shape<"((8,1),(2))">
            %lay_3469 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %1222 = cute.get_shape(%lay_3469) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3470, %e1_3471, %e2_3472 = cute.get_leaves(%1222) : !cute.shape<"((8,1),(2))">
            %lay_3473 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %sz_3474 = cute.size(%lay_3473) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3475 = cute.get_leaves(%sz_3474) : !cute.int_tuple<"2">
            %lay_3476 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %sz_3477 = cute.size(%lay_3476) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3478 = cute.get_leaves(%sz_3477) : !cute.int_tuple<"2">
            %1223 = cute.static : !cute.layout<"1:0">
            %iter_3479 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3480 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3481 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %lay_3482 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %append_3483 = cute.append_to_rank<2> (%lay_3481, %1223) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3484 = cute.append_to_rank<2> (%lay_3482, %1223) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3485 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3486 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3487 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3488 = cute.get_layout(%view_3462) : !memref_rmem_i8_2
            %append_3489 = cute.append_to_rank<2> (%lay_3488, %1223) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3490 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3491 = cute.size(%lay_3485) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1224 = cute.get_scalars(%sz_3491) : !cute.int_tuple<"2">
            %c0_i32_3492 = arith.constant 0 : i32
            %c1_i32_3493 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3492 to %1224 step %c1_i32_3493  : i32 {
              %coord_3494 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3495 = cute.slice(%lay_3485, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3496 = cute.crd2idx(%coord_3494, %lay_3485) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3497 = cute.add_offset(%iter_3479, %idx_3496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3498 = cute.make_view(%ptr_3497, %slice_3495) : !memref_gmem_bf16_10
              %slice_3499 = cute.slice(%lay_3486, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3500 = cute.crd2idx(%coord_3494, %lay_3486) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3501 = cute.add_offset(%iter_3480, %idx_3500) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3502 = cute.make_view(%ptr_3501, %slice_3499) : !memref_smem_bf16_14
              %slice_3503 = cute.slice(%lay_3490, %coord_3494) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3504 = cute.crd2idx(%coord_3494, %lay_3490) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3505 = cute.add_offset(%iter_3487, %idx_3504) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3506 = cute.make_view(%ptr_3505, %slice_3503) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3498, %view_3502, %view_3506) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3395 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3396 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_3398 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_smem_bf16_12
            %iter_3401 = cute.get_iter(%view_3400) : !memref_smem_bf16_12
            %lay_3402 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %sz_3403 = cute.size(%lay_3402) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3404 = cute.get_leaves(%sz_3403) : !cute.int_tuple<"16">
            %lay_3405 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %1216 = cute.get_shape(%lay_3405) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3406, %e1_3407, %e2_3408 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %int_tuple_3409 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3410 = cute.tuple.product(%int_tuple_3409) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3411 = cute.get_leaves(%res_3410) : !cute.int_tuple<"16">
            %cst_3412 = arith.constant 0.000000e+00 : bf16
            %1217 = vector.splat %cst_3412 : vector<16xbf16>
            %int_tuple_3413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3414 = cute.size(%int_tuple_3413) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3415 = cute.get_leaves(%sz_3414) : !cute.int_tuple<"16">
            %int_tuple_3416 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3417 = cute.size(%int_tuple_3416) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3418 = cute.get_leaves(%sz_3417) : !cute.int_tuple<"16">
            cute.memref.store_vec %1217, %view_3400, row_major : !memref_smem_bf16_12
          }
          %coord_3299 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_3300 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3301 = cute.crd2idx(%coord_3299, %lay_3300) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_3302 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3303 = cute.add_offset(%iter_3302, %idx_3301) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3304 = cute.make_view(%tup_3303) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3305 = cute.get_iter(%view_3304) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3306, %e1_3307, %e2_3308, %e3_3309 = cute.get_leaves(%iter_3305) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1162 = cute.get_scalars(%e0_3306) : !cute.int_tuple<"?">
          %1163 = cute.get_scalars(%e1_3307) : !cute.int_tuple<"?">
          %1164 = cute.get_scalars(%e2_3308) : !cute.int_tuple<"?">
          %1165 = cute.get_scalars(%e3_3309) : !cute.int_tuple<"?{div=8}">
          %iter_3310 = cute.get_iter(%view_3304) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3311, %e1_3312, %e2_3313, %e3_3314 = cute.get_leaves(%iter_3310) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1166 = cute.get_scalars(%e0_3311) : !cute.int_tuple<"?">
          %1167 = cute.get_scalars(%e1_3312) : !cute.int_tuple<"?">
          %1168 = cute.get_scalars(%e2_3313) : !cute.int_tuple<"?">
          %1169 = cute.get_scalars(%e3_3314) : !cute.int_tuple<"?{div=8}">
          %iter_3315 = cute.get_iter(%view_3304) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3316, %e1_3317, %e2_3318, %e3_3319 = cute.get_leaves(%iter_3315) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1170 = cute.get_scalars(%e0_3316) : !cute.int_tuple<"?">
          %1171 = cute.get_scalars(%e1_3317) : !cute.int_tuple<"?">
          %1172 = cute.get_scalars(%e2_3318) : !cute.int_tuple<"?">
          %1173 = cute.get_scalars(%e3_3319) : !cute.int_tuple<"?{div=8}">
          %lay_3320 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1174 = cute.get_shape(%lay_3320) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3321, %e1_3322, %e2_3323, %e3_3324 = cute.get_leaves(%1174) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3325 = cute.to_int_tuple(%e0_3321) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1175 = cute.get_scalars(%itup_3325) : !cute.int_tuple<"?">
          %itup_3326 = cute.to_int_tuple(%e1_3322) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1176 = cute.get_scalars(%itup_3326) : !cute.int_tuple<"?">
          %itup_3327 = cute.to_int_tuple(%e2_3323) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1177 = cute.get_scalars(%itup_3327) : !cute.int_tuple<"?">
          %itup_3328 = cute.to_int_tuple(%e3_3324) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1178 = cute.get_scalars(%itup_3328) : !cute.int_tuple<"?{div=8}">
          %coord_3329 = cute.make_coord(%e1_3317) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3330 = cute.make_coord(%itup_3326) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1179 = cute.elem_less(%coord_3329, %coord_3330) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1179 {
            %coord_3395 = cute.make_coord(%sub_2060) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_3396 = cute.get_layout(%src_partitioned_373) : !memref_gmem_bf16_6
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_3398 = cute.get_iter(%src_partitioned_373) : !memref_gmem_bf16_6
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_gmem_bf16_8
            %iter_3401 = cute.get_iter(%view_3400) : !memref_gmem_bf16_8
            %coord_3402 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3403 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3404 = cute.crd2idx(%coord_3402, %lay_3403) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_3405 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3406 = cute.add_offset(%iter_3405, %idx_3404) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3407 = cute.make_view(%ptr_3406) : !memref_smem_bf16_12
            %iter_3408 = cute.get_iter(%view_3407) : !memref_smem_bf16_12
            %coord_3409 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3410 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
            %idx_3411 = cute.crd2idx(%coord_3409, %lay_3410) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3412 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
            %ptr_3413 = cute.add_offset(%iter_3412, %idx_3411) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3414 = cute.make_view(%ptr_3413) : !memref_rmem_i8_1
            %iter_3415 = cute.get_iter(%view_3414) : !memref_rmem_i8_1
            %lay_3416 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %1216 = cute.get_shape(%lay_3416) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3417, %e1_3418, %e2_3419 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %lay_3420 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %1217 = cute.get_shape(%lay_3420) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3421, %e1_3422, %e2_3423 = cute.get_leaves(%1217) : !cute.shape<"((8,1),2)">
            %lay_3424 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %shape_3425 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3426 = cute.make_layout() : !cute.layout<"1:0">
            %append_3427 = cute.append_to_rank<2> (%lay_3424, %lay_3426) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3428 = cute.make_view(%iter_3401, %append_3427) : !memref_gmem_bf16_8
            %iter_3429 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %lay_3430 = cute.get_layout(%view_3428) : !memref_gmem_bf16_8
            %1218 = cute.get_shape(%lay_3430) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3431, %e1_3432, %e2_3433 = cute.get_leaves(%1218) : !cute.shape<"((8,1),2)">
            %iter_3434 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %view_3435 = cute.make_view(%iter_3434) : !memref_gmem_bf16_9
            %iter_3436 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3437 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %lay_3438 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %shape_3439 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3440 = cute.make_layout() : !cute.layout<"1:0">
            %append_3441 = cute.append_to_rank<2> (%lay_3438, %lay_3440) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3442 = cute.make_view(%iter_3408, %append_3441) : !memref_smem_bf16_12
            %iter_3443 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %lay_3444 = cute.get_layout(%view_3442) : !memref_smem_bf16_12
            %1219 = cute.get_shape(%lay_3444) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3445, %e1_3446, %e2_3447 = cute.get_leaves(%1219) : !cute.shape<"((8,1),2)">
            %iter_3448 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %view_3449 = cute.make_view(%iter_3448) : !memref_smem_bf16_13
            %iter_3450 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %iter_3451 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3452 = cute.get_layout(%view_3414) : !memref_rmem_i8_1
            %shape_3453 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3454 = cute.make_layout() : !cute.layout<"1:0">
            %append_3455 = cute.append_to_rank<2> (%lay_3452, %lay_3454) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3456 = cute.make_view(%iter_3415, %append_3455) : !memref_rmem_i8_1
            %iter_3457 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %lay_3458 = cute.get_layout(%view_3456) : !memref_rmem_i8_1
            %1220 = cute.get_shape(%lay_3458) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3459, %e1_3460 = cute.get_leaves(%1220) : !cute.shape<"(1,2)">
            %iter_3461 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %view_3462 = cute.make_view(%iter_3461) : !memref_rmem_i8_2
            %iter_3463 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %iter_3464 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3465 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %1221 = cute.get_shape(%lay_3465) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3466, %e1_3467, %e2_3468 = cute.get_leaves(%1221) : !cute.shape<"((8,1),(2))">
            %lay_3469 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %1222 = cute.get_shape(%lay_3469) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3470, %e1_3471, %e2_3472 = cute.get_leaves(%1222) : !cute.shape<"((8,1),(2))">
            %lay_3473 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %sz_3474 = cute.size(%lay_3473) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3475 = cute.get_leaves(%sz_3474) : !cute.int_tuple<"2">
            %lay_3476 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %sz_3477 = cute.size(%lay_3476) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3478 = cute.get_leaves(%sz_3477) : !cute.int_tuple<"2">
            %1223 = cute.static : !cute.layout<"1:0">
            %iter_3479 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3480 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3481 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %lay_3482 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %append_3483 = cute.append_to_rank<2> (%lay_3481, %1223) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3484 = cute.append_to_rank<2> (%lay_3482, %1223) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3485 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3486 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3487 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3488 = cute.get_layout(%view_3462) : !memref_rmem_i8_2
            %append_3489 = cute.append_to_rank<2> (%lay_3488, %1223) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3490 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3491 = cute.size(%lay_3485) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1224 = cute.get_scalars(%sz_3491) : !cute.int_tuple<"2">
            %c0_i32_3492 = arith.constant 0 : i32
            %c1_i32_3493 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3492 to %1224 step %c1_i32_3493  : i32 {
              %coord_3494 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3495 = cute.slice(%lay_3485, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3496 = cute.crd2idx(%coord_3494, %lay_3485) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3497 = cute.add_offset(%iter_3479, %idx_3496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3498 = cute.make_view(%ptr_3497, %slice_3495) : !memref_gmem_bf16_10
              %slice_3499 = cute.slice(%lay_3486, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3500 = cute.crd2idx(%coord_3494, %lay_3486) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3501 = cute.add_offset(%iter_3480, %idx_3500) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3502 = cute.make_view(%ptr_3501, %slice_3499) : !memref_smem_bf16_14
              %slice_3503 = cute.slice(%lay_3490, %coord_3494) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3504 = cute.crd2idx(%coord_3494, %lay_3490) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3505 = cute.add_offset(%iter_3487, %idx_3504) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3506 = cute.make_view(%ptr_3505, %slice_3503) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3498, %view_3502, %view_3506) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3395 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3396 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_3398 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_smem_bf16_12
            %iter_3401 = cute.get_iter(%view_3400) : !memref_smem_bf16_12
            %lay_3402 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %sz_3403 = cute.size(%lay_3402) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3404 = cute.get_leaves(%sz_3403) : !cute.int_tuple<"16">
            %lay_3405 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %1216 = cute.get_shape(%lay_3405) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3406, %e1_3407, %e2_3408 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %int_tuple_3409 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3410 = cute.tuple.product(%int_tuple_3409) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3411 = cute.get_leaves(%res_3410) : !cute.int_tuple<"16">
            %cst_3412 = arith.constant 0.000000e+00 : bf16
            %1217 = vector.splat %cst_3412 : vector<16xbf16>
            %int_tuple_3413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3414 = cute.size(%int_tuple_3413) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3415 = cute.get_leaves(%sz_3414) : !cute.int_tuple<"16">
            %int_tuple_3416 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3417 = cute.size(%int_tuple_3416) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3418 = cute.get_leaves(%sz_3417) : !cute.int_tuple<"16">
            cute.memref.store_vec %1217, %view_3400, row_major : !memref_smem_bf16_12
          }
          %coord_3331 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_3332 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3333 = cute.crd2idx(%coord_3331, %lay_3332) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_3334 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3335 = cute.add_offset(%iter_3334, %idx_3333) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3336 = cute.make_view(%tup_3335) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3337 = cute.get_iter(%view_3336) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3338, %e1_3339, %e2_3340, %e3_3341 = cute.get_leaves(%iter_3337) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1180 = cute.get_scalars(%e0_3338) : !cute.int_tuple<"?">
          %1181 = cute.get_scalars(%e1_3339) : !cute.int_tuple<"?">
          %1182 = cute.get_scalars(%e2_3340) : !cute.int_tuple<"?">
          %1183 = cute.get_scalars(%e3_3341) : !cute.int_tuple<"?{div=8}">
          %iter_3342 = cute.get_iter(%view_3336) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%iter_3342) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1184 = cute.get_scalars(%e0_3343) : !cute.int_tuple<"?">
          %1185 = cute.get_scalars(%e1_3344) : !cute.int_tuple<"?">
          %1186 = cute.get_scalars(%e2_3345) : !cute.int_tuple<"?">
          %1187 = cute.get_scalars(%e3_3346) : !cute.int_tuple<"?{div=8}">
          %iter_3347 = cute.get_iter(%view_3336) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3348, %e1_3349, %e2_3350, %e3_3351 = cute.get_leaves(%iter_3347) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1188 = cute.get_scalars(%e0_3348) : !cute.int_tuple<"?">
          %1189 = cute.get_scalars(%e1_3349) : !cute.int_tuple<"?">
          %1190 = cute.get_scalars(%e2_3350) : !cute.int_tuple<"?">
          %1191 = cute.get_scalars(%e3_3351) : !cute.int_tuple<"?{div=8}">
          %lay_3352 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1192 = cute.get_shape(%lay_3352) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1192) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3357 = cute.to_int_tuple(%e0_3353) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1193 = cute.get_scalars(%itup_3357) : !cute.int_tuple<"?">
          %itup_3358 = cute.to_int_tuple(%e1_3354) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1194 = cute.get_scalars(%itup_3358) : !cute.int_tuple<"?">
          %itup_3359 = cute.to_int_tuple(%e2_3355) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1195 = cute.get_scalars(%itup_3359) : !cute.int_tuple<"?">
          %itup_3360 = cute.to_int_tuple(%e3_3356) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1196 = cute.get_scalars(%itup_3360) : !cute.int_tuple<"?{div=8}">
          %coord_3361 = cute.make_coord(%e1_3349) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3362 = cute.make_coord(%itup_3358) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1197 = cute.elem_less(%coord_3361, %coord_3362) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1197 {
            %coord_3395 = cute.make_coord(%sub_2060) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_3396 = cute.get_layout(%src_partitioned_373) : !memref_gmem_bf16_6
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_3398 = cute.get_iter(%src_partitioned_373) : !memref_gmem_bf16_6
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_gmem_bf16_8
            %iter_3401 = cute.get_iter(%view_3400) : !memref_gmem_bf16_8
            %coord_3402 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3403 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3404 = cute.crd2idx(%coord_3402, %lay_3403) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_3405 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3406 = cute.add_offset(%iter_3405, %idx_3404) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3407 = cute.make_view(%ptr_3406) : !memref_smem_bf16_12
            %iter_3408 = cute.get_iter(%view_3407) : !memref_smem_bf16_12
            %coord_3409 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3410 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
            %idx_3411 = cute.crd2idx(%coord_3409, %lay_3410) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3412 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
            %ptr_3413 = cute.add_offset(%iter_3412, %idx_3411) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3414 = cute.make_view(%ptr_3413) : !memref_rmem_i8_1
            %iter_3415 = cute.get_iter(%view_3414) : !memref_rmem_i8_1
            %lay_3416 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %1216 = cute.get_shape(%lay_3416) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3417, %e1_3418, %e2_3419 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %lay_3420 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %1217 = cute.get_shape(%lay_3420) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3421, %e1_3422, %e2_3423 = cute.get_leaves(%1217) : !cute.shape<"((8,1),2)">
            %lay_3424 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %shape_3425 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3426 = cute.make_layout() : !cute.layout<"1:0">
            %append_3427 = cute.append_to_rank<2> (%lay_3424, %lay_3426) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3428 = cute.make_view(%iter_3401, %append_3427) : !memref_gmem_bf16_8
            %iter_3429 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %lay_3430 = cute.get_layout(%view_3428) : !memref_gmem_bf16_8
            %1218 = cute.get_shape(%lay_3430) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3431, %e1_3432, %e2_3433 = cute.get_leaves(%1218) : !cute.shape<"((8,1),2)">
            %iter_3434 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %view_3435 = cute.make_view(%iter_3434) : !memref_gmem_bf16_9
            %iter_3436 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3437 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %lay_3438 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %shape_3439 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3440 = cute.make_layout() : !cute.layout<"1:0">
            %append_3441 = cute.append_to_rank<2> (%lay_3438, %lay_3440) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3442 = cute.make_view(%iter_3408, %append_3441) : !memref_smem_bf16_12
            %iter_3443 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %lay_3444 = cute.get_layout(%view_3442) : !memref_smem_bf16_12
            %1219 = cute.get_shape(%lay_3444) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3445, %e1_3446, %e2_3447 = cute.get_leaves(%1219) : !cute.shape<"((8,1),2)">
            %iter_3448 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %view_3449 = cute.make_view(%iter_3448) : !memref_smem_bf16_13
            %iter_3450 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %iter_3451 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3452 = cute.get_layout(%view_3414) : !memref_rmem_i8_1
            %shape_3453 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3454 = cute.make_layout() : !cute.layout<"1:0">
            %append_3455 = cute.append_to_rank<2> (%lay_3452, %lay_3454) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3456 = cute.make_view(%iter_3415, %append_3455) : !memref_rmem_i8_1
            %iter_3457 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %lay_3458 = cute.get_layout(%view_3456) : !memref_rmem_i8_1
            %1220 = cute.get_shape(%lay_3458) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3459, %e1_3460 = cute.get_leaves(%1220) : !cute.shape<"(1,2)">
            %iter_3461 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %view_3462 = cute.make_view(%iter_3461) : !memref_rmem_i8_2
            %iter_3463 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %iter_3464 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3465 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %1221 = cute.get_shape(%lay_3465) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3466, %e1_3467, %e2_3468 = cute.get_leaves(%1221) : !cute.shape<"((8,1),(2))">
            %lay_3469 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %1222 = cute.get_shape(%lay_3469) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3470, %e1_3471, %e2_3472 = cute.get_leaves(%1222) : !cute.shape<"((8,1),(2))">
            %lay_3473 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %sz_3474 = cute.size(%lay_3473) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3475 = cute.get_leaves(%sz_3474) : !cute.int_tuple<"2">
            %lay_3476 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %sz_3477 = cute.size(%lay_3476) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3478 = cute.get_leaves(%sz_3477) : !cute.int_tuple<"2">
            %1223 = cute.static : !cute.layout<"1:0">
            %iter_3479 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3480 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3481 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %lay_3482 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %append_3483 = cute.append_to_rank<2> (%lay_3481, %1223) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3484 = cute.append_to_rank<2> (%lay_3482, %1223) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3485 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3486 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3487 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3488 = cute.get_layout(%view_3462) : !memref_rmem_i8_2
            %append_3489 = cute.append_to_rank<2> (%lay_3488, %1223) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3490 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3491 = cute.size(%lay_3485) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1224 = cute.get_scalars(%sz_3491) : !cute.int_tuple<"2">
            %c0_i32_3492 = arith.constant 0 : i32
            %c1_i32_3493 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3492 to %1224 step %c1_i32_3493  : i32 {
              %coord_3494 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3495 = cute.slice(%lay_3485, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3496 = cute.crd2idx(%coord_3494, %lay_3485) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3497 = cute.add_offset(%iter_3479, %idx_3496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3498 = cute.make_view(%ptr_3497, %slice_3495) : !memref_gmem_bf16_10
              %slice_3499 = cute.slice(%lay_3486, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3500 = cute.crd2idx(%coord_3494, %lay_3486) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3501 = cute.add_offset(%iter_3480, %idx_3500) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3502 = cute.make_view(%ptr_3501, %slice_3499) : !memref_smem_bf16_14
              %slice_3503 = cute.slice(%lay_3490, %coord_3494) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3504 = cute.crd2idx(%coord_3494, %lay_3490) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3505 = cute.add_offset(%iter_3487, %idx_3504) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3506 = cute.make_view(%ptr_3505, %slice_3503) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3498, %view_3502, %view_3506) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3395 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3396 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_3398 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_smem_bf16_12
            %iter_3401 = cute.get_iter(%view_3400) : !memref_smem_bf16_12
            %lay_3402 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %sz_3403 = cute.size(%lay_3402) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3404 = cute.get_leaves(%sz_3403) : !cute.int_tuple<"16">
            %lay_3405 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %1216 = cute.get_shape(%lay_3405) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3406, %e1_3407, %e2_3408 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %int_tuple_3409 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3410 = cute.tuple.product(%int_tuple_3409) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3411 = cute.get_leaves(%res_3410) : !cute.int_tuple<"16">
            %cst_3412 = arith.constant 0.000000e+00 : bf16
            %1217 = vector.splat %cst_3412 : vector<16xbf16>
            %int_tuple_3413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3414 = cute.size(%int_tuple_3413) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3415 = cute.get_leaves(%sz_3414) : !cute.int_tuple<"16">
            %int_tuple_3416 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3417 = cute.size(%int_tuple_3416) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3418 = cute.get_leaves(%sz_3417) : !cute.int_tuple<"16">
            cute.memref.store_vec %1217, %view_3400, row_major : !memref_smem_bf16_12
          }
          %coord_3363 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_3364 = cute.get_layout(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3365 = cute.crd2idx(%coord_3363, %lay_3364) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_3366 = cute.get_iter(%src_partitioned_630) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3367 = cute.add_offset(%iter_3366, %idx_3365) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3368 = cute.make_view(%tup_3367) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3369 = cute.get_iter(%view_3368) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3370, %e1_3371, %e2_3372, %e3_3373 = cute.get_leaves(%iter_3369) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1198 = cute.get_scalars(%e0_3370) : !cute.int_tuple<"?">
          %1199 = cute.get_scalars(%e1_3371) : !cute.int_tuple<"?">
          %1200 = cute.get_scalars(%e2_3372) : !cute.int_tuple<"?">
          %1201 = cute.get_scalars(%e3_3373) : !cute.int_tuple<"?{div=8}">
          %iter_3374 = cute.get_iter(%view_3368) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3375, %e1_3376, %e2_3377, %e3_3378 = cute.get_leaves(%iter_3374) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1202 = cute.get_scalars(%e0_3375) : !cute.int_tuple<"?">
          %1203 = cute.get_scalars(%e1_3376) : !cute.int_tuple<"?">
          %1204 = cute.get_scalars(%e2_3377) : !cute.int_tuple<"?">
          %1205 = cute.get_scalars(%e3_3378) : !cute.int_tuple<"?{div=8}">
          %iter_3379 = cute.get_iter(%view_3368) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3380, %e1_3381, %e2_3382, %e3_3383 = cute.get_leaves(%iter_3379) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1206 = cute.get_scalars(%e0_3380) : !cute.int_tuple<"?">
          %1207 = cute.get_scalars(%e1_3381) : !cute.int_tuple<"?">
          %1208 = cute.get_scalars(%e2_3382) : !cute.int_tuple<"?">
          %1209 = cute.get_scalars(%e3_3383) : !cute.int_tuple<"?{div=8}">
          %lay_3384 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1210 = cute.get_shape(%lay_3384) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3385, %e1_3386, %e2_3387, %e3_3388 = cute.get_leaves(%1210) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3389 = cute.to_int_tuple(%e0_3385) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1211 = cute.get_scalars(%itup_3389) : !cute.int_tuple<"?">
          %itup_3390 = cute.to_int_tuple(%e1_3386) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1212 = cute.get_scalars(%itup_3390) : !cute.int_tuple<"?">
          %itup_3391 = cute.to_int_tuple(%e2_3387) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1213 = cute.get_scalars(%itup_3391) : !cute.int_tuple<"?">
          %itup_3392 = cute.to_int_tuple(%e3_3388) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1214 = cute.get_scalars(%itup_3392) : !cute.int_tuple<"?{div=8}">
          %coord_3393 = cute.make_coord(%e1_3381) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3394 = cute.make_coord(%itup_3390) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1215 = cute.elem_less(%coord_3393, %coord_3394) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1215 {
            %coord_3395 = cute.make_coord(%sub_2060) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_3396 = cute.get_layout(%src_partitioned_373) : !memref_gmem_bf16_6
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_3398 = cute.get_iter(%src_partitioned_373) : !memref_gmem_bf16_6
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_gmem_bf16_8
            %iter_3401 = cute.get_iter(%view_3400) : !memref_gmem_bf16_8
            %coord_3402 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3403 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3404 = cute.crd2idx(%coord_3402, %lay_3403) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_3405 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3406 = cute.add_offset(%iter_3405, %idx_3404) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3407 = cute.make_view(%ptr_3406) : !memref_smem_bf16_12
            %iter_3408 = cute.get_iter(%view_3407) : !memref_smem_bf16_12
            %coord_3409 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3410 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
            %idx_3411 = cute.crd2idx(%coord_3409, %lay_3410) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3412 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
            %ptr_3413 = cute.add_offset(%iter_3412, %idx_3411) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3414 = cute.make_view(%ptr_3413) : !memref_rmem_i8_1
            %iter_3415 = cute.get_iter(%view_3414) : !memref_rmem_i8_1
            %lay_3416 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %1216 = cute.get_shape(%lay_3416) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3417, %e1_3418, %e2_3419 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %lay_3420 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %1217 = cute.get_shape(%lay_3420) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3421, %e1_3422, %e2_3423 = cute.get_leaves(%1217) : !cute.shape<"((8,1),2)">
            %lay_3424 = cute.get_layout(%view_3400) : !memref_gmem_bf16_8
            %shape_3425 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3426 = cute.make_layout() : !cute.layout<"1:0">
            %append_3427 = cute.append_to_rank<2> (%lay_3424, %lay_3426) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3428 = cute.make_view(%iter_3401, %append_3427) : !memref_gmem_bf16_8
            %iter_3429 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %lay_3430 = cute.get_layout(%view_3428) : !memref_gmem_bf16_8
            %1218 = cute.get_shape(%lay_3430) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3431, %e1_3432, %e2_3433 = cute.get_leaves(%1218) : !cute.shape<"((8,1),2)">
            %iter_3434 = cute.get_iter(%view_3428) : !memref_gmem_bf16_8
            %view_3435 = cute.make_view(%iter_3434) : !memref_gmem_bf16_9
            %iter_3436 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3437 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %lay_3438 = cute.get_layout(%view_3407) : !memref_smem_bf16_12
            %shape_3439 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3440 = cute.make_layout() : !cute.layout<"1:0">
            %append_3441 = cute.append_to_rank<2> (%lay_3438, %lay_3440) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3442 = cute.make_view(%iter_3408, %append_3441) : !memref_smem_bf16_12
            %iter_3443 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %lay_3444 = cute.get_layout(%view_3442) : !memref_smem_bf16_12
            %1219 = cute.get_shape(%lay_3444) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3445, %e1_3446, %e2_3447 = cute.get_leaves(%1219) : !cute.shape<"((8,1),2)">
            %iter_3448 = cute.get_iter(%view_3442) : !memref_smem_bf16_12
            %view_3449 = cute.make_view(%iter_3448) : !memref_smem_bf16_13
            %iter_3450 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %iter_3451 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3452 = cute.get_layout(%view_3414) : !memref_rmem_i8_1
            %shape_3453 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3454 = cute.make_layout() : !cute.layout<"1:0">
            %append_3455 = cute.append_to_rank<2> (%lay_3452, %lay_3454) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3456 = cute.make_view(%iter_3415, %append_3455) : !memref_rmem_i8_1
            %iter_3457 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %lay_3458 = cute.get_layout(%view_3456) : !memref_rmem_i8_1
            %1220 = cute.get_shape(%lay_3458) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3459, %e1_3460 = cute.get_leaves(%1220) : !cute.shape<"(1,2)">
            %iter_3461 = cute.get_iter(%view_3456) : !memref_rmem_i8_1
            %view_3462 = cute.make_view(%iter_3461) : !memref_rmem_i8_2
            %iter_3463 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %iter_3464 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3465 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %1221 = cute.get_shape(%lay_3465) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3466, %e1_3467, %e2_3468 = cute.get_leaves(%1221) : !cute.shape<"((8,1),(2))">
            %lay_3469 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %1222 = cute.get_shape(%lay_3469) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3470, %e1_3471, %e2_3472 = cute.get_leaves(%1222) : !cute.shape<"((8,1),(2))">
            %lay_3473 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %sz_3474 = cute.size(%lay_3473) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3475 = cute.get_leaves(%sz_3474) : !cute.int_tuple<"2">
            %lay_3476 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %sz_3477 = cute.size(%lay_3476) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3478 = cute.get_leaves(%sz_3477) : !cute.int_tuple<"2">
            %1223 = cute.static : !cute.layout<"1:0">
            %iter_3479 = cute.get_iter(%view_3435) : !memref_gmem_bf16_9
            %iter_3480 = cute.get_iter(%view_3449) : !memref_smem_bf16_13
            %lay_3481 = cute.get_layout(%view_3435) : !memref_gmem_bf16_9
            %lay_3482 = cute.get_layout(%view_3449) : !memref_smem_bf16_13
            %append_3483 = cute.append_to_rank<2> (%lay_3481, %1223) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3484 = cute.append_to_rank<2> (%lay_3482, %1223) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3485 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3486 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3487 = cute.get_iter(%view_3462) : !memref_rmem_i8_2
            %lay_3488 = cute.get_layout(%view_3462) : !memref_rmem_i8_2
            %append_3489 = cute.append_to_rank<2> (%lay_3488, %1223) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3490 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3491 = cute.size(%lay_3485) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1224 = cute.get_scalars(%sz_3491) : !cute.int_tuple<"2">
            %c0_i32_3492 = arith.constant 0 : i32
            %c1_i32_3493 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3492 to %1224 step %c1_i32_3493  : i32 {
              %coord_3494 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3495 = cute.slice(%lay_3485, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3496 = cute.crd2idx(%coord_3494, %lay_3485) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3497 = cute.add_offset(%iter_3479, %idx_3496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3498 = cute.make_view(%ptr_3497, %slice_3495) : !memref_gmem_bf16_10
              %slice_3499 = cute.slice(%lay_3486, %coord_3494) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3500 = cute.crd2idx(%coord_3494, %lay_3486) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3501 = cute.add_offset(%iter_3480, %idx_3500) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3502 = cute.make_view(%ptr_3501, %slice_3499) : !memref_smem_bf16_14
              %slice_3503 = cute.slice(%lay_3490, %coord_3494) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3504 = cute.crd2idx(%coord_3494, %lay_3490) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3505 = cute.add_offset(%iter_3487, %idx_3504) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3506 = cute.make_view(%ptr_3505, %slice_3503) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3498, %view_3502, %view_3506) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3395 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3396 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
            %idx_3397 = cute.crd2idx(%coord_3395, %lay_3396) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_3398 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
            %ptr_3399 = cute.add_offset(%iter_3398, %idx_3397) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3400 = cute.make_view(%ptr_3399) : !memref_smem_bf16_12
            %iter_3401 = cute.get_iter(%view_3400) : !memref_smem_bf16_12
            %lay_3402 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %sz_3403 = cute.size(%lay_3402) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3404 = cute.get_leaves(%sz_3403) : !cute.int_tuple<"16">
            %lay_3405 = cute.get_layout(%view_3400) : !memref_smem_bf16_12
            %1216 = cute.get_shape(%lay_3405) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3406, %e1_3407, %e2_3408 = cute.get_leaves(%1216) : !cute.shape<"((8,1),2)">
            %int_tuple_3409 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3410 = cute.tuple.product(%int_tuple_3409) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3411 = cute.get_leaves(%res_3410) : !cute.int_tuple<"16">
            %cst_3412 = arith.constant 0.000000e+00 : bf16
            %1217 = vector.splat %cst_3412 : vector<16xbf16>
            %int_tuple_3413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3414 = cute.size(%int_tuple_3413) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3415 = cute.get_leaves(%sz_3414) : !cute.int_tuple<"16">
            %int_tuple_3416 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3417 = cute.size(%int_tuple_3416) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3418 = cute.get_leaves(%sz_3417) : !cute.int_tuple<"16">
            cute.memref.store_vec %1217, %view_3400, row_major : !memref_smem_bf16_12
          }
        } else {
          %coord_3259 = cute.make_coord(%sub_2060) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_3260 = cute.get_layout(%src_partitioned_373) : !memref_gmem_bf16_6
          %slice_3261 = cute.slice(%lay_3260, %coord_3259) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_3262 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_3263 = cute.get_iter(%src_partitioned_373) : !memref_gmem_bf16_6
          %ptr_3264 = cute.add_offset(%iter_3263, %idx_3262) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_3265 = cute.make_view(%ptr_3264, %slice_3261) : !memref_gmem_bf16_5
          %iter_3266 = cute.get_iter(%view_3265) : !memref_gmem_bf16_5
          %coord_3267 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3268 = cute.get_layout(%dst_partitioned_376) : !memref_smem_bf16_3
          %idx_3269 = cute.crd2idx(%coord_3267, %lay_3268) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_3270 = cute.get_iter(%dst_partitioned_376) : !memref_smem_bf16_3
          %ptr_3271 = cute.add_offset(%iter_3270, %idx_3269) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3272 = cute.make_view(%ptr_3271) : !memref_smem_bf16_3
          %iter_3273 = cute.get_iter(%view_3272) : !memref_smem_bf16_3
          %coord_3274 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3275 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
          %idx_3276 = cute.crd2idx(%coord_3274, %lay_3275) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_3277 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
          %ptr_3278 = cute.add_offset(%iter_3277, %idx_3276) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_3279 = cute.make_view(%ptr_3278) : !memref_rmem_i8_
          %iter_3280 = cute.get_iter(%view_3279) : !memref_rmem_i8_
          %lay_3281 = cute.get_layout(%view_3265) : !memref_gmem_bf16_5
          %1143 = cute.get_shape(%lay_3281) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3282, %e1_3283, %e2_3284, %e3_3285 = cute.get_leaves(%1143) : !cute.shape<"((8,1),4,2)">
          %lay_3286 = cute.get_layout(%view_3272) : !memref_smem_bf16_3
          %1144 = cute.get_shape(%lay_3286) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3287, %e1_3288, %e2_3289, %e3_3290 = cute.get_leaves(%1144) : !cute.shape<"((8,1),4,2)">
          %lay_3291 = cute.get_layout(%view_3265) : !memref_gmem_bf16_5
          %shape_3292 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3293 = cute.make_layout() : !cute.layout<"1:0">
          %append_3294 = cute.append_to_rank<2> (%lay_3291, %lay_3293) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_3295 = cute.make_view(%iter_3266, %append_3294) : !memref_gmem_bf16_5
          %iter_3296 = cute.get_iter(%view_3295) : !memref_gmem_bf16_5
          %lay_3297 = cute.get_layout(%view_3295) : !memref_gmem_bf16_5
          %1145 = cute.get_shape(%lay_3297) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3298, %e1_3299, %e2_3300, %e3_3301 = cute.get_leaves(%1145) : !cute.shape<"((8,1),4,2)">
          %iter_3302 = cute.get_iter(%view_3295) : !memref_gmem_bf16_5
          %lay_3303 = cute.get_layout(%view_3295) : !memref_gmem_bf16_5
          %1146 = cute.get_scalars(%lay_3303) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_3304 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_3305 = cute.assume(%1146) : (i64) -> !cute.i64<divby 128>
          %stride_3306 = cute.make_stride(%iv_3305) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_3307 = cute.make_layout(%shape_3304, %stride_3306) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_3308 = cute.make_view(%iter_3302, %lay_3307) : !memref_gmem_bf16_13
          %iter_3309 = cute.get_iter(%view_3308) : !memref_gmem_bf16_13
          %iter_3310 = cute.get_iter(%view_3308) : !memref_gmem_bf16_13
          %lay_3311 = cute.get_layout(%view_3272) : !memref_smem_bf16_3
          %shape_3312 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3313 = cute.make_layout() : !cute.layout<"1:0">
          %append_3314 = cute.append_to_rank<2> (%lay_3311, %lay_3313) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_3315 = cute.make_view(%iter_3273, %append_3314) : !memref_smem_bf16_3
          %iter_3316 = cute.get_iter(%view_3315) : !memref_smem_bf16_3
          %lay_3317 = cute.get_layout(%view_3315) : !memref_smem_bf16_3
          %1147 = cute.get_shape(%lay_3317) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3318, %e1_3319, %e2_3320, %e3_3321 = cute.get_leaves(%1147) : !cute.shape<"((8,1),4,2)">
          %iter_3322 = cute.get_iter(%view_3315) : !memref_smem_bf16_3
          %view_3323 = cute.make_view(%iter_3322) : !memref_smem_bf16_17
          %iter_3324 = cute.get_iter(%view_3323) : !memref_smem_bf16_17
          %iter_3325 = cute.get_iter(%view_3323) : !memref_smem_bf16_17
          %lay_3326 = cute.get_layout(%view_3279) : !memref_rmem_i8_
          %shape_3327 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3328 = cute.make_layout() : !cute.layout<"1:0">
          %append_3329 = cute.append_to_rank<2> (%lay_3326, %lay_3328) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_3330 = cute.make_view(%iter_3280, %append_3329) : !memref_rmem_i8_
          %iter_3331 = cute.get_iter(%view_3330) : !memref_rmem_i8_
          %lay_3332 = cute.get_layout(%view_3330) : !memref_rmem_i8_
          %1148 = cute.get_shape(%lay_3332) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_3333, %e1_3334, %e2_3335 = cute.get_leaves(%1148) : !cute.shape<"(1,4,2)">
          %iter_3336 = cute.get_iter(%view_3330) : !memref_rmem_i8_
          %view_3337 = cute.make_view(%iter_3336) : !memref_rmem_i8_4
          %iter_3338 = cute.get_iter(%view_3337) : !memref_rmem_i8_4
          %iter_3339 = cute.get_iter(%view_3337) : !memref_rmem_i8_4
          %lay_3340 = cute.get_layout(%view_3308) : !memref_gmem_bf16_13
          %1149 = cute.get_shape(%lay_3340) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3341, %e1_3342, %e2_3343, %e3_3344 = cute.get_leaves(%1149) : !cute.shape<"((8,1),(4,2))">
          %lay_3345 = cute.get_layout(%view_3323) : !memref_smem_bf16_17
          %1150 = cute.get_shape(%lay_3345) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3346, %e1_3347, %e2_3348, %e3_3349 = cute.get_leaves(%1150) : !cute.shape<"((8,1),(4,2))">
          %lay_3350 = cute.get_layout(%view_3308) : !memref_gmem_bf16_13
          %sz_3351 = cute.size(%lay_3350) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_3352 = cute.get_leaves(%sz_3351) : !cute.int_tuple<"8">
          %lay_3353 = cute.get_layout(%view_3323) : !memref_smem_bf16_17
          %sz_3354 = cute.size(%lay_3353) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_3355 = cute.get_leaves(%sz_3354) : !cute.int_tuple<"8">
          %1151 = cute.static : !cute.layout<"1:0">
          %iter_3356 = cute.get_iter(%view_3308) : !memref_gmem_bf16_13
          %iter_3357 = cute.get_iter(%view_3323) : !memref_smem_bf16_17
          %lay_3358 = cute.get_layout(%view_3308) : !memref_gmem_bf16_13
          %lay_3359 = cute.get_layout(%view_3323) : !memref_smem_bf16_17
          %append_3360 = cute.append_to_rank<2> (%lay_3358, %1151) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_3361 = cute.append_to_rank<2> (%lay_3359, %1151) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1152 = cute.get_scalars(%append_3360) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_3362 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_3363 = cute.assume(%1152) : (i64) -> !cute.i64<divby 128>
          %stride_3364 = cute.make_stride(%iv_3363) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_3365 = cute.make_layout(%shape_3362, %stride_3364) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_3366 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_3367 = cute.get_iter(%view_3337) : !memref_rmem_i8_4
          %lay_3368 = cute.get_layout(%view_3337) : !memref_rmem_i8_4
          %append_3369 = cute.append_to_rank<2> (%lay_3368, %1151) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_3370 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_3371 = cute.size(%lay_3365) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1153 = cute.get_scalars(%sz_3371) : !cute.int_tuple<"8">
          %c0_i32_3372 = arith.constant 0 : i32
          %c1_i32_3373 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3372 to %1153 step %c1_i32_3373  : i32 {
            %coord_3374 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3375 = cute.slice(%lay_3365, %coord_3374) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_3376 = cute.crd2idx(%coord_3374, %lay_3365) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_3377 = cute.add_offset(%iter_3356, %idx_3376) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3378 = cute.make_view(%ptr_3377, %slice_3375) : !memref_gmem_bf16_10
            %slice_3379 = cute.slice(%lay_3366, %coord_3374) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_3380 = cute.crd2idx(%coord_3374, %lay_3366) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3381 = cute.add_offset(%iter_3357, %idx_3380) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3382 = cute.make_view(%ptr_3381, %slice_3379) : !memref_smem_bf16_14
            %slice_3383 = cute.slice(%lay_3370, %coord_3374) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_3384 = cute.crd2idx(%coord_3374, %lay_3370) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_3385 = cute.add_offset(%iter_3367, %idx_3384) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_3386 = cute.make_view(%ptr_3385, %slice_3383) : !memref_rmem_i8_3
            cute.copy_atom_call(%4, %view_3378, %view_3382, %view_3386) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %shape_2063 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %922 = cute.tiled.mma.partition_shape C (%arg6, %shape_2063) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(64,64)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2064, %e1_2065, %e2_2066, %e3_2067 = cute.get_leaves(%922) : !cute.shape<"((2,2),1,8)">
        %shape_2068 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2069 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2070 = cute.memref.alloca(%lay_2069) : !memref_rmem_f32_1
        %iter_2071 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2072 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %shape_2073 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %923 = cute.tiled.mma.partition_shape C (%arg6, %shape_2073) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(64,64)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2074, %e1_2075, %e2_2076, %e3_2077 = cute.get_leaves(%923) : !cute.shape<"((2,2),1,8)">
        %shape_2078 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2079 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2080 = cute.memref.alloca(%lay_2079) : !memref_rmem_bf16_6
        %iter_2081 = cute.get_iter(%rmem_2080) : !memref_rmem_bf16_6
        %iter_2082 = cute.get_iter(%rmem_2080) : !memref_rmem_bf16_6
        %retiled_2083 = cute.tiled.copy.retile(%arg7, %rmem_2080) : (!copy_ldsm_4_3, !memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_2084 = cute.get_iter(%retiled_2083) : !memref_rmem_bf16_7
        %coord_2085 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2086 = cute.get_layout(%src_partitioned_485) : !memref_smem_bf16_11
        %slice_2087 = cute.slice(%lay_2086, %coord_2085) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">, !cute.coord<"(_,_,_)">
        %idx_2088 = cute.crd2idx(%coord_2085, %lay_2086) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.int_tuple<"0">
        %iter_2089 = cute.get_iter(%src_partitioned_485) : !memref_smem_bf16_11
        %ptr_2090 = cute.add_offset(%iter_2089, %idx_2088) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2091 = cute.make_view(%ptr_2090, %slice_2087) : !memref_smem_bf16_11
        %iter_2092 = cute.get_iter(%view_2091) : !memref_smem_bf16_11
        %coord_2093 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2094 = cute.get_layout(%retiled_2083) : !memref_rmem_bf16_7
        %idx_2095 = cute.crd2idx(%coord_2093, %lay_2094) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.int_tuple<"0">
        %iter_2096 = cute.get_iter(%retiled_2083) : !memref_rmem_bf16_7
        %ptr_2097 = cute.add_offset(%iter_2096, %idx_2095) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2098 = cute.make_view(%ptr_2097) : !memref_rmem_bf16_7
        %iter_2099 = cute.get_iter(%view_2098) : !memref_rmem_bf16_7
        %lay_2100 = cute.get_layout(%view_2091) : !memref_smem_bf16_11
        %924 = cute.get_shape(%lay_2100) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2101, %e1_2102, %e2_2103, %e3_2104, %e4_2105 = cute.get_leaves(%924) : !cute.shape<"((8,1),1,(2,2))">
        %lay_2106 = cute.get_layout(%view_2098) : !memref_rmem_bf16_7
        %925 = cute.get_shape(%lay_2106) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2107, %e1_2108, %e2_2109, %e3_2110 = cute.get_leaves(%925) : !cute.shape<"((8,1),1,4)">
        %lay_2111 = cute.get_layout(%view_2091) : !memref_smem_bf16_11
        %shape_2112 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2113 = cute.make_layout() : !cute.layout<"1:0">
        %append_2114 = cute.append_to_rank<2> (%lay_2111, %lay_2113) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">, !cute.layout<"1:0">
        %view_2115 = cute.make_view(%iter_2092, %append_2114) : !memref_smem_bf16_11
        %iter_2116 = cute.get_iter(%view_2115) : !memref_smem_bf16_11
        %lay_2117 = cute.get_layout(%view_2115) : !memref_smem_bf16_11
        %926 = cute.get_shape(%lay_2117) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2118, %e1_2119, %e2_2120, %e3_2121, %e4_2122 = cute.get_leaves(%926) : !cute.shape<"((8,1),1,(2,2))">
        %iter_2123 = cute.get_iter(%view_2115) : !memref_smem_bf16_11
        %lay_2124 = cute.get_layout(%view_2115) : !memref_smem_bf16_11
        %927:2 = cute.get_scalars(%lay_2124) <{only_dynamic}> : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %shape_2125 = cute.make_shape() : () -> !cute.shape<"((8,1),(1,(2,2)))">
        %iv_2126 = cute.assume(%927#0) : (i32) -> !cute.i32<divby 16>
        %iv_2127 = cute.assume(%927#1) : (i32) -> !cute.i32<divby 32>
        %stride_2128 = cute.make_stride(%iv_2126, %iv_2127) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(0,(?{div=16},?{div=32})))">
        %lay_2129 = cute.make_layout(%shape_2125, %stride_2128) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %view_2130 = cute.make_view(%iter_2123, %lay_2129) : !memref_smem_bf16_18
        %iter_2131 = cute.get_iter(%view_2130) : !memref_smem_bf16_18
        %iter_2132 = cute.get_iter(%view_2130) : !memref_smem_bf16_18
        %lay_2133 = cute.get_layout(%view_2098) : !memref_rmem_bf16_7
        %shape_2134 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2135 = cute.make_layout() : !cute.layout<"1:0">
        %append_2136 = cute.append_to_rank<2> (%lay_2133, %lay_2135) : !cute.layout<"((8,1),1,4):((1,0),0,8)">, !cute.layout<"1:0">
        %view_2137 = cute.make_view(%iter_2099, %append_2136) : !memref_rmem_bf16_7
        %iter_2138 = cute.get_iter(%view_2137) : !memref_rmem_bf16_7
        %lay_2139 = cute.get_layout(%view_2137) : !memref_rmem_bf16_7
        %928 = cute.get_shape(%lay_2139) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2140, %e1_2141, %e2_2142, %e3_2143 = cute.get_leaves(%928) : !cute.shape<"((8,1),1,4)">
        %iter_2144 = cute.get_iter(%view_2137) : !memref_rmem_bf16_7
        %view_2145 = cute.make_view(%iter_2144) : !memref_rmem_bf16_8
        %iter_2146 = cute.get_iter(%view_2145) : !memref_rmem_bf16_8
        %iter_2147 = cute.get_iter(%view_2145) : !memref_rmem_bf16_8
        %lay_2148 = cute.get_layout(%view_2130) : !memref_smem_bf16_18
        %929 = cute.get_shape(%lay_2148) : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.shape<"((8,1),(1,(2,2)))">
        %e0_2149, %e1_2150, %e2_2151, %e3_2152, %e4_2153 = cute.get_leaves(%929) : !cute.shape<"((8,1),(1,(2,2)))">
        %lay_2154 = cute.get_layout(%view_2145) : !memref_rmem_bf16_8
        %930 = cute.get_shape(%lay_2154) : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.shape<"((8,1),(1,4))">
        %e0_2155, %e1_2156, %e2_2157, %e3_2158 = cute.get_leaves(%930) : !cute.shape<"((8,1),(1,4))">
        %lay_2159 = cute.get_layout(%view_2130) : !memref_smem_bf16_18
        %sz_2160 = cute.size(%lay_2159) <{mode = [1]}> : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.int_tuple<"4">
        %e0_2161 = cute.get_leaves(%sz_2160) : !cute.int_tuple<"4">
        %lay_2162 = cute.get_layout(%view_2145) : !memref_rmem_bf16_8
        %sz_2163 = cute.size(%lay_2162) <{mode = [1]}> : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.int_tuple<"4">
        %e0_2164 = cute.get_leaves(%sz_2163) : !cute.int_tuple<"4">
        %931 = cute.static : !cute.layout<"1:0">
        %iter_2165 = cute.get_iter(%view_2130) : !memref_smem_bf16_18
        %iter_2166 = cute.get_iter(%view_2145) : !memref_rmem_bf16_8
        %lay_2167 = cute.get_layout(%view_2130) : !memref_smem_bf16_18
        %lay_2168 = cute.get_layout(%view_2145) : !memref_rmem_bf16_8
        %append_2169 = cute.append_to_rank<2> (%lay_2167, %931) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">, !cute.layout<"1:0">
        %append_2170 = cute.append_to_rank<2> (%lay_2168, %931) : !cute.layout<"((8,1),(1,4)):((1,0),(0,8))">, !cute.layout<"1:0">
        %932:2 = cute.get_scalars(%append_2169) <{only_dynamic}> : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %shape_2171 = cute.make_shape() : () -> !cute.shape<"((8,1),((1,(2,2))))">
        %iv_2172 = cute.assume(%932#0) : (i32) -> !cute.i32<divby 16>
        %iv_2173 = cute.assume(%932#1) : (i32) -> !cute.i32<divby 32>
        %stride_2174 = cute.make_stride(%iv_2172, %iv_2173) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2175 = cute.make_layout(%shape_2171, %stride_2174) : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2176 = cute.make_layout() : !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">
        %sz_2177 = cute.size(%lay_2175) <{mode = [1]}> : (!cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"4">
        %933 = cute.get_scalars(%sz_2177) : !cute.int_tuple<"4">
        %c0_i32_2178 = arith.constant 0 : i32
        %c1_i32_2179 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2178 to %933 step %c1_i32_2179  : i32 {
          %coord_3259 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3260 = cute.slice(%lay_2175, %coord_3259) : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">, !cute.coord<"(_,?)">
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_2175) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_3262 = cute.add_offset(%iter_2165, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3263 = cute.make_view(%ptr_3262, %slice_3260) : !memref_smem_bf16_14
          %slice_3264 = cute.slice(%lay_2176, %coord_3259) : !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">, !cute.coord<"(_,?)">
          %idx_3265 = cute.crd2idx(%coord_3259, %lay_2176) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_3266 = cute.add_offset(%iter_2166, %idx_3265) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3267 = cute.make_view(%ptr_3266, %slice_3264) : !memref_rmem_bf16_9
          cute.copy_atom_call(%191, %view_3263, %view_3267) : (!copy_ldsm_4_3, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2180 = cute.get_layout(%rmem_2080) : !memref_rmem_bf16_6
        %934 = cute.get_shape(%lay_2180) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2181, %e1_2182, %e2_2183, %e3_2184 = cute.get_leaves(%934) : !cute.shape<"((2,2),1,8)">
        %935 = cute.memref.load_vec %rmem_2080, row_major : !memref_rmem_bf16_6
        %936 = arith.extf %935 : vector<32xbf16> to vector<32xf32>
        %lay_2185 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %937 = cute.get_shape(%lay_2185) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2186, %e1_2187, %e2_2188, %e3_2189 = cute.get_leaves(%937) : !cute.shape<"((2,2),1,8)">
        %int_tuple_2190 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2191 = cute.size(%int_tuple_2190) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2192 = cute.get_leaves(%sz_2191) : !cute.int_tuple<"32">
        %int_tuple_2193 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2194 = cute.size(%int_tuple_2193) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2195 = cute.get_leaves(%sz_2194) : !cute.int_tuple<"32">
        cute.memref.store_vec %936, %rmem_2070, row_major : !memref_rmem_f32_1
        %coord_2196 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2197 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
        %idx_2198 = cute.crd2idx(%coord_2196, %lay_2197) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2199 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
        %ptr_2200 = cute.add_offset(%iter_2199, %idx_2198) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2201 = cute.make_view(%ptr_2200) : !memref_smem_bf16_15
        %iter_2202 = cute.get_iter(%view_2201) : !memref_smem_bf16_15
        %coord_2203 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2204 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_2205 = cute.crd2idx(%coord_2203, %lay_2204) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"0">
        %iter_2206 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_2207 = cute.add_offset(%iter_2206, %idx_2205) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2208 = cute.make_view(%ptr_2207) : !memref_rmem_bf16_10
        %iter_2209 = cute.get_iter(%view_2208) : !memref_rmem_bf16_10
        %lay_2210 = cute.get_layout(%view_2201) : !memref_smem_bf16_15
        %938 = cute.get_shape(%lay_2210) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2211, %e1_2212, %e2_2213 = cute.get_leaves(%938) : !cute.shape<"((8,1),1)">
        %lay_2214 = cute.get_layout(%view_2208) : !memref_rmem_bf16_10
        %939 = cute.get_shape(%lay_2214) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2215, %e1_2216, %e2_2217 = cute.get_leaves(%939) : !cute.shape<"((8,1),1)">
        %lay_2218 = cute.get_layout(%view_2201) : !memref_smem_bf16_15
        %shape_2219 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2220 = cute.make_layout() : !cute.layout<"1:0">
        %append_2221 = cute.append_to_rank<2> (%lay_2218, %lay_2220) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2222 = cute.make_view(%iter_2202, %append_2221) : !memref_smem_bf16_15
        %iter_2223 = cute.get_iter(%view_2222) : !memref_smem_bf16_15
        %lay_2224 = cute.get_layout(%view_2222) : !memref_smem_bf16_15
        %940 = cute.get_shape(%lay_2224) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2225, %e1_2226, %e2_2227 = cute.get_leaves(%940) : !cute.shape<"((8,1),1)">
        %iter_2228 = cute.get_iter(%view_2222) : !memref_smem_bf16_15
        %view_2229 = cute.make_view(%iter_2228) : !memref_smem_bf16_16
        %iter_2230 = cute.get_iter(%view_2229) : !memref_smem_bf16_16
        %iter_2231 = cute.get_iter(%view_2229) : !memref_smem_bf16_16
        %lay_2232 = cute.get_layout(%view_2208) : !memref_rmem_bf16_10
        %shape_2233 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2234 = cute.make_layout() : !cute.layout<"1:0">
        %append_2235 = cute.append_to_rank<2> (%lay_2232, %lay_2234) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2236 = cute.make_view(%iter_2209, %append_2235) : !memref_rmem_bf16_10
        %iter_2237 = cute.get_iter(%view_2236) : !memref_rmem_bf16_10
        %lay_2238 = cute.get_layout(%view_2236) : !memref_rmem_bf16_10
        %941 = cute.get_shape(%lay_2238) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2239, %e1_2240, %e2_2241 = cute.get_leaves(%941) : !cute.shape<"((8,1),1)">
        %iter_2242 = cute.get_iter(%view_2236) : !memref_rmem_bf16_10
        %view_2243 = cute.make_view(%iter_2242) : !memref_rmem_bf16_11
        %iter_2244 = cute.get_iter(%view_2243) : !memref_rmem_bf16_11
        %iter_2245 = cute.get_iter(%view_2243) : !memref_rmem_bf16_11
        %lay_2246 = cute.get_layout(%view_2229) : !memref_smem_bf16_16
        %942 = cute.get_shape(%lay_2246) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2247, %e1_2248, %e2_2249 = cute.get_leaves(%942) : !cute.shape<"((8,1),(1))">
        %lay_2250 = cute.get_layout(%view_2243) : !memref_rmem_bf16_11
        %943 = cute.get_shape(%lay_2250) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2251, %e1_2252, %e2_2253 = cute.get_leaves(%943) : !cute.shape<"((8,1),(1))">
        %lay_2254 = cute.get_layout(%view_2229) : !memref_smem_bf16_16
        %sz_2255 = cute.size(%lay_2254) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2256 = cute.get_leaves(%sz_2255) : !cute.int_tuple<"1">
        %lay_2257 = cute.get_layout(%view_2243) : !memref_rmem_bf16_11
        %sz_2258 = cute.size(%lay_2257) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2259 = cute.get_leaves(%sz_2258) : !cute.int_tuple<"1">
        %944 = cute.static : !cute.layout<"1:0">
        %iter_2260 = cute.get_iter(%view_2229) : !memref_smem_bf16_16
        %iter_2261 = cute.get_iter(%view_2243) : !memref_rmem_bf16_11
        %lay_2262 = cute.get_layout(%view_2229) : !memref_smem_bf16_16
        %lay_2263 = cute.get_layout(%view_2243) : !memref_rmem_bf16_11
        %append_2264 = cute.append_to_rank<2> (%lay_2262, %944) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2265 = cute.append_to_rank<2> (%lay_2263, %944) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2266 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2267 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2268 = cute.size(%lay_2266) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %945 = cute.get_scalars(%sz_2268) : !cute.int_tuple<"1">
        %c0_i32_2269 = arith.constant 0 : i32
        %c1_i32_2270 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2269 to %945 step %c1_i32_2270  : i32 {
          %coord_3259 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3260 = cute.slice(%lay_2266, %coord_3259) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_2266) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_3262 = cute.add_offset(%iter_2260, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3263 = cute.make_view(%ptr_3262, %slice_3260) : !memref_smem_bf16_14
          %slice_3264 = cute.slice(%lay_2267, %coord_3259) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_3265 = cute.crd2idx(%coord_3259, %lay_2267) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_3266 = cute.add_offset(%iter_2261, %idx_3265) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3267 = cute.make_view(%ptr_3266, %slice_3264) : !memref_rmem_bf16_9
          cute.copy_atom_call(%179, %view_3263, %view_3267) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_2271 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2272 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
        %idx_2273 = cute.crd2idx(%coord_2271, %lay_2272) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2274 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
        %ptr_2275 = cute.add_offset(%iter_2274, %idx_2273) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2276 = cute.make_view(%ptr_2275) : !memref_smem_bf16_19
        %iter_2277 = cute.get_iter(%view_2276) : !memref_smem_bf16_19
        %coord_2278 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2279 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
        %idx_2280 = cute.crd2idx(%coord_2278, %lay_2279) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"0">
        %iter_2281 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
        %ptr_2282 = cute.add_offset(%iter_2281, %idx_2280) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2283 = cute.make_view(%ptr_2282) : !memref_rmem_bf16_12
        %iter_2284 = cute.get_iter(%view_2283) : !memref_rmem_bf16_12
        %lay_2285 = cute.get_layout(%view_2276) : !memref_smem_bf16_19
        %946 = cute.get_shape(%lay_2285) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2286, %e1_2287, %e2_2288 = cute.get_leaves(%946) : !cute.shape<"((8,1),4)">
        %lay_2289 = cute.get_layout(%view_2283) : !memref_rmem_bf16_12
        %947 = cute.get_shape(%lay_2289) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_2290, %e1_2291, %e2_2292, %e3_2293 = cute.get_leaves(%947) : !cute.shape<"(((4,2),1),4)">
        %lay_2294 = cute.get_layout(%view_2276) : !memref_smem_bf16_19
        %shape_2295 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2296 = cute.make_layout() : !cute.layout<"1:0">
        %append_2297 = cute.append_to_rank<2> (%lay_2294, %lay_2296) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_2298 = cute.make_view(%iter_2277, %append_2297) : !memref_smem_bf16_19
        %iter_2299 = cute.get_iter(%view_2298) : !memref_smem_bf16_19
        %lay_2300 = cute.get_layout(%view_2298) : !memref_smem_bf16_19
        %948 = cute.get_shape(%lay_2300) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2301, %e1_2302, %e2_2303 = cute.get_leaves(%948) : !cute.shape<"((8,1),4)">
        %iter_2304 = cute.get_iter(%view_2298) : !memref_smem_bf16_19
        %view_2305 = cute.make_view(%iter_2304) : !memref_smem_bf16_20
        %iter_2306 = cute.get_iter(%view_2305) : !memref_smem_bf16_20
        %iter_2307 = cute.get_iter(%view_2305) : !memref_smem_bf16_20
        %lay_2308 = cute.get_layout(%view_2283) : !memref_rmem_bf16_12
        %shape_2309 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2310 = cute.make_layout() : !cute.layout<"1:0">
        %append_2311 = cute.append_to_rank<2> (%lay_2308, %lay_2310) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
        %view_2312 = cute.make_view(%iter_2284, %append_2311) : !memref_rmem_bf16_12
        %iter_2313 = cute.get_iter(%view_2312) : !memref_rmem_bf16_12
        %lay_2314 = cute.get_layout(%view_2312) : !memref_rmem_bf16_12
        %949 = cute.get_shape(%lay_2314) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_2315, %e1_2316, %e2_2317, %e3_2318 = cute.get_leaves(%949) : !cute.shape<"(((4,2),1),4)">
        %iter_2319 = cute.get_iter(%view_2312) : !memref_rmem_bf16_12
        %view_2320 = cute.make_view(%iter_2319) : !memref_rmem_bf16_13
        %iter_2321 = cute.get_iter(%view_2320) : !memref_rmem_bf16_13
        %iter_2322 = cute.get_iter(%view_2320) : !memref_rmem_bf16_13
        %lay_2323 = cute.get_layout(%view_2305) : !memref_smem_bf16_20
        %950 = cute.get_shape(%lay_2323) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_2324, %e1_2325, %e2_2326 = cute.get_leaves(%950) : !cute.shape<"((8,1),(4))">
        %lay_2327 = cute.get_layout(%view_2320) : !memref_rmem_bf16_13
        %951 = cute.get_shape(%lay_2327) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
        %e0_2328, %e1_2329, %e2_2330, %e3_2331 = cute.get_leaves(%951) : !cute.shape<"(((4,2),1),(4))">
        %lay_2332 = cute.get_layout(%view_2305) : !memref_smem_bf16_20
        %sz_2333 = cute.size(%lay_2332) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_2334 = cute.get_leaves(%sz_2333) : !cute.int_tuple<"4">
        %lay_2335 = cute.get_layout(%view_2320) : !memref_rmem_bf16_13
        %sz_2336 = cute.size(%lay_2335) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
        %e0_2337 = cute.get_leaves(%sz_2336) : !cute.int_tuple<"4">
        %952 = cute.static : !cute.layout<"1:0">
        %iter_2338 = cute.get_iter(%view_2305) : !memref_smem_bf16_20
        %iter_2339 = cute.get_iter(%view_2320) : !memref_rmem_bf16_13
        %lay_2340 = cute.get_layout(%view_2305) : !memref_smem_bf16_20
        %lay_2341 = cute.get_layout(%view_2320) : !memref_rmem_bf16_13
        %append_2342 = cute.append_to_rank<2> (%lay_2340, %952) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_2343 = cute.append_to_rank<2> (%lay_2341, %952) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
        %lay_2344 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_2345 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
        %sz_2346 = cute.size(%lay_2344) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %953 = cute.get_scalars(%sz_2346) : !cute.int_tuple<"4">
        %c0_i32_2347 = arith.constant 0 : i32
        %c1_i32_2348 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2347 to %953 step %c1_i32_2348  : i32 {
          %coord_3259 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3260 = cute.slice(%lay_2344, %coord_3259) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_2344) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_3262 = cute.add_offset(%iter_2338, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3263 = cute.make_view(%ptr_3262, %slice_3260) : !memref_smem_bf16_14
          %slice_3264 = cute.slice(%lay_2345, %coord_3259) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
          %idx_3265 = cute.crd2idx(%coord_3259, %lay_2345) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
          %ptr_3266 = cute.add_offset(%iter_2339, %idx_3265) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3267 = cute.make_view(%ptr_3266, %slice_3264) : !memref_rmem_bf16_14
          cute.copy_atom_call(%183, %view_3263, %view_3267) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2349 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
        %954 = cute.get_shape(%lay_2349) : (!cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),1,((2,2),2))">
        %e0_2350, %e1_2351, %e2_2352, %e3_2353, %e4_2354, %e5_2355 = cute.get_leaves(%954) : !cute.shape<"((8,1),1,((2,2),2))">
        %int_tuple_2356 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2357 = cute.size(%int_tuple_2356) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2358 = cute.get_leaves(%sz_2357) : !cute.int_tuple<"8">
        %int_tuple_2359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2360 = cute.size(%int_tuple_2359) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2361 = cute.get_leaves(%sz_2360) : !cute.int_tuple<"8">
        %true = arith.constant true
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"64">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2362 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2363 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2364 = cute.crd2idx(%coord_2362, %lay_2363) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"0">
        %iter_2365 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2366 = cute.add_offset(%iter_2365, %idx_2364) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2367 = cute.make_view(%ptr_2366) : !memref_rmem_bf16_15
        %iter_2368 = cute.get_iter(%view_2367) : !memref_rmem_bf16_15
        %coord_2369 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2370 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2371 = cute.crd2idx(%coord_2369, %lay_2370) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"0">
        %iter_2372 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2373 = cute.add_offset(%iter_2372, %idx_2371) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2374 = cute.make_view(%ptr_2373) : !memref_rmem_bf16_16
        %iter_2375 = cute.get_iter(%view_2374) : !memref_rmem_bf16_16
        %lay_2376 = cute.get_layout(%view_2367) : !memref_rmem_bf16_15
        %955 = cute.get_shape(%lay_2376) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2377, %e1_2378, %e2_2379, %e3_2380 = cute.get_leaves(%955) : !cute.shape<"((2,2,2),1)">
        %lay_2381 = cute.get_layout(%view_2374) : !memref_rmem_bf16_16
        %956 = cute.get_shape(%lay_2381) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2382, %e1_2383, %e2_2384, %e3_2385 = cute.get_leaves(%956) : !cute.shape<"((2,2),(2,4))">
        %iter_2386 = cute.get_iter(%view_2367) : !memref_rmem_bf16_15
        %iter_2387 = cute.get_iter(%view_2374) : !memref_rmem_bf16_16
        %iter_2388 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2389 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2390 = cute.get_layout(%view_2367) : !memref_rmem_bf16_15
        %lay_2391 = cute.get_layout(%view_2374) : !memref_rmem_bf16_16
        %lay_2392 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2393 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %957 = cute.static : !cute.layout<"1:0">
        %append_2394 = cute.append_to_rank<3> (%lay_2390, %957) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2395 = cute.append_to_rank<3> (%lay_2391, %957) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2396 = cute.size(%append_2394) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2397 = cute.size(%append_2394) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2398 = cute.size(%append_2395) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %958 = cute.get_scalars(%sz_2396) : !cute.int_tuple<"1">
        %959 = cute.get_scalars(%sz_2397) : !cute.int_tuple<"1">
        %960 = cute.get_scalars(%sz_2398) : !cute.int_tuple<"8">
        %c0_i32_2399 = arith.constant 0 : i32
        %c1_i32_2400 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2399 to %958 step %c1_i32_2400  : i32 {
          scf.for %arg9 = %c0_i32_2399 to %959 step %c1_i32_2400  : i32 {
            scf.for %arg10 = %c0_i32_2399 to %960 step %c1_i32_2400  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2394, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2394) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2386, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2395, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2395) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2387, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2392, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2392) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2388, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2393, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2393) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2389, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2401 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2402 = cute.size(%int_tuple_2401) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2403 = cute.get_leaves(%sz_2402) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"32">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"128">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2404 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_2405 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2406 = cute.crd2idx(%coord_2404, %lay_2405) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"16">
        %iter_2407 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2408 = cute.add_offset(%iter_2407, %idx_2406) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2409 = cute.make_view(%ptr_2408) : !memref_rmem_bf16_15
        %iter_2410 = cute.get_iter(%view_2409) : !memref_rmem_bf16_15
        %coord_2411 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_2412 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2413 = cute.crd2idx(%coord_2411, %lay_2412) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"64">
        %iter_2414 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2415 = cute.add_offset(%iter_2414, %idx_2413) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2416 = cute.make_view(%ptr_2415) : !memref_rmem_bf16_16
        %iter_2417 = cute.get_iter(%view_2416) : !memref_rmem_bf16_16
        %lay_2418 = cute.get_layout(%view_2409) : !memref_rmem_bf16_15
        %961 = cute.get_shape(%lay_2418) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2419, %e1_2420, %e2_2421, %e3_2422 = cute.get_leaves(%961) : !cute.shape<"((2,2,2),1)">
        %lay_2423 = cute.get_layout(%view_2416) : !memref_rmem_bf16_16
        %962 = cute.get_shape(%lay_2423) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2424, %e1_2425, %e2_2426, %e3_2427 = cute.get_leaves(%962) : !cute.shape<"((2,2),(2,4))">
        %iter_2428 = cute.get_iter(%view_2409) : !memref_rmem_bf16_15
        %iter_2429 = cute.get_iter(%view_2416) : !memref_rmem_bf16_16
        %iter_2430 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2431 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2432 = cute.get_layout(%view_2409) : !memref_rmem_bf16_15
        %lay_2433 = cute.get_layout(%view_2416) : !memref_rmem_bf16_16
        %lay_2434 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2435 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %963 = cute.static : !cute.layout<"1:0">
        %append_2436 = cute.append_to_rank<3> (%lay_2432, %963) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2437 = cute.append_to_rank<3> (%lay_2433, %963) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2438 = cute.size(%append_2436) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2439 = cute.size(%append_2436) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2440 = cute.size(%append_2437) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %964 = cute.get_scalars(%sz_2438) : !cute.int_tuple<"1">
        %965 = cute.get_scalars(%sz_2439) : !cute.int_tuple<"1">
        %966 = cute.get_scalars(%sz_2440) : !cute.int_tuple<"8">
        %c0_i32_2441 = arith.constant 0 : i32
        %c1_i32_2442 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2441 to %964 step %c1_i32_2442  : i32 {
          scf.for %arg9 = %c0_i32_2441 to %965 step %c1_i32_2442  : i32 {
            scf.for %arg10 = %c0_i32_2441 to %966 step %c1_i32_2442  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2436, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2436) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2428, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2437, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2437) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2429, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2434, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2434) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2430, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2435, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2435) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2431, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2443 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2444 = cute.size(%int_tuple_2443) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2445 = cute.get_leaves(%sz_2444) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"48">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"192">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2446 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_2447 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2448 = cute.crd2idx(%coord_2446, %lay_2447) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"32">
        %iter_2449 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2450 = cute.add_offset(%iter_2449, %idx_2448) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2451 = cute.make_view(%ptr_2450) : !memref_rmem_bf16_15
        %iter_2452 = cute.get_iter(%view_2451) : !memref_rmem_bf16_15
        %coord_2453 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_2454 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2455 = cute.crd2idx(%coord_2453, %lay_2454) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"128">
        %iter_2456 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2457 = cute.add_offset(%iter_2456, %idx_2455) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2458 = cute.make_view(%ptr_2457) : !memref_rmem_bf16_16
        %iter_2459 = cute.get_iter(%view_2458) : !memref_rmem_bf16_16
        %lay_2460 = cute.get_layout(%view_2451) : !memref_rmem_bf16_15
        %967 = cute.get_shape(%lay_2460) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2461, %e1_2462, %e2_2463, %e3_2464 = cute.get_leaves(%967) : !cute.shape<"((2,2,2),1)">
        %lay_2465 = cute.get_layout(%view_2458) : !memref_rmem_bf16_16
        %968 = cute.get_shape(%lay_2465) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2466, %e1_2467, %e2_2468, %e3_2469 = cute.get_leaves(%968) : !cute.shape<"((2,2),(2,4))">
        %iter_2470 = cute.get_iter(%view_2451) : !memref_rmem_bf16_15
        %iter_2471 = cute.get_iter(%view_2458) : !memref_rmem_bf16_16
        %iter_2472 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2473 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2474 = cute.get_layout(%view_2451) : !memref_rmem_bf16_15
        %lay_2475 = cute.get_layout(%view_2458) : !memref_rmem_bf16_16
        %lay_2476 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2477 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %969 = cute.static : !cute.layout<"1:0">
        %append_2478 = cute.append_to_rank<3> (%lay_2474, %969) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2479 = cute.append_to_rank<3> (%lay_2475, %969) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2480 = cute.size(%append_2478) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2481 = cute.size(%append_2478) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2482 = cute.size(%append_2479) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %970 = cute.get_scalars(%sz_2480) : !cute.int_tuple<"1">
        %971 = cute.get_scalars(%sz_2481) : !cute.int_tuple<"1">
        %972 = cute.get_scalars(%sz_2482) : !cute.int_tuple<"8">
        %c0_i32_2483 = arith.constant 0 : i32
        %c1_i32_2484 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2483 to %970 step %c1_i32_2484  : i32 {
          scf.for %arg9 = %c0_i32_2483 to %971 step %c1_i32_2484  : i32 {
            scf.for %arg10 = %c0_i32_2483 to %972 step %c1_i32_2484  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2478, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2478) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2470, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2479, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2479) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2471, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2476, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2476) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2472, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2477, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2477) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2473, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2485 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2486 = cute.size(%int_tuple_2485) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2487 = cute.get_leaves(%sz_2486) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"8">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,4)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"16">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2488 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_2489 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2490 = cute.crd2idx(%coord_2488, %lay_2489) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"48">
        %iter_2491 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2492 = cute.add_offset(%iter_2491, %idx_2490) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2493 = cute.make_view(%ptr_2492) : !memref_rmem_bf16_15
        %iter_2494 = cute.get_iter(%view_2493) : !memref_rmem_bf16_15
        %coord_2495 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_2496 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2497 = cute.crd2idx(%coord_2495, %lay_2496) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"192">
        %iter_2498 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2499 = cute.add_offset(%iter_2498, %idx_2497) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2500 = cute.make_view(%ptr_2499) : !memref_rmem_bf16_16
        %iter_2501 = cute.get_iter(%view_2500) : !memref_rmem_bf16_16
        %lay_2502 = cute.get_layout(%view_2493) : !memref_rmem_bf16_15
        %973 = cute.get_shape(%lay_2502) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2503, %e1_2504, %e2_2505, %e3_2506 = cute.get_leaves(%973) : !cute.shape<"((2,2,2),1)">
        %lay_2507 = cute.get_layout(%view_2500) : !memref_rmem_bf16_16
        %974 = cute.get_shape(%lay_2507) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2508, %e1_2509, %e2_2510, %e3_2511 = cute.get_leaves(%974) : !cute.shape<"((2,2),(2,4))">
        %iter_2512 = cute.get_iter(%view_2493) : !memref_rmem_bf16_15
        %iter_2513 = cute.get_iter(%view_2500) : !memref_rmem_bf16_16
        %iter_2514 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2515 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2516 = cute.get_layout(%view_2493) : !memref_rmem_bf16_15
        %lay_2517 = cute.get_layout(%view_2500) : !memref_rmem_bf16_16
        %lay_2518 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2519 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %975 = cute.static : !cute.layout<"1:0">
        %append_2520 = cute.append_to_rank<3> (%lay_2516, %975) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2521 = cute.append_to_rank<3> (%lay_2517, %975) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2522 = cute.size(%append_2520) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2523 = cute.size(%append_2520) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2524 = cute.size(%append_2521) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %976 = cute.get_scalars(%sz_2522) : !cute.int_tuple<"1">
        %977 = cute.get_scalars(%sz_2523) : !cute.int_tuple<"1">
        %978 = cute.get_scalars(%sz_2524) : !cute.int_tuple<"8">
        %c0_i32_2525 = arith.constant 0 : i32
        %c1_i32_2526 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2525 to %976 step %c1_i32_2526  : i32 {
          scf.for %arg9 = %c0_i32_2525 to %977 step %c1_i32_2526  : i32 {
            scf.for %arg10 = %c0_i32_2525 to %978 step %c1_i32_2526  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2520, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2520) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2512, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2521, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2521) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2513, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2518, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2518) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2514, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2519, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2519) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2515, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2527 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2528 = cute.size(%int_tuple_2527) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2529 = cute.get_leaves(%sz_2528) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"24">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,5)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"80">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2530 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_2531 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2532 = cute.crd2idx(%coord_2530, %lay_2531) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"8">
        %iter_2533 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2534 = cute.add_offset(%iter_2533, %idx_2532) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2535 = cute.make_view(%ptr_2534) : !memref_rmem_bf16_15
        %iter_2536 = cute.get_iter(%view_2535) : !memref_rmem_bf16_15
        %coord_2537 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_2538 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2539 = cute.crd2idx(%coord_2537, %lay_2538) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"16">
        %iter_2540 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2541 = cute.add_offset(%iter_2540, %idx_2539) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2542 = cute.make_view(%ptr_2541) : !memref_rmem_bf16_16
        %iter_2543 = cute.get_iter(%view_2542) : !memref_rmem_bf16_16
        %lay_2544 = cute.get_layout(%view_2535) : !memref_rmem_bf16_15
        %979 = cute.get_shape(%lay_2544) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2545, %e1_2546, %e2_2547, %e3_2548 = cute.get_leaves(%979) : !cute.shape<"((2,2,2),1)">
        %lay_2549 = cute.get_layout(%view_2542) : !memref_rmem_bf16_16
        %980 = cute.get_shape(%lay_2549) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2550, %e1_2551, %e2_2552, %e3_2553 = cute.get_leaves(%980) : !cute.shape<"((2,2),(2,4))">
        %iter_2554 = cute.get_iter(%view_2535) : !memref_rmem_bf16_15
        %iter_2555 = cute.get_iter(%view_2542) : !memref_rmem_bf16_16
        %iter_2556 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2557 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2558 = cute.get_layout(%view_2535) : !memref_rmem_bf16_15
        %lay_2559 = cute.get_layout(%view_2542) : !memref_rmem_bf16_16
        %lay_2560 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2561 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %981 = cute.static : !cute.layout<"1:0">
        %append_2562 = cute.append_to_rank<3> (%lay_2558, %981) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2563 = cute.append_to_rank<3> (%lay_2559, %981) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2564 = cute.size(%append_2562) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2565 = cute.size(%append_2562) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2566 = cute.size(%append_2563) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %982 = cute.get_scalars(%sz_2564) : !cute.int_tuple<"1">
        %983 = cute.get_scalars(%sz_2565) : !cute.int_tuple<"1">
        %984 = cute.get_scalars(%sz_2566) : !cute.int_tuple<"8">
        %c0_i32_2567 = arith.constant 0 : i32
        %c1_i32_2568 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2567 to %982 step %c1_i32_2568  : i32 {
          scf.for %arg9 = %c0_i32_2567 to %983 step %c1_i32_2568  : i32 {
            scf.for %arg10 = %c0_i32_2567 to %984 step %c1_i32_2568  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2562, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2562) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2554, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2563, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2563) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2555, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2560, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2560) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2556, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2561, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2561) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2557, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2569 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2570 = cute.size(%int_tuple_2569) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2571 = cute.get_leaves(%sz_2570) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"40">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,6)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"144">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2572 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_2573 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2574 = cute.crd2idx(%coord_2572, %lay_2573) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"24">
        %iter_2575 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2576 = cute.add_offset(%iter_2575, %idx_2574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2577 = cute.make_view(%ptr_2576) : !memref_rmem_bf16_15
        %iter_2578 = cute.get_iter(%view_2577) : !memref_rmem_bf16_15
        %coord_2579 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_2580 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2581 = cute.crd2idx(%coord_2579, %lay_2580) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"80">
        %iter_2582 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2583 = cute.add_offset(%iter_2582, %idx_2581) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2584 = cute.make_view(%ptr_2583) : !memref_rmem_bf16_16
        %iter_2585 = cute.get_iter(%view_2584) : !memref_rmem_bf16_16
        %lay_2586 = cute.get_layout(%view_2577) : !memref_rmem_bf16_15
        %985 = cute.get_shape(%lay_2586) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2587, %e1_2588, %e2_2589, %e3_2590 = cute.get_leaves(%985) : !cute.shape<"((2,2,2),1)">
        %lay_2591 = cute.get_layout(%view_2584) : !memref_rmem_bf16_16
        %986 = cute.get_shape(%lay_2591) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2592, %e1_2593, %e2_2594, %e3_2595 = cute.get_leaves(%986) : !cute.shape<"((2,2),(2,4))">
        %iter_2596 = cute.get_iter(%view_2577) : !memref_rmem_bf16_15
        %iter_2597 = cute.get_iter(%view_2584) : !memref_rmem_bf16_16
        %iter_2598 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2599 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2600 = cute.get_layout(%view_2577) : !memref_rmem_bf16_15
        %lay_2601 = cute.get_layout(%view_2584) : !memref_rmem_bf16_16
        %lay_2602 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2603 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %987 = cute.static : !cute.layout<"1:0">
        %append_2604 = cute.append_to_rank<3> (%lay_2600, %987) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2605 = cute.append_to_rank<3> (%lay_2601, %987) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2606 = cute.size(%append_2604) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2607 = cute.size(%append_2604) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2608 = cute.size(%append_2605) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %988 = cute.get_scalars(%sz_2606) : !cute.int_tuple<"1">
        %989 = cute.get_scalars(%sz_2607) : !cute.int_tuple<"1">
        %990 = cute.get_scalars(%sz_2608) : !cute.int_tuple<"8">
        %c0_i32_2609 = arith.constant 0 : i32
        %c1_i32_2610 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2609 to %988 step %c1_i32_2610  : i32 {
          scf.for %arg9 = %c0_i32_2609 to %989 step %c1_i32_2610  : i32 {
            scf.for %arg10 = %c0_i32_2609 to %990 step %c1_i32_2610  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2604, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2604) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2596, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2605, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2605) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2597, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2602, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2602) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2598, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2603, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2603) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2599, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2611 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2612 = cute.size(%int_tuple_2611) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2613 = cute.get_leaves(%sz_2612) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"56">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,7)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"208">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2614 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_2615 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2616 = cute.crd2idx(%coord_2614, %lay_2615) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"40">
        %iter_2617 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2618 = cute.add_offset(%iter_2617, %idx_2616) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2619 = cute.make_view(%ptr_2618) : !memref_rmem_bf16_15
        %iter_2620 = cute.get_iter(%view_2619) : !memref_rmem_bf16_15
        %coord_2621 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_2622 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2623 = cute.crd2idx(%coord_2621, %lay_2622) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"144">
        %iter_2624 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2625 = cute.add_offset(%iter_2624, %idx_2623) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2626 = cute.make_view(%ptr_2625) : !memref_rmem_bf16_16
        %iter_2627 = cute.get_iter(%view_2626) : !memref_rmem_bf16_16
        %lay_2628 = cute.get_layout(%view_2619) : !memref_rmem_bf16_15
        %991 = cute.get_shape(%lay_2628) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2629, %e1_2630, %e2_2631, %e3_2632 = cute.get_leaves(%991) : !cute.shape<"((2,2,2),1)">
        %lay_2633 = cute.get_layout(%view_2626) : !memref_rmem_bf16_16
        %992 = cute.get_shape(%lay_2633) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2634, %e1_2635, %e2_2636, %e3_2637 = cute.get_leaves(%992) : !cute.shape<"((2,2),(2,4))">
        %iter_2638 = cute.get_iter(%view_2619) : !memref_rmem_bf16_15
        %iter_2639 = cute.get_iter(%view_2626) : !memref_rmem_bf16_16
        %iter_2640 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2641 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2642 = cute.get_layout(%view_2619) : !memref_rmem_bf16_15
        %lay_2643 = cute.get_layout(%view_2626) : !memref_rmem_bf16_16
        %lay_2644 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2645 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %993 = cute.static : !cute.layout<"1:0">
        %append_2646 = cute.append_to_rank<3> (%lay_2642, %993) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2647 = cute.append_to_rank<3> (%lay_2643, %993) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2648 = cute.size(%append_2646) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2649 = cute.size(%append_2646) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2650 = cute.size(%append_2647) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %994 = cute.get_scalars(%sz_2648) : !cute.int_tuple<"1">
        %995 = cute.get_scalars(%sz_2649) : !cute.int_tuple<"1">
        %996 = cute.get_scalars(%sz_2650) : !cute.int_tuple<"8">
        %c0_i32_2651 = arith.constant 0 : i32
        %c1_i32_2652 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2651 to %994 step %c1_i32_2652  : i32 {
          scf.for %arg9 = %c0_i32_2651 to %995 step %c1_i32_2652  : i32 {
            scf.for %arg10 = %c0_i32_2651 to %996 step %c1_i32_2652  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2646, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2646) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2638, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2647, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2647) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2639, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2644, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2644) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2640, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2645, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2645) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2641, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2653 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2654 = cute.size(%int_tuple_2653) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2655 = cute.get_leaves(%sz_2654) : !cute.int_tuple<"8">
        %false = arith.constant false
        scf.if %false {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3260 = cute.get_layout(%src_partitioned_471) : !memref_smem_bf16_8
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_3262 = cute.get_iter(%src_partitioned_471) : !memref_smem_bf16_8
          %ptr_3263 = cute.add_offset(%iter_3262, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3264 = cute.make_view(%ptr_3263) : !memref_smem_bf16_15
          %iter_3265 = cute.get_iter(%view_3264) : !memref_smem_bf16_15
          %coord_3266 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3267 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3268 = cute.crd2idx(%coord_3266, %lay_3267) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_3269 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3270 = cute.add_offset(%iter_3269, %idx_3268) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3271 = cute.make_view(%ptr_3270) : !memref_rmem_bf16_10
          %iter_3272 = cute.get_iter(%view_3271) : !memref_rmem_bf16_10
          %lay_3273 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %1143 = cute.get_shape(%lay_3273) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3274, %e1_3275, %e2_3276 = cute.get_leaves(%1143) : !cute.shape<"((8,1),1)">
          %lay_3277 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %1144 = cute.get_shape(%lay_3277) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3278, %e1_3279, %e2_3280 = cute.get_leaves(%1144) : !cute.shape<"((8,1),1)">
          %lay_3281 = cute.get_layout(%view_3264) : !memref_smem_bf16_15
          %shape_3282 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3283 = cute.make_layout() : !cute.layout<"1:0">
          %append_3284 = cute.append_to_rank<2> (%lay_3281, %lay_3283) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3285 = cute.make_view(%iter_3265, %append_3284) : !memref_smem_bf16_15
          %iter_3286 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %lay_3287 = cute.get_layout(%view_3285) : !memref_smem_bf16_15
          %1145 = cute.get_shape(%lay_3287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1145) : !cute.shape<"((8,1),1)">
          %iter_3291 = cute.get_iter(%view_3285) : !memref_smem_bf16_15
          %view_3292 = cute.make_view(%iter_3291) : !memref_smem_bf16_16
          %iter_3293 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3294 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %lay_3295 = cute.get_layout(%view_3271) : !memref_rmem_bf16_10
          %shape_3296 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3297 = cute.make_layout() : !cute.layout<"1:0">
          %append_3298 = cute.append_to_rank<2> (%lay_3295, %lay_3297) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3299 = cute.make_view(%iter_3272, %append_3298) : !memref_rmem_bf16_10
          %iter_3300 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %lay_3301 = cute.get_layout(%view_3299) : !memref_rmem_bf16_10
          %1146 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1146) : !cute.shape<"((8,1),1)">
          %iter_3305 = cute.get_iter(%view_3299) : !memref_rmem_bf16_10
          %view_3306 = cute.make_view(%iter_3305) : !memref_rmem_bf16_11
          %iter_3307 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %iter_3308 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3309 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %1147 = cute.get_shape(%lay_3309) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3310, %e1_3311, %e2_3312 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(1))">
          %lay_3313 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %1148 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3314, %e1_3315, %e2_3316 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(1))">
          %lay_3317 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %sz_3318 = cute.size(%lay_3317) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3319 = cute.get_leaves(%sz_3318) : !cute.int_tuple<"1">
          %lay_3320 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %sz_3321 = cute.size(%lay_3320) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3322 = cute.get_leaves(%sz_3321) : !cute.int_tuple<"1">
          %1149 = cute.static : !cute.layout<"1:0">
          %iter_3323 = cute.get_iter(%view_3292) : !memref_smem_bf16_16
          %iter_3324 = cute.get_iter(%view_3306) : !memref_rmem_bf16_11
          %lay_3325 = cute.get_layout(%view_3292) : !memref_smem_bf16_16
          %lay_3326 = cute.get_layout(%view_3306) : !memref_rmem_bf16_11
          %append_3327 = cute.append_to_rank<2> (%lay_3325, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3328 = cute.append_to_rank<2> (%lay_3326, %1149) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3329 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3330 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3331 = cute.size(%lay_3329) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1150 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
          %c0_i32_3332 = arith.constant 0 : i32
          %c1_i32_3333 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3332 to %1150 step %c1_i32_3333  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3329, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3329) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3415 = cute.add_offset(%iter_3323, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3330, %coord_3412) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3330) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3419 = cute.add_offset(%iter_3324, %idx_3418) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3416, %view_3420) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3335 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_9
          %idx_3336 = cute.crd2idx(%coord_3334, %lay_3335) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_3337 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_9
          %ptr_3338 = cute.add_offset(%iter_3337, %idx_3336) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3339 = cute.make_view(%ptr_3338) : !memref_smem_bf16_19
          %iter_3340 = cute.get_iter(%view_3339) : !memref_smem_bf16_19
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3342 = cute.get_layout(%retiled_477) : !memref_rmem_bf16_4
          %idx_3343 = cute.crd2idx(%coord_3341, %lay_3342) : (!cute.coord<"(_,_,8)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"32">
          %iter_3344 = cute.get_iter(%retiled_477) : !memref_rmem_bf16_4
          %ptr_3345 = cute.add_offset(%iter_3344, %idx_3343) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3346 = cute.make_view(%ptr_3345) : !memref_rmem_bf16_12
          %iter_3347 = cute.get_iter(%view_3346) : !memref_rmem_bf16_12
          %lay_3348 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %1151 = cute.get_shape(%lay_3348) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3349, %e1_3350, %e2_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4)">
          %lay_3352 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %1152 = cute.get_shape(%lay_3352) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3353, %e1_3354, %e2_3355, %e3_3356 = cute.get_leaves(%1152) : !cute.shape<"(((4,2),1),4)">
          %lay_3357 = cute.get_layout(%view_3339) : !memref_smem_bf16_19
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3340, %append_3360) : !memref_smem_bf16_19
          %iter_3362 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %lay_3363 = cute.get_layout(%view_3361) : !memref_smem_bf16_19
          %1153 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_smem_bf16_19
          %view_3368 = cute.make_view(%iter_3367) : !memref_smem_bf16_20
          %iter_3369 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3370 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %lay_3371 = cute.get_layout(%view_3346) : !memref_rmem_bf16_12
          %shape_3372 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3373 = cute.make_layout() : !cute.layout<"1:0">
          %append_3374 = cute.append_to_rank<2> (%lay_3371, %lay_3373) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3375 = cute.make_view(%iter_3347, %append_3374) : !memref_rmem_bf16_12
          %iter_3376 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %lay_3377 = cute.get_layout(%view_3375) : !memref_rmem_bf16_12
          %1154 = cute.get_shape(%lay_3377) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1154) : !cute.shape<"(((4,2),1),4)">
          %iter_3382 = cute.get_iter(%view_3375) : !memref_rmem_bf16_12
          %view_3383 = cute.make_view(%iter_3382) : !memref_rmem_bf16_13
          %iter_3384 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %iter_3385 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3386 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %1155 = cute.get_shape(%lay_3386) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3387, %e1_3388, %e2_3389 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4))">
          %lay_3390 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %1156 = cute.get_shape(%lay_3390) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1156) : !cute.shape<"(((4,2),1),(4))">
          %lay_3395 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"4">
          %lay_3398 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"4">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3368) : !memref_smem_bf16_20
          %iter_3402 = cute.get_iter(%view_3383) : !memref_rmem_bf16_13
          %lay_3403 = cute.get_layout(%view_3368) : !memref_smem_bf16_20
          %lay_3404 = cute.get_layout(%view_3383) : !memref_rmem_bf16_13
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1157) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1157) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3407 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3408 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3409 = cute.size(%lay_3407) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1158 = cute.get_scalars(%sz_3409) : !cute.int_tuple<"4">
          %c0_i32_3410 = arith.constant 0 : i32
          %c1_i32_3411 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3410 to %1158 step %c1_i32_3411  : i32 {
            %coord_3412 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3413 = cute.slice(%lay_3407, %coord_3412) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3414 = cute.crd2idx(%coord_3412, %lay_3407) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3415 = cute.add_offset(%iter_3401, %idx_3414) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3416 = cute.make_view(%ptr_3415, %slice_3413) : !memref_smem_bf16_14
            %slice_3417 = cute.slice(%lay_3408, %coord_3412) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3412, %lay_3408) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3419 = cute.add_offset(%iter_3402, %idx_3418) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3416, %view_3420) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2656 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_2657 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2658 = cute.crd2idx(%coord_2656, %lay_2657) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"56">
        %iter_2659 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2660 = cute.add_offset(%iter_2659, %idx_2658) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2661 = cute.make_view(%ptr_2660) : !memref_rmem_bf16_15
        %iter_2662 = cute.get_iter(%view_2661) : !memref_rmem_bf16_15
        %coord_2663 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_2664 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2665 = cute.crd2idx(%coord_2663, %lay_2664) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"208">
        %iter_2666 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2667 = cute.add_offset(%iter_2666, %idx_2665) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2668 = cute.make_view(%ptr_2667) : !memref_rmem_bf16_16
        %iter_2669 = cute.get_iter(%view_2668) : !memref_rmem_bf16_16
        %lay_2670 = cute.get_layout(%view_2661) : !memref_rmem_bf16_15
        %997 = cute.get_shape(%lay_2670) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2671, %e1_2672, %e2_2673, %e3_2674 = cute.get_leaves(%997) : !cute.shape<"((2,2,2),1)">
        %lay_2675 = cute.get_layout(%view_2668) : !memref_rmem_bf16_16
        %998 = cute.get_shape(%lay_2675) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2676, %e1_2677, %e2_2678, %e3_2679 = cute.get_leaves(%998) : !cute.shape<"((2,2),(2,4))">
        %iter_2680 = cute.get_iter(%view_2661) : !memref_rmem_bf16_15
        %iter_2681 = cute.get_iter(%view_2668) : !memref_rmem_bf16_16
        %iter_2682 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %iter_2683 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
        %lay_2684 = cute.get_layout(%view_2661) : !memref_rmem_bf16_15
        %lay_2685 = cute.get_layout(%view_2668) : !memref_rmem_bf16_16
        %lay_2686 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %lay_2687 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %999 = cute.static : !cute.layout<"1:0">
        %append_2688 = cute.append_to_rank<3> (%lay_2684, %999) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2689 = cute.append_to_rank<3> (%lay_2685, %999) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2690 = cute.size(%append_2688) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2691 = cute.size(%append_2688) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2692 = cute.size(%append_2689) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1000 = cute.get_scalars(%sz_2690) : !cute.int_tuple<"1">
        %1001 = cute.get_scalars(%sz_2691) : !cute.int_tuple<"1">
        %1002 = cute.get_scalars(%sz_2692) : !cute.int_tuple<"8">
        %c0_i32_2693 = arith.constant 0 : i32
        %c1_i32_2694 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2693 to %1000 step %c1_i32_2694  : i32 {
          scf.for %arg9 = %c0_i32_2693 to %1001 step %c1_i32_2694  : i32 {
            scf.for %arg10 = %c0_i32_2693 to %1002 step %c1_i32_2694  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_2688, %coord_3259) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_2688) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_2680, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_17
              %slice_3266 = cute.slice(%append_2689, %coord_3260) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_2689) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_2681, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_2686, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_2686) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_2682, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_2687, %coord_3261) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_2687) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_2683, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_2695 = arith.constant 1 : i32
        %c128_i32_2696 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_2695 number_of_threads = %c128_i32_2696
        %c0_i32_2697 = arith.constant 0 : i32
        %1003 = arith.cmpi sgt, %920, %c0_i32_2697 : i32
        scf.if %1003 {
          %int_tuple_3259 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3260 = cute.tuple_sub(%sub_2060, %int_tuple_3259) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1143 = cute.get_scalars(%sub_3260) : !cute.int_tuple<"?">
          %coord_3261 = cute.make_coord(%sub_3260) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_3262 = cute.get_layout(%src_partitioned_367) : !memref_gmem_bf16_6
          %slice_3263 = cute.slice(%lay_3262, %coord_3261) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_3264 = cute.crd2idx(%coord_3261, %lay_3262) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_3265 = cute.get_iter(%src_partitioned_367) : !memref_gmem_bf16_6
          %ptr_3266 = cute.add_offset(%iter_3265, %idx_3264) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_3267 = cute.make_view(%ptr_3266, %slice_3263) : !memref_gmem_bf16_5
          %iter_3268 = cute.get_iter(%view_3267) : !memref_gmem_bf16_5
          %coord_3269 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3270 = cute.get_layout(%dst_partitioned_370) : !memref_smem_bf16_3
          %idx_3271 = cute.crd2idx(%coord_3269, %lay_3270) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_3272 = cute.get_iter(%dst_partitioned_370) : !memref_smem_bf16_3
          %ptr_3273 = cute.add_offset(%iter_3272, %idx_3271) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3274 = cute.make_view(%ptr_3273) : !memref_smem_bf16_3
          %iter_3275 = cute.get_iter(%view_3274) : !memref_smem_bf16_3
          %coord_3276 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3277 = cute.get_layout(%rmem_680) : !memref_rmem_i8_
          %idx_3278 = cute.crd2idx(%coord_3276, %lay_3277) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_3279 = cute.get_iter(%rmem_680) : !memref_rmem_i8_
          %ptr_3280 = cute.add_offset(%iter_3279, %idx_3278) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_3281 = cute.make_view(%ptr_3280) : !memref_rmem_i8_
          %iter_3282 = cute.get_iter(%view_3281) : !memref_rmem_i8_
          %lay_3283 = cute.get_layout(%view_3267) : !memref_gmem_bf16_5
          %1144 = cute.get_shape(%lay_3283) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3284, %e1_3285, %e2_3286, %e3_3287 = cute.get_leaves(%1144) : !cute.shape<"((8,1),4,2)">
          %lay_3288 = cute.get_layout(%view_3274) : !memref_smem_bf16_3
          %1145 = cute.get_shape(%lay_3288) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3289, %e1_3290, %e2_3291, %e3_3292 = cute.get_leaves(%1145) : !cute.shape<"((8,1),4,2)">
          %lay_3293 = cute.get_layout(%view_3267) : !memref_gmem_bf16_5
          %shape_3294 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3295 = cute.make_layout() : !cute.layout<"1:0">
          %append_3296 = cute.append_to_rank<2> (%lay_3293, %lay_3295) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_3297 = cute.make_view(%iter_3268, %append_3296) : !memref_gmem_bf16_5
          %iter_3298 = cute.get_iter(%view_3297) : !memref_gmem_bf16_5
          %lay_3299 = cute.get_layout(%view_3297) : !memref_gmem_bf16_5
          %1146 = cute.get_shape(%lay_3299) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3300, %e1_3301, %e2_3302, %e3_3303 = cute.get_leaves(%1146) : !cute.shape<"((8,1),4,2)">
          %iter_3304 = cute.get_iter(%view_3297) : !memref_gmem_bf16_5
          %lay_3305 = cute.get_layout(%view_3297) : !memref_gmem_bf16_5
          %1147 = cute.get_scalars(%lay_3305) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_3306 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_3307 = cute.assume(%1147) : (i64) -> !cute.i64<divby 128>
          %stride_3308 = cute.make_stride(%iv_3307) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_3309 = cute.make_layout(%shape_3306, %stride_3308) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_3310 = cute.make_view(%iter_3304, %lay_3309) : !memref_gmem_bf16_13
          %iter_3311 = cute.get_iter(%view_3310) : !memref_gmem_bf16_13
          %iter_3312 = cute.get_iter(%view_3310) : !memref_gmem_bf16_13
          %lay_3313 = cute.get_layout(%view_3274) : !memref_smem_bf16_3
          %shape_3314 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3315 = cute.make_layout() : !cute.layout<"1:0">
          %append_3316 = cute.append_to_rank<2> (%lay_3313, %lay_3315) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_3317 = cute.make_view(%iter_3275, %append_3316) : !memref_smem_bf16_3
          %iter_3318 = cute.get_iter(%view_3317) : !memref_smem_bf16_3
          %lay_3319 = cute.get_layout(%view_3317) : !memref_smem_bf16_3
          %1148 = cute.get_shape(%lay_3319) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3320, %e1_3321, %e2_3322, %e3_3323 = cute.get_leaves(%1148) : !cute.shape<"((8,1),4,2)">
          %iter_3324 = cute.get_iter(%view_3317) : !memref_smem_bf16_3
          %view_3325 = cute.make_view(%iter_3324) : !memref_smem_bf16_17
          %iter_3326 = cute.get_iter(%view_3325) : !memref_smem_bf16_17
          %iter_3327 = cute.get_iter(%view_3325) : !memref_smem_bf16_17
          %lay_3328 = cute.get_layout(%view_3281) : !memref_rmem_i8_
          %shape_3329 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3330 = cute.make_layout() : !cute.layout<"1:0">
          %append_3331 = cute.append_to_rank<2> (%lay_3328, %lay_3330) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_3332 = cute.make_view(%iter_3282, %append_3331) : !memref_rmem_i8_
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_i8_
          %lay_3334 = cute.get_layout(%view_3332) : !memref_rmem_i8_
          %1149 = cute.get_shape(%lay_3334) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_3335, %e1_3336, %e2_3337 = cute.get_leaves(%1149) : !cute.shape<"(1,4,2)">
          %iter_3338 = cute.get_iter(%view_3332) : !memref_rmem_i8_
          %view_3339 = cute.make_view(%iter_3338) : !memref_rmem_i8_4
          %iter_3340 = cute.get_iter(%view_3339) : !memref_rmem_i8_4
          %iter_3341 = cute.get_iter(%view_3339) : !memref_rmem_i8_4
          %lay_3342 = cute.get_layout(%view_3310) : !memref_gmem_bf16_13
          %1150 = cute.get_shape(%lay_3342) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%1150) : !cute.shape<"((8,1),(4,2))">
          %lay_3347 = cute.get_layout(%view_3325) : !memref_smem_bf16_17
          %1151 = cute.get_shape(%lay_3347) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3348, %e1_3349, %e2_3350, %e3_3351 = cute.get_leaves(%1151) : !cute.shape<"((8,1),(4,2))">
          %lay_3352 = cute.get_layout(%view_3310) : !memref_gmem_bf16_13
          %sz_3353 = cute.size(%lay_3352) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_3354 = cute.get_leaves(%sz_3353) : !cute.int_tuple<"8">
          %lay_3355 = cute.get_layout(%view_3325) : !memref_smem_bf16_17
          %sz_3356 = cute.size(%lay_3355) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_3357 = cute.get_leaves(%sz_3356) : !cute.int_tuple<"8">
          %1152 = cute.static : !cute.layout<"1:0">
          %iter_3358 = cute.get_iter(%view_3310) : !memref_gmem_bf16_13
          %iter_3359 = cute.get_iter(%view_3325) : !memref_smem_bf16_17
          %lay_3360 = cute.get_layout(%view_3310) : !memref_gmem_bf16_13
          %lay_3361 = cute.get_layout(%view_3325) : !memref_smem_bf16_17
          %append_3362 = cute.append_to_rank<2> (%lay_3360, %1152) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_3363 = cute.append_to_rank<2> (%lay_3361, %1152) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1153 = cute.get_scalars(%append_3362) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_3364 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_3365 = cute.assume(%1153) : (i64) -> !cute.i64<divby 128>
          %stride_3366 = cute.make_stride(%iv_3365) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_3367 = cute.make_layout(%shape_3364, %stride_3366) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_3368 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_3369 = cute.get_iter(%view_3339) : !memref_rmem_i8_4
          %lay_3370 = cute.get_layout(%view_3339) : !memref_rmem_i8_4
          %append_3371 = cute.append_to_rank<2> (%lay_3370, %1152) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_3372 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_3373 = cute.size(%lay_3367) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1154 = cute.get_scalars(%sz_3373) : !cute.int_tuple<"8">
          %c0_i32_3374 = arith.constant 0 : i32
          %c1_i32_3375 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3374 to %1154 step %c1_i32_3375  : i32 {
            %coord_3514 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3515 = cute.slice(%lay_3367, %coord_3514) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_3516 = cute.crd2idx(%coord_3514, %lay_3367) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_3517 = cute.add_offset(%iter_3358, %idx_3516) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3518 = cute.make_view(%ptr_3517, %slice_3515) : !memref_gmem_bf16_10
            %slice_3519 = cute.slice(%lay_3368, %coord_3514) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_3520 = cute.crd2idx(%coord_3514, %lay_3368) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3521 = cute.add_offset(%iter_3359, %idx_3520) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3522 = cute.make_view(%ptr_3521, %slice_3519) : !memref_smem_bf16_14
            %slice_3523 = cute.slice(%lay_3372, %coord_3514) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_3524 = cute.crd2idx(%coord_3514, %lay_3372) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_3525 = cute.add_offset(%iter_3369, %idx_3524) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_3526 = cute.make_view(%ptr_3525, %slice_3523) : !memref_rmem_i8_3
            cute.copy_atom_call(%4, %view_3518, %view_3522, %view_3526) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %lay_3376 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %1155 = cute.get_shape(%lay_3376) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
          %e0_3377, %e1_3378, %e2_3379, %e3_3380, %e4_3381 = cute.get_leaves(%1155) : !cute.shape<"((8,1),4,1,?)">
          %itup_3382 = cute.to_int_tuple(%e4_3381) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1156 = cute.get_scalars(%itup_3382) : !cute.int_tuple<"?">
          %int_tuple_3383 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_3384 = cute.size(%int_tuple_3383) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_3385 = cute.get_leaves(%sz_3384) : !cute.int_tuple<"4">
          %coord_3386 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
          %lay_3387 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3388 = cute.crd2idx(%coord_3386, %lay_3387) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
          %iter_3389 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3390 = cute.add_offset(%iter_3389, %idx_3388) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3391 = cute.make_view(%tup_3390) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3392 = cute.get_iter(%view_3391) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3393, %e1_3394, %e2_3395, %e3_3396 = cute.get_leaves(%iter_3392) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1157 = cute.get_scalars(%e0_3393) : !cute.int_tuple<"?">
          %1158 = cute.get_scalars(%e1_3394) : !cute.int_tuple<"?">
          %1159 = cute.get_scalars(%e2_3395) : !cute.int_tuple<"?">
          %1160 = cute.get_scalars(%e3_3396) : !cute.int_tuple<"?{div=8}">
          %iter_3397 = cute.get_iter(%view_3391) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3398, %e1_3399, %e2_3400, %e3_3401 = cute.get_leaves(%iter_3397) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1161 = cute.get_scalars(%e0_3398) : !cute.int_tuple<"?">
          %1162 = cute.get_scalars(%e1_3399) : !cute.int_tuple<"?">
          %1163 = cute.get_scalars(%e2_3400) : !cute.int_tuple<"?">
          %1164 = cute.get_scalars(%e3_3401) : !cute.int_tuple<"?{div=8}">
          %iter_3402 = cute.get_iter(%view_3391) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3403, %e1_3404, %e2_3405, %e3_3406 = cute.get_leaves(%iter_3402) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1165 = cute.get_scalars(%e0_3403) : !cute.int_tuple<"?">
          %1166 = cute.get_scalars(%e1_3404) : !cute.int_tuple<"?">
          %1167 = cute.get_scalars(%e2_3405) : !cute.int_tuple<"?">
          %1168 = cute.get_scalars(%e3_3406) : !cute.int_tuple<"?{div=8}">
          %lay_3407 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1169 = cute.get_shape(%lay_3407) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3408, %e1_3409, %e2_3410, %e3_3411 = cute.get_leaves(%1169) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3412 = cute.to_int_tuple(%e0_3408) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1170 = cute.get_scalars(%itup_3412) : !cute.int_tuple<"?">
          %itup_3413 = cute.to_int_tuple(%e1_3409) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1171 = cute.get_scalars(%itup_3413) : !cute.int_tuple<"?">
          %itup_3414 = cute.to_int_tuple(%e2_3410) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1172 = cute.get_scalars(%itup_3414) : !cute.int_tuple<"?">
          %itup_3415 = cute.to_int_tuple(%e3_3411) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1173 = cute.get_scalars(%itup_3415) : !cute.int_tuple<"?{div=8}">
          %coord_3416 = cute.make_coord(%e1_3404) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3417 = cute.make_coord(%itup_3414) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1174 = cute.elem_less(%coord_3416, %coord_3417) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1174 {
            %int_tuple_3514 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3515 = cute.tuple_sub(%sub_2060, %int_tuple_3514) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1229 = cute.get_scalars(%sub_3515) : !cute.int_tuple<"?">
            %coord_3516 = cute.make_coord(%sub_3515) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_3517 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
            %idx_3518 = cute.crd2idx(%coord_3516, %lay_3517) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
            %iter_3519 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
            %ptr_3520 = cute.add_offset(%iter_3519, %idx_3518) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3521 = cute.make_view(%ptr_3520) : !memref_gmem_bf16_11
            %iter_3522 = cute.get_iter(%view_3521) : !memref_gmem_bf16_11
            %coord_3523 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3524 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3525 = cute.crd2idx(%coord_3523, %lay_3524) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_3526 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3527 = cute.add_offset(%iter_3526, %idx_3525) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3528 = cute.make_view(%ptr_3527) : !memref_smem_bf16_15
            %iter_3529 = cute.get_iter(%view_3528) : !memref_smem_bf16_15
            %lay_3530 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %1230 = cute.get_shape(%lay_3530) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3531, %e1_3532, %e2_3533 = cute.get_leaves(%1230) : !cute.shape<"((8,1),1)">
            %lay_3534 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %1231 = cute.get_shape(%lay_3534) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3535, %e1_3536, %e2_3537 = cute.get_leaves(%1231) : !cute.shape<"((8,1),1)">
            %lay_3538 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %shape_3539 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3540 = cute.make_layout() : !cute.layout<"1:0">
            %append_3541 = cute.append_to_rank<2> (%lay_3538, %lay_3540) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3542 = cute.make_view(%iter_3522, %append_3541) : !memref_gmem_bf16_11
            %iter_3543 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %lay_3544 = cute.get_layout(%view_3542) : !memref_gmem_bf16_11
            %1232 = cute.get_shape(%lay_3544) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3545, %e1_3546, %e2_3547 = cute.get_leaves(%1232) : !cute.shape<"((8,1),1)">
            %iter_3548 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %view_3549 = cute.make_view(%iter_3548) : !memref_gmem_bf16_12
            %iter_3550 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3551 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %lay_3552 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %shape_3553 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3554 = cute.make_layout() : !cute.layout<"1:0">
            %append_3555 = cute.append_to_rank<2> (%lay_3552, %lay_3554) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3556 = cute.make_view(%iter_3529, %append_3555) : !memref_smem_bf16_15
            %iter_3557 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %lay_3558 = cute.get_layout(%view_3556) : !memref_smem_bf16_15
            %1233 = cute.get_shape(%lay_3558) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3559, %e1_3560, %e2_3561 = cute.get_leaves(%1233) : !cute.shape<"((8,1),1)">
            %iter_3562 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %view_3563 = cute.make_view(%iter_3562) : !memref_smem_bf16_16
            %iter_3564 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %iter_3565 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3566 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %1234 = cute.get_shape(%lay_3566) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3567, %e1_3568, %e2_3569 = cute.get_leaves(%1234) : !cute.shape<"((8,1),(1))">
            %lay_3570 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %1235 = cute.get_shape(%lay_3570) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3571, %e1_3572, %e2_3573 = cute.get_leaves(%1235) : !cute.shape<"((8,1),(1))">
            %lay_3574 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %sz_3575 = cute.size(%lay_3574) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3576 = cute.get_leaves(%sz_3575) : !cute.int_tuple<"1">
            %lay_3577 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %sz_3578 = cute.size(%lay_3577) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3579 = cute.get_leaves(%sz_3578) : !cute.int_tuple<"1">
            %1236 = cute.static : !cute.layout<"1:0">
            %iter_3580 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3581 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3582 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %lay_3583 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %append_3584 = cute.append_to_rank<2> (%lay_3582, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3585 = cute.append_to_rank<2> (%lay_3583, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3586 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3587 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3588 = cute.size(%lay_3586) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1237 = cute.get_scalars(%sz_3588) : !cute.int_tuple<"1">
            %c0_i32_3589 = arith.constant 0 : i32
            %c1_i32_3590 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3589 to %1237 step %c1_i32_3590  : i32 {
              %coord_3591 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3592 = cute.slice(%lay_3586, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3593 = cute.crd2idx(%coord_3591, %lay_3586) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3594 = cute.add_offset(%iter_3580, %idx_3593) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3595 = cute.make_view(%ptr_3594, %slice_3592) : !memref_gmem_bf16_10
              %slice_3596 = cute.slice(%lay_3587, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3597 = cute.crd2idx(%coord_3591, %lay_3587) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3598 = cute.add_offset(%iter_3581, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3599 = cute.make_view(%ptr_3598, %slice_3596) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3595, %view_3599) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3514 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3515 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3516 = cute.crd2idx(%coord_3514, %lay_3515) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_3517 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3518 = cute.add_offset(%iter_3517, %idx_3516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3519 = cute.make_view(%ptr_3518) : !memref_smem_bf16_15
            %iter_3520 = cute.get_iter(%view_3519) : !memref_smem_bf16_15
            %lay_3521 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %sz_3522 = cute.size(%lay_3521) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3523 = cute.get_leaves(%sz_3522) : !cute.int_tuple<"8">
            %lay_3524 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %1229 = cute.get_shape(%lay_3524) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3525, %e1_3526, %e2_3527 = cute.get_leaves(%1229) : !cute.shape<"((8,1),1)">
            %int_tuple_3528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3529 = cute.tuple.product(%int_tuple_3528) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3530 = cute.get_leaves(%res_3529) : !cute.int_tuple<"8">
            %cst_3531 = arith.constant 0.000000e+00 : bf16
            %1230 = vector.splat %cst_3531 : vector<8xbf16>
            %int_tuple_3532 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3533 = cute.size(%int_tuple_3532) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3534 = cute.get_leaves(%sz_3533) : !cute.int_tuple<"8">
            %int_tuple_3535 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3536 = cute.size(%int_tuple_3535) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3537 = cute.get_leaves(%sz_3536) : !cute.int_tuple<"8">
            cute.memref.store_vec %1230, %view_3519, row_major : !memref_smem_bf16_15
          }
          %coord_3418 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
          %lay_3419 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3420 = cute.crd2idx(%coord_3418, %lay_3419) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
          %iter_3421 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3422 = cute.add_offset(%iter_3421, %idx_3420) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3423 = cute.make_view(%tup_3422) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3424 = cute.get_iter(%view_3423) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3425, %e1_3426, %e2_3427, %e3_3428 = cute.get_leaves(%iter_3424) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1175 = cute.get_scalars(%e0_3425) : !cute.int_tuple<"?">
          %1176 = cute.get_scalars(%e1_3426) : !cute.int_tuple<"?">
          %1177 = cute.get_scalars(%e2_3427) : !cute.int_tuple<"?">
          %1178 = cute.get_scalars(%e3_3428) : !cute.int_tuple<"?{div=8}">
          %iter_3429 = cute.get_iter(%view_3423) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3430, %e1_3431, %e2_3432, %e3_3433 = cute.get_leaves(%iter_3429) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1179 = cute.get_scalars(%e0_3430) : !cute.int_tuple<"?">
          %1180 = cute.get_scalars(%e1_3431) : !cute.int_tuple<"?">
          %1181 = cute.get_scalars(%e2_3432) : !cute.int_tuple<"?">
          %1182 = cute.get_scalars(%e3_3433) : !cute.int_tuple<"?{div=8}">
          %iter_3434 = cute.get_iter(%view_3423) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3435, %e1_3436, %e2_3437, %e3_3438 = cute.get_leaves(%iter_3434) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1183 = cute.get_scalars(%e0_3435) : !cute.int_tuple<"?">
          %1184 = cute.get_scalars(%e1_3436) : !cute.int_tuple<"?">
          %1185 = cute.get_scalars(%e2_3437) : !cute.int_tuple<"?">
          %1186 = cute.get_scalars(%e3_3438) : !cute.int_tuple<"?{div=8}">
          %lay_3439 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1187 = cute.get_shape(%lay_3439) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3440, %e1_3441, %e2_3442, %e3_3443 = cute.get_leaves(%1187) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3444 = cute.to_int_tuple(%e0_3440) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1188 = cute.get_scalars(%itup_3444) : !cute.int_tuple<"?">
          %itup_3445 = cute.to_int_tuple(%e1_3441) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1189 = cute.get_scalars(%itup_3445) : !cute.int_tuple<"?">
          %itup_3446 = cute.to_int_tuple(%e2_3442) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1190 = cute.get_scalars(%itup_3446) : !cute.int_tuple<"?">
          %itup_3447 = cute.to_int_tuple(%e3_3443) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1191 = cute.get_scalars(%itup_3447) : !cute.int_tuple<"?{div=8}">
          %coord_3448 = cute.make_coord(%e1_3436) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3449 = cute.make_coord(%itup_3446) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1192 = cute.elem_less(%coord_3448, %coord_3449) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1192 {
            %int_tuple_3514 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3515 = cute.tuple_sub(%sub_2060, %int_tuple_3514) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1229 = cute.get_scalars(%sub_3515) : !cute.int_tuple<"?">
            %coord_3516 = cute.make_coord(%sub_3515) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_3517 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
            %idx_3518 = cute.crd2idx(%coord_3516, %lay_3517) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_3519 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
            %ptr_3520 = cute.add_offset(%iter_3519, %idx_3518) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3521 = cute.make_view(%ptr_3520) : !memref_gmem_bf16_11
            %iter_3522 = cute.get_iter(%view_3521) : !memref_gmem_bf16_11
            %coord_3523 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3524 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3525 = cute.crd2idx(%coord_3523, %lay_3524) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_3526 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3527 = cute.add_offset(%iter_3526, %idx_3525) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3528 = cute.make_view(%ptr_3527) : !memref_smem_bf16_15
            %iter_3529 = cute.get_iter(%view_3528) : !memref_smem_bf16_15
            %lay_3530 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %1230 = cute.get_shape(%lay_3530) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3531, %e1_3532, %e2_3533 = cute.get_leaves(%1230) : !cute.shape<"((8,1),1)">
            %lay_3534 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %1231 = cute.get_shape(%lay_3534) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3535, %e1_3536, %e2_3537 = cute.get_leaves(%1231) : !cute.shape<"((8,1),1)">
            %lay_3538 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %shape_3539 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3540 = cute.make_layout() : !cute.layout<"1:0">
            %append_3541 = cute.append_to_rank<2> (%lay_3538, %lay_3540) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3542 = cute.make_view(%iter_3522, %append_3541) : !memref_gmem_bf16_11
            %iter_3543 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %lay_3544 = cute.get_layout(%view_3542) : !memref_gmem_bf16_11
            %1232 = cute.get_shape(%lay_3544) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3545, %e1_3546, %e2_3547 = cute.get_leaves(%1232) : !cute.shape<"((8,1),1)">
            %iter_3548 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %view_3549 = cute.make_view(%iter_3548) : !memref_gmem_bf16_12
            %iter_3550 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3551 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %lay_3552 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %shape_3553 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3554 = cute.make_layout() : !cute.layout<"1:0">
            %append_3555 = cute.append_to_rank<2> (%lay_3552, %lay_3554) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3556 = cute.make_view(%iter_3529, %append_3555) : !memref_smem_bf16_15
            %iter_3557 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %lay_3558 = cute.get_layout(%view_3556) : !memref_smem_bf16_15
            %1233 = cute.get_shape(%lay_3558) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3559, %e1_3560, %e2_3561 = cute.get_leaves(%1233) : !cute.shape<"((8,1),1)">
            %iter_3562 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %view_3563 = cute.make_view(%iter_3562) : !memref_smem_bf16_16
            %iter_3564 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %iter_3565 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3566 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %1234 = cute.get_shape(%lay_3566) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3567, %e1_3568, %e2_3569 = cute.get_leaves(%1234) : !cute.shape<"((8,1),(1))">
            %lay_3570 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %1235 = cute.get_shape(%lay_3570) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3571, %e1_3572, %e2_3573 = cute.get_leaves(%1235) : !cute.shape<"((8,1),(1))">
            %lay_3574 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %sz_3575 = cute.size(%lay_3574) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3576 = cute.get_leaves(%sz_3575) : !cute.int_tuple<"1">
            %lay_3577 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %sz_3578 = cute.size(%lay_3577) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3579 = cute.get_leaves(%sz_3578) : !cute.int_tuple<"1">
            %1236 = cute.static : !cute.layout<"1:0">
            %iter_3580 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3581 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3582 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %lay_3583 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %append_3584 = cute.append_to_rank<2> (%lay_3582, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3585 = cute.append_to_rank<2> (%lay_3583, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3586 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3587 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3588 = cute.size(%lay_3586) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1237 = cute.get_scalars(%sz_3588) : !cute.int_tuple<"1">
            %c0_i32_3589 = arith.constant 0 : i32
            %c1_i32_3590 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3589 to %1237 step %c1_i32_3590  : i32 {
              %coord_3591 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3592 = cute.slice(%lay_3586, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3593 = cute.crd2idx(%coord_3591, %lay_3586) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3594 = cute.add_offset(%iter_3580, %idx_3593) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3595 = cute.make_view(%ptr_3594, %slice_3592) : !memref_gmem_bf16_10
              %slice_3596 = cute.slice(%lay_3587, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3597 = cute.crd2idx(%coord_3591, %lay_3587) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3598 = cute.add_offset(%iter_3581, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3599 = cute.make_view(%ptr_3598, %slice_3596) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3595, %view_3599) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3514 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3515 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3516 = cute.crd2idx(%coord_3514, %lay_3515) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_3517 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3518 = cute.add_offset(%iter_3517, %idx_3516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3519 = cute.make_view(%ptr_3518) : !memref_smem_bf16_15
            %iter_3520 = cute.get_iter(%view_3519) : !memref_smem_bf16_15
            %lay_3521 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %sz_3522 = cute.size(%lay_3521) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3523 = cute.get_leaves(%sz_3522) : !cute.int_tuple<"8">
            %lay_3524 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %1229 = cute.get_shape(%lay_3524) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3525, %e1_3526, %e2_3527 = cute.get_leaves(%1229) : !cute.shape<"((8,1),1)">
            %int_tuple_3528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3529 = cute.tuple.product(%int_tuple_3528) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3530 = cute.get_leaves(%res_3529) : !cute.int_tuple<"8">
            %cst_3531 = arith.constant 0.000000e+00 : bf16
            %1230 = vector.splat %cst_3531 : vector<8xbf16>
            %int_tuple_3532 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3533 = cute.size(%int_tuple_3532) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3534 = cute.get_leaves(%sz_3533) : !cute.int_tuple<"8">
            %int_tuple_3535 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3536 = cute.size(%int_tuple_3535) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3537 = cute.get_leaves(%sz_3536) : !cute.int_tuple<"8">
            cute.memref.store_vec %1230, %view_3519, row_major : !memref_smem_bf16_15
          }
          %coord_3450 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
          %lay_3451 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3452 = cute.crd2idx(%coord_3450, %lay_3451) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
          %iter_3453 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3454 = cute.add_offset(%iter_3453, %idx_3452) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3455 = cute.make_view(%tup_3454) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3456 = cute.get_iter(%view_3455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3457, %e1_3458, %e2_3459, %e3_3460 = cute.get_leaves(%iter_3456) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1193 = cute.get_scalars(%e0_3457) : !cute.int_tuple<"?">
          %1194 = cute.get_scalars(%e1_3458) : !cute.int_tuple<"?">
          %1195 = cute.get_scalars(%e2_3459) : !cute.int_tuple<"?">
          %1196 = cute.get_scalars(%e3_3460) : !cute.int_tuple<"?{div=8}">
          %iter_3461 = cute.get_iter(%view_3455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3462, %e1_3463, %e2_3464, %e3_3465 = cute.get_leaves(%iter_3461) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1197 = cute.get_scalars(%e0_3462) : !cute.int_tuple<"?">
          %1198 = cute.get_scalars(%e1_3463) : !cute.int_tuple<"?">
          %1199 = cute.get_scalars(%e2_3464) : !cute.int_tuple<"?">
          %1200 = cute.get_scalars(%e3_3465) : !cute.int_tuple<"?{div=8}">
          %iter_3466 = cute.get_iter(%view_3455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3467, %e1_3468, %e2_3469, %e3_3470 = cute.get_leaves(%iter_3466) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1201 = cute.get_scalars(%e0_3467) : !cute.int_tuple<"?">
          %1202 = cute.get_scalars(%e1_3468) : !cute.int_tuple<"?">
          %1203 = cute.get_scalars(%e2_3469) : !cute.int_tuple<"?">
          %1204 = cute.get_scalars(%e3_3470) : !cute.int_tuple<"?{div=8}">
          %lay_3471 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1205 = cute.get_shape(%lay_3471) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3472, %e1_3473, %e2_3474, %e3_3475 = cute.get_leaves(%1205) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3476 = cute.to_int_tuple(%e0_3472) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1206 = cute.get_scalars(%itup_3476) : !cute.int_tuple<"?">
          %itup_3477 = cute.to_int_tuple(%e1_3473) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1207 = cute.get_scalars(%itup_3477) : !cute.int_tuple<"?">
          %itup_3478 = cute.to_int_tuple(%e2_3474) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1208 = cute.get_scalars(%itup_3478) : !cute.int_tuple<"?">
          %itup_3479 = cute.to_int_tuple(%e3_3475) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1209 = cute.get_scalars(%itup_3479) : !cute.int_tuple<"?{div=8}">
          %coord_3480 = cute.make_coord(%e1_3468) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3481 = cute.make_coord(%itup_3478) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1210 = cute.elem_less(%coord_3480, %coord_3481) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1210 {
            %int_tuple_3514 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3515 = cute.tuple_sub(%sub_2060, %int_tuple_3514) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1229 = cute.get_scalars(%sub_3515) : !cute.int_tuple<"?">
            %coord_3516 = cute.make_coord(%sub_3515) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_3517 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
            %idx_3518 = cute.crd2idx(%coord_3516, %lay_3517) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_3519 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
            %ptr_3520 = cute.add_offset(%iter_3519, %idx_3518) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3521 = cute.make_view(%ptr_3520) : !memref_gmem_bf16_11
            %iter_3522 = cute.get_iter(%view_3521) : !memref_gmem_bf16_11
            %coord_3523 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3524 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3525 = cute.crd2idx(%coord_3523, %lay_3524) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_3526 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3527 = cute.add_offset(%iter_3526, %idx_3525) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3528 = cute.make_view(%ptr_3527) : !memref_smem_bf16_15
            %iter_3529 = cute.get_iter(%view_3528) : !memref_smem_bf16_15
            %lay_3530 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %1230 = cute.get_shape(%lay_3530) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3531, %e1_3532, %e2_3533 = cute.get_leaves(%1230) : !cute.shape<"((8,1),1)">
            %lay_3534 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %1231 = cute.get_shape(%lay_3534) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3535, %e1_3536, %e2_3537 = cute.get_leaves(%1231) : !cute.shape<"((8,1),1)">
            %lay_3538 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %shape_3539 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3540 = cute.make_layout() : !cute.layout<"1:0">
            %append_3541 = cute.append_to_rank<2> (%lay_3538, %lay_3540) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3542 = cute.make_view(%iter_3522, %append_3541) : !memref_gmem_bf16_11
            %iter_3543 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %lay_3544 = cute.get_layout(%view_3542) : !memref_gmem_bf16_11
            %1232 = cute.get_shape(%lay_3544) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3545, %e1_3546, %e2_3547 = cute.get_leaves(%1232) : !cute.shape<"((8,1),1)">
            %iter_3548 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %view_3549 = cute.make_view(%iter_3548) : !memref_gmem_bf16_12
            %iter_3550 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3551 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %lay_3552 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %shape_3553 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3554 = cute.make_layout() : !cute.layout<"1:0">
            %append_3555 = cute.append_to_rank<2> (%lay_3552, %lay_3554) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3556 = cute.make_view(%iter_3529, %append_3555) : !memref_smem_bf16_15
            %iter_3557 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %lay_3558 = cute.get_layout(%view_3556) : !memref_smem_bf16_15
            %1233 = cute.get_shape(%lay_3558) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3559, %e1_3560, %e2_3561 = cute.get_leaves(%1233) : !cute.shape<"((8,1),1)">
            %iter_3562 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %view_3563 = cute.make_view(%iter_3562) : !memref_smem_bf16_16
            %iter_3564 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %iter_3565 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3566 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %1234 = cute.get_shape(%lay_3566) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3567, %e1_3568, %e2_3569 = cute.get_leaves(%1234) : !cute.shape<"((8,1),(1))">
            %lay_3570 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %1235 = cute.get_shape(%lay_3570) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3571, %e1_3572, %e2_3573 = cute.get_leaves(%1235) : !cute.shape<"((8,1),(1))">
            %lay_3574 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %sz_3575 = cute.size(%lay_3574) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3576 = cute.get_leaves(%sz_3575) : !cute.int_tuple<"1">
            %lay_3577 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %sz_3578 = cute.size(%lay_3577) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3579 = cute.get_leaves(%sz_3578) : !cute.int_tuple<"1">
            %1236 = cute.static : !cute.layout<"1:0">
            %iter_3580 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3581 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3582 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %lay_3583 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %append_3584 = cute.append_to_rank<2> (%lay_3582, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3585 = cute.append_to_rank<2> (%lay_3583, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3586 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3587 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3588 = cute.size(%lay_3586) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1237 = cute.get_scalars(%sz_3588) : !cute.int_tuple<"1">
            %c0_i32_3589 = arith.constant 0 : i32
            %c1_i32_3590 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3589 to %1237 step %c1_i32_3590  : i32 {
              %coord_3591 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3592 = cute.slice(%lay_3586, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3593 = cute.crd2idx(%coord_3591, %lay_3586) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3594 = cute.add_offset(%iter_3580, %idx_3593) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3595 = cute.make_view(%ptr_3594, %slice_3592) : !memref_gmem_bf16_10
              %slice_3596 = cute.slice(%lay_3587, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3597 = cute.crd2idx(%coord_3591, %lay_3587) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3598 = cute.add_offset(%iter_3581, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3599 = cute.make_view(%ptr_3598, %slice_3596) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3595, %view_3599) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3514 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3515 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3516 = cute.crd2idx(%coord_3514, %lay_3515) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_3517 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3518 = cute.add_offset(%iter_3517, %idx_3516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3519 = cute.make_view(%ptr_3518) : !memref_smem_bf16_15
            %iter_3520 = cute.get_iter(%view_3519) : !memref_smem_bf16_15
            %lay_3521 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %sz_3522 = cute.size(%lay_3521) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3523 = cute.get_leaves(%sz_3522) : !cute.int_tuple<"8">
            %lay_3524 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %1229 = cute.get_shape(%lay_3524) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3525, %e1_3526, %e2_3527 = cute.get_leaves(%1229) : !cute.shape<"((8,1),1)">
            %int_tuple_3528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3529 = cute.tuple.product(%int_tuple_3528) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3530 = cute.get_leaves(%res_3529) : !cute.int_tuple<"8">
            %cst_3531 = arith.constant 0.000000e+00 : bf16
            %1230 = vector.splat %cst_3531 : vector<8xbf16>
            %int_tuple_3532 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3533 = cute.size(%int_tuple_3532) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3534 = cute.get_leaves(%sz_3533) : !cute.int_tuple<"8">
            %int_tuple_3535 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3536 = cute.size(%int_tuple_3535) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3537 = cute.get_leaves(%sz_3536) : !cute.int_tuple<"8">
            cute.memref.store_vec %1230, %view_3519, row_major : !memref_smem_bf16_15
          }
          %coord_3482 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
          %lay_3483 = cute.get_layout(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3484 = cute.crd2idx(%coord_3482, %lay_3483) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
          %iter_3485 = cute.get_iter(%src_partitioned_637) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3486 = cute.add_offset(%iter_3485, %idx_3484) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3487 = cute.make_view(%tup_3486) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3488 = cute.get_iter(%view_3487) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3489, %e1_3490, %e2_3491, %e3_3492 = cute.get_leaves(%iter_3488) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1211 = cute.get_scalars(%e0_3489) : !cute.int_tuple<"?">
          %1212 = cute.get_scalars(%e1_3490) : !cute.int_tuple<"?">
          %1213 = cute.get_scalars(%e2_3491) : !cute.int_tuple<"?">
          %1214 = cute.get_scalars(%e3_3492) : !cute.int_tuple<"?{div=8}">
          %iter_3493 = cute.get_iter(%view_3487) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3494, %e1_3495, %e2_3496, %e3_3497 = cute.get_leaves(%iter_3493) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1215 = cute.get_scalars(%e0_3494) : !cute.int_tuple<"?">
          %1216 = cute.get_scalars(%e1_3495) : !cute.int_tuple<"?">
          %1217 = cute.get_scalars(%e2_3496) : !cute.int_tuple<"?">
          %1218 = cute.get_scalars(%e3_3497) : !cute.int_tuple<"?{div=8}">
          %iter_3498 = cute.get_iter(%view_3487) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3499, %e1_3500, %e2_3501, %e3_3502 = cute.get_leaves(%iter_3498) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1219 = cute.get_scalars(%e0_3499) : !cute.int_tuple<"?">
          %1220 = cute.get_scalars(%e1_3500) : !cute.int_tuple<"?">
          %1221 = cute.get_scalars(%e2_3501) : !cute.int_tuple<"?">
          %1222 = cute.get_scalars(%e3_3502) : !cute.int_tuple<"?{div=8}">
          %lay_3503 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1223 = cute.get_shape(%lay_3503) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3504, %e1_3505, %e2_3506, %e3_3507 = cute.get_leaves(%1223) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3508 = cute.to_int_tuple(%e0_3504) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1224 = cute.get_scalars(%itup_3508) : !cute.int_tuple<"?">
          %itup_3509 = cute.to_int_tuple(%e1_3505) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1225 = cute.get_scalars(%itup_3509) : !cute.int_tuple<"?">
          %itup_3510 = cute.to_int_tuple(%e2_3506) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1226 = cute.get_scalars(%itup_3510) : !cute.int_tuple<"?">
          %itup_3511 = cute.to_int_tuple(%e3_3507) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1227 = cute.get_scalars(%itup_3511) : !cute.int_tuple<"?{div=8}">
          %coord_3512 = cute.make_coord(%e1_3500) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3513 = cute.make_coord(%itup_3510) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1228 = cute.elem_less(%coord_3512, %coord_3513) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1228 {
            %int_tuple_3514 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3515 = cute.tuple_sub(%sub_2060, %int_tuple_3514) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1229 = cute.get_scalars(%sub_3515) : !cute.int_tuple<"?">
            %coord_3516 = cute.make_coord(%sub_3515) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_3517 = cute.get_layout(%src_partitioned_379) : !memref_gmem_bf16_7
            %idx_3518 = cute.crd2idx(%coord_3516, %lay_3517) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_3519 = cute.get_iter(%src_partitioned_379) : !memref_gmem_bf16_7
            %ptr_3520 = cute.add_offset(%iter_3519, %idx_3518) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3521 = cute.make_view(%ptr_3520) : !memref_gmem_bf16_11
            %iter_3522 = cute.get_iter(%view_3521) : !memref_gmem_bf16_11
            %coord_3523 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3524 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3525 = cute.crd2idx(%coord_3523, %lay_3524) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_3526 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3527 = cute.add_offset(%iter_3526, %idx_3525) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3528 = cute.make_view(%ptr_3527) : !memref_smem_bf16_15
            %iter_3529 = cute.get_iter(%view_3528) : !memref_smem_bf16_15
            %lay_3530 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %1230 = cute.get_shape(%lay_3530) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3531, %e1_3532, %e2_3533 = cute.get_leaves(%1230) : !cute.shape<"((8,1),1)">
            %lay_3534 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %1231 = cute.get_shape(%lay_3534) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3535, %e1_3536, %e2_3537 = cute.get_leaves(%1231) : !cute.shape<"((8,1),1)">
            %lay_3538 = cute.get_layout(%view_3521) : !memref_gmem_bf16_11
            %shape_3539 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3540 = cute.make_layout() : !cute.layout<"1:0">
            %append_3541 = cute.append_to_rank<2> (%lay_3538, %lay_3540) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3542 = cute.make_view(%iter_3522, %append_3541) : !memref_gmem_bf16_11
            %iter_3543 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %lay_3544 = cute.get_layout(%view_3542) : !memref_gmem_bf16_11
            %1232 = cute.get_shape(%lay_3544) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3545, %e1_3546, %e2_3547 = cute.get_leaves(%1232) : !cute.shape<"((8,1),1)">
            %iter_3548 = cute.get_iter(%view_3542) : !memref_gmem_bf16_11
            %view_3549 = cute.make_view(%iter_3548) : !memref_gmem_bf16_12
            %iter_3550 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3551 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %lay_3552 = cute.get_layout(%view_3528) : !memref_smem_bf16_15
            %shape_3553 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3554 = cute.make_layout() : !cute.layout<"1:0">
            %append_3555 = cute.append_to_rank<2> (%lay_3552, %lay_3554) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3556 = cute.make_view(%iter_3529, %append_3555) : !memref_smem_bf16_15
            %iter_3557 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %lay_3558 = cute.get_layout(%view_3556) : !memref_smem_bf16_15
            %1233 = cute.get_shape(%lay_3558) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3559, %e1_3560, %e2_3561 = cute.get_leaves(%1233) : !cute.shape<"((8,1),1)">
            %iter_3562 = cute.get_iter(%view_3556) : !memref_smem_bf16_15
            %view_3563 = cute.make_view(%iter_3562) : !memref_smem_bf16_16
            %iter_3564 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %iter_3565 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3566 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %1234 = cute.get_shape(%lay_3566) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3567, %e1_3568, %e2_3569 = cute.get_leaves(%1234) : !cute.shape<"((8,1),(1))">
            %lay_3570 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %1235 = cute.get_shape(%lay_3570) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3571, %e1_3572, %e2_3573 = cute.get_leaves(%1235) : !cute.shape<"((8,1),(1))">
            %lay_3574 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %sz_3575 = cute.size(%lay_3574) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3576 = cute.get_leaves(%sz_3575) : !cute.int_tuple<"1">
            %lay_3577 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %sz_3578 = cute.size(%lay_3577) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3579 = cute.get_leaves(%sz_3578) : !cute.int_tuple<"1">
            %1236 = cute.static : !cute.layout<"1:0">
            %iter_3580 = cute.get_iter(%view_3549) : !memref_gmem_bf16_12
            %iter_3581 = cute.get_iter(%view_3563) : !memref_smem_bf16_16
            %lay_3582 = cute.get_layout(%view_3549) : !memref_gmem_bf16_12
            %lay_3583 = cute.get_layout(%view_3563) : !memref_smem_bf16_16
            %append_3584 = cute.append_to_rank<2> (%lay_3582, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3585 = cute.append_to_rank<2> (%lay_3583, %1236) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3586 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3587 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3588 = cute.size(%lay_3586) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1237 = cute.get_scalars(%sz_3588) : !cute.int_tuple<"1">
            %c0_i32_3589 = arith.constant 0 : i32
            %c1_i32_3590 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3589 to %1237 step %c1_i32_3590  : i32 {
              %coord_3591 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3592 = cute.slice(%lay_3586, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3593 = cute.crd2idx(%coord_3591, %lay_3586) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3594 = cute.add_offset(%iter_3580, %idx_3593) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3595 = cute.make_view(%ptr_3594, %slice_3592) : !memref_gmem_bf16_10
              %slice_3596 = cute.slice(%lay_3587, %coord_3591) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3597 = cute.crd2idx(%coord_3591, %lay_3587) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3598 = cute.add_offset(%iter_3581, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3599 = cute.make_view(%ptr_3598, %slice_3596) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3595, %view_3599) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3514 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3515 = cute.get_layout(%dst_partitioned_382) : !memref_smem_bf16_4
            %idx_3516 = cute.crd2idx(%coord_3514, %lay_3515) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_3517 = cute.get_iter(%dst_partitioned_382) : !memref_smem_bf16_4
            %ptr_3518 = cute.add_offset(%iter_3517, %idx_3516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3519 = cute.make_view(%ptr_3518) : !memref_smem_bf16_15
            %iter_3520 = cute.get_iter(%view_3519) : !memref_smem_bf16_15
            %lay_3521 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %sz_3522 = cute.size(%lay_3521) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3523 = cute.get_leaves(%sz_3522) : !cute.int_tuple<"8">
            %lay_3524 = cute.get_layout(%view_3519) : !memref_smem_bf16_15
            %1229 = cute.get_shape(%lay_3524) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3525, %e1_3526, %e2_3527 = cute.get_leaves(%1229) : !cute.shape<"((8,1),1)">
            %int_tuple_3528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3529 = cute.tuple.product(%int_tuple_3528) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3530 = cute.get_leaves(%res_3529) : !cute.int_tuple<"8">
            %cst_3531 = arith.constant 0.000000e+00 : bf16
            %1230 = vector.splat %cst_3531 : vector<8xbf16>
            %int_tuple_3532 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3533 = cute.size(%int_tuple_3532) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3534 = cute.get_leaves(%sz_3533) : !cute.int_tuple<"8">
            %int_tuple_3535 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3536 = cute.size(%int_tuple_3535) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3537 = cute.get_leaves(%sz_3536) : !cute.int_tuple<"8">
            cute.memref.store_vec %1230, %view_3519, row_major : !memref_smem_bf16_15
          }
          nvvm.cp.async.commit.group
        }
        %lay_2698 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
        %1004 = cute.get_shape(%lay_2698) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2699, %e1_2700, %e2_2701, %e3_2702 = cute.get_leaves(%1004) : !cute.shape<"((2,2),1,8)">
        %1005 = cute.get_stride(%lay_2698) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2703, %e1_2704, %e2_2705, %e3_2706 = cute.get_leaves(%1005) : !cute.stride<"((1,2),0,4)">
        %1006 = scf.if %true -> (!memref_rmem_f32_1) {
          %iter_3259 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
          %lay_3260 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
          %1143 = cute.get_shape(%lay_3260) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3261, %e1_3262, %e2_3263, %e3_3264 = cute.get_leaves(%1143) : !cute.shape<"((2,2),1,8)">
          %1144 = cute.memref.load_vec %rmem_2070, row_major : !memref_rmem_f32_1
          %cst_3265 = arith.constant 5.000000e-01 : f32
          %1145 = vector.broadcast %cst_3265 : f32 to vector<32xf32>
          %1146 = arith.mulf %1144, %1145 : vector<32xf32>
          %int_tuple_3266 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3267 = cute.size(%int_tuple_3266) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3268 = cute.get_leaves(%sz_3267) : !cute.int_tuple<"32">
          %int_tuple_3269 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3270 = cute.size(%int_tuple_3269) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3271 = cute.get_leaves(%sz_3270) : !cute.int_tuple<"32">
          cute.memref.store_vec %1146, %rmem_2070, row_major : !memref_rmem_f32_1
          %int_tuple_3272 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_3273 = cute.size(%int_tuple_3272) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_3274 = cute.get_leaves(%sz_3273) : !cute.int_tuple<"4">
          %int_tuple_3275 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3276 = cute.size(%int_tuple_3275) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3277 = cute.get_leaves(%sz_3276) : !cute.int_tuple<"1">
          %int_tuple_3278 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3279 = cute.size(%int_tuple_3278) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3280 = cute.get_leaves(%sz_3279) : !cute.int_tuple<"8">
          %coord_3281 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %1147 = cute.memref.load(%rmem_2070, %coord_3281) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">) -> f32
          %1148 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1147 : (f32) -> f32
          %coord_3282 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          cute.memref.store(%rmem_2070, %coord_3282, %1148) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
          %coord_3283 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %1149 = cute.memref.load(%rmem_2070, %coord_3283) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">) -> f32
          %1150 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1149 : (f32) -> f32
          %coord_3284 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          cute.memref.store(%rmem_2070, %coord_3284, %1150) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
          %coord_3285 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %1151 = cute.memref.load(%rmem_2070, %coord_3285) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">) -> f32
          %1152 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1151 : (f32) -> f32
          %coord_3286 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          cute.memref.store(%rmem_2070, %coord_3286, %1152) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
          %coord_3287 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %1153 = cute.memref.load(%rmem_2070, %coord_3287) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">) -> f32
          %1154 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1153 : (f32) -> f32
          %coord_3288 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          cute.memref.store(%rmem_2070, %coord_3288, %1154) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
          %coord_3289 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %1155 = cute.memref.load(%rmem_2070, %coord_3289) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">) -> f32
          %1156 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1155 : (f32) -> f32
          %coord_3290 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          cute.memref.store(%rmem_2070, %coord_3290, %1156) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
          %coord_3291 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %1157 = cute.memref.load(%rmem_2070, %coord_3291) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">) -> f32
          %1158 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1157 : (f32) -> f32
          %coord_3292 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          cute.memref.store(%rmem_2070, %coord_3292, %1158) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
          %coord_3293 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %1159 = cute.memref.load(%rmem_2070, %coord_3293) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">) -> f32
          %1160 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1159 : (f32) -> f32
          %coord_3294 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          cute.memref.store(%rmem_2070, %coord_3294, %1160) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
          %coord_3295 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %1161 = cute.memref.load(%rmem_2070, %coord_3295) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">) -> f32
          %1162 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1161 : (f32) -> f32
          %coord_3296 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          cute.memref.store(%rmem_2070, %coord_3296, %1162) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
          %int_tuple_3297 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3298 = cute.size(%int_tuple_3297) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3299 = cute.get_leaves(%sz_3298) : !cute.int_tuple<"1">
          %int_tuple_3300 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3301 = cute.size(%int_tuple_3300) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3302 = cute.get_leaves(%sz_3301) : !cute.int_tuple<"8">
          %coord_3303 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %1163 = cute.memref.load(%rmem_2070, %coord_3303) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">) -> f32
          %1164 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1163 : (f32) -> f32
          %coord_3304 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          cute.memref.store(%rmem_2070, %coord_3304, %1164) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
          %coord_3305 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %1165 = cute.memref.load(%rmem_2070, %coord_3305) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">) -> f32
          %1166 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1165 : (f32) -> f32
          %coord_3306 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          cute.memref.store(%rmem_2070, %coord_3306, %1166) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
          %coord_3307 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %1167 = cute.memref.load(%rmem_2070, %coord_3307) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">) -> f32
          %1168 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1167 : (f32) -> f32
          %coord_3308 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          cute.memref.store(%rmem_2070, %coord_3308, %1168) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
          %coord_3309 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %1169 = cute.memref.load(%rmem_2070, %coord_3309) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">) -> f32
          %1170 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1169 : (f32) -> f32
          %coord_3310 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          cute.memref.store(%rmem_2070, %coord_3310, %1170) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
          %coord_3311 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %1171 = cute.memref.load(%rmem_2070, %coord_3311) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">) -> f32
          %1172 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1171 : (f32) -> f32
          %coord_3312 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          cute.memref.store(%rmem_2070, %coord_3312, %1172) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
          %coord_3313 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %1173 = cute.memref.load(%rmem_2070, %coord_3313) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">) -> f32
          %1174 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1173 : (f32) -> f32
          %coord_3314 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          cute.memref.store(%rmem_2070, %coord_3314, %1174) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
          %coord_3315 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %1175 = cute.memref.load(%rmem_2070, %coord_3315) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">) -> f32
          %1176 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1175 : (f32) -> f32
          %coord_3316 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          cute.memref.store(%rmem_2070, %coord_3316, %1176) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
          %coord_3317 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %1177 = cute.memref.load(%rmem_2070, %coord_3317) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">) -> f32
          %1178 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1177 : (f32) -> f32
          %coord_3318 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          cute.memref.store(%rmem_2070, %coord_3318, %1178) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
          %int_tuple_3319 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3320 = cute.size(%int_tuple_3319) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3321 = cute.get_leaves(%sz_3320) : !cute.int_tuple<"1">
          %int_tuple_3322 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3323 = cute.size(%int_tuple_3322) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3324 = cute.get_leaves(%sz_3323) : !cute.int_tuple<"8">
          %coord_3325 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %1179 = cute.memref.load(%rmem_2070, %coord_3325) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">) -> f32
          %1180 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1179 : (f32) -> f32
          %coord_3326 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          cute.memref.store(%rmem_2070, %coord_3326, %1180) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %1181 = cute.memref.load(%rmem_2070, %coord_3327) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">) -> f32
          %1182 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1181 : (f32) -> f32
          %coord_3328 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          cute.memref.store(%rmem_2070, %coord_3328, %1182) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
          %coord_3329 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %1183 = cute.memref.load(%rmem_2070, %coord_3329) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">) -> f32
          %1184 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1183 : (f32) -> f32
          %coord_3330 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          cute.memref.store(%rmem_2070, %coord_3330, %1184) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
          %coord_3331 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %1185 = cute.memref.load(%rmem_2070, %coord_3331) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">) -> f32
          %1186 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1185 : (f32) -> f32
          %coord_3332 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          cute.memref.store(%rmem_2070, %coord_3332, %1186) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
          %coord_3333 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %1187 = cute.memref.load(%rmem_2070, %coord_3333) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">) -> f32
          %1188 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1187 : (f32) -> f32
          %coord_3334 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          cute.memref.store(%rmem_2070, %coord_3334, %1188) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
          %coord_3335 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %1189 = cute.memref.load(%rmem_2070, %coord_3335) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">) -> f32
          %1190 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1189 : (f32) -> f32
          %coord_3336 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          cute.memref.store(%rmem_2070, %coord_3336, %1190) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
          %coord_3337 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %1191 = cute.memref.load(%rmem_2070, %coord_3337) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">) -> f32
          %1192 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1191 : (f32) -> f32
          %coord_3338 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          cute.memref.store(%rmem_2070, %coord_3338, %1192) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
          %coord_3339 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %1193 = cute.memref.load(%rmem_2070, %coord_3339) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">) -> f32
          %1194 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1193 : (f32) -> f32
          %coord_3340 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          cute.memref.store(%rmem_2070, %coord_3340, %1194) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
          %int_tuple_3341 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3342 = cute.size(%int_tuple_3341) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3343 = cute.get_leaves(%sz_3342) : !cute.int_tuple<"1">
          %int_tuple_3344 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3345 = cute.size(%int_tuple_3344) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3346 = cute.get_leaves(%sz_3345) : !cute.int_tuple<"8">
          %coord_3347 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %1195 = cute.memref.load(%rmem_2070, %coord_3347) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">) -> f32
          %1196 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1195 : (f32) -> f32
          %coord_3348 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          cute.memref.store(%rmem_2070, %coord_3348, %1196) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
          %coord_3349 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %1197 = cute.memref.load(%rmem_2070, %coord_3349) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">) -> f32
          %1198 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1197 : (f32) -> f32
          %coord_3350 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          cute.memref.store(%rmem_2070, %coord_3350, %1198) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
          %coord_3351 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %1199 = cute.memref.load(%rmem_2070, %coord_3351) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">) -> f32
          %1200 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1199 : (f32) -> f32
          %coord_3352 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          cute.memref.store(%rmem_2070, %coord_3352, %1200) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
          %coord_3353 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %1201 = cute.memref.load(%rmem_2070, %coord_3353) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">) -> f32
          %1202 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1201 : (f32) -> f32
          %coord_3354 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          cute.memref.store(%rmem_2070, %coord_3354, %1202) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
          %coord_3355 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %1203 = cute.memref.load(%rmem_2070, %coord_3355) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">) -> f32
          %1204 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1203 : (f32) -> f32
          %coord_3356 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          cute.memref.store(%rmem_2070, %coord_3356, %1204) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
          %coord_3357 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %1205 = cute.memref.load(%rmem_2070, %coord_3357) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">) -> f32
          %1206 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1205 : (f32) -> f32
          %coord_3358 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          cute.memref.store(%rmem_2070, %coord_3358, %1206) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
          %coord_3359 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %1207 = cute.memref.load(%rmem_2070, %coord_3359) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">) -> f32
          %1208 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1207 : (f32) -> f32
          %coord_3360 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          cute.memref.store(%rmem_2070, %coord_3360, %1208) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
          %coord_3361 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %1209 = cute.memref.load(%rmem_2070, %coord_3361) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">) -> f32
          %1210 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1209 : (f32) -> f32
          %coord_3362 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          cute.memref.store(%rmem_2070, %coord_3362, %1210) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
          %1211 = cute.memref.load_vec %rmem_2070, row_major : !memref_rmem_f32_1
          %1212 = arith.mulf %1146, %1211 : vector<32xf32>
          %1213 = arith.addf %1212, %1146 : vector<32xf32>
          %int_tuple_3363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3364 = cute.size(%int_tuple_3363) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3365 = cute.get_leaves(%sz_3364) : !cute.int_tuple<"32">
          %int_tuple_3366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3367 = cute.size(%int_tuple_3366) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3368 = cute.get_leaves(%sz_3367) : !cute.int_tuple<"32">
          cute.memref.store_vec %1213, %rmem_2070, row_major : !memref_rmem_f32_1
          %lay_3369 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
          %1214 = cute.get_shape(%lay_3369) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3370, %e1_3371, %e2_3372, %e3_3373 = cute.get_leaves(%1214) : !cute.shape<"((2,2),1,8)">
          %1215 = cute.get_stride(%lay_3369) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3374, %e1_3375, %e2_3376, %e3_3377 = cute.get_leaves(%1215) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2070 : !memref_rmem_f32_1
        } else {
          %iter_3259 = cute.get_iter(%rmem_2070) : !memref_rmem_f32_1
          %lay_3260 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
          %1143 = cute.get_shape(%lay_3260) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3261, %e1_3262, %e2_3263, %e3_3264 = cute.get_leaves(%1143) : !cute.shape<"((2,2),1,8)">
          %1144 = cute.memref.load_vec %rmem_2070, row_major : !memref_rmem_f32_1
          %cst_3265 = arith.constant -1.44269502 : f32
          %1145 = vector.broadcast %cst_3265 : f32 to vector<32xf32>
          %1146 = arith.mulf %1144, %1145 : vector<32xf32>
          %1147 = math.exp2 %1146 fastmath<fast> : vector<32xf32>
          %cst_3266 = arith.constant 1.000000e+00 : f32
          %1148 = vector.broadcast %cst_3266 : f32 to vector<32xf32>
          %1149 = arith.addf %1147, %1148 : vector<32xf32>
          %1150 = arith.divf %1144, %1149 : vector<32xf32>
          %int_tuple_3267 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3268 = cute.size(%int_tuple_3267) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3269 = cute.get_leaves(%sz_3268) : !cute.int_tuple<"32">
          %int_tuple_3270 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3271 = cute.size(%int_tuple_3270) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3272 = cute.get_leaves(%sz_3271) : !cute.int_tuple<"32">
          cute.memref.store_vec %1150, %rmem_2070, row_major : !memref_rmem_f32_1
          %lay_3273 = cute.get_layout(%rmem_2070) : !memref_rmem_f32_1
          %1151 = cute.get_shape(%lay_3273) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3274, %e1_3275, %e2_3276, %e3_3277 = cute.get_leaves(%1151) : !cute.shape<"((2,2),1,8)">
          %1152 = cute.get_stride(%lay_3273) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3278, %e1_3279, %e2_3280, %e3_3281 = cute.get_leaves(%1152) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2070 : !memref_rmem_f32_1
        }
        %iter_2707 = cute.get_iter(%1006) : !memref_rmem_f32_1
        %lay_2708 = cute.get_layout(%1006) : !memref_rmem_f32_1
        %1007 = cute.get_shape(%lay_2708) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2709, %e1_2710, %e2_2711, %e3_2712 = cute.get_leaves(%1007) : !cute.shape<"((2,2),1,8)">
        %1008 = cute.get_stride(%lay_2708) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2713, %e1_2714, %e2_2715, %e3_2716 = cute.get_leaves(%1008) : !cute.stride<"((1,2),0,4)">
        %iter_2717 = cute.get_iter(%1006) : !memref_rmem_f32_1
        %iter_2718 = cute.get_iter(%1006) : !memref_rmem_f32_1
        %lay_2719 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1009 = cute.get_shape(%lay_2719) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_2720, %e1_2721, %e2_2722, %e3_2723 = cute.get_leaves(%1009) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_2724 = cute.to_int_tuple(%e0_2720) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1010 = cute.get_scalars(%itup_2724) : !cute.int_tuple<"?">
        %itup_2725 = cute.to_int_tuple(%e1_2721) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1011 = cute.get_scalars(%itup_2725) : !cute.int_tuple<"?">
        %itup_2726 = cute.to_int_tuple(%e2_2722) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1012 = cute.get_scalars(%itup_2726) : !cute.int_tuple<"?">
        %itup_2727 = cute.to_int_tuple(%e3_2723) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1013 = cute.get_scalars(%itup_2727) : !cute.int_tuple<"?{div=8}">
        %lay_2728 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1014 = cute.get_shape(%lay_2728) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_2729, %e1_2730, %e2_2731, %e3_2732 = cute.get_leaves(%1014) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_2733 = cute.to_int_tuple(%e0_2729) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1015 = cute.get_scalars(%itup_2733) : !cute.int_tuple<"?">
        %itup_2734 = cute.to_int_tuple(%e1_2730) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1016 = cute.get_scalars(%itup_2734) : !cute.int_tuple<"?">
        %itup_2735 = cute.to_int_tuple(%e2_2731) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1017 = cute.get_scalars(%itup_2735) : !cute.int_tuple<"?">
        %itup_2736 = cute.to_int_tuple(%e3_2732) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1018 = cute.get_scalars(%itup_2736) : !cute.int_tuple<"?{div=8}">
        %shape_2737 = cute.make_shape(%itup_2726, %itup_2736) : (!cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?{div=8})">
        %1019 = cute.make_identity_tensor(%shape_2737) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_2738 = cute.get_iter(%1019) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_2739, %e1_2740 = cute.get_leaves(%iter_2738) : !cute.int_tuple<"(0,0)">
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,_)">
        %lay_2742 = cute.get_layout(%1019) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %slice_2743 = cute.slice(%lay_2742, %coord_2741) : !cute.layout<"(?,?{div=8}):(1@0,1@1)">, !cute.coord<"(_,_)">
        %int_tuple_2744 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0)">
        %view_2745 = cute.make_view(%int_tuple_2744, %slice_2743) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_2746 = cute.get_iter(%view_2745) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_2747, %e1_2748 = cute.get_leaves(%iter_2746) : !cute.int_tuple<"(0,0)">
        %tile_2749 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
        %coord_2750 = cute.make_coord(%sub_223, %sub_2060) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.coord<"(?,?)">
        %1020:2 = cute.get_scalars(%coord_2750) <{only_dynamic}> : !cute.coord<"(?,?)">
        %coord_2751 = cute.make_coord(%1020#0, %1020#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
        %lay_2752 = cute.get_layout(%view_2745) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %1021:2 = cute.get_scalars(%lay_2752) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %c64_i32_2753 = arith.constant 64 : i32
        %1022 = arith.ceildivsi %1021#0, %c64_i32_2753 : i32
        %c64_i32_2754 = arith.constant 64 : i32
        %1023 = arith.ceildivsi %1021#1, %c64_i32_2754 : i32
        %shape_2755 = cute.make_shape(%1022, %1023) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
        %stride_2756 = cute.make_stride() : () -> !cute.stride<"((1@0,1@1),(64@0,64@1))">
        %lay_2757 = cute.make_layout(%shape_2755, %stride_2756) : !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">
        %idx_2758 = cute.crd2idx(%coord_2751, %lay_2757) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %iter_2759 = cute.get_iter(%view_2745) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %tup_2760 = cute.add_offset(%iter_2759, %idx_2758) : (!cute.int_tuple<"(0,0)">, !cute.int_tuple<"(?{div=64},?{div=64})">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %view_2761 = cute.make_view(%tup_2760) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %iter_2762 = cute.get_iter(%view_2761) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %e0_2763, %e1_2764 = cute.get_leaves(%iter_2762) : !cute.int_tuple<"(?{div=64},?{div=64})">
        %1024 = cute.get_scalars(%e0_2763) : !cute.int_tuple<"?{div=64}">
        %1025 = cute.get_scalars(%e1_2764) : !cute.int_tuple<"?{div=64}">
        %lay_2765 = cute.get_layout(%1006) : !memref_rmem_f32_1
        %1026 = cute.get_shape(%lay_2765) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2766, %e1_2767, %e2_2768, %e3_2769 = cute.get_leaves(%1026) : !cute.shape<"((2,2),1,8)">
        %1027 = cute.get_stride(%lay_2765) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2770, %e1_2771, %e2_2772, %e3_2773 = cute.get_leaves(%1027) : !cute.stride<"((1,2),0,4)">
        %1028 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1029 = cute.get_shape(%1028) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_2774, %e1_2775, %e2_2776, %e3_2777 = cute.get_leaves(%1029) : !cute.shape<"(32,4,1,1)">
        %1030 = cute.get_stride(%1028) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_2778, %e1_2779, %e2_2780, %e3_2781 = cute.get_leaves(%1030) : !cute.stride<"(1,32,0,0)">
        %1031 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_2782, %e1_2783, %e2_2784 = cute.get_leaves(%1031) : !cute.tile<"[64:1;16:1;16:1]">
        %1032 = cute.get_shape(%e0_2782) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_2785 = cute.get_leaves(%1032) : !cute.shape<"64">
        %1033 = cute.get_stride(%e0_2782) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_2786 = cute.get_leaves(%1033) : !cute.stride<"1">
        %1034 = cute.get_shape(%e1_2783) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_2787 = cute.get_leaves(%1034) : !cute.shape<"16">
        %1035 = cute.get_stride(%e1_2783) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_2788 = cute.get_leaves(%1035) : !cute.stride<"1">
        %1036 = cute.get_shape(%e2_2784) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_2789 = cute.get_leaves(%1036) : !cute.shape<"16">
        %1037 = cute.get_stride(%e2_2784) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_2790 = cute.get_leaves(%1037) : !cute.stride<"1">
        %1038 = cute.static : !cute.layout<"32:1">
        %1039 = cute.get_shape(%1038) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_2791 = cute.get_leaves(%1039) : !cute.shape<"32">
        %1040 = cute.get_stride(%1038) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_2792 = cute.get_leaves(%1040) : !cute.stride<"1">
        %1041 = cute.static : !cute.shape<"(16,8,16)">
        %e0_2793, %e1_2794, %e2_2795 = cute.get_leaves(%1041) : !cute.shape<"(16,8,16)">
        %1042 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1043 = cute.get_shape(%1042) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_2796, %e1_2797, %e2_2798, %e3_2799, %e4_2800 = cute.get_leaves(%1043) : !cute.shape<"((4,8),(2,2,2))">
        %1044 = cute.get_stride(%1042) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_2801, %e1_2802, %e2_2803, %e3_2804, %e4_2805 = cute.get_leaves(%1044) : !cute.stride<"((32,1),(16,8,128))">
        %1045 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1046 = cute.get_shape(%1045) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_2806, %e1_2807, %e2_2808, %e3_2809 = cute.get_leaves(%1046) : !cute.shape<"((4,8),(2,2))">
        %1047 = cute.get_stride(%1045) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_2810, %e1_2811, %e2_2812, %e3_2813 = cute.get_leaves(%1047) : !cute.stride<"((16,1),(8,64))">
        %1048 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1049 = cute.get_shape(%1048) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_2814, %e1_2815, %e2_2816, %e3_2817 = cute.get_leaves(%1049) : !cute.shape<"((4,8),(2,2))">
        %1050 = cute.get_stride(%1048) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_2818, %e1_2819, %e2_2820, %e3_2821 = cute.get_leaves(%1050) : !cute.stride<"((32,1),(16,8))">
        %1051:2 = scf.if %false -> (!memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_) {
          %iter_3259 = cute.get_iter(%1006) : !memref_rmem_f32_1
          %coord_3260 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
          %ptn_C = cute.tiled.mma.partition C (%arg6, %view_2761, %coord_3260) : (!mma_bf16_bf16_f32_16x8x16_, !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %iter_3261 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %e0_3262, %e1_3263 = cute.get_leaves(%iter_3261) : !cute.int_tuple<"(?,?{div=2})">
          %1143 = cute.get_scalars(%e0_3262) : !cute.int_tuple<"?">
          %1144 = cute.get_scalars(%e1_3263) : !cute.int_tuple<"?{div=2}">
          %lay_3264 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %1145 = cute.get_shape(%lay_3264) : (!cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3265, %e1_3266, %e2_3267, %e3_3268 = cute.get_leaves(%1145) : !cute.shape<"((2,2),1,8)">
          %int_tuple_3269 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_3270 = cute.size(%int_tuple_3269) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_3271 = cute.get_leaves(%sz_3270) : !cute.int_tuple<"4">
          %int_tuple_3272 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3273 = cute.size(%int_tuple_3272) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3274 = cute.get_leaves(%sz_3273) : !cute.int_tuple<"1">
          %int_tuple_3275 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3276 = cute.size(%int_tuple_3275) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3277 = cute.get_leaves(%sz_3276) : !cute.int_tuple<"8">
          %coord_3278 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3279 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3280 = cute.crd2idx(%coord_3278, %lay_3279) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_3281 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3282 = cute.add_offset(%iter_3281, %idx_3280) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3283 = cute.make_view(%tup_3282) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3284 = cute.get_iter(%view_3283) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3285, %e1_3286 = cute.get_leaves(%iter_3284) : !cute.int_tuple<"(?,?{div=2})">
          %1146 = cute.get_scalars(%e0_3285) : !cute.int_tuple<"?">
          %1147 = cute.get_scalars(%e1_3286) : !cute.int_tuple<"?{div=2}">
          %iter_3287 = cute.get_iter(%view_3283) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3288, %e1_3289 = cute.get_leaves(%iter_3287) : !cute.int_tuple<"(?,?{div=2})">
          %1148 = cute.get_scalars(%e0_3288) : !cute.int_tuple<"?">
          %1149 = cute.get_scalars(%e1_3289) : !cute.int_tuple<"?{div=2}">
          %iter_3290 = cute.get_iter(%view_3283) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3291, %e1_3292 = cute.get_leaves(%iter_3290) : !cute.int_tuple<"(?,?{div=2})">
          %1150 = cute.get_scalars(%e0_3291) : !cute.int_tuple<"?">
          %1151 = cute.get_scalars(%e1_3292) : !cute.int_tuple<"?{div=2}">
          %coord_3293 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3294 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3295 = cute.crd2idx(%coord_3293, %lay_3294) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_3296 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3297 = cute.add_offset(%iter_3296, %idx_3295) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3298 = cute.make_view(%tup_3297) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3299 = cute.get_iter(%view_3298) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3300, %e1_3301 = cute.get_leaves(%iter_3299) : !cute.int_tuple<"(?,?{div=2})">
          %1152 = cute.get_scalars(%e0_3300) : !cute.int_tuple<"?">
          %1153 = cute.get_scalars(%e1_3301) : !cute.int_tuple<"?{div=2}">
          %iter_3302 = cute.get_iter(%view_3298) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3303, %e1_3304 = cute.get_leaves(%iter_3302) : !cute.int_tuple<"(?,?{div=2})">
          %1154 = cute.get_scalars(%e0_3303) : !cute.int_tuple<"?">
          %1155 = cute.get_scalars(%e1_3304) : !cute.int_tuple<"?{div=2}">
          %iter_3305 = cute.get_iter(%view_3298) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3306, %e1_3307 = cute.get_leaves(%iter_3305) : !cute.int_tuple<"(?,?{div=2})">
          %1156 = cute.get_scalars(%e0_3306) : !cute.int_tuple<"?">
          %1157 = cute.get_scalars(%e1_3307) : !cute.int_tuple<"?{div=2}">
          %coord_3308 = cute.make_coord(%e0_3291) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3309 = cute.make_coord(%e1_3307) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1158 = cute.elem_less(%coord_3308, %coord_3309) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3310 = cute.get_layout(%1006) : !memref_rmem_f32_1
          %1159 = cute.get_shape(%lay_3310) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3311, %e1_3312, %e2_3313, %e3_3314 = cute.get_leaves(%1159) : !cute.shape<"((2,2),1,8)">
          %1160 = cute.get_stride(%lay_3310) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3315, %e1_3316, %e2_3317, %e3_3318 = cute.get_leaves(%1160) : !cute.stride<"((1,2),0,4)">
          %1161 = scf.if %1158 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1006) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
            cute.memref.store(%1006, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1006) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1006 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1006) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1006) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1006 : !memref_rmem_f32_1
          }
          %iter_3319 = cute.get_iter(%1161) : !memref_rmem_f32_1
          %lay_3320 = cute.get_layout(%1161) : !memref_rmem_f32_1
          %1162 = cute.get_shape(%lay_3320) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3321, %e1_3322, %e2_3323, %e3_3324 = cute.get_leaves(%1162) : !cute.shape<"((2,2),1,8)">
          %1163 = cute.get_stride(%lay_3320) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3325, %e1_3326, %e2_3327, %e3_3328 = cute.get_leaves(%1163) : !cute.stride<"((1,2),0,4)">
          %iter_3329 = cute.get_iter(%1161) : !memref_rmem_f32_1
          %iter_3330 = cute.get_iter(%1161) : !memref_rmem_f32_1
          %coord_3331 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_3332 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3333 = cute.crd2idx(%coord_3331, %lay_3332) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_3334 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3335 = cute.add_offset(%iter_3334, %idx_3333) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3336 = cute.make_view(%tup_3335) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3337 = cute.get_iter(%view_3336) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3338, %e1_3339 = cute.get_leaves(%iter_3337) : !cute.int_tuple<"(?,?{div=2})">
          %1164 = cute.get_scalars(%e0_3338) : !cute.int_tuple<"?">
          %1165 = cute.get_scalars(%e1_3339) : !cute.int_tuple<"?{div=2}">
          %iter_3340 = cute.get_iter(%view_3336) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3341, %e1_3342 = cute.get_leaves(%iter_3340) : !cute.int_tuple<"(?,?{div=2})">
          %1166 = cute.get_scalars(%e0_3341) : !cute.int_tuple<"?">
          %1167 = cute.get_scalars(%e1_3342) : !cute.int_tuple<"?{div=2}">
          %iter_3343 = cute.get_iter(%view_3336) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3344, %e1_3345 = cute.get_leaves(%iter_3343) : !cute.int_tuple<"(?,?{div=2})">
          %1168 = cute.get_scalars(%e0_3344) : !cute.int_tuple<"?">
          %1169 = cute.get_scalars(%e1_3345) : !cute.int_tuple<"?{div=2}">
          %coord_3346 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_3347 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3348 = cute.crd2idx(%coord_3346, %lay_3347) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_3349 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3350 = cute.add_offset(%iter_3349, %idx_3348) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3351 = cute.make_view(%tup_3350) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3352 = cute.get_iter(%view_3351) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3353, %e1_3354 = cute.get_leaves(%iter_3352) : !cute.int_tuple<"(?,?{div=2})">
          %1170 = cute.get_scalars(%e0_3353) : !cute.int_tuple<"?">
          %1171 = cute.get_scalars(%e1_3354) : !cute.int_tuple<"?{div=2}">
          %iter_3355 = cute.get_iter(%view_3351) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3356, %e1_3357 = cute.get_leaves(%iter_3355) : !cute.int_tuple<"(?,?{div=2})">
          %1172 = cute.get_scalars(%e0_3356) : !cute.int_tuple<"?">
          %1173 = cute.get_scalars(%e1_3357) : !cute.int_tuple<"?{div=2}">
          %iter_3358 = cute.get_iter(%view_3351) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3359, %e1_3360 = cute.get_leaves(%iter_3358) : !cute.int_tuple<"(?,?{div=2})">
          %1174 = cute.get_scalars(%e0_3359) : !cute.int_tuple<"?">
          %1175 = cute.get_scalars(%e1_3360) : !cute.int_tuple<"?{div=2}">
          %coord_3361 = cute.make_coord(%e0_3344) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3362 = cute.make_coord(%e1_3360) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1176 = cute.elem_less(%coord_3361, %coord_3362) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3363 = cute.get_layout(%1161) : !memref_rmem_f32_1
          %1177 = cute.get_shape(%lay_3363) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3364, %e1_3365, %e2_3366, %e3_3367 = cute.get_leaves(%1177) : !cute.shape<"((2,2),1,8)">
          %1178 = cute.get_stride(%lay_3363) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3368, %e1_3369, %e2_3370, %e3_3371 = cute.get_leaves(%1178) : !cute.stride<"((1,2),0,4)">
          %1179 = scf.if %1176 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1161) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
            cute.memref.store(%1161, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1161) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1161 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1161) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1161) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1161 : !memref_rmem_f32_1
          }
          %iter_3372 = cute.get_iter(%1179) : !memref_rmem_f32_1
          %lay_3373 = cute.get_layout(%1179) : !memref_rmem_f32_1
          %1180 = cute.get_shape(%lay_3373) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3374, %e1_3375, %e2_3376, %e3_3377 = cute.get_leaves(%1180) : !cute.shape<"((2,2),1,8)">
          %1181 = cute.get_stride(%lay_3373) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%1181) : !cute.stride<"((1,2),0,4)">
          %iter_3382 = cute.get_iter(%1179) : !memref_rmem_f32_1
          %iter_3383 = cute.get_iter(%1179) : !memref_rmem_f32_1
          %coord_3384 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_3385 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3386 = cute.crd2idx(%coord_3384, %lay_3385) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_3387 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3388 = cute.add_offset(%iter_3387, %idx_3386) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3389 = cute.make_view(%tup_3388) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3390 = cute.get_iter(%view_3389) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3391, %e1_3392 = cute.get_leaves(%iter_3390) : !cute.int_tuple<"(?,?{div=2})">
          %1182 = cute.get_scalars(%e0_3391) : !cute.int_tuple<"?">
          %1183 = cute.get_scalars(%e1_3392) : !cute.int_tuple<"?{div=2}">
          %iter_3393 = cute.get_iter(%view_3389) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3394, %e1_3395 = cute.get_leaves(%iter_3393) : !cute.int_tuple<"(?,?{div=2})">
          %1184 = cute.get_scalars(%e0_3394) : !cute.int_tuple<"?">
          %1185 = cute.get_scalars(%e1_3395) : !cute.int_tuple<"?{div=2}">
          %iter_3396 = cute.get_iter(%view_3389) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3397, %e1_3398 = cute.get_leaves(%iter_3396) : !cute.int_tuple<"(?,?{div=2})">
          %1186 = cute.get_scalars(%e0_3397) : !cute.int_tuple<"?">
          %1187 = cute.get_scalars(%e1_3398) : !cute.int_tuple<"?{div=2}">
          %coord_3399 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_3400 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3401 = cute.crd2idx(%coord_3399, %lay_3400) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_3402 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3403 = cute.add_offset(%iter_3402, %idx_3401) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3404 = cute.make_view(%tup_3403) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3405 = cute.get_iter(%view_3404) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3406, %e1_3407 = cute.get_leaves(%iter_3405) : !cute.int_tuple<"(?,?{div=2})">
          %1188 = cute.get_scalars(%e0_3406) : !cute.int_tuple<"?">
          %1189 = cute.get_scalars(%e1_3407) : !cute.int_tuple<"?{div=2}">
          %iter_3408 = cute.get_iter(%view_3404) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3409, %e1_3410 = cute.get_leaves(%iter_3408) : !cute.int_tuple<"(?,?{div=2})">
          %1190 = cute.get_scalars(%e0_3409) : !cute.int_tuple<"?">
          %1191 = cute.get_scalars(%e1_3410) : !cute.int_tuple<"?{div=2}">
          %iter_3411 = cute.get_iter(%view_3404) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3412, %e1_3413 = cute.get_leaves(%iter_3411) : !cute.int_tuple<"(?,?{div=2})">
          %1192 = cute.get_scalars(%e0_3412) : !cute.int_tuple<"?">
          %1193 = cute.get_scalars(%e1_3413) : !cute.int_tuple<"?{div=2}">
          %coord_3414 = cute.make_coord(%e0_3397) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3415 = cute.make_coord(%e1_3413) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1194 = cute.elem_less(%coord_3414, %coord_3415) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3416 = cute.get_layout(%1179) : !memref_rmem_f32_1
          %1195 = cute.get_shape(%lay_3416) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1195) : !cute.shape<"((2,2),1,8)">
          %1196 = cute.get_stride(%lay_3416) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3421, %e1_3422, %e2_3423, %e3_3424 = cute.get_leaves(%1196) : !cute.stride<"((1,2),0,4)">
          %1197 = scf.if %1194 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1179) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
            cute.memref.store(%1179, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1179) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1179 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1179) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1179) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1179 : !memref_rmem_f32_1
          }
          %iter_3425 = cute.get_iter(%1197) : !memref_rmem_f32_1
          %lay_3426 = cute.get_layout(%1197) : !memref_rmem_f32_1
          %1198 = cute.get_shape(%lay_3426) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3427, %e1_3428, %e2_3429, %e3_3430 = cute.get_leaves(%1198) : !cute.shape<"((2,2),1,8)">
          %1199 = cute.get_stride(%lay_3426) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3431, %e1_3432, %e2_3433, %e3_3434 = cute.get_leaves(%1199) : !cute.stride<"((1,2),0,4)">
          %iter_3435 = cute.get_iter(%1197) : !memref_rmem_f32_1
          %iter_3436 = cute.get_iter(%1197) : !memref_rmem_f32_1
          %coord_3437 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_3438 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3439 = cute.crd2idx(%coord_3437, %lay_3438) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_3440 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3441 = cute.add_offset(%iter_3440, %idx_3439) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3442 = cute.make_view(%tup_3441) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3443 = cute.get_iter(%view_3442) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3444, %e1_3445 = cute.get_leaves(%iter_3443) : !cute.int_tuple<"(?,?{div=2})">
          %1200 = cute.get_scalars(%e0_3444) : !cute.int_tuple<"?">
          %1201 = cute.get_scalars(%e1_3445) : !cute.int_tuple<"?{div=2}">
          %iter_3446 = cute.get_iter(%view_3442) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3447, %e1_3448 = cute.get_leaves(%iter_3446) : !cute.int_tuple<"(?,?{div=2})">
          %1202 = cute.get_scalars(%e0_3447) : !cute.int_tuple<"?">
          %1203 = cute.get_scalars(%e1_3448) : !cute.int_tuple<"?{div=2}">
          %iter_3449 = cute.get_iter(%view_3442) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3450, %e1_3451 = cute.get_leaves(%iter_3449) : !cute.int_tuple<"(?,?{div=2})">
          %1204 = cute.get_scalars(%e0_3450) : !cute.int_tuple<"?">
          %1205 = cute.get_scalars(%e1_3451) : !cute.int_tuple<"?{div=2}">
          %coord_3452 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_3453 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3454 = cute.crd2idx(%coord_3452, %lay_3453) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_3455 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3456 = cute.add_offset(%iter_3455, %idx_3454) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3457 = cute.make_view(%tup_3456) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3458 = cute.get_iter(%view_3457) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3459, %e1_3460 = cute.get_leaves(%iter_3458) : !cute.int_tuple<"(?,?{div=2})">
          %1206 = cute.get_scalars(%e0_3459) : !cute.int_tuple<"?">
          %1207 = cute.get_scalars(%e1_3460) : !cute.int_tuple<"?{div=2}">
          %iter_3461 = cute.get_iter(%view_3457) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3462, %e1_3463 = cute.get_leaves(%iter_3461) : !cute.int_tuple<"(?,?{div=2})">
          %1208 = cute.get_scalars(%e0_3462) : !cute.int_tuple<"?">
          %1209 = cute.get_scalars(%e1_3463) : !cute.int_tuple<"?{div=2}">
          %iter_3464 = cute.get_iter(%view_3457) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3465, %e1_3466 = cute.get_leaves(%iter_3464) : !cute.int_tuple<"(?,?{div=2})">
          %1210 = cute.get_scalars(%e0_3465) : !cute.int_tuple<"?">
          %1211 = cute.get_scalars(%e1_3466) : !cute.int_tuple<"?{div=2}">
          %coord_3467 = cute.make_coord(%e0_3450) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3468 = cute.make_coord(%e1_3466) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1212 = cute.elem_less(%coord_3467, %coord_3468) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3469 = cute.get_layout(%1197) : !memref_rmem_f32_1
          %1213 = cute.get_shape(%lay_3469) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3470, %e1_3471, %e2_3472, %e3_3473 = cute.get_leaves(%1213) : !cute.shape<"((2,2),1,8)">
          %1214 = cute.get_stride(%lay_3469) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3474, %e1_3475, %e2_3476, %e3_3477 = cute.get_leaves(%1214) : !cute.stride<"((1,2),0,4)">
          %1215 = scf.if %1212 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1197) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
            cute.memref.store(%1197, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1197) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1197 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1197) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1197) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1197 : !memref_rmem_f32_1
          }
          %iter_3478 = cute.get_iter(%1215) : !memref_rmem_f32_1
          %lay_3479 = cute.get_layout(%1215) : !memref_rmem_f32_1
          %1216 = cute.get_shape(%lay_3479) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3480, %e1_3481, %e2_3482, %e3_3483 = cute.get_leaves(%1216) : !cute.shape<"((2,2),1,8)">
          %1217 = cute.get_stride(%lay_3479) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3484, %e1_3485, %e2_3486, %e3_3487 = cute.get_leaves(%1217) : !cute.stride<"((1,2),0,4)">
          %iter_3488 = cute.get_iter(%1215) : !memref_rmem_f32_1
          %iter_3489 = cute.get_iter(%1215) : !memref_rmem_f32_1
          %coord_3490 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_3491 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3492 = cute.crd2idx(%coord_3490, %lay_3491) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_3493 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3494 = cute.add_offset(%iter_3493, %idx_3492) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3495 = cute.make_view(%tup_3494) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3496 = cute.get_iter(%view_3495) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3497, %e1_3498 = cute.get_leaves(%iter_3496) : !cute.int_tuple<"(?,?{div=2})">
          %1218 = cute.get_scalars(%e0_3497) : !cute.int_tuple<"?">
          %1219 = cute.get_scalars(%e1_3498) : !cute.int_tuple<"?{div=2}">
          %iter_3499 = cute.get_iter(%view_3495) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3500, %e1_3501 = cute.get_leaves(%iter_3499) : !cute.int_tuple<"(?,?{div=2})">
          %1220 = cute.get_scalars(%e0_3500) : !cute.int_tuple<"?">
          %1221 = cute.get_scalars(%e1_3501) : !cute.int_tuple<"?{div=2}">
          %iter_3502 = cute.get_iter(%view_3495) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3503, %e1_3504 = cute.get_leaves(%iter_3502) : !cute.int_tuple<"(?,?{div=2})">
          %1222 = cute.get_scalars(%e0_3503) : !cute.int_tuple<"?">
          %1223 = cute.get_scalars(%e1_3504) : !cute.int_tuple<"?{div=2}">
          %coord_3505 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_3506 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3507 = cute.crd2idx(%coord_3505, %lay_3506) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_3508 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3509 = cute.add_offset(%iter_3508, %idx_3507) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3510 = cute.make_view(%tup_3509) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3511 = cute.get_iter(%view_3510) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3512, %e1_3513 = cute.get_leaves(%iter_3511) : !cute.int_tuple<"(?,?{div=2})">
          %1224 = cute.get_scalars(%e0_3512) : !cute.int_tuple<"?">
          %1225 = cute.get_scalars(%e1_3513) : !cute.int_tuple<"?{div=2}">
          %iter_3514 = cute.get_iter(%view_3510) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3515, %e1_3516 = cute.get_leaves(%iter_3514) : !cute.int_tuple<"(?,?{div=2})">
          %1226 = cute.get_scalars(%e0_3515) : !cute.int_tuple<"?">
          %1227 = cute.get_scalars(%e1_3516) : !cute.int_tuple<"?{div=2}">
          %iter_3517 = cute.get_iter(%view_3510) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3518, %e1_3519 = cute.get_leaves(%iter_3517) : !cute.int_tuple<"(?,?{div=2})">
          %1228 = cute.get_scalars(%e0_3518) : !cute.int_tuple<"?">
          %1229 = cute.get_scalars(%e1_3519) : !cute.int_tuple<"?{div=2}">
          %coord_3520 = cute.make_coord(%e0_3503) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3521 = cute.make_coord(%e1_3519) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1230 = cute.elem_less(%coord_3520, %coord_3521) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3522 = cute.get_layout(%1215) : !memref_rmem_f32_1
          %1231 = cute.get_shape(%lay_3522) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3523, %e1_3524, %e2_3525, %e3_3526 = cute.get_leaves(%1231) : !cute.shape<"((2,2),1,8)">
          %1232 = cute.get_stride(%lay_3522) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3527, %e1_3528, %e2_3529, %e3_3530 = cute.get_leaves(%1232) : !cute.stride<"((1,2),0,4)">
          %1233 = scf.if %1230 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1215) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
            cute.memref.store(%1215, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1215) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1215 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1215) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1215) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1215 : !memref_rmem_f32_1
          }
          %iter_3531 = cute.get_iter(%1233) : !memref_rmem_f32_1
          %lay_3532 = cute.get_layout(%1233) : !memref_rmem_f32_1
          %1234 = cute.get_shape(%lay_3532) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3533, %e1_3534, %e2_3535, %e3_3536 = cute.get_leaves(%1234) : !cute.shape<"((2,2),1,8)">
          %1235 = cute.get_stride(%lay_3532) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3537, %e1_3538, %e2_3539, %e3_3540 = cute.get_leaves(%1235) : !cute.stride<"((1,2),0,4)">
          %iter_3541 = cute.get_iter(%1233) : !memref_rmem_f32_1
          %iter_3542 = cute.get_iter(%1233) : !memref_rmem_f32_1
          %coord_3543 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_3544 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3545 = cute.crd2idx(%coord_3543, %lay_3544) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_3546 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3547 = cute.add_offset(%iter_3546, %idx_3545) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3548 = cute.make_view(%tup_3547) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3549 = cute.get_iter(%view_3548) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3550, %e1_3551 = cute.get_leaves(%iter_3549) : !cute.int_tuple<"(?,?{div=2})">
          %1236 = cute.get_scalars(%e0_3550) : !cute.int_tuple<"?">
          %1237 = cute.get_scalars(%e1_3551) : !cute.int_tuple<"?{div=2}">
          %iter_3552 = cute.get_iter(%view_3548) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3553, %e1_3554 = cute.get_leaves(%iter_3552) : !cute.int_tuple<"(?,?{div=2})">
          %1238 = cute.get_scalars(%e0_3553) : !cute.int_tuple<"?">
          %1239 = cute.get_scalars(%e1_3554) : !cute.int_tuple<"?{div=2}">
          %iter_3555 = cute.get_iter(%view_3548) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3556, %e1_3557 = cute.get_leaves(%iter_3555) : !cute.int_tuple<"(?,?{div=2})">
          %1240 = cute.get_scalars(%e0_3556) : !cute.int_tuple<"?">
          %1241 = cute.get_scalars(%e1_3557) : !cute.int_tuple<"?{div=2}">
          %coord_3558 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_3559 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3560 = cute.crd2idx(%coord_3558, %lay_3559) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_3561 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3562 = cute.add_offset(%iter_3561, %idx_3560) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3563 = cute.make_view(%tup_3562) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3564 = cute.get_iter(%view_3563) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3565, %e1_3566 = cute.get_leaves(%iter_3564) : !cute.int_tuple<"(?,?{div=2})">
          %1242 = cute.get_scalars(%e0_3565) : !cute.int_tuple<"?">
          %1243 = cute.get_scalars(%e1_3566) : !cute.int_tuple<"?{div=2}">
          %iter_3567 = cute.get_iter(%view_3563) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3568, %e1_3569 = cute.get_leaves(%iter_3567) : !cute.int_tuple<"(?,?{div=2})">
          %1244 = cute.get_scalars(%e0_3568) : !cute.int_tuple<"?">
          %1245 = cute.get_scalars(%e1_3569) : !cute.int_tuple<"?{div=2}">
          %iter_3570 = cute.get_iter(%view_3563) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3571, %e1_3572 = cute.get_leaves(%iter_3570) : !cute.int_tuple<"(?,?{div=2})">
          %1246 = cute.get_scalars(%e0_3571) : !cute.int_tuple<"?">
          %1247 = cute.get_scalars(%e1_3572) : !cute.int_tuple<"?{div=2}">
          %coord_3573 = cute.make_coord(%e0_3556) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3574 = cute.make_coord(%e1_3572) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1248 = cute.elem_less(%coord_3573, %coord_3574) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3575 = cute.get_layout(%1233) : !memref_rmem_f32_1
          %1249 = cute.get_shape(%lay_3575) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3576, %e1_3577, %e2_3578, %e3_3579 = cute.get_leaves(%1249) : !cute.shape<"((2,2),1,8)">
          %1250 = cute.get_stride(%lay_3575) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3580, %e1_3581, %e2_3582, %e3_3583 = cute.get_leaves(%1250) : !cute.stride<"((1,2),0,4)">
          %1251 = scf.if %1248 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1233) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
            cute.memref.store(%1233, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1233) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1233 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1233) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1233) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1233 : !memref_rmem_f32_1
          }
          %iter_3584 = cute.get_iter(%1251) : !memref_rmem_f32_1
          %lay_3585 = cute.get_layout(%1251) : !memref_rmem_f32_1
          %1252 = cute.get_shape(%lay_3585) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3586, %e1_3587, %e2_3588, %e3_3589 = cute.get_leaves(%1252) : !cute.shape<"((2,2),1,8)">
          %1253 = cute.get_stride(%lay_3585) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3590, %e1_3591, %e2_3592, %e3_3593 = cute.get_leaves(%1253) : !cute.stride<"((1,2),0,4)">
          %iter_3594 = cute.get_iter(%1251) : !memref_rmem_f32_1
          %iter_3595 = cute.get_iter(%1251) : !memref_rmem_f32_1
          %coord_3596 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_3597 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3598 = cute.crd2idx(%coord_3596, %lay_3597) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_3599 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3600 = cute.add_offset(%iter_3599, %idx_3598) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3601 = cute.make_view(%tup_3600) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3602 = cute.get_iter(%view_3601) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3603, %e1_3604 = cute.get_leaves(%iter_3602) : !cute.int_tuple<"(?,?{div=2})">
          %1254 = cute.get_scalars(%e0_3603) : !cute.int_tuple<"?">
          %1255 = cute.get_scalars(%e1_3604) : !cute.int_tuple<"?{div=2}">
          %iter_3605 = cute.get_iter(%view_3601) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3606, %e1_3607 = cute.get_leaves(%iter_3605) : !cute.int_tuple<"(?,?{div=2})">
          %1256 = cute.get_scalars(%e0_3606) : !cute.int_tuple<"?">
          %1257 = cute.get_scalars(%e1_3607) : !cute.int_tuple<"?{div=2}">
          %iter_3608 = cute.get_iter(%view_3601) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3609, %e1_3610 = cute.get_leaves(%iter_3608) : !cute.int_tuple<"(?,?{div=2})">
          %1258 = cute.get_scalars(%e0_3609) : !cute.int_tuple<"?">
          %1259 = cute.get_scalars(%e1_3610) : !cute.int_tuple<"?{div=2}">
          %coord_3611 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_3612 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3613 = cute.crd2idx(%coord_3611, %lay_3612) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_3614 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3615 = cute.add_offset(%iter_3614, %idx_3613) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3616 = cute.make_view(%tup_3615) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3617 = cute.get_iter(%view_3616) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3618, %e1_3619 = cute.get_leaves(%iter_3617) : !cute.int_tuple<"(?,?{div=2})">
          %1260 = cute.get_scalars(%e0_3618) : !cute.int_tuple<"?">
          %1261 = cute.get_scalars(%e1_3619) : !cute.int_tuple<"?{div=2}">
          %iter_3620 = cute.get_iter(%view_3616) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3621, %e1_3622 = cute.get_leaves(%iter_3620) : !cute.int_tuple<"(?,?{div=2})">
          %1262 = cute.get_scalars(%e0_3621) : !cute.int_tuple<"?">
          %1263 = cute.get_scalars(%e1_3622) : !cute.int_tuple<"?{div=2}">
          %iter_3623 = cute.get_iter(%view_3616) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3624, %e1_3625 = cute.get_leaves(%iter_3623) : !cute.int_tuple<"(?,?{div=2})">
          %1264 = cute.get_scalars(%e0_3624) : !cute.int_tuple<"?">
          %1265 = cute.get_scalars(%e1_3625) : !cute.int_tuple<"?{div=2}">
          %coord_3626 = cute.make_coord(%e0_3609) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3627 = cute.make_coord(%e1_3625) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1266 = cute.elem_less(%coord_3626, %coord_3627) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3628 = cute.get_layout(%1251) : !memref_rmem_f32_1
          %1267 = cute.get_shape(%lay_3628) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3629, %e1_3630, %e2_3631, %e3_3632 = cute.get_leaves(%1267) : !cute.shape<"((2,2),1,8)">
          %1268 = cute.get_stride(%lay_3628) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3633, %e1_3634, %e2_3635, %e3_3636 = cute.get_leaves(%1268) : !cute.stride<"((1,2),0,4)">
          %1269 = scf.if %1266 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1251) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
            cute.memref.store(%1251, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1251) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1251 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1251) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1251) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1251 : !memref_rmem_f32_1
          }
          %iter_3637 = cute.get_iter(%1269) : !memref_rmem_f32_1
          %lay_3638 = cute.get_layout(%1269) : !memref_rmem_f32_1
          %1270 = cute.get_shape(%lay_3638) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3639, %e1_3640, %e2_3641, %e3_3642 = cute.get_leaves(%1270) : !cute.shape<"((2,2),1,8)">
          %1271 = cute.get_stride(%lay_3638) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3643, %e1_3644, %e2_3645, %e3_3646 = cute.get_leaves(%1271) : !cute.stride<"((1,2),0,4)">
          %iter_3647 = cute.get_iter(%1269) : !memref_rmem_f32_1
          %iter_3648 = cute.get_iter(%1269) : !memref_rmem_f32_1
          %coord_3649 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_3650 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3651 = cute.crd2idx(%coord_3649, %lay_3650) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_3652 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3653 = cute.add_offset(%iter_3652, %idx_3651) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3654 = cute.make_view(%tup_3653) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3655 = cute.get_iter(%view_3654) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3656, %e1_3657 = cute.get_leaves(%iter_3655) : !cute.int_tuple<"(?,?{div=2})">
          %1272 = cute.get_scalars(%e0_3656) : !cute.int_tuple<"?">
          %1273 = cute.get_scalars(%e1_3657) : !cute.int_tuple<"?{div=2}">
          %iter_3658 = cute.get_iter(%view_3654) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3659, %e1_3660 = cute.get_leaves(%iter_3658) : !cute.int_tuple<"(?,?{div=2})">
          %1274 = cute.get_scalars(%e0_3659) : !cute.int_tuple<"?">
          %1275 = cute.get_scalars(%e1_3660) : !cute.int_tuple<"?{div=2}">
          %iter_3661 = cute.get_iter(%view_3654) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3662, %e1_3663 = cute.get_leaves(%iter_3661) : !cute.int_tuple<"(?,?{div=2})">
          %1276 = cute.get_scalars(%e0_3662) : !cute.int_tuple<"?">
          %1277 = cute.get_scalars(%e1_3663) : !cute.int_tuple<"?{div=2}">
          %coord_3664 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_3665 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3666 = cute.crd2idx(%coord_3664, %lay_3665) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_3667 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3668 = cute.add_offset(%iter_3667, %idx_3666) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3669 = cute.make_view(%tup_3668) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3670 = cute.get_iter(%view_3669) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3671, %e1_3672 = cute.get_leaves(%iter_3670) : !cute.int_tuple<"(?,?{div=2})">
          %1278 = cute.get_scalars(%e0_3671) : !cute.int_tuple<"?">
          %1279 = cute.get_scalars(%e1_3672) : !cute.int_tuple<"?{div=2}">
          %iter_3673 = cute.get_iter(%view_3669) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3674, %e1_3675 = cute.get_leaves(%iter_3673) : !cute.int_tuple<"(?,?{div=2})">
          %1280 = cute.get_scalars(%e0_3674) : !cute.int_tuple<"?">
          %1281 = cute.get_scalars(%e1_3675) : !cute.int_tuple<"?{div=2}">
          %iter_3676 = cute.get_iter(%view_3669) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3677, %e1_3678 = cute.get_leaves(%iter_3676) : !cute.int_tuple<"(?,?{div=2})">
          %1282 = cute.get_scalars(%e0_3677) : !cute.int_tuple<"?">
          %1283 = cute.get_scalars(%e1_3678) : !cute.int_tuple<"?{div=2}">
          %coord_3679 = cute.make_coord(%e0_3662) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3680 = cute.make_coord(%e1_3678) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1284 = cute.elem_less(%coord_3679, %coord_3680) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3681 = cute.get_layout(%1269) : !memref_rmem_f32_1
          %1285 = cute.get_shape(%lay_3681) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3682, %e1_3683, %e2_3684, %e3_3685 = cute.get_leaves(%1285) : !cute.shape<"((2,2),1,8)">
          %1286 = cute.get_stride(%lay_3681) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3686, %e1_3687, %e2_3688, %e3_3689 = cute.get_leaves(%1286) : !cute.stride<"((1,2),0,4)">
          %1287 = scf.if %1284 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1269) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
            cute.memref.store(%1269, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1269) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1269 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1269) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1269) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1269 : !memref_rmem_f32_1
          }
          %iter_3690 = cute.get_iter(%1287) : !memref_rmem_f32_1
          %lay_3691 = cute.get_layout(%1287) : !memref_rmem_f32_1
          %1288 = cute.get_shape(%lay_3691) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3692, %e1_3693, %e2_3694, %e3_3695 = cute.get_leaves(%1288) : !cute.shape<"((2,2),1,8)">
          %1289 = cute.get_stride(%lay_3691) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3696, %e1_3697, %e2_3698, %e3_3699 = cute.get_leaves(%1289) : !cute.stride<"((1,2),0,4)">
          %iter_3700 = cute.get_iter(%1287) : !memref_rmem_f32_1
          %iter_3701 = cute.get_iter(%1287) : !memref_rmem_f32_1
          %int_tuple_3702 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3703 = cute.size(%int_tuple_3702) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3704 = cute.get_leaves(%sz_3703) : !cute.int_tuple<"1">
          %int_tuple_3705 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3706 = cute.size(%int_tuple_3705) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3707 = cute.get_leaves(%sz_3706) : !cute.int_tuple<"8">
          %coord_3708 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_3709 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3710 = cute.crd2idx(%coord_3708, %lay_3709) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_3711 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3712 = cute.add_offset(%iter_3711, %idx_3710) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_3713 = cute.make_view(%tup_3712) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3714 = cute.get_iter(%view_3713) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3715, %e1_3716 = cute.get_leaves(%iter_3714) : !cute.int_tuple<"(?,?)">
          %1290 = cute.get_scalars(%e0_3715) : !cute.int_tuple<"?">
          %1291 = cute.get_scalars(%e1_3716) : !cute.int_tuple<"?">
          %iter_3717 = cute.get_iter(%view_3713) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3718, %e1_3719 = cute.get_leaves(%iter_3717) : !cute.int_tuple<"(?,?)">
          %1292 = cute.get_scalars(%e0_3718) : !cute.int_tuple<"?">
          %1293 = cute.get_scalars(%e1_3719) : !cute.int_tuple<"?">
          %iter_3720 = cute.get_iter(%view_3713) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3721, %e1_3722 = cute.get_leaves(%iter_3720) : !cute.int_tuple<"(?,?)">
          %1294 = cute.get_scalars(%e0_3721) : !cute.int_tuple<"?">
          %1295 = cute.get_scalars(%e1_3722) : !cute.int_tuple<"?">
          %coord_3723 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_3724 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3725 = cute.crd2idx(%coord_3723, %lay_3724) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_3726 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3727 = cute.add_offset(%iter_3726, %idx_3725) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_3728 = cute.make_view(%tup_3727) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3729 = cute.get_iter(%view_3728) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3730, %e1_3731 = cute.get_leaves(%iter_3729) : !cute.int_tuple<"(?,?)">
          %1296 = cute.get_scalars(%e0_3730) : !cute.int_tuple<"?">
          %1297 = cute.get_scalars(%e1_3731) : !cute.int_tuple<"?">
          %iter_3732 = cute.get_iter(%view_3728) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3733, %e1_3734 = cute.get_leaves(%iter_3732) : !cute.int_tuple<"(?,?)">
          %1298 = cute.get_scalars(%e0_3733) : !cute.int_tuple<"?">
          %1299 = cute.get_scalars(%e1_3734) : !cute.int_tuple<"?">
          %iter_3735 = cute.get_iter(%view_3728) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3736, %e1_3737 = cute.get_leaves(%iter_3735) : !cute.int_tuple<"(?,?)">
          %1300 = cute.get_scalars(%e0_3736) : !cute.int_tuple<"?">
          %1301 = cute.get_scalars(%e1_3737) : !cute.int_tuple<"?">
          %coord_3738 = cute.make_coord(%e0_3721) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3739 = cute.make_coord(%e1_3737) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1302 = cute.elem_less(%coord_3738, %coord_3739) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3740 = cute.get_layout(%1287) : !memref_rmem_f32_1
          %1303 = cute.get_shape(%lay_3740) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3741, %e1_3742, %e2_3743, %e3_3744 = cute.get_leaves(%1303) : !cute.shape<"((2,2),1,8)">
          %1304 = cute.get_stride(%lay_3740) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3745, %e1_3746, %e2_3747, %e3_3748 = cute.get_leaves(%1304) : !cute.stride<"((1,2),0,4)">
          %1305 = scf.if %1302 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1287) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
            cute.memref.store(%1287, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1287) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1287 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1287) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1287) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1287 : !memref_rmem_f32_1
          }
          %iter_3749 = cute.get_iter(%1305) : !memref_rmem_f32_1
          %lay_3750 = cute.get_layout(%1305) : !memref_rmem_f32_1
          %1306 = cute.get_shape(%lay_3750) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3751, %e1_3752, %e2_3753, %e3_3754 = cute.get_leaves(%1306) : !cute.shape<"((2,2),1,8)">
          %1307 = cute.get_stride(%lay_3750) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3755, %e1_3756, %e2_3757, %e3_3758 = cute.get_leaves(%1307) : !cute.stride<"((1,2),0,4)">
          %iter_3759 = cute.get_iter(%1305) : !memref_rmem_f32_1
          %iter_3760 = cute.get_iter(%1305) : !memref_rmem_f32_1
          %coord_3761 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_3762 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3763 = cute.crd2idx(%coord_3761, %lay_3762) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_3764 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3765 = cute.add_offset(%iter_3764, %idx_3763) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_3766 = cute.make_view(%tup_3765) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3767 = cute.get_iter(%view_3766) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3768, %e1_3769 = cute.get_leaves(%iter_3767) : !cute.int_tuple<"(?,?)">
          %1308 = cute.get_scalars(%e0_3768) : !cute.int_tuple<"?">
          %1309 = cute.get_scalars(%e1_3769) : !cute.int_tuple<"?">
          %iter_3770 = cute.get_iter(%view_3766) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3771, %e1_3772 = cute.get_leaves(%iter_3770) : !cute.int_tuple<"(?,?)">
          %1310 = cute.get_scalars(%e0_3771) : !cute.int_tuple<"?">
          %1311 = cute.get_scalars(%e1_3772) : !cute.int_tuple<"?">
          %iter_3773 = cute.get_iter(%view_3766) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3774, %e1_3775 = cute.get_leaves(%iter_3773) : !cute.int_tuple<"(?,?)">
          %1312 = cute.get_scalars(%e0_3774) : !cute.int_tuple<"?">
          %1313 = cute.get_scalars(%e1_3775) : !cute.int_tuple<"?">
          %coord_3776 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_3777 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3778 = cute.crd2idx(%coord_3776, %lay_3777) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_3779 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3780 = cute.add_offset(%iter_3779, %idx_3778) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_3781 = cute.make_view(%tup_3780) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3782 = cute.get_iter(%view_3781) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3783, %e1_3784 = cute.get_leaves(%iter_3782) : !cute.int_tuple<"(?,?)">
          %1314 = cute.get_scalars(%e0_3783) : !cute.int_tuple<"?">
          %1315 = cute.get_scalars(%e1_3784) : !cute.int_tuple<"?">
          %iter_3785 = cute.get_iter(%view_3781) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3786, %e1_3787 = cute.get_leaves(%iter_3785) : !cute.int_tuple<"(?,?)">
          %1316 = cute.get_scalars(%e0_3786) : !cute.int_tuple<"?">
          %1317 = cute.get_scalars(%e1_3787) : !cute.int_tuple<"?">
          %iter_3788 = cute.get_iter(%view_3781) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3789, %e1_3790 = cute.get_leaves(%iter_3788) : !cute.int_tuple<"(?,?)">
          %1318 = cute.get_scalars(%e0_3789) : !cute.int_tuple<"?">
          %1319 = cute.get_scalars(%e1_3790) : !cute.int_tuple<"?">
          %coord_3791 = cute.make_coord(%e0_3774) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3792 = cute.make_coord(%e1_3790) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1320 = cute.elem_less(%coord_3791, %coord_3792) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3793 = cute.get_layout(%1305) : !memref_rmem_f32_1
          %1321 = cute.get_shape(%lay_3793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3794, %e1_3795, %e2_3796, %e3_3797 = cute.get_leaves(%1321) : !cute.shape<"((2,2),1,8)">
          %1322 = cute.get_stride(%lay_3793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3798, %e1_3799, %e2_3800, %e3_3801 = cute.get_leaves(%1322) : !cute.stride<"((1,2),0,4)">
          %1323 = scf.if %1320 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1305) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
            cute.memref.store(%1305, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1305) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1305 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1305) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1305) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1305 : !memref_rmem_f32_1
          }
          %iter_3802 = cute.get_iter(%1323) : !memref_rmem_f32_1
          %lay_3803 = cute.get_layout(%1323) : !memref_rmem_f32_1
          %1324 = cute.get_shape(%lay_3803) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3804, %e1_3805, %e2_3806, %e3_3807 = cute.get_leaves(%1324) : !cute.shape<"((2,2),1,8)">
          %1325 = cute.get_stride(%lay_3803) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3808, %e1_3809, %e2_3810, %e3_3811 = cute.get_leaves(%1325) : !cute.stride<"((1,2),0,4)">
          %iter_3812 = cute.get_iter(%1323) : !memref_rmem_f32_1
          %iter_3813 = cute.get_iter(%1323) : !memref_rmem_f32_1
          %coord_3814 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_3815 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3816 = cute.crd2idx(%coord_3814, %lay_3815) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_3817 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3818 = cute.add_offset(%iter_3817, %idx_3816) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_3819 = cute.make_view(%tup_3818) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3820 = cute.get_iter(%view_3819) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3821, %e1_3822 = cute.get_leaves(%iter_3820) : !cute.int_tuple<"(?,?)">
          %1326 = cute.get_scalars(%e0_3821) : !cute.int_tuple<"?">
          %1327 = cute.get_scalars(%e1_3822) : !cute.int_tuple<"?">
          %iter_3823 = cute.get_iter(%view_3819) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3824, %e1_3825 = cute.get_leaves(%iter_3823) : !cute.int_tuple<"(?,?)">
          %1328 = cute.get_scalars(%e0_3824) : !cute.int_tuple<"?">
          %1329 = cute.get_scalars(%e1_3825) : !cute.int_tuple<"?">
          %iter_3826 = cute.get_iter(%view_3819) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3827, %e1_3828 = cute.get_leaves(%iter_3826) : !cute.int_tuple<"(?,?)">
          %1330 = cute.get_scalars(%e0_3827) : !cute.int_tuple<"?">
          %1331 = cute.get_scalars(%e1_3828) : !cute.int_tuple<"?">
          %coord_3829 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_3830 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3831 = cute.crd2idx(%coord_3829, %lay_3830) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_3832 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3833 = cute.add_offset(%iter_3832, %idx_3831) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_3834 = cute.make_view(%tup_3833) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3835 = cute.get_iter(%view_3834) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3836, %e1_3837 = cute.get_leaves(%iter_3835) : !cute.int_tuple<"(?,?)">
          %1332 = cute.get_scalars(%e0_3836) : !cute.int_tuple<"?">
          %1333 = cute.get_scalars(%e1_3837) : !cute.int_tuple<"?">
          %iter_3838 = cute.get_iter(%view_3834) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3839, %e1_3840 = cute.get_leaves(%iter_3838) : !cute.int_tuple<"(?,?)">
          %1334 = cute.get_scalars(%e0_3839) : !cute.int_tuple<"?">
          %1335 = cute.get_scalars(%e1_3840) : !cute.int_tuple<"?">
          %iter_3841 = cute.get_iter(%view_3834) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3842, %e1_3843 = cute.get_leaves(%iter_3841) : !cute.int_tuple<"(?,?)">
          %1336 = cute.get_scalars(%e0_3842) : !cute.int_tuple<"?">
          %1337 = cute.get_scalars(%e1_3843) : !cute.int_tuple<"?">
          %coord_3844 = cute.make_coord(%e0_3827) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3845 = cute.make_coord(%e1_3843) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1338 = cute.elem_less(%coord_3844, %coord_3845) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3846 = cute.get_layout(%1323) : !memref_rmem_f32_1
          %1339 = cute.get_shape(%lay_3846) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3847, %e1_3848, %e2_3849, %e3_3850 = cute.get_leaves(%1339) : !cute.shape<"((2,2),1,8)">
          %1340 = cute.get_stride(%lay_3846) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3851, %e1_3852, %e2_3853, %e3_3854 = cute.get_leaves(%1340) : !cute.stride<"((1,2),0,4)">
          %1341 = scf.if %1338 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1323) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
            cute.memref.store(%1323, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1323) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1323 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1323) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1323) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1323 : !memref_rmem_f32_1
          }
          %iter_3855 = cute.get_iter(%1341) : !memref_rmem_f32_1
          %lay_3856 = cute.get_layout(%1341) : !memref_rmem_f32_1
          %1342 = cute.get_shape(%lay_3856) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3857, %e1_3858, %e2_3859, %e3_3860 = cute.get_leaves(%1342) : !cute.shape<"((2,2),1,8)">
          %1343 = cute.get_stride(%lay_3856) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3861, %e1_3862, %e2_3863, %e3_3864 = cute.get_leaves(%1343) : !cute.stride<"((1,2),0,4)">
          %iter_3865 = cute.get_iter(%1341) : !memref_rmem_f32_1
          %iter_3866 = cute.get_iter(%1341) : !memref_rmem_f32_1
          %coord_3867 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_3868 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3869 = cute.crd2idx(%coord_3867, %lay_3868) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_3870 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3871 = cute.add_offset(%iter_3870, %idx_3869) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_3872 = cute.make_view(%tup_3871) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3873 = cute.get_iter(%view_3872) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3874, %e1_3875 = cute.get_leaves(%iter_3873) : !cute.int_tuple<"(?,?)">
          %1344 = cute.get_scalars(%e0_3874) : !cute.int_tuple<"?">
          %1345 = cute.get_scalars(%e1_3875) : !cute.int_tuple<"?">
          %iter_3876 = cute.get_iter(%view_3872) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3877, %e1_3878 = cute.get_leaves(%iter_3876) : !cute.int_tuple<"(?,?)">
          %1346 = cute.get_scalars(%e0_3877) : !cute.int_tuple<"?">
          %1347 = cute.get_scalars(%e1_3878) : !cute.int_tuple<"?">
          %iter_3879 = cute.get_iter(%view_3872) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3880, %e1_3881 = cute.get_leaves(%iter_3879) : !cute.int_tuple<"(?,?)">
          %1348 = cute.get_scalars(%e0_3880) : !cute.int_tuple<"?">
          %1349 = cute.get_scalars(%e1_3881) : !cute.int_tuple<"?">
          %coord_3882 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_3883 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3884 = cute.crd2idx(%coord_3882, %lay_3883) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_3885 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3886 = cute.add_offset(%iter_3885, %idx_3884) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_3887 = cute.make_view(%tup_3886) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3888 = cute.get_iter(%view_3887) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3889, %e1_3890 = cute.get_leaves(%iter_3888) : !cute.int_tuple<"(?,?)">
          %1350 = cute.get_scalars(%e0_3889) : !cute.int_tuple<"?">
          %1351 = cute.get_scalars(%e1_3890) : !cute.int_tuple<"?">
          %iter_3891 = cute.get_iter(%view_3887) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3892, %e1_3893 = cute.get_leaves(%iter_3891) : !cute.int_tuple<"(?,?)">
          %1352 = cute.get_scalars(%e0_3892) : !cute.int_tuple<"?">
          %1353 = cute.get_scalars(%e1_3893) : !cute.int_tuple<"?">
          %iter_3894 = cute.get_iter(%view_3887) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3895, %e1_3896 = cute.get_leaves(%iter_3894) : !cute.int_tuple<"(?,?)">
          %1354 = cute.get_scalars(%e0_3895) : !cute.int_tuple<"?">
          %1355 = cute.get_scalars(%e1_3896) : !cute.int_tuple<"?">
          %coord_3897 = cute.make_coord(%e0_3880) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3898 = cute.make_coord(%e1_3896) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1356 = cute.elem_less(%coord_3897, %coord_3898) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3899 = cute.get_layout(%1341) : !memref_rmem_f32_1
          %1357 = cute.get_shape(%lay_3899) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3900, %e1_3901, %e2_3902, %e3_3903 = cute.get_leaves(%1357) : !cute.shape<"((2,2),1,8)">
          %1358 = cute.get_stride(%lay_3899) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3904, %e1_3905, %e2_3906, %e3_3907 = cute.get_leaves(%1358) : !cute.stride<"((1,2),0,4)">
          %1359 = scf.if %1356 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1341) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
            cute.memref.store(%1341, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1341) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1341 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1341) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1341) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1341 : !memref_rmem_f32_1
          }
          %iter_3908 = cute.get_iter(%1359) : !memref_rmem_f32_1
          %lay_3909 = cute.get_layout(%1359) : !memref_rmem_f32_1
          %1360 = cute.get_shape(%lay_3909) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3910, %e1_3911, %e2_3912, %e3_3913 = cute.get_leaves(%1360) : !cute.shape<"((2,2),1,8)">
          %1361 = cute.get_stride(%lay_3909) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3914, %e1_3915, %e2_3916, %e3_3917 = cute.get_leaves(%1361) : !cute.stride<"((1,2),0,4)">
          %iter_3918 = cute.get_iter(%1359) : !memref_rmem_f32_1
          %iter_3919 = cute.get_iter(%1359) : !memref_rmem_f32_1
          %coord_3920 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_3921 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3922 = cute.crd2idx(%coord_3920, %lay_3921) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_3923 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3924 = cute.add_offset(%iter_3923, %idx_3922) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_3925 = cute.make_view(%tup_3924) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3926 = cute.get_iter(%view_3925) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3927, %e1_3928 = cute.get_leaves(%iter_3926) : !cute.int_tuple<"(?,?)">
          %1362 = cute.get_scalars(%e0_3927) : !cute.int_tuple<"?">
          %1363 = cute.get_scalars(%e1_3928) : !cute.int_tuple<"?">
          %iter_3929 = cute.get_iter(%view_3925) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3930, %e1_3931 = cute.get_leaves(%iter_3929) : !cute.int_tuple<"(?,?)">
          %1364 = cute.get_scalars(%e0_3930) : !cute.int_tuple<"?">
          %1365 = cute.get_scalars(%e1_3931) : !cute.int_tuple<"?">
          %iter_3932 = cute.get_iter(%view_3925) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3933, %e1_3934 = cute.get_leaves(%iter_3932) : !cute.int_tuple<"(?,?)">
          %1366 = cute.get_scalars(%e0_3933) : !cute.int_tuple<"?">
          %1367 = cute.get_scalars(%e1_3934) : !cute.int_tuple<"?">
          %coord_3935 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_3936 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3937 = cute.crd2idx(%coord_3935, %lay_3936) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_3938 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3939 = cute.add_offset(%iter_3938, %idx_3937) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_3940 = cute.make_view(%tup_3939) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3941 = cute.get_iter(%view_3940) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3942, %e1_3943 = cute.get_leaves(%iter_3941) : !cute.int_tuple<"(?,?)">
          %1368 = cute.get_scalars(%e0_3942) : !cute.int_tuple<"?">
          %1369 = cute.get_scalars(%e1_3943) : !cute.int_tuple<"?">
          %iter_3944 = cute.get_iter(%view_3940) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3945, %e1_3946 = cute.get_leaves(%iter_3944) : !cute.int_tuple<"(?,?)">
          %1370 = cute.get_scalars(%e0_3945) : !cute.int_tuple<"?">
          %1371 = cute.get_scalars(%e1_3946) : !cute.int_tuple<"?">
          %iter_3947 = cute.get_iter(%view_3940) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3948, %e1_3949 = cute.get_leaves(%iter_3947) : !cute.int_tuple<"(?,?)">
          %1372 = cute.get_scalars(%e0_3948) : !cute.int_tuple<"?">
          %1373 = cute.get_scalars(%e1_3949) : !cute.int_tuple<"?">
          %coord_3950 = cute.make_coord(%e0_3933) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3951 = cute.make_coord(%e1_3949) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1374 = cute.elem_less(%coord_3950, %coord_3951) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3952 = cute.get_layout(%1359) : !memref_rmem_f32_1
          %1375 = cute.get_shape(%lay_3952) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3953, %e1_3954, %e2_3955, %e3_3956 = cute.get_leaves(%1375) : !cute.shape<"((2,2),1,8)">
          %1376 = cute.get_stride(%lay_3952) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3957, %e1_3958, %e2_3959, %e3_3960 = cute.get_leaves(%1376) : !cute.stride<"((1,2),0,4)">
          %1377 = scf.if %1374 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1359) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
            cute.memref.store(%1359, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1359) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1359 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1359) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1359) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1359 : !memref_rmem_f32_1
          }
          %iter_3961 = cute.get_iter(%1377) : !memref_rmem_f32_1
          %lay_3962 = cute.get_layout(%1377) : !memref_rmem_f32_1
          %1378 = cute.get_shape(%lay_3962) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3963, %e1_3964, %e2_3965, %e3_3966 = cute.get_leaves(%1378) : !cute.shape<"((2,2),1,8)">
          %1379 = cute.get_stride(%lay_3962) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3967, %e1_3968, %e2_3969, %e3_3970 = cute.get_leaves(%1379) : !cute.stride<"((1,2),0,4)">
          %iter_3971 = cute.get_iter(%1377) : !memref_rmem_f32_1
          %iter_3972 = cute.get_iter(%1377) : !memref_rmem_f32_1
          %coord_3973 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_3974 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3975 = cute.crd2idx(%coord_3973, %lay_3974) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_3976 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3977 = cute.add_offset(%iter_3976, %idx_3975) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_3978 = cute.make_view(%tup_3977) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3979 = cute.get_iter(%view_3978) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3980, %e1_3981 = cute.get_leaves(%iter_3979) : !cute.int_tuple<"(?,?)">
          %1380 = cute.get_scalars(%e0_3980) : !cute.int_tuple<"?">
          %1381 = cute.get_scalars(%e1_3981) : !cute.int_tuple<"?">
          %iter_3982 = cute.get_iter(%view_3978) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3983, %e1_3984 = cute.get_leaves(%iter_3982) : !cute.int_tuple<"(?,?)">
          %1382 = cute.get_scalars(%e0_3983) : !cute.int_tuple<"?">
          %1383 = cute.get_scalars(%e1_3984) : !cute.int_tuple<"?">
          %iter_3985 = cute.get_iter(%view_3978) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3986, %e1_3987 = cute.get_leaves(%iter_3985) : !cute.int_tuple<"(?,?)">
          %1384 = cute.get_scalars(%e0_3986) : !cute.int_tuple<"?">
          %1385 = cute.get_scalars(%e1_3987) : !cute.int_tuple<"?">
          %coord_3988 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_3989 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3990 = cute.crd2idx(%coord_3988, %lay_3989) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_3991 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3992 = cute.add_offset(%iter_3991, %idx_3990) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_3993 = cute.make_view(%tup_3992) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3994 = cute.get_iter(%view_3993) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3995, %e1_3996 = cute.get_leaves(%iter_3994) : !cute.int_tuple<"(?,?)">
          %1386 = cute.get_scalars(%e0_3995) : !cute.int_tuple<"?">
          %1387 = cute.get_scalars(%e1_3996) : !cute.int_tuple<"?">
          %iter_3997 = cute.get_iter(%view_3993) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3998, %e1_3999 = cute.get_leaves(%iter_3997) : !cute.int_tuple<"(?,?)">
          %1388 = cute.get_scalars(%e0_3998) : !cute.int_tuple<"?">
          %1389 = cute.get_scalars(%e1_3999) : !cute.int_tuple<"?">
          %iter_4000 = cute.get_iter(%view_3993) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4001, %e1_4002 = cute.get_leaves(%iter_4000) : !cute.int_tuple<"(?,?)">
          %1390 = cute.get_scalars(%e0_4001) : !cute.int_tuple<"?">
          %1391 = cute.get_scalars(%e1_4002) : !cute.int_tuple<"?">
          %coord_4003 = cute.make_coord(%e0_3986) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4004 = cute.make_coord(%e1_4002) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1392 = cute.elem_less(%coord_4003, %coord_4004) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4005 = cute.get_layout(%1377) : !memref_rmem_f32_1
          %1393 = cute.get_shape(%lay_4005) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4006, %e1_4007, %e2_4008, %e3_4009 = cute.get_leaves(%1393) : !cute.shape<"((2,2),1,8)">
          %1394 = cute.get_stride(%lay_4005) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4010, %e1_4011, %e2_4012, %e3_4013 = cute.get_leaves(%1394) : !cute.stride<"((1,2),0,4)">
          %1395 = scf.if %1392 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1377) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
            cute.memref.store(%1377, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1377) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1377 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1377) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1377) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1377 : !memref_rmem_f32_1
          }
          %iter_4014 = cute.get_iter(%1395) : !memref_rmem_f32_1
          %lay_4015 = cute.get_layout(%1395) : !memref_rmem_f32_1
          %1396 = cute.get_shape(%lay_4015) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4016, %e1_4017, %e2_4018, %e3_4019 = cute.get_leaves(%1396) : !cute.shape<"((2,2),1,8)">
          %1397 = cute.get_stride(%lay_4015) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4020, %e1_4021, %e2_4022, %e3_4023 = cute.get_leaves(%1397) : !cute.stride<"((1,2),0,4)">
          %iter_4024 = cute.get_iter(%1395) : !memref_rmem_f32_1
          %iter_4025 = cute.get_iter(%1395) : !memref_rmem_f32_1
          %coord_4026 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4027 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4028 = cute.crd2idx(%coord_4026, %lay_4027) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4029 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4030 = cute.add_offset(%iter_4029, %idx_4028) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4031 = cute.make_view(%tup_4030) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4032 = cute.get_iter(%view_4031) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4033, %e1_4034 = cute.get_leaves(%iter_4032) : !cute.int_tuple<"(?,?)">
          %1398 = cute.get_scalars(%e0_4033) : !cute.int_tuple<"?">
          %1399 = cute.get_scalars(%e1_4034) : !cute.int_tuple<"?">
          %iter_4035 = cute.get_iter(%view_4031) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4036, %e1_4037 = cute.get_leaves(%iter_4035) : !cute.int_tuple<"(?,?)">
          %1400 = cute.get_scalars(%e0_4036) : !cute.int_tuple<"?">
          %1401 = cute.get_scalars(%e1_4037) : !cute.int_tuple<"?">
          %iter_4038 = cute.get_iter(%view_4031) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4039, %e1_4040 = cute.get_leaves(%iter_4038) : !cute.int_tuple<"(?,?)">
          %1402 = cute.get_scalars(%e0_4039) : !cute.int_tuple<"?">
          %1403 = cute.get_scalars(%e1_4040) : !cute.int_tuple<"?">
          %coord_4041 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4042 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4043 = cute.crd2idx(%coord_4041, %lay_4042) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4044 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4045 = cute.add_offset(%iter_4044, %idx_4043) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4046 = cute.make_view(%tup_4045) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4047 = cute.get_iter(%view_4046) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4048, %e1_4049 = cute.get_leaves(%iter_4047) : !cute.int_tuple<"(?,?)">
          %1404 = cute.get_scalars(%e0_4048) : !cute.int_tuple<"?">
          %1405 = cute.get_scalars(%e1_4049) : !cute.int_tuple<"?">
          %iter_4050 = cute.get_iter(%view_4046) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4051, %e1_4052 = cute.get_leaves(%iter_4050) : !cute.int_tuple<"(?,?)">
          %1406 = cute.get_scalars(%e0_4051) : !cute.int_tuple<"?">
          %1407 = cute.get_scalars(%e1_4052) : !cute.int_tuple<"?">
          %iter_4053 = cute.get_iter(%view_4046) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4054, %e1_4055 = cute.get_leaves(%iter_4053) : !cute.int_tuple<"(?,?)">
          %1408 = cute.get_scalars(%e0_4054) : !cute.int_tuple<"?">
          %1409 = cute.get_scalars(%e1_4055) : !cute.int_tuple<"?">
          %coord_4056 = cute.make_coord(%e0_4039) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4057 = cute.make_coord(%e1_4055) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1410 = cute.elem_less(%coord_4056, %coord_4057) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4058 = cute.get_layout(%1395) : !memref_rmem_f32_1
          %1411 = cute.get_shape(%lay_4058) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4059, %e1_4060, %e2_4061, %e3_4062 = cute.get_leaves(%1411) : !cute.shape<"((2,2),1,8)">
          %1412 = cute.get_stride(%lay_4058) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4063, %e1_4064, %e2_4065, %e3_4066 = cute.get_leaves(%1412) : !cute.stride<"((1,2),0,4)">
          %1413 = scf.if %1410 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1395) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
            cute.memref.store(%1395, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1395) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1395 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1395) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1395) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1395 : !memref_rmem_f32_1
          }
          %iter_4067 = cute.get_iter(%1413) : !memref_rmem_f32_1
          %lay_4068 = cute.get_layout(%1413) : !memref_rmem_f32_1
          %1414 = cute.get_shape(%lay_4068) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4069, %e1_4070, %e2_4071, %e3_4072 = cute.get_leaves(%1414) : !cute.shape<"((2,2),1,8)">
          %1415 = cute.get_stride(%lay_4068) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1415) : !cute.stride<"((1,2),0,4)">
          %iter_4077 = cute.get_iter(%1413) : !memref_rmem_f32_1
          %iter_4078 = cute.get_iter(%1413) : !memref_rmem_f32_1
          %coord_4079 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4080 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4081 = cute.crd2idx(%coord_4079, %lay_4080) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4082 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4083 = cute.add_offset(%iter_4082, %idx_4081) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4084 = cute.make_view(%tup_4083) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4085 = cute.get_iter(%view_4084) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4086, %e1_4087 = cute.get_leaves(%iter_4085) : !cute.int_tuple<"(?,?)">
          %1416 = cute.get_scalars(%e0_4086) : !cute.int_tuple<"?">
          %1417 = cute.get_scalars(%e1_4087) : !cute.int_tuple<"?">
          %iter_4088 = cute.get_iter(%view_4084) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4089, %e1_4090 = cute.get_leaves(%iter_4088) : !cute.int_tuple<"(?,?)">
          %1418 = cute.get_scalars(%e0_4089) : !cute.int_tuple<"?">
          %1419 = cute.get_scalars(%e1_4090) : !cute.int_tuple<"?">
          %iter_4091 = cute.get_iter(%view_4084) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4092, %e1_4093 = cute.get_leaves(%iter_4091) : !cute.int_tuple<"(?,?)">
          %1420 = cute.get_scalars(%e0_4092) : !cute.int_tuple<"?">
          %1421 = cute.get_scalars(%e1_4093) : !cute.int_tuple<"?">
          %coord_4094 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4095 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4097 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4099 = cute.make_view(%tup_4098) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4100 = cute.get_iter(%view_4099) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4101, %e1_4102 = cute.get_leaves(%iter_4100) : !cute.int_tuple<"(?,?)">
          %1422 = cute.get_scalars(%e0_4101) : !cute.int_tuple<"?">
          %1423 = cute.get_scalars(%e1_4102) : !cute.int_tuple<"?">
          %iter_4103 = cute.get_iter(%view_4099) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4104, %e1_4105 = cute.get_leaves(%iter_4103) : !cute.int_tuple<"(?,?)">
          %1424 = cute.get_scalars(%e0_4104) : !cute.int_tuple<"?">
          %1425 = cute.get_scalars(%e1_4105) : !cute.int_tuple<"?">
          %iter_4106 = cute.get_iter(%view_4099) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4107, %e1_4108 = cute.get_leaves(%iter_4106) : !cute.int_tuple<"(?,?)">
          %1426 = cute.get_scalars(%e0_4107) : !cute.int_tuple<"?">
          %1427 = cute.get_scalars(%e1_4108) : !cute.int_tuple<"?">
          %coord_4109 = cute.make_coord(%e0_4092) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4110 = cute.make_coord(%e1_4108) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1428 = cute.elem_less(%coord_4109, %coord_4110) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4111 = cute.get_layout(%1413) : !memref_rmem_f32_1
          %1429 = cute.get_shape(%lay_4111) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1429) : !cute.shape<"((2,2),1,8)">
          %1430 = cute.get_stride(%lay_4111) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4116, %e1_4117, %e2_4118, %e3_4119 = cute.get_leaves(%1430) : !cute.stride<"((1,2),0,4)">
          %1431 = scf.if %1428 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1413) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
            cute.memref.store(%1413, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1413) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1413 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1413) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1413) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1413 : !memref_rmem_f32_1
          }
          %iter_4120 = cute.get_iter(%1431) : !memref_rmem_f32_1
          %lay_4121 = cute.get_layout(%1431) : !memref_rmem_f32_1
          %1432 = cute.get_shape(%lay_4121) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4122, %e1_4123, %e2_4124, %e3_4125 = cute.get_leaves(%1432) : !cute.shape<"((2,2),1,8)">
          %1433 = cute.get_stride(%lay_4121) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4126, %e1_4127, %e2_4128, %e3_4129 = cute.get_leaves(%1433) : !cute.stride<"((1,2),0,4)">
          %iter_4130 = cute.get_iter(%1431) : !memref_rmem_f32_1
          %iter_4131 = cute.get_iter(%1431) : !memref_rmem_f32_1
          %int_tuple_4132 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4133 = cute.size(%int_tuple_4132) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4134 = cute.get_leaves(%sz_4133) : !cute.int_tuple<"1">
          %int_tuple_4135 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4136 = cute.size(%int_tuple_4135) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4137 = cute.get_leaves(%sz_4136) : !cute.int_tuple<"8">
          %coord_4138 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4139 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4140 = cute.crd2idx(%coord_4138, %lay_4139) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4141 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4142 = cute.add_offset(%iter_4141, %idx_4140) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4143 = cute.make_view(%tup_4142) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4144 = cute.get_iter(%view_4143) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4145, %e1_4146 = cute.get_leaves(%iter_4144) : !cute.int_tuple<"(?,?{div=2})">
          %1434 = cute.get_scalars(%e0_4145) : !cute.int_tuple<"?">
          %1435 = cute.get_scalars(%e1_4146) : !cute.int_tuple<"?{div=2}">
          %iter_4147 = cute.get_iter(%view_4143) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4148, %e1_4149 = cute.get_leaves(%iter_4147) : !cute.int_tuple<"(?,?{div=2})">
          %1436 = cute.get_scalars(%e0_4148) : !cute.int_tuple<"?">
          %1437 = cute.get_scalars(%e1_4149) : !cute.int_tuple<"?{div=2}">
          %iter_4150 = cute.get_iter(%view_4143) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4151, %e1_4152 = cute.get_leaves(%iter_4150) : !cute.int_tuple<"(?,?{div=2})">
          %1438 = cute.get_scalars(%e0_4151) : !cute.int_tuple<"?">
          %1439 = cute.get_scalars(%e1_4152) : !cute.int_tuple<"?{div=2}">
          %coord_4153 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4154 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4155 = cute.crd2idx(%coord_4153, %lay_4154) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4156 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4157 = cute.add_offset(%iter_4156, %idx_4155) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4158 = cute.make_view(%tup_4157) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4159 = cute.get_iter(%view_4158) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4160, %e1_4161 = cute.get_leaves(%iter_4159) : !cute.int_tuple<"(?,?{div=2})">
          %1440 = cute.get_scalars(%e0_4160) : !cute.int_tuple<"?">
          %1441 = cute.get_scalars(%e1_4161) : !cute.int_tuple<"?{div=2}">
          %iter_4162 = cute.get_iter(%view_4158) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4163, %e1_4164 = cute.get_leaves(%iter_4162) : !cute.int_tuple<"(?,?{div=2})">
          %1442 = cute.get_scalars(%e0_4163) : !cute.int_tuple<"?">
          %1443 = cute.get_scalars(%e1_4164) : !cute.int_tuple<"?{div=2}">
          %iter_4165 = cute.get_iter(%view_4158) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4166, %e1_4167 = cute.get_leaves(%iter_4165) : !cute.int_tuple<"(?,?{div=2})">
          %1444 = cute.get_scalars(%e0_4166) : !cute.int_tuple<"?">
          %1445 = cute.get_scalars(%e1_4167) : !cute.int_tuple<"?{div=2}">
          %coord_4168 = cute.make_coord(%e0_4151) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4169 = cute.make_coord(%e1_4167) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1446 = cute.elem_less(%coord_4168, %coord_4169) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4170 = cute.get_layout(%1431) : !memref_rmem_f32_1
          %1447 = cute.get_shape(%lay_4170) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4171, %e1_4172, %e2_4173, %e3_4174 = cute.get_leaves(%1447) : !cute.shape<"((2,2),1,8)">
          %1448 = cute.get_stride(%lay_4170) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4175, %e1_4176, %e2_4177, %e3_4178 = cute.get_leaves(%1448) : !cute.stride<"((1,2),0,4)">
          %1449 = scf.if %1446 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1431) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
            cute.memref.store(%1431, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1431) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1431 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1431) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1431) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1431 : !memref_rmem_f32_1
          }
          %iter_4179 = cute.get_iter(%1449) : !memref_rmem_f32_1
          %lay_4180 = cute.get_layout(%1449) : !memref_rmem_f32_1
          %1450 = cute.get_shape(%lay_4180) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4181, %e1_4182, %e2_4183, %e3_4184 = cute.get_leaves(%1450) : !cute.shape<"((2,2),1,8)">
          %1451 = cute.get_stride(%lay_4180) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4185, %e1_4186, %e2_4187, %e3_4188 = cute.get_leaves(%1451) : !cute.stride<"((1,2),0,4)">
          %iter_4189 = cute.get_iter(%1449) : !memref_rmem_f32_1
          %iter_4190 = cute.get_iter(%1449) : !memref_rmem_f32_1
          %coord_4191 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4192 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4193 = cute.crd2idx(%coord_4191, %lay_4192) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4194 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4195 = cute.add_offset(%iter_4194, %idx_4193) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4196 = cute.make_view(%tup_4195) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4197 = cute.get_iter(%view_4196) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4198, %e1_4199 = cute.get_leaves(%iter_4197) : !cute.int_tuple<"(?,?{div=2})">
          %1452 = cute.get_scalars(%e0_4198) : !cute.int_tuple<"?">
          %1453 = cute.get_scalars(%e1_4199) : !cute.int_tuple<"?{div=2}">
          %iter_4200 = cute.get_iter(%view_4196) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4201, %e1_4202 = cute.get_leaves(%iter_4200) : !cute.int_tuple<"(?,?{div=2})">
          %1454 = cute.get_scalars(%e0_4201) : !cute.int_tuple<"?">
          %1455 = cute.get_scalars(%e1_4202) : !cute.int_tuple<"?{div=2}">
          %iter_4203 = cute.get_iter(%view_4196) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4204, %e1_4205 = cute.get_leaves(%iter_4203) : !cute.int_tuple<"(?,?{div=2})">
          %1456 = cute.get_scalars(%e0_4204) : !cute.int_tuple<"?">
          %1457 = cute.get_scalars(%e1_4205) : !cute.int_tuple<"?{div=2}">
          %coord_4206 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4207 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4208 = cute.crd2idx(%coord_4206, %lay_4207) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4209 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4210 = cute.add_offset(%iter_4209, %idx_4208) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4211 = cute.make_view(%tup_4210) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4212 = cute.get_iter(%view_4211) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4213, %e1_4214 = cute.get_leaves(%iter_4212) : !cute.int_tuple<"(?,?{div=2})">
          %1458 = cute.get_scalars(%e0_4213) : !cute.int_tuple<"?">
          %1459 = cute.get_scalars(%e1_4214) : !cute.int_tuple<"?{div=2}">
          %iter_4215 = cute.get_iter(%view_4211) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4216, %e1_4217 = cute.get_leaves(%iter_4215) : !cute.int_tuple<"(?,?{div=2})">
          %1460 = cute.get_scalars(%e0_4216) : !cute.int_tuple<"?">
          %1461 = cute.get_scalars(%e1_4217) : !cute.int_tuple<"?{div=2}">
          %iter_4218 = cute.get_iter(%view_4211) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4219, %e1_4220 = cute.get_leaves(%iter_4218) : !cute.int_tuple<"(?,?{div=2})">
          %1462 = cute.get_scalars(%e0_4219) : !cute.int_tuple<"?">
          %1463 = cute.get_scalars(%e1_4220) : !cute.int_tuple<"?{div=2}">
          %coord_4221 = cute.make_coord(%e0_4204) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4222 = cute.make_coord(%e1_4220) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1464 = cute.elem_less(%coord_4221, %coord_4222) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4223 = cute.get_layout(%1449) : !memref_rmem_f32_1
          %1465 = cute.get_shape(%lay_4223) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4224, %e1_4225, %e2_4226, %e3_4227 = cute.get_leaves(%1465) : !cute.shape<"((2,2),1,8)">
          %1466 = cute.get_stride(%lay_4223) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4228, %e1_4229, %e2_4230, %e3_4231 = cute.get_leaves(%1466) : !cute.stride<"((1,2),0,4)">
          %1467 = scf.if %1464 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1449) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
            cute.memref.store(%1449, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1449) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1449 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1449) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1449) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1449 : !memref_rmem_f32_1
          }
          %iter_4232 = cute.get_iter(%1467) : !memref_rmem_f32_1
          %lay_4233 = cute.get_layout(%1467) : !memref_rmem_f32_1
          %1468 = cute.get_shape(%lay_4233) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4234, %e1_4235, %e2_4236, %e3_4237 = cute.get_leaves(%1468) : !cute.shape<"((2,2),1,8)">
          %1469 = cute.get_stride(%lay_4233) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4238, %e1_4239, %e2_4240, %e3_4241 = cute.get_leaves(%1469) : !cute.stride<"((1,2),0,4)">
          %iter_4242 = cute.get_iter(%1467) : !memref_rmem_f32_1
          %iter_4243 = cute.get_iter(%1467) : !memref_rmem_f32_1
          %coord_4244 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_4245 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4246 = cute.crd2idx(%coord_4244, %lay_4245) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_4247 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4248 = cute.add_offset(%iter_4247, %idx_4246) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4249 = cute.make_view(%tup_4248) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4250 = cute.get_iter(%view_4249) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4251, %e1_4252 = cute.get_leaves(%iter_4250) : !cute.int_tuple<"(?,?{div=2})">
          %1470 = cute.get_scalars(%e0_4251) : !cute.int_tuple<"?">
          %1471 = cute.get_scalars(%e1_4252) : !cute.int_tuple<"?{div=2}">
          %iter_4253 = cute.get_iter(%view_4249) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4254, %e1_4255 = cute.get_leaves(%iter_4253) : !cute.int_tuple<"(?,?{div=2})">
          %1472 = cute.get_scalars(%e0_4254) : !cute.int_tuple<"?">
          %1473 = cute.get_scalars(%e1_4255) : !cute.int_tuple<"?{div=2}">
          %iter_4256 = cute.get_iter(%view_4249) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4257, %e1_4258 = cute.get_leaves(%iter_4256) : !cute.int_tuple<"(?,?{div=2})">
          %1474 = cute.get_scalars(%e0_4257) : !cute.int_tuple<"?">
          %1475 = cute.get_scalars(%e1_4258) : !cute.int_tuple<"?{div=2}">
          %coord_4259 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_4260 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4261 = cute.crd2idx(%coord_4259, %lay_4260) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_4262 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4263 = cute.add_offset(%iter_4262, %idx_4261) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4264 = cute.make_view(%tup_4263) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4265 = cute.get_iter(%view_4264) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4266, %e1_4267 = cute.get_leaves(%iter_4265) : !cute.int_tuple<"(?,?{div=2})">
          %1476 = cute.get_scalars(%e0_4266) : !cute.int_tuple<"?">
          %1477 = cute.get_scalars(%e1_4267) : !cute.int_tuple<"?{div=2}">
          %iter_4268 = cute.get_iter(%view_4264) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4269, %e1_4270 = cute.get_leaves(%iter_4268) : !cute.int_tuple<"(?,?{div=2})">
          %1478 = cute.get_scalars(%e0_4269) : !cute.int_tuple<"?">
          %1479 = cute.get_scalars(%e1_4270) : !cute.int_tuple<"?{div=2}">
          %iter_4271 = cute.get_iter(%view_4264) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4272, %e1_4273 = cute.get_leaves(%iter_4271) : !cute.int_tuple<"(?,?{div=2})">
          %1480 = cute.get_scalars(%e0_4272) : !cute.int_tuple<"?">
          %1481 = cute.get_scalars(%e1_4273) : !cute.int_tuple<"?{div=2}">
          %coord_4274 = cute.make_coord(%e0_4257) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4275 = cute.make_coord(%e1_4273) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1482 = cute.elem_less(%coord_4274, %coord_4275) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4276 = cute.get_layout(%1467) : !memref_rmem_f32_1
          %1483 = cute.get_shape(%lay_4276) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4277, %e1_4278, %e2_4279, %e3_4280 = cute.get_leaves(%1483) : !cute.shape<"((2,2),1,8)">
          %1484 = cute.get_stride(%lay_4276) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4281, %e1_4282, %e2_4283, %e3_4284 = cute.get_leaves(%1484) : !cute.stride<"((1,2),0,4)">
          %1485 = scf.if %1482 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1467) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
            cute.memref.store(%1467, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1467) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1467 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1467) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1467) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1467 : !memref_rmem_f32_1
          }
          %iter_4285 = cute.get_iter(%1485) : !memref_rmem_f32_1
          %lay_4286 = cute.get_layout(%1485) : !memref_rmem_f32_1
          %1486 = cute.get_shape(%lay_4286) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4287, %e1_4288, %e2_4289, %e3_4290 = cute.get_leaves(%1486) : !cute.shape<"((2,2),1,8)">
          %1487 = cute.get_stride(%lay_4286) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4291, %e1_4292, %e2_4293, %e3_4294 = cute.get_leaves(%1487) : !cute.stride<"((1,2),0,4)">
          %iter_4295 = cute.get_iter(%1485) : !memref_rmem_f32_1
          %iter_4296 = cute.get_iter(%1485) : !memref_rmem_f32_1
          %coord_4297 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_4298 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4299 = cute.crd2idx(%coord_4297, %lay_4298) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_4300 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4301 = cute.add_offset(%iter_4300, %idx_4299) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4302 = cute.make_view(%tup_4301) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4303 = cute.get_iter(%view_4302) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4304, %e1_4305 = cute.get_leaves(%iter_4303) : !cute.int_tuple<"(?,?{div=2})">
          %1488 = cute.get_scalars(%e0_4304) : !cute.int_tuple<"?">
          %1489 = cute.get_scalars(%e1_4305) : !cute.int_tuple<"?{div=2}">
          %iter_4306 = cute.get_iter(%view_4302) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4307, %e1_4308 = cute.get_leaves(%iter_4306) : !cute.int_tuple<"(?,?{div=2})">
          %1490 = cute.get_scalars(%e0_4307) : !cute.int_tuple<"?">
          %1491 = cute.get_scalars(%e1_4308) : !cute.int_tuple<"?{div=2}">
          %iter_4309 = cute.get_iter(%view_4302) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4310, %e1_4311 = cute.get_leaves(%iter_4309) : !cute.int_tuple<"(?,?{div=2})">
          %1492 = cute.get_scalars(%e0_4310) : !cute.int_tuple<"?">
          %1493 = cute.get_scalars(%e1_4311) : !cute.int_tuple<"?{div=2}">
          %coord_4312 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_4313 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4314 = cute.crd2idx(%coord_4312, %lay_4313) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_4315 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4316 = cute.add_offset(%iter_4315, %idx_4314) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4317 = cute.make_view(%tup_4316) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4318 = cute.get_iter(%view_4317) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4319, %e1_4320 = cute.get_leaves(%iter_4318) : !cute.int_tuple<"(?,?{div=2})">
          %1494 = cute.get_scalars(%e0_4319) : !cute.int_tuple<"?">
          %1495 = cute.get_scalars(%e1_4320) : !cute.int_tuple<"?{div=2}">
          %iter_4321 = cute.get_iter(%view_4317) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4322, %e1_4323 = cute.get_leaves(%iter_4321) : !cute.int_tuple<"(?,?{div=2})">
          %1496 = cute.get_scalars(%e0_4322) : !cute.int_tuple<"?">
          %1497 = cute.get_scalars(%e1_4323) : !cute.int_tuple<"?{div=2}">
          %iter_4324 = cute.get_iter(%view_4317) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4325, %e1_4326 = cute.get_leaves(%iter_4324) : !cute.int_tuple<"(?,?{div=2})">
          %1498 = cute.get_scalars(%e0_4325) : !cute.int_tuple<"?">
          %1499 = cute.get_scalars(%e1_4326) : !cute.int_tuple<"?{div=2}">
          %coord_4327 = cute.make_coord(%e0_4310) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4328 = cute.make_coord(%e1_4326) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1500 = cute.elem_less(%coord_4327, %coord_4328) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4329 = cute.get_layout(%1485) : !memref_rmem_f32_1
          %1501 = cute.get_shape(%lay_4329) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4330, %e1_4331, %e2_4332, %e3_4333 = cute.get_leaves(%1501) : !cute.shape<"((2,2),1,8)">
          %1502 = cute.get_stride(%lay_4329) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4334, %e1_4335, %e2_4336, %e3_4337 = cute.get_leaves(%1502) : !cute.stride<"((1,2),0,4)">
          %1503 = scf.if %1500 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1485) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
            cute.memref.store(%1485, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1485) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1485 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1485) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1485) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1485 : !memref_rmem_f32_1
          }
          %iter_4338 = cute.get_iter(%1503) : !memref_rmem_f32_1
          %lay_4339 = cute.get_layout(%1503) : !memref_rmem_f32_1
          %1504 = cute.get_shape(%lay_4339) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4340, %e1_4341, %e2_4342, %e3_4343 = cute.get_leaves(%1504) : !cute.shape<"((2,2),1,8)">
          %1505 = cute.get_stride(%lay_4339) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4344, %e1_4345, %e2_4346, %e3_4347 = cute.get_leaves(%1505) : !cute.stride<"((1,2),0,4)">
          %iter_4348 = cute.get_iter(%1503) : !memref_rmem_f32_1
          %iter_4349 = cute.get_iter(%1503) : !memref_rmem_f32_1
          %coord_4350 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_4351 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4352 = cute.crd2idx(%coord_4350, %lay_4351) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_4353 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4354 = cute.add_offset(%iter_4353, %idx_4352) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4355 = cute.make_view(%tup_4354) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4356 = cute.get_iter(%view_4355) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4357, %e1_4358 = cute.get_leaves(%iter_4356) : !cute.int_tuple<"(?,?{div=2})">
          %1506 = cute.get_scalars(%e0_4357) : !cute.int_tuple<"?">
          %1507 = cute.get_scalars(%e1_4358) : !cute.int_tuple<"?{div=2}">
          %iter_4359 = cute.get_iter(%view_4355) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4360, %e1_4361 = cute.get_leaves(%iter_4359) : !cute.int_tuple<"(?,?{div=2})">
          %1508 = cute.get_scalars(%e0_4360) : !cute.int_tuple<"?">
          %1509 = cute.get_scalars(%e1_4361) : !cute.int_tuple<"?{div=2}">
          %iter_4362 = cute.get_iter(%view_4355) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4363, %e1_4364 = cute.get_leaves(%iter_4362) : !cute.int_tuple<"(?,?{div=2})">
          %1510 = cute.get_scalars(%e0_4363) : !cute.int_tuple<"?">
          %1511 = cute.get_scalars(%e1_4364) : !cute.int_tuple<"?{div=2}">
          %coord_4365 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_4366 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4367 = cute.crd2idx(%coord_4365, %lay_4366) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_4368 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4369 = cute.add_offset(%iter_4368, %idx_4367) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4370 = cute.make_view(%tup_4369) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4371 = cute.get_iter(%view_4370) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4372, %e1_4373 = cute.get_leaves(%iter_4371) : !cute.int_tuple<"(?,?{div=2})">
          %1512 = cute.get_scalars(%e0_4372) : !cute.int_tuple<"?">
          %1513 = cute.get_scalars(%e1_4373) : !cute.int_tuple<"?{div=2}">
          %iter_4374 = cute.get_iter(%view_4370) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4375, %e1_4376 = cute.get_leaves(%iter_4374) : !cute.int_tuple<"(?,?{div=2})">
          %1514 = cute.get_scalars(%e0_4375) : !cute.int_tuple<"?">
          %1515 = cute.get_scalars(%e1_4376) : !cute.int_tuple<"?{div=2}">
          %iter_4377 = cute.get_iter(%view_4370) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4378, %e1_4379 = cute.get_leaves(%iter_4377) : !cute.int_tuple<"(?,?{div=2})">
          %1516 = cute.get_scalars(%e0_4378) : !cute.int_tuple<"?">
          %1517 = cute.get_scalars(%e1_4379) : !cute.int_tuple<"?{div=2}">
          %coord_4380 = cute.make_coord(%e0_4363) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4381 = cute.make_coord(%e1_4379) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1518 = cute.elem_less(%coord_4380, %coord_4381) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4382 = cute.get_layout(%1503) : !memref_rmem_f32_1
          %1519 = cute.get_shape(%lay_4382) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4383, %e1_4384, %e2_4385, %e3_4386 = cute.get_leaves(%1519) : !cute.shape<"((2,2),1,8)">
          %1520 = cute.get_stride(%lay_4382) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4387, %e1_4388, %e2_4389, %e3_4390 = cute.get_leaves(%1520) : !cute.stride<"((1,2),0,4)">
          %1521 = scf.if %1518 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1503) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
            cute.memref.store(%1503, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1503) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1503 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1503) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1503) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1503 : !memref_rmem_f32_1
          }
          %iter_4391 = cute.get_iter(%1521) : !memref_rmem_f32_1
          %lay_4392 = cute.get_layout(%1521) : !memref_rmem_f32_1
          %1522 = cute.get_shape(%lay_4392) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4393, %e1_4394, %e2_4395, %e3_4396 = cute.get_leaves(%1522) : !cute.shape<"((2,2),1,8)">
          %1523 = cute.get_stride(%lay_4392) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4397, %e1_4398, %e2_4399, %e3_4400 = cute.get_leaves(%1523) : !cute.stride<"((1,2),0,4)">
          %iter_4401 = cute.get_iter(%1521) : !memref_rmem_f32_1
          %iter_4402 = cute.get_iter(%1521) : !memref_rmem_f32_1
          %coord_4403 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_4404 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4405 = cute.crd2idx(%coord_4403, %lay_4404) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_4406 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4407 = cute.add_offset(%iter_4406, %idx_4405) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4408 = cute.make_view(%tup_4407) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4409 = cute.get_iter(%view_4408) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4410, %e1_4411 = cute.get_leaves(%iter_4409) : !cute.int_tuple<"(?,?{div=2})">
          %1524 = cute.get_scalars(%e0_4410) : !cute.int_tuple<"?">
          %1525 = cute.get_scalars(%e1_4411) : !cute.int_tuple<"?{div=2}">
          %iter_4412 = cute.get_iter(%view_4408) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4413, %e1_4414 = cute.get_leaves(%iter_4412) : !cute.int_tuple<"(?,?{div=2})">
          %1526 = cute.get_scalars(%e0_4413) : !cute.int_tuple<"?">
          %1527 = cute.get_scalars(%e1_4414) : !cute.int_tuple<"?{div=2}">
          %iter_4415 = cute.get_iter(%view_4408) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4416, %e1_4417 = cute.get_leaves(%iter_4415) : !cute.int_tuple<"(?,?{div=2})">
          %1528 = cute.get_scalars(%e0_4416) : !cute.int_tuple<"?">
          %1529 = cute.get_scalars(%e1_4417) : !cute.int_tuple<"?{div=2}">
          %coord_4418 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_4419 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4420 = cute.crd2idx(%coord_4418, %lay_4419) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_4421 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4422 = cute.add_offset(%iter_4421, %idx_4420) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4423 = cute.make_view(%tup_4422) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4424 = cute.get_iter(%view_4423) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4425, %e1_4426 = cute.get_leaves(%iter_4424) : !cute.int_tuple<"(?,?{div=2})">
          %1530 = cute.get_scalars(%e0_4425) : !cute.int_tuple<"?">
          %1531 = cute.get_scalars(%e1_4426) : !cute.int_tuple<"?{div=2}">
          %iter_4427 = cute.get_iter(%view_4423) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4428, %e1_4429 = cute.get_leaves(%iter_4427) : !cute.int_tuple<"(?,?{div=2})">
          %1532 = cute.get_scalars(%e0_4428) : !cute.int_tuple<"?">
          %1533 = cute.get_scalars(%e1_4429) : !cute.int_tuple<"?{div=2}">
          %iter_4430 = cute.get_iter(%view_4423) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4431, %e1_4432 = cute.get_leaves(%iter_4430) : !cute.int_tuple<"(?,?{div=2})">
          %1534 = cute.get_scalars(%e0_4431) : !cute.int_tuple<"?">
          %1535 = cute.get_scalars(%e1_4432) : !cute.int_tuple<"?{div=2}">
          %coord_4433 = cute.make_coord(%e0_4416) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4434 = cute.make_coord(%e1_4432) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1536 = cute.elem_less(%coord_4433, %coord_4434) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4435 = cute.get_layout(%1521) : !memref_rmem_f32_1
          %1537 = cute.get_shape(%lay_4435) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4436, %e1_4437, %e2_4438, %e3_4439 = cute.get_leaves(%1537) : !cute.shape<"((2,2),1,8)">
          %1538 = cute.get_stride(%lay_4435) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4440, %e1_4441, %e2_4442, %e3_4443 = cute.get_leaves(%1538) : !cute.stride<"((1,2),0,4)">
          %1539 = scf.if %1536 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1521) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
            cute.memref.store(%1521, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1521) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1521 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1521) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1521) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1521 : !memref_rmem_f32_1
          }
          %iter_4444 = cute.get_iter(%1539) : !memref_rmem_f32_1
          %lay_4445 = cute.get_layout(%1539) : !memref_rmem_f32_1
          %1540 = cute.get_shape(%lay_4445) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4446, %e1_4447, %e2_4448, %e3_4449 = cute.get_leaves(%1540) : !cute.shape<"((2,2),1,8)">
          %1541 = cute.get_stride(%lay_4445) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4450, %e1_4451, %e2_4452, %e3_4453 = cute.get_leaves(%1541) : !cute.stride<"((1,2),0,4)">
          %iter_4454 = cute.get_iter(%1539) : !memref_rmem_f32_1
          %iter_4455 = cute.get_iter(%1539) : !memref_rmem_f32_1
          %coord_4456 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_4457 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4458 = cute.crd2idx(%coord_4456, %lay_4457) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_4459 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4460 = cute.add_offset(%iter_4459, %idx_4458) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4461 = cute.make_view(%tup_4460) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4462 = cute.get_iter(%view_4461) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4463, %e1_4464 = cute.get_leaves(%iter_4462) : !cute.int_tuple<"(?,?{div=2})">
          %1542 = cute.get_scalars(%e0_4463) : !cute.int_tuple<"?">
          %1543 = cute.get_scalars(%e1_4464) : !cute.int_tuple<"?{div=2}">
          %iter_4465 = cute.get_iter(%view_4461) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4466, %e1_4467 = cute.get_leaves(%iter_4465) : !cute.int_tuple<"(?,?{div=2})">
          %1544 = cute.get_scalars(%e0_4466) : !cute.int_tuple<"?">
          %1545 = cute.get_scalars(%e1_4467) : !cute.int_tuple<"?{div=2}">
          %iter_4468 = cute.get_iter(%view_4461) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4469, %e1_4470 = cute.get_leaves(%iter_4468) : !cute.int_tuple<"(?,?{div=2})">
          %1546 = cute.get_scalars(%e0_4469) : !cute.int_tuple<"?">
          %1547 = cute.get_scalars(%e1_4470) : !cute.int_tuple<"?{div=2}">
          %coord_4471 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_4472 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4473 = cute.crd2idx(%coord_4471, %lay_4472) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_4474 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4475 = cute.add_offset(%iter_4474, %idx_4473) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4476 = cute.make_view(%tup_4475) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4477 = cute.get_iter(%view_4476) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4478, %e1_4479 = cute.get_leaves(%iter_4477) : !cute.int_tuple<"(?,?{div=2})">
          %1548 = cute.get_scalars(%e0_4478) : !cute.int_tuple<"?">
          %1549 = cute.get_scalars(%e1_4479) : !cute.int_tuple<"?{div=2}">
          %iter_4480 = cute.get_iter(%view_4476) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4481, %e1_4482 = cute.get_leaves(%iter_4480) : !cute.int_tuple<"(?,?{div=2})">
          %1550 = cute.get_scalars(%e0_4481) : !cute.int_tuple<"?">
          %1551 = cute.get_scalars(%e1_4482) : !cute.int_tuple<"?{div=2}">
          %iter_4483 = cute.get_iter(%view_4476) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4484, %e1_4485 = cute.get_leaves(%iter_4483) : !cute.int_tuple<"(?,?{div=2})">
          %1552 = cute.get_scalars(%e0_4484) : !cute.int_tuple<"?">
          %1553 = cute.get_scalars(%e1_4485) : !cute.int_tuple<"?{div=2}">
          %coord_4486 = cute.make_coord(%e0_4469) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4487 = cute.make_coord(%e1_4485) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1554 = cute.elem_less(%coord_4486, %coord_4487) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4488 = cute.get_layout(%1539) : !memref_rmem_f32_1
          %1555 = cute.get_shape(%lay_4488) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4489, %e1_4490, %e2_4491, %e3_4492 = cute.get_leaves(%1555) : !cute.shape<"((2,2),1,8)">
          %1556 = cute.get_stride(%lay_4488) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4493, %e1_4494, %e2_4495, %e3_4496 = cute.get_leaves(%1556) : !cute.stride<"((1,2),0,4)">
          %1557 = scf.if %1554 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1539) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
            cute.memref.store(%1539, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1539) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1539 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1539) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1539) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1539 : !memref_rmem_f32_1
          }
          %iter_4497 = cute.get_iter(%1557) : !memref_rmem_f32_1
          %lay_4498 = cute.get_layout(%1557) : !memref_rmem_f32_1
          %1558 = cute.get_shape(%lay_4498) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4499, %e1_4500, %e2_4501, %e3_4502 = cute.get_leaves(%1558) : !cute.shape<"((2,2),1,8)">
          %1559 = cute.get_stride(%lay_4498) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4503, %e1_4504, %e2_4505, %e3_4506 = cute.get_leaves(%1559) : !cute.stride<"((1,2),0,4)">
          %iter_4507 = cute.get_iter(%1557) : !memref_rmem_f32_1
          %iter_4508 = cute.get_iter(%1557) : !memref_rmem_f32_1
          %coord_4509 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_4510 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4511 = cute.crd2idx(%coord_4509, %lay_4510) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_4512 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4513 = cute.add_offset(%iter_4512, %idx_4511) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4514 = cute.make_view(%tup_4513) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4515 = cute.get_iter(%view_4514) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4516, %e1_4517 = cute.get_leaves(%iter_4515) : !cute.int_tuple<"(?,?{div=2})">
          %1560 = cute.get_scalars(%e0_4516) : !cute.int_tuple<"?">
          %1561 = cute.get_scalars(%e1_4517) : !cute.int_tuple<"?{div=2}">
          %iter_4518 = cute.get_iter(%view_4514) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4519, %e1_4520 = cute.get_leaves(%iter_4518) : !cute.int_tuple<"(?,?{div=2})">
          %1562 = cute.get_scalars(%e0_4519) : !cute.int_tuple<"?">
          %1563 = cute.get_scalars(%e1_4520) : !cute.int_tuple<"?{div=2}">
          %iter_4521 = cute.get_iter(%view_4514) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4522, %e1_4523 = cute.get_leaves(%iter_4521) : !cute.int_tuple<"(?,?{div=2})">
          %1564 = cute.get_scalars(%e0_4522) : !cute.int_tuple<"?">
          %1565 = cute.get_scalars(%e1_4523) : !cute.int_tuple<"?{div=2}">
          %coord_4524 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_4525 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4526 = cute.crd2idx(%coord_4524, %lay_4525) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_4527 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4528 = cute.add_offset(%iter_4527, %idx_4526) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4529 = cute.make_view(%tup_4528) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4530 = cute.get_iter(%view_4529) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4531, %e1_4532 = cute.get_leaves(%iter_4530) : !cute.int_tuple<"(?,?{div=2})">
          %1566 = cute.get_scalars(%e0_4531) : !cute.int_tuple<"?">
          %1567 = cute.get_scalars(%e1_4532) : !cute.int_tuple<"?{div=2}">
          %iter_4533 = cute.get_iter(%view_4529) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4534, %e1_4535 = cute.get_leaves(%iter_4533) : !cute.int_tuple<"(?,?{div=2})">
          %1568 = cute.get_scalars(%e0_4534) : !cute.int_tuple<"?">
          %1569 = cute.get_scalars(%e1_4535) : !cute.int_tuple<"?{div=2}">
          %iter_4536 = cute.get_iter(%view_4529) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4537, %e1_4538 = cute.get_leaves(%iter_4536) : !cute.int_tuple<"(?,?{div=2})">
          %1570 = cute.get_scalars(%e0_4537) : !cute.int_tuple<"?">
          %1571 = cute.get_scalars(%e1_4538) : !cute.int_tuple<"?{div=2}">
          %coord_4539 = cute.make_coord(%e0_4522) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4540 = cute.make_coord(%e1_4538) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1572 = cute.elem_less(%coord_4539, %coord_4540) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4541 = cute.get_layout(%1557) : !memref_rmem_f32_1
          %1573 = cute.get_shape(%lay_4541) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4542, %e1_4543, %e2_4544, %e3_4545 = cute.get_leaves(%1573) : !cute.shape<"((2,2),1,8)">
          %1574 = cute.get_stride(%lay_4541) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4546, %e1_4547, %e2_4548, %e3_4549 = cute.get_leaves(%1574) : !cute.stride<"((1,2),0,4)">
          %1575 = scf.if %1572 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1557) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
            cute.memref.store(%1557, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1557) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1557 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1557) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1557) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1557 : !memref_rmem_f32_1
          }
          %iter_4550 = cute.get_iter(%1575) : !memref_rmem_f32_1
          %lay_4551 = cute.get_layout(%1575) : !memref_rmem_f32_1
          %1576 = cute.get_shape(%lay_4551) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4552, %e1_4553, %e2_4554, %e3_4555 = cute.get_leaves(%1576) : !cute.shape<"((2,2),1,8)">
          %1577 = cute.get_stride(%lay_4551) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4556, %e1_4557, %e2_4558, %e3_4559 = cute.get_leaves(%1577) : !cute.stride<"((1,2),0,4)">
          %iter_4560 = cute.get_iter(%1575) : !memref_rmem_f32_1
          %iter_4561 = cute.get_iter(%1575) : !memref_rmem_f32_1
          %int_tuple_4562 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4563 = cute.size(%int_tuple_4562) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4564 = cute.get_leaves(%sz_4563) : !cute.int_tuple<"1">
          %int_tuple_4565 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4566 = cute.size(%int_tuple_4565) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4567 = cute.get_leaves(%sz_4566) : !cute.int_tuple<"8">
          %coord_4568 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_4569 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4570 = cute.crd2idx(%coord_4568, %lay_4569) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_4571 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4572 = cute.add_offset(%iter_4571, %idx_4570) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4573 = cute.make_view(%tup_4572) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4574 = cute.get_iter(%view_4573) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4575, %e1_4576 = cute.get_leaves(%iter_4574) : !cute.int_tuple<"(?,?)">
          %1578 = cute.get_scalars(%e0_4575) : !cute.int_tuple<"?">
          %1579 = cute.get_scalars(%e1_4576) : !cute.int_tuple<"?">
          %iter_4577 = cute.get_iter(%view_4573) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4578, %e1_4579 = cute.get_leaves(%iter_4577) : !cute.int_tuple<"(?,?)">
          %1580 = cute.get_scalars(%e0_4578) : !cute.int_tuple<"?">
          %1581 = cute.get_scalars(%e1_4579) : !cute.int_tuple<"?">
          %iter_4580 = cute.get_iter(%view_4573) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4581, %e1_4582 = cute.get_leaves(%iter_4580) : !cute.int_tuple<"(?,?)">
          %1582 = cute.get_scalars(%e0_4581) : !cute.int_tuple<"?">
          %1583 = cute.get_scalars(%e1_4582) : !cute.int_tuple<"?">
          %coord_4583 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_4584 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4585 = cute.crd2idx(%coord_4583, %lay_4584) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_4586 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4587 = cute.add_offset(%iter_4586, %idx_4585) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4588 = cute.make_view(%tup_4587) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4589 = cute.get_iter(%view_4588) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4590, %e1_4591 = cute.get_leaves(%iter_4589) : !cute.int_tuple<"(?,?)">
          %1584 = cute.get_scalars(%e0_4590) : !cute.int_tuple<"?">
          %1585 = cute.get_scalars(%e1_4591) : !cute.int_tuple<"?">
          %iter_4592 = cute.get_iter(%view_4588) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4593, %e1_4594 = cute.get_leaves(%iter_4592) : !cute.int_tuple<"(?,?)">
          %1586 = cute.get_scalars(%e0_4593) : !cute.int_tuple<"?">
          %1587 = cute.get_scalars(%e1_4594) : !cute.int_tuple<"?">
          %iter_4595 = cute.get_iter(%view_4588) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4596, %e1_4597 = cute.get_leaves(%iter_4595) : !cute.int_tuple<"(?,?)">
          %1588 = cute.get_scalars(%e0_4596) : !cute.int_tuple<"?">
          %1589 = cute.get_scalars(%e1_4597) : !cute.int_tuple<"?">
          %coord_4598 = cute.make_coord(%e0_4581) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4599 = cute.make_coord(%e1_4597) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1590 = cute.elem_less(%coord_4598, %coord_4599) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4600 = cute.get_layout(%1575) : !memref_rmem_f32_1
          %1591 = cute.get_shape(%lay_4600) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4601, %e1_4602, %e2_4603, %e3_4604 = cute.get_leaves(%1591) : !cute.shape<"((2,2),1,8)">
          %1592 = cute.get_stride(%lay_4600) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4605, %e1_4606, %e2_4607, %e3_4608 = cute.get_leaves(%1592) : !cute.stride<"((1,2),0,4)">
          %1593 = scf.if %1590 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1575) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
            cute.memref.store(%1575, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1575) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1575 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1575) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1575) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1575 : !memref_rmem_f32_1
          }
          %iter_4609 = cute.get_iter(%1593) : !memref_rmem_f32_1
          %lay_4610 = cute.get_layout(%1593) : !memref_rmem_f32_1
          %1594 = cute.get_shape(%lay_4610) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4611, %e1_4612, %e2_4613, %e3_4614 = cute.get_leaves(%1594) : !cute.shape<"((2,2),1,8)">
          %1595 = cute.get_stride(%lay_4610) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4615, %e1_4616, %e2_4617, %e3_4618 = cute.get_leaves(%1595) : !cute.stride<"((1,2),0,4)">
          %iter_4619 = cute.get_iter(%1593) : !memref_rmem_f32_1
          %iter_4620 = cute.get_iter(%1593) : !memref_rmem_f32_1
          %coord_4621 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_4622 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4623 = cute.crd2idx(%coord_4621, %lay_4622) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_4624 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4625 = cute.add_offset(%iter_4624, %idx_4623) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4626 = cute.make_view(%tup_4625) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4627 = cute.get_iter(%view_4626) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4628, %e1_4629 = cute.get_leaves(%iter_4627) : !cute.int_tuple<"(?,?)">
          %1596 = cute.get_scalars(%e0_4628) : !cute.int_tuple<"?">
          %1597 = cute.get_scalars(%e1_4629) : !cute.int_tuple<"?">
          %iter_4630 = cute.get_iter(%view_4626) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4631, %e1_4632 = cute.get_leaves(%iter_4630) : !cute.int_tuple<"(?,?)">
          %1598 = cute.get_scalars(%e0_4631) : !cute.int_tuple<"?">
          %1599 = cute.get_scalars(%e1_4632) : !cute.int_tuple<"?">
          %iter_4633 = cute.get_iter(%view_4626) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4634, %e1_4635 = cute.get_leaves(%iter_4633) : !cute.int_tuple<"(?,?)">
          %1600 = cute.get_scalars(%e0_4634) : !cute.int_tuple<"?">
          %1601 = cute.get_scalars(%e1_4635) : !cute.int_tuple<"?">
          %coord_4636 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_4637 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4638 = cute.crd2idx(%coord_4636, %lay_4637) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_4639 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4640 = cute.add_offset(%iter_4639, %idx_4638) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4641 = cute.make_view(%tup_4640) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4642 = cute.get_iter(%view_4641) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4643, %e1_4644 = cute.get_leaves(%iter_4642) : !cute.int_tuple<"(?,?)">
          %1602 = cute.get_scalars(%e0_4643) : !cute.int_tuple<"?">
          %1603 = cute.get_scalars(%e1_4644) : !cute.int_tuple<"?">
          %iter_4645 = cute.get_iter(%view_4641) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4646, %e1_4647 = cute.get_leaves(%iter_4645) : !cute.int_tuple<"(?,?)">
          %1604 = cute.get_scalars(%e0_4646) : !cute.int_tuple<"?">
          %1605 = cute.get_scalars(%e1_4647) : !cute.int_tuple<"?">
          %iter_4648 = cute.get_iter(%view_4641) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4649, %e1_4650 = cute.get_leaves(%iter_4648) : !cute.int_tuple<"(?,?)">
          %1606 = cute.get_scalars(%e0_4649) : !cute.int_tuple<"?">
          %1607 = cute.get_scalars(%e1_4650) : !cute.int_tuple<"?">
          %coord_4651 = cute.make_coord(%e0_4634) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4652 = cute.make_coord(%e1_4650) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1608 = cute.elem_less(%coord_4651, %coord_4652) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4653 = cute.get_layout(%1593) : !memref_rmem_f32_1
          %1609 = cute.get_shape(%lay_4653) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4654, %e1_4655, %e2_4656, %e3_4657 = cute.get_leaves(%1609) : !cute.shape<"((2,2),1,8)">
          %1610 = cute.get_stride(%lay_4653) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4658, %e1_4659, %e2_4660, %e3_4661 = cute.get_leaves(%1610) : !cute.stride<"((1,2),0,4)">
          %1611 = scf.if %1608 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1593) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
            cute.memref.store(%1593, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1593) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1593 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1593) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1593) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1593 : !memref_rmem_f32_1
          }
          %iter_4662 = cute.get_iter(%1611) : !memref_rmem_f32_1
          %lay_4663 = cute.get_layout(%1611) : !memref_rmem_f32_1
          %1612 = cute.get_shape(%lay_4663) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4664, %e1_4665, %e2_4666, %e3_4667 = cute.get_leaves(%1612) : !cute.shape<"((2,2),1,8)">
          %1613 = cute.get_stride(%lay_4663) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4668, %e1_4669, %e2_4670, %e3_4671 = cute.get_leaves(%1613) : !cute.stride<"((1,2),0,4)">
          %iter_4672 = cute.get_iter(%1611) : !memref_rmem_f32_1
          %iter_4673 = cute.get_iter(%1611) : !memref_rmem_f32_1
          %coord_4674 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_4675 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4676 = cute.crd2idx(%coord_4674, %lay_4675) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_4677 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4678 = cute.add_offset(%iter_4677, %idx_4676) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4679 = cute.make_view(%tup_4678) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4680 = cute.get_iter(%view_4679) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4681, %e1_4682 = cute.get_leaves(%iter_4680) : !cute.int_tuple<"(?,?)">
          %1614 = cute.get_scalars(%e0_4681) : !cute.int_tuple<"?">
          %1615 = cute.get_scalars(%e1_4682) : !cute.int_tuple<"?">
          %iter_4683 = cute.get_iter(%view_4679) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4684, %e1_4685 = cute.get_leaves(%iter_4683) : !cute.int_tuple<"(?,?)">
          %1616 = cute.get_scalars(%e0_4684) : !cute.int_tuple<"?">
          %1617 = cute.get_scalars(%e1_4685) : !cute.int_tuple<"?">
          %iter_4686 = cute.get_iter(%view_4679) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4687, %e1_4688 = cute.get_leaves(%iter_4686) : !cute.int_tuple<"(?,?)">
          %1618 = cute.get_scalars(%e0_4687) : !cute.int_tuple<"?">
          %1619 = cute.get_scalars(%e1_4688) : !cute.int_tuple<"?">
          %coord_4689 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_4690 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4691 = cute.crd2idx(%coord_4689, %lay_4690) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_4692 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4693 = cute.add_offset(%iter_4692, %idx_4691) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4694 = cute.make_view(%tup_4693) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4695 = cute.get_iter(%view_4694) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4696, %e1_4697 = cute.get_leaves(%iter_4695) : !cute.int_tuple<"(?,?)">
          %1620 = cute.get_scalars(%e0_4696) : !cute.int_tuple<"?">
          %1621 = cute.get_scalars(%e1_4697) : !cute.int_tuple<"?">
          %iter_4698 = cute.get_iter(%view_4694) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4699, %e1_4700 = cute.get_leaves(%iter_4698) : !cute.int_tuple<"(?,?)">
          %1622 = cute.get_scalars(%e0_4699) : !cute.int_tuple<"?">
          %1623 = cute.get_scalars(%e1_4700) : !cute.int_tuple<"?">
          %iter_4701 = cute.get_iter(%view_4694) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4702, %e1_4703 = cute.get_leaves(%iter_4701) : !cute.int_tuple<"(?,?)">
          %1624 = cute.get_scalars(%e0_4702) : !cute.int_tuple<"?">
          %1625 = cute.get_scalars(%e1_4703) : !cute.int_tuple<"?">
          %coord_4704 = cute.make_coord(%e0_4687) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4705 = cute.make_coord(%e1_4703) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1626 = cute.elem_less(%coord_4704, %coord_4705) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4706 = cute.get_layout(%1611) : !memref_rmem_f32_1
          %1627 = cute.get_shape(%lay_4706) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4707, %e1_4708, %e2_4709, %e3_4710 = cute.get_leaves(%1627) : !cute.shape<"((2,2),1,8)">
          %1628 = cute.get_stride(%lay_4706) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4711, %e1_4712, %e2_4713, %e3_4714 = cute.get_leaves(%1628) : !cute.stride<"((1,2),0,4)">
          %1629 = scf.if %1626 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1611) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
            cute.memref.store(%1611, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1611) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1611 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1611) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1611) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1611 : !memref_rmem_f32_1
          }
          %iter_4715 = cute.get_iter(%1629) : !memref_rmem_f32_1
          %lay_4716 = cute.get_layout(%1629) : !memref_rmem_f32_1
          %1630 = cute.get_shape(%lay_4716) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4717, %e1_4718, %e2_4719, %e3_4720 = cute.get_leaves(%1630) : !cute.shape<"((2,2),1,8)">
          %1631 = cute.get_stride(%lay_4716) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4721, %e1_4722, %e2_4723, %e3_4724 = cute.get_leaves(%1631) : !cute.stride<"((1,2),0,4)">
          %iter_4725 = cute.get_iter(%1629) : !memref_rmem_f32_1
          %iter_4726 = cute.get_iter(%1629) : !memref_rmem_f32_1
          %coord_4727 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_4728 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4729 = cute.crd2idx(%coord_4727, %lay_4728) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_4730 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4731 = cute.add_offset(%iter_4730, %idx_4729) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4732 = cute.make_view(%tup_4731) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4733 = cute.get_iter(%view_4732) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4734, %e1_4735 = cute.get_leaves(%iter_4733) : !cute.int_tuple<"(?,?)">
          %1632 = cute.get_scalars(%e0_4734) : !cute.int_tuple<"?">
          %1633 = cute.get_scalars(%e1_4735) : !cute.int_tuple<"?">
          %iter_4736 = cute.get_iter(%view_4732) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4737, %e1_4738 = cute.get_leaves(%iter_4736) : !cute.int_tuple<"(?,?)">
          %1634 = cute.get_scalars(%e0_4737) : !cute.int_tuple<"?">
          %1635 = cute.get_scalars(%e1_4738) : !cute.int_tuple<"?">
          %iter_4739 = cute.get_iter(%view_4732) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4740, %e1_4741 = cute.get_leaves(%iter_4739) : !cute.int_tuple<"(?,?)">
          %1636 = cute.get_scalars(%e0_4740) : !cute.int_tuple<"?">
          %1637 = cute.get_scalars(%e1_4741) : !cute.int_tuple<"?">
          %coord_4742 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_4743 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4744 = cute.crd2idx(%coord_4742, %lay_4743) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_4745 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4746 = cute.add_offset(%iter_4745, %idx_4744) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4747 = cute.make_view(%tup_4746) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4748 = cute.get_iter(%view_4747) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4749, %e1_4750 = cute.get_leaves(%iter_4748) : !cute.int_tuple<"(?,?)">
          %1638 = cute.get_scalars(%e0_4749) : !cute.int_tuple<"?">
          %1639 = cute.get_scalars(%e1_4750) : !cute.int_tuple<"?">
          %iter_4751 = cute.get_iter(%view_4747) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4752, %e1_4753 = cute.get_leaves(%iter_4751) : !cute.int_tuple<"(?,?)">
          %1640 = cute.get_scalars(%e0_4752) : !cute.int_tuple<"?">
          %1641 = cute.get_scalars(%e1_4753) : !cute.int_tuple<"?">
          %iter_4754 = cute.get_iter(%view_4747) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4755, %e1_4756 = cute.get_leaves(%iter_4754) : !cute.int_tuple<"(?,?)">
          %1642 = cute.get_scalars(%e0_4755) : !cute.int_tuple<"?">
          %1643 = cute.get_scalars(%e1_4756) : !cute.int_tuple<"?">
          %coord_4757 = cute.make_coord(%e0_4740) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4758 = cute.make_coord(%e1_4756) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1644 = cute.elem_less(%coord_4757, %coord_4758) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4759 = cute.get_layout(%1629) : !memref_rmem_f32_1
          %1645 = cute.get_shape(%lay_4759) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4760, %e1_4761, %e2_4762, %e3_4763 = cute.get_leaves(%1645) : !cute.shape<"((2,2),1,8)">
          %1646 = cute.get_stride(%lay_4759) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4764, %e1_4765, %e2_4766, %e3_4767 = cute.get_leaves(%1646) : !cute.stride<"((1,2),0,4)">
          %1647 = scf.if %1644 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1629) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
            cute.memref.store(%1629, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1629) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1629 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1629) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1629) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1629 : !memref_rmem_f32_1
          }
          %iter_4768 = cute.get_iter(%1647) : !memref_rmem_f32_1
          %lay_4769 = cute.get_layout(%1647) : !memref_rmem_f32_1
          %1648 = cute.get_shape(%lay_4769) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4770, %e1_4771, %e2_4772, %e3_4773 = cute.get_leaves(%1648) : !cute.shape<"((2,2),1,8)">
          %1649 = cute.get_stride(%lay_4769) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4774, %e1_4775, %e2_4776, %e3_4777 = cute.get_leaves(%1649) : !cute.stride<"((1,2),0,4)">
          %iter_4778 = cute.get_iter(%1647) : !memref_rmem_f32_1
          %iter_4779 = cute.get_iter(%1647) : !memref_rmem_f32_1
          %coord_4780 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_4781 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4782 = cute.crd2idx(%coord_4780, %lay_4781) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_4783 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4784 = cute.add_offset(%iter_4783, %idx_4782) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4785 = cute.make_view(%tup_4784) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4786 = cute.get_iter(%view_4785) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4787, %e1_4788 = cute.get_leaves(%iter_4786) : !cute.int_tuple<"(?,?)">
          %1650 = cute.get_scalars(%e0_4787) : !cute.int_tuple<"?">
          %1651 = cute.get_scalars(%e1_4788) : !cute.int_tuple<"?">
          %iter_4789 = cute.get_iter(%view_4785) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4790, %e1_4791 = cute.get_leaves(%iter_4789) : !cute.int_tuple<"(?,?)">
          %1652 = cute.get_scalars(%e0_4790) : !cute.int_tuple<"?">
          %1653 = cute.get_scalars(%e1_4791) : !cute.int_tuple<"?">
          %iter_4792 = cute.get_iter(%view_4785) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4793, %e1_4794 = cute.get_leaves(%iter_4792) : !cute.int_tuple<"(?,?)">
          %1654 = cute.get_scalars(%e0_4793) : !cute.int_tuple<"?">
          %1655 = cute.get_scalars(%e1_4794) : !cute.int_tuple<"?">
          %coord_4795 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_4796 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4797 = cute.crd2idx(%coord_4795, %lay_4796) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_4798 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4799 = cute.add_offset(%iter_4798, %idx_4797) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4800 = cute.make_view(%tup_4799) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4801 = cute.get_iter(%view_4800) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4802, %e1_4803 = cute.get_leaves(%iter_4801) : !cute.int_tuple<"(?,?)">
          %1656 = cute.get_scalars(%e0_4802) : !cute.int_tuple<"?">
          %1657 = cute.get_scalars(%e1_4803) : !cute.int_tuple<"?">
          %iter_4804 = cute.get_iter(%view_4800) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4805, %e1_4806 = cute.get_leaves(%iter_4804) : !cute.int_tuple<"(?,?)">
          %1658 = cute.get_scalars(%e0_4805) : !cute.int_tuple<"?">
          %1659 = cute.get_scalars(%e1_4806) : !cute.int_tuple<"?">
          %iter_4807 = cute.get_iter(%view_4800) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4808, %e1_4809 = cute.get_leaves(%iter_4807) : !cute.int_tuple<"(?,?)">
          %1660 = cute.get_scalars(%e0_4808) : !cute.int_tuple<"?">
          %1661 = cute.get_scalars(%e1_4809) : !cute.int_tuple<"?">
          %coord_4810 = cute.make_coord(%e0_4793) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4811 = cute.make_coord(%e1_4809) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1662 = cute.elem_less(%coord_4810, %coord_4811) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4812 = cute.get_layout(%1647) : !memref_rmem_f32_1
          %1663 = cute.get_shape(%lay_4812) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4813, %e1_4814, %e2_4815, %e3_4816 = cute.get_leaves(%1663) : !cute.shape<"((2,2),1,8)">
          %1664 = cute.get_stride(%lay_4812) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4817, %e1_4818, %e2_4819, %e3_4820 = cute.get_leaves(%1664) : !cute.stride<"((1,2),0,4)">
          %1665 = scf.if %1662 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1647) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
            cute.memref.store(%1647, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1647) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1647 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1647) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1647) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1647 : !memref_rmem_f32_1
          }
          %iter_4821 = cute.get_iter(%1665) : !memref_rmem_f32_1
          %lay_4822 = cute.get_layout(%1665) : !memref_rmem_f32_1
          %1666 = cute.get_shape(%lay_4822) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4823, %e1_4824, %e2_4825, %e3_4826 = cute.get_leaves(%1666) : !cute.shape<"((2,2),1,8)">
          %1667 = cute.get_stride(%lay_4822) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4827, %e1_4828, %e2_4829, %e3_4830 = cute.get_leaves(%1667) : !cute.stride<"((1,2),0,4)">
          %iter_4831 = cute.get_iter(%1665) : !memref_rmem_f32_1
          %iter_4832 = cute.get_iter(%1665) : !memref_rmem_f32_1
          %coord_4833 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_4834 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4835 = cute.crd2idx(%coord_4833, %lay_4834) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_4836 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4837 = cute.add_offset(%iter_4836, %idx_4835) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4838 = cute.make_view(%tup_4837) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4839 = cute.get_iter(%view_4838) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4840, %e1_4841 = cute.get_leaves(%iter_4839) : !cute.int_tuple<"(?,?)">
          %1668 = cute.get_scalars(%e0_4840) : !cute.int_tuple<"?">
          %1669 = cute.get_scalars(%e1_4841) : !cute.int_tuple<"?">
          %iter_4842 = cute.get_iter(%view_4838) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4843, %e1_4844 = cute.get_leaves(%iter_4842) : !cute.int_tuple<"(?,?)">
          %1670 = cute.get_scalars(%e0_4843) : !cute.int_tuple<"?">
          %1671 = cute.get_scalars(%e1_4844) : !cute.int_tuple<"?">
          %iter_4845 = cute.get_iter(%view_4838) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4846, %e1_4847 = cute.get_leaves(%iter_4845) : !cute.int_tuple<"(?,?)">
          %1672 = cute.get_scalars(%e0_4846) : !cute.int_tuple<"?">
          %1673 = cute.get_scalars(%e1_4847) : !cute.int_tuple<"?">
          %coord_4848 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_4849 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4850 = cute.crd2idx(%coord_4848, %lay_4849) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_4851 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4852 = cute.add_offset(%iter_4851, %idx_4850) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4853 = cute.make_view(%tup_4852) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4854 = cute.get_iter(%view_4853) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4855, %e1_4856 = cute.get_leaves(%iter_4854) : !cute.int_tuple<"(?,?)">
          %1674 = cute.get_scalars(%e0_4855) : !cute.int_tuple<"?">
          %1675 = cute.get_scalars(%e1_4856) : !cute.int_tuple<"?">
          %iter_4857 = cute.get_iter(%view_4853) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4858, %e1_4859 = cute.get_leaves(%iter_4857) : !cute.int_tuple<"(?,?)">
          %1676 = cute.get_scalars(%e0_4858) : !cute.int_tuple<"?">
          %1677 = cute.get_scalars(%e1_4859) : !cute.int_tuple<"?">
          %iter_4860 = cute.get_iter(%view_4853) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4861, %e1_4862 = cute.get_leaves(%iter_4860) : !cute.int_tuple<"(?,?)">
          %1678 = cute.get_scalars(%e0_4861) : !cute.int_tuple<"?">
          %1679 = cute.get_scalars(%e1_4862) : !cute.int_tuple<"?">
          %coord_4863 = cute.make_coord(%e0_4846) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4864 = cute.make_coord(%e1_4862) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1680 = cute.elem_less(%coord_4863, %coord_4864) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4865 = cute.get_layout(%1665) : !memref_rmem_f32_1
          %1681 = cute.get_shape(%lay_4865) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4866, %e1_4867, %e2_4868, %e3_4869 = cute.get_leaves(%1681) : !cute.shape<"((2,2),1,8)">
          %1682 = cute.get_stride(%lay_4865) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4870, %e1_4871, %e2_4872, %e3_4873 = cute.get_leaves(%1682) : !cute.stride<"((1,2),0,4)">
          %1683 = scf.if %1680 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1665) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
            cute.memref.store(%1665, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1665) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1665 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1665) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1665) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1665 : !memref_rmem_f32_1
          }
          %iter_4874 = cute.get_iter(%1683) : !memref_rmem_f32_1
          %lay_4875 = cute.get_layout(%1683) : !memref_rmem_f32_1
          %1684 = cute.get_shape(%lay_4875) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4876, %e1_4877, %e2_4878, %e3_4879 = cute.get_leaves(%1684) : !cute.shape<"((2,2),1,8)">
          %1685 = cute.get_stride(%lay_4875) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4880, %e1_4881, %e2_4882, %e3_4883 = cute.get_leaves(%1685) : !cute.stride<"((1,2),0,4)">
          %iter_4884 = cute.get_iter(%1683) : !memref_rmem_f32_1
          %iter_4885 = cute.get_iter(%1683) : !memref_rmem_f32_1
          %coord_4886 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_4887 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4888 = cute.crd2idx(%coord_4886, %lay_4887) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_4889 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4890 = cute.add_offset(%iter_4889, %idx_4888) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4891 = cute.make_view(%tup_4890) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4892 = cute.get_iter(%view_4891) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4893, %e1_4894 = cute.get_leaves(%iter_4892) : !cute.int_tuple<"(?,?)">
          %1686 = cute.get_scalars(%e0_4893) : !cute.int_tuple<"?">
          %1687 = cute.get_scalars(%e1_4894) : !cute.int_tuple<"?">
          %iter_4895 = cute.get_iter(%view_4891) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4896, %e1_4897 = cute.get_leaves(%iter_4895) : !cute.int_tuple<"(?,?)">
          %1688 = cute.get_scalars(%e0_4896) : !cute.int_tuple<"?">
          %1689 = cute.get_scalars(%e1_4897) : !cute.int_tuple<"?">
          %iter_4898 = cute.get_iter(%view_4891) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4899, %e1_4900 = cute.get_leaves(%iter_4898) : !cute.int_tuple<"(?,?)">
          %1690 = cute.get_scalars(%e0_4899) : !cute.int_tuple<"?">
          %1691 = cute.get_scalars(%e1_4900) : !cute.int_tuple<"?">
          %coord_4901 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_4902 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4903 = cute.crd2idx(%coord_4901, %lay_4902) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_4904 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4905 = cute.add_offset(%iter_4904, %idx_4903) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4906 = cute.make_view(%tup_4905) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4907 = cute.get_iter(%view_4906) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4908, %e1_4909 = cute.get_leaves(%iter_4907) : !cute.int_tuple<"(?,?)">
          %1692 = cute.get_scalars(%e0_4908) : !cute.int_tuple<"?">
          %1693 = cute.get_scalars(%e1_4909) : !cute.int_tuple<"?">
          %iter_4910 = cute.get_iter(%view_4906) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4911, %e1_4912 = cute.get_leaves(%iter_4910) : !cute.int_tuple<"(?,?)">
          %1694 = cute.get_scalars(%e0_4911) : !cute.int_tuple<"?">
          %1695 = cute.get_scalars(%e1_4912) : !cute.int_tuple<"?">
          %iter_4913 = cute.get_iter(%view_4906) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4914, %e1_4915 = cute.get_leaves(%iter_4913) : !cute.int_tuple<"(?,?)">
          %1696 = cute.get_scalars(%e0_4914) : !cute.int_tuple<"?">
          %1697 = cute.get_scalars(%e1_4915) : !cute.int_tuple<"?">
          %coord_4916 = cute.make_coord(%e0_4899) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4917 = cute.make_coord(%e1_4915) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1698 = cute.elem_less(%coord_4916, %coord_4917) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4918 = cute.get_layout(%1683) : !memref_rmem_f32_1
          %1699 = cute.get_shape(%lay_4918) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4919, %e1_4920, %e2_4921, %e3_4922 = cute.get_leaves(%1699) : !cute.shape<"((2,2),1,8)">
          %1700 = cute.get_stride(%lay_4918) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4923, %e1_4924, %e2_4925, %e3_4926 = cute.get_leaves(%1700) : !cute.stride<"((1,2),0,4)">
          %1701 = scf.if %1698 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1683) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
            cute.memref.store(%1683, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1683) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1683 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1683) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1683) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1683 : !memref_rmem_f32_1
          }
          %iter_4927 = cute.get_iter(%1701) : !memref_rmem_f32_1
          %lay_4928 = cute.get_layout(%1701) : !memref_rmem_f32_1
          %1702 = cute.get_shape(%lay_4928) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4929, %e1_4930, %e2_4931, %e3_4932 = cute.get_leaves(%1702) : !cute.shape<"((2,2),1,8)">
          %1703 = cute.get_stride(%lay_4928) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4933, %e1_4934, %e2_4935, %e3_4936 = cute.get_leaves(%1703) : !cute.stride<"((1,2),0,4)">
          %iter_4937 = cute.get_iter(%1701) : !memref_rmem_f32_1
          %iter_4938 = cute.get_iter(%1701) : !memref_rmem_f32_1
          %coord_4939 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_4940 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4941 = cute.crd2idx(%coord_4939, %lay_4940) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_4942 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4943 = cute.add_offset(%iter_4942, %idx_4941) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4944 = cute.make_view(%tup_4943) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4945 = cute.get_iter(%view_4944) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4946, %e1_4947 = cute.get_leaves(%iter_4945) : !cute.int_tuple<"(?,?)">
          %1704 = cute.get_scalars(%e0_4946) : !cute.int_tuple<"?">
          %1705 = cute.get_scalars(%e1_4947) : !cute.int_tuple<"?">
          %iter_4948 = cute.get_iter(%view_4944) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4949, %e1_4950 = cute.get_leaves(%iter_4948) : !cute.int_tuple<"(?,?)">
          %1706 = cute.get_scalars(%e0_4949) : !cute.int_tuple<"?">
          %1707 = cute.get_scalars(%e1_4950) : !cute.int_tuple<"?">
          %iter_4951 = cute.get_iter(%view_4944) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4952, %e1_4953 = cute.get_leaves(%iter_4951) : !cute.int_tuple<"(?,?)">
          %1708 = cute.get_scalars(%e0_4952) : !cute.int_tuple<"?">
          %1709 = cute.get_scalars(%e1_4953) : !cute.int_tuple<"?">
          %coord_4954 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_4955 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4956 = cute.crd2idx(%coord_4954, %lay_4955) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_4957 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4958 = cute.add_offset(%iter_4957, %idx_4956) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4959 = cute.make_view(%tup_4958) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4960 = cute.get_iter(%view_4959) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4961, %e1_4962 = cute.get_leaves(%iter_4960) : !cute.int_tuple<"(?,?)">
          %1710 = cute.get_scalars(%e0_4961) : !cute.int_tuple<"?">
          %1711 = cute.get_scalars(%e1_4962) : !cute.int_tuple<"?">
          %iter_4963 = cute.get_iter(%view_4959) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4964, %e1_4965 = cute.get_leaves(%iter_4963) : !cute.int_tuple<"(?,?)">
          %1712 = cute.get_scalars(%e0_4964) : !cute.int_tuple<"?">
          %1713 = cute.get_scalars(%e1_4965) : !cute.int_tuple<"?">
          %iter_4966 = cute.get_iter(%view_4959) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4967, %e1_4968 = cute.get_leaves(%iter_4966) : !cute.int_tuple<"(?,?)">
          %1714 = cute.get_scalars(%e0_4967) : !cute.int_tuple<"?">
          %1715 = cute.get_scalars(%e1_4968) : !cute.int_tuple<"?">
          %coord_4969 = cute.make_coord(%e0_4952) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4970 = cute.make_coord(%e1_4968) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1716 = cute.elem_less(%coord_4969, %coord_4970) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4971 = cute.get_layout(%1701) : !memref_rmem_f32_1
          %1717 = cute.get_shape(%lay_4971) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4972, %e1_4973, %e2_4974, %e3_4975 = cute.get_leaves(%1717) : !cute.shape<"((2,2),1,8)">
          %1718 = cute.get_stride(%lay_4971) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4976, %e1_4977, %e2_4978, %e3_4979 = cute.get_leaves(%1718) : !cute.stride<"((1,2),0,4)">
          %1719 = scf.if %1716 -> (!memref_rmem_f32_1) {
            %iter_5049 = cute.get_iter(%1701) : !memref_rmem_f32_1
            %cst_5050 = arith.constant 0.000000e+00 : f32
            %coord_5051 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
            cute.memref.store(%1701, %coord_5051, %cst_5050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
            %lay_5052 = cute.get_layout(%1701) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1701 : !memref_rmem_f32_1
          } else {
            %iter_5049 = cute.get_iter(%1701) : !memref_rmem_f32_1
            %lay_5050 = cute.get_layout(%1701) : !memref_rmem_f32_1
            %1747 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1747) : !cute.shape<"((2,2),1,8)">
            %1748 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1748) : !cute.stride<"((1,2),0,4)">
            scf.yield %1701 : !memref_rmem_f32_1
          }
          %iter_4980 = cute.get_iter(%1719) : !memref_rmem_f32_1
          %lay_4981 = cute.get_layout(%1719) : !memref_rmem_f32_1
          %1720 = cute.get_shape(%lay_4981) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4982, %e1_4983, %e2_4984, %e3_4985 = cute.get_leaves(%1720) : !cute.shape<"((2,2),1,8)">
          %1721 = cute.get_stride(%lay_4981) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4986, %e1_4987, %e2_4988, %e3_4989 = cute.get_leaves(%1721) : !cute.stride<"((1,2),0,4)">
          %iter_4990 = cute.get_iter(%1719) : !memref_rmem_f32_1
          %iter_4991 = cute.get_iter(%1719) : !memref_rmem_f32_1
          %lay_4992 = cute.get_layout(%1719) : !memref_rmem_f32_1
          %1722 = cute.get_shape(%lay_4992) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4993, %e1_4994, %e2_4995, %e3_4996 = cute.get_leaves(%1722) : !cute.shape<"((2,2),1,8)">
          %1723 = cute.get_stride(%lay_4992) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4997, %e1_4998, %e2_4999, %e3_5000 = cute.get_leaves(%1723) : !cute.stride<"((1,2),0,4)">
          %1724 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %1725 = cute.get_shape(%1724) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_5001, %e1_5002, %e2_5003, %e3_5004 = cute.get_leaves(%1725) : !cute.shape<"(32,4,1,1)">
          %1726 = cute.get_stride(%1724) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_5005, %e1_5006, %e2_5007, %e3_5008 = cute.get_leaves(%1726) : !cute.stride<"(1,32,0,0)">
          %1727 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_5009, %e1_5010, %e2_5011 = cute.get_leaves(%1727) : !cute.tile<"[64:1;16:1;16:1]">
          %1728 = cute.get_shape(%e0_5009) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_5012 = cute.get_leaves(%1728) : !cute.shape<"64">
          %1729 = cute.get_stride(%e0_5009) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_5013 = cute.get_leaves(%1729) : !cute.stride<"1">
          %1730 = cute.get_shape(%e1_5010) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5014 = cute.get_leaves(%1730) : !cute.shape<"16">
          %1731 = cute.get_stride(%e1_5010) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5015 = cute.get_leaves(%1731) : !cute.stride<"1">
          %1732 = cute.get_shape(%e2_5011) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5016 = cute.get_leaves(%1732) : !cute.shape<"16">
          %1733 = cute.get_stride(%e2_5011) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5017 = cute.get_leaves(%1733) : !cute.stride<"1">
          %1734 = cute.static : !cute.layout<"32:1">
          %1735 = cute.get_shape(%1734) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_5018 = cute.get_leaves(%1735) : !cute.shape<"32">
          %1736 = cute.get_stride(%1734) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_5019 = cute.get_leaves(%1736) : !cute.stride<"1">
          %1737 = cute.static : !cute.shape<"(16,8,16)">
          %e0_5020, %e1_5021, %e2_5022 = cute.get_leaves(%1737) : !cute.shape<"(16,8,16)">
          %1738 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %1739 = cute.get_shape(%1738) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_5023, %e1_5024, %e2_5025, %e3_5026, %e4_5027 = cute.get_leaves(%1739) : !cute.shape<"((4,8),(2,2,2))">
          %1740 = cute.get_stride(%1738) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_5028, %e1_5029, %e2_5030, %e3_5031, %e4_5032 = cute.get_leaves(%1740) : !cute.stride<"((32,1),(16,8,128))">
          %1741 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %1742 = cute.get_shape(%1741) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5033, %e1_5034, %e2_5035, %e3_5036 = cute.get_leaves(%1742) : !cute.shape<"((4,8),(2,2))">
          %1743 = cute.get_stride(%1741) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_5037, %e1_5038, %e2_5039, %e3_5040 = cute.get_leaves(%1743) : !cute.stride<"((16,1),(8,64))">
          %1744 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %1745 = cute.get_shape(%1744) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5041, %e1_5042, %e2_5043, %e3_5044 = cute.get_leaves(%1745) : !cute.shape<"((4,8),(2,2))">
          %1746 = cute.get_stride(%1744) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_5045, %e1_5046, %e2_5047, %e3_5048 = cute.get_leaves(%1746) : !cute.stride<"((32,1),(16,8))">
          scf.yield %1719, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        } else {
          %iter_3259 = cute.get_iter(%1006) : !memref_rmem_f32_1
          %lay_3260 = cute.get_layout(%1006) : !memref_rmem_f32_1
          %1143 = cute.get_shape(%lay_3260) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3261, %e1_3262, %e2_3263, %e3_3264 = cute.get_leaves(%1143) : !cute.shape<"((2,2),1,8)">
          %1144 = cute.get_stride(%lay_3260) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3265, %e1_3266, %e2_3267, %e3_3268 = cute.get_leaves(%1144) : !cute.stride<"((1,2),0,4)">
          %1145 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %1146 = cute.get_shape(%1145) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_3269, %e1_3270, %e2_3271, %e3_3272 = cute.get_leaves(%1146) : !cute.shape<"(32,4,1,1)">
          %1147 = cute.get_stride(%1145) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_3273, %e1_3274, %e2_3275, %e3_3276 = cute.get_leaves(%1147) : !cute.stride<"(1,32,0,0)">
          %1148 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_3277, %e1_3278, %e2_3279 = cute.get_leaves(%1148) : !cute.tile<"[64:1;16:1;16:1]">
          %1149 = cute.get_shape(%e0_3277) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_3280 = cute.get_leaves(%1149) : !cute.shape<"64">
          %1150 = cute.get_stride(%e0_3277) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_3281 = cute.get_leaves(%1150) : !cute.stride<"1">
          %1151 = cute.get_shape(%e1_3278) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_3282 = cute.get_leaves(%1151) : !cute.shape<"16">
          %1152 = cute.get_stride(%e1_3278) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_3283 = cute.get_leaves(%1152) : !cute.stride<"1">
          %1153 = cute.get_shape(%e2_3279) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_3284 = cute.get_leaves(%1153) : !cute.shape<"16">
          %1154 = cute.get_stride(%e2_3279) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_3285 = cute.get_leaves(%1154) : !cute.stride<"1">
          %1155 = cute.static : !cute.layout<"32:1">
          %1156 = cute.get_shape(%1155) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_3286 = cute.get_leaves(%1156) : !cute.shape<"32">
          %1157 = cute.get_stride(%1155) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_3287 = cute.get_leaves(%1157) : !cute.stride<"1">
          %1158 = cute.static : !cute.shape<"(16,8,16)">
          %e0_3288, %e1_3289, %e2_3290 = cute.get_leaves(%1158) : !cute.shape<"(16,8,16)">
          %1159 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %1160 = cute.get_shape(%1159) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_3291, %e1_3292, %e2_3293, %e3_3294, %e4_3295 = cute.get_leaves(%1160) : !cute.shape<"((4,8),(2,2,2))">
          %1161 = cute.get_stride(%1159) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_3296, %e1_3297, %e2_3298, %e3_3299, %e4_3300 = cute.get_leaves(%1161) : !cute.stride<"((32,1),(16,8,128))">
          %1162 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %1163 = cute.get_shape(%1162) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_3301, %e1_3302, %e2_3303, %e3_3304 = cute.get_leaves(%1163) : !cute.shape<"((4,8),(2,2))">
          %1164 = cute.get_stride(%1162) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_3305, %e1_3306, %e2_3307, %e3_3308 = cute.get_leaves(%1164) : !cute.stride<"((16,1),(8,64))">
          %1165 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %1166 = cute.get_shape(%1165) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_3309, %e1_3310, %e2_3311, %e3_3312 = cute.get_leaves(%1166) : !cute.shape<"((4,8),(2,2))">
          %1167 = cute.get_stride(%1165) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_3313, %e1_3314, %e2_3315, %e3_3316 = cute.get_leaves(%1167) : !cute.stride<"((32,1),(16,8))">
          scf.yield %1006, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        }
        %iter_2822 = cute.get_iter(%1051#0) : !memref_rmem_f32_1
        %lay_2823 = cute.get_layout(%1051#0) : !memref_rmem_f32_1
        %1052 = cute.get_shape(%lay_2823) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2824, %e1_2825, %e2_2826, %e3_2827 = cute.get_leaves(%1052) : !cute.shape<"((2,2),1,8)">
        %1053 = cute.get_stride(%lay_2823) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2828, %e1_2829, %e2_2830, %e3_2831 = cute.get_leaves(%1053) : !cute.stride<"((1,2),0,4)">
        %iter_2832 = cute.get_iter(%1051#0) : !memref_rmem_f32_1
        %iter_2833 = cute.get_iter(%1051#0) : !memref_rmem_f32_1
        %lay_2834 = cute.get_layout(%1051#0) : !memref_rmem_f32_1
        %1054 = cute.make_layout_like(%lay_2834) : !cute.layout<"((2,2),1,8):((1,2),0,4)"> to !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2835 = cute.memref.alloca(%1054) : !memref_rmem_bf16_6
        %iter_2836 = cute.get_iter(%rmem_2835) : !memref_rmem_bf16_6
        %iter_2837 = cute.get_iter(%rmem_2835) : !memref_rmem_bf16_6
        %lay_2838 = cute.get_layout(%1051#0) : !memref_rmem_f32_1
        %1055 = cute.get_shape(%lay_2838) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2839, %e1_2840, %e2_2841, %e3_2842 = cute.get_leaves(%1055) : !cute.shape<"((2,2),1,8)">
        %1056 = cute.memref.load_vec %1051#0, row_major : !memref_rmem_f32_1
        %1057 = arith.truncf %1056 : vector<32xf32> to vector<32xbf16>
        %lay_2843 = cute.get_layout(%rmem_2835) : !memref_rmem_bf16_6
        %1058 = cute.get_shape(%lay_2843) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2844, %e1_2845, %e2_2846, %e3_2847 = cute.get_leaves(%1058) : !cute.shape<"((2,2),1,8)">
        %int_tuple_2848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2849 = cute.size(%int_tuple_2848) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2850 = cute.get_leaves(%sz_2849) : !cute.int_tuple<"32">
        %int_tuple_2851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2852 = cute.size(%int_tuple_2851) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2853 = cute.get_leaves(%sz_2852) : !cute.int_tuple<"32">
        cute.memref.store_vec %1057, %rmem_2835, row_major : !memref_rmem_bf16_6
        %lay_2854 = cute.get_layout(%rmem_2835) : !memref_rmem_bf16_6
        %tile_2855 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_2856 = cute.make_layout() : !cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">
        %1059 = cute.get_shape(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2857, %e1_2858, %e2_2859, %e3_2860, %e4_2861 = cute.get_leaves(%1059) : !cute.shape<"((2,2),1,(2,4))">
        %1060 = cute.get_shape(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2862, %e1_2863, %e2_2864, %e3_2865, %e4_2866 = cute.get_leaves(%1060) : !cute.shape<"((2,2),1,(2,4))">
        %1061 = cute.get_shape(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2867, %e1_2868, %e2_2869, %e3_2870, %e4_2871 = cute.get_leaves(%1061) : !cute.shape<"((2,2),1,(2,4))">
        %1062 = cute.get_shape(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2872, %e1_2873, %e2_2874, %e3_2875, %e4_2876 = cute.get_leaves(%1062) : !cute.shape<"((2,2),1,(2,4))">
        %1063 = cute.get_stride(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2877, %e1_2878, %e2_2879, %e3_2880, %e4_2881 = cute.get_leaves(%1063) : !cute.stride<"((1,2),0,(4,8))">
        %1064 = cute.get_stride(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2882, %e1_2883, %e2_2884, %e3_2885, %e4_2886 = cute.get_leaves(%1064) : !cute.stride<"((1,2),0,(4,8))">
        %1065 = cute.get_stride(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2887, %e1_2888, %e2_2889, %e3_2890, %e4_2891 = cute.get_leaves(%1065) : !cute.stride<"((1,2),0,(4,8))">
        %1066 = cute.get_stride(%lay_2856) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2892, %e1_2893, %e2_2894, %e3_2895, %e4_2896 = cute.get_leaves(%1066) : !cute.stride<"((1,2),0,(4,8))">
        %shape_2897 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),1,4)">
        %stride_2898 = cute.make_stride() : () -> !cute.stride<"(((1,2),4),0,8)">
        %lay_2899 = cute.make_layout() : !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">
        %view_2900 = cute.make_view(%iter_2837, %lay_2899) : !memref_rmem_bf16_19
        %iter_2901 = cute.get_iter(%view_2900) : !memref_rmem_bf16_19
        %coord_2902 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2903 = cute.get_layout(%src_partitioned_480) : !memref_smem_bf16_10
        %slice_2904 = cute.slice(%lay_2903, %coord_2902) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
        %idx_2905 = cute.crd2idx(%coord_2902, %lay_2903) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_2906 = cute.get_iter(%src_partitioned_480) : !memref_smem_bf16_10
        %ptr_2907 = cute.add_offset(%iter_2906, %idx_2905) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2908 = cute.make_view(%ptr_2907, %slice_2904) : !memref_smem_bf16_21
        %iter_2909 = cute.get_iter(%view_2908) : !memref_smem_bf16_21
        %coord_2910 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2911 = cute.get_layout(%retiled_482) : !memref_rmem_bf16_5
        %idx_2912 = cute.crd2idx(%coord_2910, %lay_2911) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_2913 = cute.get_iter(%retiled_482) : !memref_rmem_bf16_5
        %ptr_2914 = cute.add_offset(%iter_2913, %idx_2912) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2915 = cute.make_view(%ptr_2914) : !memref_rmem_bf16_20
        %iter_2916 = cute.get_iter(%view_2915) : !memref_rmem_bf16_20
        %lay_2917 = cute.get_layout(%view_2908) : !memref_smem_bf16_21
        %1067 = cute.get_shape(%lay_2917) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_2918, %e1_2919, %e2_2920, %e3_2921, %e4_2922 = cute.get_leaves(%1067) : !cute.shape<"((8,1),((2,2),2))">
        %lay_2923 = cute.get_layout(%view_2915) : !memref_rmem_bf16_20
        %1068 = cute.get_shape(%lay_2923) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_2924, %e1_2925, %e2_2926, %e3_2927 = cute.get_leaves(%1068) : !cute.shape<"((8,1),(4,2))">
        %lay_2928 = cute.get_layout(%view_2908) : !memref_smem_bf16_21
        %shape_2929 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2930 = cute.make_layout() : !cute.layout<"1:0">
        %append_2931 = cute.append_to_rank<2> (%lay_2928, %lay_2930) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_2932 = cute.make_view(%iter_2909, %append_2931) : !memref_smem_bf16_21
        %iter_2933 = cute.get_iter(%view_2932) : !memref_smem_bf16_21
        %lay_2934 = cute.get_layout(%view_2932) : !memref_smem_bf16_21
        %1069 = cute.get_shape(%lay_2934) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_2935, %e1_2936, %e2_2937, %e3_2938, %e4_2939 = cute.get_leaves(%1069) : !cute.shape<"((8,1),((2,2),2))">
        %iter_2940 = cute.get_iter(%view_2932) : !memref_smem_bf16_21
        %lay_2941 = cute.get_layout(%view_2932) : !memref_smem_bf16_21
        %1070:2 = cute.get_scalars(%lay_2941) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_2942 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_2943 = cute.assume(%1070#0) : (i32) -> !cute.i32<divby 16>
        %iv_2944 = cute.assume(%1070#1) : (i32) -> !cute.i32<divby 32>
        %stride_2945 = cute.make_stride(%iv_2943, %iv_2944) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_2946 = cute.make_layout(%shape_2942, %stride_2945) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_2947 = cute.make_view(%iter_2940, %lay_2946) : !memref_smem_bf16_22
        %iter_2948 = cute.get_iter(%view_2947) : !memref_smem_bf16_22
        %iter_2949 = cute.get_iter(%view_2947) : !memref_smem_bf16_22
        %lay_2950 = cute.get_layout(%view_2915) : !memref_rmem_bf16_20
        %shape_2951 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2952 = cute.make_layout() : !cute.layout<"1:0">
        %append_2953 = cute.append_to_rank<2> (%lay_2950, %lay_2952) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_2954 = cute.make_view(%iter_2916, %append_2953) : !memref_rmem_bf16_20
        %iter_2955 = cute.get_iter(%view_2954) : !memref_rmem_bf16_20
        %lay_2956 = cute.get_layout(%view_2954) : !memref_rmem_bf16_20
        %1071 = cute.get_shape(%lay_2956) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_2957, %e1_2958, %e2_2959, %e3_2960 = cute.get_leaves(%1071) : !cute.shape<"((8,1),(4,2))">
        %iter_2961 = cute.get_iter(%view_2954) : !memref_rmem_bf16_20
        %view_2962 = cute.make_view(%iter_2961) : !memref_rmem_bf16_21
        %iter_2963 = cute.get_iter(%view_2962) : !memref_rmem_bf16_21
        %iter_2964 = cute.get_iter(%view_2962) : !memref_rmem_bf16_21
        %lay_2965 = cute.get_layout(%view_2947) : !memref_smem_bf16_22
        %1072 = cute.get_shape(%lay_2965) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_2966, %e1_2967, %e2_2968, %e3_2969, %e4_2970 = cute.get_leaves(%1072) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_2971 = cute.get_layout(%view_2962) : !memref_rmem_bf16_21
        %1073 = cute.get_shape(%lay_2971) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_2972, %e1_2973, %e2_2974, %e3_2975 = cute.get_leaves(%1073) : !cute.shape<"((8,1),((4,2)))">
        %lay_2976 = cute.get_layout(%view_2947) : !memref_smem_bf16_22
        %sz_2977 = cute.size(%lay_2976) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_2978 = cute.get_leaves(%sz_2977) : !cute.int_tuple<"8">
        %lay_2979 = cute.get_layout(%view_2962) : !memref_rmem_bf16_21
        %sz_2980 = cute.size(%lay_2979) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_2981 = cute.get_leaves(%sz_2980) : !cute.int_tuple<"8">
        %1074 = cute.static : !cute.layout<"1:0">
        %iter_2982 = cute.get_iter(%view_2947) : !memref_smem_bf16_22
        %iter_2983 = cute.get_iter(%view_2962) : !memref_rmem_bf16_21
        %lay_2984 = cute.get_layout(%view_2947) : !memref_smem_bf16_22
        %lay_2985 = cute.get_layout(%view_2962) : !memref_rmem_bf16_21
        %append_2986 = cute.append_to_rank<2> (%lay_2984, %1074) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_2987 = cute.append_to_rank<2> (%lay_2985, %1074) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %1075:2 = cute.get_scalars(%append_2986) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_2988 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_2989 = cute.assume(%1075#0) : (i32) -> !cute.i32<divby 16>
        %iv_2990 = cute.assume(%1075#1) : (i32) -> !cute.i32<divby 32>
        %stride_2991 = cute.make_stride(%iv_2989, %iv_2990) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_2992 = cute.make_layout(%shape_2988, %stride_2991) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_2993 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_2994 = cute.size(%lay_2992) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %1076 = cute.get_scalars(%sz_2994) : !cute.int_tuple<"8">
        %c0_i32_2995 = arith.constant 0 : i32
        %c1_i32_2996 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2995 to %1076 step %c1_i32_2996  : i32 {
          %coord_3259 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3260 = cute.slice(%lay_2992, %coord_3259) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_3261 = cute.crd2idx(%coord_3259, %lay_2992) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_3262 = cute.add_offset(%iter_2982, %idx_3261) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3263 = cute.make_view(%ptr_3262, %slice_3260) : !memref_smem_bf16_14
          %slice_3264 = cute.slice(%lay_2993, %coord_3259) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_3265 = cute.crd2idx(%coord_3259, %lay_2993) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_3266 = cute.add_offset(%iter_2983, %idx_3265) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3267 = cute.make_view(%ptr_3266, %slice_3264) : !memref_rmem_bf16_22
          cute.copy_atom_call(%187, %view_3263, %view_3267) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2997 = cute.get_layout(%view_2900) : !memref_rmem_bf16_19
        %1077 = cute.get_shape(%lay_2997) : (!cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.shape<"(((2,2),2),1,4)">
        %e0_2998, %e1_2999, %e2_3000, %e3_3001, %e4_3002 = cute.get_leaves(%1077) : !cute.shape<"(((2,2),2),1,4)">
        %int_tuple_3003 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3004 = cute.size(%int_tuple_3003) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3005 = cute.get_leaves(%sz_3004) : !cute.int_tuple<"4">
        %int_tuple_3006 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3007 = cute.size(%int_tuple_3006) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3008 = cute.get_leaves(%sz_3007) : !cute.int_tuple<"4">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3260 = cute.get_layout(%src_partitioned_480) : !memref_smem_bf16_10
          %slice_3261 = cute.slice(%lay_3260, %coord_3259) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,1)">
          %idx_3262 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
          %iter_3263 = cute.get_iter(%src_partitioned_480) : !memref_smem_bf16_10
          %ptr_3264 = cute.add_offset(%iter_3263, %idx_3262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3265 = cute.make_view(%ptr_3264, %slice_3261) : !memref_smem_bf16_21
          %iter_3266 = cute.get_iter(%view_3265) : !memref_smem_bf16_21
          %coord_3267 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3268 = cute.get_layout(%retiled_482) : !memref_rmem_bf16_5
          %idx_3269 = cute.crd2idx(%coord_3267, %lay_3268) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
          %iter_3270 = cute.get_iter(%retiled_482) : !memref_rmem_bf16_5
          %ptr_3271 = cute.add_offset(%iter_3270, %idx_3269) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3272 = cute.make_view(%ptr_3271) : !memref_rmem_bf16_20
          %iter_3273 = cute.get_iter(%view_3272) : !memref_rmem_bf16_20
          %lay_3274 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %1143 = cute.get_shape(%lay_3274) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3275, %e1_3276, %e2_3277, %e3_3278, %e4_3279 = cute.get_leaves(%1143) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3280 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %1144 = cute.get_shape(%lay_3280) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3281, %e1_3282, %e2_3283, %e3_3284 = cute.get_leaves(%1144) : !cute.shape<"((8,1),(4,2))">
          %lay_3285 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %shape_3286 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3287 = cute.make_layout() : !cute.layout<"1:0">
          %append_3288 = cute.append_to_rank<2> (%lay_3285, %lay_3287) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3289 = cute.make_view(%iter_3266, %append_3288) : !memref_smem_bf16_21
          %iter_3290 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3291 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1145 = cute.get_shape(%lay_3291) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3292, %e1_3293, %e2_3294, %e3_3295, %e4_3296 = cute.get_leaves(%1145) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3297 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3298 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1146:2 = cute.get_scalars(%lay_3298) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3299 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3300 = cute.assume(%1146#0) : (i32) -> !cute.i32<divby 16>
          %iv_3301 = cute.assume(%1146#1) : (i32) -> !cute.i32<divby 32>
          %stride_3302 = cute.make_stride(%iv_3300, %iv_3301) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3303 = cute.make_layout(%shape_3299, %stride_3302) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3304 = cute.make_view(%iter_3297, %lay_3303) : !memref_smem_bf16_22
          %iter_3305 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3306 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %lay_3307 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %shape_3308 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3309 = cute.make_layout() : !cute.layout<"1:0">
          %append_3310 = cute.append_to_rank<2> (%lay_3307, %lay_3309) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3311 = cute.make_view(%iter_3273, %append_3310) : !memref_rmem_bf16_20
          %iter_3312 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %lay_3313 = cute.get_layout(%view_3311) : !memref_rmem_bf16_20
          %1147 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3314, %e1_3315, %e2_3316, %e3_3317 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(4,2))">
          %iter_3318 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %view_3319 = cute.make_view(%iter_3318) : !memref_rmem_bf16_21
          %iter_3320 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %iter_3321 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3322 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %1148 = cute.get_shape(%lay_3322) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3323, %e1_3324, %e2_3325, %e3_3326, %e4_3327 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3328 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %1149 = cute.get_shape(%lay_3328) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3329, %e1_3330, %e2_3331, %e3_3332 = cute.get_leaves(%1149) : !cute.shape<"((8,1),((4,2)))">
          %lay_3333 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %sz_3334 = cute.size(%lay_3333) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3335 = cute.get_leaves(%sz_3334) : !cute.int_tuple<"8">
          %lay_3336 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %sz_3337 = cute.size(%lay_3336) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3338 = cute.get_leaves(%sz_3337) : !cute.int_tuple<"8">
          %1150 = cute.static : !cute.layout<"1:0">
          %iter_3339 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3340 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3341 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %lay_3342 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %append_3343 = cute.append_to_rank<2> (%lay_3341, %1150) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3344 = cute.append_to_rank<2> (%lay_3342, %1150) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1151:2 = cute.get_scalars(%append_3343) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3345 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3346 = cute.assume(%1151#0) : (i32) -> !cute.i32<divby 16>
          %iv_3347 = cute.assume(%1151#1) : (i32) -> !cute.i32<divby 32>
          %stride_3348 = cute.make_stride(%iv_3346, %iv_3347) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3349 = cute.make_layout(%shape_3345, %stride_3348) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3350 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3351 = cute.size(%lay_3349) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1152 = cute.get_scalars(%sz_3351) : !cute.int_tuple<"8">
          %c0_i32_3352 = arith.constant 0 : i32
          %c1_i32_3353 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3352 to %1152 step %c1_i32_3353  : i32 {
            %coord_3354 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3355 = cute.slice(%lay_3349, %coord_3354) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3356 = cute.crd2idx(%coord_3354, %lay_3349) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3357 = cute.add_offset(%iter_3339, %idx_3356) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3358 = cute.make_view(%ptr_3357, %slice_3355) : !memref_smem_bf16_14
            %slice_3359 = cute.slice(%lay_3350, %coord_3354) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3360 = cute.crd2idx(%coord_3354, %lay_3350) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3361 = cute.add_offset(%iter_3340, %idx_3360) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3362 = cute.make_view(%ptr_3361, %slice_3359) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3358, %view_3362) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3009 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3010 = cute.get_layout(%view_2900) : !memref_rmem_bf16_19
        %idx_3011 = cute.crd2idx(%coord_3009, %lay_3010) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"0">
        %iter_3012 = cute.get_iter(%view_2900) : !memref_rmem_bf16_19
        %ptr_3013 = cute.add_offset(%iter_3012, %idx_3011) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3014 = cute.make_view(%ptr_3013) : !memref_rmem_bf16_23
        %iter_3015 = cute.get_iter(%view_3014) : !memref_rmem_bf16_23
        %coord_3016 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3017 = cute.get_layout(%frg_B_393) : !memref_rmem_bf16_2
        %idx_3018 = cute.crd2idx(%coord_3016, %lay_3017) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_3019 = cute.get_iter(%frg_B_393) : !memref_rmem_bf16_2
        %ptr_3020 = cute.add_offset(%iter_3019, %idx_3018) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3021 = cute.make_view(%ptr_3020) : !memref_rmem_bf16_24
        %iter_3022 = cute.get_iter(%view_3021) : !memref_rmem_bf16_24
        %lay_3023 = cute.get_layout(%view_3014) : !memref_rmem_bf16_23
        %1078 = cute.get_shape(%lay_3023) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3024, %e1_3025, %e2_3026, %e3_3027 = cute.get_leaves(%1078) : !cute.shape<"(((2,2),2),1)">
        %lay_3028 = cute.get_layout(%view_3021) : !memref_rmem_bf16_24
        %1079 = cute.get_shape(%lay_3028) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3029, %e1_3030, %e2_3031, %e3_3032 = cute.get_leaves(%1079) : !cute.shape<"((2,2),(8,2))">
        %lay_3033 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1080 = cute.get_shape(%lay_3033) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
        %e0_3034, %e1_3035, %e2_3036, %e3_3037 = cute.get_leaves(%1080) : !cute.shape<"((2,2),1,16)">
        %iter_3038 = cute.get_iter(%view_3014) : !memref_rmem_bf16_23
        %iter_3039 = cute.get_iter(%view_3021) : !memref_rmem_bf16_24
        %iter_3040 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3041 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3042 = cute.get_layout(%view_3014) : !memref_rmem_bf16_23
        %lay_3043 = cute.get_layout(%view_3021) : !memref_rmem_bf16_24
        %lay_3044 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3045 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1081 = cute.static : !cute.layout<"1:0">
        %append_3046 = cute.append_to_rank<3> (%lay_3042, %1081) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3047 = cute.append_to_rank<3> (%lay_3043, %1081) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3048 = cute.size(%append_3046) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3049 = cute.size(%append_3046) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3050 = cute.size(%append_3047) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1082 = cute.get_scalars(%sz_3048) : !cute.int_tuple<"1">
        %1083 = cute.get_scalars(%sz_3049) : !cute.int_tuple<"1">
        %1084 = cute.get_scalars(%sz_3050) : !cute.int_tuple<"16">
        %c0_i32_3051 = arith.constant 0 : i32
        %c1_i32_3052 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3051 to %1082 step %c1_i32_3052  : i32 {
          scf.for %arg9 = %c0_i32_3051 to %1083 step %c1_i32_3052  : i32 {
            scf.for %arg10 = %c0_i32_3051 to %1084 step %c1_i32_3052  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_3046, %coord_3259) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_3046) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_3038, %idx_3263) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_25
              %slice_3266 = cute.slice(%append_3047, %coord_3260) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_3047) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_3039, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_3044, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_3044) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_3040, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_3045, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_3045) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_3041, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_25, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3053 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3054 = cute.size(%int_tuple_3053) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3055 = cute.get_leaves(%sz_3054) : !cute.int_tuple<"4">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3260 = cute.get_layout(%src_partitioned_480) : !memref_smem_bf16_10
          %slice_3261 = cute.slice(%lay_3260, %coord_3259) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,2)">
          %idx_3262 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
          %iter_3263 = cute.get_iter(%src_partitioned_480) : !memref_smem_bf16_10
          %ptr_3264 = cute.add_offset(%iter_3263, %idx_3262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3265 = cute.make_view(%ptr_3264, %slice_3261) : !memref_smem_bf16_21
          %iter_3266 = cute.get_iter(%view_3265) : !memref_smem_bf16_21
          %coord_3267 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3268 = cute.get_layout(%retiled_482) : !memref_rmem_bf16_5
          %idx_3269 = cute.crd2idx(%coord_3267, %lay_3268) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
          %iter_3270 = cute.get_iter(%retiled_482) : !memref_rmem_bf16_5
          %ptr_3271 = cute.add_offset(%iter_3270, %idx_3269) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3272 = cute.make_view(%ptr_3271) : !memref_rmem_bf16_20
          %iter_3273 = cute.get_iter(%view_3272) : !memref_rmem_bf16_20
          %lay_3274 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %1143 = cute.get_shape(%lay_3274) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3275, %e1_3276, %e2_3277, %e3_3278, %e4_3279 = cute.get_leaves(%1143) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3280 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %1144 = cute.get_shape(%lay_3280) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3281, %e1_3282, %e2_3283, %e3_3284 = cute.get_leaves(%1144) : !cute.shape<"((8,1),(4,2))">
          %lay_3285 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %shape_3286 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3287 = cute.make_layout() : !cute.layout<"1:0">
          %append_3288 = cute.append_to_rank<2> (%lay_3285, %lay_3287) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3289 = cute.make_view(%iter_3266, %append_3288) : !memref_smem_bf16_21
          %iter_3290 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3291 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1145 = cute.get_shape(%lay_3291) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3292, %e1_3293, %e2_3294, %e3_3295, %e4_3296 = cute.get_leaves(%1145) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3297 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3298 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1146:2 = cute.get_scalars(%lay_3298) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3299 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3300 = cute.assume(%1146#0) : (i32) -> !cute.i32<divby 16>
          %iv_3301 = cute.assume(%1146#1) : (i32) -> !cute.i32<divby 32>
          %stride_3302 = cute.make_stride(%iv_3300, %iv_3301) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3303 = cute.make_layout(%shape_3299, %stride_3302) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3304 = cute.make_view(%iter_3297, %lay_3303) : !memref_smem_bf16_22
          %iter_3305 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3306 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %lay_3307 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %shape_3308 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3309 = cute.make_layout() : !cute.layout<"1:0">
          %append_3310 = cute.append_to_rank<2> (%lay_3307, %lay_3309) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3311 = cute.make_view(%iter_3273, %append_3310) : !memref_rmem_bf16_20
          %iter_3312 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %lay_3313 = cute.get_layout(%view_3311) : !memref_rmem_bf16_20
          %1147 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3314, %e1_3315, %e2_3316, %e3_3317 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(4,2))">
          %iter_3318 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %view_3319 = cute.make_view(%iter_3318) : !memref_rmem_bf16_21
          %iter_3320 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %iter_3321 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3322 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %1148 = cute.get_shape(%lay_3322) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3323, %e1_3324, %e2_3325, %e3_3326, %e4_3327 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3328 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %1149 = cute.get_shape(%lay_3328) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3329, %e1_3330, %e2_3331, %e3_3332 = cute.get_leaves(%1149) : !cute.shape<"((8,1),((4,2)))">
          %lay_3333 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %sz_3334 = cute.size(%lay_3333) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3335 = cute.get_leaves(%sz_3334) : !cute.int_tuple<"8">
          %lay_3336 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %sz_3337 = cute.size(%lay_3336) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3338 = cute.get_leaves(%sz_3337) : !cute.int_tuple<"8">
          %1150 = cute.static : !cute.layout<"1:0">
          %iter_3339 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3340 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3341 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %lay_3342 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %append_3343 = cute.append_to_rank<2> (%lay_3341, %1150) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3344 = cute.append_to_rank<2> (%lay_3342, %1150) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1151:2 = cute.get_scalars(%append_3343) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3345 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3346 = cute.assume(%1151#0) : (i32) -> !cute.i32<divby 16>
          %iv_3347 = cute.assume(%1151#1) : (i32) -> !cute.i32<divby 32>
          %stride_3348 = cute.make_stride(%iv_3346, %iv_3347) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3349 = cute.make_layout(%shape_3345, %stride_3348) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3350 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3351 = cute.size(%lay_3349) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1152 = cute.get_scalars(%sz_3351) : !cute.int_tuple<"8">
          %c0_i32_3352 = arith.constant 0 : i32
          %c1_i32_3353 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3352 to %1152 step %c1_i32_3353  : i32 {
            %coord_3354 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3355 = cute.slice(%lay_3349, %coord_3354) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3356 = cute.crd2idx(%coord_3354, %lay_3349) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3357 = cute.add_offset(%iter_3339, %idx_3356) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3358 = cute.make_view(%ptr_3357, %slice_3355) : !memref_smem_bf16_14
            %slice_3359 = cute.slice(%lay_3350, %coord_3354) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3360 = cute.crd2idx(%coord_3354, %lay_3350) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3361 = cute.add_offset(%iter_3340, %idx_3360) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3362 = cute.make_view(%ptr_3361, %slice_3359) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3358, %view_3362) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3056 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3057 = cute.get_layout(%view_2900) : !memref_rmem_bf16_19
        %idx_3058 = cute.crd2idx(%coord_3056, %lay_3057) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"8">
        %iter_3059 = cute.get_iter(%view_2900) : !memref_rmem_bf16_19
        %ptr_3060 = cute.add_offset(%iter_3059, %idx_3058) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3061 = cute.make_view(%ptr_3060) : !memref_rmem_bf16_26
        %iter_3062 = cute.get_iter(%view_3061) : !memref_rmem_bf16_26
        %coord_3063 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3064 = cute.get_layout(%frg_B_393) : !memref_rmem_bf16_2
        %idx_3065 = cute.crd2idx(%coord_3063, %lay_3064) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_3066 = cute.get_iter(%frg_B_393) : !memref_rmem_bf16_2
        %ptr_3067 = cute.add_offset(%iter_3066, %idx_3065) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3068 = cute.make_view(%ptr_3067) : !memref_rmem_bf16_24
        %iter_3069 = cute.get_iter(%view_3068) : !memref_rmem_bf16_24
        %lay_3070 = cute.get_layout(%view_3061) : !memref_rmem_bf16_26
        %1085 = cute.get_shape(%lay_3070) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3071, %e1_3072, %e2_3073, %e3_3074 = cute.get_leaves(%1085) : !cute.shape<"(((2,2),2),1)">
        %lay_3075 = cute.get_layout(%view_3068) : !memref_rmem_bf16_24
        %1086 = cute.get_shape(%lay_3075) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3076, %e1_3077, %e2_3078, %e3_3079 = cute.get_leaves(%1086) : !cute.shape<"((2,2),(8,2))">
        %iter_3080 = cute.get_iter(%view_3061) : !memref_rmem_bf16_26
        %iter_3081 = cute.get_iter(%view_3068) : !memref_rmem_bf16_24
        %iter_3082 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3083 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3084 = cute.get_layout(%view_3061) : !memref_rmem_bf16_26
        %lay_3085 = cute.get_layout(%view_3068) : !memref_rmem_bf16_24
        %lay_3086 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3087 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1087 = cute.static : !cute.layout<"1:0">
        %append_3088 = cute.append_to_rank<3> (%lay_3084, %1087) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3089 = cute.append_to_rank<3> (%lay_3085, %1087) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3090 = cute.size(%append_3088) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3091 = cute.size(%append_3088) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3092 = cute.size(%append_3089) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1088 = cute.get_scalars(%sz_3090) : !cute.int_tuple<"1">
        %1089 = cute.get_scalars(%sz_3091) : !cute.int_tuple<"1">
        %1090 = cute.get_scalars(%sz_3092) : !cute.int_tuple<"16">
        %c0_i32_3093 = arith.constant 0 : i32
        %c1_i32_3094 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3093 to %1088 step %c1_i32_3094  : i32 {
          scf.for %arg9 = %c0_i32_3093 to %1089 step %c1_i32_3094  : i32 {
            scf.for %arg10 = %c0_i32_3093 to %1090 step %c1_i32_3094  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_3088, %coord_3259) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_3088) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_3080, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_27
              %slice_3266 = cute.slice(%append_3089, %coord_3260) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_3089) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_3081, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_3086, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_3086) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_3082, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_3087, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_3087) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_3083, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_27, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3095 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3096 = cute.size(%int_tuple_3095) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3097 = cute.get_leaves(%sz_3096) : !cute.int_tuple<"4">
        scf.if %true {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3260 = cute.get_layout(%src_partitioned_480) : !memref_smem_bf16_10
          %slice_3261 = cute.slice(%lay_3260, %coord_3259) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,3)">
          %idx_3262 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
          %iter_3263 = cute.get_iter(%src_partitioned_480) : !memref_smem_bf16_10
          %ptr_3264 = cute.add_offset(%iter_3263, %idx_3262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3265 = cute.make_view(%ptr_3264, %slice_3261) : !memref_smem_bf16_21
          %iter_3266 = cute.get_iter(%view_3265) : !memref_smem_bf16_21
          %coord_3267 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3268 = cute.get_layout(%retiled_482) : !memref_rmem_bf16_5
          %idx_3269 = cute.crd2idx(%coord_3267, %lay_3268) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
          %iter_3270 = cute.get_iter(%retiled_482) : !memref_rmem_bf16_5
          %ptr_3271 = cute.add_offset(%iter_3270, %idx_3269) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3272 = cute.make_view(%ptr_3271) : !memref_rmem_bf16_20
          %iter_3273 = cute.get_iter(%view_3272) : !memref_rmem_bf16_20
          %lay_3274 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %1143 = cute.get_shape(%lay_3274) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3275, %e1_3276, %e2_3277, %e3_3278, %e4_3279 = cute.get_leaves(%1143) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3280 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %1144 = cute.get_shape(%lay_3280) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3281, %e1_3282, %e2_3283, %e3_3284 = cute.get_leaves(%1144) : !cute.shape<"((8,1),(4,2))">
          %lay_3285 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %shape_3286 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3287 = cute.make_layout() : !cute.layout<"1:0">
          %append_3288 = cute.append_to_rank<2> (%lay_3285, %lay_3287) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3289 = cute.make_view(%iter_3266, %append_3288) : !memref_smem_bf16_21
          %iter_3290 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3291 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1145 = cute.get_shape(%lay_3291) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3292, %e1_3293, %e2_3294, %e3_3295, %e4_3296 = cute.get_leaves(%1145) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3297 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3298 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1146:2 = cute.get_scalars(%lay_3298) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3299 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3300 = cute.assume(%1146#0) : (i32) -> !cute.i32<divby 16>
          %iv_3301 = cute.assume(%1146#1) : (i32) -> !cute.i32<divby 32>
          %stride_3302 = cute.make_stride(%iv_3300, %iv_3301) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3303 = cute.make_layout(%shape_3299, %stride_3302) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3304 = cute.make_view(%iter_3297, %lay_3303) : !memref_smem_bf16_22
          %iter_3305 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3306 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %lay_3307 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %shape_3308 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3309 = cute.make_layout() : !cute.layout<"1:0">
          %append_3310 = cute.append_to_rank<2> (%lay_3307, %lay_3309) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3311 = cute.make_view(%iter_3273, %append_3310) : !memref_rmem_bf16_20
          %iter_3312 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %lay_3313 = cute.get_layout(%view_3311) : !memref_rmem_bf16_20
          %1147 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3314, %e1_3315, %e2_3316, %e3_3317 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(4,2))">
          %iter_3318 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %view_3319 = cute.make_view(%iter_3318) : !memref_rmem_bf16_21
          %iter_3320 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %iter_3321 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3322 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %1148 = cute.get_shape(%lay_3322) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3323, %e1_3324, %e2_3325, %e3_3326, %e4_3327 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3328 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %1149 = cute.get_shape(%lay_3328) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3329, %e1_3330, %e2_3331, %e3_3332 = cute.get_leaves(%1149) : !cute.shape<"((8,1),((4,2)))">
          %lay_3333 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %sz_3334 = cute.size(%lay_3333) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3335 = cute.get_leaves(%sz_3334) : !cute.int_tuple<"8">
          %lay_3336 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %sz_3337 = cute.size(%lay_3336) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3338 = cute.get_leaves(%sz_3337) : !cute.int_tuple<"8">
          %1150 = cute.static : !cute.layout<"1:0">
          %iter_3339 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3340 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3341 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %lay_3342 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %append_3343 = cute.append_to_rank<2> (%lay_3341, %1150) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3344 = cute.append_to_rank<2> (%lay_3342, %1150) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1151:2 = cute.get_scalars(%append_3343) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3345 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3346 = cute.assume(%1151#0) : (i32) -> !cute.i32<divby 16>
          %iv_3347 = cute.assume(%1151#1) : (i32) -> !cute.i32<divby 32>
          %stride_3348 = cute.make_stride(%iv_3346, %iv_3347) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3349 = cute.make_layout(%shape_3345, %stride_3348) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3350 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3351 = cute.size(%lay_3349) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1152 = cute.get_scalars(%sz_3351) : !cute.int_tuple<"8">
          %c0_i32_3352 = arith.constant 0 : i32
          %c1_i32_3353 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3352 to %1152 step %c1_i32_3353  : i32 {
            %coord_3354 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3355 = cute.slice(%lay_3349, %coord_3354) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3356 = cute.crd2idx(%coord_3354, %lay_3349) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3357 = cute.add_offset(%iter_3339, %idx_3356) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3358 = cute.make_view(%ptr_3357, %slice_3355) : !memref_smem_bf16_14
            %slice_3359 = cute.slice(%lay_3350, %coord_3354) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3360 = cute.crd2idx(%coord_3354, %lay_3350) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3361 = cute.add_offset(%iter_3340, %idx_3360) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3362 = cute.make_view(%ptr_3361, %slice_3359) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3358, %view_3362) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3098 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3099 = cute.get_layout(%view_2900) : !memref_rmem_bf16_19
        %idx_3100 = cute.crd2idx(%coord_3098, %lay_3099) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"16">
        %iter_3101 = cute.get_iter(%view_2900) : !memref_rmem_bf16_19
        %ptr_3102 = cute.add_offset(%iter_3101, %idx_3100) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3103 = cute.make_view(%ptr_3102) : !memref_rmem_bf16_23
        %iter_3104 = cute.get_iter(%view_3103) : !memref_rmem_bf16_23
        %coord_3105 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3106 = cute.get_layout(%frg_B_393) : !memref_rmem_bf16_2
        %idx_3107 = cute.crd2idx(%coord_3105, %lay_3106) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_3108 = cute.get_iter(%frg_B_393) : !memref_rmem_bf16_2
        %ptr_3109 = cute.add_offset(%iter_3108, %idx_3107) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3110 = cute.make_view(%ptr_3109) : !memref_rmem_bf16_24
        %iter_3111 = cute.get_iter(%view_3110) : !memref_rmem_bf16_24
        %lay_3112 = cute.get_layout(%view_3103) : !memref_rmem_bf16_23
        %1091 = cute.get_shape(%lay_3112) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3113, %e1_3114, %e2_3115, %e3_3116 = cute.get_leaves(%1091) : !cute.shape<"(((2,2),2),1)">
        %lay_3117 = cute.get_layout(%view_3110) : !memref_rmem_bf16_24
        %1092 = cute.get_shape(%lay_3117) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3118, %e1_3119, %e2_3120, %e3_3121 = cute.get_leaves(%1092) : !cute.shape<"((2,2),(8,2))">
        %iter_3122 = cute.get_iter(%view_3103) : !memref_rmem_bf16_23
        %iter_3123 = cute.get_iter(%view_3110) : !memref_rmem_bf16_24
        %iter_3124 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3125 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3126 = cute.get_layout(%view_3103) : !memref_rmem_bf16_23
        %lay_3127 = cute.get_layout(%view_3110) : !memref_rmem_bf16_24
        %lay_3128 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3129 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1093 = cute.static : !cute.layout<"1:0">
        %append_3130 = cute.append_to_rank<3> (%lay_3126, %1093) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3131 = cute.append_to_rank<3> (%lay_3127, %1093) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3132 = cute.size(%append_3130) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3133 = cute.size(%append_3130) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3134 = cute.size(%append_3131) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1094 = cute.get_scalars(%sz_3132) : !cute.int_tuple<"1">
        %1095 = cute.get_scalars(%sz_3133) : !cute.int_tuple<"1">
        %1096 = cute.get_scalars(%sz_3134) : !cute.int_tuple<"16">
        %c0_i32_3135 = arith.constant 0 : i32
        %c1_i32_3136 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3135 to %1094 step %c1_i32_3136  : i32 {
          scf.for %arg9 = %c0_i32_3135 to %1095 step %c1_i32_3136  : i32 {
            scf.for %arg10 = %c0_i32_3135 to %1096 step %c1_i32_3136  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_3130, %coord_3259) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_3130) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_3122, %idx_3263) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_25
              %slice_3266 = cute.slice(%append_3131, %coord_3260) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_3131) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_3123, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_3128, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_3128) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_3124, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_3129, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_3129) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_3125, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_25, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3137 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3138 = cute.size(%int_tuple_3137) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3139 = cute.get_leaves(%sz_3138) : !cute.int_tuple<"4">
        scf.if %false {
          %coord_3259 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3260 = cute.get_layout(%src_partitioned_480) : !memref_smem_bf16_10
          %slice_3261 = cute.slice(%lay_3260, %coord_3259) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,4)">
          %idx_3262 = cute.crd2idx(%coord_3259, %lay_3260) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"4096">
          %iter_3263 = cute.get_iter(%src_partitioned_480) : !memref_smem_bf16_10
          %ptr_3264 = cute.add_offset(%iter_3263, %idx_3262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3265 = cute.make_view(%ptr_3264, %slice_3261) : !memref_smem_bf16_21
          %iter_3266 = cute.get_iter(%view_3265) : !memref_smem_bf16_21
          %coord_3267 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3268 = cute.get_layout(%retiled_482) : !memref_rmem_bf16_5
          %idx_3269 = cute.crd2idx(%coord_3267, %lay_3268) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"128">
          %iter_3270 = cute.get_iter(%retiled_482) : !memref_rmem_bf16_5
          %ptr_3271 = cute.add_offset(%iter_3270, %idx_3269) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3272 = cute.make_view(%ptr_3271) : !memref_rmem_bf16_20
          %iter_3273 = cute.get_iter(%view_3272) : !memref_rmem_bf16_20
          %lay_3274 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %1143 = cute.get_shape(%lay_3274) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3275, %e1_3276, %e2_3277, %e3_3278, %e4_3279 = cute.get_leaves(%1143) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3280 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %1144 = cute.get_shape(%lay_3280) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3281, %e1_3282, %e2_3283, %e3_3284 = cute.get_leaves(%1144) : !cute.shape<"((8,1),(4,2))">
          %lay_3285 = cute.get_layout(%view_3265) : !memref_smem_bf16_21
          %shape_3286 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3287 = cute.make_layout() : !cute.layout<"1:0">
          %append_3288 = cute.append_to_rank<2> (%lay_3285, %lay_3287) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3289 = cute.make_view(%iter_3266, %append_3288) : !memref_smem_bf16_21
          %iter_3290 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3291 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1145 = cute.get_shape(%lay_3291) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3292, %e1_3293, %e2_3294, %e3_3295, %e4_3296 = cute.get_leaves(%1145) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3297 = cute.get_iter(%view_3289) : !memref_smem_bf16_21
          %lay_3298 = cute.get_layout(%view_3289) : !memref_smem_bf16_21
          %1146:2 = cute.get_scalars(%lay_3298) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3299 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3300 = cute.assume(%1146#0) : (i32) -> !cute.i32<divby 16>
          %iv_3301 = cute.assume(%1146#1) : (i32) -> !cute.i32<divby 32>
          %stride_3302 = cute.make_stride(%iv_3300, %iv_3301) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3303 = cute.make_layout(%shape_3299, %stride_3302) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3304 = cute.make_view(%iter_3297, %lay_3303) : !memref_smem_bf16_22
          %iter_3305 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3306 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %lay_3307 = cute.get_layout(%view_3272) : !memref_rmem_bf16_20
          %shape_3308 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3309 = cute.make_layout() : !cute.layout<"1:0">
          %append_3310 = cute.append_to_rank<2> (%lay_3307, %lay_3309) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3311 = cute.make_view(%iter_3273, %append_3310) : !memref_rmem_bf16_20
          %iter_3312 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %lay_3313 = cute.get_layout(%view_3311) : !memref_rmem_bf16_20
          %1147 = cute.get_shape(%lay_3313) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3314, %e1_3315, %e2_3316, %e3_3317 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(4,2))">
          %iter_3318 = cute.get_iter(%view_3311) : !memref_rmem_bf16_20
          %view_3319 = cute.make_view(%iter_3318) : !memref_rmem_bf16_21
          %iter_3320 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %iter_3321 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3322 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %1148 = cute.get_shape(%lay_3322) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3323, %e1_3324, %e2_3325, %e3_3326, %e4_3327 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3328 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %1149 = cute.get_shape(%lay_3328) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3329, %e1_3330, %e2_3331, %e3_3332 = cute.get_leaves(%1149) : !cute.shape<"((8,1),((4,2)))">
          %lay_3333 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %sz_3334 = cute.size(%lay_3333) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3335 = cute.get_leaves(%sz_3334) : !cute.int_tuple<"8">
          %lay_3336 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %sz_3337 = cute.size(%lay_3336) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3338 = cute.get_leaves(%sz_3337) : !cute.int_tuple<"8">
          %1150 = cute.static : !cute.layout<"1:0">
          %iter_3339 = cute.get_iter(%view_3304) : !memref_smem_bf16_22
          %iter_3340 = cute.get_iter(%view_3319) : !memref_rmem_bf16_21
          %lay_3341 = cute.get_layout(%view_3304) : !memref_smem_bf16_22
          %lay_3342 = cute.get_layout(%view_3319) : !memref_rmem_bf16_21
          %append_3343 = cute.append_to_rank<2> (%lay_3341, %1150) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3344 = cute.append_to_rank<2> (%lay_3342, %1150) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1151:2 = cute.get_scalars(%append_3343) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3345 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3346 = cute.assume(%1151#0) : (i32) -> !cute.i32<divby 16>
          %iv_3347 = cute.assume(%1151#1) : (i32) -> !cute.i32<divby 32>
          %stride_3348 = cute.make_stride(%iv_3346, %iv_3347) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3349 = cute.make_layout(%shape_3345, %stride_3348) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3350 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3351 = cute.size(%lay_3349) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1152 = cute.get_scalars(%sz_3351) : !cute.int_tuple<"8">
          %c0_i32_3352 = arith.constant 0 : i32
          %c1_i32_3353 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3352 to %1152 step %c1_i32_3353  : i32 {
            %coord_3354 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3355 = cute.slice(%lay_3349, %coord_3354) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3356 = cute.crd2idx(%coord_3354, %lay_3349) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3357 = cute.add_offset(%iter_3339, %idx_3356) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3358 = cute.make_view(%ptr_3357, %slice_3355) : !memref_smem_bf16_14
            %slice_3359 = cute.slice(%lay_3350, %coord_3354) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3360 = cute.crd2idx(%coord_3354, %lay_3350) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3361 = cute.add_offset(%iter_3340, %idx_3360) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3362 = cute.make_view(%ptr_3361, %slice_3359) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3358, %view_3362) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3140 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3141 = cute.get_layout(%view_2900) : !memref_rmem_bf16_19
        %idx_3142 = cute.crd2idx(%coord_3140, %lay_3141) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"24">
        %iter_3143 = cute.get_iter(%view_2900) : !memref_rmem_bf16_19
        %ptr_3144 = cute.add_offset(%iter_3143, %idx_3142) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3145 = cute.make_view(%ptr_3144) : !memref_rmem_bf16_26
        %iter_3146 = cute.get_iter(%view_3145) : !memref_rmem_bf16_26
        %coord_3147 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3148 = cute.get_layout(%frg_B_393) : !memref_rmem_bf16_2
        %idx_3149 = cute.crd2idx(%coord_3147, %lay_3148) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_3150 = cute.get_iter(%frg_B_393) : !memref_rmem_bf16_2
        %ptr_3151 = cute.add_offset(%iter_3150, %idx_3149) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3152 = cute.make_view(%ptr_3151) : !memref_rmem_bf16_24
        %iter_3153 = cute.get_iter(%view_3152) : !memref_rmem_bf16_24
        %lay_3154 = cute.get_layout(%view_3145) : !memref_rmem_bf16_26
        %1097 = cute.get_shape(%lay_3154) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3155, %e1_3156, %e2_3157, %e3_3158 = cute.get_leaves(%1097) : !cute.shape<"(((2,2),2),1)">
        %lay_3159 = cute.get_layout(%view_3152) : !memref_rmem_bf16_24
        %1098 = cute.get_shape(%lay_3159) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3160, %e1_3161, %e2_3162, %e3_3163 = cute.get_leaves(%1098) : !cute.shape<"((2,2),(8,2))">
        %iter_3164 = cute.get_iter(%view_3145) : !memref_rmem_bf16_26
        %iter_3165 = cute.get_iter(%view_3152) : !memref_rmem_bf16_24
        %iter_3166 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3167 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3168 = cute.get_layout(%view_3145) : !memref_rmem_bf16_26
        %lay_3169 = cute.get_layout(%view_3152) : !memref_rmem_bf16_24
        %lay_3170 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3171 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1099 = cute.static : !cute.layout<"1:0">
        %append_3172 = cute.append_to_rank<3> (%lay_3168, %1099) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3173 = cute.append_to_rank<3> (%lay_3169, %1099) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3174 = cute.size(%append_3172) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3175 = cute.size(%append_3172) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3176 = cute.size(%append_3173) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1100 = cute.get_scalars(%sz_3174) : !cute.int_tuple<"1">
        %1101 = cute.get_scalars(%sz_3175) : !cute.int_tuple<"1">
        %1102 = cute.get_scalars(%sz_3176) : !cute.int_tuple<"16">
        %c0_i32_3177 = arith.constant 0 : i32
        %c1_i32_3178 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3177 to %1100 step %c1_i32_3178  : i32 {
          scf.for %arg9 = %c0_i32_3177 to %1101 step %c1_i32_3178  : i32 {
            scf.for %arg10 = %c0_i32_3177 to %1102 step %c1_i32_3178  : i32 {
              %coord_3259 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3260 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3261 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3262 = cute.slice(%append_3172, %coord_3259) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3263 = cute.crd2idx(%coord_3259, %append_3172) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3264 = cute.add_offset(%iter_3164, %idx_3263) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3265 = cute.make_view(%ptr_3264, %slice_3262) : !memref_rmem_bf16_27
              %slice_3266 = cute.slice(%append_3173, %coord_3260) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3267 = cute.crd2idx(%coord_3260, %append_3173) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3268 = cute.add_offset(%iter_3165, %idx_3267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3269 = cute.make_view(%ptr_3268, %slice_3266) : !memref_rmem_bf16_18
              %slice_3270 = cute.slice(%lay_3170, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3271 = cute.crd2idx(%coord_3261, %lay_3170) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3272 = cute.add_offset(%iter_3166, %idx_3271) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3273 = cute.make_view(%ptr_3272, %slice_3270) : !memref_rmem_f32_2
              %slice_3274 = cute.slice(%lay_3171, %coord_3261) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3275 = cute.crd2idx(%coord_3261, %lay_3171) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3276 = cute.add_offset(%iter_3167, %idx_3275) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3277 = cute.make_view(%ptr_3276, %slice_3274) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3277, %view_3265, %view_3269, %view_3273) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_27, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %1103 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1104 = cute.get_shape(%1103) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_3179, %e1_3180, %e2_3181, %e3_3182 = cute.get_leaves(%1104) : !cute.shape<"(32,4,1,1)">
        %1105 = cute.get_stride(%1103) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_3183, %e1_3184, %e2_3185, %e3_3186 = cute.get_leaves(%1105) : !cute.stride<"(1,32,0,0)">
        %1106 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_3187, %e1_3188, %e2_3189 = cute.get_leaves(%1106) : !cute.tile<"[64:1;16:1;16:1]">
        %1107 = cute.get_shape(%e0_3187) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3190 = cute.get_leaves(%1107) : !cute.shape<"64">
        %1108 = cute.get_stride(%e0_3187) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3191 = cute.get_leaves(%1108) : !cute.stride<"1">
        %1109 = cute.get_shape(%e1_3188) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3192 = cute.get_leaves(%1109) : !cute.shape<"16">
        %1110 = cute.get_stride(%e1_3188) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3193 = cute.get_leaves(%1110) : !cute.stride<"1">
        %1111 = cute.get_shape(%e2_3189) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3194 = cute.get_leaves(%1111) : !cute.shape<"16">
        %1112 = cute.get_stride(%e2_3189) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3195 = cute.get_leaves(%1112) : !cute.stride<"1">
        %1113 = cute.static : !cute.layout<"32:1">
        %1114 = cute.get_shape(%1113) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3196 = cute.get_leaves(%1114) : !cute.shape<"32">
        %1115 = cute.get_stride(%1113) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3197 = cute.get_leaves(%1115) : !cute.stride<"1">
        %1116 = cute.static : !cute.shape<"(16,8,16)">
        %e0_3198, %e1_3199, %e2_3200 = cute.get_leaves(%1116) : !cute.shape<"(16,8,16)">
        %1117 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1118 = cute.get_shape(%1117) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_3201, %e1_3202, %e2_3203, %e3_3204, %e4_3205 = cute.get_leaves(%1118) : !cute.shape<"((4,8),(2,2,2))">
        %1119 = cute.get_stride(%1117) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_3206, %e1_3207, %e2_3208, %e3_3209, %e4_3210 = cute.get_leaves(%1119) : !cute.stride<"((32,1),(16,8,128))">
        %1120 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1121 = cute.get_shape(%1120) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3211, %e1_3212, %e2_3213, %e3_3214 = cute.get_leaves(%1121) : !cute.shape<"((4,8),(2,2))">
        %1122 = cute.get_stride(%1120) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_3215, %e1_3216, %e2_3217, %e3_3218 = cute.get_leaves(%1122) : !cute.stride<"((16,1),(8,64))">
        %1123 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1124 = cute.get_shape(%1123) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3219, %e1_3220, %e2_3221, %e3_3222 = cute.get_leaves(%1124) : !cute.shape<"((4,8),(2,2))">
        %1125 = cute.get_stride(%1123) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_3223, %e1_3224, %e2_3225, %e3_3226 = cute.get_leaves(%1125) : !cute.stride<"((32,1),(16,8))">
        %1126 = cute.static : !cute.tile<"[64:1;16:1]">
        %e0_3227, %e1_3228 = cute.get_leaves(%1126) : !cute.tile<"[64:1;16:1]">
        %1127 = cute.get_shape(%e0_3227) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3229 = cute.get_leaves(%1127) : !cute.shape<"64">
        %1128 = cute.get_stride(%e0_3227) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3230 = cute.get_leaves(%1128) : !cute.stride<"1">
        %1129 = cute.get_shape(%e1_3228) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3231 = cute.get_leaves(%1129) : !cute.shape<"16">
        %1130 = cute.get_stride(%e1_3228) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3232 = cute.get_leaves(%1130) : !cute.stride<"1">
        %1131 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
        %1132 = cute.get_shape(%1131) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %e0_3233, %e1_3234, %e2_3235, %e3_3236, %e4_3237, %e5_3238, %e6_3239 = cute.get_leaves(%1132) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %1133 = cute.get_stride(%1131) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %e0_3240, %e1_3241, %e2_3242, %e3_3243, %e4_3244, %e5_3245, %e6_3246 = cute.get_leaves(%1133) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %1134 = cute.static : !cute.layout<"32:1">
        %1135 = cute.get_shape(%1134) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3247 = cute.get_leaves(%1135) : !cute.shape<"32">
        %1136 = cute.get_stride(%1134) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3248 = cute.get_leaves(%1136) : !cute.stride<"1">
        %1137 = cute.static : !cute.layout<"(32,8):(8,1)">
        %1138 = cute.get_shape(%1137) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
        %e0_3249, %e1_3250 = cute.get_leaves(%1138) : !cute.shape<"(32,8)">
        %1139 = cute.get_stride(%1137) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
        %e0_3251, %e1_3252 = cute.get_leaves(%1139) : !cute.stride<"(8,1)">
        %1140 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
        %1141 = cute.get_shape(%1140) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
        %e0_3253, %e1_3254, %e2_3255 = cute.get_leaves(%1141) : !cute.shape<"(32,(2,4))">
        %1142 = cute.get_stride(%1140) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
        %e0_3256, %e1_3257, %e2_3258 = cute.get_leaves(%1142) : !cute.stride<"(2,(1,64))">
        scf.yield %1051#1, %arg7 : !mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3
      }
      %lay_1572 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %rmem_1573 = cute.memref.alloca(%lay_1572) : !memref_rmem_bf16_28
      %iter_1574 = cute.get_iter(%rmem_1573) : !memref_rmem_bf16_28
      %iter_1575 = cute.get_iter(%rmem_1573) : !memref_rmem_bf16_28
      %lay_1576 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %757 = cute.get_shape(%lay_1576) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_1577, %e1_1578, %e2_1579, %e3_1580 = cute.get_leaves(%757) : !cute.shape<"((2,2),1,16)">
      %758 = cute.memref.load_vec %rmem, row_major : !memref_rmem_f32_
      %759 = arith.truncf %758 : vector<64xf32> to vector<64xbf16>
      %lay_1581 = cute.get_layout(%rmem_1573) : !memref_rmem_bf16_28
      %760 = cute.get_shape(%lay_1581) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_1582, %e1_1583, %e2_1584, %e3_1585 = cute.get_leaves(%760) : !cute.shape<"((2,2),1,16)">
      %int_tuple_1586 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_1587 = cute.size(%int_tuple_1586) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_1588 = cute.get_leaves(%sz_1587) : !cute.int_tuple<"64">
      %int_tuple_1589 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_1590 = cute.size(%int_tuple_1589) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_1591 = cute.get_leaves(%sz_1590) : !cute.int_tuple<"64">
      cute.memref.store_vec %759, %rmem_1573, row_major : !memref_rmem_bf16_28
      %761 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %iter_1592 = cute.recast_iter(%iter_346) : !cute.ptr<bf16, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>, S<3,4,3>>
      %762 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %view_1593 = cute.make_view(%iter_1592, %762) : !memref_smem_bf16_23
      %iter_1594 = cute.get_iter(%view_1593) : !memref_smem_bf16_23
      %atom_1595 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %763 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %764 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_1596, %e1_1597, %e2_1598 = cute.get_leaves(%764) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_1599 = cute.size(%e0_1596) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_1600 = cute.get_leaves(%sz_1599) : !cute.int_tuple<"64">
      %765 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_1601, %e1_1602, %e2_1603 = cute.get_leaves(%765) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_1604 = cute.size(%e1_1602) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_1605 = cute.get_leaves(%sz_1604) : !cute.int_tuple<"16">
      %tile_1606 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %766 = cute.make_tiled_copy(%atom_1595) : !copy_simt1
      %retiled_1607 = cute.tiled.copy.retile(%766, %rmem_1573) : (!copy_simt1, !memref_rmem_bf16_28) -> !memref_rmem_bf16_29
      %iter_1608 = cute.get_iter(%retiled_1607) : !memref_rmem_bf16_29
      %coord_1609 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_1610 = cute.tiled.copy.partition_D(%766, %view_1593, %coord_1609) : (!copy_simt1, !memref_smem_bf16_23, !cute.coord<"?">) -> !memref_smem_bf16_24
      %iter_1611 = cute.get_iter(%dst_partitioned_1610) : !memref_smem_bf16_24
      %lay_1612 = cute.get_layout(%retiled_1607) : !memref_rmem_bf16_29
      %767 = cute.get_shape(%lay_1612) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_1613, %e1_1614, %e2_1615, %e3_1616 = cute.get_leaves(%767) : !cute.shape<"((1,8),1,8)">
      %lay_1617 = cute.get_layout(%dst_partitioned_1610) : !memref_smem_bf16_24
      %768 = cute.get_shape(%lay_1617) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_1618, %e1_1619, %e2_1620, %e3_1621, %e4_1622, %e5_1623, %e6_1624 = cute.get_leaves(%768) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %lay_1625 = cute.get_layout(%retiled_1607) : !memref_rmem_bf16_29
      %shape_1626 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1627 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_1625, %lay_1627) : !cute.layout<"((1,8),1,8):((0,1),0,8)">, !cute.layout<"1:0">
      %view_1628 = cute.make_view(%iter_1608, %append) : !memref_rmem_bf16_29
      %iter_1629 = cute.get_iter(%view_1628) : !memref_rmem_bf16_29
      %lay_1630 = cute.get_layout(%view_1628) : !memref_rmem_bf16_29
      %769 = cute.get_shape(%lay_1630) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_1631, %e1_1632, %e2_1633, %e3_1634 = cute.get_leaves(%769) : !cute.shape<"((1,8),1,8)">
      %iter_1635 = cute.get_iter(%view_1628) : !memref_rmem_bf16_29
      %view_1636 = cute.make_view(%iter_1635) : !memref_rmem_bf16_30
      %iter_1637 = cute.get_iter(%view_1636) : !memref_rmem_bf16_30
      %iter_1638 = cute.get_iter(%view_1636) : !memref_rmem_bf16_30
      %lay_1639 = cute.get_layout(%dst_partitioned_1610) : !memref_smem_bf16_24
      %shape_1640 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1641 = cute.make_layout() : !cute.layout<"1:0">
      %append_1642 = cute.append_to_rank<2> (%lay_1639, %lay_1641) : !cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">, !cute.layout<"1:0">
      %view_1643 = cute.make_view(%iter_1611, %append_1642) : !memref_smem_bf16_24
      %iter_1644 = cute.get_iter(%view_1643) : !memref_smem_bf16_24
      %lay_1645 = cute.get_layout(%view_1643) : !memref_smem_bf16_24
      %770 = cute.get_shape(%lay_1645) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_1646, %e1_1647, %e2_1648, %e3_1649, %e4_1650, %e5_1651, %e6_1652 = cute.get_leaves(%770) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %iter_1653 = cute.get_iter(%view_1643) : !memref_smem_bf16_24
      %view_1654 = cute.make_view(%iter_1653) : !memref_smem_bf16_25
      %iter_1655 = cute.get_iter(%view_1654) : !memref_smem_bf16_25
      %iter_1656 = cute.get_iter(%view_1654) : !memref_smem_bf16_25
      %lay_1657 = cute.get_layout(%view_1636) : !memref_rmem_bf16_30
      %771 = cute.get_shape(%lay_1657) : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.shape<"((1,8),(1,8))">
      %e0_1658, %e1_1659, %e2_1660, %e3_1661 = cute.get_leaves(%771) : !cute.shape<"((1,8),(1,8))">
      %lay_1662 = cute.get_layout(%view_1654) : !memref_smem_bf16_25
      %772 = cute.get_shape(%lay_1662) : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %e0_1663, %e1_1664, %e2_1665, %e3_1666, %e4_1667, %e5_1668, %e6_1669 = cute.get_leaves(%772) : !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %lay_1670 = cute.get_layout(%view_1636) : !memref_rmem_bf16_30
      %sz_1671 = cute.size(%lay_1670) <{mode = [1]}> : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.int_tuple<"8">
      %e0_1672 = cute.get_leaves(%sz_1671) : !cute.int_tuple<"8">
      %lay_1673 = cute.get_layout(%view_1654) : !memref_smem_bf16_25
      %sz_1674 = cute.size(%lay_1673) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.int_tuple<"8">
      %e0_1675 = cute.get_leaves(%sz_1674) : !cute.int_tuple<"8">
      %773 = cute.static : !cute.layout<"1:0">
      %iter_1676 = cute.get_iter(%view_1636) : !memref_rmem_bf16_30
      %iter_1677 = cute.get_iter(%view_1654) : !memref_smem_bf16_25
      %lay_1678 = cute.get_layout(%view_1636) : !memref_rmem_bf16_30
      %lay_1679 = cute.get_layout(%view_1654) : !memref_smem_bf16_25
      %append_1680 = cute.append_to_rank<2> (%lay_1678, %773) : !cute.layout<"((1,8),(1,8)):((0,1),(0,8))">, !cute.layout<"1:0">
      %append_1681 = cute.append_to_rank<2> (%lay_1679, %773) : !cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">, !cute.layout<"1:0">
      %lay_1682 = cute.make_layout() : !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">
      %lay_1683 = cute.make_layout() : !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">
      %sz_1684 = cute.size(%lay_1682) <{mode = [1]}> : (!cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"8">
      %774 = cute.get_scalars(%sz_1684) : !cute.int_tuple<"8">
      %c0_i32_1685 = arith.constant 0 : i32
      %c1_i32_1686 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1685 to %774 step %c1_i32_1686  : i32 {
        %coord_2059 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_2060 = cute.slice(%lay_1682, %coord_2059) : !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">, !cute.coord<"(_,?)">
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_1682) : (!cute.coord<"(_,?)">, !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2062 = cute.add_offset(%iter_1676, %idx_2061) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2063 = cute.make_view(%ptr_2062, %slice_2060) : !memref_rmem_bf16_31
        %slice_2064 = cute.slice(%lay_1683, %coord_2059) : !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">, !cute.coord<"(_,?)">
        %idx_2065 = cute.crd2idx(%coord_2059, %lay_1683) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_2066 = cute.add_offset(%iter_1677, %idx_2065) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %view_2067 = cute.make_view(%ptr_2066, %slice_2064) : !memref_smem_bf16_26
        cute.copy_atom_call(%atom_1595, %view_2063, %view_2067) : (!cute_nvgpu.atom.universal_copy<bf16>, !memref_rmem_bf16_31, !memref_smem_bf16_26) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1687 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1688 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %slice_1689 = cute.slice(%lay_1688, %coord_1687) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_1690 = cute.crd2idx(%coord_1687, %lay_1688) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_1691 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_1692 = cute.add_offset(%iter_1691, %idx_1690) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_1693 = cute.make_view(%ptr_1692, %slice_1689) : !memref_gmem_bf16_1
      %iter_1694 = cute.get_iter(%view_1693) : !memref_gmem_bf16_1
      %tile_1695 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1696 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %775 = cute.get_scalars(%coord_1696) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1697 = cute.make_coord(%775) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1698 = cute.get_layout(%view_1693) : !memref_gmem_bf16_1
      %776:3 = cute.get_scalars(%lay_1698) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_1699 = arith.constant 64 : i32
      %777 = arith.ceildivsi %776#0, %c64_i32_1699 : i32
      %c64_i64_1700 = arith.constant 64 : i64
      %778 = arith.muli %776#2, %c64_i64_1700 : i64
      %c128_i32_1701 = arith.constant 128 : i32
      %779 = arith.ceildivsi %776#1, %c128_i32_1701 : i32
      %shape_1702 = cute.make_shape(%777, %779) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_1703 = cute.assume(%776#2) : (i64) -> !cute.i64<divby 8>
      %iv_1704 = cute.assume(%778) : (i64) -> !cute.i64<divby 512>
      %stride_1705 = cute.make_stride(%iv_1703, %iv_1704) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_1706 = cute.make_layout(%shape_1702, %stride_1705) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_1707 = cute.slice(%lay_1706, %coord_1697) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_1708 = cute.crd2idx(%coord_1697, %lay_1706) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_1709 = cute.get_iter(%view_1693) : !memref_gmem_bf16_1
      %ptr_1710 = cute.add_offset(%iter_1709, %idx_1708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_1711 = cute.make_view(%ptr_1710, %slice_1707) : !memref_gmem_bf16_2
      %iter_1712 = cute.get_iter(%view_1711) : !memref_gmem_bf16_2
      %coord_1713 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_1714 = cute.tiled.copy.partition_S(%5, %view_1593, %coord_1713) : (!copy_simt, !memref_smem_bf16_23, !cute.coord<"?">) -> !memref_smem_bf16_27
      %iter_1715 = cute.get_iter(%src_partitioned_1714) : !memref_smem_bf16_27
      %coord_1716 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_1717 = cute.tiled.copy.partition_D(%5, %view_1711, %coord_1716) : (!copy_simt, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_1718 = cute.get_iter(%dst_partitioned_1717) : !memref_gmem_bf16_5
      %lay_1719 = cute.get_layout(%dst_partitioned_1717) : !memref_gmem_bf16_5
      %780 = cute.make_layout_like(%lay_1719) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)"> to !cute.layout<"((8,1),4,2):((1,0),16,8)">
      %rmem_1720 = cute.memref.alloca(%780) : !memref_rmem_bf16_32
      %iter_1721 = cute.get_iter(%rmem_1720) : !memref_rmem_bf16_32
      %iter_1722 = cute.get_iter(%rmem_1720) : !memref_rmem_bf16_32
      %c1_i32_1723 = arith.constant 1 : i32
      %c128_i32_1724 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_1723 number_of_threads = %c128_i32_1724
      %lay_1725 = cute.get_layout(%src_partitioned_1714) : !memref_smem_bf16_27
      %781 = cute.get_shape(%lay_1725) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1726, %e1_1727, %e2_1728, %e3_1729 = cute.get_leaves(%781) : !cute.shape<"((8,1),4,2)">
      %lay_1730 = cute.get_layout(%rmem_1720) : !memref_rmem_bf16_32
      %782 = cute.get_shape(%lay_1730) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1731, %e1_1732, %e2_1733, %e3_1734 = cute.get_leaves(%782) : !cute.shape<"((8,1),4,2)">
      %lay_1735 = cute.get_layout(%src_partitioned_1714) : !memref_smem_bf16_27
      %shape_1736 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1737 = cute.make_layout() : !cute.layout<"1:0">
      %append_1738 = cute.append_to_rank<2> (%lay_1735, %lay_1737) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
      %view_1739 = cute.make_view(%iter_1715, %append_1738) : !memref_smem_bf16_27
      %iter_1740 = cute.get_iter(%view_1739) : !memref_smem_bf16_27
      %lay_1741 = cute.get_layout(%view_1739) : !memref_smem_bf16_27
      %783 = cute.get_shape(%lay_1741) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1742, %e1_1743, %e2_1744, %e3_1745 = cute.get_leaves(%783) : !cute.shape<"((8,1),4,2)">
      %iter_1746 = cute.get_iter(%view_1739) : !memref_smem_bf16_27
      %view_1747 = cute.make_view(%iter_1746) : !memref_smem_bf16_28
      %iter_1748 = cute.get_iter(%view_1747) : !memref_smem_bf16_28
      %iter_1749 = cute.get_iter(%view_1747) : !memref_smem_bf16_28
      %lay_1750 = cute.get_layout(%rmem_1720) : !memref_rmem_bf16_32
      %shape_1751 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1752 = cute.make_layout() : !cute.layout<"1:0">
      %append_1753 = cute.append_to_rank<2> (%lay_1750, %lay_1752) : !cute.layout<"((8,1),4,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_1754 = cute.make_view(%iter_1722, %append_1753) : !memref_rmem_bf16_32
      %iter_1755 = cute.get_iter(%view_1754) : !memref_rmem_bf16_32
      %lay_1756 = cute.get_layout(%view_1754) : !memref_rmem_bf16_32
      %784 = cute.get_shape(%lay_1756) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1757, %e1_1758, %e2_1759, %e3_1760 = cute.get_leaves(%784) : !cute.shape<"((8,1),4,2)">
      %iter_1761 = cute.get_iter(%view_1754) : !memref_rmem_bf16_32
      %view_1762 = cute.make_view(%iter_1761) : !memref_rmem_bf16_33
      %iter_1763 = cute.get_iter(%view_1762) : !memref_rmem_bf16_33
      %iter_1764 = cute.get_iter(%view_1762) : !memref_rmem_bf16_33
      %lay_1765 = cute.get_layout(%view_1747) : !memref_smem_bf16_28
      %785 = cute.get_shape(%lay_1765) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_1766, %e1_1767, %e2_1768, %e3_1769 = cute.get_leaves(%785) : !cute.shape<"((8,1),(4,2))">
      %lay_1770 = cute.get_layout(%view_1762) : !memref_rmem_bf16_33
      %786 = cute.get_shape(%lay_1770) : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_1771, %e1_1772, %e2_1773, %e3_1774 = cute.get_leaves(%786) : !cute.shape<"((8,1),(4,2))">
      %lay_1775 = cute.get_layout(%view_1747) : !memref_smem_bf16_28
      %sz_1776 = cute.size(%lay_1775) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
      %e0_1777 = cute.get_leaves(%sz_1776) : !cute.int_tuple<"8">
      %lay_1778 = cute.get_layout(%view_1762) : !memref_rmem_bf16_33
      %sz_1779 = cute.size(%lay_1778) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.int_tuple<"8">
      %e0_1780 = cute.get_leaves(%sz_1779) : !cute.int_tuple<"8">
      %787 = cute.static : !cute.layout<"1:0">
      %iter_1781 = cute.get_iter(%view_1747) : !memref_smem_bf16_28
      %iter_1782 = cute.get_iter(%view_1762) : !memref_rmem_bf16_33
      %lay_1783 = cute.get_layout(%view_1747) : !memref_smem_bf16_28
      %lay_1784 = cute.get_layout(%view_1762) : !memref_rmem_bf16_33
      %append_1785 = cute.append_to_rank<2> (%lay_1783, %787) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
      %append_1786 = cute.append_to_rank<2> (%lay_1784, %787) : !cute.layout<"((8,1),(4,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_1787 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
      %lay_1788 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">
      %sz_1789 = cute.size(%lay_1787) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"8">
      %788 = cute.get_scalars(%sz_1789) : !cute.int_tuple<"8">
      %c0_i32_1790 = arith.constant 0 : i32
      %c1_i32_1791 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1790 to %788 step %c1_i32_1791  : i32 {
        %coord_2059 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_2060 = cute.slice(%lay_1787, %coord_2059) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_1787) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_2062 = cute.add_offset(%iter_1781, %idx_2061) : (!cute.ptr<bf16, smem, align<16>, S<3,4,3>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
        %view_2063 = cute.make_view(%ptr_2062, %slice_2060) : !memref_smem_bf16_29
        %slice_2064 = cute.slice(%lay_1788, %coord_2059) : !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">, !cute.coord<"(_,?)">
        %idx_2065 = cute.crd2idx(%coord_2059, %lay_1788) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2066 = cute.add_offset(%iter_1782, %idx_2065) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2067 = cute.make_view(%ptr_2066, %slice_2064) : !memref_rmem_bf16_9
        cute.copy_atom_call(%5, %view_2063, %view_2067) : (!copy_simt, !memref_smem_bf16_29, !memref_rmem_bf16_9) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_1792 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %789 = cute.get_shape(%lay_1792) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1793, %e1_1794, %e2_1795, %e3_1796 = cute.get_leaves(%789) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1797 = cute.to_int_tuple(%e0_1793) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %790 = cute.get_scalars(%itup_1797) : !cute.int_tuple<"?">
      %itup_1798 = cute.to_int_tuple(%e1_1794) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %791 = cute.get_scalars(%itup_1798) : !cute.int_tuple<"?">
      %itup_1799 = cute.to_int_tuple(%e2_1795) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %792 = cute.get_scalars(%itup_1799) : !cute.int_tuple<"?">
      %itup_1800 = cute.to_int_tuple(%e3_1796) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %793 = cute.get_scalars(%itup_1800) : !cute.int_tuple<"?{div=8}">
      %shape_1801 = cute.make_shape(%itup_1797, %itup_1798, %itup_1799, %itup_1800) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %794 = cute.make_identity_tensor(%shape_1801) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1802 = cute.get_iter(%794) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1803, %e1_1804, %e2_1805, %e3_1806 = cute.get_leaves(%iter_1802) : !cute.int_tuple<"(0,0,0,0)">
      %coord_1807 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1808 = cute.get_layout(%794) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_1809 = cute.slice(%lay_1808, %coord_1807) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_1810 = cute.crd2idx(%coord_1807, %lay_1808) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_1811 = cute.get_iter(%794) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_1812 = cute.add_offset(%iter_1811, %idx_1810) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_1813 = cute.make_view(%tup_1812, %slice_1809) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_1814 = cute.get_iter(%view_1813) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1815, %e1_1816, %e2_1817, %e3_1818 = cute.get_leaves(%iter_1814) : !cute.int_tuple<"(?,0,?,0)">
      %795 = cute.get_scalars(%e0_1815) : !cute.int_tuple<"?">
      %796 = cute.get_scalars(%e2_1817) : !cute.int_tuple<"?">
      %tile_1819 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1820 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %797 = cute.get_scalars(%coord_1820) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1821 = cute.make_coord(%797) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1822 = cute.get_layout(%view_1813) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %798:2 = cute.get_scalars(%lay_1822) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_1823 = arith.constant 64 : i32
      %799 = arith.ceildivsi %798#0, %c64_i32_1823 : i32
      %c128_i32_1824 = arith.constant 128 : i32
      %800 = arith.ceildivsi %798#1, %c128_i32_1824 : i32
      %shape_1825 = cute.make_shape(%799, %800) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_1826 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_1827 = cute.make_layout(%shape_1825, %stride_1826) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_1828 = cute.crd2idx(%coord_1821, %lay_1827) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_1829 = cute.get_iter(%view_1813) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_1830 = cute.add_offset(%iter_1829, %idx_1828) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_1831 = cute.make_view(%tup_1830) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_1832 = cute.get_iter(%view_1831) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_1833, %e1_1834, %e2_1835, %e3_1836 = cute.get_leaves(%iter_1832) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %801 = cute.get_scalars(%e0_1833) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e1_1834) : !cute.int_tuple<"?{div=64}">
      %803 = cute.get_scalars(%e2_1835) : !cute.int_tuple<"?">
      %coord_1837 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_1838 = cute.tiled.copy.partition_D(%5, %view_1831, %coord_1837) : (!copy_simt, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1839 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1840, %e1_1841, %e2_1842, %e3_1843 = cute.get_leaves(%iter_1839) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %804 = cute.get_scalars(%e0_1840) : !cute.int_tuple<"?">
      %805 = cute.get_scalars(%e1_1841) : !cute.int_tuple<"?">
      %806 = cute.get_scalars(%e2_1842) : !cute.int_tuple<"?">
      %807 = cute.get_scalars(%e3_1843) : !cute.int_tuple<"?{div=8}">
      %lay_1844 = cute.get_layout(%dst_partitioned_1717) : !memref_gmem_bf16_5
      %808 = cute.get_shape(%lay_1844) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1845, %e1_1846, %e2_1847, %e3_1848 = cute.get_leaves(%808) : !cute.shape<"((8,1),4,2)">
      %shape_1849 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1850 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1851 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1852 = cute.memref.alloca(%lay_1851) : !memref_rmem_i8_
      %iter_1853 = cute.get_iter(%rmem_1852) : !memref_rmem_i8_
      %iter_1854 = cute.get_iter(%rmem_1852) : !memref_rmem_i8_
      %lay_1855 = cute.get_layout(%rmem_1852) : !memref_rmem_i8_
      %809 = cute.get_shape(%lay_1855) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1856, %e1_1857, %e2_1858 = cute.get_leaves(%809) : !cute.shape<"(1,4,2)">
      %int_tuple_1859 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_1860 = cute.size(%int_tuple_1859) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_1861 = cute.get_leaves(%sz_1860) : !cute.int_tuple<"2">
      %coord_1862 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1863 = cute.get_layout(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1864 = cute.crd2idx(%coord_1862, %lay_1863) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1865 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1866 = cute.add_offset(%iter_1865, %idx_1864) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1867 = cute.make_view(%tup_1866) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1868 = cute.get_iter(%view_1867) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1869, %e1_1870, %e2_1871, %e3_1872 = cute.get_leaves(%iter_1868) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %810 = cute.get_scalars(%e0_1869) : !cute.int_tuple<"?">
      %811 = cute.get_scalars(%e1_1870) : !cute.int_tuple<"?">
      %812 = cute.get_scalars(%e2_1871) : !cute.int_tuple<"?">
      %813 = cute.get_scalars(%e3_1872) : !cute.int_tuple<"?{div=8}">
      %iter_1873 = cute.get_iter(%view_1867) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1874, %e1_1875, %e2_1876, %e3_1877 = cute.get_leaves(%iter_1873) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %814 = cute.get_scalars(%e0_1874) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e1_1875) : !cute.int_tuple<"?">
      %816 = cute.get_scalars(%e2_1876) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e3_1877) : !cute.int_tuple<"?{div=8}">
      %iter_1878 = cute.get_iter(%view_1867) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1879, %e1_1880, %e2_1881, %e3_1882 = cute.get_leaves(%iter_1878) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %818 = cute.get_scalars(%e0_1879) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e1_1880) : !cute.int_tuple<"?">
      %820 = cute.get_scalars(%e2_1881) : !cute.int_tuple<"?">
      %821 = cute.get_scalars(%e3_1882) : !cute.int_tuple<"?{div=8}">
      %lay_1883 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %822 = cute.get_shape(%lay_1883) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1884, %e1_1885, %e2_1886, %e3_1887 = cute.get_leaves(%822) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1888 = cute.to_int_tuple(%e0_1884) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %823 = cute.get_scalars(%itup_1888) : !cute.int_tuple<"?">
      %itup_1889 = cute.to_int_tuple(%e1_1885) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %824 = cute.get_scalars(%itup_1889) : !cute.int_tuple<"?">
      %itup_1890 = cute.to_int_tuple(%e2_1886) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %825 = cute.get_scalars(%itup_1890) : !cute.int_tuple<"?">
      %itup_1891 = cute.to_int_tuple(%e3_1887) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %826 = cute.get_scalars(%itup_1891) : !cute.int_tuple<"?{div=8}">
      %coord_1892 = cute.make_coord(%e3_1882) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1893 = cute.make_coord(%itup_1891) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %827 = cute.elem_less(%coord_1892, %coord_1893) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %828 = arith.extui %827 : i1 to i8
      %coord_1894 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1852, %coord_1894, %828) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1895 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1896 = cute.get_layout(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1897 = cute.crd2idx(%coord_1895, %lay_1896) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1898 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1899 = cute.add_offset(%iter_1898, %idx_1897) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1900 = cute.make_view(%tup_1899) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1901 = cute.get_iter(%view_1900) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1902, %e1_1903, %e2_1904, %e3_1905 = cute.get_leaves(%iter_1901) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %829 = cute.get_scalars(%e0_1902) : !cute.int_tuple<"?">
      %830 = cute.get_scalars(%e1_1903) : !cute.int_tuple<"?">
      %831 = cute.get_scalars(%e2_1904) : !cute.int_tuple<"?">
      %832 = cute.get_scalars(%e3_1905) : !cute.int_tuple<"?{div=8}">
      %iter_1906 = cute.get_iter(%view_1900) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1907, %e1_1908, %e2_1909, %e3_1910 = cute.get_leaves(%iter_1906) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %833 = cute.get_scalars(%e0_1907) : !cute.int_tuple<"?">
      %834 = cute.get_scalars(%e1_1908) : !cute.int_tuple<"?">
      %835 = cute.get_scalars(%e2_1909) : !cute.int_tuple<"?">
      %836 = cute.get_scalars(%e3_1910) : !cute.int_tuple<"?{div=8}">
      %iter_1911 = cute.get_iter(%view_1900) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1912, %e1_1913, %e2_1914, %e3_1915 = cute.get_leaves(%iter_1911) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %837 = cute.get_scalars(%e0_1912) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e1_1913) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e2_1914) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e3_1915) : !cute.int_tuple<"?{div=8}">
      %lay_1916 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %841 = cute.get_shape(%lay_1916) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1917, %e1_1918, %e2_1919, %e3_1920 = cute.get_leaves(%841) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1921 = cute.to_int_tuple(%e0_1917) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %842 = cute.get_scalars(%itup_1921) : !cute.int_tuple<"?">
      %itup_1922 = cute.to_int_tuple(%e1_1918) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %843 = cute.get_scalars(%itup_1922) : !cute.int_tuple<"?">
      %itup_1923 = cute.to_int_tuple(%e2_1919) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %844 = cute.get_scalars(%itup_1923) : !cute.int_tuple<"?">
      %itup_1924 = cute.to_int_tuple(%e3_1920) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %845 = cute.get_scalars(%itup_1924) : !cute.int_tuple<"?{div=8}">
      %coord_1925 = cute.make_coord(%e3_1915) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1926 = cute.make_coord(%itup_1924) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %846 = cute.elem_less(%coord_1925, %coord_1926) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %847 = arith.extui %846 : i1 to i8
      %coord_1927 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1852, %coord_1927, %847) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_1928 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1929 = cute.size(%int_tuple_1928) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1930 = cute.get_leaves(%sz_1929) : !cute.int_tuple<"4">
      %coord_1931 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1932 = cute.get_layout(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1933 = cute.crd2idx(%coord_1931, %lay_1932) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1934 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1935 = cute.add_offset(%iter_1934, %idx_1933) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1936 = cute.make_view(%tup_1935) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1937 = cute.get_iter(%view_1936) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1938, %e1_1939, %e2_1940, %e3_1941 = cute.get_leaves(%iter_1937) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %848 = cute.get_scalars(%e0_1938) : !cute.int_tuple<"?">
      %849 = cute.get_scalars(%e1_1939) : !cute.int_tuple<"?">
      %850 = cute.get_scalars(%e2_1940) : !cute.int_tuple<"?">
      %851 = cute.get_scalars(%e3_1941) : !cute.int_tuple<"?{div=8}">
      %iter_1942 = cute.get_iter(%view_1936) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1943, %e1_1944, %e2_1945, %e3_1946 = cute.get_leaves(%iter_1942) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %852 = cute.get_scalars(%e0_1943) : !cute.int_tuple<"?">
      %853 = cute.get_scalars(%e1_1944) : !cute.int_tuple<"?">
      %854 = cute.get_scalars(%e2_1945) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e3_1946) : !cute.int_tuple<"?{div=8}">
      %iter_1947 = cute.get_iter(%view_1936) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1948, %e1_1949, %e2_1950, %e3_1951 = cute.get_leaves(%iter_1947) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %856 = cute.get_scalars(%e0_1948) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e1_1949) : !cute.int_tuple<"?">
      %858 = cute.get_scalars(%e2_1950) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e3_1951) : !cute.int_tuple<"?{div=8}">
      %lay_1952 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %860 = cute.get_shape(%lay_1952) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1953, %e1_1954, %e2_1955, %e3_1956 = cute.get_leaves(%860) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1957 = cute.to_int_tuple(%e0_1953) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %861 = cute.get_scalars(%itup_1957) : !cute.int_tuple<"?">
      %itup_1958 = cute.to_int_tuple(%e1_1954) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %862 = cute.get_scalars(%itup_1958) : !cute.int_tuple<"?">
      %itup_1959 = cute.to_int_tuple(%e2_1955) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %863 = cute.get_scalars(%itup_1959) : !cute.int_tuple<"?">
      %itup_1960 = cute.to_int_tuple(%e3_1956) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %864 = cute.get_scalars(%itup_1960) : !cute.int_tuple<"?{div=8}">
      %coord_1961 = cute.make_coord(%e1_1949) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1962 = cute.make_coord(%itup_1958) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %865 = cute.elem_less(%coord_1961, %coord_1962) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %865 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2060 = cute.get_layout(%rmem_1720) : !memref_rmem_bf16_32
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_2062 = cute.get_iter(%rmem_1720) : !memref_rmem_bf16_32
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_rmem_bf16_34
        %iter_2065 = cute.get_iter(%view_2064) : !memref_rmem_bf16_34
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2069 = cute.get_iter(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_gmem_bf16_8
        %iter_2072 = cute.get_iter(%view_2071) : !memref_gmem_bf16_8
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2074 = cute.get_layout(%rmem_1852) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_1852) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_rmem_bf16_34
        %iter_2093 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %lay_2094 = cute.get_layout(%view_2092) : !memref_rmem_bf16_34
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %view_2099 = cute.make_view(%iter_2098) : !memref_rmem_bf16_35
        %iter_2100 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2101 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %lay_2102 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_gmem_bf16_8
        %iter_2107 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %lay_2108 = cute.get_layout(%view_2106) : !memref_gmem_bf16_8
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %view_2113 = cute.make_view(%iter_2112) : !memref_gmem_bf16_9
        %iter_2114 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %iter_2115 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2144 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2145 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %lay_2146 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_rmem_bf16_9
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_gmem_bf16_10
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2162, %view_2166, %view_2170) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_1963 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1964 = cute.get_layout(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1965 = cute.crd2idx(%coord_1963, %lay_1964) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1966 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1967 = cute.add_offset(%iter_1966, %idx_1965) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1968 = cute.make_view(%tup_1967) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1969 = cute.get_iter(%view_1968) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1970, %e1_1971, %e2_1972, %e3_1973 = cute.get_leaves(%iter_1969) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %866 = cute.get_scalars(%e0_1970) : !cute.int_tuple<"?">
      %867 = cute.get_scalars(%e1_1971) : !cute.int_tuple<"?">
      %868 = cute.get_scalars(%e2_1972) : !cute.int_tuple<"?">
      %869 = cute.get_scalars(%e3_1973) : !cute.int_tuple<"?{div=8}">
      %iter_1974 = cute.get_iter(%view_1968) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1975, %e1_1976, %e2_1977, %e3_1978 = cute.get_leaves(%iter_1974) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %870 = cute.get_scalars(%e0_1975) : !cute.int_tuple<"?">
      %871 = cute.get_scalars(%e1_1976) : !cute.int_tuple<"?">
      %872 = cute.get_scalars(%e2_1977) : !cute.int_tuple<"?">
      %873 = cute.get_scalars(%e3_1978) : !cute.int_tuple<"?{div=8}">
      %iter_1979 = cute.get_iter(%view_1968) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1980, %e1_1981, %e2_1982, %e3_1983 = cute.get_leaves(%iter_1979) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %874 = cute.get_scalars(%e0_1980) : !cute.int_tuple<"?">
      %875 = cute.get_scalars(%e1_1981) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e2_1982) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e3_1983) : !cute.int_tuple<"?{div=8}">
      %lay_1984 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %878 = cute.get_shape(%lay_1984) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1985, %e1_1986, %e2_1987, %e3_1988 = cute.get_leaves(%878) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1989 = cute.to_int_tuple(%e0_1985) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %879 = cute.get_scalars(%itup_1989) : !cute.int_tuple<"?">
      %itup_1990 = cute.to_int_tuple(%e1_1986) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %880 = cute.get_scalars(%itup_1990) : !cute.int_tuple<"?">
      %itup_1991 = cute.to_int_tuple(%e2_1987) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %881 = cute.get_scalars(%itup_1991) : !cute.int_tuple<"?">
      %itup_1992 = cute.to_int_tuple(%e3_1988) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %882 = cute.get_scalars(%itup_1992) : !cute.int_tuple<"?{div=8}">
      %coord_1993 = cute.make_coord(%e1_1981) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1994 = cute.make_coord(%itup_1990) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %883 = cute.elem_less(%coord_1993, %coord_1994) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %883 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2060 = cute.get_layout(%rmem_1720) : !memref_rmem_bf16_32
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_2062 = cute.get_iter(%rmem_1720) : !memref_rmem_bf16_32
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_rmem_bf16_34
        %iter_2065 = cute.get_iter(%view_2064) : !memref_rmem_bf16_34
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2069 = cute.get_iter(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_gmem_bf16_8
        %iter_2072 = cute.get_iter(%view_2071) : !memref_gmem_bf16_8
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2074 = cute.get_layout(%rmem_1852) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_1852) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_rmem_bf16_34
        %iter_2093 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %lay_2094 = cute.get_layout(%view_2092) : !memref_rmem_bf16_34
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %view_2099 = cute.make_view(%iter_2098) : !memref_rmem_bf16_35
        %iter_2100 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2101 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %lay_2102 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_gmem_bf16_8
        %iter_2107 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %lay_2108 = cute.get_layout(%view_2106) : !memref_gmem_bf16_8
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %view_2113 = cute.make_view(%iter_2112) : !memref_gmem_bf16_9
        %iter_2114 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %iter_2115 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2144 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2145 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %lay_2146 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_rmem_bf16_9
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_gmem_bf16_10
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2162, %view_2166, %view_2170) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_1995 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1996 = cute.get_layout(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1997 = cute.crd2idx(%coord_1995, %lay_1996) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1998 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1999 = cute.add_offset(%iter_1998, %idx_1997) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2000 = cute.make_view(%tup_1999) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2001 = cute.get_iter(%view_2000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2002, %e1_2003, %e2_2004, %e3_2005 = cute.get_leaves(%iter_2001) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %884 = cute.get_scalars(%e0_2002) : !cute.int_tuple<"?">
      %885 = cute.get_scalars(%e1_2003) : !cute.int_tuple<"?">
      %886 = cute.get_scalars(%e2_2004) : !cute.int_tuple<"?">
      %887 = cute.get_scalars(%e3_2005) : !cute.int_tuple<"?{div=8}">
      %iter_2006 = cute.get_iter(%view_2000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2007, %e1_2008, %e2_2009, %e3_2010 = cute.get_leaves(%iter_2006) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %888 = cute.get_scalars(%e0_2007) : !cute.int_tuple<"?">
      %889 = cute.get_scalars(%e1_2008) : !cute.int_tuple<"?">
      %890 = cute.get_scalars(%e2_2009) : !cute.int_tuple<"?">
      %891 = cute.get_scalars(%e3_2010) : !cute.int_tuple<"?{div=8}">
      %iter_2011 = cute.get_iter(%view_2000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2012, %e1_2013, %e2_2014, %e3_2015 = cute.get_leaves(%iter_2011) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %892 = cute.get_scalars(%e0_2012) : !cute.int_tuple<"?">
      %893 = cute.get_scalars(%e1_2013) : !cute.int_tuple<"?">
      %894 = cute.get_scalars(%e2_2014) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e3_2015) : !cute.int_tuple<"?{div=8}">
      %lay_2016 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %896 = cute.get_shape(%lay_2016) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2017, %e1_2018, %e2_2019, %e3_2020 = cute.get_leaves(%896) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2021 = cute.to_int_tuple(%e0_2017) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %897 = cute.get_scalars(%itup_2021) : !cute.int_tuple<"?">
      %itup_2022 = cute.to_int_tuple(%e1_2018) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %898 = cute.get_scalars(%itup_2022) : !cute.int_tuple<"?">
      %itup_2023 = cute.to_int_tuple(%e2_2019) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %899 = cute.get_scalars(%itup_2023) : !cute.int_tuple<"?">
      %itup_2024 = cute.to_int_tuple(%e3_2020) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %900 = cute.get_scalars(%itup_2024) : !cute.int_tuple<"?{div=8}">
      %coord_2025 = cute.make_coord(%e1_2013) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2026 = cute.make_coord(%itup_2022) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %901 = cute.elem_less(%coord_2025, %coord_2026) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %901 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2060 = cute.get_layout(%rmem_1720) : !memref_rmem_bf16_32
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_2062 = cute.get_iter(%rmem_1720) : !memref_rmem_bf16_32
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_rmem_bf16_34
        %iter_2065 = cute.get_iter(%view_2064) : !memref_rmem_bf16_34
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2069 = cute.get_iter(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_gmem_bf16_8
        %iter_2072 = cute.get_iter(%view_2071) : !memref_gmem_bf16_8
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2074 = cute.get_layout(%rmem_1852) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_1852) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_rmem_bf16_34
        %iter_2093 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %lay_2094 = cute.get_layout(%view_2092) : !memref_rmem_bf16_34
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %view_2099 = cute.make_view(%iter_2098) : !memref_rmem_bf16_35
        %iter_2100 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2101 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %lay_2102 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_gmem_bf16_8
        %iter_2107 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %lay_2108 = cute.get_layout(%view_2106) : !memref_gmem_bf16_8
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %view_2113 = cute.make_view(%iter_2112) : !memref_gmem_bf16_9
        %iter_2114 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %iter_2115 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2144 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2145 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %lay_2146 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_rmem_bf16_9
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_gmem_bf16_10
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2162, %view_2166, %view_2170) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2027 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_2028 = cute.get_layout(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2029 = cute.crd2idx(%coord_2027, %lay_2028) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_2030 = cute.get_iter(%dst_partitioned_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2031 = cute.add_offset(%iter_2030, %idx_2029) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2032 = cute.make_view(%tup_2031) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2033 = cute.get_iter(%view_2032) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2034, %e1_2035, %e2_2036, %e3_2037 = cute.get_leaves(%iter_2033) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %902 = cute.get_scalars(%e0_2034) : !cute.int_tuple<"?">
      %903 = cute.get_scalars(%e1_2035) : !cute.int_tuple<"?">
      %904 = cute.get_scalars(%e2_2036) : !cute.int_tuple<"?">
      %905 = cute.get_scalars(%e3_2037) : !cute.int_tuple<"?{div=8}">
      %iter_2038 = cute.get_iter(%view_2032) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2039, %e1_2040, %e2_2041, %e3_2042 = cute.get_leaves(%iter_2038) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %906 = cute.get_scalars(%e0_2039) : !cute.int_tuple<"?">
      %907 = cute.get_scalars(%e1_2040) : !cute.int_tuple<"?">
      %908 = cute.get_scalars(%e2_2041) : !cute.int_tuple<"?">
      %909 = cute.get_scalars(%e3_2042) : !cute.int_tuple<"?{div=8}">
      %iter_2043 = cute.get_iter(%view_2032) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2044, %e1_2045, %e2_2046, %e3_2047 = cute.get_leaves(%iter_2043) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %910 = cute.get_scalars(%e0_2044) : !cute.int_tuple<"?">
      %911 = cute.get_scalars(%e1_2045) : !cute.int_tuple<"?">
      %912 = cute.get_scalars(%e2_2046) : !cute.int_tuple<"?">
      %913 = cute.get_scalars(%e3_2047) : !cute.int_tuple<"?{div=8}">
      %lay_2048 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %914 = cute.get_shape(%lay_2048) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2049, %e1_2050, %e2_2051, %e3_2052 = cute.get_leaves(%914) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2053 = cute.to_int_tuple(%e0_2049) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %915 = cute.get_scalars(%itup_2053) : !cute.int_tuple<"?">
      %itup_2054 = cute.to_int_tuple(%e1_2050) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %916 = cute.get_scalars(%itup_2054) : !cute.int_tuple<"?">
      %itup_2055 = cute.to_int_tuple(%e2_2051) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %917 = cute.get_scalars(%itup_2055) : !cute.int_tuple<"?">
      %itup_2056 = cute.to_int_tuple(%e3_2052) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %918 = cute.get_scalars(%itup_2056) : !cute.int_tuple<"?{div=8}">
      %coord_2057 = cute.make_coord(%e1_2045) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2058 = cute.make_coord(%itup_2054) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %919 = cute.elem_less(%coord_2057, %coord_2058) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %919 {
        %coord_2059 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2060 = cute.get_layout(%rmem_1720) : !memref_rmem_bf16_32
        %idx_2061 = cute.crd2idx(%coord_2059, %lay_2060) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_2062 = cute.get_iter(%rmem_1720) : !memref_rmem_bf16_32
        %ptr_2063 = cute.add_offset(%iter_2062, %idx_2061) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2064 = cute.make_view(%ptr_2063) : !memref_rmem_bf16_34
        %iter_2065 = cute.get_iter(%view_2064) : !memref_rmem_bf16_34
        %coord_2066 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2067 = cute.get_layout(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %idx_2068 = cute.crd2idx(%coord_2066, %lay_2067) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2069 = cute.get_iter(%dst_partitioned_1717) : !memref_gmem_bf16_5
        %ptr_2070 = cute.add_offset(%iter_2069, %idx_2068) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2071 = cute.make_view(%ptr_2070) : !memref_gmem_bf16_8
        %iter_2072 = cute.get_iter(%view_2071) : !memref_gmem_bf16_8
        %coord_2073 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2074 = cute.get_layout(%rmem_1852) : !memref_rmem_i8_
        %idx_2075 = cute.crd2idx(%coord_2073, %lay_2074) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2076 = cute.get_iter(%rmem_1852) : !memref_rmem_i8_
        %ptr_2077 = cute.add_offset(%iter_2076, %idx_2075) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2078 = cute.make_view(%ptr_2077) : !memref_rmem_i8_1
        %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_i8_1
        %lay_2080 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %920 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%920) : !cute.shape<"((8,1),2)">
        %lay_2084 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %921 = cute.get_shape(%lay_2084) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2085, %e1_2086, %e2_2087 = cute.get_leaves(%921) : !cute.shape<"((8,1),2)">
        %lay_2088 = cute.get_layout(%view_2064) : !memref_rmem_bf16_34
        %shape_2089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2090 = cute.make_layout() : !cute.layout<"1:0">
        %append_2091 = cute.append_to_rank<2> (%lay_2088, %lay_2090) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2092 = cute.make_view(%iter_2065, %append_2091) : !memref_rmem_bf16_34
        %iter_2093 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %lay_2094 = cute.get_layout(%view_2092) : !memref_rmem_bf16_34
        %922 = cute.get_shape(%lay_2094) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2095, %e1_2096, %e2_2097 = cute.get_leaves(%922) : !cute.shape<"((8,1),2)">
        %iter_2098 = cute.get_iter(%view_2092) : !memref_rmem_bf16_34
        %view_2099 = cute.make_view(%iter_2098) : !memref_rmem_bf16_35
        %iter_2100 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2101 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %lay_2102 = cute.get_layout(%view_2071) : !memref_gmem_bf16_8
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2104 = cute.make_layout() : !cute.layout<"1:0">
        %append_2105 = cute.append_to_rank<2> (%lay_2102, %lay_2104) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2106 = cute.make_view(%iter_2072, %append_2105) : !memref_gmem_bf16_8
        %iter_2107 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %lay_2108 = cute.get_layout(%view_2106) : !memref_gmem_bf16_8
        %923 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%923) : !cute.shape<"((8,1),2)">
        %iter_2112 = cute.get_iter(%view_2106) : !memref_gmem_bf16_8
        %view_2113 = cute.make_view(%iter_2112) : !memref_gmem_bf16_9
        %iter_2114 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %iter_2115 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2116 = cute.get_layout(%view_2078) : !memref_rmem_i8_1
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2079, %append_2119) : !memref_rmem_i8_1
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_i8_1
        %924 = cute.get_shape(%lay_2122) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2123, %e1_2124 = cute.get_leaves(%924) : !cute.shape<"(1,2)">
        %iter_2125 = cute.get_iter(%view_2120) : !memref_rmem_i8_1
        %view_2126 = cute.make_view(%iter_2125) : !memref_rmem_i8_2
        %iter_2127 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %iter_2128 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2129 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %925 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%925) : !cute.shape<"((8,1),(2))">
        %lay_2133 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %926 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2134, %e1_2135, %e2_2136 = cute.get_leaves(%926) : !cute.shape<"((8,1),(2))">
        %lay_2137 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %sz_2138 = cute.size(%lay_2137) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2139 = cute.get_leaves(%sz_2138) : !cute.int_tuple<"2">
        %lay_2140 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %sz_2141 = cute.size(%lay_2140) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2142 = cute.get_leaves(%sz_2141) : !cute.int_tuple<"2">
        %927 = cute.static : !cute.layout<"1:0">
        %iter_2143 = cute.get_iter(%view_2099) : !memref_rmem_bf16_35
        %iter_2144 = cute.get_iter(%view_2113) : !memref_gmem_bf16_9
        %lay_2145 = cute.get_layout(%view_2099) : !memref_rmem_bf16_35
        %lay_2146 = cute.get_layout(%view_2113) : !memref_gmem_bf16_9
        %append_2147 = cute.append_to_rank<2> (%lay_2145, %927) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2148 = cute.append_to_rank<2> (%lay_2146, %927) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2149 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2150 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2151 = cute.get_iter(%view_2126) : !memref_rmem_i8_2
        %lay_2152 = cute.get_layout(%view_2126) : !memref_rmem_i8_2
        %append_2153 = cute.append_to_rank<2> (%lay_2152, %927) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2155 = cute.size(%lay_2149) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %928 = cute.get_scalars(%sz_2155) : !cute.int_tuple<"2">
        %c0_i32_2156 = arith.constant 0 : i32
        %c1_i32_2157 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2156 to %928 step %c1_i32_2157  : i32 {
          %coord_2158 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2159 = cute.slice(%lay_2149, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2160 = cute.crd2idx(%coord_2158, %lay_2149) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2161 = cute.add_offset(%iter_2143, %idx_2160) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2162 = cute.make_view(%ptr_2161, %slice_2159) : !memref_rmem_bf16_9
          %slice_2163 = cute.slice(%lay_2150, %coord_2158) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2164 = cute.crd2idx(%coord_2158, %lay_2150) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2165 = cute.add_offset(%iter_2144, %idx_2164) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2166 = cute.make_view(%ptr_2165, %slice_2163) : !memref_gmem_bf16_10
          %slice_2167 = cute.slice(%lay_2154, %coord_2158) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2168 = cute.crd2idx(%coord_2158, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2169 = cute.add_offset(%iter_2151, %idx_2168) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2170 = cute.make_view(%ptr_2169, %slice_2167) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2162, %view_2166, %view_2170) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__HSTUAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Ten(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_, %arg5: !gpu.async.token) attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
    %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
    %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
    %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
    %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
    %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
    %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
    %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
    %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
    %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
    %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
    %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
    %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
    %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
    %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
    %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
    %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %36 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%36) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %37 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
    %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %38 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
    %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %39 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
    %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %40 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
    %41 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%41) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %42 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
    %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %43 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
    %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %44 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
    %45 = cute.static : !cute.swizzle<"S<3,4,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %46 = cute.get_stride(%lay_83) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_84, %e1_85 = cute.get_leaves(%46) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_86 = cute.make_composed_layout(%45, %int_tuple, %lay_83) : !cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">
    %shape_87 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_88 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %47 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_89 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_90 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %48 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_91 = cute.make_shape() : () -> !cute.shape<"(64,64)">
    %int_tuple_92 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %49 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
    %cosz = cute.cosize(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_93 = cute.get_leaves(%cosz) : !cute.int_tuple<"8192">
    %cosz_94 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_95 = cute.get_leaves(%cosz_94) : !cute.int_tuple<"8192">
    %cosz_96 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_97 = cute.get_leaves(%cosz_96) : !cute.int_tuple<"8192">
    %cosz_98 = cute.cosize(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"4096">
    %e0_99 = cute.get_leaves(%cosz_98) : !cute.int_tuple<"4096">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>
    %atom_100 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %50 = cute.composed_get_outer(%lay_86) : (!cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %51 = cute.get_shape(%50) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_101, %e1_102 = cute.get_leaves(%51) : !cute.shape<"(8,64)">
    %shape_103 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_104 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_105 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_106 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_107 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %prod = cute.raked_product(%lay_105, %lay_107) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_108 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_109 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_110 = cute.get_leaves(%sz_109) : !cute.int_tuple<"8">
    %shape_111 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_112 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_113 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %52 = cute.get_shape(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_114, %e1_115, %e2_116 = cute.get_leaves(%52) : !cute.shape<"(16,(8,8))">
    %int_tuple_117 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res = cute.tuple.product_each(%int_tuple_117) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_118, %e1_119 = cute.get_leaves(%res) : !cute.int_tuple<"(16,64)">
    %int_tuple_120 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_121 = cute.tuple.product_each(%int_tuple_120) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_122, %e1_123 = cute.get_leaves(%res_121) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %53 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %prod_124 = cute.raked_product(%lay_105, %lay_107) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_125 = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_126 = cute.get_leaves(%sz_125) : !cute.int_tuple<"128">
    %sz_127 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_128 = cute.get_leaves(%sz_127) : !cute.int_tuple<"8">
    %shape_129 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_130 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_131 = cute.right_inverse(%prod_124) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_132 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %54 = cute.get_shape(%prod_124) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_133, %e1_134, %e2_135 = cute.get_leaves(%54) : !cute.shape<"(16,(8,8))">
    %int_tuple_136 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res_137 = cute.tuple.product_each(%int_tuple_136) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_138, %e1_139 = cute.get_leaves(%res_137) : !cute.int_tuple<"(16,64)">
    %int_tuple_140 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_141 = cute.tuple.product_each(%int_tuple_140) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_142, %e1_143 = cute.get_leaves(%res_141) : !cute.int_tuple<"(16,64)">
    %tile_144 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %55 = cute.make_tiled_copy(%atom_100) : !copy_simt
    %shape_145 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_146 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_147 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_148 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %56 = cute.get_shape(%lay_148) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_149, %e1_150, %e2_151 = cute.get_leaves(%56) : !cute.shape<"(4,1,1)">
    %tile_152 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %57 = cute.make_tiled_mma(%atom_146) : !mma_bf16_bf16_f32_16x8x16_
    %lay_153 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %58 = cute.get_shape(%lay_153) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_154, %e1_155, %e2_156, %e3_157 = cute.get_leaves(%58) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_158 = cute.to_int_tuple(%e0_154) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %59 = cute.get_scalars(%itup_158) : !cute.int_tuple<"?">
    %itup_159 = cute.to_int_tuple(%e1_155) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_159) : !cute.int_tuple<"?">
    %itup_160 = cute.to_int_tuple(%e2_156) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_160) : !cute.int_tuple<"?">
    %itup_161 = cute.to_int_tuple(%e3_157) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %62 = cute.get_scalars(%itup_161) : !cute.int_tuple<"?{div=8}">
    %int_tuple_162 = cute.make_int_tuple(%itup_159) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_163 = cute.make_tile() : () -> !cute.tile<"64:1">
    %63 = cute.get_scalars(%int_tuple_162) <{only_dynamic}> : !cute.int_tuple<"?">
    %c64_i32 = arith.constant 64 : i32
    %64 = arith.ceildivsi %63, %c64_i32 : i32
    %int_tuple_164 = cute.make_int_tuple(%64) : (i32) -> !cute.int_tuple<"?">
    %e0_165 = cute.get_leaves(%int_tuple_164) : !cute.int_tuple<"?">
    %65 = cute.get_scalars(%e0_165) : !cute.int_tuple<"?">
    %lay_166 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %66 = cute.get_shape(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%66) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_171 = cute.to_int_tuple(%e0_167) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %67 = cute.get_scalars(%itup_171) : !cute.int_tuple<"?">
    %itup_172 = cute.to_int_tuple(%e1_168) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %68 = cute.get_scalars(%itup_172) : !cute.int_tuple<"?">
    %itup_173 = cute.to_int_tuple(%e2_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e3_170) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %70 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?{div=8}">
    %71 = cute.get_stride(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%71) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_179 = cute.to_int_tuple(%e0_175) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %72 = cute.get_scalars(%itup_179) : !cute.int_tuple<"?{i64 div=8}">
    %itup_180 = cute.to_int_tuple(%e1_176) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %73 = cute.get_scalars(%itup_180) : !cute.int_tuple<"?{i64 div=8}">
    %itup_181 = cute.to_int_tuple(%e2_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %lay_182 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %75 = cute.get_shape(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_183, %e1_184, %e2_185, %e3_186 = cute.get_leaves(%75) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_187 = cute.to_int_tuple(%e0_183) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %76 = cute.get_scalars(%itup_187) : !cute.int_tuple<"?">
    %itup_188 = cute.to_int_tuple(%e1_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %77 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
    %itup_189 = cute.to_int_tuple(%e2_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e3_186) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %79 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?{div=8}">
    %80 = cute.get_stride(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_191, %e1_192, %e2_193, %e3_194 = cute.get_leaves(%80) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_195 = cute.to_int_tuple(%e0_191) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %81 = cute.get_scalars(%itup_195) : !cute.int_tuple<"?{i64 div=8}">
    %itup_196 = cute.to_int_tuple(%e1_192) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %82 = cute.get_scalars(%itup_196) : !cute.int_tuple<"?{i64 div=8}">
    %itup_197 = cute.to_int_tuple(%e2_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %lay_198 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %84 = cute.get_shape(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_199, %e1_200, %e2_201, %e3_202 = cute.get_leaves(%84) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_203 = cute.to_int_tuple(%e0_199) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %85 = cute.get_scalars(%itup_203) : !cute.int_tuple<"?">
    %itup_204 = cute.to_int_tuple(%e1_200) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %86 = cute.get_scalars(%itup_204) : !cute.int_tuple<"?">
    %itup_205 = cute.to_int_tuple(%e2_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e3_202) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %88 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?{div=8}">
    %89 = cute.get_stride(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_207, %e1_208, %e2_209, %e3_210 = cute.get_leaves(%89) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_211 = cute.to_int_tuple(%e0_207) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %90 = cute.get_scalars(%itup_211) : !cute.int_tuple<"?{i64 div=8}">
    %itup_212 = cute.to_int_tuple(%e1_208) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %91 = cute.get_scalars(%itup_212) : !cute.int_tuple<"?{i64 div=8}">
    %itup_213 = cute.to_int_tuple(%e2_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %lay_214 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %93 = cute.get_shape(%lay_214) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_215, %e1_216, %e2_217, %e3_218 = cute.get_leaves(%93) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_219 = cute.to_int_tuple(%e0_215) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %94 = cute.get_scalars(%itup_219) : !cute.int_tuple<"?">
    %itup_220 = cute.to_int_tuple(%e1_216) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %95 = cute.get_scalars(%itup_220) : !cute.int_tuple<"?">
    %itup_221 = cute.to_int_tuple(%e2_217) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %96 = cute.get_scalars(%itup_221) : !cute.int_tuple<"?">
    %itup_222 = cute.to_int_tuple(%e3_218) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %97 = cute.get_scalars(%itup_222) : !cute.int_tuple<"?{div=8}">
    %98 = cute.get_stride(%lay_214) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_223, %e1_224, %e2_225, %e3_226 = cute.get_leaves(%98) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_227 = cute.to_int_tuple(%e0_223) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %99 = cute.get_scalars(%itup_227) : !cute.int_tuple<"?{i64 div=8}">
    %itup_228 = cute.to_int_tuple(%e1_224) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %100 = cute.get_scalars(%itup_228) : !cute.int_tuple<"?{i64 div=8}">
    %itup_229 = cute.to_int_tuple(%e2_225) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %101 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?{i64 div=8}">
    %lay_230 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %102 = cute.get_shape(%lay_230) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_231, %e1_232, %e2_233, %e3_234 = cute.get_leaves(%102) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_235 = cute.to_int_tuple(%e0_231) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %103 = cute.get_scalars(%itup_235) : !cute.int_tuple<"?">
    %itup_236 = cute.to_int_tuple(%e1_232) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %104 = cute.get_scalars(%itup_236) : !cute.int_tuple<"?">
    %itup_237 = cute.to_int_tuple(%e2_233) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %105 = cute.get_scalars(%itup_237) : !cute.int_tuple<"?">
    %itup_238 = cute.to_int_tuple(%e3_234) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %106 = cute.get_scalars(%itup_238) : !cute.int_tuple<"?{div=8}">
    %107 = cute.get_stride(%lay_230) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_239, %e1_240, %e2_241, %e3_242 = cute.get_leaves(%107) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_243 = cute.to_int_tuple(%e0_239) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %108 = cute.get_scalars(%itup_243) : !cute.int_tuple<"?{i64 div=8}">
    %itup_244 = cute.to_int_tuple(%e1_240) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %109 = cute.get_scalars(%itup_244) : !cute.int_tuple<"?{i64 div=8}">
    %itup_245 = cute.to_int_tuple(%e2_241) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %110 = cute.get_scalars(%itup_245) : !cute.int_tuple<"?{i64 div=8}">
    %111 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %112 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_246 = cute.get_leaves(%112) : !cute.int_tuple<"0">
    %113 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %114 = cute.get_shape(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_247, %e1_248, %e2_249, %e3_250 = cute.get_leaves(%114) : !cute.shape<"((8,8),(64,2))">
    %115 = cute.get_stride(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_251, %e1_252, %e2_253, %e3_254 = cute.get_leaves(%115) : !cute.stride<"((64,512),(1,4096))">
    %116 = cute.composed_get_inner(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %117 = cute.composed_get_offset(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_255 = cute.get_leaves(%117) : !cute.int_tuple<"0">
    %118 = cute.composed_get_outer(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %119 = cute.get_shape(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_256, %e1_257, %e2_258, %e3_259 = cute.get_leaves(%119) : !cute.shape<"((8,8),(64,2))">
    %120 = cute.get_stride(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_260, %e1_261, %e2_262, %e3_263 = cute.get_leaves(%120) : !cute.stride<"((64,512),(1,4096))">
    %121 = cute.composed_get_inner(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
    %122 = cute.composed_get_offset(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
    %e0_264 = cute.get_leaves(%122) : !cute.int_tuple<"0">
    %123 = cute.composed_get_outer(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
    %124 = cute.get_shape(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
    %e0_265, %e1_266, %e2_267, %e3_268 = cute.get_leaves(%124) : !cute.shape<"((8,8),(64,1))">
    %125 = cute.get_stride(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
    %e0_269, %e1_270, %e2_271, %e3_272 = cute.get_leaves(%125) : !cute.stride<"((64,512),(1,0))">
    %126 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %127 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_273 = cute.get_leaves(%127) : !cute.int_tuple<"0">
    %128 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %129 = cute.get_shape(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_274, %e1_275, %e2_276, %e3_277 = cute.get_leaves(%129) : !cute.shape<"((8,8),(64,2))">
    %130 = cute.get_stride(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_278, %e1_279, %e2_280, %e3_281 = cute.get_leaves(%130) : !cute.stride<"((64,512),(1,4096))">
    %131 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_282, %e1_283 = cute.get_leaves(%131) : !cute.tile<"[16:1;64:1]">
    %132 = cute.get_shape(%e0_282) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_284 = cute.get_leaves(%132) : !cute.shape<"16">
    %133 = cute.get_stride(%e0_282) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_285 = cute.get_leaves(%133) : !cute.stride<"1">
    %134 = cute.get_shape(%e1_283) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_286 = cute.get_leaves(%134) : !cute.shape<"64">
    %135 = cute.get_stride(%e1_283) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_287 = cute.get_leaves(%135) : !cute.stride<"1">
    %136 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %137 = cute.get_shape(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_288, %e1_289, %e2_290 = cute.get_leaves(%137) : !cute.shape<"((8,16),8)">
    %138 = cute.get_stride(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_291, %e1_292, %e2_293 = cute.get_leaves(%138) : !cute.stride<"((128,1),16)">
    %139 = cute.static : !cute.layout<"1:0">
    %140 = cute.get_shape(%139) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_294 = cute.get_leaves(%140) : !cute.shape<"1">
    %141 = cute.get_stride(%139) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_295 = cute.get_leaves(%141) : !cute.stride<"0">
    %142 = cute.static : !cute.layout<"(1,8):(0,1)">
    %143 = cute.get_shape(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_296, %e1_297 = cute.get_leaves(%143) : !cute.shape<"(1,8)">
    %144 = cute.get_stride(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_298, %e1_299 = cute.get_leaves(%144) : !cute.stride<"(0,1)">
    %145 = cute.static : !cute.layout<"(1,8):(0,1)">
    %146 = cute.get_shape(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_300, %e1_301 = cute.get_leaves(%146) : !cute.shape<"(1,8)">
    %147 = cute.get_stride(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_302, %e1_303 = cute.get_leaves(%147) : !cute.stride<"(0,1)">
    %148 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_304, %e1_305 = cute.get_leaves(%148) : !cute.tile<"[16:1;64:1]">
    %149 = cute.get_shape(%e0_304) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_306 = cute.get_leaves(%149) : !cute.shape<"16">
    %150 = cute.get_stride(%e0_304) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_307 = cute.get_leaves(%150) : !cute.stride<"1">
    %151 = cute.get_shape(%e1_305) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_308 = cute.get_leaves(%151) : !cute.shape<"64">
    %152 = cute.get_stride(%e1_305) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_309 = cute.get_leaves(%152) : !cute.stride<"1">
    %153 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %154 = cute.get_shape(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_310, %e1_311, %e2_312 = cute.get_leaves(%154) : !cute.shape<"((8,16),8)">
    %155 = cute.get_stride(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_313, %e1_314, %e2_315 = cute.get_leaves(%155) : !cute.stride<"((128,1),16)">
    %156 = cute.static : !cute.layout<"1:0">
    %157 = cute.get_shape(%156) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_316 = cute.get_leaves(%157) : !cute.shape<"1">
    %158 = cute.get_stride(%156) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_317 = cute.get_leaves(%158) : !cute.stride<"0">
    %159 = cute.static : !cute.layout<"(1,8):(0,1)">
    %160 = cute.get_shape(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_318, %e1_319 = cute.get_leaves(%160) : !cute.shape<"(1,8)">
    %161 = cute.get_stride(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_320, %e1_321 = cute.get_leaves(%161) : !cute.stride<"(0,1)">
    %162 = cute.static : !cute.layout<"(1,8):(0,1)">
    %163 = cute.get_shape(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_322, %e1_323 = cute.get_leaves(%163) : !cute.shape<"(1,8)">
    %164 = cute.get_stride(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_324, %e1_325 = cute.get_leaves(%164) : !cute.stride<"(0,1)">
    %165 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %166 = cute.get_shape(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%166) : !cute.shape<"(32,4,1,1)">
    %167 = cute.get_stride(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_330, %e1_331, %e2_332, %e3_333 = cute.get_leaves(%167) : !cute.stride<"(1,32,0,0)">
    %168 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_334, %e1_335, %e2_336 = cute.get_leaves(%168) : !cute.tile<"[64:1;16:1;16:1]">
    %169 = cute.get_shape(%e0_334) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_337 = cute.get_leaves(%169) : !cute.shape<"64">
    %170 = cute.get_stride(%e0_334) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_338 = cute.get_leaves(%170) : !cute.stride<"1">
    %171 = cute.get_shape(%e1_335) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_339 = cute.get_leaves(%171) : !cute.shape<"16">
    %172 = cute.get_stride(%e1_335) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_340 = cute.get_leaves(%172) : !cute.stride<"1">
    %173 = cute.get_shape(%e2_336) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_341 = cute.get_leaves(%173) : !cute.shape<"16">
    %174 = cute.get_stride(%e2_336) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_342 = cute.get_leaves(%174) : !cute.stride<"1">
    %175 = cute.static : !cute.layout<"32:1">
    %176 = cute.get_shape(%175) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_343 = cute.get_leaves(%176) : !cute.shape<"32">
    %177 = cute.get_stride(%175) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_344 = cute.get_leaves(%177) : !cute.stride<"1">
    %178 = cute.static : !cute.shape<"(16,8,16)">
    %e0_345, %e1_346, %e2_347 = cute.get_leaves(%178) : !cute.shape<"(16,8,16)">
    %179 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %180 = cute.get_shape(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_348, %e1_349, %e2_350, %e3_351, %e4 = cute.get_leaves(%180) : !cute.shape<"((4,8),(2,2,2))">
    %181 = cute.get_stride(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_352, %e1_353, %e2_354, %e3_355, %e4_356 = cute.get_leaves(%181) : !cute.stride<"((32,1),(16,8,128))">
    %182 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %183 = cute.get_shape(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_357, %e1_358, %e2_359, %e3_360 = cute.get_leaves(%183) : !cute.shape<"((4,8),(2,2))">
    %184 = cute.get_stride(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_361, %e1_362, %e2_363, %e3_364 = cute.get_leaves(%184) : !cute.stride<"((16,1),(8,64))">
    %185 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %186 = cute.get_shape(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_365, %e1_366, %e2_367, %e3_368 = cute.get_leaves(%186) : !cute.shape<"((4,8),(2,2))">
    %187 = cute.get_stride(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_369, %e1_370, %e2_371, %e3_372 = cute.get_leaves(%187) : !cute.stride<"((32,1),(16,8))">
    %c4 = arith.constant 4 : index
    %188 = arith.index_cast %65 : i32 to index
    %c128 = arith.constant 128 : index
    %c1 = arith.constant 1 : index
    %c57344_i32 = arith.constant 57344 : i32
    %189 = gpu.launch_func async [%arg5] @kernels::@kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8_0 blocks in (%c4, %c4, %188) threads in (%c128, %c1, %c1)  dynamic_shared_memory_size %c57344_i32 args(%arg0 : !memref_gmem_bf16_, %arg1 : !memref_gmem_bf16_, %arg2 : !memref_gmem_bf16_, %arg3 : !memref_gmem_bf16_, %arg4 : !memref_gmem_bf16_) {use_pdl = false}
    return
  }
}
