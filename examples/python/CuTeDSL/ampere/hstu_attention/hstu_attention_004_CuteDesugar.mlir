!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_3 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(64,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "(64,64,?):(?{i64 div=8},1,64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_11 = !cute.memref<bf16, gmem, align<16>, "((8,1),1):((1,0),0)">
!memref_gmem_bf16_12 = !cute.memref<bf16, gmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_gmem_bf16_13 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),1,(4,2)):((1,0),0,(16,8))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<32>, "((8,1),1,4):((1,0),0,8)">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<32>, "((8,1),(1,4)):((1,0),(0,8))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<16>, "((8,1),1):((1,0),0)">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4):(((1,32),0),4)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),(4)):(((1,32),0),(4))">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1)):(((1,32),0))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1):((1,2,4),0)">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4)):((1,2),(32,4))">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1,4):(((1,2),4),0,8)">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((1,8),1,8):((0,1),0,8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((1,8),(1,8)):((0,1),(0,8))">
!memref_rmem_bf16_31 = !cute.memref<bf16, rmem, align<16>, "((1,8)):((0,1))">
!memref_rmem_bf16_32 = !cute.memref<bf16, rmem, align<32>, "((8,1),4,2):((1,0),16,8)">
!memref_rmem_bf16_33 = !cute.memref<bf16, rmem, align<32>, "((8,1),(4,2)):((1,0),(16,8))">
!memref_rmem_bf16_34 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_35 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,1):((1,0),1024,0)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),1,((2,2),2)):((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),(2,4),((2,2),2)):((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,4,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),1):((1,0),0)">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<1024>, S<3,4,3>, "((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">
!memref_smem_bf16_25 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">
!memref_smem_bf16_26 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2))):((0,(1,512,8)))">
!memref_smem_bf16_27 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_28 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_29 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1)):((1,0))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    cuda.kernel @kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gm_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_) attributes {cu_attrs = {max_dynamic_shared_size_bytes = #cuda.dev_max_shared_memory_optin, non_portable_cluster_size_allowed = 1 : i32}, cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %1 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
      %3 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %4 = cute.static : !copy_ldgsts
      %5 = cute.static : !copy_simt
      %6 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %7 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%7) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
      %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %10 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
      %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %11 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
      %12 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%12) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
      %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %15 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
      %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %16 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%16) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
      %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %19 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
      %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %20 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
      %21 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%21) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
      %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %24 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
      %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %25 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%25) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
      %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %28 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
      %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %29 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
      %30 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%30) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
      %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %33 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
      %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %34 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%34) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
      %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %37 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
      %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %38 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
      %39 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%39) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
      %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
      %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %43 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%43) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %44 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
      %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %45 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
      %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %46 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
      %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %47 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
      %48 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%48) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %49 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
      %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %50 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
      %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %51 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
      %52 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %53 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,8),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,4096))">
      %57 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %58 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_92 = cute.get_leaves(%58) : !cute.int_tuple<"0">
      %59 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %60 = cute.get_shape(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_93, %e1_94, %e2_95, %e3_96 = cute.get_leaves(%60) : !cute.shape<"((8,8),(64,2))">
      %61 = cute.get_stride(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_97, %e1_98, %e2_99, %e3_100 = cute.get_leaves(%61) : !cute.stride<"((64,512),(1,4096))">
      %62 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
      %63 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
      %e0_101 = cute.get_leaves(%63) : !cute.int_tuple<"0">
      %64 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
      %65 = cute.get_shape(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
      %e0_102, %e1_103, %e2_104, %e3_105 = cute.get_leaves(%65) : !cute.shape<"((8,8),(64,1))">
      %66 = cute.get_stride(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
      %e0_106, %e1_107, %e2_108, %e3_109 = cute.get_leaves(%66) : !cute.stride<"((64,512),(1,0))">
      %67 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %68 = cute.composed_get_offset(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_110 = cute.get_leaves(%68) : !cute.int_tuple<"0">
      %69 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %70 = cute.get_shape(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_111, %e1_112, %e2_113, %e3_114 = cute.get_leaves(%70) : !cute.shape<"((8,8),(64,2))">
      %71 = cute.get_stride(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_115, %e1_116, %e2_117, %e3_118 = cute.get_leaves(%71) : !cute.stride<"((64,512),(1,4096))">
      %72 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_119, %e1_120 = cute.get_leaves(%72) : !cute.tile<"[16:1;64:1]">
      %73 = cute.get_shape(%e0_119) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_121 = cute.get_leaves(%73) : !cute.shape<"16">
      %74 = cute.get_stride(%e0_119) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_122 = cute.get_leaves(%74) : !cute.stride<"1">
      %75 = cute.get_shape(%e1_120) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_123 = cute.get_leaves(%75) : !cute.shape<"64">
      %76 = cute.get_stride(%e1_120) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_124 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %78 = cute.get_shape(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_125, %e1_126, %e2_127 = cute.get_leaves(%78) : !cute.shape<"((8,16),8)">
      %79 = cute.get_stride(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_128, %e1_129, %e2_130 = cute.get_leaves(%79) : !cute.stride<"((128,1),16)">
      %80 = cute.static : !cute.layout<"1:0">
      %81 = cute.get_shape(%80) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_131 = cute.get_leaves(%81) : !cute.shape<"1">
      %82 = cute.get_stride(%80) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_132 = cute.get_leaves(%82) : !cute.stride<"0">
      %83 = cute.static : !cute.layout<"(1,8):(0,1)">
      %84 = cute.get_shape(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_133, %e1_134 = cute.get_leaves(%84) : !cute.shape<"(1,8)">
      %85 = cute.get_stride(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_135, %e1_136 = cute.get_leaves(%85) : !cute.stride<"(0,1)">
      %86 = cute.static : !cute.layout<"(1,8):(0,1)">
      %87 = cute.get_shape(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_137, %e1_138 = cute.get_leaves(%87) : !cute.shape<"(1,8)">
      %88 = cute.get_stride(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_139, %e1_140 = cute.get_leaves(%88) : !cute.stride<"(0,1)">
      %89 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_141, %e1_142 = cute.get_leaves(%89) : !cute.tile<"[16:1;64:1]">
      %90 = cute.get_shape(%e0_141) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_143 = cute.get_leaves(%90) : !cute.shape<"16">
      %91 = cute.get_stride(%e0_141) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_144 = cute.get_leaves(%91) : !cute.stride<"1">
      %92 = cute.get_shape(%e1_142) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_145 = cute.get_leaves(%92) : !cute.shape<"64">
      %93 = cute.get_stride(%e1_142) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_146 = cute.get_leaves(%93) : !cute.stride<"1">
      %94 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %95 = cute.get_shape(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_147, %e1_148, %e2_149 = cute.get_leaves(%95) : !cute.shape<"((8,16),8)">
      %96 = cute.get_stride(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_150, %e1_151, %e2_152 = cute.get_leaves(%96) : !cute.stride<"((128,1),16)">
      %97 = cute.static : !cute.layout<"1:0">
      %98 = cute.get_shape(%97) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_153 = cute.get_leaves(%98) : !cute.shape<"1">
      %99 = cute.get_stride(%97) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_154 = cute.get_leaves(%99) : !cute.stride<"0">
      %100 = cute.static : !cute.layout<"(1,8):(0,1)">
      %101 = cute.get_shape(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_155, %e1_156 = cute.get_leaves(%101) : !cute.shape<"(1,8)">
      %102 = cute.get_stride(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_157, %e1_158 = cute.get_leaves(%102) : !cute.stride<"(0,1)">
      %103 = cute.static : !cute.layout<"(1,8):(0,1)">
      %104 = cute.get_shape(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_159, %e1_160 = cute.get_leaves(%104) : !cute.shape<"(1,8)">
      %105 = cute.get_stride(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_161, %e1_162 = cute.get_leaves(%105) : !cute.stride<"(0,1)">
      %106 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %107 = cute.get_shape(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_163, %e1_164, %e2_165, %e3_166 = cute.get_leaves(%107) : !cute.shape<"(32,4,1,1)">
      %108 = cute.get_stride(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%108) : !cute.stride<"(1,32,0,0)">
      %109 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_171, %e1_172, %e2_173 = cute.get_leaves(%109) : !cute.tile<"[64:1;16:1;16:1]">
      %110 = cute.get_shape(%e0_171) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_174 = cute.get_leaves(%110) : !cute.shape<"64">
      %111 = cute.get_stride(%e0_171) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_175 = cute.get_leaves(%111) : !cute.stride<"1">
      %112 = cute.get_shape(%e1_172) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_176 = cute.get_leaves(%112) : !cute.shape<"16">
      %113 = cute.get_stride(%e1_172) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_177 = cute.get_leaves(%113) : !cute.stride<"1">
      %114 = cute.get_shape(%e2_173) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_178 = cute.get_leaves(%114) : !cute.shape<"16">
      %115 = cute.get_stride(%e2_173) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_179 = cute.get_leaves(%115) : !cute.stride<"1">
      %116 = cute.static : !cute.layout<"32:1">
      %117 = cute.get_shape(%116) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_180 = cute.get_leaves(%117) : !cute.shape<"32">
      %118 = cute.get_stride(%116) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_181 = cute.get_leaves(%118) : !cute.stride<"1">
      %119 = cute.static : !cute.shape<"(16,8,16)">
      %e0_182, %e1_183, %e2_184 = cute.get_leaves(%119) : !cute.shape<"(16,8,16)">
      %120 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %121 = cute.get_shape(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_185, %e1_186, %e2_187, %e3_188, %e4 = cute.get_leaves(%121) : !cute.shape<"((4,8),(2,2,2))">
      %122 = cute.get_stride(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_189, %e1_190, %e2_191, %e3_192, %e4_193 = cute.get_leaves(%122) : !cute.stride<"((32,1),(16,8,128))">
      %123 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %124 = cute.get_shape(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_194, %e1_195, %e2_196, %e3_197 = cute.get_leaves(%124) : !cute.shape<"((4,8),(2,2))">
      %125 = cute.get_stride(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_198, %e1_199, %e2_200, %e3_201 = cute.get_leaves(%125) : !cute.stride<"((16,1),(8,64))">
      %126 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %127 = cute.get_shape(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_202, %e1_203, %e2_204, %e3_205 = cute.get_leaves(%127) : !cute.shape<"((4,8),(2,2))">
      %128 = cute.get_stride(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_206, %e1_207, %e2_208, %e3_209 = cute.get_leaves(%128) : !cute.stride<"((32,1),(16,8))">
      %129 = nvvm.read.ptx.sreg.tid.x : i32
      %130 = nvvm.read.ptx.sreg.tid.y : i32
      %131 = nvvm.read.ptx.sreg.tid.z : i32
      %132 = nvvm.read.ptx.sreg.ctaid.x : i32
      %133 = nvvm.read.ptx.sreg.ctaid.y : i32
      %134 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_210 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %135 = cute.get_shape(%lay_210) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_211, %e1_212, %e2_213, %e3_214 = cute.get_leaves(%135) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_215 = cute.to_int_tuple(%e0_211) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %136 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?">
      %itup_216 = cute.to_int_tuple(%e1_212) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %137 = cute.get_scalars(%itup_216) : !cute.int_tuple<"?">
      %itup_217 = cute.to_int_tuple(%e2_213) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %138 = cute.get_scalars(%itup_217) : !cute.int_tuple<"?">
      %itup_218 = cute.to_int_tuple(%e3_214) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %139 = cute.get_scalars(%itup_218) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_216) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %140 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %141 = arith.ceildivsi %140, %c64_i32 : i32
      %int_tuple_219 = cute.make_int_tuple(%141) : (i32) -> !cute.int_tuple<"?">
      %e0_220 = cute.get_leaves(%int_tuple_219) : !cute.int_tuple<"?">
      %142 = cute.get_scalars(%e0_220) : !cute.int_tuple<"?">
      %int_tuple_221 = cute.make_int_tuple(%134) : (i32) -> !cute.int_tuple<"?">
      %sub = cute.tuple_sub(%e0_220, %int_tuple_221) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %143 = cute.get_scalars(%sub) : !cute.int_tuple<"?">
      %int_tuple_222 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_223 = cute.tuple_sub(%sub, %int_tuple_222) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %144 = cute.get_scalars(%sub_223) : !cute.int_tuple<"?">
      %lay_224 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %145 = cute.get_shape(%lay_224) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_225, %e1_226, %e2_227, %e3_228 = cute.get_leaves(%145) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_229 = cute.to_int_tuple(%e0_225) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %146 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?">
      %itup_230 = cute.to_int_tuple(%e1_226) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %147 = cute.get_scalars(%itup_230) : !cute.int_tuple<"?">
      %itup_231 = cute.to_int_tuple(%e2_227) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %148 = cute.get_scalars(%itup_231) : !cute.int_tuple<"?">
      %itup_232 = cute.to_int_tuple(%e3_228) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %149 = cute.get_scalars(%itup_232) : !cute.int_tuple<"?{div=8}">
      %int_tuple_233 = cute.make_int_tuple(%itup_230) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile_234 = cute.make_tile() : () -> !cute.tile<"64:1">
      %150 = cute.get_scalars(%int_tuple_233) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32_235 = arith.constant 64 : i32
      %151 = arith.ceildivsi %150, %c64_i32_235 : i32
      %int_tuple_236 = cute.make_int_tuple(%151) : (i32) -> !cute.int_tuple<"?">
      %e0_237 = cute.get_leaves(%int_tuple_236) : !cute.int_tuple<"?">
      %152 = cute.get_scalars(%e0_237) : !cute.int_tuple<"?">
      %int_tuple_238 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_239 = cute.tuple_sub(%e0_237, %int_tuple_238) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %153 = cute.get_scalars(%sub_239) : !cute.int_tuple<"?">
      %coord = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_240 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %slice = cute.slice(%lay_240, %coord) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx = cute.crd2idx(%coord, %lay_240) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_241 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_241, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %slice) : !memref_gmem_bf16_1
      %iter_242 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %iter_243 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_244 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_245 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %154 = cute.get_scalars(%coord_245) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_246 = cute.make_coord(%154) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_247 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %155:3 = cute.get_scalars(%lay_247) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_248 = arith.constant 64 : i32
      %156 = arith.ceildivsi %155#0, %c64_i32_248 : i32
      %c64_i64 = arith.constant 64 : i64
      %157 = arith.muli %155#2, %c64_i64 : i64
      %c128_i32 = arith.constant 128 : i32
      %158 = arith.ceildivsi %155#1, %c128_i32 : i32
      %shape = cute.make_shape(%156, %158) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv = cute.assume(%155#2) : (i64) -> !cute.i64<divby 8>
      %iv_249 = cute.assume(%157) : (i64) -> !cute.i64<divby 512>
      %stride = cute.make_stride(%iv, %iv_249) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_250 = cute.make_layout(%shape, %stride) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_251 = cute.slice(%lay_250, %coord_246) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_252 = cute.crd2idx(%coord_246, %lay_250) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_253 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_254 = cute.add_offset(%iter_253, %idx_252) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_255 = cute.make_view(%ptr_254, %slice_251) : !memref_gmem_bf16_2
      %iter_256 = cute.get_iter(%view_255) : !memref_gmem_bf16_2
      %coord_257 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_258 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %slice_259 = cute.slice(%lay_258, %coord_257) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_260 = cute.crd2idx(%coord_257, %lay_258) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_261 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_262 = cute.add_offset(%iter_261, %idx_260) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_263 = cute.make_view(%ptr_262, %slice_259) : !memref_gmem_bf16_1
      %iter_264 = cute.get_iter(%view_263) : !memref_gmem_bf16_1
      %iter_265 = cute.get_iter(%view_263) : !memref_gmem_bf16_1
      %tile_266 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_267 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_268 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_269 = cute.get_layout(%view_263) : !memref_gmem_bf16_1
      %159:3 = cute.get_scalars(%lay_269) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_270 = arith.constant 64 : i32
      %160 = arith.ceildivsi %159#0, %c64_i32_270 : i32
      %c64_i64_271 = arith.constant 64 : i64
      %161 = arith.muli %159#2, %c64_i64_271 : i64
      %c128_i32_272 = arith.constant 128 : i32
      %162 = arith.ceildivsi %159#1, %c128_i32_272 : i32
      %shape_273 = cute.make_shape(%160, %162) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_274 = cute.assume(%159#2) : (i64) -> !cute.i64<divby 8>
      %iv_275 = cute.assume(%161) : (i64) -> !cute.i64<divby 512>
      %stride_276 = cute.make_stride(%iv_274, %iv_275) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_277 = cute.make_layout(%shape_273, %stride_276) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_278 = cute.slice(%lay_277, %coord_268) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_279 = cute.crd2idx(%coord_268, %lay_277) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_280 = cute.get_iter(%view_263) : !memref_gmem_bf16_1
      %ptr_281 = cute.add_offset(%iter_280, %idx_279) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_282 = cute.make_view(%ptr_281, %slice_278) : !memref_gmem_bf16_3
      %iter_283 = cute.get_iter(%view_282) : !memref_gmem_bf16_3
      %coord_284 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_285 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %slice_286 = cute.slice(%lay_285, %coord_284) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_287 = cute.crd2idx(%coord_284, %lay_285) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_288 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_289 = cute.add_offset(%iter_288, %idx_287) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_290 = cute.make_view(%ptr_289, %slice_286) : !memref_gmem_bf16_1
      %iter_291 = cute.get_iter(%view_290) : !memref_gmem_bf16_1
      %iter_292 = cute.get_iter(%view_290) : !memref_gmem_bf16_1
      %tile_293 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_294 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_295 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_296 = cute.get_layout(%view_290) : !memref_gmem_bf16_1
      %163:3 = cute.get_scalars(%lay_296) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_297 = arith.constant 64 : i32
      %164 = arith.ceildivsi %163#0, %c64_i32_297 : i32
      %c64_i64_298 = arith.constant 64 : i64
      %165 = arith.muli %163#2, %c64_i64_298 : i64
      %c128_i32_299 = arith.constant 128 : i32
      %166 = arith.ceildivsi %163#1, %c128_i32_299 : i32
      %shape_300 = cute.make_shape(%164, %166) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_301 = cute.assume(%163#2) : (i64) -> !cute.i64<divby 8>
      %iv_302 = cute.assume(%165) : (i64) -> !cute.i64<divby 512>
      %stride_303 = cute.make_stride(%iv_301, %iv_302) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_304 = cute.make_layout(%shape_300, %stride_303) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_305 = cute.slice(%lay_304, %coord_295) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_306 = cute.crd2idx(%coord_295, %lay_304) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_307 = cute.get_iter(%view_290) : !memref_gmem_bf16_1
      %ptr_308 = cute.add_offset(%iter_307, %idx_306) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_309 = cute.make_view(%ptr_308, %slice_305) : !memref_gmem_bf16_3
      %iter_310 = cute.get_iter(%view_309) : !memref_gmem_bf16_3
      %coord_311 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_312 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %slice_313 = cute.slice(%lay_312, %coord_311) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,?,_,_)">
      %idx_314 = cute.crd2idx(%coord_311, %lay_312) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_315 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %ptr_316 = cute.add_offset(%iter_315, %idx_314) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_317 = cute.make_view(%ptr_316, %slice_313) : !memref_gmem_bf16_1
      %iter_318 = cute.get_iter(%view_317) : !memref_gmem_bf16_1
      %iter_319 = cute.get_iter(%view_317) : !memref_gmem_bf16_1
      %tile_320 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_321 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %167 = cute.get_scalars(%coord_321) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_322 = cute.make_coord(%167) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_323 = cute.get_layout(%view_317) : !memref_gmem_bf16_1
      %168:3 = cute.get_scalars(%lay_323) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_324 = arith.constant 64 : i32
      %169 = arith.ceildivsi %168#0, %c64_i32_324 : i32
      %c64_i64_325 = arith.constant 64 : i64
      %170 = arith.muli %168#2, %c64_i64_325 : i64
      %c64_i32_326 = arith.constant 64 : i32
      %171 = arith.ceildivsi %168#1, %c64_i32_326 : i32
      %shape_327 = cute.make_shape(%169, %171) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %iv_328 = cute.assume(%168#2) : (i64) -> !cute.i64<divby 8>
      %iv_329 = cute.assume(%170) : (i64) -> !cute.i64<divby 512>
      %stride_330 = cute.make_stride(%iv_328, %iv_329) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},64))">
      %lay_331 = cute.make_layout(%shape_327, %stride_330) : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">
      %slice_332 = cute.slice(%lay_331, %coord_322) : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">, !cute.coord<"((_,_),(?,_))">
      %idx_333 = cute.crd2idx(%coord_322, %lay_331) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_334 = cute.get_iter(%view_317) : !memref_gmem_bf16_1
      %ptr_335 = cute.add_offset(%iter_334, %idx_333) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_336 = cute.make_view(%ptr_335, %slice_332) : !memref_gmem_bf16_4
      %iter_337 = cute.get_iter(%view_336) : !memref_gmem_bf16_4
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_338 = cute.make_int_tuple() : () -> !cute.int_tuple<"57344">
      %ptr_339 = cute.add_offset(%smem_ptr, %int_tuple_338) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"57344">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c57344_i32 = arith.constant 57344 : i32
      %172 = arith.cmpi sge, %smem_size, %c57344_i32 : i32
      cf.assert %172, "Allocation failed: shared memory allocation exceeds available memory set in kernel launch. Allocated bytes: 57344 bytes. Please reduce the allocation or set a larger smem size in kernel launch."
      %int_tuple_340 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_341 = cute.add_offset(%smem_ptr, %int_tuple_340) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_342 = cute.make_int_tuple() : () -> !cute.int_tuple<"16384">
      %ptr_343 = cute.add_offset(%smem_ptr, %int_tuple_342) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"16384">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_344 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_345 = cute.add_offset(%smem_ptr, %int_tuple_344) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_346 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_347 = cute.add_offset(%smem_ptr, %int_tuple_346) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_348 = cute.recast_iter(%ptr_341) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_349 = cute.make_view(%iter_348, %0) : !memref_smem_bf16_
      %iter_350 = cute.get_iter(%view_349) : !memref_smem_bf16_
      %iter_351 = cute.recast_iter(%ptr_343) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_352 = cute.make_view(%iter_351, %1) : !memref_smem_bf16_
      %iter_353 = cute.get_iter(%view_352) : !memref_smem_bf16_
      %iter_354 = cute.recast_iter(%ptr_345) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_355 = cute.make_view(%iter_354, %1) : !memref_smem_bf16_
      %iter_356 = cute.get_iter(%view_355) : !memref_smem_bf16_
      %iter_357 = cute.recast_iter(%ptr_347) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_358 = cute.make_view(%iter_357, %2) : !memref_smem_bf16_1
      %iter_359 = cute.get_iter(%view_358) : !memref_smem_bf16_1
      %shape_360 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_361 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_362 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_363 = cute.get_iter(%view_355) : !memref_smem_bf16_
      %view_364 = cute.make_view(%iter_363) : !memref_smem_bf16_2
      %iter_365 = cute.get_iter(%view_364) : !memref_smem_bf16_2
      %coord_366 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned = cute.tiled.copy.partition_S(%4, %view_255, %coord_366) : (!copy_ldgsts, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_367 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
      %coord_368 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned = cute.tiled.copy.partition_D(%4, %view_349, %coord_368) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_369 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
      %coord_370 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_371 = cute.tiled.copy.partition_S(%4, %view_282, %coord_370) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_6
      %iter_372 = cute.get_iter(%src_partitioned_371) : !memref_gmem_bf16_6
      %coord_373 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_374 = cute.tiled.copy.partition_D(%4, %view_352, %coord_373) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_375 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
      %coord_376 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_377 = cute.tiled.copy.partition_S(%4, %view_309, %coord_376) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_6
      %iter_378 = cute.get_iter(%src_partitioned_377) : !memref_gmem_bf16_6
      %coord_379 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_380 = cute.tiled.copy.partition_D(%4, %view_355, %coord_379) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_381 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
      %coord_382 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_383 = cute.tiled.copy.partition_S(%4, %view_336, %coord_382) : (!copy_ldgsts, !memref_gmem_bf16_4, !cute.coord<"?">) -> !memref_gmem_bf16_7
      %iter_384 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
      %coord_385 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_386 = cute.tiled.copy.partition_D(%4, %view_358, %coord_385) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_387 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
      %coord_388 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %ptn_A = cute.tiled.mma.partition A (%6, %view_349, %coord_388) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_5
      %iter_389 = cute.get_iter(%ptn_A) : !memref_smem_bf16_5
      %frg_A = cute.mma.make_fragment A (%6, %ptn_A) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_5) -> !memref_rmem_bf16_
      %iter_390 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %coord_391 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %ptn_B = cute.tiled.mma.partition B (%6, %view_352, %coord_391) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_6
      %iter_392 = cute.get_iter(%ptn_B) : !memref_smem_bf16_6
      %frg_B = cute.mma.make_fragment B (%6, %ptn_B) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_6) -> !memref_rmem_bf16_1
      %iter_393 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %coord_394 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %ptn_B_395 = cute.tiled.mma.partition B (%6, %view_364, %coord_394) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_7
      %iter_396 = cute.get_iter(%ptn_B_395) : !memref_smem_bf16_7
      %frg_B_397 = cute.mma.make_fragment B (%6, %ptn_B_395) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_7) -> !memref_rmem_bf16_2
      %iter_398 = cute.get_iter(%frg_B_397) : !memref_rmem_bf16_2
      %shape_399 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %173 = cute.tiled.mma.partition_shape C (%6, %shape_399) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(64,128)">) -> !cute.shape<"((2,2),1,16)">
      %e0_400, %e1_401, %e2_402, %e3_403 = cute.get_leaves(%173) : !cute.shape<"((2,2),1,16)">
      %shape_404 = cute.make_shape() : () -> !cute.shape<"((2,2),1,16)">
      %lay_405 = cute.make_layout() : !cute.layout<"((2,2),1,16):((1,2),0,4)">
      %rmem = cute.memref.alloca(%lay_405) : !memref_rmem_f32_
      %iter_406 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_407 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_408 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %sz = cute.size(%lay_408) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"64">
      %e0_409 = cute.get_leaves(%sz) : !cute.int_tuple<"64">
      %lay_410 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %174 = cute.get_shape(%lay_410) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_411, %e1_412, %e2_413, %e3_414 = cute.get_leaves(%174) : !cute.shape<"((2,2),1,16)">
      %int_tuple_415 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %res = cute.tuple.product(%int_tuple_415) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_416 = cute.get_leaves(%res) : !cute.int_tuple<"64">
      %cst = arith.constant 0.000000e+00 : f32
      %175 = vector.splat %cst : vector<64xf32>
      %int_tuple_417 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_418 = cute.size(%int_tuple_417) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_419 = cute.get_leaves(%sz_418) : !cute.int_tuple<"64">
      %int_tuple_420 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_421 = cute.size(%int_tuple_420) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_422 = cute.get_leaves(%sz_421) : !cute.int_tuple<"64">
      cute.memref.store_vec %175, %rmem : !memref_rmem_f32_
      %shape_423 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_424 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_425 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_426 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_427 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %shape_428 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_429 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %176 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %177 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_430, %e1_431, %e2_432 = cute.get_leaves(%177) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_433 = cute.size(%e0_430) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_434 = cute.get_leaves(%sz_433) : !cute.int_tuple<"64">
      %178 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_435, %e1_436, %e2_437 = cute.get_leaves(%178) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_438 = cute.size(%e2_437) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_439 = cute.get_leaves(%sz_438) : !cute.int_tuple<"16">
      %tile_440 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %179 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %180 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %181 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_441, %e1_442, %e2_443 = cute.get_leaves(%181) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_444 = cute.size(%e1_442) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_445 = cute.get_leaves(%sz_444) : !cute.int_tuple<"16">
      %182 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_446, %e1_447, %e2_448 = cute.get_leaves(%182) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_449 = cute.size(%e2_448) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_450 = cute.get_leaves(%sz_449) : !cute.int_tuple<"16">
      %tile_451 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %183 = cute.make_tiled_copy(%atom_425) : !copy_ldsm_4_1
      %184 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %185 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_452, %e1_453, %e2_454 = cute.get_leaves(%185) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_455 = cute.size(%e1_453) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_456 = cute.get_leaves(%sz_455) : !cute.int_tuple<"16">
      %186 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_457, %e1_458, %e2_459 = cute.get_leaves(%186) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_460 = cute.size(%e2_459) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_461 = cute.get_leaves(%sz_460) : !cute.int_tuple<"16">
      %tile_462 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %187 = cute.make_tiled_copy(%atom_427) : !copy_ldsm_4_2
      %188 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %189 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_463, %e1_464, %e2_465 = cute.get_leaves(%189) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_466 = cute.size(%e0_463) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_467 = cute.get_leaves(%sz_466) : !cute.int_tuple<"64">
      %190 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_468, %e1_469, %e2_470 = cute.get_leaves(%190) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_471 = cute.size(%e1_469) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_472 = cute.get_leaves(%sz_471) : !cute.int_tuple<"16">
      %tile_473 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %191 = cute.make_tiled_copy(%atom_429) : !copy_ldsm_4_3
      %coord_474 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_475 = cute.tiled.copy.partition_S(%179, %view_349, %coord_474) : (!copy_ldsm_4_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_8
      %iter_476 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
      %retiled = cute.tiled.copy.retile(%179, %frg_A) : (!copy_ldsm_4_, !memref_rmem_bf16_) -> !memref_rmem_bf16_3
      %iter_477 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %coord_478 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_479 = cute.tiled.copy.partition_S(%183, %view_352, %coord_478) : (!copy_ldsm_4_1, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_9
      %iter_480 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
      %retiled_481 = cute.tiled.copy.retile(%183, %frg_B) : (!copy_ldsm_4_1, !memref_rmem_bf16_1) -> !memref_rmem_bf16_4
      %iter_482 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
      %coord_483 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_484 = cute.tiled.copy.partition_S(%187, %view_364, %coord_483) : (!copy_ldsm_4_2, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_10
      %iter_485 = cute.get_iter(%src_partitioned_484) : !memref_smem_bf16_10
      %retiled_486 = cute.tiled.copy.retile(%187, %frg_B_397) : (!copy_ldsm_4_2, !memref_rmem_bf16_2) -> !memref_rmem_bf16_5
      %iter_487 = cute.get_iter(%retiled_486) : !memref_rmem_bf16_5
      %coord_488 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_489 = cute.tiled.copy.partition_S(%191, %view_358, %coord_488) : (!copy_ldsm_4_3, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_11
      %iter_490 = cute.get_iter(%src_partitioned_489) : !memref_smem_bf16_11
      %lay_491 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %192 = cute.get_shape(%lay_491) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_492, %e1_493, %e2_494, %e3_495 = cute.get_leaves(%192) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_496 = cute.to_int_tuple(%e0_492) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %193 = cute.get_scalars(%itup_496) : !cute.int_tuple<"?">
      %itup_497 = cute.to_int_tuple(%e1_493) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %194 = cute.get_scalars(%itup_497) : !cute.int_tuple<"?">
      %itup_498 = cute.to_int_tuple(%e2_494) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %195 = cute.get_scalars(%itup_498) : !cute.int_tuple<"?">
      %itup_499 = cute.to_int_tuple(%e3_495) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %196 = cute.get_scalars(%itup_499) : !cute.int_tuple<"?{div=8}">
      %shape_500 = cute.make_shape(%itup_496, %itup_497, %itup_498, %itup_499) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %197 = cute.make_identity_tensor(%shape_500) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_501 = cute.get_iter(%197) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_502, %e1_503, %e2_504, %e3_505 = cute.get_leaves(%iter_501) : !cute.int_tuple<"(0,0,0,0)">
      %lay_506 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %198 = cute.get_shape(%lay_506) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_507, %e1_508, %e2_509, %e3_510 = cute.get_leaves(%198) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_511 = cute.to_int_tuple(%e0_507) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %199 = cute.get_scalars(%itup_511) : !cute.int_tuple<"?">
      %itup_512 = cute.to_int_tuple(%e1_508) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %200 = cute.get_scalars(%itup_512) : !cute.int_tuple<"?">
      %itup_513 = cute.to_int_tuple(%e2_509) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %201 = cute.get_scalars(%itup_513) : !cute.int_tuple<"?">
      %itup_514 = cute.to_int_tuple(%e3_510) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %202 = cute.get_scalars(%itup_514) : !cute.int_tuple<"?{div=8}">
      %shape_515 = cute.make_shape(%itup_511, %itup_512, %itup_513, %itup_514) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %203 = cute.make_identity_tensor(%shape_515) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_516 = cute.get_iter(%203) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_517, %e1_518, %e2_519, %e3_520 = cute.get_leaves(%iter_516) : !cute.int_tuple<"(0,0,0,0)">
      %lay_521 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %204 = cute.get_shape(%lay_521) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_522, %e1_523, %e2_524, %e3_525 = cute.get_leaves(%204) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_526 = cute.to_int_tuple(%e0_522) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %205 = cute.get_scalars(%itup_526) : !cute.int_tuple<"?">
      %itup_527 = cute.to_int_tuple(%e1_523) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %206 = cute.get_scalars(%itup_527) : !cute.int_tuple<"?">
      %itup_528 = cute.to_int_tuple(%e2_524) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %207 = cute.get_scalars(%itup_528) : !cute.int_tuple<"?">
      %itup_529 = cute.to_int_tuple(%e3_525) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %208 = cute.get_scalars(%itup_529) : !cute.int_tuple<"?{div=8}">
      %shape_530 = cute.make_shape(%itup_526, %itup_527, %itup_528, %itup_529) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %209 = cute.make_identity_tensor(%shape_530) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_531 = cute.get_iter(%209) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_532, %e1_533, %e2_534, %e3_535 = cute.get_leaves(%iter_531) : !cute.int_tuple<"(0,0,0,0)">
      %coord_536 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_537 = cute.get_layout(%197) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_538 = cute.slice(%lay_537, %coord_536) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_539 = cute.crd2idx(%coord_536, %lay_537) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_540 = cute.get_iter(%197) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_540, %idx_539) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_541 = cute.make_view(%tup, %slice_538) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_542 = cute.get_iter(%view_541) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_543, %e1_544, %e2_545, %e3_546 = cute.get_leaves(%iter_542) : !cute.int_tuple<"(?,0,?,0)">
      %210 = cute.get_scalars(%e0_543) : !cute.int_tuple<"?">
      %211 = cute.get_scalars(%e2_545) : !cute.int_tuple<"?">
      %iter_547 = cute.get_iter(%view_541) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_548, %e1_549, %e2_550, %e3_551 = cute.get_leaves(%iter_547) : !cute.int_tuple<"(?,0,?,0)">
      %212 = cute.get_scalars(%e0_548) : !cute.int_tuple<"?">
      %213 = cute.get_scalars(%e2_550) : !cute.int_tuple<"?">
      %tile_552 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_553 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %214 = cute.get_scalars(%coord_553) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_554 = cute.make_coord(%214) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_555 = cute.get_layout(%view_541) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %215:2 = cute.get_scalars(%lay_555) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_556 = arith.constant 64 : i32
      %216 = arith.ceildivsi %215#0, %c64_i32_556 : i32
      %c128_i32_557 = arith.constant 128 : i32
      %217 = arith.ceildivsi %215#1, %c128_i32_557 : i32
      %shape_558 = cute.make_shape(%216, %217) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_559 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_560 = cute.make_layout(%shape_558, %stride_559) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_561 = cute.crd2idx(%coord_554, %lay_560) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_562 = cute.get_iter(%view_541) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_563 = cute.add_offset(%iter_562, %idx_561) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_564 = cute.make_view(%tup_563) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_565 = cute.get_iter(%view_564) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_566, %e1_567, %e2_568, %e3_569 = cute.get_leaves(%iter_565) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %218 = cute.get_scalars(%e0_566) : !cute.int_tuple<"?">
      %219 = cute.get_scalars(%e1_567) : !cute.int_tuple<"?{div=64}">
      %220 = cute.get_scalars(%e2_568) : !cute.int_tuple<"?">
      %coord_570 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_571 = cute.get_layout(%203) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_572 = cute.slice(%lay_571, %coord_570) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_573 = cute.crd2idx(%coord_570, %lay_571) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_574 = cute.get_iter(%203) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_575 = cute.add_offset(%iter_574, %idx_573) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_576 = cute.make_view(%tup_575, %slice_572) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_577 = cute.get_iter(%view_576) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_578, %e1_579, %e2_580, %e3_581 = cute.get_leaves(%iter_577) : !cute.int_tuple<"(?,0,?,0)">
      %221 = cute.get_scalars(%e0_578) : !cute.int_tuple<"?">
      %222 = cute.get_scalars(%e2_580) : !cute.int_tuple<"?">
      %iter_582 = cute.get_iter(%view_576) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_583, %e1_584, %e2_585, %e3_586 = cute.get_leaves(%iter_582) : !cute.int_tuple<"(?,0,?,0)">
      %223 = cute.get_scalars(%e0_583) : !cute.int_tuple<"?">
      %224 = cute.get_scalars(%e2_585) : !cute.int_tuple<"?">
      %tile_587 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_588 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %225 = cute.get_scalars(%coord_588) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_589 = cute.make_coord(%225) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_590 = cute.get_layout(%view_576) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %226:2 = cute.get_scalars(%lay_590) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_591 = arith.constant 64 : i32
      %227 = arith.ceildivsi %226#0, %c64_i32_591 : i32
      %c128_i32_592 = arith.constant 128 : i32
      %228 = arith.ceildivsi %226#1, %c128_i32_592 : i32
      %shape_593 = cute.make_shape(%227, %228) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_594 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_595 = cute.make_layout(%shape_593, %stride_594) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_596 = cute.crd2idx(%coord_589, %lay_595) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_597 = cute.get_iter(%view_576) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_598 = cute.add_offset(%iter_597, %idx_596) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_599 = cute.make_view(%tup_598) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_600 = cute.get_iter(%view_599) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_601, %e1_602, %e2_603, %e3_604 = cute.get_leaves(%iter_600) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %229 = cute.get_scalars(%e0_601) : !cute.int_tuple<"?">
      %230 = cute.get_scalars(%e1_602) : !cute.int_tuple<"?{div=64}">
      %231 = cute.get_scalars(%e2_603) : !cute.int_tuple<"?">
      %coord_605 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_606 = cute.get_layout(%209) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_607 = cute.slice(%lay_606, %coord_605) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,?,_,_)">
      %idx_608 = cute.crd2idx(%coord_605, %lay_606) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,?,0,0)">
      %iter_609 = cute.get_iter(%209) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_610 = cute.add_offset(%iter_609, %idx_608) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,?,0,0)">) -> !cute.int_tuple<"(?,?,0,0)">
      %view_611 = cute.make_view(%tup_610, %slice_607) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %iter_612 = cute.get_iter(%view_611) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %e0_613, %e1_614, %e2_615, %e3_616 = cute.get_leaves(%iter_612) : !cute.int_tuple<"(?,?,0,0)">
      %232 = cute.get_scalars(%e0_613) : !cute.int_tuple<"?">
      %233 = cute.get_scalars(%e1_614) : !cute.int_tuple<"?">
      %iter_617 = cute.get_iter(%view_611) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %e0_618, %e1_619, %e2_620, %e3_621 = cute.get_leaves(%iter_617) : !cute.int_tuple<"(?,?,0,0)">
      %234 = cute.get_scalars(%e0_618) : !cute.int_tuple<"?">
      %235 = cute.get_scalars(%e1_619) : !cute.int_tuple<"?">
      %tile_622 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_623 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %236 = cute.get_scalars(%coord_623) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_624 = cute.make_coord(%236) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_625 = cute.get_layout(%view_611) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %237:2 = cute.get_scalars(%lay_625) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@2,1@3)">
      %c64_i32_626 = arith.constant 64 : i32
      %238 = arith.ceildivsi %237#0, %c64_i32_626 : i32
      %c64_i32_627 = arith.constant 64 : i32
      %239 = arith.ceildivsi %237#1, %c64_i32_627 : i32
      %shape_628 = cute.make_shape(%238, %239) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %stride_629 = cute.make_stride() : () -> !cute.stride<"((1@2,1@3),(64@2,64@3))">
      %lay_630 = cute.make_layout(%shape_628, %stride_629) : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">
      %slice_631 = cute.slice(%lay_630, %coord_624) : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">, !cute.coord<"((_,_),(?,_))">
      %idx_632 = cute.crd2idx(%coord_624, %lay_630) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">) -> !cute.int_tuple<"(0,0,?{div=64},0)">
      %iter_633 = cute.get_iter(%view_611) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %tup_634 = cute.add_offset(%iter_633, %idx_632) : (!cute.int_tuple<"(?,?,0,0)">, !cute.int_tuple<"(0,0,?{div=64},0)">) -> !cute.int_tuple<"(?,?,?{div=64},0)">
      %view_635 = cute.make_view(%tup_634, %slice_631) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %iter_636 = cute.get_iter(%view_635) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %e0_637, %e1_638, %e2_639, %e3_640 = cute.get_leaves(%iter_636) : !cute.int_tuple<"(?,?,?{div=64},0)">
      %240 = cute.get_scalars(%e0_637) : !cute.int_tuple<"?">
      %241 = cute.get_scalars(%e1_638) : !cute.int_tuple<"?">
      %242 = cute.get_scalars(%e2_639) : !cute.int_tuple<"?{div=64}">
      %coord_641 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_642 = cute.tiled.copy.partition_S(%4, %view_564, %coord_641) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_643 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_644, %e1_645, %e2_646, %e3_647 = cute.get_leaves(%iter_643) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %243 = cute.get_scalars(%e0_644) : !cute.int_tuple<"?">
      %244 = cute.get_scalars(%e1_645) : !cute.int_tuple<"?">
      %245 = cute.get_scalars(%e2_646) : !cute.int_tuple<"?">
      %246 = cute.get_scalars(%e3_647) : !cute.int_tuple<"?{div=8}">
      %coord_648 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_649 = cute.tiled.copy.partition_S(%4, %view_599, %coord_648) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_650 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_651, %e1_652, %e2_653, %e3_654 = cute.get_leaves(%iter_650) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %247 = cute.get_scalars(%e0_651) : !cute.int_tuple<"?">
      %248 = cute.get_scalars(%e1_652) : !cute.int_tuple<"?">
      %249 = cute.get_scalars(%e2_653) : !cute.int_tuple<"?">
      %250 = cute.get_scalars(%e3_654) : !cute.int_tuple<"?{div=8}">
      %coord_655 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_656 = cute.tiled.copy.partition_S(%4, %view_635, %coord_655) : (!copy_ldgsts, !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %iter_657 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %e0_658, %e1_659, %e2_660, %e3_661 = cute.get_leaves(%iter_657) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %251 = cute.get_scalars(%e0_658) : !cute.int_tuple<"?">
      %252 = cute.get_scalars(%e1_659) : !cute.int_tuple<"?">
      %253 = cute.get_scalars(%e2_660) : !cute.int_tuple<"?">
      %254 = cute.get_scalars(%e3_661) : !cute.int_tuple<"?{div=8}">
      %lay_662 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %255 = cute.get_shape(%lay_662) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_663, %e1_664, %e2_665, %e3_666 = cute.get_leaves(%255) : !cute.shape<"((8,1),4,2)">
      %lay_667 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_668 = cute.size(%lay_667) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_669 = cute.get_leaves(%sz_668) : !cute.int_tuple<"4">
      %lay_670 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_671 = cute.size(%lay_670) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_672 = cute.get_leaves(%sz_671) : !cute.int_tuple<"2">
      %lay_673 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_674 = cute.size(%lay_673) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_675 = cute.get_leaves(%sz_674) : !cute.int_tuple<"2">
      %shape_676 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_677 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_678 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_679 = cute.memref.alloca(%lay_678) : !memref_rmem_i8_
      %iter_680 = cute.get_iter(%rmem_679) : !memref_rmem_i8_
      %iter_681 = cute.get_iter(%rmem_679) : !memref_rmem_i8_
      %lay_682 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
      %256 = cute.get_shape(%lay_682) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_683, %e1_684, %e2_685, %e3_686 = cute.get_leaves(%256) : !cute.shape<"((8,1),4,2)">
      %lay_687 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
      %sz_688 = cute.size(%lay_687) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_689 = cute.get_leaves(%sz_688) : !cute.int_tuple<"4">
      %lay_690 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
      %sz_691 = cute.size(%lay_690) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_692 = cute.get_leaves(%sz_691) : !cute.int_tuple<"2">
      %lay_693 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
      %sz_694 = cute.size(%lay_693) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_695 = cute.get_leaves(%sz_694) : !cute.int_tuple<"2">
      %shape_696 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_697 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_698 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_699 = cute.memref.alloca(%lay_698) : !memref_rmem_i8_
      %iter_700 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
      %iter_701 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
      %lay_702 = cute.get_layout(%rmem_679) : !memref_rmem_i8_
      %257 = cute.get_shape(%lay_702) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_703, %e1_704, %e2_705 = cute.get_leaves(%257) : !cute.shape<"(1,4,2)">
      %coord_706 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_707 = cute.get_layout(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_708 = cute.crd2idx(%coord_706, %lay_707) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_709 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_710 = cute.add_offset(%iter_709, %idx_708) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_711 = cute.make_view(%tup_710) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_712 = cute.get_iter(%view_711) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_713, %e1_714, %e2_715, %e3_716 = cute.get_leaves(%iter_712) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %258 = cute.get_scalars(%e0_713) : !cute.int_tuple<"?">
      %259 = cute.get_scalars(%e1_714) : !cute.int_tuple<"?">
      %260 = cute.get_scalars(%e2_715) : !cute.int_tuple<"?">
      %261 = cute.get_scalars(%e3_716) : !cute.int_tuple<"?{div=8}">
      %iter_717 = cute.get_iter(%view_711) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_718, %e1_719, %e2_720, %e3_721 = cute.get_leaves(%iter_717) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %262 = cute.get_scalars(%e0_718) : !cute.int_tuple<"?">
      %263 = cute.get_scalars(%e1_719) : !cute.int_tuple<"?">
      %264 = cute.get_scalars(%e2_720) : !cute.int_tuple<"?">
      %265 = cute.get_scalars(%e3_721) : !cute.int_tuple<"?{div=8}">
      %iter_722 = cute.get_iter(%view_711) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_723, %e1_724, %e2_725, %e3_726 = cute.get_leaves(%iter_722) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %266 = cute.get_scalars(%e0_723) : !cute.int_tuple<"?">
      %267 = cute.get_scalars(%e1_724) : !cute.int_tuple<"?">
      %268 = cute.get_scalars(%e2_725) : !cute.int_tuple<"?">
      %269 = cute.get_scalars(%e3_726) : !cute.int_tuple<"?{div=8}">
      %lay_727 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %270 = cute.get_shape(%lay_727) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_728, %e1_729, %e2_730, %e3_731 = cute.get_leaves(%270) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_732 = cute.to_int_tuple(%e0_728) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %271 = cute.get_scalars(%itup_732) : !cute.int_tuple<"?">
      %itup_733 = cute.to_int_tuple(%e1_729) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %272 = cute.get_scalars(%itup_733) : !cute.int_tuple<"?">
      %itup_734 = cute.to_int_tuple(%e2_730) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %273 = cute.get_scalars(%itup_734) : !cute.int_tuple<"?">
      %itup_735 = cute.to_int_tuple(%e3_731) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %274 = cute.get_scalars(%itup_735) : !cute.int_tuple<"?{div=8}">
      %coord_736 = cute.make_coord(%e3_726) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_737 = cute.make_coord(%itup_735) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %275 = cute.elem_less(%coord_736, %coord_737) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %276 = arith.extui %275 : i1 to i8
      %coord_738 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_679, %coord_738, %276) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_739 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_740 = cute.get_layout(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_741 = cute.crd2idx(%coord_739, %lay_740) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_742 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_743 = cute.add_offset(%iter_742, %idx_741) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_744 = cute.make_view(%tup_743) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_745 = cute.get_iter(%view_744) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_746, %e1_747, %e2_748, %e3_749 = cute.get_leaves(%iter_745) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %277 = cute.get_scalars(%e0_746) : !cute.int_tuple<"?">
      %278 = cute.get_scalars(%e1_747) : !cute.int_tuple<"?">
      %279 = cute.get_scalars(%e2_748) : !cute.int_tuple<"?">
      %280 = cute.get_scalars(%e3_749) : !cute.int_tuple<"?{div=8}">
      %iter_750 = cute.get_iter(%view_744) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_751, %e1_752, %e2_753, %e3_754 = cute.get_leaves(%iter_750) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %281 = cute.get_scalars(%e0_751) : !cute.int_tuple<"?">
      %282 = cute.get_scalars(%e1_752) : !cute.int_tuple<"?">
      %283 = cute.get_scalars(%e2_753) : !cute.int_tuple<"?">
      %284 = cute.get_scalars(%e3_754) : !cute.int_tuple<"?{div=8}">
      %iter_755 = cute.get_iter(%view_744) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_756, %e1_757, %e2_758, %e3_759 = cute.get_leaves(%iter_755) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %285 = cute.get_scalars(%e0_756) : !cute.int_tuple<"?">
      %286 = cute.get_scalars(%e1_757) : !cute.int_tuple<"?">
      %287 = cute.get_scalars(%e2_758) : !cute.int_tuple<"?">
      %288 = cute.get_scalars(%e3_759) : !cute.int_tuple<"?{div=8}">
      %lay_760 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %289 = cute.get_shape(%lay_760) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_761, %e1_762, %e2_763, %e3_764 = cute.get_leaves(%289) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_765 = cute.to_int_tuple(%e0_761) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %290 = cute.get_scalars(%itup_765) : !cute.int_tuple<"?">
      %itup_766 = cute.to_int_tuple(%e1_762) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %291 = cute.get_scalars(%itup_766) : !cute.int_tuple<"?">
      %itup_767 = cute.to_int_tuple(%e2_763) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %292 = cute.get_scalars(%itup_767) : !cute.int_tuple<"?">
      %itup_768 = cute.to_int_tuple(%e3_764) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %293 = cute.get_scalars(%itup_768) : !cute.int_tuple<"?{div=8}">
      %coord_769 = cute.make_coord(%e3_759) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_770 = cute.make_coord(%itup_768) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %294 = cute.elem_less(%coord_769, %coord_770) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %295 = arith.extui %294 : i1 to i8
      %coord_771 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_679, %coord_771, %295) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_772 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
      %296 = cute.get_shape(%lay_772) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_773, %e1_774, %e2_775 = cute.get_leaves(%296) : !cute.shape<"(1,4,2)">
      %coord_776 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_777 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_778 = cute.crd2idx(%coord_776, %lay_777) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_779 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_780 = cute.add_offset(%iter_779, %idx_778) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_781 = cute.make_view(%tup_780) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_782 = cute.get_iter(%view_781) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_783, %e1_784, %e2_785, %e3_786 = cute.get_leaves(%iter_782) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %297 = cute.get_scalars(%e0_783) : !cute.int_tuple<"?">
      %298 = cute.get_scalars(%e1_784) : !cute.int_tuple<"?">
      %299 = cute.get_scalars(%e2_785) : !cute.int_tuple<"?">
      %300 = cute.get_scalars(%e3_786) : !cute.int_tuple<"?{div=8}">
      %iter_787 = cute.get_iter(%view_781) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_788, %e1_789, %e2_790, %e3_791 = cute.get_leaves(%iter_787) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %301 = cute.get_scalars(%e0_788) : !cute.int_tuple<"?">
      %302 = cute.get_scalars(%e1_789) : !cute.int_tuple<"?">
      %303 = cute.get_scalars(%e2_790) : !cute.int_tuple<"?">
      %304 = cute.get_scalars(%e3_791) : !cute.int_tuple<"?{div=8}">
      %iter_792 = cute.get_iter(%view_781) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_793, %e1_794, %e2_795, %e3_796 = cute.get_leaves(%iter_792) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %305 = cute.get_scalars(%e0_793) : !cute.int_tuple<"?">
      %306 = cute.get_scalars(%e1_794) : !cute.int_tuple<"?">
      %307 = cute.get_scalars(%e2_795) : !cute.int_tuple<"?">
      %308 = cute.get_scalars(%e3_796) : !cute.int_tuple<"?{div=8}">
      %lay_797 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %309 = cute.get_shape(%lay_797) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_798, %e1_799, %e2_800, %e3_801 = cute.get_leaves(%309) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_802 = cute.to_int_tuple(%e0_798) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %310 = cute.get_scalars(%itup_802) : !cute.int_tuple<"?">
      %itup_803 = cute.to_int_tuple(%e1_799) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %311 = cute.get_scalars(%itup_803) : !cute.int_tuple<"?">
      %itup_804 = cute.to_int_tuple(%e2_800) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %312 = cute.get_scalars(%itup_804) : !cute.int_tuple<"?">
      %itup_805 = cute.to_int_tuple(%e3_801) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %313 = cute.get_scalars(%itup_805) : !cute.int_tuple<"?{div=8}">
      %coord_806 = cute.make_coord(%e3_796) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_807 = cute.make_coord(%itup_805) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %314 = cute.elem_less(%coord_806, %coord_807) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %315 = arith.extui %314 : i1 to i8
      %coord_808 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_699, %coord_808, %315) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_809 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_810 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_811 = cute.crd2idx(%coord_809, %lay_810) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_812 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_813 = cute.add_offset(%iter_812, %idx_811) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_814 = cute.make_view(%tup_813) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_815 = cute.get_iter(%view_814) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_816, %e1_817, %e2_818, %e3_819 = cute.get_leaves(%iter_815) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %316 = cute.get_scalars(%e0_816) : !cute.int_tuple<"?">
      %317 = cute.get_scalars(%e1_817) : !cute.int_tuple<"?">
      %318 = cute.get_scalars(%e2_818) : !cute.int_tuple<"?">
      %319 = cute.get_scalars(%e3_819) : !cute.int_tuple<"?{div=8}">
      %iter_820 = cute.get_iter(%view_814) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_821, %e1_822, %e2_823, %e3_824 = cute.get_leaves(%iter_820) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %320 = cute.get_scalars(%e0_821) : !cute.int_tuple<"?">
      %321 = cute.get_scalars(%e1_822) : !cute.int_tuple<"?">
      %322 = cute.get_scalars(%e2_823) : !cute.int_tuple<"?">
      %323 = cute.get_scalars(%e3_824) : !cute.int_tuple<"?{div=8}">
      %iter_825 = cute.get_iter(%view_814) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_826, %e1_827, %e2_828, %e3_829 = cute.get_leaves(%iter_825) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %324 = cute.get_scalars(%e0_826) : !cute.int_tuple<"?">
      %325 = cute.get_scalars(%e1_827) : !cute.int_tuple<"?">
      %326 = cute.get_scalars(%e2_828) : !cute.int_tuple<"?">
      %327 = cute.get_scalars(%e3_829) : !cute.int_tuple<"?{div=8}">
      %lay_830 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %328 = cute.get_shape(%lay_830) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_831, %e1_832, %e2_833, %e3_834 = cute.get_leaves(%328) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_835 = cute.to_int_tuple(%e0_831) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %329 = cute.get_scalars(%itup_835) : !cute.int_tuple<"?">
      %itup_836 = cute.to_int_tuple(%e1_832) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %330 = cute.get_scalars(%itup_836) : !cute.int_tuple<"?">
      %itup_837 = cute.to_int_tuple(%e2_833) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %331 = cute.get_scalars(%itup_837) : !cute.int_tuple<"?">
      %itup_838 = cute.to_int_tuple(%e3_834) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %332 = cute.get_scalars(%itup_838) : !cute.int_tuple<"?{div=8}">
      %coord_839 = cute.make_coord(%e3_829) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_840 = cute.make_coord(%itup_838) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %333 = cute.elem_less(%coord_839, %coord_840) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %334 = arith.extui %333 : i1 to i8
      %coord_841 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_699, %coord_841, %334) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_842 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_843 = cute.size(%int_tuple_842) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_844 = cute.get_leaves(%sz_843) : !cute.int_tuple<"4">
      %coord_845 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_846 = cute.get_layout(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_847 = cute.crd2idx(%coord_845, %lay_846) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_848 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_849 = cute.add_offset(%iter_848, %idx_847) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_850 = cute.make_view(%tup_849) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_851 = cute.get_iter(%view_850) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_852, %e1_853, %e2_854, %e3_855 = cute.get_leaves(%iter_851) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %335 = cute.get_scalars(%e0_852) : !cute.int_tuple<"?">
      %336 = cute.get_scalars(%e1_853) : !cute.int_tuple<"?">
      %337 = cute.get_scalars(%e2_854) : !cute.int_tuple<"?">
      %338 = cute.get_scalars(%e3_855) : !cute.int_tuple<"?{div=8}">
      %iter_856 = cute.get_iter(%view_850) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_857, %e1_858, %e2_859, %e3_860 = cute.get_leaves(%iter_856) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %339 = cute.get_scalars(%e0_857) : !cute.int_tuple<"?">
      %340 = cute.get_scalars(%e1_858) : !cute.int_tuple<"?">
      %341 = cute.get_scalars(%e2_859) : !cute.int_tuple<"?">
      %342 = cute.get_scalars(%e3_860) : !cute.int_tuple<"?{div=8}">
      %iter_861 = cute.get_iter(%view_850) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_862, %e1_863, %e2_864, %e3_865 = cute.get_leaves(%iter_861) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %343 = cute.get_scalars(%e0_862) : !cute.int_tuple<"?">
      %344 = cute.get_scalars(%e1_863) : !cute.int_tuple<"?">
      %345 = cute.get_scalars(%e2_864) : !cute.int_tuple<"?">
      %346 = cute.get_scalars(%e3_865) : !cute.int_tuple<"?{div=8}">
      %lay_866 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %347 = cute.get_shape(%lay_866) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_867, %e1_868, %e2_869, %e3_870 = cute.get_leaves(%347) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_871 = cute.to_int_tuple(%e0_867) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %348 = cute.get_scalars(%itup_871) : !cute.int_tuple<"?">
      %itup_872 = cute.to_int_tuple(%e1_868) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %349 = cute.get_scalars(%itup_872) : !cute.int_tuple<"?">
      %itup_873 = cute.to_int_tuple(%e2_869) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %350 = cute.get_scalars(%itup_873) : !cute.int_tuple<"?">
      %itup_874 = cute.to_int_tuple(%e3_870) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %351 = cute.get_scalars(%itup_874) : !cute.int_tuple<"?{div=8}">
      %coord_875 = cute.make_coord(%e1_863) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_876 = cute.make_coord(%itup_872) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %352 = cute.elem_less(%coord_875, %coord_876) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %352 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2085 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2087 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2095 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2101 = cute.get_layout(%rmem_679) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_679) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2087 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %coord_877 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_878 = cute.get_layout(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_879 = cute.crd2idx(%coord_877, %lay_878) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_880 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_881 = cute.add_offset(%iter_880, %idx_879) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_882 = cute.make_view(%tup_881) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_883 = cute.get_iter(%view_882) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_884, %e1_885, %e2_886, %e3_887 = cute.get_leaves(%iter_883) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %353 = cute.get_scalars(%e0_884) : !cute.int_tuple<"?">
      %354 = cute.get_scalars(%e1_885) : !cute.int_tuple<"?">
      %355 = cute.get_scalars(%e2_886) : !cute.int_tuple<"?">
      %356 = cute.get_scalars(%e3_887) : !cute.int_tuple<"?{div=8}">
      %iter_888 = cute.get_iter(%view_882) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_889, %e1_890, %e2_891, %e3_892 = cute.get_leaves(%iter_888) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %357 = cute.get_scalars(%e0_889) : !cute.int_tuple<"?">
      %358 = cute.get_scalars(%e1_890) : !cute.int_tuple<"?">
      %359 = cute.get_scalars(%e2_891) : !cute.int_tuple<"?">
      %360 = cute.get_scalars(%e3_892) : !cute.int_tuple<"?{div=8}">
      %iter_893 = cute.get_iter(%view_882) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_894, %e1_895, %e2_896, %e3_897 = cute.get_leaves(%iter_893) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %361 = cute.get_scalars(%e0_894) : !cute.int_tuple<"?">
      %362 = cute.get_scalars(%e1_895) : !cute.int_tuple<"?">
      %363 = cute.get_scalars(%e2_896) : !cute.int_tuple<"?">
      %364 = cute.get_scalars(%e3_897) : !cute.int_tuple<"?{div=8}">
      %lay_898 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %365 = cute.get_shape(%lay_898) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_899, %e1_900, %e2_901, %e3_902 = cute.get_leaves(%365) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_903 = cute.to_int_tuple(%e0_899) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %366 = cute.get_scalars(%itup_903) : !cute.int_tuple<"?">
      %itup_904 = cute.to_int_tuple(%e1_900) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %367 = cute.get_scalars(%itup_904) : !cute.int_tuple<"?">
      %itup_905 = cute.to_int_tuple(%e2_901) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %368 = cute.get_scalars(%itup_905) : !cute.int_tuple<"?">
      %itup_906 = cute.to_int_tuple(%e3_902) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %369 = cute.get_scalars(%itup_906) : !cute.int_tuple<"?{div=8}">
      %coord_907 = cute.make_coord(%e1_895) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_908 = cute.make_coord(%itup_904) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %370 = cute.elem_less(%coord_907, %coord_908) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %370 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2085 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2087 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2095 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2101 = cute.get_layout(%rmem_679) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_679) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2087 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %coord_909 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_910 = cute.get_layout(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_911 = cute.crd2idx(%coord_909, %lay_910) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_912 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_913 = cute.add_offset(%iter_912, %idx_911) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_914 = cute.make_view(%tup_913) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_915 = cute.get_iter(%view_914) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_916, %e1_917, %e2_918, %e3_919 = cute.get_leaves(%iter_915) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %371 = cute.get_scalars(%e0_916) : !cute.int_tuple<"?">
      %372 = cute.get_scalars(%e1_917) : !cute.int_tuple<"?">
      %373 = cute.get_scalars(%e2_918) : !cute.int_tuple<"?">
      %374 = cute.get_scalars(%e3_919) : !cute.int_tuple<"?{div=8}">
      %iter_920 = cute.get_iter(%view_914) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_921, %e1_922, %e2_923, %e3_924 = cute.get_leaves(%iter_920) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %375 = cute.get_scalars(%e0_921) : !cute.int_tuple<"?">
      %376 = cute.get_scalars(%e1_922) : !cute.int_tuple<"?">
      %377 = cute.get_scalars(%e2_923) : !cute.int_tuple<"?">
      %378 = cute.get_scalars(%e3_924) : !cute.int_tuple<"?{div=8}">
      %iter_925 = cute.get_iter(%view_914) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_926, %e1_927, %e2_928, %e3_929 = cute.get_leaves(%iter_925) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %379 = cute.get_scalars(%e0_926) : !cute.int_tuple<"?">
      %380 = cute.get_scalars(%e1_927) : !cute.int_tuple<"?">
      %381 = cute.get_scalars(%e2_928) : !cute.int_tuple<"?">
      %382 = cute.get_scalars(%e3_929) : !cute.int_tuple<"?{div=8}">
      %lay_930 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %383 = cute.get_shape(%lay_930) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_931, %e1_932, %e2_933, %e3_934 = cute.get_leaves(%383) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_935 = cute.to_int_tuple(%e0_931) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %384 = cute.get_scalars(%itup_935) : !cute.int_tuple<"?">
      %itup_936 = cute.to_int_tuple(%e1_932) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %385 = cute.get_scalars(%itup_936) : !cute.int_tuple<"?">
      %itup_937 = cute.to_int_tuple(%e2_933) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %386 = cute.get_scalars(%itup_937) : !cute.int_tuple<"?">
      %itup_938 = cute.to_int_tuple(%e3_934) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %387 = cute.get_scalars(%itup_938) : !cute.int_tuple<"?{div=8}">
      %coord_939 = cute.make_coord(%e1_927) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_940 = cute.make_coord(%itup_936) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %388 = cute.elem_less(%coord_939, %coord_940) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %388 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2085 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2087 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2095 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2101 = cute.get_layout(%rmem_679) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_679) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2087 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %coord_941 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_942 = cute.get_layout(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_943 = cute.crd2idx(%coord_941, %lay_942) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_944 = cute.get_iter(%src_partitioned_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_945 = cute.add_offset(%iter_944, %idx_943) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_946 = cute.make_view(%tup_945) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_947 = cute.get_iter(%view_946) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_948, %e1_949, %e2_950, %e3_951 = cute.get_leaves(%iter_947) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %389 = cute.get_scalars(%e0_948) : !cute.int_tuple<"?">
      %390 = cute.get_scalars(%e1_949) : !cute.int_tuple<"?">
      %391 = cute.get_scalars(%e2_950) : !cute.int_tuple<"?">
      %392 = cute.get_scalars(%e3_951) : !cute.int_tuple<"?{div=8}">
      %iter_952 = cute.get_iter(%view_946) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_953, %e1_954, %e2_955, %e3_956 = cute.get_leaves(%iter_952) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %393 = cute.get_scalars(%e0_953) : !cute.int_tuple<"?">
      %394 = cute.get_scalars(%e1_954) : !cute.int_tuple<"?">
      %395 = cute.get_scalars(%e2_955) : !cute.int_tuple<"?">
      %396 = cute.get_scalars(%e3_956) : !cute.int_tuple<"?{div=8}">
      %iter_957 = cute.get_iter(%view_946) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_958, %e1_959, %e2_960, %e3_961 = cute.get_leaves(%iter_957) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %397 = cute.get_scalars(%e0_958) : !cute.int_tuple<"?">
      %398 = cute.get_scalars(%e1_959) : !cute.int_tuple<"?">
      %399 = cute.get_scalars(%e2_960) : !cute.int_tuple<"?">
      %400 = cute.get_scalars(%e3_961) : !cute.int_tuple<"?{div=8}">
      %lay_962 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %401 = cute.get_shape(%lay_962) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_963, %e1_964, %e2_965, %e3_966 = cute.get_leaves(%401) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_967 = cute.to_int_tuple(%e0_963) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %402 = cute.get_scalars(%itup_967) : !cute.int_tuple<"?">
      %itup_968 = cute.to_int_tuple(%e1_964) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %403 = cute.get_scalars(%itup_968) : !cute.int_tuple<"?">
      %itup_969 = cute.to_int_tuple(%e2_965) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %404 = cute.get_scalars(%itup_969) : !cute.int_tuple<"?">
      %itup_970 = cute.to_int_tuple(%e3_966) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %405 = cute.get_scalars(%itup_970) : !cute.int_tuple<"?{div=8}">
      %coord_971 = cute.make_coord(%e1_959) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_972 = cute.make_coord(%itup_968) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %406 = cute.elem_less(%coord_971, %coord_972) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %406 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2085 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_5
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2087 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_5
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2095 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2101 = cute.get_layout(%rmem_679) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_679) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2087 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %int_tuple_973 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_974 = cute.size(%int_tuple_973) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_975 = cute.get_leaves(%sz_974) : !cute.int_tuple<"4">
      %coord_976 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_977 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_978 = cute.crd2idx(%coord_976, %lay_977) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_979 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_980 = cute.add_offset(%iter_979, %idx_978) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_981 = cute.make_view(%tup_980) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_982 = cute.get_iter(%view_981) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_983, %e1_984, %e2_985, %e3_986 = cute.get_leaves(%iter_982) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %407 = cute.get_scalars(%e0_983) : !cute.int_tuple<"?">
      %408 = cute.get_scalars(%e1_984) : !cute.int_tuple<"?">
      %409 = cute.get_scalars(%e2_985) : !cute.int_tuple<"?">
      %410 = cute.get_scalars(%e3_986) : !cute.int_tuple<"?{div=8}">
      %iter_987 = cute.get_iter(%view_981) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_988, %e1_989, %e2_990, %e3_991 = cute.get_leaves(%iter_987) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %411 = cute.get_scalars(%e0_988) : !cute.int_tuple<"?">
      %412 = cute.get_scalars(%e1_989) : !cute.int_tuple<"?">
      %413 = cute.get_scalars(%e2_990) : !cute.int_tuple<"?">
      %414 = cute.get_scalars(%e3_991) : !cute.int_tuple<"?{div=8}">
      %iter_992 = cute.get_iter(%view_981) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_993, %e1_994, %e2_995, %e3_996 = cute.get_leaves(%iter_992) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %415 = cute.get_scalars(%e0_993) : !cute.int_tuple<"?">
      %416 = cute.get_scalars(%e1_994) : !cute.int_tuple<"?">
      %417 = cute.get_scalars(%e2_995) : !cute.int_tuple<"?">
      %418 = cute.get_scalars(%e3_996) : !cute.int_tuple<"?{div=8}">
      %lay_997 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %419 = cute.get_shape(%lay_997) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_998, %e1_999, %e2_1000, %e3_1001 = cute.get_leaves(%419) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1002 = cute.to_int_tuple(%e0_998) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %420 = cute.get_scalars(%itup_1002) : !cute.int_tuple<"?">
      %itup_1003 = cute.to_int_tuple(%e1_999) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %421 = cute.get_scalars(%itup_1003) : !cute.int_tuple<"?">
      %itup_1004 = cute.to_int_tuple(%e2_1000) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %422 = cute.get_scalars(%itup_1004) : !cute.int_tuple<"?">
      %itup_1005 = cute.to_int_tuple(%e3_1001) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %423 = cute.get_scalars(%itup_1005) : !cute.int_tuple<"?{div=8}">
      %coord_1006 = cute.make_coord(%e1_994) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1007 = cute.make_coord(%itup_1003) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %424 = cute.elem_less(%coord_1006, %coord_1007) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %424 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_371) : !memref_gmem_bf16_6
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_2087 = cute.get_iter(%src_partitioned_371) : !memref_gmem_bf16_6
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2095 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2101 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2087 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %coord_1008 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1009 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1010 = cute.crd2idx(%coord_1008, %lay_1009) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1011 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1012 = cute.add_offset(%iter_1011, %idx_1010) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1013 = cute.make_view(%tup_1012) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1014 = cute.get_iter(%view_1013) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1015, %e1_1016, %e2_1017, %e3_1018 = cute.get_leaves(%iter_1014) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %425 = cute.get_scalars(%e0_1015) : !cute.int_tuple<"?">
      %426 = cute.get_scalars(%e1_1016) : !cute.int_tuple<"?">
      %427 = cute.get_scalars(%e2_1017) : !cute.int_tuple<"?">
      %428 = cute.get_scalars(%e3_1018) : !cute.int_tuple<"?{div=8}">
      %iter_1019 = cute.get_iter(%view_1013) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1020, %e1_1021, %e2_1022, %e3_1023 = cute.get_leaves(%iter_1019) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %429 = cute.get_scalars(%e0_1020) : !cute.int_tuple<"?">
      %430 = cute.get_scalars(%e1_1021) : !cute.int_tuple<"?">
      %431 = cute.get_scalars(%e2_1022) : !cute.int_tuple<"?">
      %432 = cute.get_scalars(%e3_1023) : !cute.int_tuple<"?{div=8}">
      %iter_1024 = cute.get_iter(%view_1013) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1025, %e1_1026, %e2_1027, %e3_1028 = cute.get_leaves(%iter_1024) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %433 = cute.get_scalars(%e0_1025) : !cute.int_tuple<"?">
      %434 = cute.get_scalars(%e1_1026) : !cute.int_tuple<"?">
      %435 = cute.get_scalars(%e2_1027) : !cute.int_tuple<"?">
      %436 = cute.get_scalars(%e3_1028) : !cute.int_tuple<"?{div=8}">
      %lay_1029 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %437 = cute.get_shape(%lay_1029) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1030, %e1_1031, %e2_1032, %e3_1033 = cute.get_leaves(%437) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1034 = cute.to_int_tuple(%e0_1030) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %438 = cute.get_scalars(%itup_1034) : !cute.int_tuple<"?">
      %itup_1035 = cute.to_int_tuple(%e1_1031) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %439 = cute.get_scalars(%itup_1035) : !cute.int_tuple<"?">
      %itup_1036 = cute.to_int_tuple(%e2_1032) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %440 = cute.get_scalars(%itup_1036) : !cute.int_tuple<"?">
      %itup_1037 = cute.to_int_tuple(%e3_1033) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %441 = cute.get_scalars(%itup_1037) : !cute.int_tuple<"?{div=8}">
      %coord_1038 = cute.make_coord(%e1_1026) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1039 = cute.make_coord(%itup_1035) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %442 = cute.elem_less(%coord_1038, %coord_1039) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %442 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_371) : !memref_gmem_bf16_6
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2087 = cute.get_iter(%src_partitioned_371) : !memref_gmem_bf16_6
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2095 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2101 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2087 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %coord_1040 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1041 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1042 = cute.crd2idx(%coord_1040, %lay_1041) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1043 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1044 = cute.add_offset(%iter_1043, %idx_1042) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1045 = cute.make_view(%tup_1044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1046 = cute.get_iter(%view_1045) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1047, %e1_1048, %e2_1049, %e3_1050 = cute.get_leaves(%iter_1046) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %443 = cute.get_scalars(%e0_1047) : !cute.int_tuple<"?">
      %444 = cute.get_scalars(%e1_1048) : !cute.int_tuple<"?">
      %445 = cute.get_scalars(%e2_1049) : !cute.int_tuple<"?">
      %446 = cute.get_scalars(%e3_1050) : !cute.int_tuple<"?{div=8}">
      %iter_1051 = cute.get_iter(%view_1045) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1052, %e1_1053, %e2_1054, %e3_1055 = cute.get_leaves(%iter_1051) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %447 = cute.get_scalars(%e0_1052) : !cute.int_tuple<"?">
      %448 = cute.get_scalars(%e1_1053) : !cute.int_tuple<"?">
      %449 = cute.get_scalars(%e2_1054) : !cute.int_tuple<"?">
      %450 = cute.get_scalars(%e3_1055) : !cute.int_tuple<"?{div=8}">
      %iter_1056 = cute.get_iter(%view_1045) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1057, %e1_1058, %e2_1059, %e3_1060 = cute.get_leaves(%iter_1056) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %451 = cute.get_scalars(%e0_1057) : !cute.int_tuple<"?">
      %452 = cute.get_scalars(%e1_1058) : !cute.int_tuple<"?">
      %453 = cute.get_scalars(%e2_1059) : !cute.int_tuple<"?">
      %454 = cute.get_scalars(%e3_1060) : !cute.int_tuple<"?{div=8}">
      %lay_1061 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %455 = cute.get_shape(%lay_1061) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1062, %e1_1063, %e2_1064, %e3_1065 = cute.get_leaves(%455) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1066 = cute.to_int_tuple(%e0_1062) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %456 = cute.get_scalars(%itup_1066) : !cute.int_tuple<"?">
      %itup_1067 = cute.to_int_tuple(%e1_1063) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %457 = cute.get_scalars(%itup_1067) : !cute.int_tuple<"?">
      %itup_1068 = cute.to_int_tuple(%e2_1064) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %458 = cute.get_scalars(%itup_1068) : !cute.int_tuple<"?">
      %itup_1069 = cute.to_int_tuple(%e3_1065) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %459 = cute.get_scalars(%itup_1069) : !cute.int_tuple<"?{div=8}">
      %coord_1070 = cute.make_coord(%e1_1058) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1071 = cute.make_coord(%itup_1067) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %460 = cute.elem_less(%coord_1070, %coord_1071) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %460 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_371) : !memref_gmem_bf16_6
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2087 = cute.get_iter(%src_partitioned_371) : !memref_gmem_bf16_6
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2095 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2101 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2087 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %coord_1072 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1073 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1074 = cute.crd2idx(%coord_1072, %lay_1073) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1075 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1076 = cute.add_offset(%iter_1075, %idx_1074) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1077 = cute.make_view(%tup_1076) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1078 = cute.get_iter(%view_1077) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1079, %e1_1080, %e2_1081, %e3_1082 = cute.get_leaves(%iter_1078) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %461 = cute.get_scalars(%e0_1079) : !cute.int_tuple<"?">
      %462 = cute.get_scalars(%e1_1080) : !cute.int_tuple<"?">
      %463 = cute.get_scalars(%e2_1081) : !cute.int_tuple<"?">
      %464 = cute.get_scalars(%e3_1082) : !cute.int_tuple<"?{div=8}">
      %iter_1083 = cute.get_iter(%view_1077) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1084, %e1_1085, %e2_1086, %e3_1087 = cute.get_leaves(%iter_1083) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %465 = cute.get_scalars(%e0_1084) : !cute.int_tuple<"?">
      %466 = cute.get_scalars(%e1_1085) : !cute.int_tuple<"?">
      %467 = cute.get_scalars(%e2_1086) : !cute.int_tuple<"?">
      %468 = cute.get_scalars(%e3_1087) : !cute.int_tuple<"?{div=8}">
      %iter_1088 = cute.get_iter(%view_1077) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1089, %e1_1090, %e2_1091, %e3_1092 = cute.get_leaves(%iter_1088) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %469 = cute.get_scalars(%e0_1089) : !cute.int_tuple<"?">
      %470 = cute.get_scalars(%e1_1090) : !cute.int_tuple<"?">
      %471 = cute.get_scalars(%e2_1091) : !cute.int_tuple<"?">
      %472 = cute.get_scalars(%e3_1092) : !cute.int_tuple<"?{div=8}">
      %lay_1093 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %473 = cute.get_shape(%lay_1093) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1094, %e1_1095, %e2_1096, %e3_1097 = cute.get_leaves(%473) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1098 = cute.to_int_tuple(%e0_1094) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %474 = cute.get_scalars(%itup_1098) : !cute.int_tuple<"?">
      %itup_1099 = cute.to_int_tuple(%e1_1095) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %475 = cute.get_scalars(%itup_1099) : !cute.int_tuple<"?">
      %itup_1100 = cute.to_int_tuple(%e2_1096) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %476 = cute.get_scalars(%itup_1100) : !cute.int_tuple<"?">
      %itup_1101 = cute.to_int_tuple(%e3_1097) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %477 = cute.get_scalars(%itup_1101) : !cute.int_tuple<"?{div=8}">
      %coord_1102 = cute.make_coord(%e1_1090) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1103 = cute.make_coord(%itup_1099) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %478 = cute.elem_less(%coord_1102, %coord_1103) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %478 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_371) : !memref_gmem_bf16_6
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2087 = cute.get_iter(%src_partitioned_371) : !memref_gmem_bf16_6
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_8
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_8
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2095 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_12
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_12
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2101 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_gmem_bf16_8
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_gmem_bf16_8
        %iter_2121 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %lay_2122 = cute.get_layout(%view_2120) : !memref_gmem_bf16_8
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_gmem_bf16_8
        %view_2127 = cute.make_view(%iter_2126) : !memref_gmem_bf16_9
        %iter_2128 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2129 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %lay_2130 = cute.get_layout(%view_2097) : !memref_smem_bf16_12
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_smem_bf16_12
        %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %lay_2136 = cute.get_layout(%view_2134) : !memref_smem_bf16_12
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_smem_bf16_12
        %view_2141 = cute.make_view(%iter_2140) : !memref_smem_bf16_13
        %iter_2142 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %iter_2143 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_gmem_bf16_9
        %iter_2172 = cute.get_iter(%view_2141) : !memref_smem_bf16_13
        %lay_2173 = cute.get_layout(%view_2127) : !memref_gmem_bf16_9
        %lay_2174 = cute.get_layout(%view_2141) : !memref_smem_bf16_13
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_gmem_bf16_10
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_smem_bf16_14
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%4, %view_2190, %view_2194, %view_2198) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2085 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2087 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_12
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_12
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"16">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_12
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2096, %e1_2097, %e2_2098 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %int_tuple_2099 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_2100 = cute.tuple.product(%int_tuple_2099) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2101 = cute.get_leaves(%res_2100) : !cute.int_tuple<"16">
        %cst_2102 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2102 : vector<16xbf16>
        %int_tuple_2103 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2104 = cute.size(%int_tuple_2103) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2105 = cute.get_leaves(%sz_2104) : !cute.int_tuple<"16">
        %int_tuple_2106 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2107 = cute.size(%int_tuple_2106) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2108 = cute.get_leaves(%sz_2107) : !cute.int_tuple<"16">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_12
      }
      %lay_1104 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %479 = cute.get_shape(%lay_1104) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
      %e0_1105, %e1_1106, %e2_1107, %e3_1108, %e4_1109 = cute.get_leaves(%479) : !cute.shape<"((8,1),4,1,?)">
      %itup_1110 = cute.to_int_tuple(%e4_1109) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %480 = cute.get_scalars(%itup_1110) : !cute.int_tuple<"?">
      %int_tuple_1111 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1112 = cute.size(%int_tuple_1111) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1113 = cute.get_leaves(%sz_1112) : !cute.int_tuple<"4">
      %int_tuple_1114 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1115 = cute.size(%int_tuple_1114) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1116 = cute.get_leaves(%sz_1115) : !cute.int_tuple<"1">
      %coord_1117 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1118 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1119 = cute.crd2idx(%coord_1117, %lay_1118) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1120 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1121 = cute.add_offset(%iter_1120, %idx_1119) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1122 = cute.make_view(%tup_1121) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1123 = cute.get_iter(%view_1122) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1124, %e1_1125, %e2_1126, %e3_1127 = cute.get_leaves(%iter_1123) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %481 = cute.get_scalars(%e0_1124) : !cute.int_tuple<"?">
      %482 = cute.get_scalars(%e1_1125) : !cute.int_tuple<"?">
      %483 = cute.get_scalars(%e2_1126) : !cute.int_tuple<"?">
      %484 = cute.get_scalars(%e3_1127) : !cute.int_tuple<"?{div=8}">
      %iter_1128 = cute.get_iter(%view_1122) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1129, %e1_1130, %e2_1131, %e3_1132 = cute.get_leaves(%iter_1128) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %485 = cute.get_scalars(%e0_1129) : !cute.int_tuple<"?">
      %486 = cute.get_scalars(%e1_1130) : !cute.int_tuple<"?">
      %487 = cute.get_scalars(%e2_1131) : !cute.int_tuple<"?">
      %488 = cute.get_scalars(%e3_1132) : !cute.int_tuple<"?{div=8}">
      %iter_1133 = cute.get_iter(%view_1122) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1134, %e1_1135, %e2_1136, %e3_1137 = cute.get_leaves(%iter_1133) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %489 = cute.get_scalars(%e0_1134) : !cute.int_tuple<"?">
      %490 = cute.get_scalars(%e1_1135) : !cute.int_tuple<"?">
      %491 = cute.get_scalars(%e2_1136) : !cute.int_tuple<"?">
      %492 = cute.get_scalars(%e3_1137) : !cute.int_tuple<"?{div=8}">
      %lay_1138 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %493 = cute.get_shape(%lay_1138) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1139, %e1_1140, %e2_1141, %e3_1142 = cute.get_leaves(%493) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1143 = cute.to_int_tuple(%e0_1139) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %494 = cute.get_scalars(%itup_1143) : !cute.int_tuple<"?">
      %itup_1144 = cute.to_int_tuple(%e1_1140) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %495 = cute.get_scalars(%itup_1144) : !cute.int_tuple<"?">
      %itup_1145 = cute.to_int_tuple(%e2_1141) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %496 = cute.get_scalars(%itup_1145) : !cute.int_tuple<"?">
      %itup_1146 = cute.to_int_tuple(%e3_1142) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %497 = cute.get_scalars(%itup_1146) : !cute.int_tuple<"?{div=8}">
      %coord_1147 = cute.make_coord(%e1_1135) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1148 = cute.make_coord(%itup_1145) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %498 = cute.elem_less(%coord_1147, %coord_1148) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1149 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1150 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1151 = cute.crd2idx(%coord_1149, %lay_1150) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1152 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1153 = cute.add_offset(%iter_1152, %idx_1151) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1154 = cute.make_view(%tup_1153) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1155 = cute.get_iter(%view_1154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1156, %e1_1157, %e2_1158, %e3_1159 = cute.get_leaves(%iter_1155) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %499 = cute.get_scalars(%e0_1156) : !cute.int_tuple<"?">
      %500 = cute.get_scalars(%e1_1157) : !cute.int_tuple<"?">
      %501 = cute.get_scalars(%e2_1158) : !cute.int_tuple<"?">
      %502 = cute.get_scalars(%e3_1159) : !cute.int_tuple<"?{div=8}">
      %iter_1160 = cute.get_iter(%view_1154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1161, %e1_1162, %e2_1163, %e3_1164 = cute.get_leaves(%iter_1160) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %503 = cute.get_scalars(%e0_1161) : !cute.int_tuple<"?">
      %504 = cute.get_scalars(%e1_1162) : !cute.int_tuple<"?">
      %505 = cute.get_scalars(%e2_1163) : !cute.int_tuple<"?">
      %506 = cute.get_scalars(%e3_1164) : !cute.int_tuple<"?{div=8}">
      %iter_1165 = cute.get_iter(%view_1154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1166, %e1_1167, %e2_1168, %e3_1169 = cute.get_leaves(%iter_1165) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %507 = cute.get_scalars(%e0_1166) : !cute.int_tuple<"?">
      %508 = cute.get_scalars(%e1_1167) : !cute.int_tuple<"?">
      %509 = cute.get_scalars(%e2_1168) : !cute.int_tuple<"?">
      %510 = cute.get_scalars(%e3_1169) : !cute.int_tuple<"?{div=8}">
      %lay_1170 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %511 = cute.get_shape(%lay_1170) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1171, %e1_1172, %e2_1173, %e3_1174 = cute.get_leaves(%511) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1175 = cute.to_int_tuple(%e0_1171) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %512 = cute.get_scalars(%itup_1175) : !cute.int_tuple<"?">
      %itup_1176 = cute.to_int_tuple(%e1_1172) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %513 = cute.get_scalars(%itup_1176) : !cute.int_tuple<"?">
      %itup_1177 = cute.to_int_tuple(%e2_1173) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %514 = cute.get_scalars(%itup_1177) : !cute.int_tuple<"?">
      %itup_1178 = cute.to_int_tuple(%e3_1174) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %515 = cute.get_scalars(%itup_1178) : !cute.int_tuple<"?{div=8}">
      %coord_1179 = cute.make_coord(%e1_1167) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1180 = cute.make_coord(%itup_1177) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %516 = cute.elem_less(%coord_1179, %coord_1180) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1181 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1182 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1183 = cute.crd2idx(%coord_1181, %lay_1182) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1184 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1185 = cute.add_offset(%iter_1184, %idx_1183) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1186 = cute.make_view(%tup_1185) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1187 = cute.get_iter(%view_1186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1188, %e1_1189, %e2_1190, %e3_1191 = cute.get_leaves(%iter_1187) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %517 = cute.get_scalars(%e0_1188) : !cute.int_tuple<"?">
      %518 = cute.get_scalars(%e1_1189) : !cute.int_tuple<"?">
      %519 = cute.get_scalars(%e2_1190) : !cute.int_tuple<"?">
      %520 = cute.get_scalars(%e3_1191) : !cute.int_tuple<"?{div=8}">
      %iter_1192 = cute.get_iter(%view_1186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1193, %e1_1194, %e2_1195, %e3_1196 = cute.get_leaves(%iter_1192) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %521 = cute.get_scalars(%e0_1193) : !cute.int_tuple<"?">
      %522 = cute.get_scalars(%e1_1194) : !cute.int_tuple<"?">
      %523 = cute.get_scalars(%e2_1195) : !cute.int_tuple<"?">
      %524 = cute.get_scalars(%e3_1196) : !cute.int_tuple<"?{div=8}">
      %iter_1197 = cute.get_iter(%view_1186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1198, %e1_1199, %e2_1200, %e3_1201 = cute.get_leaves(%iter_1197) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %525 = cute.get_scalars(%e0_1198) : !cute.int_tuple<"?">
      %526 = cute.get_scalars(%e1_1199) : !cute.int_tuple<"?">
      %527 = cute.get_scalars(%e2_1200) : !cute.int_tuple<"?">
      %528 = cute.get_scalars(%e3_1201) : !cute.int_tuple<"?{div=8}">
      %lay_1202 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %529 = cute.get_shape(%lay_1202) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1203, %e1_1204, %e2_1205, %e3_1206 = cute.get_leaves(%529) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1207 = cute.to_int_tuple(%e0_1203) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %530 = cute.get_scalars(%itup_1207) : !cute.int_tuple<"?">
      %itup_1208 = cute.to_int_tuple(%e1_1204) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %531 = cute.get_scalars(%itup_1208) : !cute.int_tuple<"?">
      %itup_1209 = cute.to_int_tuple(%e2_1205) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %532 = cute.get_scalars(%itup_1209) : !cute.int_tuple<"?">
      %itup_1210 = cute.to_int_tuple(%e3_1206) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %533 = cute.get_scalars(%itup_1210) : !cute.int_tuple<"?{div=8}">
      %coord_1211 = cute.make_coord(%e2_1200) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1212 = cute.make_coord(%itup_1210) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %534 = cute.elem_less(%coord_1211, %coord_1212) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %535 = arith.extui %516 : i1 to i32
      %c0_i32 = arith.constant 0 : i32
      %536 = arith.cmpi ne, %535, %c0_i32 : i32
      %537 = arith.extui %516 : i1 to i32
      %538 = arith.extui %534 : i1 to i32
      %539 = arith.select %536, %538, %537 : i32
      %c0_i32_1213 = arith.constant 0 : i32
      %540 = arith.cmpi ne, %539, %c0_i32_1213 : i32
      scf.if %540 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,0,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
        %iter_2087 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_10
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2093 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2095 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_14
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %lay_2100 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %928 = cute.get_shape(%lay_2100) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2101, %e1_2102 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %lay_2103 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %929 = cute.get_shape(%lay_2103) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2104, %e1_2105 = cute.get_leaves(%929) : !cute.shape<"((8,1))">
        %lay_2106 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %shape_2107 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2108 = cute.make_layout() : !cute.layout<"1:0">
        %append_2109 = cute.append_to_rank<2> (%lay_2106, %lay_2108) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2110 = cute.make_view(%iter_2091, %append_2109) : !memref_gmem_bf16_11
        %iter_2111 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %lay_2112 = cute.get_layout(%view_2110) : !memref_gmem_bf16_11
        %930 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%930) : !cute.shape<"((8,1),1)">
        %iter_2116 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %view_2117 = cute.make_view(%iter_2116) : !memref_gmem_bf16_12
        %iter_2118 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2119 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %lay_2120 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %shape_2121 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2122 = cute.make_layout() : !cute.layout<"1:0">
        %append_2123 = cute.append_to_rank<2> (%lay_2120, %lay_2122) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2124 = cute.make_view(%iter_2099, %append_2123) : !memref_smem_bf16_15
        %iter_2125 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %lay_2126 = cute.get_layout(%view_2124) : !memref_smem_bf16_15
        %931 = cute.get_shape(%lay_2126) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2127, %e1_2128, %e2_2129 = cute.get_leaves(%931) : !cute.shape<"((8,1),1)">
        %iter_2130 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %view_2131 = cute.make_view(%iter_2130) : !memref_smem_bf16_16
        %iter_2132 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %iter_2133 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2134 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %932 = cute.get_shape(%lay_2134) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2135, %e1_2136, %e2_2137 = cute.get_leaves(%932) : !cute.shape<"((8,1),(1))">
        %lay_2138 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %933 = cute.get_shape(%lay_2138) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2139, %e1_2140, %e2_2141 = cute.get_leaves(%933) : !cute.shape<"((8,1),(1))">
        %lay_2142 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %sz_2143 = cute.size(%lay_2142) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2144 = cute.get_leaves(%sz_2143) : !cute.int_tuple<"1">
        %lay_2145 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %sz_2146 = cute.size(%lay_2145) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2147 = cute.get_leaves(%sz_2146) : !cute.int_tuple<"1">
        %934 = cute.static : !cute.layout<"1:0">
        %iter_2148 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2149 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2150 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %lay_2151 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %append_2152 = cute.append_to_rank<2> (%lay_2150, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2153 = cute.append_to_rank<2> (%lay_2151, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2155 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2156 = cute.size(%lay_2154) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %935 = cute.get_scalars(%sz_2156) : !cute.int_tuple<"1">
        %c0_i32_2157 = arith.constant 0 : i32
        %c1_i32_2158 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2157 to %935 step %c1_i32_2158  : i32 {
          %coord_2159 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2160 = cute.slice(%lay_2154, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2161 = cute.crd2idx(%coord_2159, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2162 = cute.add_offset(%iter_2148, %idx_2161) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2163 = cute.make_view(%ptr_2162, %slice_2160) : !memref_gmem_bf16_10
          %slice_2164 = cute.slice(%lay_2155, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2165 = cute.crd2idx(%coord_2159, %lay_2155) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2166 = cute.add_offset(%iter_2149, %idx_2165) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2167 = cute.make_view(%ptr_2166, %slice_2164) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2163, %view_2167) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2085 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2087 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_14
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"8">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2096, %e1_2097 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %int_tuple_2098 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2099 = cute.tuple.product(%int_tuple_2098) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2100 = cute.get_leaves(%res_2099) : !cute.int_tuple<"8">
        %cst_2101 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2101 : vector<8xbf16>
        %int_tuple_2102 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2103 = cute.size(%int_tuple_2102) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2104 = cute.get_leaves(%sz_2103) : !cute.int_tuple<"8">
        %int_tuple_2105 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2106 = cute.size(%int_tuple_2105) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2107 = cute.get_leaves(%sz_2106) : !cute.int_tuple<"8">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_14
      }
      %int_tuple_1214 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1215 = cute.size(%int_tuple_1214) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1216 = cute.get_leaves(%sz_1215) : !cute.int_tuple<"1">
      %coord_1217 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1218 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1219 = cute.crd2idx(%coord_1217, %lay_1218) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1220 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1221 = cute.add_offset(%iter_1220, %idx_1219) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1222 = cute.make_view(%tup_1221) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1223 = cute.get_iter(%view_1222) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1224, %e1_1225, %e2_1226, %e3_1227 = cute.get_leaves(%iter_1223) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %541 = cute.get_scalars(%e0_1224) : !cute.int_tuple<"?">
      %542 = cute.get_scalars(%e1_1225) : !cute.int_tuple<"?">
      %543 = cute.get_scalars(%e2_1226) : !cute.int_tuple<"?">
      %544 = cute.get_scalars(%e3_1227) : !cute.int_tuple<"?{div=8}">
      %iter_1228 = cute.get_iter(%view_1222) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1229, %e1_1230, %e2_1231, %e3_1232 = cute.get_leaves(%iter_1228) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %545 = cute.get_scalars(%e0_1229) : !cute.int_tuple<"?">
      %546 = cute.get_scalars(%e1_1230) : !cute.int_tuple<"?">
      %547 = cute.get_scalars(%e2_1231) : !cute.int_tuple<"?">
      %548 = cute.get_scalars(%e3_1232) : !cute.int_tuple<"?{div=8}">
      %iter_1233 = cute.get_iter(%view_1222) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1234, %e1_1235, %e2_1236, %e3_1237 = cute.get_leaves(%iter_1233) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %549 = cute.get_scalars(%e0_1234) : !cute.int_tuple<"?">
      %550 = cute.get_scalars(%e1_1235) : !cute.int_tuple<"?">
      %551 = cute.get_scalars(%e2_1236) : !cute.int_tuple<"?">
      %552 = cute.get_scalars(%e3_1237) : !cute.int_tuple<"?{div=8}">
      %lay_1238 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %553 = cute.get_shape(%lay_1238) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1239, %e1_1240, %e2_1241, %e3_1242 = cute.get_leaves(%553) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1243 = cute.to_int_tuple(%e0_1239) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %554 = cute.get_scalars(%itup_1243) : !cute.int_tuple<"?">
      %itup_1244 = cute.to_int_tuple(%e1_1240) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %555 = cute.get_scalars(%itup_1244) : !cute.int_tuple<"?">
      %itup_1245 = cute.to_int_tuple(%e2_1241) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %556 = cute.get_scalars(%itup_1245) : !cute.int_tuple<"?">
      %itup_1246 = cute.to_int_tuple(%e3_1242) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %557 = cute.get_scalars(%itup_1246) : !cute.int_tuple<"?{div=8}">
      %coord_1247 = cute.make_coord(%e1_1235) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1248 = cute.make_coord(%itup_1245) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %558 = cute.elem_less(%coord_1247, %coord_1248) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1249 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1250 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1251 = cute.crd2idx(%coord_1249, %lay_1250) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1252 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1253 = cute.add_offset(%iter_1252, %idx_1251) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1254 = cute.make_view(%tup_1253) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1255 = cute.get_iter(%view_1254) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1256, %e1_1257, %e2_1258, %e3_1259 = cute.get_leaves(%iter_1255) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %559 = cute.get_scalars(%e0_1256) : !cute.int_tuple<"?">
      %560 = cute.get_scalars(%e1_1257) : !cute.int_tuple<"?">
      %561 = cute.get_scalars(%e2_1258) : !cute.int_tuple<"?">
      %562 = cute.get_scalars(%e3_1259) : !cute.int_tuple<"?{div=8}">
      %iter_1260 = cute.get_iter(%view_1254) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1261, %e1_1262, %e2_1263, %e3_1264 = cute.get_leaves(%iter_1260) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %563 = cute.get_scalars(%e0_1261) : !cute.int_tuple<"?">
      %564 = cute.get_scalars(%e1_1262) : !cute.int_tuple<"?">
      %565 = cute.get_scalars(%e2_1263) : !cute.int_tuple<"?">
      %566 = cute.get_scalars(%e3_1264) : !cute.int_tuple<"?{div=8}">
      %iter_1265 = cute.get_iter(%view_1254) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1266, %e1_1267, %e2_1268, %e3_1269 = cute.get_leaves(%iter_1265) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %567 = cute.get_scalars(%e0_1266) : !cute.int_tuple<"?">
      %568 = cute.get_scalars(%e1_1267) : !cute.int_tuple<"?">
      %569 = cute.get_scalars(%e2_1268) : !cute.int_tuple<"?">
      %570 = cute.get_scalars(%e3_1269) : !cute.int_tuple<"?{div=8}">
      %lay_1270 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %571 = cute.get_shape(%lay_1270) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1271, %e1_1272, %e2_1273, %e3_1274 = cute.get_leaves(%571) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1275 = cute.to_int_tuple(%e0_1271) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %572 = cute.get_scalars(%itup_1275) : !cute.int_tuple<"?">
      %itup_1276 = cute.to_int_tuple(%e1_1272) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %573 = cute.get_scalars(%itup_1276) : !cute.int_tuple<"?">
      %itup_1277 = cute.to_int_tuple(%e2_1273) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %574 = cute.get_scalars(%itup_1277) : !cute.int_tuple<"?">
      %itup_1278 = cute.to_int_tuple(%e3_1274) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %575 = cute.get_scalars(%itup_1278) : !cute.int_tuple<"?{div=8}">
      %coord_1279 = cute.make_coord(%e1_1267) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1280 = cute.make_coord(%itup_1277) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %576 = cute.elem_less(%coord_1279, %coord_1280) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1281 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1282 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1283 = cute.crd2idx(%coord_1281, %lay_1282) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1284 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1285 = cute.add_offset(%iter_1284, %idx_1283) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1286 = cute.make_view(%tup_1285) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1287 = cute.get_iter(%view_1286) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1288, %e1_1289, %e2_1290, %e3_1291 = cute.get_leaves(%iter_1287) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %577 = cute.get_scalars(%e0_1288) : !cute.int_tuple<"?">
      %578 = cute.get_scalars(%e1_1289) : !cute.int_tuple<"?">
      %579 = cute.get_scalars(%e2_1290) : !cute.int_tuple<"?">
      %580 = cute.get_scalars(%e3_1291) : !cute.int_tuple<"?{div=8}">
      %iter_1292 = cute.get_iter(%view_1286) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1293, %e1_1294, %e2_1295, %e3_1296 = cute.get_leaves(%iter_1292) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %581 = cute.get_scalars(%e0_1293) : !cute.int_tuple<"?">
      %582 = cute.get_scalars(%e1_1294) : !cute.int_tuple<"?">
      %583 = cute.get_scalars(%e2_1295) : !cute.int_tuple<"?">
      %584 = cute.get_scalars(%e3_1296) : !cute.int_tuple<"?{div=8}">
      %iter_1297 = cute.get_iter(%view_1286) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1298, %e1_1299, %e2_1300, %e3_1301 = cute.get_leaves(%iter_1297) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %585 = cute.get_scalars(%e0_1298) : !cute.int_tuple<"?">
      %586 = cute.get_scalars(%e1_1299) : !cute.int_tuple<"?">
      %587 = cute.get_scalars(%e2_1300) : !cute.int_tuple<"?">
      %588 = cute.get_scalars(%e3_1301) : !cute.int_tuple<"?{div=8}">
      %lay_1302 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %589 = cute.get_shape(%lay_1302) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1303, %e1_1304, %e2_1305, %e3_1306 = cute.get_leaves(%589) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1307 = cute.to_int_tuple(%e0_1303) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %590 = cute.get_scalars(%itup_1307) : !cute.int_tuple<"?">
      %itup_1308 = cute.to_int_tuple(%e1_1304) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %591 = cute.get_scalars(%itup_1308) : !cute.int_tuple<"?">
      %itup_1309 = cute.to_int_tuple(%e2_1305) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %592 = cute.get_scalars(%itup_1309) : !cute.int_tuple<"?">
      %itup_1310 = cute.to_int_tuple(%e3_1306) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %593 = cute.get_scalars(%itup_1310) : !cute.int_tuple<"?{div=8}">
      %coord_1311 = cute.make_coord(%e2_1300) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1312 = cute.make_coord(%itup_1310) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %594 = cute.elem_less(%coord_1311, %coord_1312) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %595 = arith.extui %576 : i1 to i32
      %596 = arith.cmpi ne, %595, %c0_i32 : i32
      %597 = arith.extui %576 : i1 to i32
      %598 = arith.extui %594 : i1 to i32
      %599 = arith.select %596, %598, %597 : i32
      %600 = arith.cmpi ne, %599, %c0_i32_1213 : i32
      scf.if %600 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,0,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2087 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_10
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2093 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2095 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_14
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %lay_2100 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %928 = cute.get_shape(%lay_2100) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2101, %e1_2102 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %lay_2103 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %929 = cute.get_shape(%lay_2103) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2104, %e1_2105 = cute.get_leaves(%929) : !cute.shape<"((8,1))">
        %lay_2106 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %shape_2107 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2108 = cute.make_layout() : !cute.layout<"1:0">
        %append_2109 = cute.append_to_rank<2> (%lay_2106, %lay_2108) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2110 = cute.make_view(%iter_2091, %append_2109) : !memref_gmem_bf16_11
        %iter_2111 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %lay_2112 = cute.get_layout(%view_2110) : !memref_gmem_bf16_11
        %930 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%930) : !cute.shape<"((8,1),1)">
        %iter_2116 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %view_2117 = cute.make_view(%iter_2116) : !memref_gmem_bf16_12
        %iter_2118 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2119 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %lay_2120 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %shape_2121 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2122 = cute.make_layout() : !cute.layout<"1:0">
        %append_2123 = cute.append_to_rank<2> (%lay_2120, %lay_2122) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2124 = cute.make_view(%iter_2099, %append_2123) : !memref_smem_bf16_15
        %iter_2125 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %lay_2126 = cute.get_layout(%view_2124) : !memref_smem_bf16_15
        %931 = cute.get_shape(%lay_2126) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2127, %e1_2128, %e2_2129 = cute.get_leaves(%931) : !cute.shape<"((8,1),1)">
        %iter_2130 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %view_2131 = cute.make_view(%iter_2130) : !memref_smem_bf16_16
        %iter_2132 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %iter_2133 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2134 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %932 = cute.get_shape(%lay_2134) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2135, %e1_2136, %e2_2137 = cute.get_leaves(%932) : !cute.shape<"((8,1),(1))">
        %lay_2138 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %933 = cute.get_shape(%lay_2138) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2139, %e1_2140, %e2_2141 = cute.get_leaves(%933) : !cute.shape<"((8,1),(1))">
        %lay_2142 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %sz_2143 = cute.size(%lay_2142) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2144 = cute.get_leaves(%sz_2143) : !cute.int_tuple<"1">
        %lay_2145 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %sz_2146 = cute.size(%lay_2145) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2147 = cute.get_leaves(%sz_2146) : !cute.int_tuple<"1">
        %934 = cute.static : !cute.layout<"1:0">
        %iter_2148 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2149 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2150 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %lay_2151 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %append_2152 = cute.append_to_rank<2> (%lay_2150, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2153 = cute.append_to_rank<2> (%lay_2151, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2155 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2156 = cute.size(%lay_2154) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %935 = cute.get_scalars(%sz_2156) : !cute.int_tuple<"1">
        %c0_i32_2157 = arith.constant 0 : i32
        %c1_i32_2158 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2157 to %935 step %c1_i32_2158  : i32 {
          %coord_2159 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2160 = cute.slice(%lay_2154, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2161 = cute.crd2idx(%coord_2159, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2162 = cute.add_offset(%iter_2148, %idx_2161) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2163 = cute.make_view(%ptr_2162, %slice_2160) : !memref_gmem_bf16_10
          %slice_2164 = cute.slice(%lay_2155, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2165 = cute.crd2idx(%coord_2159, %lay_2155) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2166 = cute.add_offset(%iter_2149, %idx_2165) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2167 = cute.make_view(%ptr_2166, %slice_2164) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2163, %view_2167) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2085 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2087 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_14
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"8">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2096, %e1_2097 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %int_tuple_2098 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2099 = cute.tuple.product(%int_tuple_2098) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2100 = cute.get_leaves(%res_2099) : !cute.int_tuple<"8">
        %cst_2101 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2101 : vector<8xbf16>
        %int_tuple_2102 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2103 = cute.size(%int_tuple_2102) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2104 = cute.get_leaves(%sz_2103) : !cute.int_tuple<"8">
        %int_tuple_2105 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2106 = cute.size(%int_tuple_2105) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2107 = cute.get_leaves(%sz_2106) : !cute.int_tuple<"8">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_14
      }
      %int_tuple_1313 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1314 = cute.size(%int_tuple_1313) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1315 = cute.get_leaves(%sz_1314) : !cute.int_tuple<"1">
      %coord_1316 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1317 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1318 = cute.crd2idx(%coord_1316, %lay_1317) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1319 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1320 = cute.add_offset(%iter_1319, %idx_1318) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1321 = cute.make_view(%tup_1320) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1322 = cute.get_iter(%view_1321) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1323, %e1_1324, %e2_1325, %e3_1326 = cute.get_leaves(%iter_1322) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %601 = cute.get_scalars(%e0_1323) : !cute.int_tuple<"?">
      %602 = cute.get_scalars(%e1_1324) : !cute.int_tuple<"?">
      %603 = cute.get_scalars(%e2_1325) : !cute.int_tuple<"?">
      %604 = cute.get_scalars(%e3_1326) : !cute.int_tuple<"?{div=8}">
      %iter_1327 = cute.get_iter(%view_1321) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1328, %e1_1329, %e2_1330, %e3_1331 = cute.get_leaves(%iter_1327) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %605 = cute.get_scalars(%e0_1328) : !cute.int_tuple<"?">
      %606 = cute.get_scalars(%e1_1329) : !cute.int_tuple<"?">
      %607 = cute.get_scalars(%e2_1330) : !cute.int_tuple<"?">
      %608 = cute.get_scalars(%e3_1331) : !cute.int_tuple<"?{div=8}">
      %iter_1332 = cute.get_iter(%view_1321) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1333, %e1_1334, %e2_1335, %e3_1336 = cute.get_leaves(%iter_1332) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %609 = cute.get_scalars(%e0_1333) : !cute.int_tuple<"?">
      %610 = cute.get_scalars(%e1_1334) : !cute.int_tuple<"?">
      %611 = cute.get_scalars(%e2_1335) : !cute.int_tuple<"?">
      %612 = cute.get_scalars(%e3_1336) : !cute.int_tuple<"?{div=8}">
      %lay_1337 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %613 = cute.get_shape(%lay_1337) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1338, %e1_1339, %e2_1340, %e3_1341 = cute.get_leaves(%613) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1342 = cute.to_int_tuple(%e0_1338) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %614 = cute.get_scalars(%itup_1342) : !cute.int_tuple<"?">
      %itup_1343 = cute.to_int_tuple(%e1_1339) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %615 = cute.get_scalars(%itup_1343) : !cute.int_tuple<"?">
      %itup_1344 = cute.to_int_tuple(%e2_1340) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %616 = cute.get_scalars(%itup_1344) : !cute.int_tuple<"?">
      %itup_1345 = cute.to_int_tuple(%e3_1341) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %617 = cute.get_scalars(%itup_1345) : !cute.int_tuple<"?{div=8}">
      %coord_1346 = cute.make_coord(%e1_1334) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1347 = cute.make_coord(%itup_1344) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %618 = cute.elem_less(%coord_1346, %coord_1347) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1348 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1349 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1350 = cute.crd2idx(%coord_1348, %lay_1349) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1351 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1352 = cute.add_offset(%iter_1351, %idx_1350) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1353 = cute.make_view(%tup_1352) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1354 = cute.get_iter(%view_1353) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1355, %e1_1356, %e2_1357, %e3_1358 = cute.get_leaves(%iter_1354) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %619 = cute.get_scalars(%e0_1355) : !cute.int_tuple<"?">
      %620 = cute.get_scalars(%e1_1356) : !cute.int_tuple<"?">
      %621 = cute.get_scalars(%e2_1357) : !cute.int_tuple<"?">
      %622 = cute.get_scalars(%e3_1358) : !cute.int_tuple<"?{div=8}">
      %iter_1359 = cute.get_iter(%view_1353) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1360, %e1_1361, %e2_1362, %e3_1363 = cute.get_leaves(%iter_1359) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %623 = cute.get_scalars(%e0_1360) : !cute.int_tuple<"?">
      %624 = cute.get_scalars(%e1_1361) : !cute.int_tuple<"?">
      %625 = cute.get_scalars(%e2_1362) : !cute.int_tuple<"?">
      %626 = cute.get_scalars(%e3_1363) : !cute.int_tuple<"?{div=8}">
      %iter_1364 = cute.get_iter(%view_1353) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1365, %e1_1366, %e2_1367, %e3_1368 = cute.get_leaves(%iter_1364) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %627 = cute.get_scalars(%e0_1365) : !cute.int_tuple<"?">
      %628 = cute.get_scalars(%e1_1366) : !cute.int_tuple<"?">
      %629 = cute.get_scalars(%e2_1367) : !cute.int_tuple<"?">
      %630 = cute.get_scalars(%e3_1368) : !cute.int_tuple<"?{div=8}">
      %lay_1369 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %631 = cute.get_shape(%lay_1369) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1370, %e1_1371, %e2_1372, %e3_1373 = cute.get_leaves(%631) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1374 = cute.to_int_tuple(%e0_1370) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %632 = cute.get_scalars(%itup_1374) : !cute.int_tuple<"?">
      %itup_1375 = cute.to_int_tuple(%e1_1371) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %633 = cute.get_scalars(%itup_1375) : !cute.int_tuple<"?">
      %itup_1376 = cute.to_int_tuple(%e2_1372) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %634 = cute.get_scalars(%itup_1376) : !cute.int_tuple<"?">
      %itup_1377 = cute.to_int_tuple(%e3_1373) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %635 = cute.get_scalars(%itup_1377) : !cute.int_tuple<"?{div=8}">
      %coord_1378 = cute.make_coord(%e1_1366) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1379 = cute.make_coord(%itup_1376) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %636 = cute.elem_less(%coord_1378, %coord_1379) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1380 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1381 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1382 = cute.crd2idx(%coord_1380, %lay_1381) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1383 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1384 = cute.add_offset(%iter_1383, %idx_1382) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1385 = cute.make_view(%tup_1384) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1386 = cute.get_iter(%view_1385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1387, %e1_1388, %e2_1389, %e3_1390 = cute.get_leaves(%iter_1386) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %637 = cute.get_scalars(%e0_1387) : !cute.int_tuple<"?">
      %638 = cute.get_scalars(%e1_1388) : !cute.int_tuple<"?">
      %639 = cute.get_scalars(%e2_1389) : !cute.int_tuple<"?">
      %640 = cute.get_scalars(%e3_1390) : !cute.int_tuple<"?{div=8}">
      %iter_1391 = cute.get_iter(%view_1385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1392, %e1_1393, %e2_1394, %e3_1395 = cute.get_leaves(%iter_1391) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %641 = cute.get_scalars(%e0_1392) : !cute.int_tuple<"?">
      %642 = cute.get_scalars(%e1_1393) : !cute.int_tuple<"?">
      %643 = cute.get_scalars(%e2_1394) : !cute.int_tuple<"?">
      %644 = cute.get_scalars(%e3_1395) : !cute.int_tuple<"?{div=8}">
      %iter_1396 = cute.get_iter(%view_1385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1397, %e1_1398, %e2_1399, %e3_1400 = cute.get_leaves(%iter_1396) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %645 = cute.get_scalars(%e0_1397) : !cute.int_tuple<"?">
      %646 = cute.get_scalars(%e1_1398) : !cute.int_tuple<"?">
      %647 = cute.get_scalars(%e2_1399) : !cute.int_tuple<"?">
      %648 = cute.get_scalars(%e3_1400) : !cute.int_tuple<"?{div=8}">
      %lay_1401 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %649 = cute.get_shape(%lay_1401) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1402, %e1_1403, %e2_1404, %e3_1405 = cute.get_leaves(%649) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1406 = cute.to_int_tuple(%e0_1402) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %650 = cute.get_scalars(%itup_1406) : !cute.int_tuple<"?">
      %itup_1407 = cute.to_int_tuple(%e1_1403) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %651 = cute.get_scalars(%itup_1407) : !cute.int_tuple<"?">
      %itup_1408 = cute.to_int_tuple(%e2_1404) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %652 = cute.get_scalars(%itup_1408) : !cute.int_tuple<"?">
      %itup_1409 = cute.to_int_tuple(%e3_1405) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %653 = cute.get_scalars(%itup_1409) : !cute.int_tuple<"?{div=8}">
      %coord_1410 = cute.make_coord(%e2_1399) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1411 = cute.make_coord(%itup_1409) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %654 = cute.elem_less(%coord_1410, %coord_1411) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %655 = arith.extui %636 : i1 to i32
      %656 = arith.cmpi ne, %655, %c0_i32 : i32
      %657 = arith.extui %636 : i1 to i32
      %658 = arith.extui %654 : i1 to i32
      %659 = arith.select %656, %658, %657 : i32
      %660 = arith.cmpi ne, %659, %c0_i32_1213 : i32
      scf.if %660 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,0,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2087 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_10
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2093 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2095 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_14
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %lay_2100 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %928 = cute.get_shape(%lay_2100) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2101, %e1_2102 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %lay_2103 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %929 = cute.get_shape(%lay_2103) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2104, %e1_2105 = cute.get_leaves(%929) : !cute.shape<"((8,1))">
        %lay_2106 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %shape_2107 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2108 = cute.make_layout() : !cute.layout<"1:0">
        %append_2109 = cute.append_to_rank<2> (%lay_2106, %lay_2108) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2110 = cute.make_view(%iter_2091, %append_2109) : !memref_gmem_bf16_11
        %iter_2111 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %lay_2112 = cute.get_layout(%view_2110) : !memref_gmem_bf16_11
        %930 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%930) : !cute.shape<"((8,1),1)">
        %iter_2116 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %view_2117 = cute.make_view(%iter_2116) : !memref_gmem_bf16_12
        %iter_2118 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2119 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %lay_2120 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %shape_2121 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2122 = cute.make_layout() : !cute.layout<"1:0">
        %append_2123 = cute.append_to_rank<2> (%lay_2120, %lay_2122) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2124 = cute.make_view(%iter_2099, %append_2123) : !memref_smem_bf16_15
        %iter_2125 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %lay_2126 = cute.get_layout(%view_2124) : !memref_smem_bf16_15
        %931 = cute.get_shape(%lay_2126) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2127, %e1_2128, %e2_2129 = cute.get_leaves(%931) : !cute.shape<"((8,1),1)">
        %iter_2130 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %view_2131 = cute.make_view(%iter_2130) : !memref_smem_bf16_16
        %iter_2132 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %iter_2133 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2134 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %932 = cute.get_shape(%lay_2134) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2135, %e1_2136, %e2_2137 = cute.get_leaves(%932) : !cute.shape<"((8,1),(1))">
        %lay_2138 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %933 = cute.get_shape(%lay_2138) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2139, %e1_2140, %e2_2141 = cute.get_leaves(%933) : !cute.shape<"((8,1),(1))">
        %lay_2142 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %sz_2143 = cute.size(%lay_2142) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2144 = cute.get_leaves(%sz_2143) : !cute.int_tuple<"1">
        %lay_2145 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %sz_2146 = cute.size(%lay_2145) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2147 = cute.get_leaves(%sz_2146) : !cute.int_tuple<"1">
        %934 = cute.static : !cute.layout<"1:0">
        %iter_2148 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2149 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2150 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %lay_2151 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %append_2152 = cute.append_to_rank<2> (%lay_2150, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2153 = cute.append_to_rank<2> (%lay_2151, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2155 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2156 = cute.size(%lay_2154) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %935 = cute.get_scalars(%sz_2156) : !cute.int_tuple<"1">
        %c0_i32_2157 = arith.constant 0 : i32
        %c1_i32_2158 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2157 to %935 step %c1_i32_2158  : i32 {
          %coord_2159 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2160 = cute.slice(%lay_2154, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2161 = cute.crd2idx(%coord_2159, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2162 = cute.add_offset(%iter_2148, %idx_2161) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2163 = cute.make_view(%ptr_2162, %slice_2160) : !memref_gmem_bf16_10
          %slice_2164 = cute.slice(%lay_2155, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2165 = cute.crd2idx(%coord_2159, %lay_2155) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2166 = cute.add_offset(%iter_2149, %idx_2165) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2167 = cute.make_view(%ptr_2166, %slice_2164) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2163, %view_2167) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2085 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2087 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_14
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"8">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2096, %e1_2097 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %int_tuple_2098 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2099 = cute.tuple.product(%int_tuple_2098) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2100 = cute.get_leaves(%res_2099) : !cute.int_tuple<"8">
        %cst_2101 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2101 : vector<8xbf16>
        %int_tuple_2102 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2103 = cute.size(%int_tuple_2102) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2104 = cute.get_leaves(%sz_2103) : !cute.int_tuple<"8">
        %int_tuple_2105 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2106 = cute.size(%int_tuple_2105) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2107 = cute.get_leaves(%sz_2106) : !cute.int_tuple<"8">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_14
      }
      %int_tuple_1412 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1413 = cute.size(%int_tuple_1412) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1414 = cute.get_leaves(%sz_1413) : !cute.int_tuple<"1">
      %coord_1415 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_1416 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1417 = cute.crd2idx(%coord_1415, %lay_1416) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_1418 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1419 = cute.add_offset(%iter_1418, %idx_1417) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1420 = cute.make_view(%tup_1419) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1421 = cute.get_iter(%view_1420) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1422, %e1_1423, %e2_1424, %e3_1425 = cute.get_leaves(%iter_1421) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %661 = cute.get_scalars(%e0_1422) : !cute.int_tuple<"?">
      %662 = cute.get_scalars(%e1_1423) : !cute.int_tuple<"?">
      %663 = cute.get_scalars(%e2_1424) : !cute.int_tuple<"?">
      %664 = cute.get_scalars(%e3_1425) : !cute.int_tuple<"?{div=8}">
      %iter_1426 = cute.get_iter(%view_1420) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1427, %e1_1428, %e2_1429, %e3_1430 = cute.get_leaves(%iter_1426) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %665 = cute.get_scalars(%e0_1427) : !cute.int_tuple<"?">
      %666 = cute.get_scalars(%e1_1428) : !cute.int_tuple<"?">
      %667 = cute.get_scalars(%e2_1429) : !cute.int_tuple<"?">
      %668 = cute.get_scalars(%e3_1430) : !cute.int_tuple<"?{div=8}">
      %iter_1431 = cute.get_iter(%view_1420) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1432, %e1_1433, %e2_1434, %e3_1435 = cute.get_leaves(%iter_1431) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %669 = cute.get_scalars(%e0_1432) : !cute.int_tuple<"?">
      %670 = cute.get_scalars(%e1_1433) : !cute.int_tuple<"?">
      %671 = cute.get_scalars(%e2_1434) : !cute.int_tuple<"?">
      %672 = cute.get_scalars(%e3_1435) : !cute.int_tuple<"?{div=8}">
      %lay_1436 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %673 = cute.get_shape(%lay_1436) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1437, %e1_1438, %e2_1439, %e3_1440 = cute.get_leaves(%673) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1441 = cute.to_int_tuple(%e0_1437) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %674 = cute.get_scalars(%itup_1441) : !cute.int_tuple<"?">
      %itup_1442 = cute.to_int_tuple(%e1_1438) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %675 = cute.get_scalars(%itup_1442) : !cute.int_tuple<"?">
      %itup_1443 = cute.to_int_tuple(%e2_1439) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %676 = cute.get_scalars(%itup_1443) : !cute.int_tuple<"?">
      %itup_1444 = cute.to_int_tuple(%e3_1440) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %677 = cute.get_scalars(%itup_1444) : !cute.int_tuple<"?{div=8}">
      %coord_1445 = cute.make_coord(%e1_1433) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1446 = cute.make_coord(%itup_1443) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %678 = cute.elem_less(%coord_1445, %coord_1446) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1447 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_1448 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1449 = cute.crd2idx(%coord_1447, %lay_1448) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_1450 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1451 = cute.add_offset(%iter_1450, %idx_1449) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1452 = cute.make_view(%tup_1451) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1453 = cute.get_iter(%view_1452) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1454, %e1_1455, %e2_1456, %e3_1457 = cute.get_leaves(%iter_1453) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %679 = cute.get_scalars(%e0_1454) : !cute.int_tuple<"?">
      %680 = cute.get_scalars(%e1_1455) : !cute.int_tuple<"?">
      %681 = cute.get_scalars(%e2_1456) : !cute.int_tuple<"?">
      %682 = cute.get_scalars(%e3_1457) : !cute.int_tuple<"?{div=8}">
      %iter_1458 = cute.get_iter(%view_1452) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1459, %e1_1460, %e2_1461, %e3_1462 = cute.get_leaves(%iter_1458) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %683 = cute.get_scalars(%e0_1459) : !cute.int_tuple<"?">
      %684 = cute.get_scalars(%e1_1460) : !cute.int_tuple<"?">
      %685 = cute.get_scalars(%e2_1461) : !cute.int_tuple<"?">
      %686 = cute.get_scalars(%e3_1462) : !cute.int_tuple<"?{div=8}">
      %iter_1463 = cute.get_iter(%view_1452) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1464, %e1_1465, %e2_1466, %e3_1467 = cute.get_leaves(%iter_1463) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %687 = cute.get_scalars(%e0_1464) : !cute.int_tuple<"?">
      %688 = cute.get_scalars(%e1_1465) : !cute.int_tuple<"?">
      %689 = cute.get_scalars(%e2_1466) : !cute.int_tuple<"?">
      %690 = cute.get_scalars(%e3_1467) : !cute.int_tuple<"?{div=8}">
      %lay_1468 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %691 = cute.get_shape(%lay_1468) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1469, %e1_1470, %e2_1471, %e3_1472 = cute.get_leaves(%691) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1473 = cute.to_int_tuple(%e0_1469) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %692 = cute.get_scalars(%itup_1473) : !cute.int_tuple<"?">
      %itup_1474 = cute.to_int_tuple(%e1_1470) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %693 = cute.get_scalars(%itup_1474) : !cute.int_tuple<"?">
      %itup_1475 = cute.to_int_tuple(%e2_1471) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %694 = cute.get_scalars(%itup_1475) : !cute.int_tuple<"?">
      %itup_1476 = cute.to_int_tuple(%e3_1472) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %695 = cute.get_scalars(%itup_1476) : !cute.int_tuple<"?{div=8}">
      %coord_1477 = cute.make_coord(%e1_1465) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1478 = cute.make_coord(%itup_1475) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %696 = cute.elem_less(%coord_1477, %coord_1478) : !cute.coord<"?">, !cute.coord<"?">
      %coord_1479 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_1480 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1481 = cute.crd2idx(%coord_1479, %lay_1480) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_1482 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1483 = cute.add_offset(%iter_1482, %idx_1481) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1484 = cute.make_view(%tup_1483) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1485 = cute.get_iter(%view_1484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1486, %e1_1487, %e2_1488, %e3_1489 = cute.get_leaves(%iter_1485) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %697 = cute.get_scalars(%e0_1486) : !cute.int_tuple<"?">
      %698 = cute.get_scalars(%e1_1487) : !cute.int_tuple<"?">
      %699 = cute.get_scalars(%e2_1488) : !cute.int_tuple<"?">
      %700 = cute.get_scalars(%e3_1489) : !cute.int_tuple<"?{div=8}">
      %iter_1490 = cute.get_iter(%view_1484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1491, %e1_1492, %e2_1493, %e3_1494 = cute.get_leaves(%iter_1490) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %701 = cute.get_scalars(%e0_1491) : !cute.int_tuple<"?">
      %702 = cute.get_scalars(%e1_1492) : !cute.int_tuple<"?">
      %703 = cute.get_scalars(%e2_1493) : !cute.int_tuple<"?">
      %704 = cute.get_scalars(%e3_1494) : !cute.int_tuple<"?{div=8}">
      %iter_1495 = cute.get_iter(%view_1484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1496, %e1_1497, %e2_1498, %e3_1499 = cute.get_leaves(%iter_1495) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %705 = cute.get_scalars(%e0_1496) : !cute.int_tuple<"?">
      %706 = cute.get_scalars(%e1_1497) : !cute.int_tuple<"?">
      %707 = cute.get_scalars(%e2_1498) : !cute.int_tuple<"?">
      %708 = cute.get_scalars(%e3_1499) : !cute.int_tuple<"?{div=8}">
      %lay_1500 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %709 = cute.get_shape(%lay_1500) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1501, %e1_1502, %e2_1503, %e3_1504 = cute.get_leaves(%709) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1505 = cute.to_int_tuple(%e0_1501) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %710 = cute.get_scalars(%itup_1505) : !cute.int_tuple<"?">
      %itup_1506 = cute.to_int_tuple(%e1_1502) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %711 = cute.get_scalars(%itup_1506) : !cute.int_tuple<"?">
      %itup_1507 = cute.to_int_tuple(%e2_1503) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %712 = cute.get_scalars(%itup_1507) : !cute.int_tuple<"?">
      %itup_1508 = cute.to_int_tuple(%e3_1504) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %713 = cute.get_scalars(%itup_1508) : !cute.int_tuple<"?{div=8}">
      %coord_1509 = cute.make_coord(%e2_1498) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1510 = cute.make_coord(%itup_1508) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %714 = cute.elem_less(%coord_1509, %coord_1510) : !cute.coord<"?">, !cute.coord<"?{div=8}">
      %715 = arith.extui %696 : i1 to i32
      %716 = arith.cmpi ne, %715, %c0_i32 : i32
      %717 = arith.extui %696 : i1 to i32
      %718 = arith.extui %714 : i1 to i32
      %719 = arith.select %716, %718, %717 : i32
      %720 = arith.cmpi ne, %719, %c0_i32_1213 : i32
      scf.if %720 {
        %coord_2084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,0,?)">
        %lay_2085 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2087 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_gmem_bf16_10
        %iter_2090 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %iter_2091 = cute.get_iter(%view_2089) : !memref_gmem_bf16_10
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2093 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2095 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_smem_bf16_14
        %iter_2098 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %iter_2099 = cute.get_iter(%view_2097) : !memref_smem_bf16_14
        %lay_2100 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %928 = cute.get_shape(%lay_2100) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2101, %e1_2102 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %lay_2103 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %929 = cute.get_shape(%lay_2103) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2104, %e1_2105 = cute.get_leaves(%929) : !cute.shape<"((8,1))">
        %lay_2106 = cute.get_layout(%view_2089) : !memref_gmem_bf16_10
        %shape_2107 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2108 = cute.make_layout() : !cute.layout<"1:0">
        %append_2109 = cute.append_to_rank<2> (%lay_2106, %lay_2108) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2110 = cute.make_view(%iter_2091, %append_2109) : !memref_gmem_bf16_11
        %iter_2111 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %lay_2112 = cute.get_layout(%view_2110) : !memref_gmem_bf16_11
        %930 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%930) : !cute.shape<"((8,1),1)">
        %iter_2116 = cute.get_iter(%view_2110) : !memref_gmem_bf16_11
        %view_2117 = cute.make_view(%iter_2116) : !memref_gmem_bf16_12
        %iter_2118 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2119 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %lay_2120 = cute.get_layout(%view_2097) : !memref_smem_bf16_14
        %shape_2121 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2122 = cute.make_layout() : !cute.layout<"1:0">
        %append_2123 = cute.append_to_rank<2> (%lay_2120, %lay_2122) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2124 = cute.make_view(%iter_2099, %append_2123) : !memref_smem_bf16_15
        %iter_2125 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %lay_2126 = cute.get_layout(%view_2124) : !memref_smem_bf16_15
        %931 = cute.get_shape(%lay_2126) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2127, %e1_2128, %e2_2129 = cute.get_leaves(%931) : !cute.shape<"((8,1),1)">
        %iter_2130 = cute.get_iter(%view_2124) : !memref_smem_bf16_15
        %view_2131 = cute.make_view(%iter_2130) : !memref_smem_bf16_16
        %iter_2132 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %iter_2133 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2134 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %932 = cute.get_shape(%lay_2134) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2135, %e1_2136, %e2_2137 = cute.get_leaves(%932) : !cute.shape<"((8,1),(1))">
        %lay_2138 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %933 = cute.get_shape(%lay_2138) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2139, %e1_2140, %e2_2141 = cute.get_leaves(%933) : !cute.shape<"((8,1),(1))">
        %lay_2142 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %sz_2143 = cute.size(%lay_2142) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2144 = cute.get_leaves(%sz_2143) : !cute.int_tuple<"1">
        %lay_2145 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %sz_2146 = cute.size(%lay_2145) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2147 = cute.get_leaves(%sz_2146) : !cute.int_tuple<"1">
        %934 = cute.static : !cute.layout<"1:0">
        %iter_2148 = cute.get_iter(%view_2117) : !memref_gmem_bf16_12
        %iter_2149 = cute.get_iter(%view_2131) : !memref_smem_bf16_16
        %lay_2150 = cute.get_layout(%view_2117) : !memref_gmem_bf16_12
        %lay_2151 = cute.get_layout(%view_2131) : !memref_smem_bf16_16
        %append_2152 = cute.append_to_rank<2> (%lay_2150, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2153 = cute.append_to_rank<2> (%lay_2151, %934) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2154 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2155 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2156 = cute.size(%lay_2154) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %935 = cute.get_scalars(%sz_2156) : !cute.int_tuple<"1">
        %c0_i32_2157 = arith.constant 0 : i32
        %c1_i32_2158 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2157 to %935 step %c1_i32_2158  : i32 {
          %coord_2159 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2160 = cute.slice(%lay_2154, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2161 = cute.crd2idx(%coord_2159, %lay_2154) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2162 = cute.add_offset(%iter_2148, %idx_2161) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2163 = cute.make_view(%ptr_2162, %slice_2160) : !memref_gmem_bf16_10
          %slice_2164 = cute.slice(%lay_2155, %coord_2159) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_2165 = cute.crd2idx(%coord_2159, %lay_2155) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2166 = cute.add_offset(%iter_2149, %idx_2165) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2167 = cute.make_view(%ptr_2166, %slice_2164) : !memref_smem_bf16_14
          cute.copy_atom_call(%4, %view_2163, %view_2167) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2085 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2087 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_smem_bf16_14
        %iter_2090 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %iter_2091 = cute.get_iter(%view_2089) : !memref_smem_bf16_14
        %lay_2092 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %sz_2093 = cute.size(%lay_2092) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2094 = cute.get_leaves(%sz_2093) : !cute.int_tuple<"8">
        %lay_2095 = cute.get_layout(%view_2089) : !memref_smem_bf16_14
        %928 = cute.get_shape(%lay_2095) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2096, %e1_2097 = cute.get_leaves(%928) : !cute.shape<"((8,1))">
        %int_tuple_2098 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %res_2099 = cute.tuple.product(%int_tuple_2098) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2100 = cute.get_leaves(%res_2099) : !cute.int_tuple<"8">
        %cst_2101 = arith.constant 0.000000e+00 : bf16
        %929 = vector.splat %cst_2101 : vector<8xbf16>
        %int_tuple_2102 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2103 = cute.size(%int_tuple_2102) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2104 = cute.get_leaves(%sz_2103) : !cute.int_tuple<"8">
        %int_tuple_2105 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2106 = cute.size(%int_tuple_2105) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2107 = cute.get_leaves(%sz_2106) : !cute.int_tuple<"8">
        cute.memref.store_vec %929, %view_2089 : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %int_tuple_1511 = cute.make_int_tuple() : () -> !cute.int_tuple<"-1">
      %tup_1512 = cute.add_offset(%sub_239, %int_tuple_1511) : (!cute.int_tuple<"?">, !cute.int_tuple<"-1">) -> !cute.int_tuple<"?">
      %721 = cute.get_scalars(%tup_1512) : !cute.int_tuple<"?">
      %722 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %723 = cute.get_shape(%722) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_1513, %e1_1514, %e2_1515, %e3_1516 = cute.get_leaves(%723) : !cute.shape<"(32,4,1,1)">
      %724 = cute.get_stride(%722) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_1517, %e1_1518, %e2_1519, %e3_1520 = cute.get_leaves(%724) : !cute.stride<"(1,32,0,0)">
      %725 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_1521, %e1_1522, %e2_1523 = cute.get_leaves(%725) : !cute.tile<"[64:1;16:1;16:1]">
      %726 = cute.get_shape(%e0_1521) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_1524 = cute.get_leaves(%726) : !cute.shape<"64">
      %727 = cute.get_stride(%e0_1521) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_1525 = cute.get_leaves(%727) : !cute.stride<"1">
      %728 = cute.get_shape(%e1_1522) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_1526 = cute.get_leaves(%728) : !cute.shape<"16">
      %729 = cute.get_stride(%e1_1522) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_1527 = cute.get_leaves(%729) : !cute.stride<"1">
      %730 = cute.get_shape(%e2_1523) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_1528 = cute.get_leaves(%730) : !cute.shape<"16">
      %731 = cute.get_stride(%e2_1523) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_1529 = cute.get_leaves(%731) : !cute.stride<"1">
      %732 = cute.static : !cute.layout<"32:1">
      %733 = cute.get_shape(%732) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_1530 = cute.get_leaves(%733) : !cute.shape<"32">
      %734 = cute.get_stride(%732) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_1531 = cute.get_leaves(%734) : !cute.stride<"1">
      %735 = cute.static : !cute.shape<"(16,8,16)">
      %e0_1532, %e1_1533, %e2_1534 = cute.get_leaves(%735) : !cute.shape<"(16,8,16)">
      %736 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %737 = cute.get_shape(%736) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_1535, %e1_1536, %e2_1537, %e3_1538, %e4_1539 = cute.get_leaves(%737) : !cute.shape<"((4,8),(2,2,2))">
      %738 = cute.get_stride(%736) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_1540, %e1_1541, %e2_1542, %e3_1543, %e4_1544 = cute.get_leaves(%738) : !cute.stride<"((32,1),(16,8,128))">
      %739 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %740 = cute.get_shape(%739) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_1545, %e1_1546, %e2_1547, %e3_1548 = cute.get_leaves(%740) : !cute.shape<"((4,8),(2,2))">
      %741 = cute.get_stride(%739) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_1549, %e1_1550, %e2_1551, %e3_1552 = cute.get_leaves(%741) : !cute.stride<"((16,1),(8,64))">
      %742 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %743 = cute.get_shape(%742) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_1553, %e1_1554, %e2_1555, %e3_1556 = cute.get_leaves(%743) : !cute.shape<"((4,8),(2,2))">
      %744 = cute.get_stride(%742) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_1557, %e1_1558, %e2_1559, %e3_1560 = cute.get_leaves(%744) : !cute.stride<"((32,1),(16,8))">
      %745 = cute.static : !cute.tile<"[64:1;16:1]">
      %e0_1561, %e1_1562 = cute.get_leaves(%745) : !cute.tile<"[64:1;16:1]">
      %746 = cute.get_shape(%e0_1561) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_1563 = cute.get_leaves(%746) : !cute.shape<"64">
      %747 = cute.get_stride(%e0_1561) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_1564 = cute.get_leaves(%747) : !cute.stride<"1">
      %748 = cute.get_shape(%e1_1562) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_1565 = cute.get_leaves(%748) : !cute.shape<"16">
      %749 = cute.get_stride(%e1_1562) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_1566 = cute.get_leaves(%749) : !cute.stride<"1">
      %750 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %751 = cute.get_shape(%750) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %e0_1567, %e1_1568, %e2_1569, %e3_1570, %e4_1571, %e5, %e6 = cute.get_leaves(%751) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %752 = cute.get_stride(%750) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %e0_1572, %e1_1573, %e2_1574, %e3_1575, %e4_1576, %e5_1577, %e6_1578 = cute.get_leaves(%752) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %753 = cute.static : !cute.layout<"32:1">
      %754 = cute.get_shape(%753) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_1579 = cute.get_leaves(%754) : !cute.shape<"32">
      %755 = cute.get_stride(%753) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_1580 = cute.get_leaves(%755) : !cute.stride<"1">
      %756 = cute.static : !cute.layout<"(32,8):(8,1)">
      %757 = cute.get_shape(%756) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
      %e0_1581, %e1_1582 = cute.get_leaves(%757) : !cute.shape<"(32,8)">
      %758 = cute.get_stride(%756) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
      %e0_1583, %e1_1584 = cute.get_leaves(%758) : !cute.stride<"(8,1)">
      %759 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
      %760 = cute.get_shape(%759) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
      %e0_1585, %e1_1586, %e2_1587 = cute.get_leaves(%760) : !cute.shape<"(32,(2,4))">
      %761 = cute.get_stride(%759) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
      %e0_1588, %e1_1589, %e2_1590 = cute.get_leaves(%761) : !cute.stride<"(2,(1,64))">
      %c-1_i32 = arith.constant -1 : i32
      %c1_i32 = arith.constant 1 : i32
      %762:2 = scf.for %arg5 = %c-1_i32 to %153 step %c1_i32 iter_args(%arg6 = %6, %arg7 = %191) -> (!mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3)  : i32 {
        %int_tuple_2084 = cute.make_int_tuple(%arg5) : (i32) -> !cute.int_tuple<"?">
        %sub_2085 = cute.tuple_sub(%tup_1512, %int_tuple_2084) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
        %928 = cute.get_scalars(%sub_2085) : !cute.int_tuple<"?">
        nvvm.cp.async.wait.group 0
        %c1_i32_2086 = arith.constant 1 : i32
        %c128_i32_2087 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_2086 number_of_threads = %c128_i32_2087
        %929 = arith.cmpi eq, %928, %153 : i32
        scf.if %929 {
          %lay_3319 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
          %1151 = cute.get_shape(%lay_3319) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3320, %e1_3321, %e2_3322, %e3_3323 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4,2)">
          %int_tuple_3324 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_3325 = cute.size(%int_tuple_3324) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_3326 = cute.get_leaves(%sz_3325) : !cute.int_tuple<"4">
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3328 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_3330 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3332 = cute.make_view(%tup_3331) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3333 = cute.get_iter(%view_3332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3334, %e1_3335, %e2_3336, %e3_3337 = cute.get_leaves(%iter_3333) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1152 = cute.get_scalars(%e0_3334) : !cute.int_tuple<"?">
          %1153 = cute.get_scalars(%e1_3335) : !cute.int_tuple<"?">
          %1154 = cute.get_scalars(%e2_3336) : !cute.int_tuple<"?">
          %1155 = cute.get_scalars(%e3_3337) : !cute.int_tuple<"?{div=8}">
          %iter_3338 = cute.get_iter(%view_3332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3339, %e1_3340, %e2_3341, %e3_3342 = cute.get_leaves(%iter_3338) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1156 = cute.get_scalars(%e0_3339) : !cute.int_tuple<"?">
          %1157 = cute.get_scalars(%e1_3340) : !cute.int_tuple<"?">
          %1158 = cute.get_scalars(%e2_3341) : !cute.int_tuple<"?">
          %1159 = cute.get_scalars(%e3_3342) : !cute.int_tuple<"?{div=8}">
          %iter_3343 = cute.get_iter(%view_3332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3344, %e1_3345, %e2_3346, %e3_3347 = cute.get_leaves(%iter_3343) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1160 = cute.get_scalars(%e0_3344) : !cute.int_tuple<"?">
          %1161 = cute.get_scalars(%e1_3345) : !cute.int_tuple<"?">
          %1162 = cute.get_scalars(%e2_3346) : !cute.int_tuple<"?">
          %1163 = cute.get_scalars(%e3_3347) : !cute.int_tuple<"?{div=8}">
          %lay_3348 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1164 = cute.get_shape(%lay_3348) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3349, %e1_3350, %e2_3351, %e3_3352 = cute.get_leaves(%1164) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3353 = cute.to_int_tuple(%e0_3349) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1165 = cute.get_scalars(%itup_3353) : !cute.int_tuple<"?">
          %itup_3354 = cute.to_int_tuple(%e1_3350) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1166 = cute.get_scalars(%itup_3354) : !cute.int_tuple<"?">
          %itup_3355 = cute.to_int_tuple(%e2_3351) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1167 = cute.get_scalars(%itup_3355) : !cute.int_tuple<"?">
          %itup_3356 = cute.to_int_tuple(%e3_3352) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1168 = cute.get_scalars(%itup_3356) : !cute.int_tuple<"?{div=8}">
          %coord_3357 = cute.make_coord(%e1_3345) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3358 = cute.make_coord(%itup_3354) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1169 = cute.elem_less(%coord_3357, %coord_3358) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1169 {
            %coord_3455 = cute.make_coord(%sub_2085) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_3456 = cute.get_layout(%src_partitioned_377) : !memref_gmem_bf16_6
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_3458 = cute.get_iter(%src_partitioned_377) : !memref_gmem_bf16_6
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_gmem_bf16_8
            %iter_3461 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %iter_3462 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %coord_3463 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3464 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3465 = cute.crd2idx(%coord_3463, %lay_3464) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_3466 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3467 = cute.add_offset(%iter_3466, %idx_3465) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3468 = cute.make_view(%ptr_3467) : !memref_smem_bf16_12
            %iter_3469 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %iter_3470 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %coord_3471 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3472 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
            %idx_3473 = cute.crd2idx(%coord_3471, %lay_3472) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3474 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
            %ptr_3475 = cute.add_offset(%iter_3474, %idx_3473) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3476 = cute.make_view(%ptr_3475) : !memref_rmem_i8_1
            %iter_3477 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %iter_3478 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %lay_3479 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %1224 = cute.get_shape(%lay_3479) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3480, %e1_3481, %e2_3482 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %lay_3483 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %1225 = cute.get_shape(%lay_3483) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3484, %e1_3485, %e2_3486 = cute.get_leaves(%1225) : !cute.shape<"((8,1),2)">
            %lay_3487 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %shape_3488 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3489 = cute.make_layout() : !cute.layout<"1:0">
            %append_3490 = cute.append_to_rank<2> (%lay_3487, %lay_3489) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3491 = cute.make_view(%iter_3462, %append_3490) : !memref_gmem_bf16_8
            %iter_3492 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %lay_3493 = cute.get_layout(%view_3491) : !memref_gmem_bf16_8
            %1226 = cute.get_shape(%lay_3493) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3494, %e1_3495, %e2_3496 = cute.get_leaves(%1226) : !cute.shape<"((8,1),2)">
            %iter_3497 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %view_3498 = cute.make_view(%iter_3497) : !memref_gmem_bf16_9
            %iter_3499 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3500 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %lay_3501 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %shape_3502 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3503 = cute.make_layout() : !cute.layout<"1:0">
            %append_3504 = cute.append_to_rank<2> (%lay_3501, %lay_3503) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3505 = cute.make_view(%iter_3470, %append_3504) : !memref_smem_bf16_12
            %iter_3506 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %lay_3507 = cute.get_layout(%view_3505) : !memref_smem_bf16_12
            %1227 = cute.get_shape(%lay_3507) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3508, %e1_3509, %e2_3510 = cute.get_leaves(%1227) : !cute.shape<"((8,1),2)">
            %iter_3511 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %view_3512 = cute.make_view(%iter_3511) : !memref_smem_bf16_13
            %iter_3513 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %iter_3514 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3515 = cute.get_layout(%view_3476) : !memref_rmem_i8_1
            %shape_3516 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3517 = cute.make_layout() : !cute.layout<"1:0">
            %append_3518 = cute.append_to_rank<2> (%lay_3515, %lay_3517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3519 = cute.make_view(%iter_3478, %append_3518) : !memref_rmem_i8_1
            %iter_3520 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %lay_3521 = cute.get_layout(%view_3519) : !memref_rmem_i8_1
            %1228 = cute.get_shape(%lay_3521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3522, %e1_3523 = cute.get_leaves(%1228) : !cute.shape<"(1,2)">
            %iter_3524 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %view_3525 = cute.make_view(%iter_3524) : !memref_rmem_i8_2
            %iter_3526 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %iter_3527 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3528 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %1229 = cute.get_shape(%lay_3528) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3529, %e1_3530, %e2_3531 = cute.get_leaves(%1229) : !cute.shape<"((8,1),(2))">
            %lay_3532 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %1230 = cute.get_shape(%lay_3532) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3533, %e1_3534, %e2_3535 = cute.get_leaves(%1230) : !cute.shape<"((8,1),(2))">
            %lay_3536 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %sz_3537 = cute.size(%lay_3536) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3538 = cute.get_leaves(%sz_3537) : !cute.int_tuple<"2">
            %lay_3539 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %sz_3540 = cute.size(%lay_3539) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3541 = cute.get_leaves(%sz_3540) : !cute.int_tuple<"2">
            %1231 = cute.static : !cute.layout<"1:0">
            %iter_3542 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3543 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3544 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %lay_3545 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %append_3546 = cute.append_to_rank<2> (%lay_3544, %1231) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3547 = cute.append_to_rank<2> (%lay_3545, %1231) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3548 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3549 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3550 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3551 = cute.get_layout(%view_3525) : !memref_rmem_i8_2
            %append_3552 = cute.append_to_rank<2> (%lay_3551, %1231) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3553 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3554 = cute.size(%lay_3548) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1232 = cute.get_scalars(%sz_3554) : !cute.int_tuple<"2">
            %c0_i32_3555 = arith.constant 0 : i32
            %c1_i32_3556 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3555 to %1232 step %c1_i32_3556  : i32 {
              %coord_3557 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3558 = cute.slice(%lay_3548, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3559 = cute.crd2idx(%coord_3557, %lay_3548) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3560 = cute.add_offset(%iter_3542, %idx_3559) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3561 = cute.make_view(%ptr_3560, %slice_3558) : !memref_gmem_bf16_10
              %slice_3562 = cute.slice(%lay_3549, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3563 = cute.crd2idx(%coord_3557, %lay_3549) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3564 = cute.add_offset(%iter_3543, %idx_3563) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3565 = cute.make_view(%ptr_3564, %slice_3562) : !memref_smem_bf16_14
              %slice_3566 = cute.slice(%lay_3553, %coord_3557) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3567 = cute.crd2idx(%coord_3557, %lay_3553) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3568 = cute.add_offset(%iter_3550, %idx_3567) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3569 = cute.make_view(%ptr_3568, %slice_3566) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3561, %view_3565, %view_3569) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3455 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3456 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_3458 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_smem_bf16_12
            %iter_3461 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %iter_3462 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %lay_3463 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %sz_3464 = cute.size(%lay_3463) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3465 = cute.get_leaves(%sz_3464) : !cute.int_tuple<"16">
            %lay_3466 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %1224 = cute.get_shape(%lay_3466) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3467, %e1_3468, %e2_3469 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %int_tuple_3470 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3471 = cute.tuple.product(%int_tuple_3470) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3472 = cute.get_leaves(%res_3471) : !cute.int_tuple<"16">
            %cst_3473 = arith.constant 0.000000e+00 : bf16
            %1225 = vector.splat %cst_3473 : vector<16xbf16>
            %int_tuple_3474 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3475 = cute.size(%int_tuple_3474) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3476 = cute.get_leaves(%sz_3475) : !cute.int_tuple<"16">
            %int_tuple_3477 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3478 = cute.size(%int_tuple_3477) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3479 = cute.get_leaves(%sz_3478) : !cute.int_tuple<"16">
            cute.memref.store_vec %1225, %view_3460 : !memref_smem_bf16_12
          }
          %coord_3359 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_3360 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3361 = cute.crd2idx(%coord_3359, %lay_3360) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_3362 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3363 = cute.add_offset(%iter_3362, %idx_3361) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3364 = cute.make_view(%tup_3363) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3365 = cute.get_iter(%view_3364) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3366, %e1_3367, %e2_3368, %e3_3369 = cute.get_leaves(%iter_3365) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1170 = cute.get_scalars(%e0_3366) : !cute.int_tuple<"?">
          %1171 = cute.get_scalars(%e1_3367) : !cute.int_tuple<"?">
          %1172 = cute.get_scalars(%e2_3368) : !cute.int_tuple<"?">
          %1173 = cute.get_scalars(%e3_3369) : !cute.int_tuple<"?{div=8}">
          %iter_3370 = cute.get_iter(%view_3364) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3371, %e1_3372, %e2_3373, %e3_3374 = cute.get_leaves(%iter_3370) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1174 = cute.get_scalars(%e0_3371) : !cute.int_tuple<"?">
          %1175 = cute.get_scalars(%e1_3372) : !cute.int_tuple<"?">
          %1176 = cute.get_scalars(%e2_3373) : !cute.int_tuple<"?">
          %1177 = cute.get_scalars(%e3_3374) : !cute.int_tuple<"?{div=8}">
          %iter_3375 = cute.get_iter(%view_3364) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3376, %e1_3377, %e2_3378, %e3_3379 = cute.get_leaves(%iter_3375) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1178 = cute.get_scalars(%e0_3376) : !cute.int_tuple<"?">
          %1179 = cute.get_scalars(%e1_3377) : !cute.int_tuple<"?">
          %1180 = cute.get_scalars(%e2_3378) : !cute.int_tuple<"?">
          %1181 = cute.get_scalars(%e3_3379) : !cute.int_tuple<"?{div=8}">
          %lay_3380 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1182 = cute.get_shape(%lay_3380) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3381, %e1_3382, %e2_3383, %e3_3384 = cute.get_leaves(%1182) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3385 = cute.to_int_tuple(%e0_3381) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1183 = cute.get_scalars(%itup_3385) : !cute.int_tuple<"?">
          %itup_3386 = cute.to_int_tuple(%e1_3382) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1184 = cute.get_scalars(%itup_3386) : !cute.int_tuple<"?">
          %itup_3387 = cute.to_int_tuple(%e2_3383) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1185 = cute.get_scalars(%itup_3387) : !cute.int_tuple<"?">
          %itup_3388 = cute.to_int_tuple(%e3_3384) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1186 = cute.get_scalars(%itup_3388) : !cute.int_tuple<"?{div=8}">
          %coord_3389 = cute.make_coord(%e1_3377) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3390 = cute.make_coord(%itup_3386) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1187 = cute.elem_less(%coord_3389, %coord_3390) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1187 {
            %coord_3455 = cute.make_coord(%sub_2085) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_3456 = cute.get_layout(%src_partitioned_377) : !memref_gmem_bf16_6
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_3458 = cute.get_iter(%src_partitioned_377) : !memref_gmem_bf16_6
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_gmem_bf16_8
            %iter_3461 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %iter_3462 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %coord_3463 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3464 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3465 = cute.crd2idx(%coord_3463, %lay_3464) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_3466 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3467 = cute.add_offset(%iter_3466, %idx_3465) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3468 = cute.make_view(%ptr_3467) : !memref_smem_bf16_12
            %iter_3469 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %iter_3470 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %coord_3471 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3472 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
            %idx_3473 = cute.crd2idx(%coord_3471, %lay_3472) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3474 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
            %ptr_3475 = cute.add_offset(%iter_3474, %idx_3473) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3476 = cute.make_view(%ptr_3475) : !memref_rmem_i8_1
            %iter_3477 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %iter_3478 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %lay_3479 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %1224 = cute.get_shape(%lay_3479) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3480, %e1_3481, %e2_3482 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %lay_3483 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %1225 = cute.get_shape(%lay_3483) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3484, %e1_3485, %e2_3486 = cute.get_leaves(%1225) : !cute.shape<"((8,1),2)">
            %lay_3487 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %shape_3488 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3489 = cute.make_layout() : !cute.layout<"1:0">
            %append_3490 = cute.append_to_rank<2> (%lay_3487, %lay_3489) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3491 = cute.make_view(%iter_3462, %append_3490) : !memref_gmem_bf16_8
            %iter_3492 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %lay_3493 = cute.get_layout(%view_3491) : !memref_gmem_bf16_8
            %1226 = cute.get_shape(%lay_3493) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3494, %e1_3495, %e2_3496 = cute.get_leaves(%1226) : !cute.shape<"((8,1),2)">
            %iter_3497 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %view_3498 = cute.make_view(%iter_3497) : !memref_gmem_bf16_9
            %iter_3499 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3500 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %lay_3501 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %shape_3502 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3503 = cute.make_layout() : !cute.layout<"1:0">
            %append_3504 = cute.append_to_rank<2> (%lay_3501, %lay_3503) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3505 = cute.make_view(%iter_3470, %append_3504) : !memref_smem_bf16_12
            %iter_3506 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %lay_3507 = cute.get_layout(%view_3505) : !memref_smem_bf16_12
            %1227 = cute.get_shape(%lay_3507) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3508, %e1_3509, %e2_3510 = cute.get_leaves(%1227) : !cute.shape<"((8,1),2)">
            %iter_3511 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %view_3512 = cute.make_view(%iter_3511) : !memref_smem_bf16_13
            %iter_3513 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %iter_3514 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3515 = cute.get_layout(%view_3476) : !memref_rmem_i8_1
            %shape_3516 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3517 = cute.make_layout() : !cute.layout<"1:0">
            %append_3518 = cute.append_to_rank<2> (%lay_3515, %lay_3517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3519 = cute.make_view(%iter_3478, %append_3518) : !memref_rmem_i8_1
            %iter_3520 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %lay_3521 = cute.get_layout(%view_3519) : !memref_rmem_i8_1
            %1228 = cute.get_shape(%lay_3521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3522, %e1_3523 = cute.get_leaves(%1228) : !cute.shape<"(1,2)">
            %iter_3524 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %view_3525 = cute.make_view(%iter_3524) : !memref_rmem_i8_2
            %iter_3526 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %iter_3527 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3528 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %1229 = cute.get_shape(%lay_3528) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3529, %e1_3530, %e2_3531 = cute.get_leaves(%1229) : !cute.shape<"((8,1),(2))">
            %lay_3532 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %1230 = cute.get_shape(%lay_3532) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3533, %e1_3534, %e2_3535 = cute.get_leaves(%1230) : !cute.shape<"((8,1),(2))">
            %lay_3536 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %sz_3537 = cute.size(%lay_3536) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3538 = cute.get_leaves(%sz_3537) : !cute.int_tuple<"2">
            %lay_3539 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %sz_3540 = cute.size(%lay_3539) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3541 = cute.get_leaves(%sz_3540) : !cute.int_tuple<"2">
            %1231 = cute.static : !cute.layout<"1:0">
            %iter_3542 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3543 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3544 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %lay_3545 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %append_3546 = cute.append_to_rank<2> (%lay_3544, %1231) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3547 = cute.append_to_rank<2> (%lay_3545, %1231) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3548 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3549 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3550 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3551 = cute.get_layout(%view_3525) : !memref_rmem_i8_2
            %append_3552 = cute.append_to_rank<2> (%lay_3551, %1231) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3553 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3554 = cute.size(%lay_3548) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1232 = cute.get_scalars(%sz_3554) : !cute.int_tuple<"2">
            %c0_i32_3555 = arith.constant 0 : i32
            %c1_i32_3556 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3555 to %1232 step %c1_i32_3556  : i32 {
              %coord_3557 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3558 = cute.slice(%lay_3548, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3559 = cute.crd2idx(%coord_3557, %lay_3548) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3560 = cute.add_offset(%iter_3542, %idx_3559) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3561 = cute.make_view(%ptr_3560, %slice_3558) : !memref_gmem_bf16_10
              %slice_3562 = cute.slice(%lay_3549, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3563 = cute.crd2idx(%coord_3557, %lay_3549) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3564 = cute.add_offset(%iter_3543, %idx_3563) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3565 = cute.make_view(%ptr_3564, %slice_3562) : !memref_smem_bf16_14
              %slice_3566 = cute.slice(%lay_3553, %coord_3557) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3567 = cute.crd2idx(%coord_3557, %lay_3553) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3568 = cute.add_offset(%iter_3550, %idx_3567) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3569 = cute.make_view(%ptr_3568, %slice_3566) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3561, %view_3565, %view_3569) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3455 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3456 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_3458 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_smem_bf16_12
            %iter_3461 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %iter_3462 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %lay_3463 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %sz_3464 = cute.size(%lay_3463) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3465 = cute.get_leaves(%sz_3464) : !cute.int_tuple<"16">
            %lay_3466 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %1224 = cute.get_shape(%lay_3466) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3467, %e1_3468, %e2_3469 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %int_tuple_3470 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3471 = cute.tuple.product(%int_tuple_3470) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3472 = cute.get_leaves(%res_3471) : !cute.int_tuple<"16">
            %cst_3473 = arith.constant 0.000000e+00 : bf16
            %1225 = vector.splat %cst_3473 : vector<16xbf16>
            %int_tuple_3474 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3475 = cute.size(%int_tuple_3474) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3476 = cute.get_leaves(%sz_3475) : !cute.int_tuple<"16">
            %int_tuple_3477 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3478 = cute.size(%int_tuple_3477) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3479 = cute.get_leaves(%sz_3478) : !cute.int_tuple<"16">
            cute.memref.store_vec %1225, %view_3460 : !memref_smem_bf16_12
          }
          %coord_3391 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_3392 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3393 = cute.crd2idx(%coord_3391, %lay_3392) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_3394 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3395 = cute.add_offset(%iter_3394, %idx_3393) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3396 = cute.make_view(%tup_3395) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3397 = cute.get_iter(%view_3396) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3398, %e1_3399, %e2_3400, %e3_3401 = cute.get_leaves(%iter_3397) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1188 = cute.get_scalars(%e0_3398) : !cute.int_tuple<"?">
          %1189 = cute.get_scalars(%e1_3399) : !cute.int_tuple<"?">
          %1190 = cute.get_scalars(%e2_3400) : !cute.int_tuple<"?">
          %1191 = cute.get_scalars(%e3_3401) : !cute.int_tuple<"?{div=8}">
          %iter_3402 = cute.get_iter(%view_3396) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3403, %e1_3404, %e2_3405, %e3_3406 = cute.get_leaves(%iter_3402) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1192 = cute.get_scalars(%e0_3403) : !cute.int_tuple<"?">
          %1193 = cute.get_scalars(%e1_3404) : !cute.int_tuple<"?">
          %1194 = cute.get_scalars(%e2_3405) : !cute.int_tuple<"?">
          %1195 = cute.get_scalars(%e3_3406) : !cute.int_tuple<"?{div=8}">
          %iter_3407 = cute.get_iter(%view_3396) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3408, %e1_3409, %e2_3410, %e3_3411 = cute.get_leaves(%iter_3407) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1196 = cute.get_scalars(%e0_3408) : !cute.int_tuple<"?">
          %1197 = cute.get_scalars(%e1_3409) : !cute.int_tuple<"?">
          %1198 = cute.get_scalars(%e2_3410) : !cute.int_tuple<"?">
          %1199 = cute.get_scalars(%e3_3411) : !cute.int_tuple<"?{div=8}">
          %lay_3412 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1200 = cute.get_shape(%lay_3412) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3413, %e1_3414, %e2_3415, %e3_3416 = cute.get_leaves(%1200) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3417 = cute.to_int_tuple(%e0_3413) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1201 = cute.get_scalars(%itup_3417) : !cute.int_tuple<"?">
          %itup_3418 = cute.to_int_tuple(%e1_3414) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1202 = cute.get_scalars(%itup_3418) : !cute.int_tuple<"?">
          %itup_3419 = cute.to_int_tuple(%e2_3415) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1203 = cute.get_scalars(%itup_3419) : !cute.int_tuple<"?">
          %itup_3420 = cute.to_int_tuple(%e3_3416) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1204 = cute.get_scalars(%itup_3420) : !cute.int_tuple<"?{div=8}">
          %coord_3421 = cute.make_coord(%e1_3409) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3422 = cute.make_coord(%itup_3418) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1205 = cute.elem_less(%coord_3421, %coord_3422) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1205 {
            %coord_3455 = cute.make_coord(%sub_2085) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_3456 = cute.get_layout(%src_partitioned_377) : !memref_gmem_bf16_6
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_3458 = cute.get_iter(%src_partitioned_377) : !memref_gmem_bf16_6
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_gmem_bf16_8
            %iter_3461 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %iter_3462 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %coord_3463 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3464 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3465 = cute.crd2idx(%coord_3463, %lay_3464) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_3466 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3467 = cute.add_offset(%iter_3466, %idx_3465) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3468 = cute.make_view(%ptr_3467) : !memref_smem_bf16_12
            %iter_3469 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %iter_3470 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %coord_3471 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3472 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
            %idx_3473 = cute.crd2idx(%coord_3471, %lay_3472) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3474 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
            %ptr_3475 = cute.add_offset(%iter_3474, %idx_3473) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3476 = cute.make_view(%ptr_3475) : !memref_rmem_i8_1
            %iter_3477 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %iter_3478 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %lay_3479 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %1224 = cute.get_shape(%lay_3479) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3480, %e1_3481, %e2_3482 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %lay_3483 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %1225 = cute.get_shape(%lay_3483) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3484, %e1_3485, %e2_3486 = cute.get_leaves(%1225) : !cute.shape<"((8,1),2)">
            %lay_3487 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %shape_3488 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3489 = cute.make_layout() : !cute.layout<"1:0">
            %append_3490 = cute.append_to_rank<2> (%lay_3487, %lay_3489) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3491 = cute.make_view(%iter_3462, %append_3490) : !memref_gmem_bf16_8
            %iter_3492 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %lay_3493 = cute.get_layout(%view_3491) : !memref_gmem_bf16_8
            %1226 = cute.get_shape(%lay_3493) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3494, %e1_3495, %e2_3496 = cute.get_leaves(%1226) : !cute.shape<"((8,1),2)">
            %iter_3497 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %view_3498 = cute.make_view(%iter_3497) : !memref_gmem_bf16_9
            %iter_3499 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3500 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %lay_3501 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %shape_3502 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3503 = cute.make_layout() : !cute.layout<"1:0">
            %append_3504 = cute.append_to_rank<2> (%lay_3501, %lay_3503) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3505 = cute.make_view(%iter_3470, %append_3504) : !memref_smem_bf16_12
            %iter_3506 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %lay_3507 = cute.get_layout(%view_3505) : !memref_smem_bf16_12
            %1227 = cute.get_shape(%lay_3507) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3508, %e1_3509, %e2_3510 = cute.get_leaves(%1227) : !cute.shape<"((8,1),2)">
            %iter_3511 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %view_3512 = cute.make_view(%iter_3511) : !memref_smem_bf16_13
            %iter_3513 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %iter_3514 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3515 = cute.get_layout(%view_3476) : !memref_rmem_i8_1
            %shape_3516 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3517 = cute.make_layout() : !cute.layout<"1:0">
            %append_3518 = cute.append_to_rank<2> (%lay_3515, %lay_3517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3519 = cute.make_view(%iter_3478, %append_3518) : !memref_rmem_i8_1
            %iter_3520 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %lay_3521 = cute.get_layout(%view_3519) : !memref_rmem_i8_1
            %1228 = cute.get_shape(%lay_3521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3522, %e1_3523 = cute.get_leaves(%1228) : !cute.shape<"(1,2)">
            %iter_3524 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %view_3525 = cute.make_view(%iter_3524) : !memref_rmem_i8_2
            %iter_3526 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %iter_3527 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3528 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %1229 = cute.get_shape(%lay_3528) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3529, %e1_3530, %e2_3531 = cute.get_leaves(%1229) : !cute.shape<"((8,1),(2))">
            %lay_3532 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %1230 = cute.get_shape(%lay_3532) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3533, %e1_3534, %e2_3535 = cute.get_leaves(%1230) : !cute.shape<"((8,1),(2))">
            %lay_3536 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %sz_3537 = cute.size(%lay_3536) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3538 = cute.get_leaves(%sz_3537) : !cute.int_tuple<"2">
            %lay_3539 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %sz_3540 = cute.size(%lay_3539) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3541 = cute.get_leaves(%sz_3540) : !cute.int_tuple<"2">
            %1231 = cute.static : !cute.layout<"1:0">
            %iter_3542 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3543 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3544 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %lay_3545 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %append_3546 = cute.append_to_rank<2> (%lay_3544, %1231) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3547 = cute.append_to_rank<2> (%lay_3545, %1231) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3548 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3549 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3550 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3551 = cute.get_layout(%view_3525) : !memref_rmem_i8_2
            %append_3552 = cute.append_to_rank<2> (%lay_3551, %1231) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3553 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3554 = cute.size(%lay_3548) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1232 = cute.get_scalars(%sz_3554) : !cute.int_tuple<"2">
            %c0_i32_3555 = arith.constant 0 : i32
            %c1_i32_3556 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3555 to %1232 step %c1_i32_3556  : i32 {
              %coord_3557 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3558 = cute.slice(%lay_3548, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3559 = cute.crd2idx(%coord_3557, %lay_3548) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3560 = cute.add_offset(%iter_3542, %idx_3559) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3561 = cute.make_view(%ptr_3560, %slice_3558) : !memref_gmem_bf16_10
              %slice_3562 = cute.slice(%lay_3549, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3563 = cute.crd2idx(%coord_3557, %lay_3549) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3564 = cute.add_offset(%iter_3543, %idx_3563) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3565 = cute.make_view(%ptr_3564, %slice_3562) : !memref_smem_bf16_14
              %slice_3566 = cute.slice(%lay_3553, %coord_3557) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3567 = cute.crd2idx(%coord_3557, %lay_3553) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3568 = cute.add_offset(%iter_3550, %idx_3567) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3569 = cute.make_view(%ptr_3568, %slice_3566) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3561, %view_3565, %view_3569) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3455 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3456 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_3458 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_smem_bf16_12
            %iter_3461 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %iter_3462 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %lay_3463 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %sz_3464 = cute.size(%lay_3463) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3465 = cute.get_leaves(%sz_3464) : !cute.int_tuple<"16">
            %lay_3466 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %1224 = cute.get_shape(%lay_3466) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3467, %e1_3468, %e2_3469 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %int_tuple_3470 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3471 = cute.tuple.product(%int_tuple_3470) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3472 = cute.get_leaves(%res_3471) : !cute.int_tuple<"16">
            %cst_3473 = arith.constant 0.000000e+00 : bf16
            %1225 = vector.splat %cst_3473 : vector<16xbf16>
            %int_tuple_3474 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3475 = cute.size(%int_tuple_3474) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3476 = cute.get_leaves(%sz_3475) : !cute.int_tuple<"16">
            %int_tuple_3477 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3478 = cute.size(%int_tuple_3477) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3479 = cute.get_leaves(%sz_3478) : !cute.int_tuple<"16">
            cute.memref.store_vec %1225, %view_3460 : !memref_smem_bf16_12
          }
          %coord_3423 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_3424 = cute.get_layout(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3425 = cute.crd2idx(%coord_3423, %lay_3424) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_3426 = cute.get_iter(%src_partitioned_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3427 = cute.add_offset(%iter_3426, %idx_3425) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3428 = cute.make_view(%tup_3427) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3429 = cute.get_iter(%view_3428) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3430, %e1_3431, %e2_3432, %e3_3433 = cute.get_leaves(%iter_3429) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1206 = cute.get_scalars(%e0_3430) : !cute.int_tuple<"?">
          %1207 = cute.get_scalars(%e1_3431) : !cute.int_tuple<"?">
          %1208 = cute.get_scalars(%e2_3432) : !cute.int_tuple<"?">
          %1209 = cute.get_scalars(%e3_3433) : !cute.int_tuple<"?{div=8}">
          %iter_3434 = cute.get_iter(%view_3428) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3435, %e1_3436, %e2_3437, %e3_3438 = cute.get_leaves(%iter_3434) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1210 = cute.get_scalars(%e0_3435) : !cute.int_tuple<"?">
          %1211 = cute.get_scalars(%e1_3436) : !cute.int_tuple<"?">
          %1212 = cute.get_scalars(%e2_3437) : !cute.int_tuple<"?">
          %1213 = cute.get_scalars(%e3_3438) : !cute.int_tuple<"?{div=8}">
          %iter_3439 = cute.get_iter(%view_3428) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3440, %e1_3441, %e2_3442, %e3_3443 = cute.get_leaves(%iter_3439) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1214 = cute.get_scalars(%e0_3440) : !cute.int_tuple<"?">
          %1215 = cute.get_scalars(%e1_3441) : !cute.int_tuple<"?">
          %1216 = cute.get_scalars(%e2_3442) : !cute.int_tuple<"?">
          %1217 = cute.get_scalars(%e3_3443) : !cute.int_tuple<"?{div=8}">
          %lay_3444 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1218 = cute.get_shape(%lay_3444) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3445, %e1_3446, %e2_3447, %e3_3448 = cute.get_leaves(%1218) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3449 = cute.to_int_tuple(%e0_3445) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1219 = cute.get_scalars(%itup_3449) : !cute.int_tuple<"?">
          %itup_3450 = cute.to_int_tuple(%e1_3446) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1220 = cute.get_scalars(%itup_3450) : !cute.int_tuple<"?">
          %itup_3451 = cute.to_int_tuple(%e2_3447) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1221 = cute.get_scalars(%itup_3451) : !cute.int_tuple<"?">
          %itup_3452 = cute.to_int_tuple(%e3_3448) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1222 = cute.get_scalars(%itup_3452) : !cute.int_tuple<"?{div=8}">
          %coord_3453 = cute.make_coord(%e1_3441) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3454 = cute.make_coord(%itup_3450) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1223 = cute.elem_less(%coord_3453, %coord_3454) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1223 {
            %coord_3455 = cute.make_coord(%sub_2085) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_3456 = cute.get_layout(%src_partitioned_377) : !memref_gmem_bf16_6
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_3458 = cute.get_iter(%src_partitioned_377) : !memref_gmem_bf16_6
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_gmem_bf16_8
            %iter_3461 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %iter_3462 = cute.get_iter(%view_3460) : !memref_gmem_bf16_8
            %coord_3463 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3464 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3465 = cute.crd2idx(%coord_3463, %lay_3464) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_3466 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3467 = cute.add_offset(%iter_3466, %idx_3465) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3468 = cute.make_view(%ptr_3467) : !memref_smem_bf16_12
            %iter_3469 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %iter_3470 = cute.get_iter(%view_3468) : !memref_smem_bf16_12
            %coord_3471 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3472 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
            %idx_3473 = cute.crd2idx(%coord_3471, %lay_3472) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_3474 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
            %ptr_3475 = cute.add_offset(%iter_3474, %idx_3473) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_3476 = cute.make_view(%ptr_3475) : !memref_rmem_i8_1
            %iter_3477 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %iter_3478 = cute.get_iter(%view_3476) : !memref_rmem_i8_1
            %lay_3479 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %1224 = cute.get_shape(%lay_3479) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3480, %e1_3481, %e2_3482 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %lay_3483 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %1225 = cute.get_shape(%lay_3483) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3484, %e1_3485, %e2_3486 = cute.get_leaves(%1225) : !cute.shape<"((8,1),2)">
            %lay_3487 = cute.get_layout(%view_3460) : !memref_gmem_bf16_8
            %shape_3488 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3489 = cute.make_layout() : !cute.layout<"1:0">
            %append_3490 = cute.append_to_rank<2> (%lay_3487, %lay_3489) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_3491 = cute.make_view(%iter_3462, %append_3490) : !memref_gmem_bf16_8
            %iter_3492 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %lay_3493 = cute.get_layout(%view_3491) : !memref_gmem_bf16_8
            %1226 = cute.get_shape(%lay_3493) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_3494, %e1_3495, %e2_3496 = cute.get_leaves(%1226) : !cute.shape<"((8,1),2)">
            %iter_3497 = cute.get_iter(%view_3491) : !memref_gmem_bf16_8
            %view_3498 = cute.make_view(%iter_3497) : !memref_gmem_bf16_9
            %iter_3499 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3500 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %lay_3501 = cute.get_layout(%view_3468) : !memref_smem_bf16_12
            %shape_3502 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3503 = cute.make_layout() : !cute.layout<"1:0">
            %append_3504 = cute.append_to_rank<2> (%lay_3501, %lay_3503) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_3505 = cute.make_view(%iter_3470, %append_3504) : !memref_smem_bf16_12
            %iter_3506 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %lay_3507 = cute.get_layout(%view_3505) : !memref_smem_bf16_12
            %1227 = cute.get_shape(%lay_3507) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3508, %e1_3509, %e2_3510 = cute.get_leaves(%1227) : !cute.shape<"((8,1),2)">
            %iter_3511 = cute.get_iter(%view_3505) : !memref_smem_bf16_12
            %view_3512 = cute.make_view(%iter_3511) : !memref_smem_bf16_13
            %iter_3513 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %iter_3514 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3515 = cute.get_layout(%view_3476) : !memref_rmem_i8_1
            %shape_3516 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3517 = cute.make_layout() : !cute.layout<"1:0">
            %append_3518 = cute.append_to_rank<2> (%lay_3515, %lay_3517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_3519 = cute.make_view(%iter_3478, %append_3518) : !memref_rmem_i8_1
            %iter_3520 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %lay_3521 = cute.get_layout(%view_3519) : !memref_rmem_i8_1
            %1228 = cute.get_shape(%lay_3521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_3522, %e1_3523 = cute.get_leaves(%1228) : !cute.shape<"(1,2)">
            %iter_3524 = cute.get_iter(%view_3519) : !memref_rmem_i8_1
            %view_3525 = cute.make_view(%iter_3524) : !memref_rmem_i8_2
            %iter_3526 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %iter_3527 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3528 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %1229 = cute.get_shape(%lay_3528) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_3529, %e1_3530, %e2_3531 = cute.get_leaves(%1229) : !cute.shape<"((8,1),(2))">
            %lay_3532 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %1230 = cute.get_shape(%lay_3532) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_3533, %e1_3534, %e2_3535 = cute.get_leaves(%1230) : !cute.shape<"((8,1),(2))">
            %lay_3536 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %sz_3537 = cute.size(%lay_3536) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_3538 = cute.get_leaves(%sz_3537) : !cute.int_tuple<"2">
            %lay_3539 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %sz_3540 = cute.size(%lay_3539) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_3541 = cute.get_leaves(%sz_3540) : !cute.int_tuple<"2">
            %1231 = cute.static : !cute.layout<"1:0">
            %iter_3542 = cute.get_iter(%view_3498) : !memref_gmem_bf16_9
            %iter_3543 = cute.get_iter(%view_3512) : !memref_smem_bf16_13
            %lay_3544 = cute.get_layout(%view_3498) : !memref_gmem_bf16_9
            %lay_3545 = cute.get_layout(%view_3512) : !memref_smem_bf16_13
            %append_3546 = cute.append_to_rank<2> (%lay_3544, %1231) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_3547 = cute.append_to_rank<2> (%lay_3545, %1231) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_3548 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_3549 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_3550 = cute.get_iter(%view_3525) : !memref_rmem_i8_2
            %lay_3551 = cute.get_layout(%view_3525) : !memref_rmem_i8_2
            %append_3552 = cute.append_to_rank<2> (%lay_3551, %1231) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_3553 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_3554 = cute.size(%lay_3548) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1232 = cute.get_scalars(%sz_3554) : !cute.int_tuple<"2">
            %c0_i32_3555 = arith.constant 0 : i32
            %c1_i32_3556 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3555 to %1232 step %c1_i32_3556  : i32 {
              %coord_3557 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3558 = cute.slice(%lay_3548, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_3559 = cute.crd2idx(%coord_3557, %lay_3548) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_3560 = cute.add_offset(%iter_3542, %idx_3559) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3561 = cute.make_view(%ptr_3560, %slice_3558) : !memref_gmem_bf16_10
              %slice_3562 = cute.slice(%lay_3549, %coord_3557) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_3563 = cute.crd2idx(%coord_3557, %lay_3549) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_3564 = cute.add_offset(%iter_3543, %idx_3563) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3565 = cute.make_view(%ptr_3564, %slice_3562) : !memref_smem_bf16_14
              %slice_3566 = cute.slice(%lay_3553, %coord_3557) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_3567 = cute.crd2idx(%coord_3557, %lay_3553) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_3568 = cute.add_offset(%iter_3550, %idx_3567) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_3569 = cute.make_view(%ptr_3568, %slice_3566) : !memref_rmem_i8_3
              cute.copy_atom_call(%4, %view_3561, %view_3565, %view_3569) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3455 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3456 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
            %idx_3457 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_3458 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
            %ptr_3459 = cute.add_offset(%iter_3458, %idx_3457) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3460 = cute.make_view(%ptr_3459) : !memref_smem_bf16_12
            %iter_3461 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %iter_3462 = cute.get_iter(%view_3460) : !memref_smem_bf16_12
            %lay_3463 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %sz_3464 = cute.size(%lay_3463) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_3465 = cute.get_leaves(%sz_3464) : !cute.int_tuple<"16">
            %lay_3466 = cute.get_layout(%view_3460) : !memref_smem_bf16_12
            %1224 = cute.get_shape(%lay_3466) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_3467, %e1_3468, %e2_3469 = cute.get_leaves(%1224) : !cute.shape<"((8,1),2)">
            %int_tuple_3470 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_3471 = cute.tuple.product(%int_tuple_3470) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3472 = cute.get_leaves(%res_3471) : !cute.int_tuple<"16">
            %cst_3473 = arith.constant 0.000000e+00 : bf16
            %1225 = vector.splat %cst_3473 : vector<16xbf16>
            %int_tuple_3474 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3475 = cute.size(%int_tuple_3474) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3476 = cute.get_leaves(%sz_3475) : !cute.int_tuple<"16">
            %int_tuple_3477 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_3478 = cute.size(%int_tuple_3477) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_3479 = cute.get_leaves(%sz_3478) : !cute.int_tuple<"16">
            cute.memref.store_vec %1225, %view_3460 : !memref_smem_bf16_12
          }
        } else {
          %coord_3319 = cute.make_coord(%sub_2085) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_3320 = cute.get_layout(%src_partitioned_377) : !memref_gmem_bf16_6
          %slice_3321 = cute.slice(%lay_3320, %coord_3319) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_3322 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_3323 = cute.get_iter(%src_partitioned_377) : !memref_gmem_bf16_6
          %ptr_3324 = cute.add_offset(%iter_3323, %idx_3322) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_3325 = cute.make_view(%ptr_3324, %slice_3321) : !memref_gmem_bf16_5
          %iter_3326 = cute.get_iter(%view_3325) : !memref_gmem_bf16_5
          %iter_3327 = cute.get_iter(%view_3325) : !memref_gmem_bf16_5
          %coord_3328 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3329 = cute.get_layout(%dst_partitioned_380) : !memref_smem_bf16_3
          %idx_3330 = cute.crd2idx(%coord_3328, %lay_3329) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_3331 = cute.get_iter(%dst_partitioned_380) : !memref_smem_bf16_3
          %ptr_3332 = cute.add_offset(%iter_3331, %idx_3330) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3333 = cute.make_view(%ptr_3332) : !memref_smem_bf16_3
          %iter_3334 = cute.get_iter(%view_3333) : !memref_smem_bf16_3
          %iter_3335 = cute.get_iter(%view_3333) : !memref_smem_bf16_3
          %coord_3336 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3337 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
          %idx_3338 = cute.crd2idx(%coord_3336, %lay_3337) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_3339 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
          %ptr_3340 = cute.add_offset(%iter_3339, %idx_3338) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_3341 = cute.make_view(%ptr_3340) : !memref_rmem_i8_
          %iter_3342 = cute.get_iter(%view_3341) : !memref_rmem_i8_
          %iter_3343 = cute.get_iter(%view_3341) : !memref_rmem_i8_
          %lay_3344 = cute.get_layout(%view_3325) : !memref_gmem_bf16_5
          %1151 = cute.get_shape(%lay_3344) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3345, %e1_3346, %e2_3347, %e3_3348 = cute.get_leaves(%1151) : !cute.shape<"((8,1),4,2)">
          %lay_3349 = cute.get_layout(%view_3333) : !memref_smem_bf16_3
          %1152 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3350, %e1_3351, %e2_3352, %e3_3353 = cute.get_leaves(%1152) : !cute.shape<"((8,1),4,2)">
          %lay_3354 = cute.get_layout(%view_3325) : !memref_gmem_bf16_5
          %shape_3355 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3356 = cute.make_layout() : !cute.layout<"1:0">
          %append_3357 = cute.append_to_rank<2> (%lay_3354, %lay_3356) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_3358 = cute.make_view(%iter_3327, %append_3357) : !memref_gmem_bf16_5
          %iter_3359 = cute.get_iter(%view_3358) : !memref_gmem_bf16_5
          %lay_3360 = cute.get_layout(%view_3358) : !memref_gmem_bf16_5
          %1153 = cute.get_shape(%lay_3360) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3361, %e1_3362, %e2_3363, %e3_3364 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4,2)">
          %iter_3365 = cute.get_iter(%view_3358) : !memref_gmem_bf16_5
          %lay_3366 = cute.get_layout(%view_3358) : !memref_gmem_bf16_5
          %1154 = cute.get_scalars(%lay_3366) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_3367 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_3368 = cute.assume(%1154) : (i64) -> !cute.i64<divby 128>
          %stride_3369 = cute.make_stride(%iv_3368) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_3370 = cute.make_layout(%shape_3367, %stride_3369) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_3371 = cute.make_view(%iter_3365, %lay_3370) : !memref_gmem_bf16_13
          %iter_3372 = cute.get_iter(%view_3371) : !memref_gmem_bf16_13
          %iter_3373 = cute.get_iter(%view_3371) : !memref_gmem_bf16_13
          %lay_3374 = cute.get_layout(%view_3333) : !memref_smem_bf16_3
          %shape_3375 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3376 = cute.make_layout() : !cute.layout<"1:0">
          %append_3377 = cute.append_to_rank<2> (%lay_3374, %lay_3376) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_3378 = cute.make_view(%iter_3335, %append_3377) : !memref_smem_bf16_3
          %iter_3379 = cute.get_iter(%view_3378) : !memref_smem_bf16_3
          %lay_3380 = cute.get_layout(%view_3378) : !memref_smem_bf16_3
          %1155 = cute.get_shape(%lay_3380) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3381, %e1_3382, %e2_3383, %e3_3384 = cute.get_leaves(%1155) : !cute.shape<"((8,1),4,2)">
          %iter_3385 = cute.get_iter(%view_3378) : !memref_smem_bf16_3
          %view_3386 = cute.make_view(%iter_3385) : !memref_smem_bf16_17
          %iter_3387 = cute.get_iter(%view_3386) : !memref_smem_bf16_17
          %iter_3388 = cute.get_iter(%view_3386) : !memref_smem_bf16_17
          %lay_3389 = cute.get_layout(%view_3341) : !memref_rmem_i8_
          %shape_3390 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3391 = cute.make_layout() : !cute.layout<"1:0">
          %append_3392 = cute.append_to_rank<2> (%lay_3389, %lay_3391) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_3393 = cute.make_view(%iter_3343, %append_3392) : !memref_rmem_i8_
          %iter_3394 = cute.get_iter(%view_3393) : !memref_rmem_i8_
          %lay_3395 = cute.get_layout(%view_3393) : !memref_rmem_i8_
          %1156 = cute.get_shape(%lay_3395) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_3396, %e1_3397, %e2_3398 = cute.get_leaves(%1156) : !cute.shape<"(1,4,2)">
          %iter_3399 = cute.get_iter(%view_3393) : !memref_rmem_i8_
          %view_3400 = cute.make_view(%iter_3399) : !memref_rmem_i8_4
          %iter_3401 = cute.get_iter(%view_3400) : !memref_rmem_i8_4
          %iter_3402 = cute.get_iter(%view_3400) : !memref_rmem_i8_4
          %lay_3403 = cute.get_layout(%view_3371) : !memref_gmem_bf16_13
          %1157 = cute.get_shape(%lay_3403) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3404, %e1_3405, %e2_3406, %e3_3407 = cute.get_leaves(%1157) : !cute.shape<"((8,1),(4,2))">
          %lay_3408 = cute.get_layout(%view_3386) : !memref_smem_bf16_17
          %1158 = cute.get_shape(%lay_3408) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3409, %e1_3410, %e2_3411, %e3_3412 = cute.get_leaves(%1158) : !cute.shape<"((8,1),(4,2))">
          %lay_3413 = cute.get_layout(%view_3371) : !memref_gmem_bf16_13
          %sz_3414 = cute.size(%lay_3413) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_3415 = cute.get_leaves(%sz_3414) : !cute.int_tuple<"8">
          %lay_3416 = cute.get_layout(%view_3386) : !memref_smem_bf16_17
          %sz_3417 = cute.size(%lay_3416) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_3418 = cute.get_leaves(%sz_3417) : !cute.int_tuple<"8">
          %1159 = cute.static : !cute.layout<"1:0">
          %iter_3419 = cute.get_iter(%view_3371) : !memref_gmem_bf16_13
          %iter_3420 = cute.get_iter(%view_3386) : !memref_smem_bf16_17
          %lay_3421 = cute.get_layout(%view_3371) : !memref_gmem_bf16_13
          %lay_3422 = cute.get_layout(%view_3386) : !memref_smem_bf16_17
          %append_3423 = cute.append_to_rank<2> (%lay_3421, %1159) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3422, %1159) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1160 = cute.get_scalars(%append_3423) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_3425 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_3426 = cute.assume(%1160) : (i64) -> !cute.i64<divby 128>
          %stride_3427 = cute.make_stride(%iv_3426) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_3428 = cute.make_layout(%shape_3425, %stride_3427) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_3429 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_3430 = cute.get_iter(%view_3400) : !memref_rmem_i8_4
          %lay_3431 = cute.get_layout(%view_3400) : !memref_rmem_i8_4
          %append_3432 = cute.append_to_rank<2> (%lay_3431, %1159) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_3433 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_3434 = cute.size(%lay_3428) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1161 = cute.get_scalars(%sz_3434) : !cute.int_tuple<"8">
          %c0_i32_3435 = arith.constant 0 : i32
          %c1_i32_3436 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3435 to %1161 step %c1_i32_3436  : i32 {
            %coord_3437 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3438 = cute.slice(%lay_3428, %coord_3437) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_3439 = cute.crd2idx(%coord_3437, %lay_3428) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_3440 = cute.add_offset(%iter_3419, %idx_3439) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3441 = cute.make_view(%ptr_3440, %slice_3438) : !memref_gmem_bf16_10
            %slice_3442 = cute.slice(%lay_3429, %coord_3437) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_3443 = cute.crd2idx(%coord_3437, %lay_3429) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3444 = cute.add_offset(%iter_3420, %idx_3443) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3445 = cute.make_view(%ptr_3444, %slice_3442) : !memref_smem_bf16_14
            %slice_3446 = cute.slice(%lay_3433, %coord_3437) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_3447 = cute.crd2idx(%coord_3437, %lay_3433) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_3448 = cute.add_offset(%iter_3430, %idx_3447) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_3449 = cute.make_view(%ptr_3448, %slice_3446) : !memref_rmem_i8_3
            cute.copy_atom_call(%4, %view_3441, %view_3445, %view_3449) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %shape_2088 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %930 = cute.tiled.mma.partition_shape C (%arg6, %shape_2088) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(64,64)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2089, %e1_2090, %e2_2091, %e3_2092 = cute.get_leaves(%930) : !cute.shape<"((2,2),1,8)">
        %shape_2093 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2094 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2095 = cute.memref.alloca(%lay_2094) : !memref_rmem_f32_1
        %iter_2096 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2097 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %shape_2098 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %931 = cute.tiled.mma.partition_shape C (%arg6, %shape_2098) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(64,64)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2099, %e1_2100, %e2_2101, %e3_2102 = cute.get_leaves(%931) : !cute.shape<"((2,2),1,8)">
        %shape_2103 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2104 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2105 = cute.memref.alloca(%lay_2104) : !memref_rmem_bf16_6
        %iter_2106 = cute.get_iter(%rmem_2105) : !memref_rmem_bf16_6
        %iter_2107 = cute.get_iter(%rmem_2105) : !memref_rmem_bf16_6
        %retiled_2108 = cute.tiled.copy.retile(%arg7, %rmem_2105) : (!copy_ldsm_4_3, !memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_2109 = cute.get_iter(%retiled_2108) : !memref_rmem_bf16_7
        %coord_2110 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2111 = cute.get_layout(%src_partitioned_489) : !memref_smem_bf16_11
        %slice_2112 = cute.slice(%lay_2111, %coord_2110) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">, !cute.coord<"(_,_,_)">
        %idx_2113 = cute.crd2idx(%coord_2110, %lay_2111) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.int_tuple<"0">
        %iter_2114 = cute.get_iter(%src_partitioned_489) : !memref_smem_bf16_11
        %ptr_2115 = cute.add_offset(%iter_2114, %idx_2113) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2116 = cute.make_view(%ptr_2115, %slice_2112) : !memref_smem_bf16_11
        %iter_2117 = cute.get_iter(%view_2116) : !memref_smem_bf16_11
        %iter_2118 = cute.get_iter(%view_2116) : !memref_smem_bf16_11
        %coord_2119 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2120 = cute.get_layout(%retiled_2108) : !memref_rmem_bf16_7
        %idx_2121 = cute.crd2idx(%coord_2119, %lay_2120) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.int_tuple<"0">
        %iter_2122 = cute.get_iter(%retiled_2108) : !memref_rmem_bf16_7
        %ptr_2123 = cute.add_offset(%iter_2122, %idx_2121) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2124 = cute.make_view(%ptr_2123) : !memref_rmem_bf16_7
        %iter_2125 = cute.get_iter(%view_2124) : !memref_rmem_bf16_7
        %iter_2126 = cute.get_iter(%view_2124) : !memref_rmem_bf16_7
        %lay_2127 = cute.get_layout(%view_2116) : !memref_smem_bf16_11
        %932 = cute.get_shape(%lay_2127) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2128, %e1_2129, %e2_2130, %e3_2131, %e4_2132 = cute.get_leaves(%932) : !cute.shape<"((8,1),1,(2,2))">
        %lay_2133 = cute.get_layout(%view_2124) : !memref_rmem_bf16_7
        %933 = cute.get_shape(%lay_2133) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2134, %e1_2135, %e2_2136, %e3_2137 = cute.get_leaves(%933) : !cute.shape<"((8,1),1,4)">
        %lay_2138 = cute.get_layout(%view_2116) : !memref_smem_bf16_11
        %shape_2139 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2140 = cute.make_layout() : !cute.layout<"1:0">
        %append_2141 = cute.append_to_rank<2> (%lay_2138, %lay_2140) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">, !cute.layout<"1:0">
        %view_2142 = cute.make_view(%iter_2118, %append_2141) : !memref_smem_bf16_11
        %iter_2143 = cute.get_iter(%view_2142) : !memref_smem_bf16_11
        %lay_2144 = cute.get_layout(%view_2142) : !memref_smem_bf16_11
        %934 = cute.get_shape(%lay_2144) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2145, %e1_2146, %e2_2147, %e3_2148, %e4_2149 = cute.get_leaves(%934) : !cute.shape<"((8,1),1,(2,2))">
        %iter_2150 = cute.get_iter(%view_2142) : !memref_smem_bf16_11
        %lay_2151 = cute.get_layout(%view_2142) : !memref_smem_bf16_11
        %935:2 = cute.get_scalars(%lay_2151) <{only_dynamic}> : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %shape_2152 = cute.make_shape() : () -> !cute.shape<"((8,1),(1,(2,2)))">
        %iv_2153 = cute.assume(%935#0) : (i32) -> !cute.i32<divby 16>
        %iv_2154 = cute.assume(%935#1) : (i32) -> !cute.i32<divby 32>
        %stride_2155 = cute.make_stride(%iv_2153, %iv_2154) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(0,(?{div=16},?{div=32})))">
        %lay_2156 = cute.make_layout(%shape_2152, %stride_2155) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %view_2157 = cute.make_view(%iter_2150, %lay_2156) : !memref_smem_bf16_18
        %iter_2158 = cute.get_iter(%view_2157) : !memref_smem_bf16_18
        %iter_2159 = cute.get_iter(%view_2157) : !memref_smem_bf16_18
        %lay_2160 = cute.get_layout(%view_2124) : !memref_rmem_bf16_7
        %shape_2161 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2162 = cute.make_layout() : !cute.layout<"1:0">
        %append_2163 = cute.append_to_rank<2> (%lay_2160, %lay_2162) : !cute.layout<"((8,1),1,4):((1,0),0,8)">, !cute.layout<"1:0">
        %view_2164 = cute.make_view(%iter_2126, %append_2163) : !memref_rmem_bf16_7
        %iter_2165 = cute.get_iter(%view_2164) : !memref_rmem_bf16_7
        %lay_2166 = cute.get_layout(%view_2164) : !memref_rmem_bf16_7
        %936 = cute.get_shape(%lay_2166) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2167, %e1_2168, %e2_2169, %e3_2170 = cute.get_leaves(%936) : !cute.shape<"((8,1),1,4)">
        %iter_2171 = cute.get_iter(%view_2164) : !memref_rmem_bf16_7
        %view_2172 = cute.make_view(%iter_2171) : !memref_rmem_bf16_8
        %iter_2173 = cute.get_iter(%view_2172) : !memref_rmem_bf16_8
        %iter_2174 = cute.get_iter(%view_2172) : !memref_rmem_bf16_8
        %lay_2175 = cute.get_layout(%view_2157) : !memref_smem_bf16_18
        %937 = cute.get_shape(%lay_2175) : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.shape<"((8,1),(1,(2,2)))">
        %e0_2176, %e1_2177, %e2_2178, %e3_2179, %e4_2180 = cute.get_leaves(%937) : !cute.shape<"((8,1),(1,(2,2)))">
        %lay_2181 = cute.get_layout(%view_2172) : !memref_rmem_bf16_8
        %938 = cute.get_shape(%lay_2181) : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.shape<"((8,1),(1,4))">
        %e0_2182, %e1_2183, %e2_2184, %e3_2185 = cute.get_leaves(%938) : !cute.shape<"((8,1),(1,4))">
        %lay_2186 = cute.get_layout(%view_2157) : !memref_smem_bf16_18
        %sz_2187 = cute.size(%lay_2186) <{mode = [1]}> : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.int_tuple<"4">
        %e0_2188 = cute.get_leaves(%sz_2187) : !cute.int_tuple<"4">
        %lay_2189 = cute.get_layout(%view_2172) : !memref_rmem_bf16_8
        %sz_2190 = cute.size(%lay_2189) <{mode = [1]}> : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.int_tuple<"4">
        %e0_2191 = cute.get_leaves(%sz_2190) : !cute.int_tuple<"4">
        %939 = cute.static : !cute.layout<"1:0">
        %iter_2192 = cute.get_iter(%view_2157) : !memref_smem_bf16_18
        %iter_2193 = cute.get_iter(%view_2172) : !memref_rmem_bf16_8
        %lay_2194 = cute.get_layout(%view_2157) : !memref_smem_bf16_18
        %lay_2195 = cute.get_layout(%view_2172) : !memref_rmem_bf16_8
        %append_2196 = cute.append_to_rank<2> (%lay_2194, %939) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">, !cute.layout<"1:0">
        %append_2197 = cute.append_to_rank<2> (%lay_2195, %939) : !cute.layout<"((8,1),(1,4)):((1,0),(0,8))">, !cute.layout<"1:0">
        %940:2 = cute.get_scalars(%append_2196) <{only_dynamic}> : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %shape_2198 = cute.make_shape() : () -> !cute.shape<"((8,1),((1,(2,2))))">
        %iv_2199 = cute.assume(%940#0) : (i32) -> !cute.i32<divby 16>
        %iv_2200 = cute.assume(%940#1) : (i32) -> !cute.i32<divby 32>
        %stride_2201 = cute.make_stride(%iv_2199, %iv_2200) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2202 = cute.make_layout(%shape_2198, %stride_2201) : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2203 = cute.make_layout() : !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">
        %sz_2204 = cute.size(%lay_2202) <{mode = [1]}> : (!cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"4">
        %941 = cute.get_scalars(%sz_2204) : !cute.int_tuple<"4">
        %c0_i32_2205 = arith.constant 0 : i32
        %c1_i32_2206 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2205 to %941 step %c1_i32_2206  : i32 {
          %coord_3319 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3320 = cute.slice(%lay_2202, %coord_3319) : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">, !cute.coord<"(_,?)">
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_2202) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_3322 = cute.add_offset(%iter_2192, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3323 = cute.make_view(%ptr_3322, %slice_3320) : !memref_smem_bf16_14
          %slice_3324 = cute.slice(%lay_2203, %coord_3319) : !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">, !cute.coord<"(_,?)">
          %idx_3325 = cute.crd2idx(%coord_3319, %lay_2203) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_3326 = cute.add_offset(%iter_2193, %idx_3325) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3327 = cute.make_view(%ptr_3326, %slice_3324) : !memref_rmem_bf16_9
          cute.copy_atom_call(%191, %view_3323, %view_3327) : (!copy_ldsm_4_3, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2207 = cute.get_layout(%rmem_2105) : !memref_rmem_bf16_6
        %942 = cute.get_shape(%lay_2207) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2208, %e1_2209, %e2_2210, %e3_2211 = cute.get_leaves(%942) : !cute.shape<"((2,2),1,8)">
        %943 = cute.memref.load_vec %rmem_2105 : !memref_rmem_bf16_6
        %944 = arith.extf %943 : vector<32xbf16> to vector<32xf32>
        %lay_2212 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %945 = cute.get_shape(%lay_2212) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2213, %e1_2214, %e2_2215, %e3_2216 = cute.get_leaves(%945) : !cute.shape<"((2,2),1,8)">
        %int_tuple_2217 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2218 = cute.size(%int_tuple_2217) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2219 = cute.get_leaves(%sz_2218) : !cute.int_tuple<"32">
        %int_tuple_2220 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2221 = cute.size(%int_tuple_2220) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2222 = cute.get_leaves(%sz_2221) : !cute.int_tuple<"32">
        cute.memref.store_vec %944, %rmem_2095 : !memref_rmem_f32_1
        %coord_2223 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2224 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
        %idx_2225 = cute.crd2idx(%coord_2223, %lay_2224) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2226 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
        %ptr_2227 = cute.add_offset(%iter_2226, %idx_2225) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2228 = cute.make_view(%ptr_2227) : !memref_smem_bf16_15
        %iter_2229 = cute.get_iter(%view_2228) : !memref_smem_bf16_15
        %iter_2230 = cute.get_iter(%view_2228) : !memref_smem_bf16_15
        %coord_2231 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2232 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_2233 = cute.crd2idx(%coord_2231, %lay_2232) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"0">
        %iter_2234 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_2235 = cute.add_offset(%iter_2234, %idx_2233) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2236 = cute.make_view(%ptr_2235) : !memref_rmem_bf16_10
        %iter_2237 = cute.get_iter(%view_2236) : !memref_rmem_bf16_10
        %iter_2238 = cute.get_iter(%view_2236) : !memref_rmem_bf16_10
        %lay_2239 = cute.get_layout(%view_2228) : !memref_smem_bf16_15
        %946 = cute.get_shape(%lay_2239) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2240, %e1_2241, %e2_2242 = cute.get_leaves(%946) : !cute.shape<"((8,1),1)">
        %lay_2243 = cute.get_layout(%view_2236) : !memref_rmem_bf16_10
        %947 = cute.get_shape(%lay_2243) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2244, %e1_2245, %e2_2246 = cute.get_leaves(%947) : !cute.shape<"((8,1),1)">
        %lay_2247 = cute.get_layout(%view_2228) : !memref_smem_bf16_15
        %shape_2248 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2249 = cute.make_layout() : !cute.layout<"1:0">
        %append_2250 = cute.append_to_rank<2> (%lay_2247, %lay_2249) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2251 = cute.make_view(%iter_2230, %append_2250) : !memref_smem_bf16_15
        %iter_2252 = cute.get_iter(%view_2251) : !memref_smem_bf16_15
        %lay_2253 = cute.get_layout(%view_2251) : !memref_smem_bf16_15
        %948 = cute.get_shape(%lay_2253) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2254, %e1_2255, %e2_2256 = cute.get_leaves(%948) : !cute.shape<"((8,1),1)">
        %iter_2257 = cute.get_iter(%view_2251) : !memref_smem_bf16_15
        %view_2258 = cute.make_view(%iter_2257) : !memref_smem_bf16_16
        %iter_2259 = cute.get_iter(%view_2258) : !memref_smem_bf16_16
        %iter_2260 = cute.get_iter(%view_2258) : !memref_smem_bf16_16
        %lay_2261 = cute.get_layout(%view_2236) : !memref_rmem_bf16_10
        %shape_2262 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2263 = cute.make_layout() : !cute.layout<"1:0">
        %append_2264 = cute.append_to_rank<2> (%lay_2261, %lay_2263) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2265 = cute.make_view(%iter_2238, %append_2264) : !memref_rmem_bf16_10
        %iter_2266 = cute.get_iter(%view_2265) : !memref_rmem_bf16_10
        %lay_2267 = cute.get_layout(%view_2265) : !memref_rmem_bf16_10
        %949 = cute.get_shape(%lay_2267) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2268, %e1_2269, %e2_2270 = cute.get_leaves(%949) : !cute.shape<"((8,1),1)">
        %iter_2271 = cute.get_iter(%view_2265) : !memref_rmem_bf16_10
        %view_2272 = cute.make_view(%iter_2271) : !memref_rmem_bf16_11
        %iter_2273 = cute.get_iter(%view_2272) : !memref_rmem_bf16_11
        %iter_2274 = cute.get_iter(%view_2272) : !memref_rmem_bf16_11
        %lay_2275 = cute.get_layout(%view_2258) : !memref_smem_bf16_16
        %950 = cute.get_shape(%lay_2275) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2276, %e1_2277, %e2_2278 = cute.get_leaves(%950) : !cute.shape<"((8,1),(1))">
        %lay_2279 = cute.get_layout(%view_2272) : !memref_rmem_bf16_11
        %951 = cute.get_shape(%lay_2279) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2280, %e1_2281, %e2_2282 = cute.get_leaves(%951) : !cute.shape<"((8,1),(1))">
        %lay_2283 = cute.get_layout(%view_2258) : !memref_smem_bf16_16
        %sz_2284 = cute.size(%lay_2283) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2285 = cute.get_leaves(%sz_2284) : !cute.int_tuple<"1">
        %lay_2286 = cute.get_layout(%view_2272) : !memref_rmem_bf16_11
        %sz_2287 = cute.size(%lay_2286) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2288 = cute.get_leaves(%sz_2287) : !cute.int_tuple<"1">
        %952 = cute.static : !cute.layout<"1:0">
        %iter_2289 = cute.get_iter(%view_2258) : !memref_smem_bf16_16
        %iter_2290 = cute.get_iter(%view_2272) : !memref_rmem_bf16_11
        %lay_2291 = cute.get_layout(%view_2258) : !memref_smem_bf16_16
        %lay_2292 = cute.get_layout(%view_2272) : !memref_rmem_bf16_11
        %append_2293 = cute.append_to_rank<2> (%lay_2291, %952) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2294 = cute.append_to_rank<2> (%lay_2292, %952) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2295 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2296 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2297 = cute.size(%lay_2295) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %953 = cute.get_scalars(%sz_2297) : !cute.int_tuple<"1">
        %c0_i32_2298 = arith.constant 0 : i32
        %c1_i32_2299 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2298 to %953 step %c1_i32_2299  : i32 {
          %coord_3319 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3320 = cute.slice(%lay_2295, %coord_3319) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_2295) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_3322 = cute.add_offset(%iter_2289, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3323 = cute.make_view(%ptr_3322, %slice_3320) : !memref_smem_bf16_14
          %slice_3324 = cute.slice(%lay_2296, %coord_3319) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
          %idx_3325 = cute.crd2idx(%coord_3319, %lay_2296) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_3326 = cute.add_offset(%iter_2290, %idx_3325) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3327 = cute.make_view(%ptr_3326, %slice_3324) : !memref_rmem_bf16_9
          cute.copy_atom_call(%179, %view_3323, %view_3327) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_2300 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2301 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
        %idx_2302 = cute.crd2idx(%coord_2300, %lay_2301) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2303 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
        %ptr_2304 = cute.add_offset(%iter_2303, %idx_2302) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2305 = cute.make_view(%ptr_2304) : !memref_smem_bf16_19
        %iter_2306 = cute.get_iter(%view_2305) : !memref_smem_bf16_19
        %iter_2307 = cute.get_iter(%view_2305) : !memref_smem_bf16_19
        %coord_2308 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2309 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
        %idx_2310 = cute.crd2idx(%coord_2308, %lay_2309) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"0">
        %iter_2311 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
        %ptr_2312 = cute.add_offset(%iter_2311, %idx_2310) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2313 = cute.make_view(%ptr_2312) : !memref_rmem_bf16_12
        %iter_2314 = cute.get_iter(%view_2313) : !memref_rmem_bf16_12
        %iter_2315 = cute.get_iter(%view_2313) : !memref_rmem_bf16_12
        %lay_2316 = cute.get_layout(%view_2305) : !memref_smem_bf16_19
        %954 = cute.get_shape(%lay_2316) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2317, %e1_2318, %e2_2319 = cute.get_leaves(%954) : !cute.shape<"((8,1),4)">
        %lay_2320 = cute.get_layout(%view_2313) : !memref_rmem_bf16_12
        %955 = cute.get_shape(%lay_2320) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_2321, %e1_2322, %e2_2323, %e3_2324 = cute.get_leaves(%955) : !cute.shape<"(((4,2),1),4)">
        %lay_2325 = cute.get_layout(%view_2305) : !memref_smem_bf16_19
        %shape_2326 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2327 = cute.make_layout() : !cute.layout<"1:0">
        %append_2328 = cute.append_to_rank<2> (%lay_2325, %lay_2327) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_2329 = cute.make_view(%iter_2307, %append_2328) : !memref_smem_bf16_19
        %iter_2330 = cute.get_iter(%view_2329) : !memref_smem_bf16_19
        %lay_2331 = cute.get_layout(%view_2329) : !memref_smem_bf16_19
        %956 = cute.get_shape(%lay_2331) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2332, %e1_2333, %e2_2334 = cute.get_leaves(%956) : !cute.shape<"((8,1),4)">
        %iter_2335 = cute.get_iter(%view_2329) : !memref_smem_bf16_19
        %view_2336 = cute.make_view(%iter_2335) : !memref_smem_bf16_20
        %iter_2337 = cute.get_iter(%view_2336) : !memref_smem_bf16_20
        %iter_2338 = cute.get_iter(%view_2336) : !memref_smem_bf16_20
        %lay_2339 = cute.get_layout(%view_2313) : !memref_rmem_bf16_12
        %shape_2340 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2341 = cute.make_layout() : !cute.layout<"1:0">
        %append_2342 = cute.append_to_rank<2> (%lay_2339, %lay_2341) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
        %view_2343 = cute.make_view(%iter_2315, %append_2342) : !memref_rmem_bf16_12
        %iter_2344 = cute.get_iter(%view_2343) : !memref_rmem_bf16_12
        %lay_2345 = cute.get_layout(%view_2343) : !memref_rmem_bf16_12
        %957 = cute.get_shape(%lay_2345) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_2346, %e1_2347, %e2_2348, %e3_2349 = cute.get_leaves(%957) : !cute.shape<"(((4,2),1),4)">
        %iter_2350 = cute.get_iter(%view_2343) : !memref_rmem_bf16_12
        %view_2351 = cute.make_view(%iter_2350) : !memref_rmem_bf16_13
        %iter_2352 = cute.get_iter(%view_2351) : !memref_rmem_bf16_13
        %iter_2353 = cute.get_iter(%view_2351) : !memref_rmem_bf16_13
        %lay_2354 = cute.get_layout(%view_2336) : !memref_smem_bf16_20
        %958 = cute.get_shape(%lay_2354) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_2355, %e1_2356, %e2_2357 = cute.get_leaves(%958) : !cute.shape<"((8,1),(4))">
        %lay_2358 = cute.get_layout(%view_2351) : !memref_rmem_bf16_13
        %959 = cute.get_shape(%lay_2358) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
        %e0_2359, %e1_2360, %e2_2361, %e3_2362 = cute.get_leaves(%959) : !cute.shape<"(((4,2),1),(4))">
        %lay_2363 = cute.get_layout(%view_2336) : !memref_smem_bf16_20
        %sz_2364 = cute.size(%lay_2363) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_2365 = cute.get_leaves(%sz_2364) : !cute.int_tuple<"4">
        %lay_2366 = cute.get_layout(%view_2351) : !memref_rmem_bf16_13
        %sz_2367 = cute.size(%lay_2366) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
        %e0_2368 = cute.get_leaves(%sz_2367) : !cute.int_tuple<"4">
        %960 = cute.static : !cute.layout<"1:0">
        %iter_2369 = cute.get_iter(%view_2336) : !memref_smem_bf16_20
        %iter_2370 = cute.get_iter(%view_2351) : !memref_rmem_bf16_13
        %lay_2371 = cute.get_layout(%view_2336) : !memref_smem_bf16_20
        %lay_2372 = cute.get_layout(%view_2351) : !memref_rmem_bf16_13
        %append_2373 = cute.append_to_rank<2> (%lay_2371, %960) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_2374 = cute.append_to_rank<2> (%lay_2372, %960) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
        %lay_2375 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_2376 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
        %sz_2377 = cute.size(%lay_2375) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %961 = cute.get_scalars(%sz_2377) : !cute.int_tuple<"4">
        %c0_i32_2378 = arith.constant 0 : i32
        %c1_i32_2379 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2378 to %961 step %c1_i32_2379  : i32 {
          %coord_3319 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3320 = cute.slice(%lay_2375, %coord_3319) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_2375) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_3322 = cute.add_offset(%iter_2369, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3323 = cute.make_view(%ptr_3322, %slice_3320) : !memref_smem_bf16_14
          %slice_3324 = cute.slice(%lay_2376, %coord_3319) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
          %idx_3325 = cute.crd2idx(%coord_3319, %lay_2376) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
          %ptr_3326 = cute.add_offset(%iter_2370, %idx_3325) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3327 = cute.make_view(%ptr_3326, %slice_3324) : !memref_rmem_bf16_14
          cute.copy_atom_call(%183, %view_3323, %view_3327) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2380 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
        %962 = cute.get_shape(%lay_2380) : (!cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),1,((2,2),2))">
        %e0_2381, %e1_2382, %e2_2383, %e3_2384, %e4_2385, %e5_2386 = cute.get_leaves(%962) : !cute.shape<"((8,1),1,((2,2),2))">
        %int_tuple_2387 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2388 = cute.size(%int_tuple_2387) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2389 = cute.get_leaves(%sz_2388) : !cute.int_tuple<"8">
        %int_tuple_2390 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2391 = cute.size(%int_tuple_2390) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2392 = cute.get_leaves(%sz_2391) : !cute.int_tuple<"8">
        %true = arith.constant true
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"64">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2393 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2394 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2395 = cute.crd2idx(%coord_2393, %lay_2394) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"0">
        %iter_2396 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2397 = cute.add_offset(%iter_2396, %idx_2395) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2398 = cute.make_view(%ptr_2397) : !memref_rmem_bf16_15
        %iter_2399 = cute.get_iter(%view_2398) : !memref_rmem_bf16_15
        %iter_2400 = cute.get_iter(%view_2398) : !memref_rmem_bf16_15
        %coord_2401 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2402 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2403 = cute.crd2idx(%coord_2401, %lay_2402) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"0">
        %iter_2404 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2405 = cute.add_offset(%iter_2404, %idx_2403) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2406 = cute.make_view(%ptr_2405) : !memref_rmem_bf16_16
        %iter_2407 = cute.get_iter(%view_2406) : !memref_rmem_bf16_16
        %iter_2408 = cute.get_iter(%view_2406) : !memref_rmem_bf16_16
        %lay_2409 = cute.get_layout(%view_2398) : !memref_rmem_bf16_15
        %963 = cute.get_shape(%lay_2409) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2410, %e1_2411, %e2_2412, %e3_2413 = cute.get_leaves(%963) : !cute.shape<"((2,2,2),1)">
        %lay_2414 = cute.get_layout(%view_2406) : !memref_rmem_bf16_16
        %964 = cute.get_shape(%lay_2414) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2415, %e1_2416, %e2_2417, %e3_2418 = cute.get_leaves(%964) : !cute.shape<"((2,2),(2,4))">
        %iter_2419 = cute.get_iter(%view_2398) : !memref_rmem_bf16_15
        %iter_2420 = cute.get_iter(%view_2406) : !memref_rmem_bf16_16
        %iter_2421 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2422 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2423 = cute.get_layout(%view_2398) : !memref_rmem_bf16_15
        %lay_2424 = cute.get_layout(%view_2406) : !memref_rmem_bf16_16
        %lay_2425 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2426 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %965 = cute.static : !cute.layout<"1:0">
        %append_2427 = cute.append_to_rank<3> (%lay_2423, %965) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2428 = cute.append_to_rank<3> (%lay_2424, %965) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2429 = cute.size(%append_2427) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2430 = cute.size(%append_2427) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2431 = cute.size(%append_2428) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %966 = cute.get_scalars(%sz_2429) : !cute.int_tuple<"1">
        %967 = cute.get_scalars(%sz_2430) : !cute.int_tuple<"1">
        %968 = cute.get_scalars(%sz_2431) : !cute.int_tuple<"8">
        %c0_i32_2432 = arith.constant 0 : i32
        %c1_i32_2433 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2432 to %966 step %c1_i32_2433  : i32 {
          scf.for %arg9 = %c0_i32_2432 to %967 step %c1_i32_2433  : i32 {
            scf.for %arg10 = %c0_i32_2432 to %968 step %c1_i32_2433  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2427, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2427) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2419, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2428, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2428) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2420, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2425, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2425) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2421, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2426, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2426) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2422, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2434 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2435 = cute.size(%int_tuple_2434) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2436 = cute.get_leaves(%sz_2435) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"32">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"128">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2437 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_2438 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2439 = cute.crd2idx(%coord_2437, %lay_2438) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"16">
        %iter_2440 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2441 = cute.add_offset(%iter_2440, %idx_2439) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2442 = cute.make_view(%ptr_2441) : !memref_rmem_bf16_15
        %iter_2443 = cute.get_iter(%view_2442) : !memref_rmem_bf16_15
        %iter_2444 = cute.get_iter(%view_2442) : !memref_rmem_bf16_15
        %coord_2445 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_2446 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2447 = cute.crd2idx(%coord_2445, %lay_2446) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"64">
        %iter_2448 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2449 = cute.add_offset(%iter_2448, %idx_2447) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2450 = cute.make_view(%ptr_2449) : !memref_rmem_bf16_16
        %iter_2451 = cute.get_iter(%view_2450) : !memref_rmem_bf16_16
        %iter_2452 = cute.get_iter(%view_2450) : !memref_rmem_bf16_16
        %lay_2453 = cute.get_layout(%view_2442) : !memref_rmem_bf16_15
        %969 = cute.get_shape(%lay_2453) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2454, %e1_2455, %e2_2456, %e3_2457 = cute.get_leaves(%969) : !cute.shape<"((2,2,2),1)">
        %lay_2458 = cute.get_layout(%view_2450) : !memref_rmem_bf16_16
        %970 = cute.get_shape(%lay_2458) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2459, %e1_2460, %e2_2461, %e3_2462 = cute.get_leaves(%970) : !cute.shape<"((2,2),(2,4))">
        %iter_2463 = cute.get_iter(%view_2442) : !memref_rmem_bf16_15
        %iter_2464 = cute.get_iter(%view_2450) : !memref_rmem_bf16_16
        %iter_2465 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2466 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2467 = cute.get_layout(%view_2442) : !memref_rmem_bf16_15
        %lay_2468 = cute.get_layout(%view_2450) : !memref_rmem_bf16_16
        %lay_2469 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2470 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %971 = cute.static : !cute.layout<"1:0">
        %append_2471 = cute.append_to_rank<3> (%lay_2467, %971) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2472 = cute.append_to_rank<3> (%lay_2468, %971) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2473 = cute.size(%append_2471) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2474 = cute.size(%append_2471) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2475 = cute.size(%append_2472) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %972 = cute.get_scalars(%sz_2473) : !cute.int_tuple<"1">
        %973 = cute.get_scalars(%sz_2474) : !cute.int_tuple<"1">
        %974 = cute.get_scalars(%sz_2475) : !cute.int_tuple<"8">
        %c0_i32_2476 = arith.constant 0 : i32
        %c1_i32_2477 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2476 to %972 step %c1_i32_2477  : i32 {
          scf.for %arg9 = %c0_i32_2476 to %973 step %c1_i32_2477  : i32 {
            scf.for %arg10 = %c0_i32_2476 to %974 step %c1_i32_2477  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2471, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2471) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2463, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2472, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2472) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2464, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2469, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2469) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2465, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2470, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2470) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2466, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2478 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2479 = cute.size(%int_tuple_2478) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2480 = cute.get_leaves(%sz_2479) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"48">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"192">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2481 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_2482 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2483 = cute.crd2idx(%coord_2481, %lay_2482) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"32">
        %iter_2484 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2485 = cute.add_offset(%iter_2484, %idx_2483) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2486 = cute.make_view(%ptr_2485) : !memref_rmem_bf16_15
        %iter_2487 = cute.get_iter(%view_2486) : !memref_rmem_bf16_15
        %iter_2488 = cute.get_iter(%view_2486) : !memref_rmem_bf16_15
        %coord_2489 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_2490 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2491 = cute.crd2idx(%coord_2489, %lay_2490) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"128">
        %iter_2492 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2493 = cute.add_offset(%iter_2492, %idx_2491) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2494 = cute.make_view(%ptr_2493) : !memref_rmem_bf16_16
        %iter_2495 = cute.get_iter(%view_2494) : !memref_rmem_bf16_16
        %iter_2496 = cute.get_iter(%view_2494) : !memref_rmem_bf16_16
        %lay_2497 = cute.get_layout(%view_2486) : !memref_rmem_bf16_15
        %975 = cute.get_shape(%lay_2497) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2498, %e1_2499, %e2_2500, %e3_2501 = cute.get_leaves(%975) : !cute.shape<"((2,2,2),1)">
        %lay_2502 = cute.get_layout(%view_2494) : !memref_rmem_bf16_16
        %976 = cute.get_shape(%lay_2502) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2503, %e1_2504, %e2_2505, %e3_2506 = cute.get_leaves(%976) : !cute.shape<"((2,2),(2,4))">
        %iter_2507 = cute.get_iter(%view_2486) : !memref_rmem_bf16_15
        %iter_2508 = cute.get_iter(%view_2494) : !memref_rmem_bf16_16
        %iter_2509 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2510 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2511 = cute.get_layout(%view_2486) : !memref_rmem_bf16_15
        %lay_2512 = cute.get_layout(%view_2494) : !memref_rmem_bf16_16
        %lay_2513 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2514 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %977 = cute.static : !cute.layout<"1:0">
        %append_2515 = cute.append_to_rank<3> (%lay_2511, %977) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2516 = cute.append_to_rank<3> (%lay_2512, %977) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2517 = cute.size(%append_2515) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2518 = cute.size(%append_2515) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2519 = cute.size(%append_2516) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %978 = cute.get_scalars(%sz_2517) : !cute.int_tuple<"1">
        %979 = cute.get_scalars(%sz_2518) : !cute.int_tuple<"1">
        %980 = cute.get_scalars(%sz_2519) : !cute.int_tuple<"8">
        %c0_i32_2520 = arith.constant 0 : i32
        %c1_i32_2521 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2520 to %978 step %c1_i32_2521  : i32 {
          scf.for %arg9 = %c0_i32_2520 to %979 step %c1_i32_2521  : i32 {
            scf.for %arg10 = %c0_i32_2520 to %980 step %c1_i32_2521  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2515, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2515) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2507, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2516, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2516) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2508, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2513, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2513) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2509, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2514, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2514) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2510, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2522 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2523 = cute.size(%int_tuple_2522) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2524 = cute.get_leaves(%sz_2523) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"8">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,4)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"16">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2525 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_2526 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2527 = cute.crd2idx(%coord_2525, %lay_2526) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"48">
        %iter_2528 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2529 = cute.add_offset(%iter_2528, %idx_2527) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2530 = cute.make_view(%ptr_2529) : !memref_rmem_bf16_15
        %iter_2531 = cute.get_iter(%view_2530) : !memref_rmem_bf16_15
        %iter_2532 = cute.get_iter(%view_2530) : !memref_rmem_bf16_15
        %coord_2533 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_2534 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2535 = cute.crd2idx(%coord_2533, %lay_2534) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"192">
        %iter_2536 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2537 = cute.add_offset(%iter_2536, %idx_2535) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2538 = cute.make_view(%ptr_2537) : !memref_rmem_bf16_16
        %iter_2539 = cute.get_iter(%view_2538) : !memref_rmem_bf16_16
        %iter_2540 = cute.get_iter(%view_2538) : !memref_rmem_bf16_16
        %lay_2541 = cute.get_layout(%view_2530) : !memref_rmem_bf16_15
        %981 = cute.get_shape(%lay_2541) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2542, %e1_2543, %e2_2544, %e3_2545 = cute.get_leaves(%981) : !cute.shape<"((2,2,2),1)">
        %lay_2546 = cute.get_layout(%view_2538) : !memref_rmem_bf16_16
        %982 = cute.get_shape(%lay_2546) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2547, %e1_2548, %e2_2549, %e3_2550 = cute.get_leaves(%982) : !cute.shape<"((2,2),(2,4))">
        %iter_2551 = cute.get_iter(%view_2530) : !memref_rmem_bf16_15
        %iter_2552 = cute.get_iter(%view_2538) : !memref_rmem_bf16_16
        %iter_2553 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2554 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2555 = cute.get_layout(%view_2530) : !memref_rmem_bf16_15
        %lay_2556 = cute.get_layout(%view_2538) : !memref_rmem_bf16_16
        %lay_2557 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2558 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %983 = cute.static : !cute.layout<"1:0">
        %append_2559 = cute.append_to_rank<3> (%lay_2555, %983) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2560 = cute.append_to_rank<3> (%lay_2556, %983) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2561 = cute.size(%append_2559) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2562 = cute.size(%append_2559) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2563 = cute.size(%append_2560) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %984 = cute.get_scalars(%sz_2561) : !cute.int_tuple<"1">
        %985 = cute.get_scalars(%sz_2562) : !cute.int_tuple<"1">
        %986 = cute.get_scalars(%sz_2563) : !cute.int_tuple<"8">
        %c0_i32_2564 = arith.constant 0 : i32
        %c1_i32_2565 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2564 to %984 step %c1_i32_2565  : i32 {
          scf.for %arg9 = %c0_i32_2564 to %985 step %c1_i32_2565  : i32 {
            scf.for %arg10 = %c0_i32_2564 to %986 step %c1_i32_2565  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2559, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2559) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2551, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2560, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2560) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2552, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2557, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2557) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2553, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2558, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2558) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2554, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2566 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2567 = cute.size(%int_tuple_2566) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2568 = cute.get_leaves(%sz_2567) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"24">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,5)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"80">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2569 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_2570 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2571 = cute.crd2idx(%coord_2569, %lay_2570) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"8">
        %iter_2572 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2573 = cute.add_offset(%iter_2572, %idx_2571) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2574 = cute.make_view(%ptr_2573) : !memref_rmem_bf16_15
        %iter_2575 = cute.get_iter(%view_2574) : !memref_rmem_bf16_15
        %iter_2576 = cute.get_iter(%view_2574) : !memref_rmem_bf16_15
        %coord_2577 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_2578 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2579 = cute.crd2idx(%coord_2577, %lay_2578) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"16">
        %iter_2580 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2581 = cute.add_offset(%iter_2580, %idx_2579) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2582 = cute.make_view(%ptr_2581) : !memref_rmem_bf16_16
        %iter_2583 = cute.get_iter(%view_2582) : !memref_rmem_bf16_16
        %iter_2584 = cute.get_iter(%view_2582) : !memref_rmem_bf16_16
        %lay_2585 = cute.get_layout(%view_2574) : !memref_rmem_bf16_15
        %987 = cute.get_shape(%lay_2585) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2586, %e1_2587, %e2_2588, %e3_2589 = cute.get_leaves(%987) : !cute.shape<"((2,2,2),1)">
        %lay_2590 = cute.get_layout(%view_2582) : !memref_rmem_bf16_16
        %988 = cute.get_shape(%lay_2590) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2591, %e1_2592, %e2_2593, %e3_2594 = cute.get_leaves(%988) : !cute.shape<"((2,2),(2,4))">
        %iter_2595 = cute.get_iter(%view_2574) : !memref_rmem_bf16_15
        %iter_2596 = cute.get_iter(%view_2582) : !memref_rmem_bf16_16
        %iter_2597 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2598 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2599 = cute.get_layout(%view_2574) : !memref_rmem_bf16_15
        %lay_2600 = cute.get_layout(%view_2582) : !memref_rmem_bf16_16
        %lay_2601 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2602 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %989 = cute.static : !cute.layout<"1:0">
        %append_2603 = cute.append_to_rank<3> (%lay_2599, %989) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2604 = cute.append_to_rank<3> (%lay_2600, %989) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2605 = cute.size(%append_2603) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2606 = cute.size(%append_2603) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2607 = cute.size(%append_2604) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %990 = cute.get_scalars(%sz_2605) : !cute.int_tuple<"1">
        %991 = cute.get_scalars(%sz_2606) : !cute.int_tuple<"1">
        %992 = cute.get_scalars(%sz_2607) : !cute.int_tuple<"8">
        %c0_i32_2608 = arith.constant 0 : i32
        %c1_i32_2609 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2608 to %990 step %c1_i32_2609  : i32 {
          scf.for %arg9 = %c0_i32_2608 to %991 step %c1_i32_2609  : i32 {
            scf.for %arg10 = %c0_i32_2608 to %992 step %c1_i32_2609  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2603, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2603) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2595, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2604, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2604) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2596, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2601, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2601) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2597, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2602, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2602) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2598, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2610 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2611 = cute.size(%int_tuple_2610) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2612 = cute.get_leaves(%sz_2611) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"40">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,6)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"144">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2613 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_2614 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2615 = cute.crd2idx(%coord_2613, %lay_2614) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"24">
        %iter_2616 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2617 = cute.add_offset(%iter_2616, %idx_2615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2618 = cute.make_view(%ptr_2617) : !memref_rmem_bf16_15
        %iter_2619 = cute.get_iter(%view_2618) : !memref_rmem_bf16_15
        %iter_2620 = cute.get_iter(%view_2618) : !memref_rmem_bf16_15
        %coord_2621 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_2622 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2623 = cute.crd2idx(%coord_2621, %lay_2622) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"80">
        %iter_2624 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2625 = cute.add_offset(%iter_2624, %idx_2623) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2626 = cute.make_view(%ptr_2625) : !memref_rmem_bf16_16
        %iter_2627 = cute.get_iter(%view_2626) : !memref_rmem_bf16_16
        %iter_2628 = cute.get_iter(%view_2626) : !memref_rmem_bf16_16
        %lay_2629 = cute.get_layout(%view_2618) : !memref_rmem_bf16_15
        %993 = cute.get_shape(%lay_2629) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2630, %e1_2631, %e2_2632, %e3_2633 = cute.get_leaves(%993) : !cute.shape<"((2,2,2),1)">
        %lay_2634 = cute.get_layout(%view_2626) : !memref_rmem_bf16_16
        %994 = cute.get_shape(%lay_2634) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2635, %e1_2636, %e2_2637, %e3_2638 = cute.get_leaves(%994) : !cute.shape<"((2,2),(2,4))">
        %iter_2639 = cute.get_iter(%view_2618) : !memref_rmem_bf16_15
        %iter_2640 = cute.get_iter(%view_2626) : !memref_rmem_bf16_16
        %iter_2641 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2642 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2643 = cute.get_layout(%view_2618) : !memref_rmem_bf16_15
        %lay_2644 = cute.get_layout(%view_2626) : !memref_rmem_bf16_16
        %lay_2645 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2646 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %995 = cute.static : !cute.layout<"1:0">
        %append_2647 = cute.append_to_rank<3> (%lay_2643, %995) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2648 = cute.append_to_rank<3> (%lay_2644, %995) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2649 = cute.size(%append_2647) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2650 = cute.size(%append_2647) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2651 = cute.size(%append_2648) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %996 = cute.get_scalars(%sz_2649) : !cute.int_tuple<"1">
        %997 = cute.get_scalars(%sz_2650) : !cute.int_tuple<"1">
        %998 = cute.get_scalars(%sz_2651) : !cute.int_tuple<"8">
        %c0_i32_2652 = arith.constant 0 : i32
        %c1_i32_2653 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2652 to %996 step %c1_i32_2653  : i32 {
          scf.for %arg9 = %c0_i32_2652 to %997 step %c1_i32_2653  : i32 {
            scf.for %arg10 = %c0_i32_2652 to %998 step %c1_i32_2653  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2647, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2647) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2639, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2648, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2648) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2640, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2645, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2645) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2641, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2646, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2646) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2642, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2654 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2655 = cute.size(%int_tuple_2654) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2656 = cute.get_leaves(%sz_2655) : !cute.int_tuple<"8">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"56">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,7)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"208">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2657 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_2658 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2659 = cute.crd2idx(%coord_2657, %lay_2658) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"40">
        %iter_2660 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2661 = cute.add_offset(%iter_2660, %idx_2659) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2662 = cute.make_view(%ptr_2661) : !memref_rmem_bf16_15
        %iter_2663 = cute.get_iter(%view_2662) : !memref_rmem_bf16_15
        %iter_2664 = cute.get_iter(%view_2662) : !memref_rmem_bf16_15
        %coord_2665 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_2666 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2667 = cute.crd2idx(%coord_2665, %lay_2666) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"144">
        %iter_2668 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2669 = cute.add_offset(%iter_2668, %idx_2667) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2670 = cute.make_view(%ptr_2669) : !memref_rmem_bf16_16
        %iter_2671 = cute.get_iter(%view_2670) : !memref_rmem_bf16_16
        %iter_2672 = cute.get_iter(%view_2670) : !memref_rmem_bf16_16
        %lay_2673 = cute.get_layout(%view_2662) : !memref_rmem_bf16_15
        %999 = cute.get_shape(%lay_2673) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2674, %e1_2675, %e2_2676, %e3_2677 = cute.get_leaves(%999) : !cute.shape<"((2,2,2),1)">
        %lay_2678 = cute.get_layout(%view_2670) : !memref_rmem_bf16_16
        %1000 = cute.get_shape(%lay_2678) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2679, %e1_2680, %e2_2681, %e3_2682 = cute.get_leaves(%1000) : !cute.shape<"((2,2),(2,4))">
        %iter_2683 = cute.get_iter(%view_2662) : !memref_rmem_bf16_15
        %iter_2684 = cute.get_iter(%view_2670) : !memref_rmem_bf16_16
        %iter_2685 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2686 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2687 = cute.get_layout(%view_2662) : !memref_rmem_bf16_15
        %lay_2688 = cute.get_layout(%view_2670) : !memref_rmem_bf16_16
        %lay_2689 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2690 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %1001 = cute.static : !cute.layout<"1:0">
        %append_2691 = cute.append_to_rank<3> (%lay_2687, %1001) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2692 = cute.append_to_rank<3> (%lay_2688, %1001) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2693 = cute.size(%append_2691) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2694 = cute.size(%append_2691) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2695 = cute.size(%append_2692) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1002 = cute.get_scalars(%sz_2693) : !cute.int_tuple<"1">
        %1003 = cute.get_scalars(%sz_2694) : !cute.int_tuple<"1">
        %1004 = cute.get_scalars(%sz_2695) : !cute.int_tuple<"8">
        %c0_i32_2696 = arith.constant 0 : i32
        %c1_i32_2697 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2696 to %1002 step %c1_i32_2697  : i32 {
          scf.for %arg9 = %c0_i32_2696 to %1003 step %c1_i32_2697  : i32 {
            scf.for %arg10 = %c0_i32_2696 to %1004 step %c1_i32_2697  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2691, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2691) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2683, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2692, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2692) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2684, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2689, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2689) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2685, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2690, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2690) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2686, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_2698 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_2699 = cute.size(%int_tuple_2698) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_2700 = cute.get_leaves(%sz_2699) : !cute.int_tuple<"8">
        %false = arith.constant false
        scf.if %false {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3320 = cute.get_layout(%src_partitioned_475) : !memref_smem_bf16_8
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_3322 = cute.get_iter(%src_partitioned_475) : !memref_smem_bf16_8
          %ptr_3323 = cute.add_offset(%iter_3322, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3324 = cute.make_view(%ptr_3323) : !memref_smem_bf16_15
          %iter_3325 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %iter_3326 = cute.get_iter(%view_3324) : !memref_smem_bf16_15
          %coord_3327 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3328 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
          %idx_3329 = cute.crd2idx(%coord_3327, %lay_3328) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_3330 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
          %ptr_3331 = cute.add_offset(%iter_3330, %idx_3329) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3332 = cute.make_view(%ptr_3331) : !memref_rmem_bf16_10
          %iter_3333 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %iter_3334 = cute.get_iter(%view_3332) : !memref_rmem_bf16_10
          %lay_3335 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %1151 = cute.get_shape(%lay_3335) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3336, %e1_3337, %e2_3338 = cute.get_leaves(%1151) : !cute.shape<"((8,1),1)">
          %lay_3339 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %1152 = cute.get_shape(%lay_3339) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3340, %e1_3341, %e2_3342 = cute.get_leaves(%1152) : !cute.shape<"((8,1),1)">
          %lay_3343 = cute.get_layout(%view_3324) : !memref_smem_bf16_15
          %shape_3344 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3345 = cute.make_layout() : !cute.layout<"1:0">
          %append_3346 = cute.append_to_rank<2> (%lay_3343, %lay_3345) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3347 = cute.make_view(%iter_3326, %append_3346) : !memref_smem_bf16_15
          %iter_3348 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %lay_3349 = cute.get_layout(%view_3347) : !memref_smem_bf16_15
          %1153 = cute.get_shape(%lay_3349) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3350, %e1_3351, %e2_3352 = cute.get_leaves(%1153) : !cute.shape<"((8,1),1)">
          %iter_3353 = cute.get_iter(%view_3347) : !memref_smem_bf16_15
          %view_3354 = cute.make_view(%iter_3353) : !memref_smem_bf16_16
          %iter_3355 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3356 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %lay_3357 = cute.get_layout(%view_3332) : !memref_rmem_bf16_10
          %shape_3358 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3359 = cute.make_layout() : !cute.layout<"1:0">
          %append_3360 = cute.append_to_rank<2> (%lay_3357, %lay_3359) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3361 = cute.make_view(%iter_3334, %append_3360) : !memref_rmem_bf16_10
          %iter_3362 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %lay_3363 = cute.get_layout(%view_3361) : !memref_rmem_bf16_10
          %1154 = cute.get_shape(%lay_3363) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3364, %e1_3365, %e2_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),1)">
          %iter_3367 = cute.get_iter(%view_3361) : !memref_rmem_bf16_10
          %view_3368 = cute.make_view(%iter_3367) : !memref_rmem_bf16_11
          %iter_3369 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %iter_3370 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3371 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %1155 = cute.get_shape(%lay_3371) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3372, %e1_3373, %e2_3374 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(1))">
          %lay_3375 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %1156 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_3376, %e1_3377, %e2_3378 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(1))">
          %lay_3379 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %sz_3380 = cute.size(%lay_3379) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %lay_3382 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %sz_3383 = cute.size(%lay_3382) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"1">
          %1157 = cute.static : !cute.layout<"1:0">
          %iter_3385 = cute.get_iter(%view_3354) : !memref_smem_bf16_16
          %iter_3386 = cute.get_iter(%view_3368) : !memref_rmem_bf16_11
          %lay_3387 = cute.get_layout(%view_3354) : !memref_smem_bf16_16
          %lay_3388 = cute.get_layout(%view_3368) : !memref_rmem_bf16_11
          %append_3389 = cute.append_to_rank<2> (%lay_3387, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_3390 = cute.append_to_rank<2> (%lay_3388, %1157) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_3391 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_3392 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_3393 = cute.size(%lay_3391) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1158 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
          %c0_i32_3394 = arith.constant 0 : i32
          %c1_i32_3395 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3394 to %1158 step %c1_i32_3395  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3391, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3391) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3479 = cute.add_offset(%iter_3385, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3392, %coord_3476) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3392) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_3483 = cute.add_offset(%iter_3386, %idx_3482) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_9
            cute.copy_atom_call(%179, %view_3480, %view_3484) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_9) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3397 = cute.get_layout(%src_partitioned_479) : !memref_smem_bf16_9
          %idx_3398 = cute.crd2idx(%coord_3396, %lay_3397) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_3399 = cute.get_iter(%src_partitioned_479) : !memref_smem_bf16_9
          %ptr_3400 = cute.add_offset(%iter_3399, %idx_3398) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3401 = cute.make_view(%ptr_3400) : !memref_smem_bf16_19
          %iter_3402 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %iter_3403 = cute.get_iter(%view_3401) : !memref_smem_bf16_19
          %coord_3404 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3405 = cute.get_layout(%retiled_481) : !memref_rmem_bf16_4
          %idx_3406 = cute.crd2idx(%coord_3404, %lay_3405) : (!cute.coord<"(_,_,8)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"32">
          %iter_3407 = cute.get_iter(%retiled_481) : !memref_rmem_bf16_4
          %ptr_3408 = cute.add_offset(%iter_3407, %idx_3406) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3409 = cute.make_view(%ptr_3408) : !memref_rmem_bf16_12
          %iter_3410 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %iter_3411 = cute.get_iter(%view_3409) : !memref_rmem_bf16_12
          %lay_3412 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %1159 = cute.get_shape(%lay_3412) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3413, %e1_3414, %e2_3415 = cute.get_leaves(%1159) : !cute.shape<"((8,1),4)">
          %lay_3416 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %1160 = cute.get_shape(%lay_3416) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%1160) : !cute.shape<"(((4,2),1),4)">
          %lay_3421 = cute.get_layout(%view_3401) : !memref_smem_bf16_19
          %shape_3422 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3423 = cute.make_layout() : !cute.layout<"1:0">
          %append_3424 = cute.append_to_rank<2> (%lay_3421, %lay_3423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_3425 = cute.make_view(%iter_3403, %append_3424) : !memref_smem_bf16_19
          %iter_3426 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %lay_3427 = cute.get_layout(%view_3425) : !memref_smem_bf16_19
          %1161 = cute.get_shape(%lay_3427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_3428, %e1_3429, %e2_3430 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
          %iter_3431 = cute.get_iter(%view_3425) : !memref_smem_bf16_19
          %view_3432 = cute.make_view(%iter_3431) : !memref_smem_bf16_20
          %iter_3433 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3434 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %lay_3435 = cute.get_layout(%view_3409) : !memref_rmem_bf16_12
          %shape_3436 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3437 = cute.make_layout() : !cute.layout<"1:0">
          %append_3438 = cute.append_to_rank<2> (%lay_3435, %lay_3437) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_3439 = cute.make_view(%iter_3411, %append_3438) : !memref_rmem_bf16_12
          %iter_3440 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %lay_3441 = cute.get_layout(%view_3439) : !memref_rmem_bf16_12
          %1162 = cute.get_shape(%lay_3441) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%1162) : !cute.shape<"(((4,2),1),4)">
          %iter_3446 = cute.get_iter(%view_3439) : !memref_rmem_bf16_12
          %view_3447 = cute.make_view(%iter_3446) : !memref_rmem_bf16_13
          %iter_3448 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %iter_3449 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3450 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %1163 = cute.get_shape(%lay_3450) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_3451, %e1_3452, %e2_3453 = cute.get_leaves(%1163) : !cute.shape<"((8,1),(4))">
          %lay_3454 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %1164 = cute.get_shape(%lay_3454) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_3455, %e1_3456, %e2_3457, %e3_3458 = cute.get_leaves(%1164) : !cute.shape<"(((4,2),1),(4))">
          %lay_3459 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %sz_3460 = cute.size(%lay_3459) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_3461 = cute.get_leaves(%sz_3460) : !cute.int_tuple<"4">
          %lay_3462 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %sz_3463 = cute.size(%lay_3462) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_3464 = cute.get_leaves(%sz_3463) : !cute.int_tuple<"4">
          %1165 = cute.static : !cute.layout<"1:0">
          %iter_3465 = cute.get_iter(%view_3432) : !memref_smem_bf16_20
          %iter_3466 = cute.get_iter(%view_3447) : !memref_rmem_bf16_13
          %lay_3467 = cute.get_layout(%view_3432) : !memref_smem_bf16_20
          %lay_3468 = cute.get_layout(%view_3447) : !memref_rmem_bf16_13
          %append_3469 = cute.append_to_rank<2> (%lay_3467, %1165) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_3470 = cute.append_to_rank<2> (%lay_3468, %1165) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_3471 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_3472 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_3473 = cute.size(%lay_3471) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1166 = cute.get_scalars(%sz_3473) : !cute.int_tuple<"4">
          %c0_i32_3474 = arith.constant 0 : i32
          %c1_i32_3475 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3474 to %1166 step %c1_i32_3475  : i32 {
            %coord_3476 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3477 = cute.slice(%lay_3471, %coord_3476) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
            %idx_3478 = cute.crd2idx(%coord_3476, %lay_3471) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3479 = cute.add_offset(%iter_3465, %idx_3478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3480 = cute.make_view(%ptr_3479, %slice_3477) : !memref_smem_bf16_14
            %slice_3481 = cute.slice(%lay_3472, %coord_3476) : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">, !cute.coord<"(_,?)">
            %idx_3482 = cute.crd2idx(%coord_3476, %lay_3472) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_3483 = cute.add_offset(%iter_3466, %idx_3482) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3484 = cute.make_view(%ptr_3483, %slice_3481) : !memref_rmem_bf16_14
            cute.copy_atom_call(%183, %view_3480, %view_3484) : (!copy_ldsm_4_1, !memref_smem_bf16_14, !memref_rmem_bf16_14) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_2701 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_2702 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_2703 = cute.crd2idx(%coord_2701, %lay_2702) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"56">
        %iter_2704 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_2705 = cute.add_offset(%iter_2704, %idx_2703) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2706 = cute.make_view(%ptr_2705) : !memref_rmem_bf16_15
        %iter_2707 = cute.get_iter(%view_2706) : !memref_rmem_bf16_15
        %iter_2708 = cute.get_iter(%view_2706) : !memref_rmem_bf16_15
        %coord_2709 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_2710 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_2711 = cute.crd2idx(%coord_2709, %lay_2710) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"208">
        %iter_2712 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_2713 = cute.add_offset(%iter_2712, %idx_2711) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2714 = cute.make_view(%ptr_2713) : !memref_rmem_bf16_16
        %iter_2715 = cute.get_iter(%view_2714) : !memref_rmem_bf16_16
        %iter_2716 = cute.get_iter(%view_2714) : !memref_rmem_bf16_16
        %lay_2717 = cute.get_layout(%view_2706) : !memref_rmem_bf16_15
        %1005 = cute.get_shape(%lay_2717) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_2718, %e1_2719, %e2_2720, %e3_2721 = cute.get_leaves(%1005) : !cute.shape<"((2,2,2),1)">
        %lay_2722 = cute.get_layout(%view_2714) : !memref_rmem_bf16_16
        %1006 = cute.get_shape(%lay_2722) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_2723, %e1_2724, %e2_2725, %e3_2726 = cute.get_leaves(%1006) : !cute.shape<"((2,2),(2,4))">
        %iter_2727 = cute.get_iter(%view_2706) : !memref_rmem_bf16_15
        %iter_2728 = cute.get_iter(%view_2714) : !memref_rmem_bf16_16
        %iter_2729 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %iter_2730 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
        %lay_2731 = cute.get_layout(%view_2706) : !memref_rmem_bf16_15
        %lay_2732 = cute.get_layout(%view_2714) : !memref_rmem_bf16_16
        %lay_2733 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %lay_2734 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %1007 = cute.static : !cute.layout<"1:0">
        %append_2735 = cute.append_to_rank<3> (%lay_2731, %1007) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_2736 = cute.append_to_rank<3> (%lay_2732, %1007) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_2737 = cute.size(%append_2735) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2738 = cute.size(%append_2735) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_2739 = cute.size(%append_2736) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1008 = cute.get_scalars(%sz_2737) : !cute.int_tuple<"1">
        %1009 = cute.get_scalars(%sz_2738) : !cute.int_tuple<"1">
        %1010 = cute.get_scalars(%sz_2739) : !cute.int_tuple<"8">
        %c0_i32_2740 = arith.constant 0 : i32
        %c1_i32_2741 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2740 to %1008 step %c1_i32_2741  : i32 {
          scf.for %arg9 = %c0_i32_2740 to %1009 step %c1_i32_2741  : i32 {
            scf.for %arg10 = %c0_i32_2740 to %1010 step %c1_i32_2741  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_2735, %coord_3319) : !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_2735) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_2727, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_17
              %slice_3326 = cute.slice(%append_2736, %coord_3320) : !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_2736) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_2728, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_2733, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_2733) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_2729, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_2734, %coord_3321) : !cute.layout<"((2,2),1,8):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_2734) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_2730, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_17, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_2742 = arith.constant 1 : i32
        %c128_i32_2743 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_2742 number_of_threads = %c128_i32_2743
        %c0_i32_2744 = arith.constant 0 : i32
        %1011 = arith.cmpi sgt, %928, %c0_i32_2744 : i32
        scf.if %1011 {
          %int_tuple_3319 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3320 = cute.tuple_sub(%sub_2085, %int_tuple_3319) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1151 = cute.get_scalars(%sub_3320) : !cute.int_tuple<"?">
          %coord_3321 = cute.make_coord(%sub_3320) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_3322 = cute.get_layout(%src_partitioned_371) : !memref_gmem_bf16_6
          %slice_3323 = cute.slice(%lay_3322, %coord_3321) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_3324 = cute.crd2idx(%coord_3321, %lay_3322) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_3325 = cute.get_iter(%src_partitioned_371) : !memref_gmem_bf16_6
          %ptr_3326 = cute.add_offset(%iter_3325, %idx_3324) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_3327 = cute.make_view(%ptr_3326, %slice_3323) : !memref_gmem_bf16_5
          %iter_3328 = cute.get_iter(%view_3327) : !memref_gmem_bf16_5
          %iter_3329 = cute.get_iter(%view_3327) : !memref_gmem_bf16_5
          %coord_3330 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3331 = cute.get_layout(%dst_partitioned_374) : !memref_smem_bf16_3
          %idx_3332 = cute.crd2idx(%coord_3330, %lay_3331) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_3333 = cute.get_iter(%dst_partitioned_374) : !memref_smem_bf16_3
          %ptr_3334 = cute.add_offset(%iter_3333, %idx_3332) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3335 = cute.make_view(%ptr_3334) : !memref_smem_bf16_3
          %iter_3336 = cute.get_iter(%view_3335) : !memref_smem_bf16_3
          %iter_3337 = cute.get_iter(%view_3335) : !memref_smem_bf16_3
          %coord_3338 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3339 = cute.get_layout(%rmem_699) : !memref_rmem_i8_
          %idx_3340 = cute.crd2idx(%coord_3338, %lay_3339) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_3341 = cute.get_iter(%rmem_699) : !memref_rmem_i8_
          %ptr_3342 = cute.add_offset(%iter_3341, %idx_3340) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_3343 = cute.make_view(%ptr_3342) : !memref_rmem_i8_
          %iter_3344 = cute.get_iter(%view_3343) : !memref_rmem_i8_
          %iter_3345 = cute.get_iter(%view_3343) : !memref_rmem_i8_
          %lay_3346 = cute.get_layout(%view_3327) : !memref_gmem_bf16_5
          %1152 = cute.get_shape(%lay_3346) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3347, %e1_3348, %e2_3349, %e3_3350 = cute.get_leaves(%1152) : !cute.shape<"((8,1),4,2)">
          %lay_3351 = cute.get_layout(%view_3335) : !memref_smem_bf16_3
          %1153 = cute.get_shape(%lay_3351) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3352, %e1_3353, %e2_3354, %e3_3355 = cute.get_leaves(%1153) : !cute.shape<"((8,1),4,2)">
          %lay_3356 = cute.get_layout(%view_3327) : !memref_gmem_bf16_5
          %shape_3357 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3358 = cute.make_layout() : !cute.layout<"1:0">
          %append_3359 = cute.append_to_rank<2> (%lay_3356, %lay_3358) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_3360 = cute.make_view(%iter_3329, %append_3359) : !memref_gmem_bf16_5
          %iter_3361 = cute.get_iter(%view_3360) : !memref_gmem_bf16_5
          %lay_3362 = cute.get_layout(%view_3360) : !memref_gmem_bf16_5
          %1154 = cute.get_shape(%lay_3362) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3363, %e1_3364, %e2_3365, %e3_3366 = cute.get_leaves(%1154) : !cute.shape<"((8,1),4,2)">
          %iter_3367 = cute.get_iter(%view_3360) : !memref_gmem_bf16_5
          %lay_3368 = cute.get_layout(%view_3360) : !memref_gmem_bf16_5
          %1155 = cute.get_scalars(%lay_3368) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_3369 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_3370 = cute.assume(%1155) : (i64) -> !cute.i64<divby 128>
          %stride_3371 = cute.make_stride(%iv_3370) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_3372 = cute.make_layout(%shape_3369, %stride_3371) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_3373 = cute.make_view(%iter_3367, %lay_3372) : !memref_gmem_bf16_13
          %iter_3374 = cute.get_iter(%view_3373) : !memref_gmem_bf16_13
          %iter_3375 = cute.get_iter(%view_3373) : !memref_gmem_bf16_13
          %lay_3376 = cute.get_layout(%view_3335) : !memref_smem_bf16_3
          %shape_3377 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3378 = cute.make_layout() : !cute.layout<"1:0">
          %append_3379 = cute.append_to_rank<2> (%lay_3376, %lay_3378) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_3380 = cute.make_view(%iter_3337, %append_3379) : !memref_smem_bf16_3
          %iter_3381 = cute.get_iter(%view_3380) : !memref_smem_bf16_3
          %lay_3382 = cute.get_layout(%view_3380) : !memref_smem_bf16_3
          %1156 = cute.get_shape(%lay_3382) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3383, %e1_3384, %e2_3385, %e3_3386 = cute.get_leaves(%1156) : !cute.shape<"((8,1),4,2)">
          %iter_3387 = cute.get_iter(%view_3380) : !memref_smem_bf16_3
          %view_3388 = cute.make_view(%iter_3387) : !memref_smem_bf16_17
          %iter_3389 = cute.get_iter(%view_3388) : !memref_smem_bf16_17
          %iter_3390 = cute.get_iter(%view_3388) : !memref_smem_bf16_17
          %lay_3391 = cute.get_layout(%view_3343) : !memref_rmem_i8_
          %shape_3392 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3393 = cute.make_layout() : !cute.layout<"1:0">
          %append_3394 = cute.append_to_rank<2> (%lay_3391, %lay_3393) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_3395 = cute.make_view(%iter_3345, %append_3394) : !memref_rmem_i8_
          %iter_3396 = cute.get_iter(%view_3395) : !memref_rmem_i8_
          %lay_3397 = cute.get_layout(%view_3395) : !memref_rmem_i8_
          %1157 = cute.get_shape(%lay_3397) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_3398, %e1_3399, %e2_3400 = cute.get_leaves(%1157) : !cute.shape<"(1,4,2)">
          %iter_3401 = cute.get_iter(%view_3395) : !memref_rmem_i8_
          %view_3402 = cute.make_view(%iter_3401) : !memref_rmem_i8_4
          %iter_3403 = cute.get_iter(%view_3402) : !memref_rmem_i8_4
          %iter_3404 = cute.get_iter(%view_3402) : !memref_rmem_i8_4
          %lay_3405 = cute.get_layout(%view_3373) : !memref_gmem_bf16_13
          %1158 = cute.get_shape(%lay_3405) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3406, %e1_3407, %e2_3408, %e3_3409 = cute.get_leaves(%1158) : !cute.shape<"((8,1),(4,2))">
          %lay_3410 = cute.get_layout(%view_3388) : !memref_smem_bf16_17
          %1159 = cute.get_shape(%lay_3410) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3411, %e1_3412, %e2_3413, %e3_3414 = cute.get_leaves(%1159) : !cute.shape<"((8,1),(4,2))">
          %lay_3415 = cute.get_layout(%view_3373) : !memref_gmem_bf16_13
          %sz_3416 = cute.size(%lay_3415) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_3417 = cute.get_leaves(%sz_3416) : !cute.int_tuple<"8">
          %lay_3418 = cute.get_layout(%view_3388) : !memref_smem_bf16_17
          %sz_3419 = cute.size(%lay_3418) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_3420 = cute.get_leaves(%sz_3419) : !cute.int_tuple<"8">
          %1160 = cute.static : !cute.layout<"1:0">
          %iter_3421 = cute.get_iter(%view_3373) : !memref_gmem_bf16_13
          %iter_3422 = cute.get_iter(%view_3388) : !memref_smem_bf16_17
          %lay_3423 = cute.get_layout(%view_3373) : !memref_gmem_bf16_13
          %lay_3424 = cute.get_layout(%view_3388) : !memref_smem_bf16_17
          %append_3425 = cute.append_to_rank<2> (%lay_3423, %1160) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_3426 = cute.append_to_rank<2> (%lay_3424, %1160) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1161 = cute.get_scalars(%append_3425) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_3427 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_3428 = cute.assume(%1161) : (i64) -> !cute.i64<divby 128>
          %stride_3429 = cute.make_stride(%iv_3428) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_3430 = cute.make_layout(%shape_3427, %stride_3429) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_3431 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_3432 = cute.get_iter(%view_3402) : !memref_rmem_i8_4
          %lay_3433 = cute.get_layout(%view_3402) : !memref_rmem_i8_4
          %append_3434 = cute.append_to_rank<2> (%lay_3433, %1160) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_3435 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_3436 = cute.size(%lay_3430) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1162 = cute.get_scalars(%sz_3436) : !cute.int_tuple<"8">
          %c0_i32_3437 = arith.constant 0 : i32
          %c1_i32_3438 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3437 to %1162 step %c1_i32_3438  : i32 {
            %coord_3585 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3586 = cute.slice(%lay_3430, %coord_3585) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_3587 = cute.crd2idx(%coord_3585, %lay_3430) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_3588 = cute.add_offset(%iter_3421, %idx_3587) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3589 = cute.make_view(%ptr_3588, %slice_3586) : !memref_gmem_bf16_10
            %slice_3590 = cute.slice(%lay_3431, %coord_3585) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_3591 = cute.crd2idx(%coord_3585, %lay_3431) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_3592 = cute.add_offset(%iter_3422, %idx_3591) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3593 = cute.make_view(%ptr_3592, %slice_3590) : !memref_smem_bf16_14
            %slice_3594 = cute.slice(%lay_3435, %coord_3585) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_3595 = cute.crd2idx(%coord_3585, %lay_3435) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_3596 = cute.add_offset(%iter_3432, %idx_3595) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_3597 = cute.make_view(%ptr_3596, %slice_3594) : !memref_rmem_i8_3
            cute.copy_atom_call(%4, %view_3589, %view_3593, %view_3597) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14, !memref_rmem_i8_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          %lay_3439 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %1163 = cute.get_shape(%lay_3439) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
          %e0_3440, %e1_3441, %e2_3442, %e3_3443, %e4_3444 = cute.get_leaves(%1163) : !cute.shape<"((8,1),4,1,?)">
          %itup_3445 = cute.to_int_tuple(%e4_3444) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1164 = cute.get_scalars(%itup_3445) : !cute.int_tuple<"?">
          %int_tuple_3446 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_3447 = cute.size(%int_tuple_3446) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_3448 = cute.get_leaves(%sz_3447) : !cute.int_tuple<"4">
          %int_tuple_3449 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3450 = cute.tuple_sub(%sub_2085, %int_tuple_3449) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1165 = cute.get_scalars(%sub_3450) : !cute.int_tuple<"?">
          %coord_3451 = cute.make_coord(%sub_3450) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
          %lay_3452 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3453 = cute.crd2idx(%coord_3451, %lay_3452) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
          %iter_3454 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3455 = cute.add_offset(%iter_3454, %idx_3453) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3456 = cute.make_view(%tup_3455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3457 = cute.get_iter(%view_3456) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3458, %e1_3459, %e2_3460, %e3_3461 = cute.get_leaves(%iter_3457) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1166 = cute.get_scalars(%e0_3458) : !cute.int_tuple<"?">
          %1167 = cute.get_scalars(%e1_3459) : !cute.int_tuple<"?">
          %1168 = cute.get_scalars(%e2_3460) : !cute.int_tuple<"?">
          %1169 = cute.get_scalars(%e3_3461) : !cute.int_tuple<"?{div=8}">
          %iter_3462 = cute.get_iter(%view_3456) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3463, %e1_3464, %e2_3465, %e3_3466 = cute.get_leaves(%iter_3462) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1170 = cute.get_scalars(%e0_3463) : !cute.int_tuple<"?">
          %1171 = cute.get_scalars(%e1_3464) : !cute.int_tuple<"?">
          %1172 = cute.get_scalars(%e2_3465) : !cute.int_tuple<"?">
          %1173 = cute.get_scalars(%e3_3466) : !cute.int_tuple<"?{div=8}">
          %iter_3467 = cute.get_iter(%view_3456) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3468, %e1_3469, %e2_3470, %e3_3471 = cute.get_leaves(%iter_3467) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1174 = cute.get_scalars(%e0_3468) : !cute.int_tuple<"?">
          %1175 = cute.get_scalars(%e1_3469) : !cute.int_tuple<"?">
          %1176 = cute.get_scalars(%e2_3470) : !cute.int_tuple<"?">
          %1177 = cute.get_scalars(%e3_3471) : !cute.int_tuple<"?{div=8}">
          %lay_3472 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1178 = cute.get_shape(%lay_3472) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3473, %e1_3474, %e2_3475, %e3_3476 = cute.get_leaves(%1178) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3477 = cute.to_int_tuple(%e0_3473) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1179 = cute.get_scalars(%itup_3477) : !cute.int_tuple<"?">
          %itup_3478 = cute.to_int_tuple(%e1_3474) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1180 = cute.get_scalars(%itup_3478) : !cute.int_tuple<"?">
          %itup_3479 = cute.to_int_tuple(%e2_3475) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1181 = cute.get_scalars(%itup_3479) : !cute.int_tuple<"?">
          %itup_3480 = cute.to_int_tuple(%e3_3476) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1182 = cute.get_scalars(%itup_3480) : !cute.int_tuple<"?{div=8}">
          %coord_3481 = cute.make_coord(%e1_3469) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3482 = cute.make_coord(%itup_3479) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1183 = cute.elem_less(%coord_3481, %coord_3482) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1183 {
            %int_tuple_3585 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3586 = cute.tuple_sub(%sub_2085, %int_tuple_3585) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1241 = cute.get_scalars(%sub_3586) : !cute.int_tuple<"?">
            %coord_3587 = cute.make_coord(%sub_3586) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_3588 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
            %idx_3589 = cute.crd2idx(%coord_3587, %lay_3588) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
            %iter_3590 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
            %ptr_3591 = cute.add_offset(%iter_3590, %idx_3589) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3592 = cute.make_view(%ptr_3591) : !memref_gmem_bf16_11
            %iter_3593 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %iter_3594 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %coord_3595 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3596 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3597 = cute.crd2idx(%coord_3595, %lay_3596) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_3598 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3599 = cute.add_offset(%iter_3598, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3600 = cute.make_view(%ptr_3599) : !memref_smem_bf16_15
            %iter_3601 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %iter_3602 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %lay_3603 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %1242 = cute.get_shape(%lay_3603) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3604, %e1_3605, %e2_3606 = cute.get_leaves(%1242) : !cute.shape<"((8,1),1)">
            %lay_3607 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %1243 = cute.get_shape(%lay_3607) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3608, %e1_3609, %e2_3610 = cute.get_leaves(%1243) : !cute.shape<"((8,1),1)">
            %lay_3611 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %shape_3612 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3613 = cute.make_layout() : !cute.layout<"1:0">
            %append_3614 = cute.append_to_rank<2> (%lay_3611, %lay_3613) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3615 = cute.make_view(%iter_3594, %append_3614) : !memref_gmem_bf16_11
            %iter_3616 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %lay_3617 = cute.get_layout(%view_3615) : !memref_gmem_bf16_11
            %1244 = cute.get_shape(%lay_3617) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3618, %e1_3619, %e2_3620 = cute.get_leaves(%1244) : !cute.shape<"((8,1),1)">
            %iter_3621 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %view_3622 = cute.make_view(%iter_3621) : !memref_gmem_bf16_12
            %iter_3623 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3624 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %lay_3625 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %shape_3626 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3627 = cute.make_layout() : !cute.layout<"1:0">
            %append_3628 = cute.append_to_rank<2> (%lay_3625, %lay_3627) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3629 = cute.make_view(%iter_3602, %append_3628) : !memref_smem_bf16_15
            %iter_3630 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %lay_3631 = cute.get_layout(%view_3629) : !memref_smem_bf16_15
            %1245 = cute.get_shape(%lay_3631) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3632, %e1_3633, %e2_3634 = cute.get_leaves(%1245) : !cute.shape<"((8,1),1)">
            %iter_3635 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %view_3636 = cute.make_view(%iter_3635) : !memref_smem_bf16_16
            %iter_3637 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %iter_3638 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3639 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %1246 = cute.get_shape(%lay_3639) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3640, %e1_3641, %e2_3642 = cute.get_leaves(%1246) : !cute.shape<"((8,1),(1))">
            %lay_3643 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %1247 = cute.get_shape(%lay_3643) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3644, %e1_3645, %e2_3646 = cute.get_leaves(%1247) : !cute.shape<"((8,1),(1))">
            %lay_3647 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %sz_3648 = cute.size(%lay_3647) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3649 = cute.get_leaves(%sz_3648) : !cute.int_tuple<"1">
            %lay_3650 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %sz_3651 = cute.size(%lay_3650) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3652 = cute.get_leaves(%sz_3651) : !cute.int_tuple<"1">
            %1248 = cute.static : !cute.layout<"1:0">
            %iter_3653 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3654 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3655 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %lay_3656 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %append_3657 = cute.append_to_rank<2> (%lay_3655, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3658 = cute.append_to_rank<2> (%lay_3656, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3659 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3660 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3661 = cute.size(%lay_3659) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1249 = cute.get_scalars(%sz_3661) : !cute.int_tuple<"1">
            %c0_i32_3662 = arith.constant 0 : i32
            %c1_i32_3663 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3662 to %1249 step %c1_i32_3663  : i32 {
              %coord_3664 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3665 = cute.slice(%lay_3659, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3666 = cute.crd2idx(%coord_3664, %lay_3659) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3667 = cute.add_offset(%iter_3653, %idx_3666) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3668 = cute.make_view(%ptr_3667, %slice_3665) : !memref_gmem_bf16_10
              %slice_3669 = cute.slice(%lay_3660, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3670 = cute.crd2idx(%coord_3664, %lay_3660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3671 = cute.add_offset(%iter_3654, %idx_3670) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3672 = cute.make_view(%ptr_3671, %slice_3669) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3668, %view_3672) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3585 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_3586 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3587 = cute.crd2idx(%coord_3585, %lay_3586) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_3588 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3589 = cute.add_offset(%iter_3588, %idx_3587) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3590 = cute.make_view(%ptr_3589) : !memref_smem_bf16_15
            %iter_3591 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %iter_3592 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %lay_3593 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %sz_3594 = cute.size(%lay_3593) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3595 = cute.get_leaves(%sz_3594) : !cute.int_tuple<"8">
            %lay_3596 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %1241 = cute.get_shape(%lay_3596) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3597, %e1_3598, %e2_3599 = cute.get_leaves(%1241) : !cute.shape<"((8,1),1)">
            %int_tuple_3600 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3601 = cute.tuple.product(%int_tuple_3600) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3602 = cute.get_leaves(%res_3601) : !cute.int_tuple<"8">
            %cst_3603 = arith.constant 0.000000e+00 : bf16
            %1242 = vector.splat %cst_3603 : vector<8xbf16>
            %int_tuple_3604 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3605 = cute.size(%int_tuple_3604) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3606 = cute.get_leaves(%sz_3605) : !cute.int_tuple<"8">
            %int_tuple_3607 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3608 = cute.size(%int_tuple_3607) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3609 = cute.get_leaves(%sz_3608) : !cute.int_tuple<"8">
            cute.memref.store_vec %1242, %view_3590 : !memref_smem_bf16_15
          }
          %int_tuple_3483 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3484 = cute.tuple_sub(%sub_2085, %int_tuple_3483) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1184 = cute.get_scalars(%sub_3484) : !cute.int_tuple<"?">
          %coord_3485 = cute.make_coord(%sub_3484) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
          %lay_3486 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3487 = cute.crd2idx(%coord_3485, %lay_3486) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
          %iter_3488 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3489 = cute.add_offset(%iter_3488, %idx_3487) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3490 = cute.make_view(%tup_3489) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3491 = cute.get_iter(%view_3490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3492, %e1_3493, %e2_3494, %e3_3495 = cute.get_leaves(%iter_3491) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1185 = cute.get_scalars(%e0_3492) : !cute.int_tuple<"?">
          %1186 = cute.get_scalars(%e1_3493) : !cute.int_tuple<"?">
          %1187 = cute.get_scalars(%e2_3494) : !cute.int_tuple<"?">
          %1188 = cute.get_scalars(%e3_3495) : !cute.int_tuple<"?{div=8}">
          %iter_3496 = cute.get_iter(%view_3490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3497, %e1_3498, %e2_3499, %e3_3500 = cute.get_leaves(%iter_3496) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1189 = cute.get_scalars(%e0_3497) : !cute.int_tuple<"?">
          %1190 = cute.get_scalars(%e1_3498) : !cute.int_tuple<"?">
          %1191 = cute.get_scalars(%e2_3499) : !cute.int_tuple<"?">
          %1192 = cute.get_scalars(%e3_3500) : !cute.int_tuple<"?{div=8}">
          %iter_3501 = cute.get_iter(%view_3490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3502, %e1_3503, %e2_3504, %e3_3505 = cute.get_leaves(%iter_3501) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1193 = cute.get_scalars(%e0_3502) : !cute.int_tuple<"?">
          %1194 = cute.get_scalars(%e1_3503) : !cute.int_tuple<"?">
          %1195 = cute.get_scalars(%e2_3504) : !cute.int_tuple<"?">
          %1196 = cute.get_scalars(%e3_3505) : !cute.int_tuple<"?{div=8}">
          %lay_3506 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1197 = cute.get_shape(%lay_3506) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3507, %e1_3508, %e2_3509, %e3_3510 = cute.get_leaves(%1197) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3511 = cute.to_int_tuple(%e0_3507) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1198 = cute.get_scalars(%itup_3511) : !cute.int_tuple<"?">
          %itup_3512 = cute.to_int_tuple(%e1_3508) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1199 = cute.get_scalars(%itup_3512) : !cute.int_tuple<"?">
          %itup_3513 = cute.to_int_tuple(%e2_3509) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1200 = cute.get_scalars(%itup_3513) : !cute.int_tuple<"?">
          %itup_3514 = cute.to_int_tuple(%e3_3510) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1201 = cute.get_scalars(%itup_3514) : !cute.int_tuple<"?{div=8}">
          %coord_3515 = cute.make_coord(%e1_3503) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3516 = cute.make_coord(%itup_3513) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1202 = cute.elem_less(%coord_3515, %coord_3516) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1202 {
            %int_tuple_3585 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3586 = cute.tuple_sub(%sub_2085, %int_tuple_3585) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1241 = cute.get_scalars(%sub_3586) : !cute.int_tuple<"?">
            %coord_3587 = cute.make_coord(%sub_3586) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_3588 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
            %idx_3589 = cute.crd2idx(%coord_3587, %lay_3588) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_3590 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
            %ptr_3591 = cute.add_offset(%iter_3590, %idx_3589) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3592 = cute.make_view(%ptr_3591) : !memref_gmem_bf16_11
            %iter_3593 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %iter_3594 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %coord_3595 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3596 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3597 = cute.crd2idx(%coord_3595, %lay_3596) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_3598 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3599 = cute.add_offset(%iter_3598, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3600 = cute.make_view(%ptr_3599) : !memref_smem_bf16_15
            %iter_3601 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %iter_3602 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %lay_3603 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %1242 = cute.get_shape(%lay_3603) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3604, %e1_3605, %e2_3606 = cute.get_leaves(%1242) : !cute.shape<"((8,1),1)">
            %lay_3607 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %1243 = cute.get_shape(%lay_3607) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3608, %e1_3609, %e2_3610 = cute.get_leaves(%1243) : !cute.shape<"((8,1),1)">
            %lay_3611 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %shape_3612 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3613 = cute.make_layout() : !cute.layout<"1:0">
            %append_3614 = cute.append_to_rank<2> (%lay_3611, %lay_3613) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3615 = cute.make_view(%iter_3594, %append_3614) : !memref_gmem_bf16_11
            %iter_3616 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %lay_3617 = cute.get_layout(%view_3615) : !memref_gmem_bf16_11
            %1244 = cute.get_shape(%lay_3617) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3618, %e1_3619, %e2_3620 = cute.get_leaves(%1244) : !cute.shape<"((8,1),1)">
            %iter_3621 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %view_3622 = cute.make_view(%iter_3621) : !memref_gmem_bf16_12
            %iter_3623 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3624 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %lay_3625 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %shape_3626 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3627 = cute.make_layout() : !cute.layout<"1:0">
            %append_3628 = cute.append_to_rank<2> (%lay_3625, %lay_3627) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3629 = cute.make_view(%iter_3602, %append_3628) : !memref_smem_bf16_15
            %iter_3630 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %lay_3631 = cute.get_layout(%view_3629) : !memref_smem_bf16_15
            %1245 = cute.get_shape(%lay_3631) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3632, %e1_3633, %e2_3634 = cute.get_leaves(%1245) : !cute.shape<"((8,1),1)">
            %iter_3635 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %view_3636 = cute.make_view(%iter_3635) : !memref_smem_bf16_16
            %iter_3637 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %iter_3638 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3639 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %1246 = cute.get_shape(%lay_3639) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3640, %e1_3641, %e2_3642 = cute.get_leaves(%1246) : !cute.shape<"((8,1),(1))">
            %lay_3643 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %1247 = cute.get_shape(%lay_3643) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3644, %e1_3645, %e2_3646 = cute.get_leaves(%1247) : !cute.shape<"((8,1),(1))">
            %lay_3647 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %sz_3648 = cute.size(%lay_3647) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3649 = cute.get_leaves(%sz_3648) : !cute.int_tuple<"1">
            %lay_3650 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %sz_3651 = cute.size(%lay_3650) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3652 = cute.get_leaves(%sz_3651) : !cute.int_tuple<"1">
            %1248 = cute.static : !cute.layout<"1:0">
            %iter_3653 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3654 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3655 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %lay_3656 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %append_3657 = cute.append_to_rank<2> (%lay_3655, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3658 = cute.append_to_rank<2> (%lay_3656, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3659 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3660 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3661 = cute.size(%lay_3659) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1249 = cute.get_scalars(%sz_3661) : !cute.int_tuple<"1">
            %c0_i32_3662 = arith.constant 0 : i32
            %c1_i32_3663 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3662 to %1249 step %c1_i32_3663  : i32 {
              %coord_3664 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3665 = cute.slice(%lay_3659, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3666 = cute.crd2idx(%coord_3664, %lay_3659) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3667 = cute.add_offset(%iter_3653, %idx_3666) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3668 = cute.make_view(%ptr_3667, %slice_3665) : !memref_gmem_bf16_10
              %slice_3669 = cute.slice(%lay_3660, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3670 = cute.crd2idx(%coord_3664, %lay_3660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3671 = cute.add_offset(%iter_3654, %idx_3670) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3672 = cute.make_view(%ptr_3671, %slice_3669) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3668, %view_3672) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3585 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_3586 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3587 = cute.crd2idx(%coord_3585, %lay_3586) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_3588 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3589 = cute.add_offset(%iter_3588, %idx_3587) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3590 = cute.make_view(%ptr_3589) : !memref_smem_bf16_15
            %iter_3591 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %iter_3592 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %lay_3593 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %sz_3594 = cute.size(%lay_3593) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3595 = cute.get_leaves(%sz_3594) : !cute.int_tuple<"8">
            %lay_3596 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %1241 = cute.get_shape(%lay_3596) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3597, %e1_3598, %e2_3599 = cute.get_leaves(%1241) : !cute.shape<"((8,1),1)">
            %int_tuple_3600 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3601 = cute.tuple.product(%int_tuple_3600) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3602 = cute.get_leaves(%res_3601) : !cute.int_tuple<"8">
            %cst_3603 = arith.constant 0.000000e+00 : bf16
            %1242 = vector.splat %cst_3603 : vector<8xbf16>
            %int_tuple_3604 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3605 = cute.size(%int_tuple_3604) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3606 = cute.get_leaves(%sz_3605) : !cute.int_tuple<"8">
            %int_tuple_3607 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3608 = cute.size(%int_tuple_3607) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3609 = cute.get_leaves(%sz_3608) : !cute.int_tuple<"8">
            cute.memref.store_vec %1242, %view_3590 : !memref_smem_bf16_15
          }
          %int_tuple_3517 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3518 = cute.tuple_sub(%sub_2085, %int_tuple_3517) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1203 = cute.get_scalars(%sub_3518) : !cute.int_tuple<"?">
          %coord_3519 = cute.make_coord(%sub_3518) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
          %lay_3520 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3521 = cute.crd2idx(%coord_3519, %lay_3520) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
          %iter_3522 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3523 = cute.add_offset(%iter_3522, %idx_3521) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3524 = cute.make_view(%tup_3523) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3525 = cute.get_iter(%view_3524) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3526, %e1_3527, %e2_3528, %e3_3529 = cute.get_leaves(%iter_3525) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1204 = cute.get_scalars(%e0_3526) : !cute.int_tuple<"?">
          %1205 = cute.get_scalars(%e1_3527) : !cute.int_tuple<"?">
          %1206 = cute.get_scalars(%e2_3528) : !cute.int_tuple<"?">
          %1207 = cute.get_scalars(%e3_3529) : !cute.int_tuple<"?{div=8}">
          %iter_3530 = cute.get_iter(%view_3524) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3531, %e1_3532, %e2_3533, %e3_3534 = cute.get_leaves(%iter_3530) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1208 = cute.get_scalars(%e0_3531) : !cute.int_tuple<"?">
          %1209 = cute.get_scalars(%e1_3532) : !cute.int_tuple<"?">
          %1210 = cute.get_scalars(%e2_3533) : !cute.int_tuple<"?">
          %1211 = cute.get_scalars(%e3_3534) : !cute.int_tuple<"?{div=8}">
          %iter_3535 = cute.get_iter(%view_3524) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3536, %e1_3537, %e2_3538, %e3_3539 = cute.get_leaves(%iter_3535) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1212 = cute.get_scalars(%e0_3536) : !cute.int_tuple<"?">
          %1213 = cute.get_scalars(%e1_3537) : !cute.int_tuple<"?">
          %1214 = cute.get_scalars(%e2_3538) : !cute.int_tuple<"?">
          %1215 = cute.get_scalars(%e3_3539) : !cute.int_tuple<"?{div=8}">
          %lay_3540 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1216 = cute.get_shape(%lay_3540) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3541, %e1_3542, %e2_3543, %e3_3544 = cute.get_leaves(%1216) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3545 = cute.to_int_tuple(%e0_3541) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1217 = cute.get_scalars(%itup_3545) : !cute.int_tuple<"?">
          %itup_3546 = cute.to_int_tuple(%e1_3542) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1218 = cute.get_scalars(%itup_3546) : !cute.int_tuple<"?">
          %itup_3547 = cute.to_int_tuple(%e2_3543) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1219 = cute.get_scalars(%itup_3547) : !cute.int_tuple<"?">
          %itup_3548 = cute.to_int_tuple(%e3_3544) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1220 = cute.get_scalars(%itup_3548) : !cute.int_tuple<"?{div=8}">
          %coord_3549 = cute.make_coord(%e1_3537) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3550 = cute.make_coord(%itup_3547) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1221 = cute.elem_less(%coord_3549, %coord_3550) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1221 {
            %int_tuple_3585 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3586 = cute.tuple_sub(%sub_2085, %int_tuple_3585) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1241 = cute.get_scalars(%sub_3586) : !cute.int_tuple<"?">
            %coord_3587 = cute.make_coord(%sub_3586) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_3588 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
            %idx_3589 = cute.crd2idx(%coord_3587, %lay_3588) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_3590 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
            %ptr_3591 = cute.add_offset(%iter_3590, %idx_3589) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3592 = cute.make_view(%ptr_3591) : !memref_gmem_bf16_11
            %iter_3593 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %iter_3594 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %coord_3595 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3596 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3597 = cute.crd2idx(%coord_3595, %lay_3596) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_3598 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3599 = cute.add_offset(%iter_3598, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3600 = cute.make_view(%ptr_3599) : !memref_smem_bf16_15
            %iter_3601 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %iter_3602 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %lay_3603 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %1242 = cute.get_shape(%lay_3603) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3604, %e1_3605, %e2_3606 = cute.get_leaves(%1242) : !cute.shape<"((8,1),1)">
            %lay_3607 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %1243 = cute.get_shape(%lay_3607) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3608, %e1_3609, %e2_3610 = cute.get_leaves(%1243) : !cute.shape<"((8,1),1)">
            %lay_3611 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %shape_3612 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3613 = cute.make_layout() : !cute.layout<"1:0">
            %append_3614 = cute.append_to_rank<2> (%lay_3611, %lay_3613) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3615 = cute.make_view(%iter_3594, %append_3614) : !memref_gmem_bf16_11
            %iter_3616 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %lay_3617 = cute.get_layout(%view_3615) : !memref_gmem_bf16_11
            %1244 = cute.get_shape(%lay_3617) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3618, %e1_3619, %e2_3620 = cute.get_leaves(%1244) : !cute.shape<"((8,1),1)">
            %iter_3621 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %view_3622 = cute.make_view(%iter_3621) : !memref_gmem_bf16_12
            %iter_3623 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3624 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %lay_3625 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %shape_3626 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3627 = cute.make_layout() : !cute.layout<"1:0">
            %append_3628 = cute.append_to_rank<2> (%lay_3625, %lay_3627) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3629 = cute.make_view(%iter_3602, %append_3628) : !memref_smem_bf16_15
            %iter_3630 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %lay_3631 = cute.get_layout(%view_3629) : !memref_smem_bf16_15
            %1245 = cute.get_shape(%lay_3631) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3632, %e1_3633, %e2_3634 = cute.get_leaves(%1245) : !cute.shape<"((8,1),1)">
            %iter_3635 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %view_3636 = cute.make_view(%iter_3635) : !memref_smem_bf16_16
            %iter_3637 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %iter_3638 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3639 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %1246 = cute.get_shape(%lay_3639) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3640, %e1_3641, %e2_3642 = cute.get_leaves(%1246) : !cute.shape<"((8,1),(1))">
            %lay_3643 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %1247 = cute.get_shape(%lay_3643) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3644, %e1_3645, %e2_3646 = cute.get_leaves(%1247) : !cute.shape<"((8,1),(1))">
            %lay_3647 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %sz_3648 = cute.size(%lay_3647) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3649 = cute.get_leaves(%sz_3648) : !cute.int_tuple<"1">
            %lay_3650 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %sz_3651 = cute.size(%lay_3650) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3652 = cute.get_leaves(%sz_3651) : !cute.int_tuple<"1">
            %1248 = cute.static : !cute.layout<"1:0">
            %iter_3653 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3654 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3655 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %lay_3656 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %append_3657 = cute.append_to_rank<2> (%lay_3655, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3658 = cute.append_to_rank<2> (%lay_3656, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3659 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3660 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3661 = cute.size(%lay_3659) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1249 = cute.get_scalars(%sz_3661) : !cute.int_tuple<"1">
            %c0_i32_3662 = arith.constant 0 : i32
            %c1_i32_3663 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3662 to %1249 step %c1_i32_3663  : i32 {
              %coord_3664 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3665 = cute.slice(%lay_3659, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3666 = cute.crd2idx(%coord_3664, %lay_3659) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3667 = cute.add_offset(%iter_3653, %idx_3666) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3668 = cute.make_view(%ptr_3667, %slice_3665) : !memref_gmem_bf16_10
              %slice_3669 = cute.slice(%lay_3660, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3670 = cute.crd2idx(%coord_3664, %lay_3660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3671 = cute.add_offset(%iter_3654, %idx_3670) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3672 = cute.make_view(%ptr_3671, %slice_3669) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3668, %view_3672) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3585 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_3586 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3587 = cute.crd2idx(%coord_3585, %lay_3586) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_3588 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3589 = cute.add_offset(%iter_3588, %idx_3587) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3590 = cute.make_view(%ptr_3589) : !memref_smem_bf16_15
            %iter_3591 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %iter_3592 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %lay_3593 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %sz_3594 = cute.size(%lay_3593) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3595 = cute.get_leaves(%sz_3594) : !cute.int_tuple<"8">
            %lay_3596 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %1241 = cute.get_shape(%lay_3596) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3597, %e1_3598, %e2_3599 = cute.get_leaves(%1241) : !cute.shape<"((8,1),1)">
            %int_tuple_3600 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3601 = cute.tuple.product(%int_tuple_3600) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3602 = cute.get_leaves(%res_3601) : !cute.int_tuple<"8">
            %cst_3603 = arith.constant 0.000000e+00 : bf16
            %1242 = vector.splat %cst_3603 : vector<8xbf16>
            %int_tuple_3604 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3605 = cute.size(%int_tuple_3604) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3606 = cute.get_leaves(%sz_3605) : !cute.int_tuple<"8">
            %int_tuple_3607 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3608 = cute.size(%int_tuple_3607) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3609 = cute.get_leaves(%sz_3608) : !cute.int_tuple<"8">
            cute.memref.store_vec %1242, %view_3590 : !memref_smem_bf16_15
          }
          %int_tuple_3551 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3552 = cute.tuple_sub(%sub_2085, %int_tuple_3551) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1222 = cute.get_scalars(%sub_3552) : !cute.int_tuple<"?">
          %coord_3553 = cute.make_coord(%sub_3552) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
          %lay_3554 = cute.get_layout(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_3555 = cute.crd2idx(%coord_3553, %lay_3554) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
          %iter_3556 = cute.get_iter(%src_partitioned_656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_3557 = cute.add_offset(%iter_3556, %idx_3555) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3558 = cute.make_view(%tup_3557) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3559 = cute.get_iter(%view_3558) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3560, %e1_3561, %e2_3562, %e3_3563 = cute.get_leaves(%iter_3559) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1223 = cute.get_scalars(%e0_3560) : !cute.int_tuple<"?">
          %1224 = cute.get_scalars(%e1_3561) : !cute.int_tuple<"?">
          %1225 = cute.get_scalars(%e2_3562) : !cute.int_tuple<"?">
          %1226 = cute.get_scalars(%e3_3563) : !cute.int_tuple<"?{div=8}">
          %iter_3564 = cute.get_iter(%view_3558) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3565, %e1_3566, %e2_3567, %e3_3568 = cute.get_leaves(%iter_3564) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1227 = cute.get_scalars(%e0_3565) : !cute.int_tuple<"?">
          %1228 = cute.get_scalars(%e1_3566) : !cute.int_tuple<"?">
          %1229 = cute.get_scalars(%e2_3567) : !cute.int_tuple<"?">
          %1230 = cute.get_scalars(%e3_3568) : !cute.int_tuple<"?{div=8}">
          %iter_3569 = cute.get_iter(%view_3558) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3570, %e1_3571, %e2_3572, %e3_3573 = cute.get_leaves(%iter_3569) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1231 = cute.get_scalars(%e0_3570) : !cute.int_tuple<"?">
          %1232 = cute.get_scalars(%e1_3571) : !cute.int_tuple<"?">
          %1233 = cute.get_scalars(%e2_3572) : !cute.int_tuple<"?">
          %1234 = cute.get_scalars(%e3_3573) : !cute.int_tuple<"?{div=8}">
          %lay_3574 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1235 = cute.get_shape(%lay_3574) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3575, %e1_3576, %e2_3577, %e3_3578 = cute.get_leaves(%1235) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3579 = cute.to_int_tuple(%e0_3575) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1236 = cute.get_scalars(%itup_3579) : !cute.int_tuple<"?">
          %itup_3580 = cute.to_int_tuple(%e1_3576) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1237 = cute.get_scalars(%itup_3580) : !cute.int_tuple<"?">
          %itup_3581 = cute.to_int_tuple(%e2_3577) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1238 = cute.get_scalars(%itup_3581) : !cute.int_tuple<"?">
          %itup_3582 = cute.to_int_tuple(%e3_3578) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1239 = cute.get_scalars(%itup_3582) : !cute.int_tuple<"?{div=8}">
          %coord_3583 = cute.make_coord(%e1_3571) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3584 = cute.make_coord(%itup_3581) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1240 = cute.elem_less(%coord_3583, %coord_3584) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %1240 {
            %int_tuple_3585 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_3586 = cute.tuple_sub(%sub_2085, %int_tuple_3585) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1241 = cute.get_scalars(%sub_3586) : !cute.int_tuple<"?">
            %coord_3587 = cute.make_coord(%sub_3586) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_3588 = cute.get_layout(%src_partitioned_383) : !memref_gmem_bf16_7
            %idx_3589 = cute.crd2idx(%coord_3587, %lay_3588) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_3590 = cute.get_iter(%src_partitioned_383) : !memref_gmem_bf16_7
            %ptr_3591 = cute.add_offset(%iter_3590, %idx_3589) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_3592 = cute.make_view(%ptr_3591) : !memref_gmem_bf16_11
            %iter_3593 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %iter_3594 = cute.get_iter(%view_3592) : !memref_gmem_bf16_11
            %coord_3595 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3596 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3597 = cute.crd2idx(%coord_3595, %lay_3596) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_3598 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3599 = cute.add_offset(%iter_3598, %idx_3597) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3600 = cute.make_view(%ptr_3599) : !memref_smem_bf16_15
            %iter_3601 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %iter_3602 = cute.get_iter(%view_3600) : !memref_smem_bf16_15
            %lay_3603 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %1242 = cute.get_shape(%lay_3603) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3604, %e1_3605, %e2_3606 = cute.get_leaves(%1242) : !cute.shape<"((8,1),1)">
            %lay_3607 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %1243 = cute.get_shape(%lay_3607) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3608, %e1_3609, %e2_3610 = cute.get_leaves(%1243) : !cute.shape<"((8,1),1)">
            %lay_3611 = cute.get_layout(%view_3592) : !memref_gmem_bf16_11
            %shape_3612 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3613 = cute.make_layout() : !cute.layout<"1:0">
            %append_3614 = cute.append_to_rank<2> (%lay_3611, %lay_3613) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3615 = cute.make_view(%iter_3594, %append_3614) : !memref_gmem_bf16_11
            %iter_3616 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %lay_3617 = cute.get_layout(%view_3615) : !memref_gmem_bf16_11
            %1244 = cute.get_shape(%lay_3617) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3618, %e1_3619, %e2_3620 = cute.get_leaves(%1244) : !cute.shape<"((8,1),1)">
            %iter_3621 = cute.get_iter(%view_3615) : !memref_gmem_bf16_11
            %view_3622 = cute.make_view(%iter_3621) : !memref_gmem_bf16_12
            %iter_3623 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3624 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %lay_3625 = cute.get_layout(%view_3600) : !memref_smem_bf16_15
            %shape_3626 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_3627 = cute.make_layout() : !cute.layout<"1:0">
            %append_3628 = cute.append_to_rank<2> (%lay_3625, %lay_3627) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_3629 = cute.make_view(%iter_3602, %append_3628) : !memref_smem_bf16_15
            %iter_3630 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %lay_3631 = cute.get_layout(%view_3629) : !memref_smem_bf16_15
            %1245 = cute.get_shape(%lay_3631) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3632, %e1_3633, %e2_3634 = cute.get_leaves(%1245) : !cute.shape<"((8,1),1)">
            %iter_3635 = cute.get_iter(%view_3629) : !memref_smem_bf16_15
            %view_3636 = cute.make_view(%iter_3635) : !memref_smem_bf16_16
            %iter_3637 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %iter_3638 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3639 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %1246 = cute.get_shape(%lay_3639) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3640, %e1_3641, %e2_3642 = cute.get_leaves(%1246) : !cute.shape<"((8,1),(1))">
            %lay_3643 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %1247 = cute.get_shape(%lay_3643) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_3644, %e1_3645, %e2_3646 = cute.get_leaves(%1247) : !cute.shape<"((8,1),(1))">
            %lay_3647 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %sz_3648 = cute.size(%lay_3647) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3649 = cute.get_leaves(%sz_3648) : !cute.int_tuple<"1">
            %lay_3650 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %sz_3651 = cute.size(%lay_3650) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_3652 = cute.get_leaves(%sz_3651) : !cute.int_tuple<"1">
            %1248 = cute.static : !cute.layout<"1:0">
            %iter_3653 = cute.get_iter(%view_3622) : !memref_gmem_bf16_12
            %iter_3654 = cute.get_iter(%view_3636) : !memref_smem_bf16_16
            %lay_3655 = cute.get_layout(%view_3622) : !memref_gmem_bf16_12
            %lay_3656 = cute.get_layout(%view_3636) : !memref_smem_bf16_16
            %append_3657 = cute.append_to_rank<2> (%lay_3655, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_3658 = cute.append_to_rank<2> (%lay_3656, %1248) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_3659 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_3660 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_3661 = cute.size(%lay_3659) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1249 = cute.get_scalars(%sz_3661) : !cute.int_tuple<"1">
            %c0_i32_3662 = arith.constant 0 : i32
            %c1_i32_3663 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_3662 to %1249 step %c1_i32_3663  : i32 {
              %coord_3664 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %slice_3665 = cute.slice(%lay_3659, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3666 = cute.crd2idx(%coord_3664, %lay_3659) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3667 = cute.add_offset(%iter_3653, %idx_3666) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_3668 = cute.make_view(%ptr_3667, %slice_3665) : !memref_gmem_bf16_10
              %slice_3669 = cute.slice(%lay_3660, %coord_3664) : !cute.layout<"((8,1),((1))):((1,0),((0)))">, !cute.coord<"(_,?)">
              %idx_3670 = cute.crd2idx(%coord_3664, %lay_3660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_3671 = cute.add_offset(%iter_3654, %idx_3670) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_3672 = cute.make_view(%ptr_3671, %slice_3669) : !memref_smem_bf16_14
              cute.copy_atom_call(%4, %view_3668, %view_3672) : (!copy_ldgsts, !memref_gmem_bf16_10, !memref_smem_bf16_14) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_3585 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_3586 = cute.get_layout(%dst_partitioned_386) : !memref_smem_bf16_4
            %idx_3587 = cute.crd2idx(%coord_3585, %lay_3586) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_3588 = cute.get_iter(%dst_partitioned_386) : !memref_smem_bf16_4
            %ptr_3589 = cute.add_offset(%iter_3588, %idx_3587) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3590 = cute.make_view(%ptr_3589) : !memref_smem_bf16_15
            %iter_3591 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %iter_3592 = cute.get_iter(%view_3590) : !memref_smem_bf16_15
            %lay_3593 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %sz_3594 = cute.size(%lay_3593) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_3595 = cute.get_leaves(%sz_3594) : !cute.int_tuple<"8">
            %lay_3596 = cute.get_layout(%view_3590) : !memref_smem_bf16_15
            %1241 = cute.get_shape(%lay_3596) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_3597, %e1_3598, %e2_3599 = cute.get_leaves(%1241) : !cute.shape<"((8,1),1)">
            %int_tuple_3600 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %res_3601 = cute.tuple.product(%int_tuple_3600) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3602 = cute.get_leaves(%res_3601) : !cute.int_tuple<"8">
            %cst_3603 = arith.constant 0.000000e+00 : bf16
            %1242 = vector.splat %cst_3603 : vector<8xbf16>
            %int_tuple_3604 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3605 = cute.size(%int_tuple_3604) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3606 = cute.get_leaves(%sz_3605) : !cute.int_tuple<"8">
            %int_tuple_3607 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_3608 = cute.size(%int_tuple_3607) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_3609 = cute.get_leaves(%sz_3608) : !cute.int_tuple<"8">
            cute.memref.store_vec %1242, %view_3590 : !memref_smem_bf16_15
          }
          nvvm.cp.async.commit.group
        }
        %lay_2745 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
        %1012 = cute.get_shape(%lay_2745) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2746, %e1_2747, %e2_2748, %e3_2749 = cute.get_leaves(%1012) : !cute.shape<"((2,2),1,8)">
        %1013 = cute.get_stride(%lay_2745) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2750, %e1_2751, %e2_2752, %e3_2753 = cute.get_leaves(%1013) : !cute.stride<"((1,2),0,4)">
        %1014 = scf.if %true -> (!memref_rmem_f32_1) {
          %iter_3319 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
          %lay_3320 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
          %1151 = cute.get_shape(%lay_3320) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3321, %e1_3322, %e2_3323, %e3_3324 = cute.get_leaves(%1151) : !cute.shape<"((2,2),1,8)">
          %1152 = cute.memref.load_vec %rmem_2095 : !memref_rmem_f32_1
          %cst_3325 = arith.constant 5.000000e-01 : f32
          %1153 = vector.broadcast %cst_3325 : f32 to vector<32xf32>
          %1154 = arith.mulf %1152, %1153 : vector<32xf32>
          %int_tuple_3326 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3327 = cute.size(%int_tuple_3326) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3328 = cute.get_leaves(%sz_3327) : !cute.int_tuple<"32">
          %int_tuple_3329 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3330 = cute.size(%int_tuple_3329) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3331 = cute.get_leaves(%sz_3330) : !cute.int_tuple<"32">
          cute.memref.store_vec %1154, %rmem_2095 : !memref_rmem_f32_1
          %int_tuple_3332 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_3333 = cute.size(%int_tuple_3332) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_3334 = cute.get_leaves(%sz_3333) : !cute.int_tuple<"4">
          %int_tuple_3335 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3336 = cute.size(%int_tuple_3335) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3337 = cute.get_leaves(%sz_3336) : !cute.int_tuple<"1">
          %int_tuple_3338 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3339 = cute.size(%int_tuple_3338) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3340 = cute.get_leaves(%sz_3339) : !cute.int_tuple<"8">
          %coord_3341 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %1155 = cute.memref.load(%rmem_2095, %coord_3341) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">) -> f32
          %1156 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1155 : (f32) -> f32
          %coord_3342 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          cute.memref.store(%rmem_2095, %coord_3342, %1156) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
          %coord_3343 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %1157 = cute.memref.load(%rmem_2095, %coord_3343) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">) -> f32
          %1158 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1157 : (f32) -> f32
          %coord_3344 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          cute.memref.store(%rmem_2095, %coord_3344, %1158) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
          %coord_3345 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %1159 = cute.memref.load(%rmem_2095, %coord_3345) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">) -> f32
          %1160 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1159 : (f32) -> f32
          %coord_3346 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          cute.memref.store(%rmem_2095, %coord_3346, %1160) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
          %coord_3347 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %1161 = cute.memref.load(%rmem_2095, %coord_3347) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">) -> f32
          %1162 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1161 : (f32) -> f32
          %coord_3348 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          cute.memref.store(%rmem_2095, %coord_3348, %1162) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
          %coord_3349 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %1163 = cute.memref.load(%rmem_2095, %coord_3349) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">) -> f32
          %1164 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1163 : (f32) -> f32
          %coord_3350 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          cute.memref.store(%rmem_2095, %coord_3350, %1164) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
          %coord_3351 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %1165 = cute.memref.load(%rmem_2095, %coord_3351) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">) -> f32
          %1166 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1165 : (f32) -> f32
          %coord_3352 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          cute.memref.store(%rmem_2095, %coord_3352, %1166) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
          %coord_3353 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %1167 = cute.memref.load(%rmem_2095, %coord_3353) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">) -> f32
          %1168 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1167 : (f32) -> f32
          %coord_3354 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          cute.memref.store(%rmem_2095, %coord_3354, %1168) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
          %coord_3355 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %1169 = cute.memref.load(%rmem_2095, %coord_3355) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">) -> f32
          %1170 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1169 : (f32) -> f32
          %coord_3356 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          cute.memref.store(%rmem_2095, %coord_3356, %1170) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
          %int_tuple_3357 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3358 = cute.size(%int_tuple_3357) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3359 = cute.get_leaves(%sz_3358) : !cute.int_tuple<"1">
          %int_tuple_3360 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3361 = cute.size(%int_tuple_3360) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3362 = cute.get_leaves(%sz_3361) : !cute.int_tuple<"8">
          %coord_3363 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %1171 = cute.memref.load(%rmem_2095, %coord_3363) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">) -> f32
          %1172 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1171 : (f32) -> f32
          %coord_3364 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          cute.memref.store(%rmem_2095, %coord_3364, %1172) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
          %coord_3365 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %1173 = cute.memref.load(%rmem_2095, %coord_3365) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">) -> f32
          %1174 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1173 : (f32) -> f32
          %coord_3366 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          cute.memref.store(%rmem_2095, %coord_3366, %1174) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
          %coord_3367 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %1175 = cute.memref.load(%rmem_2095, %coord_3367) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">) -> f32
          %1176 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1175 : (f32) -> f32
          %coord_3368 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          cute.memref.store(%rmem_2095, %coord_3368, %1176) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
          %coord_3369 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %1177 = cute.memref.load(%rmem_2095, %coord_3369) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">) -> f32
          %1178 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1177 : (f32) -> f32
          %coord_3370 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          cute.memref.store(%rmem_2095, %coord_3370, %1178) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
          %coord_3371 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %1179 = cute.memref.load(%rmem_2095, %coord_3371) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">) -> f32
          %1180 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1179 : (f32) -> f32
          %coord_3372 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          cute.memref.store(%rmem_2095, %coord_3372, %1180) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
          %coord_3373 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %1181 = cute.memref.load(%rmem_2095, %coord_3373) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">) -> f32
          %1182 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1181 : (f32) -> f32
          %coord_3374 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          cute.memref.store(%rmem_2095, %coord_3374, %1182) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
          %coord_3375 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %1183 = cute.memref.load(%rmem_2095, %coord_3375) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">) -> f32
          %1184 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1183 : (f32) -> f32
          %coord_3376 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          cute.memref.store(%rmem_2095, %coord_3376, %1184) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
          %coord_3377 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %1185 = cute.memref.load(%rmem_2095, %coord_3377) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">) -> f32
          %1186 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1185 : (f32) -> f32
          %coord_3378 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          cute.memref.store(%rmem_2095, %coord_3378, %1186) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
          %int_tuple_3379 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3380 = cute.size(%int_tuple_3379) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3381 = cute.get_leaves(%sz_3380) : !cute.int_tuple<"1">
          %int_tuple_3382 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3383 = cute.size(%int_tuple_3382) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3384 = cute.get_leaves(%sz_3383) : !cute.int_tuple<"8">
          %coord_3385 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %1187 = cute.memref.load(%rmem_2095, %coord_3385) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">) -> f32
          %1188 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1187 : (f32) -> f32
          %coord_3386 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          cute.memref.store(%rmem_2095, %coord_3386, %1188) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
          %coord_3387 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %1189 = cute.memref.load(%rmem_2095, %coord_3387) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">) -> f32
          %1190 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1189 : (f32) -> f32
          %coord_3388 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          cute.memref.store(%rmem_2095, %coord_3388, %1190) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
          %coord_3389 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %1191 = cute.memref.load(%rmem_2095, %coord_3389) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">) -> f32
          %1192 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1191 : (f32) -> f32
          %coord_3390 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          cute.memref.store(%rmem_2095, %coord_3390, %1192) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
          %coord_3391 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %1193 = cute.memref.load(%rmem_2095, %coord_3391) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">) -> f32
          %1194 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1193 : (f32) -> f32
          %coord_3392 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          cute.memref.store(%rmem_2095, %coord_3392, %1194) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
          %coord_3393 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %1195 = cute.memref.load(%rmem_2095, %coord_3393) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">) -> f32
          %1196 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1195 : (f32) -> f32
          %coord_3394 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          cute.memref.store(%rmem_2095, %coord_3394, %1196) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
          %coord_3395 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %1197 = cute.memref.load(%rmem_2095, %coord_3395) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">) -> f32
          %1198 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1197 : (f32) -> f32
          %coord_3396 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          cute.memref.store(%rmem_2095, %coord_3396, %1198) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
          %coord_3397 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %1199 = cute.memref.load(%rmem_2095, %coord_3397) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">) -> f32
          %1200 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1199 : (f32) -> f32
          %coord_3398 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          cute.memref.store(%rmem_2095, %coord_3398, %1200) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
          %coord_3399 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %1201 = cute.memref.load(%rmem_2095, %coord_3399) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">) -> f32
          %1202 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1201 : (f32) -> f32
          %coord_3400 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          cute.memref.store(%rmem_2095, %coord_3400, %1202) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
          %int_tuple_3401 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3402 = cute.size(%int_tuple_3401) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3403 = cute.get_leaves(%sz_3402) : !cute.int_tuple<"1">
          %int_tuple_3404 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3405 = cute.size(%int_tuple_3404) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3406 = cute.get_leaves(%sz_3405) : !cute.int_tuple<"8">
          %coord_3407 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %1203 = cute.memref.load(%rmem_2095, %coord_3407) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">) -> f32
          %1204 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1203 : (f32) -> f32
          %coord_3408 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          cute.memref.store(%rmem_2095, %coord_3408, %1204) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
          %coord_3409 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %1205 = cute.memref.load(%rmem_2095, %coord_3409) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">) -> f32
          %1206 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1205 : (f32) -> f32
          %coord_3410 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          cute.memref.store(%rmem_2095, %coord_3410, %1206) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
          %coord_3411 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %1207 = cute.memref.load(%rmem_2095, %coord_3411) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">) -> f32
          %1208 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1207 : (f32) -> f32
          %coord_3412 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          cute.memref.store(%rmem_2095, %coord_3412, %1208) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
          %coord_3413 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %1209 = cute.memref.load(%rmem_2095, %coord_3413) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">) -> f32
          %1210 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1209 : (f32) -> f32
          %coord_3414 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          cute.memref.store(%rmem_2095, %coord_3414, %1210) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
          %coord_3415 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %1211 = cute.memref.load(%rmem_2095, %coord_3415) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">) -> f32
          %1212 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1211 : (f32) -> f32
          %coord_3416 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          cute.memref.store(%rmem_2095, %coord_3416, %1212) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
          %coord_3417 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %1213 = cute.memref.load(%rmem_2095, %coord_3417) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">) -> f32
          %1214 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1213 : (f32) -> f32
          %coord_3418 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          cute.memref.store(%rmem_2095, %coord_3418, %1214) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
          %coord_3419 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %1215 = cute.memref.load(%rmem_2095, %coord_3419) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">) -> f32
          %1216 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1215 : (f32) -> f32
          %coord_3420 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          cute.memref.store(%rmem_2095, %coord_3420, %1216) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
          %coord_3421 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %1217 = cute.memref.load(%rmem_2095, %coord_3421) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">) -> f32
          %1218 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1217 : (f32) -> f32
          %coord_3422 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          cute.memref.store(%rmem_2095, %coord_3422, %1218) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
          %1219 = cute.memref.load_vec %rmem_2095 : !memref_rmem_f32_1
          %1220 = arith.mulf %1154, %1219 : vector<32xf32>
          %1221 = arith.addf %1220, %1154 : vector<32xf32>
          %int_tuple_3423 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3424 = cute.size(%int_tuple_3423) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3425 = cute.get_leaves(%sz_3424) : !cute.int_tuple<"32">
          %int_tuple_3426 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3427 = cute.size(%int_tuple_3426) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3428 = cute.get_leaves(%sz_3427) : !cute.int_tuple<"32">
          cute.memref.store_vec %1221, %rmem_2095 : !memref_rmem_f32_1
          %lay_3429 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
          %1222 = cute.get_shape(%lay_3429) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3430, %e1_3431, %e2_3432, %e3_3433 = cute.get_leaves(%1222) : !cute.shape<"((2,2),1,8)">
          %1223 = cute.get_stride(%lay_3429) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3434, %e1_3435, %e2_3436, %e3_3437 = cute.get_leaves(%1223) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2095 : !memref_rmem_f32_1
        } else {
          %iter_3319 = cute.get_iter(%rmem_2095) : !memref_rmem_f32_1
          %lay_3320 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
          %1151 = cute.get_shape(%lay_3320) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3321, %e1_3322, %e2_3323, %e3_3324 = cute.get_leaves(%1151) : !cute.shape<"((2,2),1,8)">
          %1152 = cute.memref.load_vec %rmem_2095 : !memref_rmem_f32_1
          %cst_3325 = arith.constant -1.44269502 : f32
          %1153 = vector.broadcast %cst_3325 : f32 to vector<32xf32>
          %1154 = arith.mulf %1152, %1153 : vector<32xf32>
          %1155 = math.exp2 %1154 fastmath<fast> : vector<32xf32>
          %cst_3326 = arith.constant 1.000000e+00 : f32
          %1156 = vector.broadcast %cst_3326 : f32 to vector<32xf32>
          %1157 = arith.addf %1155, %1156 : vector<32xf32>
          %1158 = arith.divf %1152, %1157 : vector<32xf32>
          %int_tuple_3327 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3328 = cute.size(%int_tuple_3327) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3329 = cute.get_leaves(%sz_3328) : !cute.int_tuple<"32">
          %int_tuple_3330 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3331 = cute.size(%int_tuple_3330) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3332 = cute.get_leaves(%sz_3331) : !cute.int_tuple<"32">
          cute.memref.store_vec %1158, %rmem_2095 : !memref_rmem_f32_1
          %lay_3333 = cute.get_layout(%rmem_2095) : !memref_rmem_f32_1
          %1159 = cute.get_shape(%lay_3333) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3334, %e1_3335, %e2_3336, %e3_3337 = cute.get_leaves(%1159) : !cute.shape<"((2,2),1,8)">
          %1160 = cute.get_stride(%lay_3333) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3338, %e1_3339, %e2_3340, %e3_3341 = cute.get_leaves(%1160) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2095 : !memref_rmem_f32_1
        }
        %iter_2754 = cute.get_iter(%1014) : !memref_rmem_f32_1
        %lay_2755 = cute.get_layout(%1014) : !memref_rmem_f32_1
        %1015 = cute.get_shape(%lay_2755) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2756, %e1_2757, %e2_2758, %e3_2759 = cute.get_leaves(%1015) : !cute.shape<"((2,2),1,8)">
        %1016 = cute.get_stride(%lay_2755) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2760, %e1_2761, %e2_2762, %e3_2763 = cute.get_leaves(%1016) : !cute.stride<"((1,2),0,4)">
        %iter_2764 = cute.get_iter(%1014) : !memref_rmem_f32_1
        %iter_2765 = cute.get_iter(%1014) : !memref_rmem_f32_1
        %lay_2766 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1017 = cute.get_shape(%lay_2766) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_2767, %e1_2768, %e2_2769, %e3_2770 = cute.get_leaves(%1017) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_2771 = cute.to_int_tuple(%e0_2767) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1018 = cute.get_scalars(%itup_2771) : !cute.int_tuple<"?">
        %itup_2772 = cute.to_int_tuple(%e1_2768) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1019 = cute.get_scalars(%itup_2772) : !cute.int_tuple<"?">
        %itup_2773 = cute.to_int_tuple(%e2_2769) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1020 = cute.get_scalars(%itup_2773) : !cute.int_tuple<"?">
        %itup_2774 = cute.to_int_tuple(%e3_2770) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1021 = cute.get_scalars(%itup_2774) : !cute.int_tuple<"?{div=8}">
        %lay_2775 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1022 = cute.get_shape(%lay_2775) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_2776, %e1_2777, %e2_2778, %e3_2779 = cute.get_leaves(%1022) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_2780 = cute.to_int_tuple(%e0_2776) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1023 = cute.get_scalars(%itup_2780) : !cute.int_tuple<"?">
        %itup_2781 = cute.to_int_tuple(%e1_2777) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1024 = cute.get_scalars(%itup_2781) : !cute.int_tuple<"?">
        %itup_2782 = cute.to_int_tuple(%e2_2778) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1025 = cute.get_scalars(%itup_2782) : !cute.int_tuple<"?">
        %itup_2783 = cute.to_int_tuple(%e3_2779) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1026 = cute.get_scalars(%itup_2783) : !cute.int_tuple<"?{div=8}">
        %shape_2784 = cute.make_shape(%itup_2773, %itup_2783) : (!cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?{div=8})">
        %1027 = cute.make_identity_tensor(%shape_2784) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_2785 = cute.get_iter(%1027) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_2786, %e1_2787 = cute.get_leaves(%iter_2785) : !cute.int_tuple<"(0,0)">
        %coord_2788 = cute.make_coord() : () -> !cute.coord<"(_,_)">
        %lay_2789 = cute.get_layout(%1027) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %slice_2790 = cute.slice(%lay_2789, %coord_2788) : !cute.layout<"(?,?{div=8}):(1@0,1@1)">, !cute.coord<"(_,_)">
        %int_tuple_2791 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0)">
        %view_2792 = cute.make_view(%int_tuple_2791, %slice_2790) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_2793 = cute.get_iter(%view_2792) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_2794, %e1_2795 = cute.get_leaves(%iter_2793) : !cute.int_tuple<"(0,0)">
        %iter_2796 = cute.get_iter(%view_2792) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_2797, %e1_2798 = cute.get_leaves(%iter_2796) : !cute.int_tuple<"(0,0)">
        %tile_2799 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
        %coord_2800 = cute.make_coord(%sub_223, %sub_2085) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.coord<"(?,?)">
        %1028:2 = cute.get_scalars(%coord_2800) <{only_dynamic}> : !cute.coord<"(?,?)">
        %coord_2801 = cute.make_coord(%1028#0, %1028#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
        %lay_2802 = cute.get_layout(%view_2792) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %1029:2 = cute.get_scalars(%lay_2802) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %c64_i32_2803 = arith.constant 64 : i32
        %1030 = arith.ceildivsi %1029#0, %c64_i32_2803 : i32
        %c64_i32_2804 = arith.constant 64 : i32
        %1031 = arith.ceildivsi %1029#1, %c64_i32_2804 : i32
        %shape_2805 = cute.make_shape(%1030, %1031) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
        %stride_2806 = cute.make_stride() : () -> !cute.stride<"((1@0,1@1),(64@0,64@1))">
        %lay_2807 = cute.make_layout(%shape_2805, %stride_2806) : !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">
        %idx_2808 = cute.crd2idx(%coord_2801, %lay_2807) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %iter_2809 = cute.get_iter(%view_2792) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %tup_2810 = cute.add_offset(%iter_2809, %idx_2808) : (!cute.int_tuple<"(0,0)">, !cute.int_tuple<"(?{div=64},?{div=64})">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %view_2811 = cute.make_view(%tup_2810) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %iter_2812 = cute.get_iter(%view_2811) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %e0_2813, %e1_2814 = cute.get_leaves(%iter_2812) : !cute.int_tuple<"(?{div=64},?{div=64})">
        %1032 = cute.get_scalars(%e0_2813) : !cute.int_tuple<"?{div=64}">
        %1033 = cute.get_scalars(%e1_2814) : !cute.int_tuple<"?{div=64}">
        %lay_2815 = cute.get_layout(%1014) : !memref_rmem_f32_1
        %1034 = cute.get_shape(%lay_2815) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2816, %e1_2817, %e2_2818, %e3_2819 = cute.get_leaves(%1034) : !cute.shape<"((2,2),1,8)">
        %1035 = cute.get_stride(%lay_2815) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2820, %e1_2821, %e2_2822, %e3_2823 = cute.get_leaves(%1035) : !cute.stride<"((1,2),0,4)">
        %1036 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1037 = cute.get_shape(%1036) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_2824, %e1_2825, %e2_2826, %e3_2827 = cute.get_leaves(%1037) : !cute.shape<"(32,4,1,1)">
        %1038 = cute.get_stride(%1036) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_2828, %e1_2829, %e2_2830, %e3_2831 = cute.get_leaves(%1038) : !cute.stride<"(1,32,0,0)">
        %1039 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_2832, %e1_2833, %e2_2834 = cute.get_leaves(%1039) : !cute.tile<"[64:1;16:1;16:1]">
        %1040 = cute.get_shape(%e0_2832) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_2835 = cute.get_leaves(%1040) : !cute.shape<"64">
        %1041 = cute.get_stride(%e0_2832) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_2836 = cute.get_leaves(%1041) : !cute.stride<"1">
        %1042 = cute.get_shape(%e1_2833) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_2837 = cute.get_leaves(%1042) : !cute.shape<"16">
        %1043 = cute.get_stride(%e1_2833) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_2838 = cute.get_leaves(%1043) : !cute.stride<"1">
        %1044 = cute.get_shape(%e2_2834) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_2839 = cute.get_leaves(%1044) : !cute.shape<"16">
        %1045 = cute.get_stride(%e2_2834) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_2840 = cute.get_leaves(%1045) : !cute.stride<"1">
        %1046 = cute.static : !cute.layout<"32:1">
        %1047 = cute.get_shape(%1046) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_2841 = cute.get_leaves(%1047) : !cute.shape<"32">
        %1048 = cute.get_stride(%1046) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_2842 = cute.get_leaves(%1048) : !cute.stride<"1">
        %1049 = cute.static : !cute.shape<"(16,8,16)">
        %e0_2843, %e1_2844, %e2_2845 = cute.get_leaves(%1049) : !cute.shape<"(16,8,16)">
        %1050 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1051 = cute.get_shape(%1050) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_2846, %e1_2847, %e2_2848, %e3_2849, %e4_2850 = cute.get_leaves(%1051) : !cute.shape<"((4,8),(2,2,2))">
        %1052 = cute.get_stride(%1050) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_2851, %e1_2852, %e2_2853, %e3_2854, %e4_2855 = cute.get_leaves(%1052) : !cute.stride<"((32,1),(16,8,128))">
        %1053 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1054 = cute.get_shape(%1053) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_2856, %e1_2857, %e2_2858, %e3_2859 = cute.get_leaves(%1054) : !cute.shape<"((4,8),(2,2))">
        %1055 = cute.get_stride(%1053) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_2860, %e1_2861, %e2_2862, %e3_2863 = cute.get_leaves(%1055) : !cute.stride<"((16,1),(8,64))">
        %1056 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1057 = cute.get_shape(%1056) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_2864, %e1_2865, %e2_2866, %e3_2867 = cute.get_leaves(%1057) : !cute.shape<"((4,8),(2,2))">
        %1058 = cute.get_stride(%1056) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_2868, %e1_2869, %e2_2870, %e3_2871 = cute.get_leaves(%1058) : !cute.stride<"((32,1),(16,8))">
        %1059:2 = scf.if %false -> (!memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_) {
          %iter_3319 = cute.get_iter(%1014) : !memref_rmem_f32_1
          %coord_3320 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
          %ptn_C = cute.tiled.mma.partition C (%arg6, %view_2811, %coord_3320) : (!mma_bf16_bf16_f32_16x8x16_, !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %iter_3321 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %e0_3322, %e1_3323 = cute.get_leaves(%iter_3321) : !cute.int_tuple<"(?,?{div=2})">
          %1151 = cute.get_scalars(%e0_3322) : !cute.int_tuple<"?">
          %1152 = cute.get_scalars(%e1_3323) : !cute.int_tuple<"?{div=2}">
          %lay_3324 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %1153 = cute.get_shape(%lay_3324) : (!cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3325, %e1_3326, %e2_3327, %e3_3328 = cute.get_leaves(%1153) : !cute.shape<"((2,2),1,8)">
          %int_tuple_3329 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_3330 = cute.size(%int_tuple_3329) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_3331 = cute.get_leaves(%sz_3330) : !cute.int_tuple<"4">
          %int_tuple_3332 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3333 = cute.size(%int_tuple_3332) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3334 = cute.get_leaves(%sz_3333) : !cute.int_tuple<"1">
          %int_tuple_3335 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3336 = cute.size(%int_tuple_3335) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3337 = cute.get_leaves(%sz_3336) : !cute.int_tuple<"8">
          %coord_3338 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3339 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3340 = cute.crd2idx(%coord_3338, %lay_3339) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_3341 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3342 = cute.add_offset(%iter_3341, %idx_3340) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3343 = cute.make_view(%tup_3342) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3344 = cute.get_iter(%view_3343) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3345, %e1_3346 = cute.get_leaves(%iter_3344) : !cute.int_tuple<"(?,?{div=2})">
          %1154 = cute.get_scalars(%e0_3345) : !cute.int_tuple<"?">
          %1155 = cute.get_scalars(%e1_3346) : !cute.int_tuple<"?{div=2}">
          %iter_3347 = cute.get_iter(%view_3343) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3348, %e1_3349 = cute.get_leaves(%iter_3347) : !cute.int_tuple<"(?,?{div=2})">
          %1156 = cute.get_scalars(%e0_3348) : !cute.int_tuple<"?">
          %1157 = cute.get_scalars(%e1_3349) : !cute.int_tuple<"?{div=2}">
          %iter_3350 = cute.get_iter(%view_3343) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3351, %e1_3352 = cute.get_leaves(%iter_3350) : !cute.int_tuple<"(?,?{div=2})">
          %1158 = cute.get_scalars(%e0_3351) : !cute.int_tuple<"?">
          %1159 = cute.get_scalars(%e1_3352) : !cute.int_tuple<"?{div=2}">
          %coord_3353 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3354 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3355 = cute.crd2idx(%coord_3353, %lay_3354) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_3356 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3357 = cute.add_offset(%iter_3356, %idx_3355) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3358 = cute.make_view(%tup_3357) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3359 = cute.get_iter(%view_3358) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3360, %e1_3361 = cute.get_leaves(%iter_3359) : !cute.int_tuple<"(?,?{div=2})">
          %1160 = cute.get_scalars(%e0_3360) : !cute.int_tuple<"?">
          %1161 = cute.get_scalars(%e1_3361) : !cute.int_tuple<"?{div=2}">
          %iter_3362 = cute.get_iter(%view_3358) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3363, %e1_3364 = cute.get_leaves(%iter_3362) : !cute.int_tuple<"(?,?{div=2})">
          %1162 = cute.get_scalars(%e0_3363) : !cute.int_tuple<"?">
          %1163 = cute.get_scalars(%e1_3364) : !cute.int_tuple<"?{div=2}">
          %iter_3365 = cute.get_iter(%view_3358) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3366, %e1_3367 = cute.get_leaves(%iter_3365) : !cute.int_tuple<"(?,?{div=2})">
          %1164 = cute.get_scalars(%e0_3366) : !cute.int_tuple<"?">
          %1165 = cute.get_scalars(%e1_3367) : !cute.int_tuple<"?{div=2}">
          %coord_3368 = cute.make_coord(%e0_3351) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3369 = cute.make_coord(%e1_3367) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1166 = cute.elem_less(%coord_3368, %coord_3369) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3370 = cute.get_layout(%1014) : !memref_rmem_f32_1
          %1167 = cute.get_shape(%lay_3370) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3371, %e1_3372, %e2_3373, %e3_3374 = cute.get_leaves(%1167) : !cute.shape<"((2,2),1,8)">
          %1168 = cute.get_stride(%lay_3370) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3375, %e1_3376, %e2_3377, %e3_3378 = cute.get_leaves(%1168) : !cute.stride<"((1,2),0,4)">
          %1169 = scf.if %1166 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1014) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
            cute.memref.store(%1014, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1014) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1014 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1014) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1014) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1014 : !memref_rmem_f32_1
          }
          %iter_3379 = cute.get_iter(%1169) : !memref_rmem_f32_1
          %lay_3380 = cute.get_layout(%1169) : !memref_rmem_f32_1
          %1170 = cute.get_shape(%lay_3380) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3381, %e1_3382, %e2_3383, %e3_3384 = cute.get_leaves(%1170) : !cute.shape<"((2,2),1,8)">
          %1171 = cute.get_stride(%lay_3380) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3385, %e1_3386, %e2_3387, %e3_3388 = cute.get_leaves(%1171) : !cute.stride<"((1,2),0,4)">
          %iter_3389 = cute.get_iter(%1169) : !memref_rmem_f32_1
          %iter_3390 = cute.get_iter(%1169) : !memref_rmem_f32_1
          %coord_3391 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_3392 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3393 = cute.crd2idx(%coord_3391, %lay_3392) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_3394 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3395 = cute.add_offset(%iter_3394, %idx_3393) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3396 = cute.make_view(%tup_3395) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3397 = cute.get_iter(%view_3396) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3398, %e1_3399 = cute.get_leaves(%iter_3397) : !cute.int_tuple<"(?,?{div=2})">
          %1172 = cute.get_scalars(%e0_3398) : !cute.int_tuple<"?">
          %1173 = cute.get_scalars(%e1_3399) : !cute.int_tuple<"?{div=2}">
          %iter_3400 = cute.get_iter(%view_3396) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3401, %e1_3402 = cute.get_leaves(%iter_3400) : !cute.int_tuple<"(?,?{div=2})">
          %1174 = cute.get_scalars(%e0_3401) : !cute.int_tuple<"?">
          %1175 = cute.get_scalars(%e1_3402) : !cute.int_tuple<"?{div=2}">
          %iter_3403 = cute.get_iter(%view_3396) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3404, %e1_3405 = cute.get_leaves(%iter_3403) : !cute.int_tuple<"(?,?{div=2})">
          %1176 = cute.get_scalars(%e0_3404) : !cute.int_tuple<"?">
          %1177 = cute.get_scalars(%e1_3405) : !cute.int_tuple<"?{div=2}">
          %coord_3406 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_3407 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3408 = cute.crd2idx(%coord_3406, %lay_3407) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_3409 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3410 = cute.add_offset(%iter_3409, %idx_3408) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3411 = cute.make_view(%tup_3410) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3412 = cute.get_iter(%view_3411) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3413, %e1_3414 = cute.get_leaves(%iter_3412) : !cute.int_tuple<"(?,?{div=2})">
          %1178 = cute.get_scalars(%e0_3413) : !cute.int_tuple<"?">
          %1179 = cute.get_scalars(%e1_3414) : !cute.int_tuple<"?{div=2}">
          %iter_3415 = cute.get_iter(%view_3411) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3416, %e1_3417 = cute.get_leaves(%iter_3415) : !cute.int_tuple<"(?,?{div=2})">
          %1180 = cute.get_scalars(%e0_3416) : !cute.int_tuple<"?">
          %1181 = cute.get_scalars(%e1_3417) : !cute.int_tuple<"?{div=2}">
          %iter_3418 = cute.get_iter(%view_3411) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3419, %e1_3420 = cute.get_leaves(%iter_3418) : !cute.int_tuple<"(?,?{div=2})">
          %1182 = cute.get_scalars(%e0_3419) : !cute.int_tuple<"?">
          %1183 = cute.get_scalars(%e1_3420) : !cute.int_tuple<"?{div=2}">
          %coord_3421 = cute.make_coord(%e0_3404) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3422 = cute.make_coord(%e1_3420) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1184 = cute.elem_less(%coord_3421, %coord_3422) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3423 = cute.get_layout(%1169) : !memref_rmem_f32_1
          %1185 = cute.get_shape(%lay_3423) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3424, %e1_3425, %e2_3426, %e3_3427 = cute.get_leaves(%1185) : !cute.shape<"((2,2),1,8)">
          %1186 = cute.get_stride(%lay_3423) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3428, %e1_3429, %e2_3430, %e3_3431 = cute.get_leaves(%1186) : !cute.stride<"((1,2),0,4)">
          %1187 = scf.if %1184 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1169) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
            cute.memref.store(%1169, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1169) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1169 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1169) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1169) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1169 : !memref_rmem_f32_1
          }
          %iter_3432 = cute.get_iter(%1187) : !memref_rmem_f32_1
          %lay_3433 = cute.get_layout(%1187) : !memref_rmem_f32_1
          %1188 = cute.get_shape(%lay_3433) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3434, %e1_3435, %e2_3436, %e3_3437 = cute.get_leaves(%1188) : !cute.shape<"((2,2),1,8)">
          %1189 = cute.get_stride(%lay_3433) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3438, %e1_3439, %e2_3440, %e3_3441 = cute.get_leaves(%1189) : !cute.stride<"((1,2),0,4)">
          %iter_3442 = cute.get_iter(%1187) : !memref_rmem_f32_1
          %iter_3443 = cute.get_iter(%1187) : !memref_rmem_f32_1
          %coord_3444 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_3445 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3446 = cute.crd2idx(%coord_3444, %lay_3445) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_3447 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3448 = cute.add_offset(%iter_3447, %idx_3446) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3449 = cute.make_view(%tup_3448) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3450 = cute.get_iter(%view_3449) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3451, %e1_3452 = cute.get_leaves(%iter_3450) : !cute.int_tuple<"(?,?{div=2})">
          %1190 = cute.get_scalars(%e0_3451) : !cute.int_tuple<"?">
          %1191 = cute.get_scalars(%e1_3452) : !cute.int_tuple<"?{div=2}">
          %iter_3453 = cute.get_iter(%view_3449) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3454, %e1_3455 = cute.get_leaves(%iter_3453) : !cute.int_tuple<"(?,?{div=2})">
          %1192 = cute.get_scalars(%e0_3454) : !cute.int_tuple<"?">
          %1193 = cute.get_scalars(%e1_3455) : !cute.int_tuple<"?{div=2}">
          %iter_3456 = cute.get_iter(%view_3449) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3457, %e1_3458 = cute.get_leaves(%iter_3456) : !cute.int_tuple<"(?,?{div=2})">
          %1194 = cute.get_scalars(%e0_3457) : !cute.int_tuple<"?">
          %1195 = cute.get_scalars(%e1_3458) : !cute.int_tuple<"?{div=2}">
          %coord_3459 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_3460 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3461 = cute.crd2idx(%coord_3459, %lay_3460) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_3462 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3463 = cute.add_offset(%iter_3462, %idx_3461) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3464 = cute.make_view(%tup_3463) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3465 = cute.get_iter(%view_3464) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3466, %e1_3467 = cute.get_leaves(%iter_3465) : !cute.int_tuple<"(?,?{div=2})">
          %1196 = cute.get_scalars(%e0_3466) : !cute.int_tuple<"?">
          %1197 = cute.get_scalars(%e1_3467) : !cute.int_tuple<"?{div=2}">
          %iter_3468 = cute.get_iter(%view_3464) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3469, %e1_3470 = cute.get_leaves(%iter_3468) : !cute.int_tuple<"(?,?{div=2})">
          %1198 = cute.get_scalars(%e0_3469) : !cute.int_tuple<"?">
          %1199 = cute.get_scalars(%e1_3470) : !cute.int_tuple<"?{div=2}">
          %iter_3471 = cute.get_iter(%view_3464) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3472, %e1_3473 = cute.get_leaves(%iter_3471) : !cute.int_tuple<"(?,?{div=2})">
          %1200 = cute.get_scalars(%e0_3472) : !cute.int_tuple<"?">
          %1201 = cute.get_scalars(%e1_3473) : !cute.int_tuple<"?{div=2}">
          %coord_3474 = cute.make_coord(%e0_3457) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3475 = cute.make_coord(%e1_3473) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1202 = cute.elem_less(%coord_3474, %coord_3475) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3476 = cute.get_layout(%1187) : !memref_rmem_f32_1
          %1203 = cute.get_shape(%lay_3476) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3477, %e1_3478, %e2_3479, %e3_3480 = cute.get_leaves(%1203) : !cute.shape<"((2,2),1,8)">
          %1204 = cute.get_stride(%lay_3476) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3481, %e1_3482, %e2_3483, %e3_3484 = cute.get_leaves(%1204) : !cute.stride<"((1,2),0,4)">
          %1205 = scf.if %1202 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1187) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
            cute.memref.store(%1187, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1187) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1187 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1187) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1187) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1187 : !memref_rmem_f32_1
          }
          %iter_3485 = cute.get_iter(%1205) : !memref_rmem_f32_1
          %lay_3486 = cute.get_layout(%1205) : !memref_rmem_f32_1
          %1206 = cute.get_shape(%lay_3486) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3487, %e1_3488, %e2_3489, %e3_3490 = cute.get_leaves(%1206) : !cute.shape<"((2,2),1,8)">
          %1207 = cute.get_stride(%lay_3486) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3491, %e1_3492, %e2_3493, %e3_3494 = cute.get_leaves(%1207) : !cute.stride<"((1,2),0,4)">
          %iter_3495 = cute.get_iter(%1205) : !memref_rmem_f32_1
          %iter_3496 = cute.get_iter(%1205) : !memref_rmem_f32_1
          %coord_3497 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_3498 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3499 = cute.crd2idx(%coord_3497, %lay_3498) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_3500 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3501 = cute.add_offset(%iter_3500, %idx_3499) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3502 = cute.make_view(%tup_3501) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3503 = cute.get_iter(%view_3502) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3504, %e1_3505 = cute.get_leaves(%iter_3503) : !cute.int_tuple<"(?,?{div=2})">
          %1208 = cute.get_scalars(%e0_3504) : !cute.int_tuple<"?">
          %1209 = cute.get_scalars(%e1_3505) : !cute.int_tuple<"?{div=2}">
          %iter_3506 = cute.get_iter(%view_3502) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3507, %e1_3508 = cute.get_leaves(%iter_3506) : !cute.int_tuple<"(?,?{div=2})">
          %1210 = cute.get_scalars(%e0_3507) : !cute.int_tuple<"?">
          %1211 = cute.get_scalars(%e1_3508) : !cute.int_tuple<"?{div=2}">
          %iter_3509 = cute.get_iter(%view_3502) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3510, %e1_3511 = cute.get_leaves(%iter_3509) : !cute.int_tuple<"(?,?{div=2})">
          %1212 = cute.get_scalars(%e0_3510) : !cute.int_tuple<"?">
          %1213 = cute.get_scalars(%e1_3511) : !cute.int_tuple<"?{div=2}">
          %coord_3512 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_3513 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3514 = cute.crd2idx(%coord_3512, %lay_3513) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_3515 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3516 = cute.add_offset(%iter_3515, %idx_3514) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3517 = cute.make_view(%tup_3516) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3518 = cute.get_iter(%view_3517) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3519, %e1_3520 = cute.get_leaves(%iter_3518) : !cute.int_tuple<"(?,?{div=2})">
          %1214 = cute.get_scalars(%e0_3519) : !cute.int_tuple<"?">
          %1215 = cute.get_scalars(%e1_3520) : !cute.int_tuple<"?{div=2}">
          %iter_3521 = cute.get_iter(%view_3517) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3522, %e1_3523 = cute.get_leaves(%iter_3521) : !cute.int_tuple<"(?,?{div=2})">
          %1216 = cute.get_scalars(%e0_3522) : !cute.int_tuple<"?">
          %1217 = cute.get_scalars(%e1_3523) : !cute.int_tuple<"?{div=2}">
          %iter_3524 = cute.get_iter(%view_3517) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3525, %e1_3526 = cute.get_leaves(%iter_3524) : !cute.int_tuple<"(?,?{div=2})">
          %1218 = cute.get_scalars(%e0_3525) : !cute.int_tuple<"?">
          %1219 = cute.get_scalars(%e1_3526) : !cute.int_tuple<"?{div=2}">
          %coord_3527 = cute.make_coord(%e0_3510) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3528 = cute.make_coord(%e1_3526) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1220 = cute.elem_less(%coord_3527, %coord_3528) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3529 = cute.get_layout(%1205) : !memref_rmem_f32_1
          %1221 = cute.get_shape(%lay_3529) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3530, %e1_3531, %e2_3532, %e3_3533 = cute.get_leaves(%1221) : !cute.shape<"((2,2),1,8)">
          %1222 = cute.get_stride(%lay_3529) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3534, %e1_3535, %e2_3536, %e3_3537 = cute.get_leaves(%1222) : !cute.stride<"((1,2),0,4)">
          %1223 = scf.if %1220 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1205) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
            cute.memref.store(%1205, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1205) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1205 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1205) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1205) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1205 : !memref_rmem_f32_1
          }
          %iter_3538 = cute.get_iter(%1223) : !memref_rmem_f32_1
          %lay_3539 = cute.get_layout(%1223) : !memref_rmem_f32_1
          %1224 = cute.get_shape(%lay_3539) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3540, %e1_3541, %e2_3542, %e3_3543 = cute.get_leaves(%1224) : !cute.shape<"((2,2),1,8)">
          %1225 = cute.get_stride(%lay_3539) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3544, %e1_3545, %e2_3546, %e3_3547 = cute.get_leaves(%1225) : !cute.stride<"((1,2),0,4)">
          %iter_3548 = cute.get_iter(%1223) : !memref_rmem_f32_1
          %iter_3549 = cute.get_iter(%1223) : !memref_rmem_f32_1
          %coord_3550 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_3551 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3552 = cute.crd2idx(%coord_3550, %lay_3551) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_3553 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3554 = cute.add_offset(%iter_3553, %idx_3552) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3555 = cute.make_view(%tup_3554) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3556 = cute.get_iter(%view_3555) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3557, %e1_3558 = cute.get_leaves(%iter_3556) : !cute.int_tuple<"(?,?{div=2})">
          %1226 = cute.get_scalars(%e0_3557) : !cute.int_tuple<"?">
          %1227 = cute.get_scalars(%e1_3558) : !cute.int_tuple<"?{div=2}">
          %iter_3559 = cute.get_iter(%view_3555) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3560, %e1_3561 = cute.get_leaves(%iter_3559) : !cute.int_tuple<"(?,?{div=2})">
          %1228 = cute.get_scalars(%e0_3560) : !cute.int_tuple<"?">
          %1229 = cute.get_scalars(%e1_3561) : !cute.int_tuple<"?{div=2}">
          %iter_3562 = cute.get_iter(%view_3555) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3563, %e1_3564 = cute.get_leaves(%iter_3562) : !cute.int_tuple<"(?,?{div=2})">
          %1230 = cute.get_scalars(%e0_3563) : !cute.int_tuple<"?">
          %1231 = cute.get_scalars(%e1_3564) : !cute.int_tuple<"?{div=2}">
          %coord_3565 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_3566 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3567 = cute.crd2idx(%coord_3565, %lay_3566) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_3568 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3569 = cute.add_offset(%iter_3568, %idx_3567) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3570 = cute.make_view(%tup_3569) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3571 = cute.get_iter(%view_3570) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3572, %e1_3573 = cute.get_leaves(%iter_3571) : !cute.int_tuple<"(?,?{div=2})">
          %1232 = cute.get_scalars(%e0_3572) : !cute.int_tuple<"?">
          %1233 = cute.get_scalars(%e1_3573) : !cute.int_tuple<"?{div=2}">
          %iter_3574 = cute.get_iter(%view_3570) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3575, %e1_3576 = cute.get_leaves(%iter_3574) : !cute.int_tuple<"(?,?{div=2})">
          %1234 = cute.get_scalars(%e0_3575) : !cute.int_tuple<"?">
          %1235 = cute.get_scalars(%e1_3576) : !cute.int_tuple<"?{div=2}">
          %iter_3577 = cute.get_iter(%view_3570) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3578, %e1_3579 = cute.get_leaves(%iter_3577) : !cute.int_tuple<"(?,?{div=2})">
          %1236 = cute.get_scalars(%e0_3578) : !cute.int_tuple<"?">
          %1237 = cute.get_scalars(%e1_3579) : !cute.int_tuple<"?{div=2}">
          %coord_3580 = cute.make_coord(%e0_3563) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3581 = cute.make_coord(%e1_3579) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1238 = cute.elem_less(%coord_3580, %coord_3581) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3582 = cute.get_layout(%1223) : !memref_rmem_f32_1
          %1239 = cute.get_shape(%lay_3582) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3583, %e1_3584, %e2_3585, %e3_3586 = cute.get_leaves(%1239) : !cute.shape<"((2,2),1,8)">
          %1240 = cute.get_stride(%lay_3582) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3587, %e1_3588, %e2_3589, %e3_3590 = cute.get_leaves(%1240) : !cute.stride<"((1,2),0,4)">
          %1241 = scf.if %1238 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1223) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
            cute.memref.store(%1223, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1223) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1223 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1223) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1223) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1223 : !memref_rmem_f32_1
          }
          %iter_3591 = cute.get_iter(%1241) : !memref_rmem_f32_1
          %lay_3592 = cute.get_layout(%1241) : !memref_rmem_f32_1
          %1242 = cute.get_shape(%lay_3592) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3593, %e1_3594, %e2_3595, %e3_3596 = cute.get_leaves(%1242) : !cute.shape<"((2,2),1,8)">
          %1243 = cute.get_stride(%lay_3592) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3597, %e1_3598, %e2_3599, %e3_3600 = cute.get_leaves(%1243) : !cute.stride<"((1,2),0,4)">
          %iter_3601 = cute.get_iter(%1241) : !memref_rmem_f32_1
          %iter_3602 = cute.get_iter(%1241) : !memref_rmem_f32_1
          %coord_3603 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_3604 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3605 = cute.crd2idx(%coord_3603, %lay_3604) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_3606 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3607 = cute.add_offset(%iter_3606, %idx_3605) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3608 = cute.make_view(%tup_3607) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3609 = cute.get_iter(%view_3608) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3610, %e1_3611 = cute.get_leaves(%iter_3609) : !cute.int_tuple<"(?,?{div=2})">
          %1244 = cute.get_scalars(%e0_3610) : !cute.int_tuple<"?">
          %1245 = cute.get_scalars(%e1_3611) : !cute.int_tuple<"?{div=2}">
          %iter_3612 = cute.get_iter(%view_3608) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3613, %e1_3614 = cute.get_leaves(%iter_3612) : !cute.int_tuple<"(?,?{div=2})">
          %1246 = cute.get_scalars(%e0_3613) : !cute.int_tuple<"?">
          %1247 = cute.get_scalars(%e1_3614) : !cute.int_tuple<"?{div=2}">
          %iter_3615 = cute.get_iter(%view_3608) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3616, %e1_3617 = cute.get_leaves(%iter_3615) : !cute.int_tuple<"(?,?{div=2})">
          %1248 = cute.get_scalars(%e0_3616) : !cute.int_tuple<"?">
          %1249 = cute.get_scalars(%e1_3617) : !cute.int_tuple<"?{div=2}">
          %coord_3618 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_3619 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3620 = cute.crd2idx(%coord_3618, %lay_3619) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_3621 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3622 = cute.add_offset(%iter_3621, %idx_3620) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3623 = cute.make_view(%tup_3622) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3624 = cute.get_iter(%view_3623) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3625, %e1_3626 = cute.get_leaves(%iter_3624) : !cute.int_tuple<"(?,?{div=2})">
          %1250 = cute.get_scalars(%e0_3625) : !cute.int_tuple<"?">
          %1251 = cute.get_scalars(%e1_3626) : !cute.int_tuple<"?{div=2}">
          %iter_3627 = cute.get_iter(%view_3623) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3628, %e1_3629 = cute.get_leaves(%iter_3627) : !cute.int_tuple<"(?,?{div=2})">
          %1252 = cute.get_scalars(%e0_3628) : !cute.int_tuple<"?">
          %1253 = cute.get_scalars(%e1_3629) : !cute.int_tuple<"?{div=2}">
          %iter_3630 = cute.get_iter(%view_3623) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3631, %e1_3632 = cute.get_leaves(%iter_3630) : !cute.int_tuple<"(?,?{div=2})">
          %1254 = cute.get_scalars(%e0_3631) : !cute.int_tuple<"?">
          %1255 = cute.get_scalars(%e1_3632) : !cute.int_tuple<"?{div=2}">
          %coord_3633 = cute.make_coord(%e0_3616) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3634 = cute.make_coord(%e1_3632) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1256 = cute.elem_less(%coord_3633, %coord_3634) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3635 = cute.get_layout(%1241) : !memref_rmem_f32_1
          %1257 = cute.get_shape(%lay_3635) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3636, %e1_3637, %e2_3638, %e3_3639 = cute.get_leaves(%1257) : !cute.shape<"((2,2),1,8)">
          %1258 = cute.get_stride(%lay_3635) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3640, %e1_3641, %e2_3642, %e3_3643 = cute.get_leaves(%1258) : !cute.stride<"((1,2),0,4)">
          %1259 = scf.if %1256 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1241) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
            cute.memref.store(%1241, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1241) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1241 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1241) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1241) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1241 : !memref_rmem_f32_1
          }
          %iter_3644 = cute.get_iter(%1259) : !memref_rmem_f32_1
          %lay_3645 = cute.get_layout(%1259) : !memref_rmem_f32_1
          %1260 = cute.get_shape(%lay_3645) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3646, %e1_3647, %e2_3648, %e3_3649 = cute.get_leaves(%1260) : !cute.shape<"((2,2),1,8)">
          %1261 = cute.get_stride(%lay_3645) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3650, %e1_3651, %e2_3652, %e3_3653 = cute.get_leaves(%1261) : !cute.stride<"((1,2),0,4)">
          %iter_3654 = cute.get_iter(%1259) : !memref_rmem_f32_1
          %iter_3655 = cute.get_iter(%1259) : !memref_rmem_f32_1
          %coord_3656 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_3657 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3658 = cute.crd2idx(%coord_3656, %lay_3657) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_3659 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3660 = cute.add_offset(%iter_3659, %idx_3658) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3661 = cute.make_view(%tup_3660) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3662 = cute.get_iter(%view_3661) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3663, %e1_3664 = cute.get_leaves(%iter_3662) : !cute.int_tuple<"(?,?{div=2})">
          %1262 = cute.get_scalars(%e0_3663) : !cute.int_tuple<"?">
          %1263 = cute.get_scalars(%e1_3664) : !cute.int_tuple<"?{div=2}">
          %iter_3665 = cute.get_iter(%view_3661) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3666, %e1_3667 = cute.get_leaves(%iter_3665) : !cute.int_tuple<"(?,?{div=2})">
          %1264 = cute.get_scalars(%e0_3666) : !cute.int_tuple<"?">
          %1265 = cute.get_scalars(%e1_3667) : !cute.int_tuple<"?{div=2}">
          %iter_3668 = cute.get_iter(%view_3661) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3669, %e1_3670 = cute.get_leaves(%iter_3668) : !cute.int_tuple<"(?,?{div=2})">
          %1266 = cute.get_scalars(%e0_3669) : !cute.int_tuple<"?">
          %1267 = cute.get_scalars(%e1_3670) : !cute.int_tuple<"?{div=2}">
          %coord_3671 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_3672 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3673 = cute.crd2idx(%coord_3671, %lay_3672) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_3674 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3675 = cute.add_offset(%iter_3674, %idx_3673) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3676 = cute.make_view(%tup_3675) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3677 = cute.get_iter(%view_3676) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3678, %e1_3679 = cute.get_leaves(%iter_3677) : !cute.int_tuple<"(?,?{div=2})">
          %1268 = cute.get_scalars(%e0_3678) : !cute.int_tuple<"?">
          %1269 = cute.get_scalars(%e1_3679) : !cute.int_tuple<"?{div=2}">
          %iter_3680 = cute.get_iter(%view_3676) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3681, %e1_3682 = cute.get_leaves(%iter_3680) : !cute.int_tuple<"(?,?{div=2})">
          %1270 = cute.get_scalars(%e0_3681) : !cute.int_tuple<"?">
          %1271 = cute.get_scalars(%e1_3682) : !cute.int_tuple<"?{div=2}">
          %iter_3683 = cute.get_iter(%view_3676) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3684, %e1_3685 = cute.get_leaves(%iter_3683) : !cute.int_tuple<"(?,?{div=2})">
          %1272 = cute.get_scalars(%e0_3684) : !cute.int_tuple<"?">
          %1273 = cute.get_scalars(%e1_3685) : !cute.int_tuple<"?{div=2}">
          %coord_3686 = cute.make_coord(%e0_3669) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3687 = cute.make_coord(%e1_3685) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1274 = cute.elem_less(%coord_3686, %coord_3687) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3688 = cute.get_layout(%1259) : !memref_rmem_f32_1
          %1275 = cute.get_shape(%lay_3688) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3689, %e1_3690, %e2_3691, %e3_3692 = cute.get_leaves(%1275) : !cute.shape<"((2,2),1,8)">
          %1276 = cute.get_stride(%lay_3688) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3693, %e1_3694, %e2_3695, %e3_3696 = cute.get_leaves(%1276) : !cute.stride<"((1,2),0,4)">
          %1277 = scf.if %1274 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1259) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
            cute.memref.store(%1259, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1259) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1259 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1259) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1259) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1259 : !memref_rmem_f32_1
          }
          %iter_3697 = cute.get_iter(%1277) : !memref_rmem_f32_1
          %lay_3698 = cute.get_layout(%1277) : !memref_rmem_f32_1
          %1278 = cute.get_shape(%lay_3698) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3699, %e1_3700, %e2_3701, %e3_3702 = cute.get_leaves(%1278) : !cute.shape<"((2,2),1,8)">
          %1279 = cute.get_stride(%lay_3698) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3703, %e1_3704, %e2_3705, %e3_3706 = cute.get_leaves(%1279) : !cute.stride<"((1,2),0,4)">
          %iter_3707 = cute.get_iter(%1277) : !memref_rmem_f32_1
          %iter_3708 = cute.get_iter(%1277) : !memref_rmem_f32_1
          %coord_3709 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_3710 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3711 = cute.crd2idx(%coord_3709, %lay_3710) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_3712 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3713 = cute.add_offset(%iter_3712, %idx_3711) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3714 = cute.make_view(%tup_3713) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3715 = cute.get_iter(%view_3714) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3716, %e1_3717 = cute.get_leaves(%iter_3715) : !cute.int_tuple<"(?,?{div=2})">
          %1280 = cute.get_scalars(%e0_3716) : !cute.int_tuple<"?">
          %1281 = cute.get_scalars(%e1_3717) : !cute.int_tuple<"?{div=2}">
          %iter_3718 = cute.get_iter(%view_3714) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3719, %e1_3720 = cute.get_leaves(%iter_3718) : !cute.int_tuple<"(?,?{div=2})">
          %1282 = cute.get_scalars(%e0_3719) : !cute.int_tuple<"?">
          %1283 = cute.get_scalars(%e1_3720) : !cute.int_tuple<"?{div=2}">
          %iter_3721 = cute.get_iter(%view_3714) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3722, %e1_3723 = cute.get_leaves(%iter_3721) : !cute.int_tuple<"(?,?{div=2})">
          %1284 = cute.get_scalars(%e0_3722) : !cute.int_tuple<"?">
          %1285 = cute.get_scalars(%e1_3723) : !cute.int_tuple<"?{div=2}">
          %coord_3724 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_3725 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3726 = cute.crd2idx(%coord_3724, %lay_3725) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_3727 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3728 = cute.add_offset(%iter_3727, %idx_3726) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3729 = cute.make_view(%tup_3728) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3730 = cute.get_iter(%view_3729) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3731, %e1_3732 = cute.get_leaves(%iter_3730) : !cute.int_tuple<"(?,?{div=2})">
          %1286 = cute.get_scalars(%e0_3731) : !cute.int_tuple<"?">
          %1287 = cute.get_scalars(%e1_3732) : !cute.int_tuple<"?{div=2}">
          %iter_3733 = cute.get_iter(%view_3729) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3734, %e1_3735 = cute.get_leaves(%iter_3733) : !cute.int_tuple<"(?,?{div=2})">
          %1288 = cute.get_scalars(%e0_3734) : !cute.int_tuple<"?">
          %1289 = cute.get_scalars(%e1_3735) : !cute.int_tuple<"?{div=2}">
          %iter_3736 = cute.get_iter(%view_3729) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3737, %e1_3738 = cute.get_leaves(%iter_3736) : !cute.int_tuple<"(?,?{div=2})">
          %1290 = cute.get_scalars(%e0_3737) : !cute.int_tuple<"?">
          %1291 = cute.get_scalars(%e1_3738) : !cute.int_tuple<"?{div=2}">
          %coord_3739 = cute.make_coord(%e0_3722) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3740 = cute.make_coord(%e1_3738) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1292 = cute.elem_less(%coord_3739, %coord_3740) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_3741 = cute.get_layout(%1277) : !memref_rmem_f32_1
          %1293 = cute.get_shape(%lay_3741) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3742, %e1_3743, %e2_3744, %e3_3745 = cute.get_leaves(%1293) : !cute.shape<"((2,2),1,8)">
          %1294 = cute.get_stride(%lay_3741) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3746, %e1_3747, %e2_3748, %e3_3749 = cute.get_leaves(%1294) : !cute.stride<"((1,2),0,4)">
          %1295 = scf.if %1292 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1277) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
            cute.memref.store(%1277, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1277) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1277 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1277) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1277) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1277 : !memref_rmem_f32_1
          }
          %iter_3750 = cute.get_iter(%1295) : !memref_rmem_f32_1
          %lay_3751 = cute.get_layout(%1295) : !memref_rmem_f32_1
          %1296 = cute.get_shape(%lay_3751) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3752, %e1_3753, %e2_3754, %e3_3755 = cute.get_leaves(%1296) : !cute.shape<"((2,2),1,8)">
          %1297 = cute.get_stride(%lay_3751) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3756, %e1_3757, %e2_3758, %e3_3759 = cute.get_leaves(%1297) : !cute.stride<"((1,2),0,4)">
          %iter_3760 = cute.get_iter(%1295) : !memref_rmem_f32_1
          %iter_3761 = cute.get_iter(%1295) : !memref_rmem_f32_1
          %int_tuple_3762 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3763 = cute.size(%int_tuple_3762) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3764 = cute.get_leaves(%sz_3763) : !cute.int_tuple<"1">
          %int_tuple_3765 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3766 = cute.size(%int_tuple_3765) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3767 = cute.get_leaves(%sz_3766) : !cute.int_tuple<"8">
          %coord_3768 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_3769 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3770 = cute.crd2idx(%coord_3768, %lay_3769) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_3771 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3772 = cute.add_offset(%iter_3771, %idx_3770) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_3773 = cute.make_view(%tup_3772) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3774 = cute.get_iter(%view_3773) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3775, %e1_3776 = cute.get_leaves(%iter_3774) : !cute.int_tuple<"(?,?)">
          %1298 = cute.get_scalars(%e0_3775) : !cute.int_tuple<"?">
          %1299 = cute.get_scalars(%e1_3776) : !cute.int_tuple<"?">
          %iter_3777 = cute.get_iter(%view_3773) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3778, %e1_3779 = cute.get_leaves(%iter_3777) : !cute.int_tuple<"(?,?)">
          %1300 = cute.get_scalars(%e0_3778) : !cute.int_tuple<"?">
          %1301 = cute.get_scalars(%e1_3779) : !cute.int_tuple<"?">
          %iter_3780 = cute.get_iter(%view_3773) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3781, %e1_3782 = cute.get_leaves(%iter_3780) : !cute.int_tuple<"(?,?)">
          %1302 = cute.get_scalars(%e0_3781) : !cute.int_tuple<"?">
          %1303 = cute.get_scalars(%e1_3782) : !cute.int_tuple<"?">
          %coord_3783 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_3784 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3785 = cute.crd2idx(%coord_3783, %lay_3784) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_3786 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3787 = cute.add_offset(%iter_3786, %idx_3785) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_3788 = cute.make_view(%tup_3787) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3789 = cute.get_iter(%view_3788) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3790, %e1_3791 = cute.get_leaves(%iter_3789) : !cute.int_tuple<"(?,?)">
          %1304 = cute.get_scalars(%e0_3790) : !cute.int_tuple<"?">
          %1305 = cute.get_scalars(%e1_3791) : !cute.int_tuple<"?">
          %iter_3792 = cute.get_iter(%view_3788) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3793, %e1_3794 = cute.get_leaves(%iter_3792) : !cute.int_tuple<"(?,?)">
          %1306 = cute.get_scalars(%e0_3793) : !cute.int_tuple<"?">
          %1307 = cute.get_scalars(%e1_3794) : !cute.int_tuple<"?">
          %iter_3795 = cute.get_iter(%view_3788) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3796, %e1_3797 = cute.get_leaves(%iter_3795) : !cute.int_tuple<"(?,?)">
          %1308 = cute.get_scalars(%e0_3796) : !cute.int_tuple<"?">
          %1309 = cute.get_scalars(%e1_3797) : !cute.int_tuple<"?">
          %coord_3798 = cute.make_coord(%e0_3781) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3799 = cute.make_coord(%e1_3797) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1310 = cute.elem_less(%coord_3798, %coord_3799) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3800 = cute.get_layout(%1295) : !memref_rmem_f32_1
          %1311 = cute.get_shape(%lay_3800) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3801, %e1_3802, %e2_3803, %e3_3804 = cute.get_leaves(%1311) : !cute.shape<"((2,2),1,8)">
          %1312 = cute.get_stride(%lay_3800) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3805, %e1_3806, %e2_3807, %e3_3808 = cute.get_leaves(%1312) : !cute.stride<"((1,2),0,4)">
          %1313 = scf.if %1310 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1295) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
            cute.memref.store(%1295, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1295) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1295 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1295) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1295) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1295 : !memref_rmem_f32_1
          }
          %iter_3809 = cute.get_iter(%1313) : !memref_rmem_f32_1
          %lay_3810 = cute.get_layout(%1313) : !memref_rmem_f32_1
          %1314 = cute.get_shape(%lay_3810) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3811, %e1_3812, %e2_3813, %e3_3814 = cute.get_leaves(%1314) : !cute.shape<"((2,2),1,8)">
          %1315 = cute.get_stride(%lay_3810) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3815, %e1_3816, %e2_3817, %e3_3818 = cute.get_leaves(%1315) : !cute.stride<"((1,2),0,4)">
          %iter_3819 = cute.get_iter(%1313) : !memref_rmem_f32_1
          %iter_3820 = cute.get_iter(%1313) : !memref_rmem_f32_1
          %coord_3821 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_3822 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3823 = cute.crd2idx(%coord_3821, %lay_3822) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_3824 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3825 = cute.add_offset(%iter_3824, %idx_3823) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_3826 = cute.make_view(%tup_3825) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3827 = cute.get_iter(%view_3826) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3828, %e1_3829 = cute.get_leaves(%iter_3827) : !cute.int_tuple<"(?,?)">
          %1316 = cute.get_scalars(%e0_3828) : !cute.int_tuple<"?">
          %1317 = cute.get_scalars(%e1_3829) : !cute.int_tuple<"?">
          %iter_3830 = cute.get_iter(%view_3826) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3831, %e1_3832 = cute.get_leaves(%iter_3830) : !cute.int_tuple<"(?,?)">
          %1318 = cute.get_scalars(%e0_3831) : !cute.int_tuple<"?">
          %1319 = cute.get_scalars(%e1_3832) : !cute.int_tuple<"?">
          %iter_3833 = cute.get_iter(%view_3826) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3834, %e1_3835 = cute.get_leaves(%iter_3833) : !cute.int_tuple<"(?,?)">
          %1320 = cute.get_scalars(%e0_3834) : !cute.int_tuple<"?">
          %1321 = cute.get_scalars(%e1_3835) : !cute.int_tuple<"?">
          %coord_3836 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_3837 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3838 = cute.crd2idx(%coord_3836, %lay_3837) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_3839 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3840 = cute.add_offset(%iter_3839, %idx_3838) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_3841 = cute.make_view(%tup_3840) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3842 = cute.get_iter(%view_3841) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3843, %e1_3844 = cute.get_leaves(%iter_3842) : !cute.int_tuple<"(?,?)">
          %1322 = cute.get_scalars(%e0_3843) : !cute.int_tuple<"?">
          %1323 = cute.get_scalars(%e1_3844) : !cute.int_tuple<"?">
          %iter_3845 = cute.get_iter(%view_3841) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3846, %e1_3847 = cute.get_leaves(%iter_3845) : !cute.int_tuple<"(?,?)">
          %1324 = cute.get_scalars(%e0_3846) : !cute.int_tuple<"?">
          %1325 = cute.get_scalars(%e1_3847) : !cute.int_tuple<"?">
          %iter_3848 = cute.get_iter(%view_3841) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3849, %e1_3850 = cute.get_leaves(%iter_3848) : !cute.int_tuple<"(?,?)">
          %1326 = cute.get_scalars(%e0_3849) : !cute.int_tuple<"?">
          %1327 = cute.get_scalars(%e1_3850) : !cute.int_tuple<"?">
          %coord_3851 = cute.make_coord(%e0_3834) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3852 = cute.make_coord(%e1_3850) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1328 = cute.elem_less(%coord_3851, %coord_3852) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3853 = cute.get_layout(%1313) : !memref_rmem_f32_1
          %1329 = cute.get_shape(%lay_3853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3854, %e1_3855, %e2_3856, %e3_3857 = cute.get_leaves(%1329) : !cute.shape<"((2,2),1,8)">
          %1330 = cute.get_stride(%lay_3853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3858, %e1_3859, %e2_3860, %e3_3861 = cute.get_leaves(%1330) : !cute.stride<"((1,2),0,4)">
          %1331 = scf.if %1328 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1313) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
            cute.memref.store(%1313, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1313) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1313 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1313) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1313) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1313 : !memref_rmem_f32_1
          }
          %iter_3862 = cute.get_iter(%1331) : !memref_rmem_f32_1
          %lay_3863 = cute.get_layout(%1331) : !memref_rmem_f32_1
          %1332 = cute.get_shape(%lay_3863) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3864, %e1_3865, %e2_3866, %e3_3867 = cute.get_leaves(%1332) : !cute.shape<"((2,2),1,8)">
          %1333 = cute.get_stride(%lay_3863) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3868, %e1_3869, %e2_3870, %e3_3871 = cute.get_leaves(%1333) : !cute.stride<"((1,2),0,4)">
          %iter_3872 = cute.get_iter(%1331) : !memref_rmem_f32_1
          %iter_3873 = cute.get_iter(%1331) : !memref_rmem_f32_1
          %coord_3874 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_3875 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3876 = cute.crd2idx(%coord_3874, %lay_3875) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_3877 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3878 = cute.add_offset(%iter_3877, %idx_3876) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_3879 = cute.make_view(%tup_3878) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3880 = cute.get_iter(%view_3879) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3881, %e1_3882 = cute.get_leaves(%iter_3880) : !cute.int_tuple<"(?,?)">
          %1334 = cute.get_scalars(%e0_3881) : !cute.int_tuple<"?">
          %1335 = cute.get_scalars(%e1_3882) : !cute.int_tuple<"?">
          %iter_3883 = cute.get_iter(%view_3879) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3884, %e1_3885 = cute.get_leaves(%iter_3883) : !cute.int_tuple<"(?,?)">
          %1336 = cute.get_scalars(%e0_3884) : !cute.int_tuple<"?">
          %1337 = cute.get_scalars(%e1_3885) : !cute.int_tuple<"?">
          %iter_3886 = cute.get_iter(%view_3879) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3887, %e1_3888 = cute.get_leaves(%iter_3886) : !cute.int_tuple<"(?,?)">
          %1338 = cute.get_scalars(%e0_3887) : !cute.int_tuple<"?">
          %1339 = cute.get_scalars(%e1_3888) : !cute.int_tuple<"?">
          %coord_3889 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_3890 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3891 = cute.crd2idx(%coord_3889, %lay_3890) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_3892 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3893 = cute.add_offset(%iter_3892, %idx_3891) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_3894 = cute.make_view(%tup_3893) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3895 = cute.get_iter(%view_3894) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3896, %e1_3897 = cute.get_leaves(%iter_3895) : !cute.int_tuple<"(?,?)">
          %1340 = cute.get_scalars(%e0_3896) : !cute.int_tuple<"?">
          %1341 = cute.get_scalars(%e1_3897) : !cute.int_tuple<"?">
          %iter_3898 = cute.get_iter(%view_3894) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3899, %e1_3900 = cute.get_leaves(%iter_3898) : !cute.int_tuple<"(?,?)">
          %1342 = cute.get_scalars(%e0_3899) : !cute.int_tuple<"?">
          %1343 = cute.get_scalars(%e1_3900) : !cute.int_tuple<"?">
          %iter_3901 = cute.get_iter(%view_3894) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3902, %e1_3903 = cute.get_leaves(%iter_3901) : !cute.int_tuple<"(?,?)">
          %1344 = cute.get_scalars(%e0_3902) : !cute.int_tuple<"?">
          %1345 = cute.get_scalars(%e1_3903) : !cute.int_tuple<"?">
          %coord_3904 = cute.make_coord(%e0_3887) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3905 = cute.make_coord(%e1_3903) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1346 = cute.elem_less(%coord_3904, %coord_3905) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3906 = cute.get_layout(%1331) : !memref_rmem_f32_1
          %1347 = cute.get_shape(%lay_3906) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3907, %e1_3908, %e2_3909, %e3_3910 = cute.get_leaves(%1347) : !cute.shape<"((2,2),1,8)">
          %1348 = cute.get_stride(%lay_3906) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3911, %e1_3912, %e2_3913, %e3_3914 = cute.get_leaves(%1348) : !cute.stride<"((1,2),0,4)">
          %1349 = scf.if %1346 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1331) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
            cute.memref.store(%1331, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1331) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1331 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1331) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1331) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1331 : !memref_rmem_f32_1
          }
          %iter_3915 = cute.get_iter(%1349) : !memref_rmem_f32_1
          %lay_3916 = cute.get_layout(%1349) : !memref_rmem_f32_1
          %1350 = cute.get_shape(%lay_3916) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3917, %e1_3918, %e2_3919, %e3_3920 = cute.get_leaves(%1350) : !cute.shape<"((2,2),1,8)">
          %1351 = cute.get_stride(%lay_3916) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3921, %e1_3922, %e2_3923, %e3_3924 = cute.get_leaves(%1351) : !cute.stride<"((1,2),0,4)">
          %iter_3925 = cute.get_iter(%1349) : !memref_rmem_f32_1
          %iter_3926 = cute.get_iter(%1349) : !memref_rmem_f32_1
          %coord_3927 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_3928 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3929 = cute.crd2idx(%coord_3927, %lay_3928) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_3930 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3931 = cute.add_offset(%iter_3930, %idx_3929) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_3932 = cute.make_view(%tup_3931) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3933 = cute.get_iter(%view_3932) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3934, %e1_3935 = cute.get_leaves(%iter_3933) : !cute.int_tuple<"(?,?)">
          %1352 = cute.get_scalars(%e0_3934) : !cute.int_tuple<"?">
          %1353 = cute.get_scalars(%e1_3935) : !cute.int_tuple<"?">
          %iter_3936 = cute.get_iter(%view_3932) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3937, %e1_3938 = cute.get_leaves(%iter_3936) : !cute.int_tuple<"(?,?)">
          %1354 = cute.get_scalars(%e0_3937) : !cute.int_tuple<"?">
          %1355 = cute.get_scalars(%e1_3938) : !cute.int_tuple<"?">
          %iter_3939 = cute.get_iter(%view_3932) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3940, %e1_3941 = cute.get_leaves(%iter_3939) : !cute.int_tuple<"(?,?)">
          %1356 = cute.get_scalars(%e0_3940) : !cute.int_tuple<"?">
          %1357 = cute.get_scalars(%e1_3941) : !cute.int_tuple<"?">
          %coord_3942 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_3943 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3944 = cute.crd2idx(%coord_3942, %lay_3943) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_3945 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3946 = cute.add_offset(%iter_3945, %idx_3944) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_3947 = cute.make_view(%tup_3946) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3948 = cute.get_iter(%view_3947) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3949, %e1_3950 = cute.get_leaves(%iter_3948) : !cute.int_tuple<"(?,?)">
          %1358 = cute.get_scalars(%e0_3949) : !cute.int_tuple<"?">
          %1359 = cute.get_scalars(%e1_3950) : !cute.int_tuple<"?">
          %iter_3951 = cute.get_iter(%view_3947) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3952, %e1_3953 = cute.get_leaves(%iter_3951) : !cute.int_tuple<"(?,?)">
          %1360 = cute.get_scalars(%e0_3952) : !cute.int_tuple<"?">
          %1361 = cute.get_scalars(%e1_3953) : !cute.int_tuple<"?">
          %iter_3954 = cute.get_iter(%view_3947) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3955, %e1_3956 = cute.get_leaves(%iter_3954) : !cute.int_tuple<"(?,?)">
          %1362 = cute.get_scalars(%e0_3955) : !cute.int_tuple<"?">
          %1363 = cute.get_scalars(%e1_3956) : !cute.int_tuple<"?">
          %coord_3957 = cute.make_coord(%e0_3940) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3958 = cute.make_coord(%e1_3956) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1364 = cute.elem_less(%coord_3957, %coord_3958) : !cute.coord<"?">, !cute.coord<"?">
          %lay_3959 = cute.get_layout(%1349) : !memref_rmem_f32_1
          %1365 = cute.get_shape(%lay_3959) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3960, %e1_3961, %e2_3962, %e3_3963 = cute.get_leaves(%1365) : !cute.shape<"((2,2),1,8)">
          %1366 = cute.get_stride(%lay_3959) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3964, %e1_3965, %e2_3966, %e3_3967 = cute.get_leaves(%1366) : !cute.stride<"((1,2),0,4)">
          %1367 = scf.if %1364 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1349) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
            cute.memref.store(%1349, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1349) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1349 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1349) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1349) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1349 : !memref_rmem_f32_1
          }
          %iter_3968 = cute.get_iter(%1367) : !memref_rmem_f32_1
          %lay_3969 = cute.get_layout(%1367) : !memref_rmem_f32_1
          %1368 = cute.get_shape(%lay_3969) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3970, %e1_3971, %e2_3972, %e3_3973 = cute.get_leaves(%1368) : !cute.shape<"((2,2),1,8)">
          %1369 = cute.get_stride(%lay_3969) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977 = cute.get_leaves(%1369) : !cute.stride<"((1,2),0,4)">
          %iter_3978 = cute.get_iter(%1367) : !memref_rmem_f32_1
          %iter_3979 = cute.get_iter(%1367) : !memref_rmem_f32_1
          %coord_3980 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_3981 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3982 = cute.crd2idx(%coord_3980, %lay_3981) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_3983 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3984 = cute.add_offset(%iter_3983, %idx_3982) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_3985 = cute.make_view(%tup_3984) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_3986 = cute.get_iter(%view_3985) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3987, %e1_3988 = cute.get_leaves(%iter_3986) : !cute.int_tuple<"(?,?)">
          %1370 = cute.get_scalars(%e0_3987) : !cute.int_tuple<"?">
          %1371 = cute.get_scalars(%e1_3988) : !cute.int_tuple<"?">
          %iter_3989 = cute.get_iter(%view_3985) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3990, %e1_3991 = cute.get_leaves(%iter_3989) : !cute.int_tuple<"(?,?)">
          %1372 = cute.get_scalars(%e0_3990) : !cute.int_tuple<"?">
          %1373 = cute.get_scalars(%e1_3991) : !cute.int_tuple<"?">
          %iter_3992 = cute.get_iter(%view_3985) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_3993, %e1_3994 = cute.get_leaves(%iter_3992) : !cute.int_tuple<"(?,?)">
          %1374 = cute.get_scalars(%e0_3993) : !cute.int_tuple<"?">
          %1375 = cute.get_scalars(%e1_3994) : !cute.int_tuple<"?">
          %coord_3995 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_3996 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3997 = cute.crd2idx(%coord_3995, %lay_3996) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_3998 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3999 = cute.add_offset(%iter_3998, %idx_3997) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4000 = cute.make_view(%tup_3999) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4001 = cute.get_iter(%view_4000) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4002, %e1_4003 = cute.get_leaves(%iter_4001) : !cute.int_tuple<"(?,?)">
          %1376 = cute.get_scalars(%e0_4002) : !cute.int_tuple<"?">
          %1377 = cute.get_scalars(%e1_4003) : !cute.int_tuple<"?">
          %iter_4004 = cute.get_iter(%view_4000) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4005, %e1_4006 = cute.get_leaves(%iter_4004) : !cute.int_tuple<"(?,?)">
          %1378 = cute.get_scalars(%e0_4005) : !cute.int_tuple<"?">
          %1379 = cute.get_scalars(%e1_4006) : !cute.int_tuple<"?">
          %iter_4007 = cute.get_iter(%view_4000) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4008, %e1_4009 = cute.get_leaves(%iter_4007) : !cute.int_tuple<"(?,?)">
          %1380 = cute.get_scalars(%e0_4008) : !cute.int_tuple<"?">
          %1381 = cute.get_scalars(%e1_4009) : !cute.int_tuple<"?">
          %coord_4010 = cute.make_coord(%e0_3993) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4011 = cute.make_coord(%e1_4009) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1382 = cute.elem_less(%coord_4010, %coord_4011) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4012 = cute.get_layout(%1367) : !memref_rmem_f32_1
          %1383 = cute.get_shape(%lay_4012) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4013, %e1_4014, %e2_4015, %e3_4016 = cute.get_leaves(%1383) : !cute.shape<"((2,2),1,8)">
          %1384 = cute.get_stride(%lay_4012) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4017, %e1_4018, %e2_4019, %e3_4020 = cute.get_leaves(%1384) : !cute.stride<"((1,2),0,4)">
          %1385 = scf.if %1382 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1367) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
            cute.memref.store(%1367, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1367) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1367 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1367) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1367) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1367 : !memref_rmem_f32_1
          }
          %iter_4021 = cute.get_iter(%1385) : !memref_rmem_f32_1
          %lay_4022 = cute.get_layout(%1385) : !memref_rmem_f32_1
          %1386 = cute.get_shape(%lay_4022) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4023, %e1_4024, %e2_4025, %e3_4026 = cute.get_leaves(%1386) : !cute.shape<"((2,2),1,8)">
          %1387 = cute.get_stride(%lay_4022) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4027, %e1_4028, %e2_4029, %e3_4030 = cute.get_leaves(%1387) : !cute.stride<"((1,2),0,4)">
          %iter_4031 = cute.get_iter(%1385) : !memref_rmem_f32_1
          %iter_4032 = cute.get_iter(%1385) : !memref_rmem_f32_1
          %coord_4033 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_4034 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4035 = cute.crd2idx(%coord_4033, %lay_4034) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_4036 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4037 = cute.add_offset(%iter_4036, %idx_4035) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4038 = cute.make_view(%tup_4037) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4039 = cute.get_iter(%view_4038) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4040, %e1_4041 = cute.get_leaves(%iter_4039) : !cute.int_tuple<"(?,?)">
          %1388 = cute.get_scalars(%e0_4040) : !cute.int_tuple<"?">
          %1389 = cute.get_scalars(%e1_4041) : !cute.int_tuple<"?">
          %iter_4042 = cute.get_iter(%view_4038) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4043, %e1_4044 = cute.get_leaves(%iter_4042) : !cute.int_tuple<"(?,?)">
          %1390 = cute.get_scalars(%e0_4043) : !cute.int_tuple<"?">
          %1391 = cute.get_scalars(%e1_4044) : !cute.int_tuple<"?">
          %iter_4045 = cute.get_iter(%view_4038) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4046, %e1_4047 = cute.get_leaves(%iter_4045) : !cute.int_tuple<"(?,?)">
          %1392 = cute.get_scalars(%e0_4046) : !cute.int_tuple<"?">
          %1393 = cute.get_scalars(%e1_4047) : !cute.int_tuple<"?">
          %coord_4048 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_4049 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4050 = cute.crd2idx(%coord_4048, %lay_4049) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_4051 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4052 = cute.add_offset(%iter_4051, %idx_4050) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4053 = cute.make_view(%tup_4052) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4054 = cute.get_iter(%view_4053) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4055, %e1_4056 = cute.get_leaves(%iter_4054) : !cute.int_tuple<"(?,?)">
          %1394 = cute.get_scalars(%e0_4055) : !cute.int_tuple<"?">
          %1395 = cute.get_scalars(%e1_4056) : !cute.int_tuple<"?">
          %iter_4057 = cute.get_iter(%view_4053) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4058, %e1_4059 = cute.get_leaves(%iter_4057) : !cute.int_tuple<"(?,?)">
          %1396 = cute.get_scalars(%e0_4058) : !cute.int_tuple<"?">
          %1397 = cute.get_scalars(%e1_4059) : !cute.int_tuple<"?">
          %iter_4060 = cute.get_iter(%view_4053) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4061, %e1_4062 = cute.get_leaves(%iter_4060) : !cute.int_tuple<"(?,?)">
          %1398 = cute.get_scalars(%e0_4061) : !cute.int_tuple<"?">
          %1399 = cute.get_scalars(%e1_4062) : !cute.int_tuple<"?">
          %coord_4063 = cute.make_coord(%e0_4046) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4064 = cute.make_coord(%e1_4062) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1400 = cute.elem_less(%coord_4063, %coord_4064) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4065 = cute.get_layout(%1385) : !memref_rmem_f32_1
          %1401 = cute.get_shape(%lay_4065) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4066, %e1_4067, %e2_4068, %e3_4069 = cute.get_leaves(%1401) : !cute.shape<"((2,2),1,8)">
          %1402 = cute.get_stride(%lay_4065) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4070, %e1_4071, %e2_4072, %e3_4073 = cute.get_leaves(%1402) : !cute.stride<"((1,2),0,4)">
          %1403 = scf.if %1400 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1385) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
            cute.memref.store(%1385, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1385) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1385 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1385) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1385) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1385 : !memref_rmem_f32_1
          }
          %iter_4074 = cute.get_iter(%1403) : !memref_rmem_f32_1
          %lay_4075 = cute.get_layout(%1403) : !memref_rmem_f32_1
          %1404 = cute.get_shape(%lay_4075) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4076, %e1_4077, %e2_4078, %e3_4079 = cute.get_leaves(%1404) : !cute.shape<"((2,2),1,8)">
          %1405 = cute.get_stride(%lay_4075) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4080, %e1_4081, %e2_4082, %e3_4083 = cute.get_leaves(%1405) : !cute.stride<"((1,2),0,4)">
          %iter_4084 = cute.get_iter(%1403) : !memref_rmem_f32_1
          %iter_4085 = cute.get_iter(%1403) : !memref_rmem_f32_1
          %coord_4086 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4087 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4088 = cute.crd2idx(%coord_4086, %lay_4087) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4089 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4090 = cute.add_offset(%iter_4089, %idx_4088) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4091 = cute.make_view(%tup_4090) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4092 = cute.get_iter(%view_4091) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4093, %e1_4094 = cute.get_leaves(%iter_4092) : !cute.int_tuple<"(?,?)">
          %1406 = cute.get_scalars(%e0_4093) : !cute.int_tuple<"?">
          %1407 = cute.get_scalars(%e1_4094) : !cute.int_tuple<"?">
          %iter_4095 = cute.get_iter(%view_4091) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4096, %e1_4097 = cute.get_leaves(%iter_4095) : !cute.int_tuple<"(?,?)">
          %1408 = cute.get_scalars(%e0_4096) : !cute.int_tuple<"?">
          %1409 = cute.get_scalars(%e1_4097) : !cute.int_tuple<"?">
          %iter_4098 = cute.get_iter(%view_4091) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4099, %e1_4100 = cute.get_leaves(%iter_4098) : !cute.int_tuple<"(?,?)">
          %1410 = cute.get_scalars(%e0_4099) : !cute.int_tuple<"?">
          %1411 = cute.get_scalars(%e1_4100) : !cute.int_tuple<"?">
          %coord_4101 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4102 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4103 = cute.crd2idx(%coord_4101, %lay_4102) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4104 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4105 = cute.add_offset(%iter_4104, %idx_4103) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4106 = cute.make_view(%tup_4105) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4107 = cute.get_iter(%view_4106) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4108, %e1_4109 = cute.get_leaves(%iter_4107) : !cute.int_tuple<"(?,?)">
          %1412 = cute.get_scalars(%e0_4108) : !cute.int_tuple<"?">
          %1413 = cute.get_scalars(%e1_4109) : !cute.int_tuple<"?">
          %iter_4110 = cute.get_iter(%view_4106) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4111, %e1_4112 = cute.get_leaves(%iter_4110) : !cute.int_tuple<"(?,?)">
          %1414 = cute.get_scalars(%e0_4111) : !cute.int_tuple<"?">
          %1415 = cute.get_scalars(%e1_4112) : !cute.int_tuple<"?">
          %iter_4113 = cute.get_iter(%view_4106) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4114, %e1_4115 = cute.get_leaves(%iter_4113) : !cute.int_tuple<"(?,?)">
          %1416 = cute.get_scalars(%e0_4114) : !cute.int_tuple<"?">
          %1417 = cute.get_scalars(%e1_4115) : !cute.int_tuple<"?">
          %coord_4116 = cute.make_coord(%e0_4099) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4117 = cute.make_coord(%e1_4115) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1418 = cute.elem_less(%coord_4116, %coord_4117) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4118 = cute.get_layout(%1403) : !memref_rmem_f32_1
          %1419 = cute.get_shape(%lay_4118) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4119, %e1_4120, %e2_4121, %e3_4122 = cute.get_leaves(%1419) : !cute.shape<"((2,2),1,8)">
          %1420 = cute.get_stride(%lay_4118) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4123, %e1_4124, %e2_4125, %e3_4126 = cute.get_leaves(%1420) : !cute.stride<"((1,2),0,4)">
          %1421 = scf.if %1418 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1403) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
            cute.memref.store(%1403, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1403) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1403 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1403) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1403) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1403 : !memref_rmem_f32_1
          }
          %iter_4127 = cute.get_iter(%1421) : !memref_rmem_f32_1
          %lay_4128 = cute.get_layout(%1421) : !memref_rmem_f32_1
          %1422 = cute.get_shape(%lay_4128) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4129, %e1_4130, %e2_4131, %e3_4132 = cute.get_leaves(%1422) : !cute.shape<"((2,2),1,8)">
          %1423 = cute.get_stride(%lay_4128) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4133, %e1_4134, %e2_4135, %e3_4136 = cute.get_leaves(%1423) : !cute.stride<"((1,2),0,4)">
          %iter_4137 = cute.get_iter(%1421) : !memref_rmem_f32_1
          %iter_4138 = cute.get_iter(%1421) : !memref_rmem_f32_1
          %coord_4139 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4140 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4141 = cute.crd2idx(%coord_4139, %lay_4140) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4142 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4143 = cute.add_offset(%iter_4142, %idx_4141) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4144 = cute.make_view(%tup_4143) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4145 = cute.get_iter(%view_4144) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4146, %e1_4147 = cute.get_leaves(%iter_4145) : !cute.int_tuple<"(?,?)">
          %1424 = cute.get_scalars(%e0_4146) : !cute.int_tuple<"?">
          %1425 = cute.get_scalars(%e1_4147) : !cute.int_tuple<"?">
          %iter_4148 = cute.get_iter(%view_4144) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4149, %e1_4150 = cute.get_leaves(%iter_4148) : !cute.int_tuple<"(?,?)">
          %1426 = cute.get_scalars(%e0_4149) : !cute.int_tuple<"?">
          %1427 = cute.get_scalars(%e1_4150) : !cute.int_tuple<"?">
          %iter_4151 = cute.get_iter(%view_4144) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4152, %e1_4153 = cute.get_leaves(%iter_4151) : !cute.int_tuple<"(?,?)">
          %1428 = cute.get_scalars(%e0_4152) : !cute.int_tuple<"?">
          %1429 = cute.get_scalars(%e1_4153) : !cute.int_tuple<"?">
          %coord_4154 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4155 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4157 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4159 = cute.make_view(%tup_4158) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4160 = cute.get_iter(%view_4159) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4161, %e1_4162 = cute.get_leaves(%iter_4160) : !cute.int_tuple<"(?,?)">
          %1430 = cute.get_scalars(%e0_4161) : !cute.int_tuple<"?">
          %1431 = cute.get_scalars(%e1_4162) : !cute.int_tuple<"?">
          %iter_4163 = cute.get_iter(%view_4159) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4164, %e1_4165 = cute.get_leaves(%iter_4163) : !cute.int_tuple<"(?,?)">
          %1432 = cute.get_scalars(%e0_4164) : !cute.int_tuple<"?">
          %1433 = cute.get_scalars(%e1_4165) : !cute.int_tuple<"?">
          %iter_4166 = cute.get_iter(%view_4159) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4167, %e1_4168 = cute.get_leaves(%iter_4166) : !cute.int_tuple<"(?,?)">
          %1434 = cute.get_scalars(%e0_4167) : !cute.int_tuple<"?">
          %1435 = cute.get_scalars(%e1_4168) : !cute.int_tuple<"?">
          %coord_4169 = cute.make_coord(%e0_4152) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4170 = cute.make_coord(%e1_4168) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1436 = cute.elem_less(%coord_4169, %coord_4170) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4171 = cute.get_layout(%1421) : !memref_rmem_f32_1
          %1437 = cute.get_shape(%lay_4171) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4172, %e1_4173, %e2_4174, %e3_4175 = cute.get_leaves(%1437) : !cute.shape<"((2,2),1,8)">
          %1438 = cute.get_stride(%lay_4171) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4176, %e1_4177, %e2_4178, %e3_4179 = cute.get_leaves(%1438) : !cute.stride<"((1,2),0,4)">
          %1439 = scf.if %1436 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1421) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
            cute.memref.store(%1421, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1421) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1421 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1421) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1421) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1421 : !memref_rmem_f32_1
          }
          %iter_4180 = cute.get_iter(%1439) : !memref_rmem_f32_1
          %lay_4181 = cute.get_layout(%1439) : !memref_rmem_f32_1
          %1440 = cute.get_shape(%lay_4181) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4182, %e1_4183, %e2_4184, %e3_4185 = cute.get_leaves(%1440) : !cute.shape<"((2,2),1,8)">
          %1441 = cute.get_stride(%lay_4181) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4186, %e1_4187, %e2_4188, %e3_4189 = cute.get_leaves(%1441) : !cute.stride<"((1,2),0,4)">
          %iter_4190 = cute.get_iter(%1439) : !memref_rmem_f32_1
          %iter_4191 = cute.get_iter(%1439) : !memref_rmem_f32_1
          %int_tuple_4192 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4193 = cute.size(%int_tuple_4192) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4194 = cute.get_leaves(%sz_4193) : !cute.int_tuple<"1">
          %int_tuple_4195 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4196 = cute.size(%int_tuple_4195) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4197 = cute.get_leaves(%sz_4196) : !cute.int_tuple<"8">
          %coord_4198 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4199 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4200 = cute.crd2idx(%coord_4198, %lay_4199) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4201 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4202 = cute.add_offset(%iter_4201, %idx_4200) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4203 = cute.make_view(%tup_4202) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4204 = cute.get_iter(%view_4203) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4205, %e1_4206 = cute.get_leaves(%iter_4204) : !cute.int_tuple<"(?,?{div=2})">
          %1442 = cute.get_scalars(%e0_4205) : !cute.int_tuple<"?">
          %1443 = cute.get_scalars(%e1_4206) : !cute.int_tuple<"?{div=2}">
          %iter_4207 = cute.get_iter(%view_4203) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4208, %e1_4209 = cute.get_leaves(%iter_4207) : !cute.int_tuple<"(?,?{div=2})">
          %1444 = cute.get_scalars(%e0_4208) : !cute.int_tuple<"?">
          %1445 = cute.get_scalars(%e1_4209) : !cute.int_tuple<"?{div=2}">
          %iter_4210 = cute.get_iter(%view_4203) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4211, %e1_4212 = cute.get_leaves(%iter_4210) : !cute.int_tuple<"(?,?{div=2})">
          %1446 = cute.get_scalars(%e0_4211) : !cute.int_tuple<"?">
          %1447 = cute.get_scalars(%e1_4212) : !cute.int_tuple<"?{div=2}">
          %coord_4213 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4214 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4215 = cute.crd2idx(%coord_4213, %lay_4214) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4216 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4217 = cute.add_offset(%iter_4216, %idx_4215) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4218 = cute.make_view(%tup_4217) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4219 = cute.get_iter(%view_4218) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4220, %e1_4221 = cute.get_leaves(%iter_4219) : !cute.int_tuple<"(?,?{div=2})">
          %1448 = cute.get_scalars(%e0_4220) : !cute.int_tuple<"?">
          %1449 = cute.get_scalars(%e1_4221) : !cute.int_tuple<"?{div=2}">
          %iter_4222 = cute.get_iter(%view_4218) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4223, %e1_4224 = cute.get_leaves(%iter_4222) : !cute.int_tuple<"(?,?{div=2})">
          %1450 = cute.get_scalars(%e0_4223) : !cute.int_tuple<"?">
          %1451 = cute.get_scalars(%e1_4224) : !cute.int_tuple<"?{div=2}">
          %iter_4225 = cute.get_iter(%view_4218) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4226, %e1_4227 = cute.get_leaves(%iter_4225) : !cute.int_tuple<"(?,?{div=2})">
          %1452 = cute.get_scalars(%e0_4226) : !cute.int_tuple<"?">
          %1453 = cute.get_scalars(%e1_4227) : !cute.int_tuple<"?{div=2}">
          %coord_4228 = cute.make_coord(%e0_4211) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4229 = cute.make_coord(%e1_4227) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1454 = cute.elem_less(%coord_4228, %coord_4229) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4230 = cute.get_layout(%1439) : !memref_rmem_f32_1
          %1455 = cute.get_shape(%lay_4230) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4231, %e1_4232, %e2_4233, %e3_4234 = cute.get_leaves(%1455) : !cute.shape<"((2,2),1,8)">
          %1456 = cute.get_stride(%lay_4230) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4235, %e1_4236, %e2_4237, %e3_4238 = cute.get_leaves(%1456) : !cute.stride<"((1,2),0,4)">
          %1457 = scf.if %1454 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1439) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
            cute.memref.store(%1439, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1439) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1439 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1439) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1439) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1439 : !memref_rmem_f32_1
          }
          %iter_4239 = cute.get_iter(%1457) : !memref_rmem_f32_1
          %lay_4240 = cute.get_layout(%1457) : !memref_rmem_f32_1
          %1458 = cute.get_shape(%lay_4240) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4241, %e1_4242, %e2_4243, %e3_4244 = cute.get_leaves(%1458) : !cute.shape<"((2,2),1,8)">
          %1459 = cute.get_stride(%lay_4240) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4245, %e1_4246, %e2_4247, %e3_4248 = cute.get_leaves(%1459) : !cute.stride<"((1,2),0,4)">
          %iter_4249 = cute.get_iter(%1457) : !memref_rmem_f32_1
          %iter_4250 = cute.get_iter(%1457) : !memref_rmem_f32_1
          %coord_4251 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4252 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4253 = cute.crd2idx(%coord_4251, %lay_4252) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4254 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4255 = cute.add_offset(%iter_4254, %idx_4253) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4256 = cute.make_view(%tup_4255) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4257 = cute.get_iter(%view_4256) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4258, %e1_4259 = cute.get_leaves(%iter_4257) : !cute.int_tuple<"(?,?{div=2})">
          %1460 = cute.get_scalars(%e0_4258) : !cute.int_tuple<"?">
          %1461 = cute.get_scalars(%e1_4259) : !cute.int_tuple<"?{div=2}">
          %iter_4260 = cute.get_iter(%view_4256) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4261, %e1_4262 = cute.get_leaves(%iter_4260) : !cute.int_tuple<"(?,?{div=2})">
          %1462 = cute.get_scalars(%e0_4261) : !cute.int_tuple<"?">
          %1463 = cute.get_scalars(%e1_4262) : !cute.int_tuple<"?{div=2}">
          %iter_4263 = cute.get_iter(%view_4256) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4264, %e1_4265 = cute.get_leaves(%iter_4263) : !cute.int_tuple<"(?,?{div=2})">
          %1464 = cute.get_scalars(%e0_4264) : !cute.int_tuple<"?">
          %1465 = cute.get_scalars(%e1_4265) : !cute.int_tuple<"?{div=2}">
          %coord_4266 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4267 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4268 = cute.crd2idx(%coord_4266, %lay_4267) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4269 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4270 = cute.add_offset(%iter_4269, %idx_4268) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4271 = cute.make_view(%tup_4270) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4272 = cute.get_iter(%view_4271) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4273, %e1_4274 = cute.get_leaves(%iter_4272) : !cute.int_tuple<"(?,?{div=2})">
          %1466 = cute.get_scalars(%e0_4273) : !cute.int_tuple<"?">
          %1467 = cute.get_scalars(%e1_4274) : !cute.int_tuple<"?{div=2}">
          %iter_4275 = cute.get_iter(%view_4271) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4276, %e1_4277 = cute.get_leaves(%iter_4275) : !cute.int_tuple<"(?,?{div=2})">
          %1468 = cute.get_scalars(%e0_4276) : !cute.int_tuple<"?">
          %1469 = cute.get_scalars(%e1_4277) : !cute.int_tuple<"?{div=2}">
          %iter_4278 = cute.get_iter(%view_4271) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4279, %e1_4280 = cute.get_leaves(%iter_4278) : !cute.int_tuple<"(?,?{div=2})">
          %1470 = cute.get_scalars(%e0_4279) : !cute.int_tuple<"?">
          %1471 = cute.get_scalars(%e1_4280) : !cute.int_tuple<"?{div=2}">
          %coord_4281 = cute.make_coord(%e0_4264) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4282 = cute.make_coord(%e1_4280) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1472 = cute.elem_less(%coord_4281, %coord_4282) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4283 = cute.get_layout(%1457) : !memref_rmem_f32_1
          %1473 = cute.get_shape(%lay_4283) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4284, %e1_4285, %e2_4286, %e3_4287 = cute.get_leaves(%1473) : !cute.shape<"((2,2),1,8)">
          %1474 = cute.get_stride(%lay_4283) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4288, %e1_4289, %e2_4290, %e3_4291 = cute.get_leaves(%1474) : !cute.stride<"((1,2),0,4)">
          %1475 = scf.if %1472 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1457) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
            cute.memref.store(%1457, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1457) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1457 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1457) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1457) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1457 : !memref_rmem_f32_1
          }
          %iter_4292 = cute.get_iter(%1475) : !memref_rmem_f32_1
          %lay_4293 = cute.get_layout(%1475) : !memref_rmem_f32_1
          %1476 = cute.get_shape(%lay_4293) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4294, %e1_4295, %e2_4296, %e3_4297 = cute.get_leaves(%1476) : !cute.shape<"((2,2),1,8)">
          %1477 = cute.get_stride(%lay_4293) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4298, %e1_4299, %e2_4300, %e3_4301 = cute.get_leaves(%1477) : !cute.stride<"((1,2),0,4)">
          %iter_4302 = cute.get_iter(%1475) : !memref_rmem_f32_1
          %iter_4303 = cute.get_iter(%1475) : !memref_rmem_f32_1
          %coord_4304 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_4305 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4306 = cute.crd2idx(%coord_4304, %lay_4305) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_4307 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4308 = cute.add_offset(%iter_4307, %idx_4306) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4309 = cute.make_view(%tup_4308) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4310 = cute.get_iter(%view_4309) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4311, %e1_4312 = cute.get_leaves(%iter_4310) : !cute.int_tuple<"(?,?{div=2})">
          %1478 = cute.get_scalars(%e0_4311) : !cute.int_tuple<"?">
          %1479 = cute.get_scalars(%e1_4312) : !cute.int_tuple<"?{div=2}">
          %iter_4313 = cute.get_iter(%view_4309) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4314, %e1_4315 = cute.get_leaves(%iter_4313) : !cute.int_tuple<"(?,?{div=2})">
          %1480 = cute.get_scalars(%e0_4314) : !cute.int_tuple<"?">
          %1481 = cute.get_scalars(%e1_4315) : !cute.int_tuple<"?{div=2}">
          %iter_4316 = cute.get_iter(%view_4309) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4317, %e1_4318 = cute.get_leaves(%iter_4316) : !cute.int_tuple<"(?,?{div=2})">
          %1482 = cute.get_scalars(%e0_4317) : !cute.int_tuple<"?">
          %1483 = cute.get_scalars(%e1_4318) : !cute.int_tuple<"?{div=2}">
          %coord_4319 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_4320 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4321 = cute.crd2idx(%coord_4319, %lay_4320) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_4322 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4323 = cute.add_offset(%iter_4322, %idx_4321) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4324 = cute.make_view(%tup_4323) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4325 = cute.get_iter(%view_4324) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4326, %e1_4327 = cute.get_leaves(%iter_4325) : !cute.int_tuple<"(?,?{div=2})">
          %1484 = cute.get_scalars(%e0_4326) : !cute.int_tuple<"?">
          %1485 = cute.get_scalars(%e1_4327) : !cute.int_tuple<"?{div=2}">
          %iter_4328 = cute.get_iter(%view_4324) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4329, %e1_4330 = cute.get_leaves(%iter_4328) : !cute.int_tuple<"(?,?{div=2})">
          %1486 = cute.get_scalars(%e0_4329) : !cute.int_tuple<"?">
          %1487 = cute.get_scalars(%e1_4330) : !cute.int_tuple<"?{div=2}">
          %iter_4331 = cute.get_iter(%view_4324) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4332, %e1_4333 = cute.get_leaves(%iter_4331) : !cute.int_tuple<"(?,?{div=2})">
          %1488 = cute.get_scalars(%e0_4332) : !cute.int_tuple<"?">
          %1489 = cute.get_scalars(%e1_4333) : !cute.int_tuple<"?{div=2}">
          %coord_4334 = cute.make_coord(%e0_4317) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4335 = cute.make_coord(%e1_4333) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1490 = cute.elem_less(%coord_4334, %coord_4335) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4336 = cute.get_layout(%1475) : !memref_rmem_f32_1
          %1491 = cute.get_shape(%lay_4336) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4337, %e1_4338, %e2_4339, %e3_4340 = cute.get_leaves(%1491) : !cute.shape<"((2,2),1,8)">
          %1492 = cute.get_stride(%lay_4336) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4341, %e1_4342, %e2_4343, %e3_4344 = cute.get_leaves(%1492) : !cute.stride<"((1,2),0,4)">
          %1493 = scf.if %1490 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1475) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
            cute.memref.store(%1475, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1475) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1475 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1475) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1475) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1475 : !memref_rmem_f32_1
          }
          %iter_4345 = cute.get_iter(%1493) : !memref_rmem_f32_1
          %lay_4346 = cute.get_layout(%1493) : !memref_rmem_f32_1
          %1494 = cute.get_shape(%lay_4346) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4347, %e1_4348, %e2_4349, %e3_4350 = cute.get_leaves(%1494) : !cute.shape<"((2,2),1,8)">
          %1495 = cute.get_stride(%lay_4346) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4351, %e1_4352, %e2_4353, %e3_4354 = cute.get_leaves(%1495) : !cute.stride<"((1,2),0,4)">
          %iter_4355 = cute.get_iter(%1493) : !memref_rmem_f32_1
          %iter_4356 = cute.get_iter(%1493) : !memref_rmem_f32_1
          %coord_4357 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_4358 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4359 = cute.crd2idx(%coord_4357, %lay_4358) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_4360 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4361 = cute.add_offset(%iter_4360, %idx_4359) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4362 = cute.make_view(%tup_4361) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4363 = cute.get_iter(%view_4362) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4364, %e1_4365 = cute.get_leaves(%iter_4363) : !cute.int_tuple<"(?,?{div=2})">
          %1496 = cute.get_scalars(%e0_4364) : !cute.int_tuple<"?">
          %1497 = cute.get_scalars(%e1_4365) : !cute.int_tuple<"?{div=2}">
          %iter_4366 = cute.get_iter(%view_4362) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4367, %e1_4368 = cute.get_leaves(%iter_4366) : !cute.int_tuple<"(?,?{div=2})">
          %1498 = cute.get_scalars(%e0_4367) : !cute.int_tuple<"?">
          %1499 = cute.get_scalars(%e1_4368) : !cute.int_tuple<"?{div=2}">
          %iter_4369 = cute.get_iter(%view_4362) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4370, %e1_4371 = cute.get_leaves(%iter_4369) : !cute.int_tuple<"(?,?{div=2})">
          %1500 = cute.get_scalars(%e0_4370) : !cute.int_tuple<"?">
          %1501 = cute.get_scalars(%e1_4371) : !cute.int_tuple<"?{div=2}">
          %coord_4372 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_4373 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4374 = cute.crd2idx(%coord_4372, %lay_4373) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_4375 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4376 = cute.add_offset(%iter_4375, %idx_4374) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4377 = cute.make_view(%tup_4376) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4378 = cute.get_iter(%view_4377) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4379, %e1_4380 = cute.get_leaves(%iter_4378) : !cute.int_tuple<"(?,?{div=2})">
          %1502 = cute.get_scalars(%e0_4379) : !cute.int_tuple<"?">
          %1503 = cute.get_scalars(%e1_4380) : !cute.int_tuple<"?{div=2}">
          %iter_4381 = cute.get_iter(%view_4377) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4382, %e1_4383 = cute.get_leaves(%iter_4381) : !cute.int_tuple<"(?,?{div=2})">
          %1504 = cute.get_scalars(%e0_4382) : !cute.int_tuple<"?">
          %1505 = cute.get_scalars(%e1_4383) : !cute.int_tuple<"?{div=2}">
          %iter_4384 = cute.get_iter(%view_4377) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4385, %e1_4386 = cute.get_leaves(%iter_4384) : !cute.int_tuple<"(?,?{div=2})">
          %1506 = cute.get_scalars(%e0_4385) : !cute.int_tuple<"?">
          %1507 = cute.get_scalars(%e1_4386) : !cute.int_tuple<"?{div=2}">
          %coord_4387 = cute.make_coord(%e0_4370) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4388 = cute.make_coord(%e1_4386) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1508 = cute.elem_less(%coord_4387, %coord_4388) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4389 = cute.get_layout(%1493) : !memref_rmem_f32_1
          %1509 = cute.get_shape(%lay_4389) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4390, %e1_4391, %e2_4392, %e3_4393 = cute.get_leaves(%1509) : !cute.shape<"((2,2),1,8)">
          %1510 = cute.get_stride(%lay_4389) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4394, %e1_4395, %e2_4396, %e3_4397 = cute.get_leaves(%1510) : !cute.stride<"((1,2),0,4)">
          %1511 = scf.if %1508 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1493) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
            cute.memref.store(%1493, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1493) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1493 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1493) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1493) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1493 : !memref_rmem_f32_1
          }
          %iter_4398 = cute.get_iter(%1511) : !memref_rmem_f32_1
          %lay_4399 = cute.get_layout(%1511) : !memref_rmem_f32_1
          %1512 = cute.get_shape(%lay_4399) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4400, %e1_4401, %e2_4402, %e3_4403 = cute.get_leaves(%1512) : !cute.shape<"((2,2),1,8)">
          %1513 = cute.get_stride(%lay_4399) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4404, %e1_4405, %e2_4406, %e3_4407 = cute.get_leaves(%1513) : !cute.stride<"((1,2),0,4)">
          %iter_4408 = cute.get_iter(%1511) : !memref_rmem_f32_1
          %iter_4409 = cute.get_iter(%1511) : !memref_rmem_f32_1
          %coord_4410 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_4411 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4412 = cute.crd2idx(%coord_4410, %lay_4411) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_4413 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4414 = cute.add_offset(%iter_4413, %idx_4412) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4415 = cute.make_view(%tup_4414) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4416 = cute.get_iter(%view_4415) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4417, %e1_4418 = cute.get_leaves(%iter_4416) : !cute.int_tuple<"(?,?{div=2})">
          %1514 = cute.get_scalars(%e0_4417) : !cute.int_tuple<"?">
          %1515 = cute.get_scalars(%e1_4418) : !cute.int_tuple<"?{div=2}">
          %iter_4419 = cute.get_iter(%view_4415) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4420, %e1_4421 = cute.get_leaves(%iter_4419) : !cute.int_tuple<"(?,?{div=2})">
          %1516 = cute.get_scalars(%e0_4420) : !cute.int_tuple<"?">
          %1517 = cute.get_scalars(%e1_4421) : !cute.int_tuple<"?{div=2}">
          %iter_4422 = cute.get_iter(%view_4415) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4423, %e1_4424 = cute.get_leaves(%iter_4422) : !cute.int_tuple<"(?,?{div=2})">
          %1518 = cute.get_scalars(%e0_4423) : !cute.int_tuple<"?">
          %1519 = cute.get_scalars(%e1_4424) : !cute.int_tuple<"?{div=2}">
          %coord_4425 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_4426 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4427 = cute.crd2idx(%coord_4425, %lay_4426) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_4428 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4429 = cute.add_offset(%iter_4428, %idx_4427) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4430 = cute.make_view(%tup_4429) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4431 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4432, %e1_4433 = cute.get_leaves(%iter_4431) : !cute.int_tuple<"(?,?{div=2})">
          %1520 = cute.get_scalars(%e0_4432) : !cute.int_tuple<"?">
          %1521 = cute.get_scalars(%e1_4433) : !cute.int_tuple<"?{div=2}">
          %iter_4434 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4435, %e1_4436 = cute.get_leaves(%iter_4434) : !cute.int_tuple<"(?,?{div=2})">
          %1522 = cute.get_scalars(%e0_4435) : !cute.int_tuple<"?">
          %1523 = cute.get_scalars(%e1_4436) : !cute.int_tuple<"?{div=2}">
          %iter_4437 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4438, %e1_4439 = cute.get_leaves(%iter_4437) : !cute.int_tuple<"(?,?{div=2})">
          %1524 = cute.get_scalars(%e0_4438) : !cute.int_tuple<"?">
          %1525 = cute.get_scalars(%e1_4439) : !cute.int_tuple<"?{div=2}">
          %coord_4440 = cute.make_coord(%e0_4423) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4441 = cute.make_coord(%e1_4439) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1526 = cute.elem_less(%coord_4440, %coord_4441) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4442 = cute.get_layout(%1511) : !memref_rmem_f32_1
          %1527 = cute.get_shape(%lay_4442) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4443, %e1_4444, %e2_4445, %e3_4446 = cute.get_leaves(%1527) : !cute.shape<"((2,2),1,8)">
          %1528 = cute.get_stride(%lay_4442) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4447, %e1_4448, %e2_4449, %e3_4450 = cute.get_leaves(%1528) : !cute.stride<"((1,2),0,4)">
          %1529 = scf.if %1526 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1511) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
            cute.memref.store(%1511, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1511) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1511 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1511) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1511) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1511 : !memref_rmem_f32_1
          }
          %iter_4451 = cute.get_iter(%1529) : !memref_rmem_f32_1
          %lay_4452 = cute.get_layout(%1529) : !memref_rmem_f32_1
          %1530 = cute.get_shape(%lay_4452) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4453, %e1_4454, %e2_4455, %e3_4456 = cute.get_leaves(%1530) : !cute.shape<"((2,2),1,8)">
          %1531 = cute.get_stride(%lay_4452) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4457, %e1_4458, %e2_4459, %e3_4460 = cute.get_leaves(%1531) : !cute.stride<"((1,2),0,4)">
          %iter_4461 = cute.get_iter(%1529) : !memref_rmem_f32_1
          %iter_4462 = cute.get_iter(%1529) : !memref_rmem_f32_1
          %coord_4463 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_4464 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4465 = cute.crd2idx(%coord_4463, %lay_4464) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_4466 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4467 = cute.add_offset(%iter_4466, %idx_4465) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4468 = cute.make_view(%tup_4467) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4469 = cute.get_iter(%view_4468) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4470, %e1_4471 = cute.get_leaves(%iter_4469) : !cute.int_tuple<"(?,?{div=2})">
          %1532 = cute.get_scalars(%e0_4470) : !cute.int_tuple<"?">
          %1533 = cute.get_scalars(%e1_4471) : !cute.int_tuple<"?{div=2}">
          %iter_4472 = cute.get_iter(%view_4468) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4473, %e1_4474 = cute.get_leaves(%iter_4472) : !cute.int_tuple<"(?,?{div=2})">
          %1534 = cute.get_scalars(%e0_4473) : !cute.int_tuple<"?">
          %1535 = cute.get_scalars(%e1_4474) : !cute.int_tuple<"?{div=2}">
          %iter_4475 = cute.get_iter(%view_4468) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4476, %e1_4477 = cute.get_leaves(%iter_4475) : !cute.int_tuple<"(?,?{div=2})">
          %1536 = cute.get_scalars(%e0_4476) : !cute.int_tuple<"?">
          %1537 = cute.get_scalars(%e1_4477) : !cute.int_tuple<"?{div=2}">
          %coord_4478 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_4479 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4480 = cute.crd2idx(%coord_4478, %lay_4479) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_4481 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4482 = cute.add_offset(%iter_4481, %idx_4480) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4483 = cute.make_view(%tup_4482) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4484 = cute.get_iter(%view_4483) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4485, %e1_4486 = cute.get_leaves(%iter_4484) : !cute.int_tuple<"(?,?{div=2})">
          %1538 = cute.get_scalars(%e0_4485) : !cute.int_tuple<"?">
          %1539 = cute.get_scalars(%e1_4486) : !cute.int_tuple<"?{div=2}">
          %iter_4487 = cute.get_iter(%view_4483) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4488, %e1_4489 = cute.get_leaves(%iter_4487) : !cute.int_tuple<"(?,?{div=2})">
          %1540 = cute.get_scalars(%e0_4488) : !cute.int_tuple<"?">
          %1541 = cute.get_scalars(%e1_4489) : !cute.int_tuple<"?{div=2}">
          %iter_4490 = cute.get_iter(%view_4483) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4491, %e1_4492 = cute.get_leaves(%iter_4490) : !cute.int_tuple<"(?,?{div=2})">
          %1542 = cute.get_scalars(%e0_4491) : !cute.int_tuple<"?">
          %1543 = cute.get_scalars(%e1_4492) : !cute.int_tuple<"?{div=2}">
          %coord_4493 = cute.make_coord(%e0_4476) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4494 = cute.make_coord(%e1_4492) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1544 = cute.elem_less(%coord_4493, %coord_4494) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4495 = cute.get_layout(%1529) : !memref_rmem_f32_1
          %1545 = cute.get_shape(%lay_4495) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4496, %e1_4497, %e2_4498, %e3_4499 = cute.get_leaves(%1545) : !cute.shape<"((2,2),1,8)">
          %1546 = cute.get_stride(%lay_4495) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4500, %e1_4501, %e2_4502, %e3_4503 = cute.get_leaves(%1546) : !cute.stride<"((1,2),0,4)">
          %1547 = scf.if %1544 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1529) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
            cute.memref.store(%1529, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1529) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1529 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1529) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1529) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1529 : !memref_rmem_f32_1
          }
          %iter_4504 = cute.get_iter(%1547) : !memref_rmem_f32_1
          %lay_4505 = cute.get_layout(%1547) : !memref_rmem_f32_1
          %1548 = cute.get_shape(%lay_4505) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4506, %e1_4507, %e2_4508, %e3_4509 = cute.get_leaves(%1548) : !cute.shape<"((2,2),1,8)">
          %1549 = cute.get_stride(%lay_4505) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4510, %e1_4511, %e2_4512, %e3_4513 = cute.get_leaves(%1549) : !cute.stride<"((1,2),0,4)">
          %iter_4514 = cute.get_iter(%1547) : !memref_rmem_f32_1
          %iter_4515 = cute.get_iter(%1547) : !memref_rmem_f32_1
          %coord_4516 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_4517 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4518 = cute.crd2idx(%coord_4516, %lay_4517) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_4519 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4520 = cute.add_offset(%iter_4519, %idx_4518) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4521 = cute.make_view(%tup_4520) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4522 = cute.get_iter(%view_4521) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4523, %e1_4524 = cute.get_leaves(%iter_4522) : !cute.int_tuple<"(?,?{div=2})">
          %1550 = cute.get_scalars(%e0_4523) : !cute.int_tuple<"?">
          %1551 = cute.get_scalars(%e1_4524) : !cute.int_tuple<"?{div=2}">
          %iter_4525 = cute.get_iter(%view_4521) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4526, %e1_4527 = cute.get_leaves(%iter_4525) : !cute.int_tuple<"(?,?{div=2})">
          %1552 = cute.get_scalars(%e0_4526) : !cute.int_tuple<"?">
          %1553 = cute.get_scalars(%e1_4527) : !cute.int_tuple<"?{div=2}">
          %iter_4528 = cute.get_iter(%view_4521) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4529, %e1_4530 = cute.get_leaves(%iter_4528) : !cute.int_tuple<"(?,?{div=2})">
          %1554 = cute.get_scalars(%e0_4529) : !cute.int_tuple<"?">
          %1555 = cute.get_scalars(%e1_4530) : !cute.int_tuple<"?{div=2}">
          %coord_4531 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_4532 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4533 = cute.crd2idx(%coord_4531, %lay_4532) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_4534 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4535 = cute.add_offset(%iter_4534, %idx_4533) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4536 = cute.make_view(%tup_4535) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4537 = cute.get_iter(%view_4536) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4538, %e1_4539 = cute.get_leaves(%iter_4537) : !cute.int_tuple<"(?,?{div=2})">
          %1556 = cute.get_scalars(%e0_4538) : !cute.int_tuple<"?">
          %1557 = cute.get_scalars(%e1_4539) : !cute.int_tuple<"?{div=2}">
          %iter_4540 = cute.get_iter(%view_4536) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4541, %e1_4542 = cute.get_leaves(%iter_4540) : !cute.int_tuple<"(?,?{div=2})">
          %1558 = cute.get_scalars(%e0_4541) : !cute.int_tuple<"?">
          %1559 = cute.get_scalars(%e1_4542) : !cute.int_tuple<"?{div=2}">
          %iter_4543 = cute.get_iter(%view_4536) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4544, %e1_4545 = cute.get_leaves(%iter_4543) : !cute.int_tuple<"(?,?{div=2})">
          %1560 = cute.get_scalars(%e0_4544) : !cute.int_tuple<"?">
          %1561 = cute.get_scalars(%e1_4545) : !cute.int_tuple<"?{div=2}">
          %coord_4546 = cute.make_coord(%e0_4529) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4547 = cute.make_coord(%e1_4545) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1562 = cute.elem_less(%coord_4546, %coord_4547) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4548 = cute.get_layout(%1547) : !memref_rmem_f32_1
          %1563 = cute.get_shape(%lay_4548) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4549, %e1_4550, %e2_4551, %e3_4552 = cute.get_leaves(%1563) : !cute.shape<"((2,2),1,8)">
          %1564 = cute.get_stride(%lay_4548) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4553, %e1_4554, %e2_4555, %e3_4556 = cute.get_leaves(%1564) : !cute.stride<"((1,2),0,4)">
          %1565 = scf.if %1562 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1547) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
            cute.memref.store(%1547, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1547) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1547 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1547) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1547) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1547 : !memref_rmem_f32_1
          }
          %iter_4557 = cute.get_iter(%1565) : !memref_rmem_f32_1
          %lay_4558 = cute.get_layout(%1565) : !memref_rmem_f32_1
          %1566 = cute.get_shape(%lay_4558) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4559, %e1_4560, %e2_4561, %e3_4562 = cute.get_leaves(%1566) : !cute.shape<"((2,2),1,8)">
          %1567 = cute.get_stride(%lay_4558) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4563, %e1_4564, %e2_4565, %e3_4566 = cute.get_leaves(%1567) : !cute.stride<"((1,2),0,4)">
          %iter_4567 = cute.get_iter(%1565) : !memref_rmem_f32_1
          %iter_4568 = cute.get_iter(%1565) : !memref_rmem_f32_1
          %coord_4569 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_4570 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4571 = cute.crd2idx(%coord_4569, %lay_4570) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_4572 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4573 = cute.add_offset(%iter_4572, %idx_4571) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4574 = cute.make_view(%tup_4573) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4575 = cute.get_iter(%view_4574) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4576, %e1_4577 = cute.get_leaves(%iter_4575) : !cute.int_tuple<"(?,?{div=2})">
          %1568 = cute.get_scalars(%e0_4576) : !cute.int_tuple<"?">
          %1569 = cute.get_scalars(%e1_4577) : !cute.int_tuple<"?{div=2}">
          %iter_4578 = cute.get_iter(%view_4574) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4579, %e1_4580 = cute.get_leaves(%iter_4578) : !cute.int_tuple<"(?,?{div=2})">
          %1570 = cute.get_scalars(%e0_4579) : !cute.int_tuple<"?">
          %1571 = cute.get_scalars(%e1_4580) : !cute.int_tuple<"?{div=2}">
          %iter_4581 = cute.get_iter(%view_4574) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4582, %e1_4583 = cute.get_leaves(%iter_4581) : !cute.int_tuple<"(?,?{div=2})">
          %1572 = cute.get_scalars(%e0_4582) : !cute.int_tuple<"?">
          %1573 = cute.get_scalars(%e1_4583) : !cute.int_tuple<"?{div=2}">
          %coord_4584 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_4585 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4586 = cute.crd2idx(%coord_4584, %lay_4585) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_4587 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4588 = cute.add_offset(%iter_4587, %idx_4586) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4589 = cute.make_view(%tup_4588) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4590 = cute.get_iter(%view_4589) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4591, %e1_4592 = cute.get_leaves(%iter_4590) : !cute.int_tuple<"(?,?{div=2})">
          %1574 = cute.get_scalars(%e0_4591) : !cute.int_tuple<"?">
          %1575 = cute.get_scalars(%e1_4592) : !cute.int_tuple<"?{div=2}">
          %iter_4593 = cute.get_iter(%view_4589) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4594, %e1_4595 = cute.get_leaves(%iter_4593) : !cute.int_tuple<"(?,?{div=2})">
          %1576 = cute.get_scalars(%e0_4594) : !cute.int_tuple<"?">
          %1577 = cute.get_scalars(%e1_4595) : !cute.int_tuple<"?{div=2}">
          %iter_4596 = cute.get_iter(%view_4589) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4597, %e1_4598 = cute.get_leaves(%iter_4596) : !cute.int_tuple<"(?,?{div=2})">
          %1578 = cute.get_scalars(%e0_4597) : !cute.int_tuple<"?">
          %1579 = cute.get_scalars(%e1_4598) : !cute.int_tuple<"?{div=2}">
          %coord_4599 = cute.make_coord(%e0_4582) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4600 = cute.make_coord(%e1_4598) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1580 = cute.elem_less(%coord_4599, %coord_4600) : !cute.coord<"?">, !cute.coord<"?{div=2}">
          %lay_4601 = cute.get_layout(%1565) : !memref_rmem_f32_1
          %1581 = cute.get_shape(%lay_4601) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4602, %e1_4603, %e2_4604, %e3_4605 = cute.get_leaves(%1581) : !cute.shape<"((2,2),1,8)">
          %1582 = cute.get_stride(%lay_4601) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4606, %e1_4607, %e2_4608, %e3_4609 = cute.get_leaves(%1582) : !cute.stride<"((1,2),0,4)">
          %1583 = scf.if %1580 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1565) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
            cute.memref.store(%1565, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1565) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1565 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1565) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1565) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1565 : !memref_rmem_f32_1
          }
          %iter_4610 = cute.get_iter(%1583) : !memref_rmem_f32_1
          %lay_4611 = cute.get_layout(%1583) : !memref_rmem_f32_1
          %1584 = cute.get_shape(%lay_4611) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4612, %e1_4613, %e2_4614, %e3_4615 = cute.get_leaves(%1584) : !cute.shape<"((2,2),1,8)">
          %1585 = cute.get_stride(%lay_4611) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4616, %e1_4617, %e2_4618, %e3_4619 = cute.get_leaves(%1585) : !cute.stride<"((1,2),0,4)">
          %iter_4620 = cute.get_iter(%1583) : !memref_rmem_f32_1
          %iter_4621 = cute.get_iter(%1583) : !memref_rmem_f32_1
          %int_tuple_4622 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4623 = cute.size(%int_tuple_4622) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4624 = cute.get_leaves(%sz_4623) : !cute.int_tuple<"1">
          %int_tuple_4625 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4626 = cute.size(%int_tuple_4625) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4627 = cute.get_leaves(%sz_4626) : !cute.int_tuple<"8">
          %coord_4628 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_4629 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4630 = cute.crd2idx(%coord_4628, %lay_4629) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_4631 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4632 = cute.add_offset(%iter_4631, %idx_4630) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4633 = cute.make_view(%tup_4632) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4634 = cute.get_iter(%view_4633) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4635, %e1_4636 = cute.get_leaves(%iter_4634) : !cute.int_tuple<"(?,?)">
          %1586 = cute.get_scalars(%e0_4635) : !cute.int_tuple<"?">
          %1587 = cute.get_scalars(%e1_4636) : !cute.int_tuple<"?">
          %iter_4637 = cute.get_iter(%view_4633) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4638, %e1_4639 = cute.get_leaves(%iter_4637) : !cute.int_tuple<"(?,?)">
          %1588 = cute.get_scalars(%e0_4638) : !cute.int_tuple<"?">
          %1589 = cute.get_scalars(%e1_4639) : !cute.int_tuple<"?">
          %iter_4640 = cute.get_iter(%view_4633) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4641, %e1_4642 = cute.get_leaves(%iter_4640) : !cute.int_tuple<"(?,?)">
          %1590 = cute.get_scalars(%e0_4641) : !cute.int_tuple<"?">
          %1591 = cute.get_scalars(%e1_4642) : !cute.int_tuple<"?">
          %coord_4643 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_4644 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4645 = cute.crd2idx(%coord_4643, %lay_4644) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_4646 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4647 = cute.add_offset(%iter_4646, %idx_4645) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4648 = cute.make_view(%tup_4647) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4649 = cute.get_iter(%view_4648) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4650, %e1_4651 = cute.get_leaves(%iter_4649) : !cute.int_tuple<"(?,?)">
          %1592 = cute.get_scalars(%e0_4650) : !cute.int_tuple<"?">
          %1593 = cute.get_scalars(%e1_4651) : !cute.int_tuple<"?">
          %iter_4652 = cute.get_iter(%view_4648) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4653, %e1_4654 = cute.get_leaves(%iter_4652) : !cute.int_tuple<"(?,?)">
          %1594 = cute.get_scalars(%e0_4653) : !cute.int_tuple<"?">
          %1595 = cute.get_scalars(%e1_4654) : !cute.int_tuple<"?">
          %iter_4655 = cute.get_iter(%view_4648) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4656, %e1_4657 = cute.get_leaves(%iter_4655) : !cute.int_tuple<"(?,?)">
          %1596 = cute.get_scalars(%e0_4656) : !cute.int_tuple<"?">
          %1597 = cute.get_scalars(%e1_4657) : !cute.int_tuple<"?">
          %coord_4658 = cute.make_coord(%e0_4641) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4659 = cute.make_coord(%e1_4657) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1598 = cute.elem_less(%coord_4658, %coord_4659) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4660 = cute.get_layout(%1583) : !memref_rmem_f32_1
          %1599 = cute.get_shape(%lay_4660) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4661, %e1_4662, %e2_4663, %e3_4664 = cute.get_leaves(%1599) : !cute.shape<"((2,2),1,8)">
          %1600 = cute.get_stride(%lay_4660) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4665, %e1_4666, %e2_4667, %e3_4668 = cute.get_leaves(%1600) : !cute.stride<"((1,2),0,4)">
          %1601 = scf.if %1598 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1583) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
            cute.memref.store(%1583, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1583) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1583 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1583) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1583) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1583 : !memref_rmem_f32_1
          }
          %iter_4669 = cute.get_iter(%1601) : !memref_rmem_f32_1
          %lay_4670 = cute.get_layout(%1601) : !memref_rmem_f32_1
          %1602 = cute.get_shape(%lay_4670) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4671, %e1_4672, %e2_4673, %e3_4674 = cute.get_leaves(%1602) : !cute.shape<"((2,2),1,8)">
          %1603 = cute.get_stride(%lay_4670) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4675, %e1_4676, %e2_4677, %e3_4678 = cute.get_leaves(%1603) : !cute.stride<"((1,2),0,4)">
          %iter_4679 = cute.get_iter(%1601) : !memref_rmem_f32_1
          %iter_4680 = cute.get_iter(%1601) : !memref_rmem_f32_1
          %coord_4681 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_4682 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4683 = cute.crd2idx(%coord_4681, %lay_4682) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_4684 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4685 = cute.add_offset(%iter_4684, %idx_4683) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4686 = cute.make_view(%tup_4685) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4687 = cute.get_iter(%view_4686) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4688, %e1_4689 = cute.get_leaves(%iter_4687) : !cute.int_tuple<"(?,?)">
          %1604 = cute.get_scalars(%e0_4688) : !cute.int_tuple<"?">
          %1605 = cute.get_scalars(%e1_4689) : !cute.int_tuple<"?">
          %iter_4690 = cute.get_iter(%view_4686) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4691, %e1_4692 = cute.get_leaves(%iter_4690) : !cute.int_tuple<"(?,?)">
          %1606 = cute.get_scalars(%e0_4691) : !cute.int_tuple<"?">
          %1607 = cute.get_scalars(%e1_4692) : !cute.int_tuple<"?">
          %iter_4693 = cute.get_iter(%view_4686) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4694, %e1_4695 = cute.get_leaves(%iter_4693) : !cute.int_tuple<"(?,?)">
          %1608 = cute.get_scalars(%e0_4694) : !cute.int_tuple<"?">
          %1609 = cute.get_scalars(%e1_4695) : !cute.int_tuple<"?">
          %coord_4696 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_4697 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4698 = cute.crd2idx(%coord_4696, %lay_4697) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_4699 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4700 = cute.add_offset(%iter_4699, %idx_4698) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4701 = cute.make_view(%tup_4700) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4702 = cute.get_iter(%view_4701) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4703, %e1_4704 = cute.get_leaves(%iter_4702) : !cute.int_tuple<"(?,?)">
          %1610 = cute.get_scalars(%e0_4703) : !cute.int_tuple<"?">
          %1611 = cute.get_scalars(%e1_4704) : !cute.int_tuple<"?">
          %iter_4705 = cute.get_iter(%view_4701) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4706, %e1_4707 = cute.get_leaves(%iter_4705) : !cute.int_tuple<"(?,?)">
          %1612 = cute.get_scalars(%e0_4706) : !cute.int_tuple<"?">
          %1613 = cute.get_scalars(%e1_4707) : !cute.int_tuple<"?">
          %iter_4708 = cute.get_iter(%view_4701) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4709, %e1_4710 = cute.get_leaves(%iter_4708) : !cute.int_tuple<"(?,?)">
          %1614 = cute.get_scalars(%e0_4709) : !cute.int_tuple<"?">
          %1615 = cute.get_scalars(%e1_4710) : !cute.int_tuple<"?">
          %coord_4711 = cute.make_coord(%e0_4694) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4712 = cute.make_coord(%e1_4710) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1616 = cute.elem_less(%coord_4711, %coord_4712) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4713 = cute.get_layout(%1601) : !memref_rmem_f32_1
          %1617 = cute.get_shape(%lay_4713) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4714, %e1_4715, %e2_4716, %e3_4717 = cute.get_leaves(%1617) : !cute.shape<"((2,2),1,8)">
          %1618 = cute.get_stride(%lay_4713) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4718, %e1_4719, %e2_4720, %e3_4721 = cute.get_leaves(%1618) : !cute.stride<"((1,2),0,4)">
          %1619 = scf.if %1616 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1601) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
            cute.memref.store(%1601, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1601) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1601 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1601) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1601) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1601 : !memref_rmem_f32_1
          }
          %iter_4722 = cute.get_iter(%1619) : !memref_rmem_f32_1
          %lay_4723 = cute.get_layout(%1619) : !memref_rmem_f32_1
          %1620 = cute.get_shape(%lay_4723) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4724, %e1_4725, %e2_4726, %e3_4727 = cute.get_leaves(%1620) : !cute.shape<"((2,2),1,8)">
          %1621 = cute.get_stride(%lay_4723) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4728, %e1_4729, %e2_4730, %e3_4731 = cute.get_leaves(%1621) : !cute.stride<"((1,2),0,4)">
          %iter_4732 = cute.get_iter(%1619) : !memref_rmem_f32_1
          %iter_4733 = cute.get_iter(%1619) : !memref_rmem_f32_1
          %coord_4734 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_4735 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4736 = cute.crd2idx(%coord_4734, %lay_4735) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_4737 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4738 = cute.add_offset(%iter_4737, %idx_4736) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4739 = cute.make_view(%tup_4738) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4740 = cute.get_iter(%view_4739) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4741, %e1_4742 = cute.get_leaves(%iter_4740) : !cute.int_tuple<"(?,?)">
          %1622 = cute.get_scalars(%e0_4741) : !cute.int_tuple<"?">
          %1623 = cute.get_scalars(%e1_4742) : !cute.int_tuple<"?">
          %iter_4743 = cute.get_iter(%view_4739) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4744, %e1_4745 = cute.get_leaves(%iter_4743) : !cute.int_tuple<"(?,?)">
          %1624 = cute.get_scalars(%e0_4744) : !cute.int_tuple<"?">
          %1625 = cute.get_scalars(%e1_4745) : !cute.int_tuple<"?">
          %iter_4746 = cute.get_iter(%view_4739) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4747, %e1_4748 = cute.get_leaves(%iter_4746) : !cute.int_tuple<"(?,?)">
          %1626 = cute.get_scalars(%e0_4747) : !cute.int_tuple<"?">
          %1627 = cute.get_scalars(%e1_4748) : !cute.int_tuple<"?">
          %coord_4749 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_4750 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4751 = cute.crd2idx(%coord_4749, %lay_4750) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_4752 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4753 = cute.add_offset(%iter_4752, %idx_4751) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4754 = cute.make_view(%tup_4753) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4755 = cute.get_iter(%view_4754) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4756, %e1_4757 = cute.get_leaves(%iter_4755) : !cute.int_tuple<"(?,?)">
          %1628 = cute.get_scalars(%e0_4756) : !cute.int_tuple<"?">
          %1629 = cute.get_scalars(%e1_4757) : !cute.int_tuple<"?">
          %iter_4758 = cute.get_iter(%view_4754) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4759, %e1_4760 = cute.get_leaves(%iter_4758) : !cute.int_tuple<"(?,?)">
          %1630 = cute.get_scalars(%e0_4759) : !cute.int_tuple<"?">
          %1631 = cute.get_scalars(%e1_4760) : !cute.int_tuple<"?">
          %iter_4761 = cute.get_iter(%view_4754) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4762, %e1_4763 = cute.get_leaves(%iter_4761) : !cute.int_tuple<"(?,?)">
          %1632 = cute.get_scalars(%e0_4762) : !cute.int_tuple<"?">
          %1633 = cute.get_scalars(%e1_4763) : !cute.int_tuple<"?">
          %coord_4764 = cute.make_coord(%e0_4747) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4765 = cute.make_coord(%e1_4763) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1634 = cute.elem_less(%coord_4764, %coord_4765) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4766 = cute.get_layout(%1619) : !memref_rmem_f32_1
          %1635 = cute.get_shape(%lay_4766) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4767, %e1_4768, %e2_4769, %e3_4770 = cute.get_leaves(%1635) : !cute.shape<"((2,2),1,8)">
          %1636 = cute.get_stride(%lay_4766) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4771, %e1_4772, %e2_4773, %e3_4774 = cute.get_leaves(%1636) : !cute.stride<"((1,2),0,4)">
          %1637 = scf.if %1634 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1619) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
            cute.memref.store(%1619, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1619) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1619 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1619) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1619) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1619 : !memref_rmem_f32_1
          }
          %iter_4775 = cute.get_iter(%1637) : !memref_rmem_f32_1
          %lay_4776 = cute.get_layout(%1637) : !memref_rmem_f32_1
          %1638 = cute.get_shape(%lay_4776) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4777, %e1_4778, %e2_4779, %e3_4780 = cute.get_leaves(%1638) : !cute.shape<"((2,2),1,8)">
          %1639 = cute.get_stride(%lay_4776) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4781, %e1_4782, %e2_4783, %e3_4784 = cute.get_leaves(%1639) : !cute.stride<"((1,2),0,4)">
          %iter_4785 = cute.get_iter(%1637) : !memref_rmem_f32_1
          %iter_4786 = cute.get_iter(%1637) : !memref_rmem_f32_1
          %coord_4787 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_4788 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4789 = cute.crd2idx(%coord_4787, %lay_4788) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_4790 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4791 = cute.add_offset(%iter_4790, %idx_4789) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4792 = cute.make_view(%tup_4791) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4793 = cute.get_iter(%view_4792) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4794, %e1_4795 = cute.get_leaves(%iter_4793) : !cute.int_tuple<"(?,?)">
          %1640 = cute.get_scalars(%e0_4794) : !cute.int_tuple<"?">
          %1641 = cute.get_scalars(%e1_4795) : !cute.int_tuple<"?">
          %iter_4796 = cute.get_iter(%view_4792) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4797, %e1_4798 = cute.get_leaves(%iter_4796) : !cute.int_tuple<"(?,?)">
          %1642 = cute.get_scalars(%e0_4797) : !cute.int_tuple<"?">
          %1643 = cute.get_scalars(%e1_4798) : !cute.int_tuple<"?">
          %iter_4799 = cute.get_iter(%view_4792) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4800, %e1_4801 = cute.get_leaves(%iter_4799) : !cute.int_tuple<"(?,?)">
          %1644 = cute.get_scalars(%e0_4800) : !cute.int_tuple<"?">
          %1645 = cute.get_scalars(%e1_4801) : !cute.int_tuple<"?">
          %coord_4802 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_4803 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4804 = cute.crd2idx(%coord_4802, %lay_4803) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_4805 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4806 = cute.add_offset(%iter_4805, %idx_4804) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4807 = cute.make_view(%tup_4806) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4808 = cute.get_iter(%view_4807) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4809, %e1_4810 = cute.get_leaves(%iter_4808) : !cute.int_tuple<"(?,?)">
          %1646 = cute.get_scalars(%e0_4809) : !cute.int_tuple<"?">
          %1647 = cute.get_scalars(%e1_4810) : !cute.int_tuple<"?">
          %iter_4811 = cute.get_iter(%view_4807) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4812, %e1_4813 = cute.get_leaves(%iter_4811) : !cute.int_tuple<"(?,?)">
          %1648 = cute.get_scalars(%e0_4812) : !cute.int_tuple<"?">
          %1649 = cute.get_scalars(%e1_4813) : !cute.int_tuple<"?">
          %iter_4814 = cute.get_iter(%view_4807) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4815, %e1_4816 = cute.get_leaves(%iter_4814) : !cute.int_tuple<"(?,?)">
          %1650 = cute.get_scalars(%e0_4815) : !cute.int_tuple<"?">
          %1651 = cute.get_scalars(%e1_4816) : !cute.int_tuple<"?">
          %coord_4817 = cute.make_coord(%e0_4800) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4818 = cute.make_coord(%e1_4816) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1652 = cute.elem_less(%coord_4817, %coord_4818) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4819 = cute.get_layout(%1637) : !memref_rmem_f32_1
          %1653 = cute.get_shape(%lay_4819) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4820, %e1_4821, %e2_4822, %e3_4823 = cute.get_leaves(%1653) : !cute.shape<"((2,2),1,8)">
          %1654 = cute.get_stride(%lay_4819) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4824, %e1_4825, %e2_4826, %e3_4827 = cute.get_leaves(%1654) : !cute.stride<"((1,2),0,4)">
          %1655 = scf.if %1652 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1637) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
            cute.memref.store(%1637, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1637) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1637 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1637) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1637) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1637 : !memref_rmem_f32_1
          }
          %iter_4828 = cute.get_iter(%1655) : !memref_rmem_f32_1
          %lay_4829 = cute.get_layout(%1655) : !memref_rmem_f32_1
          %1656 = cute.get_shape(%lay_4829) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4830, %e1_4831, %e2_4832, %e3_4833 = cute.get_leaves(%1656) : !cute.shape<"((2,2),1,8)">
          %1657 = cute.get_stride(%lay_4829) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4834, %e1_4835, %e2_4836, %e3_4837 = cute.get_leaves(%1657) : !cute.stride<"((1,2),0,4)">
          %iter_4838 = cute.get_iter(%1655) : !memref_rmem_f32_1
          %iter_4839 = cute.get_iter(%1655) : !memref_rmem_f32_1
          %coord_4840 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_4841 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4842 = cute.crd2idx(%coord_4840, %lay_4841) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_4843 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4844 = cute.add_offset(%iter_4843, %idx_4842) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4845 = cute.make_view(%tup_4844) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4846 = cute.get_iter(%view_4845) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4847, %e1_4848 = cute.get_leaves(%iter_4846) : !cute.int_tuple<"(?,?)">
          %1658 = cute.get_scalars(%e0_4847) : !cute.int_tuple<"?">
          %1659 = cute.get_scalars(%e1_4848) : !cute.int_tuple<"?">
          %iter_4849 = cute.get_iter(%view_4845) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4850, %e1_4851 = cute.get_leaves(%iter_4849) : !cute.int_tuple<"(?,?)">
          %1660 = cute.get_scalars(%e0_4850) : !cute.int_tuple<"?">
          %1661 = cute.get_scalars(%e1_4851) : !cute.int_tuple<"?">
          %iter_4852 = cute.get_iter(%view_4845) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4853, %e1_4854 = cute.get_leaves(%iter_4852) : !cute.int_tuple<"(?,?)">
          %1662 = cute.get_scalars(%e0_4853) : !cute.int_tuple<"?">
          %1663 = cute.get_scalars(%e1_4854) : !cute.int_tuple<"?">
          %coord_4855 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_4856 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4857 = cute.crd2idx(%coord_4855, %lay_4856) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_4858 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4859 = cute.add_offset(%iter_4858, %idx_4857) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4860 = cute.make_view(%tup_4859) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4861 = cute.get_iter(%view_4860) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4862, %e1_4863 = cute.get_leaves(%iter_4861) : !cute.int_tuple<"(?,?)">
          %1664 = cute.get_scalars(%e0_4862) : !cute.int_tuple<"?">
          %1665 = cute.get_scalars(%e1_4863) : !cute.int_tuple<"?">
          %iter_4864 = cute.get_iter(%view_4860) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4865, %e1_4866 = cute.get_leaves(%iter_4864) : !cute.int_tuple<"(?,?)">
          %1666 = cute.get_scalars(%e0_4865) : !cute.int_tuple<"?">
          %1667 = cute.get_scalars(%e1_4866) : !cute.int_tuple<"?">
          %iter_4867 = cute.get_iter(%view_4860) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4868, %e1_4869 = cute.get_leaves(%iter_4867) : !cute.int_tuple<"(?,?)">
          %1668 = cute.get_scalars(%e0_4868) : !cute.int_tuple<"?">
          %1669 = cute.get_scalars(%e1_4869) : !cute.int_tuple<"?">
          %coord_4870 = cute.make_coord(%e0_4853) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4871 = cute.make_coord(%e1_4869) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1670 = cute.elem_less(%coord_4870, %coord_4871) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4872 = cute.get_layout(%1655) : !memref_rmem_f32_1
          %1671 = cute.get_shape(%lay_4872) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4873, %e1_4874, %e2_4875, %e3_4876 = cute.get_leaves(%1671) : !cute.shape<"((2,2),1,8)">
          %1672 = cute.get_stride(%lay_4872) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4877, %e1_4878, %e2_4879, %e3_4880 = cute.get_leaves(%1672) : !cute.stride<"((1,2),0,4)">
          %1673 = scf.if %1670 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1655) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
            cute.memref.store(%1655, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1655) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1655 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1655) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1655) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1655 : !memref_rmem_f32_1
          }
          %iter_4881 = cute.get_iter(%1673) : !memref_rmem_f32_1
          %lay_4882 = cute.get_layout(%1673) : !memref_rmem_f32_1
          %1674 = cute.get_shape(%lay_4882) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4883, %e1_4884, %e2_4885, %e3_4886 = cute.get_leaves(%1674) : !cute.shape<"((2,2),1,8)">
          %1675 = cute.get_stride(%lay_4882) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4887, %e1_4888, %e2_4889, %e3_4890 = cute.get_leaves(%1675) : !cute.stride<"((1,2),0,4)">
          %iter_4891 = cute.get_iter(%1673) : !memref_rmem_f32_1
          %iter_4892 = cute.get_iter(%1673) : !memref_rmem_f32_1
          %coord_4893 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_4894 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4895 = cute.crd2idx(%coord_4893, %lay_4894) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_4896 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4897 = cute.add_offset(%iter_4896, %idx_4895) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4898 = cute.make_view(%tup_4897) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4899 = cute.get_iter(%view_4898) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4900, %e1_4901 = cute.get_leaves(%iter_4899) : !cute.int_tuple<"(?,?)">
          %1676 = cute.get_scalars(%e0_4900) : !cute.int_tuple<"?">
          %1677 = cute.get_scalars(%e1_4901) : !cute.int_tuple<"?">
          %iter_4902 = cute.get_iter(%view_4898) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4903, %e1_4904 = cute.get_leaves(%iter_4902) : !cute.int_tuple<"(?,?)">
          %1678 = cute.get_scalars(%e0_4903) : !cute.int_tuple<"?">
          %1679 = cute.get_scalars(%e1_4904) : !cute.int_tuple<"?">
          %iter_4905 = cute.get_iter(%view_4898) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4906, %e1_4907 = cute.get_leaves(%iter_4905) : !cute.int_tuple<"(?,?)">
          %1680 = cute.get_scalars(%e0_4906) : !cute.int_tuple<"?">
          %1681 = cute.get_scalars(%e1_4907) : !cute.int_tuple<"?">
          %coord_4908 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_4909 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4910 = cute.crd2idx(%coord_4908, %lay_4909) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_4911 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4912 = cute.add_offset(%iter_4911, %idx_4910) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4913 = cute.make_view(%tup_4912) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4914 = cute.get_iter(%view_4913) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4915, %e1_4916 = cute.get_leaves(%iter_4914) : !cute.int_tuple<"(?,?)">
          %1682 = cute.get_scalars(%e0_4915) : !cute.int_tuple<"?">
          %1683 = cute.get_scalars(%e1_4916) : !cute.int_tuple<"?">
          %iter_4917 = cute.get_iter(%view_4913) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4918, %e1_4919 = cute.get_leaves(%iter_4917) : !cute.int_tuple<"(?,?)">
          %1684 = cute.get_scalars(%e0_4918) : !cute.int_tuple<"?">
          %1685 = cute.get_scalars(%e1_4919) : !cute.int_tuple<"?">
          %iter_4920 = cute.get_iter(%view_4913) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4921, %e1_4922 = cute.get_leaves(%iter_4920) : !cute.int_tuple<"(?,?)">
          %1686 = cute.get_scalars(%e0_4921) : !cute.int_tuple<"?">
          %1687 = cute.get_scalars(%e1_4922) : !cute.int_tuple<"?">
          %coord_4923 = cute.make_coord(%e0_4906) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4924 = cute.make_coord(%e1_4922) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1688 = cute.elem_less(%coord_4923, %coord_4924) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4925 = cute.get_layout(%1673) : !memref_rmem_f32_1
          %1689 = cute.get_shape(%lay_4925) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4926, %e1_4927, %e2_4928, %e3_4929 = cute.get_leaves(%1689) : !cute.shape<"((2,2),1,8)">
          %1690 = cute.get_stride(%lay_4925) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4930, %e1_4931, %e2_4932, %e3_4933 = cute.get_leaves(%1690) : !cute.stride<"((1,2),0,4)">
          %1691 = scf.if %1688 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1673) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
            cute.memref.store(%1673, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1673) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1673 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1673) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1673) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1673 : !memref_rmem_f32_1
          }
          %iter_4934 = cute.get_iter(%1691) : !memref_rmem_f32_1
          %lay_4935 = cute.get_layout(%1691) : !memref_rmem_f32_1
          %1692 = cute.get_shape(%lay_4935) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4936, %e1_4937, %e2_4938, %e3_4939 = cute.get_leaves(%1692) : !cute.shape<"((2,2),1,8)">
          %1693 = cute.get_stride(%lay_4935) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4940, %e1_4941, %e2_4942, %e3_4943 = cute.get_leaves(%1693) : !cute.stride<"((1,2),0,4)">
          %iter_4944 = cute.get_iter(%1691) : !memref_rmem_f32_1
          %iter_4945 = cute.get_iter(%1691) : !memref_rmem_f32_1
          %coord_4946 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_4947 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4948 = cute.crd2idx(%coord_4946, %lay_4947) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_4949 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4950 = cute.add_offset(%iter_4949, %idx_4948) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4951 = cute.make_view(%tup_4950) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4952 = cute.get_iter(%view_4951) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4953, %e1_4954 = cute.get_leaves(%iter_4952) : !cute.int_tuple<"(?,?)">
          %1694 = cute.get_scalars(%e0_4953) : !cute.int_tuple<"?">
          %1695 = cute.get_scalars(%e1_4954) : !cute.int_tuple<"?">
          %iter_4955 = cute.get_iter(%view_4951) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4956, %e1_4957 = cute.get_leaves(%iter_4955) : !cute.int_tuple<"(?,?)">
          %1696 = cute.get_scalars(%e0_4956) : !cute.int_tuple<"?">
          %1697 = cute.get_scalars(%e1_4957) : !cute.int_tuple<"?">
          %iter_4958 = cute.get_iter(%view_4951) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4959, %e1_4960 = cute.get_leaves(%iter_4958) : !cute.int_tuple<"(?,?)">
          %1698 = cute.get_scalars(%e0_4959) : !cute.int_tuple<"?">
          %1699 = cute.get_scalars(%e1_4960) : !cute.int_tuple<"?">
          %coord_4961 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_4962 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4963 = cute.crd2idx(%coord_4961, %lay_4962) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_4964 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4965 = cute.add_offset(%iter_4964, %idx_4963) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4966 = cute.make_view(%tup_4965) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4967 = cute.get_iter(%view_4966) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4968, %e1_4969 = cute.get_leaves(%iter_4967) : !cute.int_tuple<"(?,?)">
          %1700 = cute.get_scalars(%e0_4968) : !cute.int_tuple<"?">
          %1701 = cute.get_scalars(%e1_4969) : !cute.int_tuple<"?">
          %iter_4970 = cute.get_iter(%view_4966) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4971, %e1_4972 = cute.get_leaves(%iter_4970) : !cute.int_tuple<"(?,?)">
          %1702 = cute.get_scalars(%e0_4971) : !cute.int_tuple<"?">
          %1703 = cute.get_scalars(%e1_4972) : !cute.int_tuple<"?">
          %iter_4973 = cute.get_iter(%view_4966) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4974, %e1_4975 = cute.get_leaves(%iter_4973) : !cute.int_tuple<"(?,?)">
          %1704 = cute.get_scalars(%e0_4974) : !cute.int_tuple<"?">
          %1705 = cute.get_scalars(%e1_4975) : !cute.int_tuple<"?">
          %coord_4976 = cute.make_coord(%e0_4959) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4977 = cute.make_coord(%e1_4975) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1706 = cute.elem_less(%coord_4976, %coord_4977) : !cute.coord<"?">, !cute.coord<"?">
          %lay_4978 = cute.get_layout(%1691) : !memref_rmem_f32_1
          %1707 = cute.get_shape(%lay_4978) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4979, %e1_4980, %e2_4981, %e3_4982 = cute.get_leaves(%1707) : !cute.shape<"((2,2),1,8)">
          %1708 = cute.get_stride(%lay_4978) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4983, %e1_4984, %e2_4985, %e3_4986 = cute.get_leaves(%1708) : !cute.stride<"((1,2),0,4)">
          %1709 = scf.if %1706 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1691) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
            cute.memref.store(%1691, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1691) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1691 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1691) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1691) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1691 : !memref_rmem_f32_1
          }
          %iter_4987 = cute.get_iter(%1709) : !memref_rmem_f32_1
          %lay_4988 = cute.get_layout(%1709) : !memref_rmem_f32_1
          %1710 = cute.get_shape(%lay_4988) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4989, %e1_4990, %e2_4991, %e3_4992 = cute.get_leaves(%1710) : !cute.shape<"((2,2),1,8)">
          %1711 = cute.get_stride(%lay_4988) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4993, %e1_4994, %e2_4995, %e3_4996 = cute.get_leaves(%1711) : !cute.stride<"((1,2),0,4)">
          %iter_4997 = cute.get_iter(%1709) : !memref_rmem_f32_1
          %iter_4998 = cute.get_iter(%1709) : !memref_rmem_f32_1
          %coord_4999 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_5000 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5001 = cute.crd2idx(%coord_4999, %lay_5000) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_5002 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5003 = cute.add_offset(%iter_5002, %idx_5001) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_5004 = cute.make_view(%tup_5003) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5005 = cute.get_iter(%view_5004) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5006, %e1_5007 = cute.get_leaves(%iter_5005) : !cute.int_tuple<"(?,?)">
          %1712 = cute.get_scalars(%e0_5006) : !cute.int_tuple<"?">
          %1713 = cute.get_scalars(%e1_5007) : !cute.int_tuple<"?">
          %iter_5008 = cute.get_iter(%view_5004) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5009, %e1_5010 = cute.get_leaves(%iter_5008) : !cute.int_tuple<"(?,?)">
          %1714 = cute.get_scalars(%e0_5009) : !cute.int_tuple<"?">
          %1715 = cute.get_scalars(%e1_5010) : !cute.int_tuple<"?">
          %iter_5011 = cute.get_iter(%view_5004) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5012, %e1_5013 = cute.get_leaves(%iter_5011) : !cute.int_tuple<"(?,?)">
          %1716 = cute.get_scalars(%e0_5012) : !cute.int_tuple<"?">
          %1717 = cute.get_scalars(%e1_5013) : !cute.int_tuple<"?">
          %coord_5014 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_5015 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5016 = cute.crd2idx(%coord_5014, %lay_5015) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_5017 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5018 = cute.add_offset(%iter_5017, %idx_5016) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_5019 = cute.make_view(%tup_5018) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5020 = cute.get_iter(%view_5019) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5021, %e1_5022 = cute.get_leaves(%iter_5020) : !cute.int_tuple<"(?,?)">
          %1718 = cute.get_scalars(%e0_5021) : !cute.int_tuple<"?">
          %1719 = cute.get_scalars(%e1_5022) : !cute.int_tuple<"?">
          %iter_5023 = cute.get_iter(%view_5019) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5024, %e1_5025 = cute.get_leaves(%iter_5023) : !cute.int_tuple<"(?,?)">
          %1720 = cute.get_scalars(%e0_5024) : !cute.int_tuple<"?">
          %1721 = cute.get_scalars(%e1_5025) : !cute.int_tuple<"?">
          %iter_5026 = cute.get_iter(%view_5019) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5027, %e1_5028 = cute.get_leaves(%iter_5026) : !cute.int_tuple<"(?,?)">
          %1722 = cute.get_scalars(%e0_5027) : !cute.int_tuple<"?">
          %1723 = cute.get_scalars(%e1_5028) : !cute.int_tuple<"?">
          %coord_5029 = cute.make_coord(%e0_5012) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5030 = cute.make_coord(%e1_5028) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1724 = cute.elem_less(%coord_5029, %coord_5030) : !cute.coord<"?">, !cute.coord<"?">
          %lay_5031 = cute.get_layout(%1709) : !memref_rmem_f32_1
          %1725 = cute.get_shape(%lay_5031) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5032, %e1_5033, %e2_5034, %e3_5035 = cute.get_leaves(%1725) : !cute.shape<"((2,2),1,8)">
          %1726 = cute.get_stride(%lay_5031) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5036, %e1_5037, %e2_5038, %e3_5039 = cute.get_leaves(%1726) : !cute.stride<"((1,2),0,4)">
          %1727 = scf.if %1724 -> (!memref_rmem_f32_1) {
            %iter_5109 = cute.get_iter(%1709) : !memref_rmem_f32_1
            %cst_5110 = arith.constant 0.000000e+00 : f32
            %coord_5111 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
            cute.memref.store(%1709, %coord_5111, %cst_5110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
            %lay_5112 = cute.get_layout(%1709) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1709 : !memref_rmem_f32_1
          } else {
            %iter_5109 = cute.get_iter(%1709) : !memref_rmem_f32_1
            %lay_5110 = cute.get_layout(%1709) : !memref_rmem_f32_1
            %1755 = cute.get_shape(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5111, %e1_5112, %e2_5113, %e3_5114 = cute.get_leaves(%1755) : !cute.shape<"((2,2),1,8)">
            %1756 = cute.get_stride(%lay_5110) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1756) : !cute.stride<"((1,2),0,4)">
            scf.yield %1709 : !memref_rmem_f32_1
          }
          %iter_5040 = cute.get_iter(%1727) : !memref_rmem_f32_1
          %lay_5041 = cute.get_layout(%1727) : !memref_rmem_f32_1
          %1728 = cute.get_shape(%lay_5041) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5042, %e1_5043, %e2_5044, %e3_5045 = cute.get_leaves(%1728) : !cute.shape<"((2,2),1,8)">
          %1729 = cute.get_stride(%lay_5041) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5046, %e1_5047, %e2_5048, %e3_5049 = cute.get_leaves(%1729) : !cute.stride<"((1,2),0,4)">
          %iter_5050 = cute.get_iter(%1727) : !memref_rmem_f32_1
          %iter_5051 = cute.get_iter(%1727) : !memref_rmem_f32_1
          %lay_5052 = cute.get_layout(%1727) : !memref_rmem_f32_1
          %1730 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1730) : !cute.shape<"((2,2),1,8)">
          %1731 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1731) : !cute.stride<"((1,2),0,4)">
          %1732 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %1733 = cute.get_shape(%1732) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_5061, %e1_5062, %e2_5063, %e3_5064 = cute.get_leaves(%1733) : !cute.shape<"(32,4,1,1)">
          %1734 = cute.get_stride(%1732) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_5065, %e1_5066, %e2_5067, %e3_5068 = cute.get_leaves(%1734) : !cute.stride<"(1,32,0,0)">
          %1735 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_5069, %e1_5070, %e2_5071 = cute.get_leaves(%1735) : !cute.tile<"[64:1;16:1;16:1]">
          %1736 = cute.get_shape(%e0_5069) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_5072 = cute.get_leaves(%1736) : !cute.shape<"64">
          %1737 = cute.get_stride(%e0_5069) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_5073 = cute.get_leaves(%1737) : !cute.stride<"1">
          %1738 = cute.get_shape(%e1_5070) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5074 = cute.get_leaves(%1738) : !cute.shape<"16">
          %1739 = cute.get_stride(%e1_5070) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5075 = cute.get_leaves(%1739) : !cute.stride<"1">
          %1740 = cute.get_shape(%e2_5071) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5076 = cute.get_leaves(%1740) : !cute.shape<"16">
          %1741 = cute.get_stride(%e2_5071) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5077 = cute.get_leaves(%1741) : !cute.stride<"1">
          %1742 = cute.static : !cute.layout<"32:1">
          %1743 = cute.get_shape(%1742) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_5078 = cute.get_leaves(%1743) : !cute.shape<"32">
          %1744 = cute.get_stride(%1742) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_5079 = cute.get_leaves(%1744) : !cute.stride<"1">
          %1745 = cute.static : !cute.shape<"(16,8,16)">
          %e0_5080, %e1_5081, %e2_5082 = cute.get_leaves(%1745) : !cute.shape<"(16,8,16)">
          %1746 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %1747 = cute.get_shape(%1746) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_5083, %e1_5084, %e2_5085, %e3_5086, %e4_5087 = cute.get_leaves(%1747) : !cute.shape<"((4,8),(2,2,2))">
          %1748 = cute.get_stride(%1746) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_5088, %e1_5089, %e2_5090, %e3_5091, %e4_5092 = cute.get_leaves(%1748) : !cute.stride<"((32,1),(16,8,128))">
          %1749 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %1750 = cute.get_shape(%1749) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5093, %e1_5094, %e2_5095, %e3_5096 = cute.get_leaves(%1750) : !cute.shape<"((4,8),(2,2))">
          %1751 = cute.get_stride(%1749) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_5097, %e1_5098, %e2_5099, %e3_5100 = cute.get_leaves(%1751) : !cute.stride<"((16,1),(8,64))">
          %1752 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %1753 = cute.get_shape(%1752) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5101, %e1_5102, %e2_5103, %e3_5104 = cute.get_leaves(%1753) : !cute.shape<"((4,8),(2,2))">
          %1754 = cute.get_stride(%1752) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_5105, %e1_5106, %e2_5107, %e3_5108 = cute.get_leaves(%1754) : !cute.stride<"((32,1),(16,8))">
          scf.yield %1727, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        } else {
          %iter_3319 = cute.get_iter(%1014) : !memref_rmem_f32_1
          %lay_3320 = cute.get_layout(%1014) : !memref_rmem_f32_1
          %1151 = cute.get_shape(%lay_3320) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3321, %e1_3322, %e2_3323, %e3_3324 = cute.get_leaves(%1151) : !cute.shape<"((2,2),1,8)">
          %1152 = cute.get_stride(%lay_3320) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3325, %e1_3326, %e2_3327, %e3_3328 = cute.get_leaves(%1152) : !cute.stride<"((1,2),0,4)">
          %1153 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %1154 = cute.get_shape(%1153) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_3329, %e1_3330, %e2_3331, %e3_3332 = cute.get_leaves(%1154) : !cute.shape<"(32,4,1,1)">
          %1155 = cute.get_stride(%1153) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_3333, %e1_3334, %e2_3335, %e3_3336 = cute.get_leaves(%1155) : !cute.stride<"(1,32,0,0)">
          %1156 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_3337, %e1_3338, %e2_3339 = cute.get_leaves(%1156) : !cute.tile<"[64:1;16:1;16:1]">
          %1157 = cute.get_shape(%e0_3337) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_3340 = cute.get_leaves(%1157) : !cute.shape<"64">
          %1158 = cute.get_stride(%e0_3337) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_3341 = cute.get_leaves(%1158) : !cute.stride<"1">
          %1159 = cute.get_shape(%e1_3338) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_3342 = cute.get_leaves(%1159) : !cute.shape<"16">
          %1160 = cute.get_stride(%e1_3338) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_3343 = cute.get_leaves(%1160) : !cute.stride<"1">
          %1161 = cute.get_shape(%e2_3339) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_3344 = cute.get_leaves(%1161) : !cute.shape<"16">
          %1162 = cute.get_stride(%e2_3339) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_3345 = cute.get_leaves(%1162) : !cute.stride<"1">
          %1163 = cute.static : !cute.layout<"32:1">
          %1164 = cute.get_shape(%1163) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_3346 = cute.get_leaves(%1164) : !cute.shape<"32">
          %1165 = cute.get_stride(%1163) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_3347 = cute.get_leaves(%1165) : !cute.stride<"1">
          %1166 = cute.static : !cute.shape<"(16,8,16)">
          %e0_3348, %e1_3349, %e2_3350 = cute.get_leaves(%1166) : !cute.shape<"(16,8,16)">
          %1167 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %1168 = cute.get_shape(%1167) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_3351, %e1_3352, %e2_3353, %e3_3354, %e4_3355 = cute.get_leaves(%1168) : !cute.shape<"((4,8),(2,2,2))">
          %1169 = cute.get_stride(%1167) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_3356, %e1_3357, %e2_3358, %e3_3359, %e4_3360 = cute.get_leaves(%1169) : !cute.stride<"((32,1),(16,8,128))">
          %1170 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %1171 = cute.get_shape(%1170) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_3361, %e1_3362, %e2_3363, %e3_3364 = cute.get_leaves(%1171) : !cute.shape<"((4,8),(2,2))">
          %1172 = cute.get_stride(%1170) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_3365, %e1_3366, %e2_3367, %e3_3368 = cute.get_leaves(%1172) : !cute.stride<"((16,1),(8,64))">
          %1173 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %1174 = cute.get_shape(%1173) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_3369, %e1_3370, %e2_3371, %e3_3372 = cute.get_leaves(%1174) : !cute.shape<"((4,8),(2,2))">
          %1175 = cute.get_stride(%1173) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_3373, %e1_3374, %e2_3375, %e3_3376 = cute.get_leaves(%1175) : !cute.stride<"((32,1),(16,8))">
          scf.yield %1014, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        }
        %iter_2872 = cute.get_iter(%1059#0) : !memref_rmem_f32_1
        %lay_2873 = cute.get_layout(%1059#0) : !memref_rmem_f32_1
        %1060 = cute.get_shape(%lay_2873) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2874, %e1_2875, %e2_2876, %e3_2877 = cute.get_leaves(%1060) : !cute.shape<"((2,2),1,8)">
        %1061 = cute.get_stride(%lay_2873) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_2878, %e1_2879, %e2_2880, %e3_2881 = cute.get_leaves(%1061) : !cute.stride<"((1,2),0,4)">
        %iter_2882 = cute.get_iter(%1059#0) : !memref_rmem_f32_1
        %iter_2883 = cute.get_iter(%1059#0) : !memref_rmem_f32_1
        %lay_2884 = cute.get_layout(%1059#0) : !memref_rmem_f32_1
        %1062 = cute.make_layout_like(%lay_2884) : !cute.layout<"((2,2),1,8):((1,2),0,4)"> to !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2885 = cute.memref.alloca(%1062) : !memref_rmem_bf16_6
        %iter_2886 = cute.get_iter(%rmem_2885) : !memref_rmem_bf16_6
        %iter_2887 = cute.get_iter(%rmem_2885) : !memref_rmem_bf16_6
        %lay_2888 = cute.get_layout(%1059#0) : !memref_rmem_f32_1
        %1063 = cute.get_shape(%lay_2888) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2889, %e1_2890, %e2_2891, %e3_2892 = cute.get_leaves(%1063) : !cute.shape<"((2,2),1,8)">
        %1064 = cute.memref.load_vec %1059#0 : !memref_rmem_f32_1
        %1065 = arith.truncf %1064 : vector<32xf32> to vector<32xbf16>
        %lay_2893 = cute.get_layout(%rmem_2885) : !memref_rmem_bf16_6
        %1066 = cute.get_shape(%lay_2893) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2894, %e1_2895, %e2_2896, %e3_2897 = cute.get_leaves(%1066) : !cute.shape<"((2,2),1,8)">
        %int_tuple_2898 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2899 = cute.size(%int_tuple_2898) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2900 = cute.get_leaves(%sz_2899) : !cute.int_tuple<"32">
        %int_tuple_2901 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2902 = cute.size(%int_tuple_2901) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2903 = cute.get_leaves(%sz_2902) : !cute.int_tuple<"32">
        cute.memref.store_vec %1065, %rmem_2885 : !memref_rmem_bf16_6
        %lay_2904 = cute.get_layout(%rmem_2885) : !memref_rmem_bf16_6
        %tile_2905 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_2906 = cute.make_layout() : !cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">
        %1067 = cute.get_shape(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2907, %e1_2908, %e2_2909, %e3_2910, %e4_2911 = cute.get_leaves(%1067) : !cute.shape<"((2,2),1,(2,4))">
        %1068 = cute.get_shape(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2912, %e1_2913, %e2_2914, %e3_2915, %e4_2916 = cute.get_leaves(%1068) : !cute.shape<"((2,2),1,(2,4))">
        %1069 = cute.get_shape(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2917, %e1_2918, %e2_2919, %e3_2920, %e4_2921 = cute.get_leaves(%1069) : !cute.shape<"((2,2),1,(2,4))">
        %1070 = cute.get_shape(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_2922, %e1_2923, %e2_2924, %e3_2925, %e4_2926 = cute.get_leaves(%1070) : !cute.shape<"((2,2),1,(2,4))">
        %1071 = cute.get_stride(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2927, %e1_2928, %e2_2929, %e3_2930, %e4_2931 = cute.get_leaves(%1071) : !cute.stride<"((1,2),0,(4,8))">
        %1072 = cute.get_stride(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2932, %e1_2933, %e2_2934, %e3_2935, %e4_2936 = cute.get_leaves(%1072) : !cute.stride<"((1,2),0,(4,8))">
        %1073 = cute.get_stride(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2937, %e1_2938, %e2_2939, %e3_2940, %e4_2941 = cute.get_leaves(%1073) : !cute.stride<"((1,2),0,(4,8))">
        %1074 = cute.get_stride(%lay_2906) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_2942, %e1_2943, %e2_2944, %e3_2945, %e4_2946 = cute.get_leaves(%1074) : !cute.stride<"((1,2),0,(4,8))">
        %shape_2947 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),1,4)">
        %stride_2948 = cute.make_stride() : () -> !cute.stride<"(((1,2),4),0,8)">
        %lay_2949 = cute.make_layout() : !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">
        %view_2950 = cute.make_view(%iter_2887, %lay_2949) : !memref_rmem_bf16_19
        %iter_2951 = cute.get_iter(%view_2950) : !memref_rmem_bf16_19
        %coord_2952 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2953 = cute.get_layout(%src_partitioned_484) : !memref_smem_bf16_10
        %slice_2954 = cute.slice(%lay_2953, %coord_2952) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
        %idx_2955 = cute.crd2idx(%coord_2952, %lay_2953) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_2956 = cute.get_iter(%src_partitioned_484) : !memref_smem_bf16_10
        %ptr_2957 = cute.add_offset(%iter_2956, %idx_2955) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2958 = cute.make_view(%ptr_2957, %slice_2954) : !memref_smem_bf16_21
        %iter_2959 = cute.get_iter(%view_2958) : !memref_smem_bf16_21
        %iter_2960 = cute.get_iter(%view_2958) : !memref_smem_bf16_21
        %coord_2961 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2962 = cute.get_layout(%retiled_486) : !memref_rmem_bf16_5
        %idx_2963 = cute.crd2idx(%coord_2961, %lay_2962) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_2964 = cute.get_iter(%retiled_486) : !memref_rmem_bf16_5
        %ptr_2965 = cute.add_offset(%iter_2964, %idx_2963) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2966 = cute.make_view(%ptr_2965) : !memref_rmem_bf16_20
        %iter_2967 = cute.get_iter(%view_2966) : !memref_rmem_bf16_20
        %iter_2968 = cute.get_iter(%view_2966) : !memref_rmem_bf16_20
        %lay_2969 = cute.get_layout(%view_2958) : !memref_smem_bf16_21
        %1075 = cute.get_shape(%lay_2969) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_2970, %e1_2971, %e2_2972, %e3_2973, %e4_2974 = cute.get_leaves(%1075) : !cute.shape<"((8,1),((2,2),2))">
        %lay_2975 = cute.get_layout(%view_2966) : !memref_rmem_bf16_20
        %1076 = cute.get_shape(%lay_2975) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_2976, %e1_2977, %e2_2978, %e3_2979 = cute.get_leaves(%1076) : !cute.shape<"((8,1),(4,2))">
        %lay_2980 = cute.get_layout(%view_2958) : !memref_smem_bf16_21
        %shape_2981 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2982 = cute.make_layout() : !cute.layout<"1:0">
        %append_2983 = cute.append_to_rank<2> (%lay_2980, %lay_2982) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_2984 = cute.make_view(%iter_2960, %append_2983) : !memref_smem_bf16_21
        %iter_2985 = cute.get_iter(%view_2984) : !memref_smem_bf16_21
        %lay_2986 = cute.get_layout(%view_2984) : !memref_smem_bf16_21
        %1077 = cute.get_shape(%lay_2986) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_2987, %e1_2988, %e2_2989, %e3_2990, %e4_2991 = cute.get_leaves(%1077) : !cute.shape<"((8,1),((2,2),2))">
        %iter_2992 = cute.get_iter(%view_2984) : !memref_smem_bf16_21
        %lay_2993 = cute.get_layout(%view_2984) : !memref_smem_bf16_21
        %1078:2 = cute.get_scalars(%lay_2993) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_2994 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_2995 = cute.assume(%1078#0) : (i32) -> !cute.i32<divby 16>
        %iv_2996 = cute.assume(%1078#1) : (i32) -> !cute.i32<divby 32>
        %stride_2997 = cute.make_stride(%iv_2995, %iv_2996) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_2998 = cute.make_layout(%shape_2994, %stride_2997) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_2999 = cute.make_view(%iter_2992, %lay_2998) : !memref_smem_bf16_22
        %iter_3000 = cute.get_iter(%view_2999) : !memref_smem_bf16_22
        %iter_3001 = cute.get_iter(%view_2999) : !memref_smem_bf16_22
        %lay_3002 = cute.get_layout(%view_2966) : !memref_rmem_bf16_20
        %shape_3003 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3004 = cute.make_layout() : !cute.layout<"1:0">
        %append_3005 = cute.append_to_rank<2> (%lay_3002, %lay_3004) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_3006 = cute.make_view(%iter_2968, %append_3005) : !memref_rmem_bf16_20
        %iter_3007 = cute.get_iter(%view_3006) : !memref_rmem_bf16_20
        %lay_3008 = cute.get_layout(%view_3006) : !memref_rmem_bf16_20
        %1079 = cute.get_shape(%lay_3008) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_3009, %e1_3010, %e2_3011, %e3_3012 = cute.get_leaves(%1079) : !cute.shape<"((8,1),(4,2))">
        %iter_3013 = cute.get_iter(%view_3006) : !memref_rmem_bf16_20
        %view_3014 = cute.make_view(%iter_3013) : !memref_rmem_bf16_21
        %iter_3015 = cute.get_iter(%view_3014) : !memref_rmem_bf16_21
        %iter_3016 = cute.get_iter(%view_3014) : !memref_rmem_bf16_21
        %lay_3017 = cute.get_layout(%view_2999) : !memref_smem_bf16_22
        %1080 = cute.get_shape(%lay_3017) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_3018, %e1_3019, %e2_3020, %e3_3021, %e4_3022 = cute.get_leaves(%1080) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_3023 = cute.get_layout(%view_3014) : !memref_rmem_bf16_21
        %1081 = cute.get_shape(%lay_3023) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_3024, %e1_3025, %e2_3026, %e3_3027 = cute.get_leaves(%1081) : !cute.shape<"((8,1),((4,2)))">
        %lay_3028 = cute.get_layout(%view_2999) : !memref_smem_bf16_22
        %sz_3029 = cute.size(%lay_3028) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_3030 = cute.get_leaves(%sz_3029) : !cute.int_tuple<"8">
        %lay_3031 = cute.get_layout(%view_3014) : !memref_rmem_bf16_21
        %sz_3032 = cute.size(%lay_3031) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_3033 = cute.get_leaves(%sz_3032) : !cute.int_tuple<"8">
        %1082 = cute.static : !cute.layout<"1:0">
        %iter_3034 = cute.get_iter(%view_2999) : !memref_smem_bf16_22
        %iter_3035 = cute.get_iter(%view_3014) : !memref_rmem_bf16_21
        %lay_3036 = cute.get_layout(%view_2999) : !memref_smem_bf16_22
        %lay_3037 = cute.get_layout(%view_3014) : !memref_rmem_bf16_21
        %append_3038 = cute.append_to_rank<2> (%lay_3036, %1082) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_3039 = cute.append_to_rank<2> (%lay_3037, %1082) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %1083:2 = cute.get_scalars(%append_3038) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_3040 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_3041 = cute.assume(%1083#0) : (i32) -> !cute.i32<divby 16>
        %iv_3042 = cute.assume(%1083#1) : (i32) -> !cute.i32<divby 32>
        %stride_3043 = cute.make_stride(%iv_3041, %iv_3042) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_3044 = cute.make_layout(%shape_3040, %stride_3043) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_3045 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_3046 = cute.size(%lay_3044) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %1084 = cute.get_scalars(%sz_3046) : !cute.int_tuple<"8">
        %c0_i32_3047 = arith.constant 0 : i32
        %c1_i32_3048 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3047 to %1084 step %c1_i32_3048  : i32 {
          %coord_3319 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %slice_3320 = cute.slice(%lay_3044, %coord_3319) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_3321 = cute.crd2idx(%coord_3319, %lay_3044) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_3322 = cute.add_offset(%iter_3034, %idx_3321) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3323 = cute.make_view(%ptr_3322, %slice_3320) : !memref_smem_bf16_14
          %slice_3324 = cute.slice(%lay_3045, %coord_3319) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_3325 = cute.crd2idx(%coord_3319, %lay_3045) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_3326 = cute.add_offset(%iter_3035, %idx_3325) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3327 = cute.make_view(%ptr_3326, %slice_3324) : !memref_rmem_bf16_22
          cute.copy_atom_call(%187, %view_3323, %view_3327) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_3049 = cute.get_layout(%view_2950) : !memref_rmem_bf16_19
        %1085 = cute.get_shape(%lay_3049) : (!cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.shape<"(((2,2),2),1,4)">
        %e0_3050, %e1_3051, %e2_3052, %e3_3053, %e4_3054 = cute.get_leaves(%1085) : !cute.shape<"(((2,2),2),1,4)">
        %int_tuple_3055 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3056 = cute.size(%int_tuple_3055) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3057 = cute.get_leaves(%sz_3056) : !cute.int_tuple<"4">
        %int_tuple_3058 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3059 = cute.size(%int_tuple_3058) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3060 = cute.get_leaves(%sz_3059) : !cute.int_tuple<"4">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3320 = cute.get_layout(%src_partitioned_484) : !memref_smem_bf16_10
          %slice_3321 = cute.slice(%lay_3320, %coord_3319) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,1)">
          %idx_3322 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
          %iter_3323 = cute.get_iter(%src_partitioned_484) : !memref_smem_bf16_10
          %ptr_3324 = cute.add_offset(%iter_3323, %idx_3322) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3325 = cute.make_view(%ptr_3324, %slice_3321) : !memref_smem_bf16_21
          %iter_3326 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %iter_3327 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %coord_3328 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3329 = cute.get_layout(%retiled_486) : !memref_rmem_bf16_5
          %idx_3330 = cute.crd2idx(%coord_3328, %lay_3329) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
          %iter_3331 = cute.get_iter(%retiled_486) : !memref_rmem_bf16_5
          %ptr_3332 = cute.add_offset(%iter_3331, %idx_3330) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3333 = cute.make_view(%ptr_3332) : !memref_rmem_bf16_20
          %iter_3334 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %iter_3335 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %lay_3336 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %1151 = cute.get_shape(%lay_3336) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3337, %e1_3338, %e2_3339, %e3_3340, %e4_3341 = cute.get_leaves(%1151) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3342 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %1152 = cute.get_shape(%lay_3342) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%1152) : !cute.shape<"((8,1),(4,2))">
          %lay_3347 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %shape_3348 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3349 = cute.make_layout() : !cute.layout<"1:0">
          %append_3350 = cute.append_to_rank<2> (%lay_3347, %lay_3349) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3351 = cute.make_view(%iter_3327, %append_3350) : !memref_smem_bf16_21
          %iter_3352 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3353 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1153 = cute.get_shape(%lay_3353) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3354, %e1_3355, %e2_3356, %e3_3357, %e4_3358 = cute.get_leaves(%1153) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3359 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3360 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1154:2 = cute.get_scalars(%lay_3360) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3361 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3362 = cute.assume(%1154#0) : (i32) -> !cute.i32<divby 16>
          %iv_3363 = cute.assume(%1154#1) : (i32) -> !cute.i32<divby 32>
          %stride_3364 = cute.make_stride(%iv_3362, %iv_3363) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3365 = cute.make_layout(%shape_3361, %stride_3364) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3366 = cute.make_view(%iter_3359, %lay_3365) : !memref_smem_bf16_22
          %iter_3367 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3368 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %lay_3369 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %shape_3370 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3371 = cute.make_layout() : !cute.layout<"1:0">
          %append_3372 = cute.append_to_rank<2> (%lay_3369, %lay_3371) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3373 = cute.make_view(%iter_3335, %append_3372) : !memref_rmem_bf16_20
          %iter_3374 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %lay_3375 = cute.get_layout(%view_3373) : !memref_rmem_bf16_20
          %1155 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3376, %e1_3377, %e2_3378, %e3_3379 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4,2))">
          %iter_3380 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %view_3381 = cute.make_view(%iter_3380) : !memref_rmem_bf16_21
          %iter_3382 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %iter_3383 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3384 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %1156 = cute.get_shape(%lay_3384) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3385, %e1_3386, %e2_3387, %e3_3388, %e4_3389 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3390 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %1157 = cute.get_shape(%lay_3390) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1157) : !cute.shape<"((8,1),((4,2)))">
          %lay_3395 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"8">
          %lay_3398 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"8">
          %1158 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3402 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3403 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %lay_3404 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1158) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1158) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1159:2 = cute.get_scalars(%append_3405) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3407 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3408 = cute.assume(%1159#0) : (i32) -> !cute.i32<divby 16>
          %iv_3409 = cute.assume(%1159#1) : (i32) -> !cute.i32<divby 32>
          %stride_3410 = cute.make_stride(%iv_3408, %iv_3409) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3411 = cute.make_layout(%shape_3407, %stride_3410) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3412 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3413 = cute.size(%lay_3411) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1160 = cute.get_scalars(%sz_3413) : !cute.int_tuple<"8">
          %c0_i32_3414 = arith.constant 0 : i32
          %c1_i32_3415 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3414 to %1160 step %c1_i32_3415  : i32 {
            %coord_3416 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3417 = cute.slice(%lay_3411, %coord_3416) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3416, %lay_3411) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3419 = cute.add_offset(%iter_3401, %idx_3418) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_smem_bf16_14
            %slice_3421 = cute.slice(%lay_3412, %coord_3416) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3422 = cute.crd2idx(%coord_3416, %lay_3412) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3423 = cute.add_offset(%iter_3402, %idx_3422) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3424 = cute.make_view(%ptr_3423, %slice_3421) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3420, %view_3424) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3061 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3062 = cute.get_layout(%view_2950) : !memref_rmem_bf16_19
        %idx_3063 = cute.crd2idx(%coord_3061, %lay_3062) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"0">
        %iter_3064 = cute.get_iter(%view_2950) : !memref_rmem_bf16_19
        %ptr_3065 = cute.add_offset(%iter_3064, %idx_3063) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3066 = cute.make_view(%ptr_3065) : !memref_rmem_bf16_23
        %iter_3067 = cute.get_iter(%view_3066) : !memref_rmem_bf16_23
        %iter_3068 = cute.get_iter(%view_3066) : !memref_rmem_bf16_23
        %coord_3069 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3070 = cute.get_layout(%frg_B_397) : !memref_rmem_bf16_2
        %idx_3071 = cute.crd2idx(%coord_3069, %lay_3070) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_3072 = cute.get_iter(%frg_B_397) : !memref_rmem_bf16_2
        %ptr_3073 = cute.add_offset(%iter_3072, %idx_3071) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3074 = cute.make_view(%ptr_3073) : !memref_rmem_bf16_24
        %iter_3075 = cute.get_iter(%view_3074) : !memref_rmem_bf16_24
        %iter_3076 = cute.get_iter(%view_3074) : !memref_rmem_bf16_24
        %lay_3077 = cute.get_layout(%view_3066) : !memref_rmem_bf16_23
        %1086 = cute.get_shape(%lay_3077) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3078, %e1_3079, %e2_3080, %e3_3081 = cute.get_leaves(%1086) : !cute.shape<"(((2,2),2),1)">
        %lay_3082 = cute.get_layout(%view_3074) : !memref_rmem_bf16_24
        %1087 = cute.get_shape(%lay_3082) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3083, %e1_3084, %e2_3085, %e3_3086 = cute.get_leaves(%1087) : !cute.shape<"((2,2),(8,2))">
        %lay_3087 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1088 = cute.get_shape(%lay_3087) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
        %e0_3088, %e1_3089, %e2_3090, %e3_3091 = cute.get_leaves(%1088) : !cute.shape<"((2,2),1,16)">
        %iter_3092 = cute.get_iter(%view_3066) : !memref_rmem_bf16_23
        %iter_3093 = cute.get_iter(%view_3074) : !memref_rmem_bf16_24
        %iter_3094 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3095 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3096 = cute.get_layout(%view_3066) : !memref_rmem_bf16_23
        %lay_3097 = cute.get_layout(%view_3074) : !memref_rmem_bf16_24
        %lay_3098 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3099 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1089 = cute.static : !cute.layout<"1:0">
        %append_3100 = cute.append_to_rank<3> (%lay_3096, %1089) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3101 = cute.append_to_rank<3> (%lay_3097, %1089) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3102 = cute.size(%append_3100) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3103 = cute.size(%append_3100) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3104 = cute.size(%append_3101) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1090 = cute.get_scalars(%sz_3102) : !cute.int_tuple<"1">
        %1091 = cute.get_scalars(%sz_3103) : !cute.int_tuple<"1">
        %1092 = cute.get_scalars(%sz_3104) : !cute.int_tuple<"16">
        %c0_i32_3105 = arith.constant 0 : i32
        %c1_i32_3106 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3105 to %1090 step %c1_i32_3106  : i32 {
          scf.for %arg9 = %c0_i32_3105 to %1091 step %c1_i32_3106  : i32 {
            scf.for %arg10 = %c0_i32_3105 to %1092 step %c1_i32_3106  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_3100, %coord_3319) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_3100) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_3092, %idx_3323) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_25
              %slice_3326 = cute.slice(%append_3101, %coord_3320) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_3101) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_3093, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_3098, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_3098) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_3094, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_3099, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_3099) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_3095, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_25, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3107 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3108 = cute.size(%int_tuple_3107) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3109 = cute.get_leaves(%sz_3108) : !cute.int_tuple<"4">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3320 = cute.get_layout(%src_partitioned_484) : !memref_smem_bf16_10
          %slice_3321 = cute.slice(%lay_3320, %coord_3319) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,2)">
          %idx_3322 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
          %iter_3323 = cute.get_iter(%src_partitioned_484) : !memref_smem_bf16_10
          %ptr_3324 = cute.add_offset(%iter_3323, %idx_3322) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3325 = cute.make_view(%ptr_3324, %slice_3321) : !memref_smem_bf16_21
          %iter_3326 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %iter_3327 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %coord_3328 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3329 = cute.get_layout(%retiled_486) : !memref_rmem_bf16_5
          %idx_3330 = cute.crd2idx(%coord_3328, %lay_3329) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
          %iter_3331 = cute.get_iter(%retiled_486) : !memref_rmem_bf16_5
          %ptr_3332 = cute.add_offset(%iter_3331, %idx_3330) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3333 = cute.make_view(%ptr_3332) : !memref_rmem_bf16_20
          %iter_3334 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %iter_3335 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %lay_3336 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %1151 = cute.get_shape(%lay_3336) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3337, %e1_3338, %e2_3339, %e3_3340, %e4_3341 = cute.get_leaves(%1151) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3342 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %1152 = cute.get_shape(%lay_3342) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%1152) : !cute.shape<"((8,1),(4,2))">
          %lay_3347 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %shape_3348 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3349 = cute.make_layout() : !cute.layout<"1:0">
          %append_3350 = cute.append_to_rank<2> (%lay_3347, %lay_3349) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3351 = cute.make_view(%iter_3327, %append_3350) : !memref_smem_bf16_21
          %iter_3352 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3353 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1153 = cute.get_shape(%lay_3353) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3354, %e1_3355, %e2_3356, %e3_3357, %e4_3358 = cute.get_leaves(%1153) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3359 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3360 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1154:2 = cute.get_scalars(%lay_3360) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3361 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3362 = cute.assume(%1154#0) : (i32) -> !cute.i32<divby 16>
          %iv_3363 = cute.assume(%1154#1) : (i32) -> !cute.i32<divby 32>
          %stride_3364 = cute.make_stride(%iv_3362, %iv_3363) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3365 = cute.make_layout(%shape_3361, %stride_3364) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3366 = cute.make_view(%iter_3359, %lay_3365) : !memref_smem_bf16_22
          %iter_3367 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3368 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %lay_3369 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %shape_3370 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3371 = cute.make_layout() : !cute.layout<"1:0">
          %append_3372 = cute.append_to_rank<2> (%lay_3369, %lay_3371) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3373 = cute.make_view(%iter_3335, %append_3372) : !memref_rmem_bf16_20
          %iter_3374 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %lay_3375 = cute.get_layout(%view_3373) : !memref_rmem_bf16_20
          %1155 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3376, %e1_3377, %e2_3378, %e3_3379 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4,2))">
          %iter_3380 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %view_3381 = cute.make_view(%iter_3380) : !memref_rmem_bf16_21
          %iter_3382 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %iter_3383 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3384 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %1156 = cute.get_shape(%lay_3384) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3385, %e1_3386, %e2_3387, %e3_3388, %e4_3389 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3390 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %1157 = cute.get_shape(%lay_3390) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1157) : !cute.shape<"((8,1),((4,2)))">
          %lay_3395 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"8">
          %lay_3398 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"8">
          %1158 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3402 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3403 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %lay_3404 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1158) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1158) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1159:2 = cute.get_scalars(%append_3405) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3407 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3408 = cute.assume(%1159#0) : (i32) -> !cute.i32<divby 16>
          %iv_3409 = cute.assume(%1159#1) : (i32) -> !cute.i32<divby 32>
          %stride_3410 = cute.make_stride(%iv_3408, %iv_3409) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3411 = cute.make_layout(%shape_3407, %stride_3410) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3412 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3413 = cute.size(%lay_3411) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1160 = cute.get_scalars(%sz_3413) : !cute.int_tuple<"8">
          %c0_i32_3414 = arith.constant 0 : i32
          %c1_i32_3415 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3414 to %1160 step %c1_i32_3415  : i32 {
            %coord_3416 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3417 = cute.slice(%lay_3411, %coord_3416) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3416, %lay_3411) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3419 = cute.add_offset(%iter_3401, %idx_3418) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_smem_bf16_14
            %slice_3421 = cute.slice(%lay_3412, %coord_3416) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3422 = cute.crd2idx(%coord_3416, %lay_3412) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3423 = cute.add_offset(%iter_3402, %idx_3422) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3424 = cute.make_view(%ptr_3423, %slice_3421) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3420, %view_3424) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3110 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3111 = cute.get_layout(%view_2950) : !memref_rmem_bf16_19
        %idx_3112 = cute.crd2idx(%coord_3110, %lay_3111) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"8">
        %iter_3113 = cute.get_iter(%view_2950) : !memref_rmem_bf16_19
        %ptr_3114 = cute.add_offset(%iter_3113, %idx_3112) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3115 = cute.make_view(%ptr_3114) : !memref_rmem_bf16_26
        %iter_3116 = cute.get_iter(%view_3115) : !memref_rmem_bf16_26
        %iter_3117 = cute.get_iter(%view_3115) : !memref_rmem_bf16_26
        %coord_3118 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3119 = cute.get_layout(%frg_B_397) : !memref_rmem_bf16_2
        %idx_3120 = cute.crd2idx(%coord_3118, %lay_3119) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_3121 = cute.get_iter(%frg_B_397) : !memref_rmem_bf16_2
        %ptr_3122 = cute.add_offset(%iter_3121, %idx_3120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3123 = cute.make_view(%ptr_3122) : !memref_rmem_bf16_24
        %iter_3124 = cute.get_iter(%view_3123) : !memref_rmem_bf16_24
        %iter_3125 = cute.get_iter(%view_3123) : !memref_rmem_bf16_24
        %lay_3126 = cute.get_layout(%view_3115) : !memref_rmem_bf16_26
        %1093 = cute.get_shape(%lay_3126) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3127, %e1_3128, %e2_3129, %e3_3130 = cute.get_leaves(%1093) : !cute.shape<"(((2,2),2),1)">
        %lay_3131 = cute.get_layout(%view_3123) : !memref_rmem_bf16_24
        %1094 = cute.get_shape(%lay_3131) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3132, %e1_3133, %e2_3134, %e3_3135 = cute.get_leaves(%1094) : !cute.shape<"((2,2),(8,2))">
        %iter_3136 = cute.get_iter(%view_3115) : !memref_rmem_bf16_26
        %iter_3137 = cute.get_iter(%view_3123) : !memref_rmem_bf16_24
        %iter_3138 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3139 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3140 = cute.get_layout(%view_3115) : !memref_rmem_bf16_26
        %lay_3141 = cute.get_layout(%view_3123) : !memref_rmem_bf16_24
        %lay_3142 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3143 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1095 = cute.static : !cute.layout<"1:0">
        %append_3144 = cute.append_to_rank<3> (%lay_3140, %1095) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3145 = cute.append_to_rank<3> (%lay_3141, %1095) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3146 = cute.size(%append_3144) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3147 = cute.size(%append_3144) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3148 = cute.size(%append_3145) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1096 = cute.get_scalars(%sz_3146) : !cute.int_tuple<"1">
        %1097 = cute.get_scalars(%sz_3147) : !cute.int_tuple<"1">
        %1098 = cute.get_scalars(%sz_3148) : !cute.int_tuple<"16">
        %c0_i32_3149 = arith.constant 0 : i32
        %c1_i32_3150 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3149 to %1096 step %c1_i32_3150  : i32 {
          scf.for %arg9 = %c0_i32_3149 to %1097 step %c1_i32_3150  : i32 {
            scf.for %arg10 = %c0_i32_3149 to %1098 step %c1_i32_3150  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_3144, %coord_3319) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_3144) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_3136, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_27
              %slice_3326 = cute.slice(%append_3145, %coord_3320) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_3145) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_3137, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_3142, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_3142) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_3138, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_3143, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_3143) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_3139, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_27, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3151 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3152 = cute.size(%int_tuple_3151) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3153 = cute.get_leaves(%sz_3152) : !cute.int_tuple<"4">
        scf.if %true {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3320 = cute.get_layout(%src_partitioned_484) : !memref_smem_bf16_10
          %slice_3321 = cute.slice(%lay_3320, %coord_3319) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,3)">
          %idx_3322 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
          %iter_3323 = cute.get_iter(%src_partitioned_484) : !memref_smem_bf16_10
          %ptr_3324 = cute.add_offset(%iter_3323, %idx_3322) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3325 = cute.make_view(%ptr_3324, %slice_3321) : !memref_smem_bf16_21
          %iter_3326 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %iter_3327 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %coord_3328 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3329 = cute.get_layout(%retiled_486) : !memref_rmem_bf16_5
          %idx_3330 = cute.crd2idx(%coord_3328, %lay_3329) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
          %iter_3331 = cute.get_iter(%retiled_486) : !memref_rmem_bf16_5
          %ptr_3332 = cute.add_offset(%iter_3331, %idx_3330) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3333 = cute.make_view(%ptr_3332) : !memref_rmem_bf16_20
          %iter_3334 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %iter_3335 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %lay_3336 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %1151 = cute.get_shape(%lay_3336) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3337, %e1_3338, %e2_3339, %e3_3340, %e4_3341 = cute.get_leaves(%1151) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3342 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %1152 = cute.get_shape(%lay_3342) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%1152) : !cute.shape<"((8,1),(4,2))">
          %lay_3347 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %shape_3348 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3349 = cute.make_layout() : !cute.layout<"1:0">
          %append_3350 = cute.append_to_rank<2> (%lay_3347, %lay_3349) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3351 = cute.make_view(%iter_3327, %append_3350) : !memref_smem_bf16_21
          %iter_3352 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3353 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1153 = cute.get_shape(%lay_3353) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3354, %e1_3355, %e2_3356, %e3_3357, %e4_3358 = cute.get_leaves(%1153) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3359 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3360 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1154:2 = cute.get_scalars(%lay_3360) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3361 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3362 = cute.assume(%1154#0) : (i32) -> !cute.i32<divby 16>
          %iv_3363 = cute.assume(%1154#1) : (i32) -> !cute.i32<divby 32>
          %stride_3364 = cute.make_stride(%iv_3362, %iv_3363) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3365 = cute.make_layout(%shape_3361, %stride_3364) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3366 = cute.make_view(%iter_3359, %lay_3365) : !memref_smem_bf16_22
          %iter_3367 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3368 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %lay_3369 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %shape_3370 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3371 = cute.make_layout() : !cute.layout<"1:0">
          %append_3372 = cute.append_to_rank<2> (%lay_3369, %lay_3371) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3373 = cute.make_view(%iter_3335, %append_3372) : !memref_rmem_bf16_20
          %iter_3374 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %lay_3375 = cute.get_layout(%view_3373) : !memref_rmem_bf16_20
          %1155 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3376, %e1_3377, %e2_3378, %e3_3379 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4,2))">
          %iter_3380 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %view_3381 = cute.make_view(%iter_3380) : !memref_rmem_bf16_21
          %iter_3382 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %iter_3383 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3384 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %1156 = cute.get_shape(%lay_3384) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3385, %e1_3386, %e2_3387, %e3_3388, %e4_3389 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3390 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %1157 = cute.get_shape(%lay_3390) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1157) : !cute.shape<"((8,1),((4,2)))">
          %lay_3395 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"8">
          %lay_3398 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"8">
          %1158 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3402 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3403 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %lay_3404 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1158) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1158) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1159:2 = cute.get_scalars(%append_3405) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3407 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3408 = cute.assume(%1159#0) : (i32) -> !cute.i32<divby 16>
          %iv_3409 = cute.assume(%1159#1) : (i32) -> !cute.i32<divby 32>
          %stride_3410 = cute.make_stride(%iv_3408, %iv_3409) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3411 = cute.make_layout(%shape_3407, %stride_3410) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3412 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3413 = cute.size(%lay_3411) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1160 = cute.get_scalars(%sz_3413) : !cute.int_tuple<"8">
          %c0_i32_3414 = arith.constant 0 : i32
          %c1_i32_3415 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3414 to %1160 step %c1_i32_3415  : i32 {
            %coord_3416 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3417 = cute.slice(%lay_3411, %coord_3416) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3416, %lay_3411) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3419 = cute.add_offset(%iter_3401, %idx_3418) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_smem_bf16_14
            %slice_3421 = cute.slice(%lay_3412, %coord_3416) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3422 = cute.crd2idx(%coord_3416, %lay_3412) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3423 = cute.add_offset(%iter_3402, %idx_3422) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3424 = cute.make_view(%ptr_3423, %slice_3421) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3420, %view_3424) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3154 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3155 = cute.get_layout(%view_2950) : !memref_rmem_bf16_19
        %idx_3156 = cute.crd2idx(%coord_3154, %lay_3155) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"16">
        %iter_3157 = cute.get_iter(%view_2950) : !memref_rmem_bf16_19
        %ptr_3158 = cute.add_offset(%iter_3157, %idx_3156) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3159 = cute.make_view(%ptr_3158) : !memref_rmem_bf16_23
        %iter_3160 = cute.get_iter(%view_3159) : !memref_rmem_bf16_23
        %iter_3161 = cute.get_iter(%view_3159) : !memref_rmem_bf16_23
        %coord_3162 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3163 = cute.get_layout(%frg_B_397) : !memref_rmem_bf16_2
        %idx_3164 = cute.crd2idx(%coord_3162, %lay_3163) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_3165 = cute.get_iter(%frg_B_397) : !memref_rmem_bf16_2
        %ptr_3166 = cute.add_offset(%iter_3165, %idx_3164) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3167 = cute.make_view(%ptr_3166) : !memref_rmem_bf16_24
        %iter_3168 = cute.get_iter(%view_3167) : !memref_rmem_bf16_24
        %iter_3169 = cute.get_iter(%view_3167) : !memref_rmem_bf16_24
        %lay_3170 = cute.get_layout(%view_3159) : !memref_rmem_bf16_23
        %1099 = cute.get_shape(%lay_3170) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3171, %e1_3172, %e2_3173, %e3_3174 = cute.get_leaves(%1099) : !cute.shape<"(((2,2),2),1)">
        %lay_3175 = cute.get_layout(%view_3167) : !memref_rmem_bf16_24
        %1100 = cute.get_shape(%lay_3175) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3176, %e1_3177, %e2_3178, %e3_3179 = cute.get_leaves(%1100) : !cute.shape<"((2,2),(8,2))">
        %iter_3180 = cute.get_iter(%view_3159) : !memref_rmem_bf16_23
        %iter_3181 = cute.get_iter(%view_3167) : !memref_rmem_bf16_24
        %iter_3182 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3183 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3184 = cute.get_layout(%view_3159) : !memref_rmem_bf16_23
        %lay_3185 = cute.get_layout(%view_3167) : !memref_rmem_bf16_24
        %lay_3186 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3187 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1101 = cute.static : !cute.layout<"1:0">
        %append_3188 = cute.append_to_rank<3> (%lay_3184, %1101) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3189 = cute.append_to_rank<3> (%lay_3185, %1101) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3190 = cute.size(%append_3188) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3191 = cute.size(%append_3188) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3192 = cute.size(%append_3189) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1102 = cute.get_scalars(%sz_3190) : !cute.int_tuple<"1">
        %1103 = cute.get_scalars(%sz_3191) : !cute.int_tuple<"1">
        %1104 = cute.get_scalars(%sz_3192) : !cute.int_tuple<"16">
        %c0_i32_3193 = arith.constant 0 : i32
        %c1_i32_3194 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3193 to %1102 step %c1_i32_3194  : i32 {
          scf.for %arg9 = %c0_i32_3193 to %1103 step %c1_i32_3194  : i32 {
            scf.for %arg10 = %c0_i32_3193 to %1104 step %c1_i32_3194  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_3188, %coord_3319) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_3188) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_3180, %idx_3323) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_25
              %slice_3326 = cute.slice(%append_3189, %coord_3320) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_3189) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_3181, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_3186, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_3186) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_3182, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_3187, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_3187) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_3183, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_25, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3195 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3196 = cute.size(%int_tuple_3195) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3197 = cute.get_leaves(%sz_3196) : !cute.int_tuple<"4">
        scf.if %false {
          %coord_3319 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3320 = cute.get_layout(%src_partitioned_484) : !memref_smem_bf16_10
          %slice_3321 = cute.slice(%lay_3320, %coord_3319) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,4)">
          %idx_3322 = cute.crd2idx(%coord_3319, %lay_3320) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"4096">
          %iter_3323 = cute.get_iter(%src_partitioned_484) : !memref_smem_bf16_10
          %ptr_3324 = cute.add_offset(%iter_3323, %idx_3322) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3325 = cute.make_view(%ptr_3324, %slice_3321) : !memref_smem_bf16_21
          %iter_3326 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %iter_3327 = cute.get_iter(%view_3325) : !memref_smem_bf16_21
          %coord_3328 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3329 = cute.get_layout(%retiled_486) : !memref_rmem_bf16_5
          %idx_3330 = cute.crd2idx(%coord_3328, %lay_3329) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"128">
          %iter_3331 = cute.get_iter(%retiled_486) : !memref_rmem_bf16_5
          %ptr_3332 = cute.add_offset(%iter_3331, %idx_3330) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3333 = cute.make_view(%ptr_3332) : !memref_rmem_bf16_20
          %iter_3334 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %iter_3335 = cute.get_iter(%view_3333) : !memref_rmem_bf16_20
          %lay_3336 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %1151 = cute.get_shape(%lay_3336) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3337, %e1_3338, %e2_3339, %e3_3340, %e4_3341 = cute.get_leaves(%1151) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3342 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %1152 = cute.get_shape(%lay_3342) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%1152) : !cute.shape<"((8,1),(4,2))">
          %lay_3347 = cute.get_layout(%view_3325) : !memref_smem_bf16_21
          %shape_3348 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3349 = cute.make_layout() : !cute.layout<"1:0">
          %append_3350 = cute.append_to_rank<2> (%lay_3347, %lay_3349) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3351 = cute.make_view(%iter_3327, %append_3350) : !memref_smem_bf16_21
          %iter_3352 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3353 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1153 = cute.get_shape(%lay_3353) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3354, %e1_3355, %e2_3356, %e3_3357, %e4_3358 = cute.get_leaves(%1153) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3359 = cute.get_iter(%view_3351) : !memref_smem_bf16_21
          %lay_3360 = cute.get_layout(%view_3351) : !memref_smem_bf16_21
          %1154:2 = cute.get_scalars(%lay_3360) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3361 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3362 = cute.assume(%1154#0) : (i32) -> !cute.i32<divby 16>
          %iv_3363 = cute.assume(%1154#1) : (i32) -> !cute.i32<divby 32>
          %stride_3364 = cute.make_stride(%iv_3362, %iv_3363) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_3365 = cute.make_layout(%shape_3361, %stride_3364) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_3366 = cute.make_view(%iter_3359, %lay_3365) : !memref_smem_bf16_22
          %iter_3367 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3368 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %lay_3369 = cute.get_layout(%view_3333) : !memref_rmem_bf16_20
          %shape_3370 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3371 = cute.make_layout() : !cute.layout<"1:0">
          %append_3372 = cute.append_to_rank<2> (%lay_3369, %lay_3371) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_3373 = cute.make_view(%iter_3335, %append_3372) : !memref_rmem_bf16_20
          %iter_3374 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %lay_3375 = cute.get_layout(%view_3373) : !memref_rmem_bf16_20
          %1155 = cute.get_shape(%lay_3375) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3376, %e1_3377, %e2_3378, %e3_3379 = cute.get_leaves(%1155) : !cute.shape<"((8,1),(4,2))">
          %iter_3380 = cute.get_iter(%view_3373) : !memref_rmem_bf16_20
          %view_3381 = cute.make_view(%iter_3380) : !memref_rmem_bf16_21
          %iter_3382 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %iter_3383 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3384 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %1156 = cute.get_shape(%lay_3384) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_3385, %e1_3386, %e2_3387, %e3_3388, %e4_3389 = cute.get_leaves(%1156) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_3390 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %1157 = cute.get_shape(%lay_3390) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1157) : !cute.shape<"((8,1),((4,2)))">
          %lay_3395 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %sz_3396 = cute.size(%lay_3395) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_3397 = cute.get_leaves(%sz_3396) : !cute.int_tuple<"8">
          %lay_3398 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %sz_3399 = cute.size(%lay_3398) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_3400 = cute.get_leaves(%sz_3399) : !cute.int_tuple<"8">
          %1158 = cute.static : !cute.layout<"1:0">
          %iter_3401 = cute.get_iter(%view_3366) : !memref_smem_bf16_22
          %iter_3402 = cute.get_iter(%view_3381) : !memref_rmem_bf16_21
          %lay_3403 = cute.get_layout(%view_3366) : !memref_smem_bf16_22
          %lay_3404 = cute.get_layout(%view_3381) : !memref_rmem_bf16_21
          %append_3405 = cute.append_to_rank<2> (%lay_3403, %1158) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_3406 = cute.append_to_rank<2> (%lay_3404, %1158) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1159:2 = cute.get_scalars(%append_3405) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_3407 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_3408 = cute.assume(%1159#0) : (i32) -> !cute.i32<divby 16>
          %iv_3409 = cute.assume(%1159#1) : (i32) -> !cute.i32<divby 32>
          %stride_3410 = cute.make_stride(%iv_3408, %iv_3409) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3411 = cute.make_layout(%shape_3407, %stride_3410) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_3412 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_3413 = cute.size(%lay_3411) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1160 = cute.get_scalars(%sz_3413) : !cute.int_tuple<"8">
          %c0_i32_3414 = arith.constant 0 : i32
          %c1_i32_3415 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_3414 to %1160 step %c1_i32_3415  : i32 {
            %coord_3416 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %slice_3417 = cute.slice(%lay_3411, %coord_3416) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
            %idx_3418 = cute.crd2idx(%coord_3416, %lay_3411) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_3419 = cute.add_offset(%iter_3401, %idx_3418) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_3420 = cute.make_view(%ptr_3419, %slice_3417) : !memref_smem_bf16_14
            %slice_3421 = cute.slice(%lay_3412, %coord_3416) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
            %idx_3422 = cute.crd2idx(%coord_3416, %lay_3412) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_3423 = cute.add_offset(%iter_3402, %idx_3422) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_3424 = cute.make_view(%ptr_3423, %slice_3421) : !memref_rmem_bf16_22
            cute.copy_atom_call(%187, %view_3420, %view_3424) : (!copy_ldsm_4_2, !memref_smem_bf16_14, !memref_rmem_bf16_22) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3198 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3199 = cute.get_layout(%view_2950) : !memref_rmem_bf16_19
        %idx_3200 = cute.crd2idx(%coord_3198, %lay_3199) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"24">
        %iter_3201 = cute.get_iter(%view_2950) : !memref_rmem_bf16_19
        %ptr_3202 = cute.add_offset(%iter_3201, %idx_3200) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3203 = cute.make_view(%ptr_3202) : !memref_rmem_bf16_26
        %iter_3204 = cute.get_iter(%view_3203) : !memref_rmem_bf16_26
        %iter_3205 = cute.get_iter(%view_3203) : !memref_rmem_bf16_26
        %coord_3206 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3207 = cute.get_layout(%frg_B_397) : !memref_rmem_bf16_2
        %idx_3208 = cute.crd2idx(%coord_3206, %lay_3207) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_3209 = cute.get_iter(%frg_B_397) : !memref_rmem_bf16_2
        %ptr_3210 = cute.add_offset(%iter_3209, %idx_3208) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3211 = cute.make_view(%ptr_3210) : !memref_rmem_bf16_24
        %iter_3212 = cute.get_iter(%view_3211) : !memref_rmem_bf16_24
        %iter_3213 = cute.get_iter(%view_3211) : !memref_rmem_bf16_24
        %lay_3214 = cute.get_layout(%view_3203) : !memref_rmem_bf16_26
        %1105 = cute.get_shape(%lay_3214) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3215, %e1_3216, %e2_3217, %e3_3218 = cute.get_leaves(%1105) : !cute.shape<"(((2,2),2),1)">
        %lay_3219 = cute.get_layout(%view_3211) : !memref_rmem_bf16_24
        %1106 = cute.get_shape(%lay_3219) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3220, %e1_3221, %e2_3222, %e3_3223 = cute.get_leaves(%1106) : !cute.shape<"((2,2),(8,2))">
        %iter_3224 = cute.get_iter(%view_3203) : !memref_rmem_bf16_26
        %iter_3225 = cute.get_iter(%view_3211) : !memref_rmem_bf16_24
        %iter_3226 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_3227 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_3228 = cute.get_layout(%view_3203) : !memref_rmem_bf16_26
        %lay_3229 = cute.get_layout(%view_3211) : !memref_rmem_bf16_24
        %lay_3230 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_3231 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %1107 = cute.static : !cute.layout<"1:0">
        %append_3232 = cute.append_to_rank<3> (%lay_3228, %1107) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3233 = cute.append_to_rank<3> (%lay_3229, %1107) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3234 = cute.size(%append_3232) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3235 = cute.size(%append_3232) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3236 = cute.size(%append_3233) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1108 = cute.get_scalars(%sz_3234) : !cute.int_tuple<"1">
        %1109 = cute.get_scalars(%sz_3235) : !cute.int_tuple<"1">
        %1110 = cute.get_scalars(%sz_3236) : !cute.int_tuple<"16">
        %c0_i32_3237 = arith.constant 0 : i32
        %c1_i32_3238 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3237 to %1108 step %c1_i32_3238  : i32 {
          scf.for %arg9 = %c0_i32_3237 to %1109 step %c1_i32_3238  : i32 {
            scf.for %arg10 = %c0_i32_3237 to %1110 step %c1_i32_3238  : i32 {
              %coord_3319 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3320 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3321 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_3322 = cute.slice(%append_3232, %coord_3319) : !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">, !cute.coord<"(_,?,?)">
              %idx_3323 = cute.crd2idx(%coord_3319, %append_3232) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3324 = cute.add_offset(%iter_3224, %idx_3323) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3325 = cute.make_view(%ptr_3324, %slice_3322) : !memref_rmem_bf16_27
              %slice_3326 = cute.slice(%append_3233, %coord_3320) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_3327 = cute.crd2idx(%coord_3320, %append_3233) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3328 = cute.add_offset(%iter_3225, %idx_3327) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3329 = cute.make_view(%ptr_3328, %slice_3326) : !memref_rmem_bf16_18
              %slice_3330 = cute.slice(%lay_3230, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3331 = cute.crd2idx(%coord_3321, %lay_3230) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3332 = cute.add_offset(%iter_3226, %idx_3331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3333 = cute.make_view(%ptr_3332, %slice_3330) : !memref_rmem_f32_2
              %slice_3334 = cute.slice(%lay_3231, %coord_3321) : !cute.layout<"((2,2),1,16):((1,2),0,4)">, !cute.coord<"(_,?,?)">
              %idx_3335 = cute.crd2idx(%coord_3321, %lay_3231) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3336 = cute.add_offset(%iter_3227, %idx_3335) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3337 = cute.make_view(%ptr_3336, %slice_3334) : !memref_rmem_f32_2
              cute.mma_atom_call(%6, %view_3337, %view_3325, %view_3329, %view_3333) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_27, !memref_rmem_bf16_18, !memref_rmem_f32_2) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %1111 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1112 = cute.get_shape(%1111) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_3239, %e1_3240, %e2_3241, %e3_3242 = cute.get_leaves(%1112) : !cute.shape<"(32,4,1,1)">
        %1113 = cute.get_stride(%1111) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_3243, %e1_3244, %e2_3245, %e3_3246 = cute.get_leaves(%1113) : !cute.stride<"(1,32,0,0)">
        %1114 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_3247, %e1_3248, %e2_3249 = cute.get_leaves(%1114) : !cute.tile<"[64:1;16:1;16:1]">
        %1115 = cute.get_shape(%e0_3247) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3250 = cute.get_leaves(%1115) : !cute.shape<"64">
        %1116 = cute.get_stride(%e0_3247) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3251 = cute.get_leaves(%1116) : !cute.stride<"1">
        %1117 = cute.get_shape(%e1_3248) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3252 = cute.get_leaves(%1117) : !cute.shape<"16">
        %1118 = cute.get_stride(%e1_3248) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3253 = cute.get_leaves(%1118) : !cute.stride<"1">
        %1119 = cute.get_shape(%e2_3249) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3254 = cute.get_leaves(%1119) : !cute.shape<"16">
        %1120 = cute.get_stride(%e2_3249) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3255 = cute.get_leaves(%1120) : !cute.stride<"1">
        %1121 = cute.static : !cute.layout<"32:1">
        %1122 = cute.get_shape(%1121) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3256 = cute.get_leaves(%1122) : !cute.shape<"32">
        %1123 = cute.get_stride(%1121) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3257 = cute.get_leaves(%1123) : !cute.stride<"1">
        %1124 = cute.static : !cute.shape<"(16,8,16)">
        %e0_3258, %e1_3259, %e2_3260 = cute.get_leaves(%1124) : !cute.shape<"(16,8,16)">
        %1125 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1126 = cute.get_shape(%1125) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_3261, %e1_3262, %e2_3263, %e3_3264, %e4_3265 = cute.get_leaves(%1126) : !cute.shape<"((4,8),(2,2,2))">
        %1127 = cute.get_stride(%1125) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_3266, %e1_3267, %e2_3268, %e3_3269, %e4_3270 = cute.get_leaves(%1127) : !cute.stride<"((32,1),(16,8,128))">
        %1128 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1129 = cute.get_shape(%1128) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3271, %e1_3272, %e2_3273, %e3_3274 = cute.get_leaves(%1129) : !cute.shape<"((4,8),(2,2))">
        %1130 = cute.get_stride(%1128) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_3275, %e1_3276, %e2_3277, %e3_3278 = cute.get_leaves(%1130) : !cute.stride<"((16,1),(8,64))">
        %1131 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1132 = cute.get_shape(%1131) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3279, %e1_3280, %e2_3281, %e3_3282 = cute.get_leaves(%1132) : !cute.shape<"((4,8),(2,2))">
        %1133 = cute.get_stride(%1131) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_3283, %e1_3284, %e2_3285, %e3_3286 = cute.get_leaves(%1133) : !cute.stride<"((32,1),(16,8))">
        %1134 = cute.static : !cute.tile<"[64:1;16:1]">
        %e0_3287, %e1_3288 = cute.get_leaves(%1134) : !cute.tile<"[64:1;16:1]">
        %1135 = cute.get_shape(%e0_3287) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3289 = cute.get_leaves(%1135) : !cute.shape<"64">
        %1136 = cute.get_stride(%e0_3287) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3290 = cute.get_leaves(%1136) : !cute.stride<"1">
        %1137 = cute.get_shape(%e1_3288) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3291 = cute.get_leaves(%1137) : !cute.shape<"16">
        %1138 = cute.get_stride(%e1_3288) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3292 = cute.get_leaves(%1138) : !cute.stride<"1">
        %1139 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
        %1140 = cute.get_shape(%1139) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %e0_3293, %e1_3294, %e2_3295, %e3_3296, %e4_3297, %e5_3298, %e6_3299 = cute.get_leaves(%1140) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %1141 = cute.get_stride(%1139) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %e0_3300, %e1_3301, %e2_3302, %e3_3303, %e4_3304, %e5_3305, %e6_3306 = cute.get_leaves(%1141) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %1142 = cute.static : !cute.layout<"32:1">
        %1143 = cute.get_shape(%1142) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3307 = cute.get_leaves(%1143) : !cute.shape<"32">
        %1144 = cute.get_stride(%1142) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3308 = cute.get_leaves(%1144) : !cute.stride<"1">
        %1145 = cute.static : !cute.layout<"(32,8):(8,1)">
        %1146 = cute.get_shape(%1145) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
        %e0_3309, %e1_3310 = cute.get_leaves(%1146) : !cute.shape<"(32,8)">
        %1147 = cute.get_stride(%1145) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
        %e0_3311, %e1_3312 = cute.get_leaves(%1147) : !cute.stride<"(8,1)">
        %1148 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
        %1149 = cute.get_shape(%1148) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
        %e0_3313, %e1_3314, %e2_3315 = cute.get_leaves(%1149) : !cute.shape<"(32,(2,4))">
        %1150 = cute.get_stride(%1148) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
        %e0_3316, %e1_3317, %e2_3318 = cute.get_leaves(%1150) : !cute.stride<"(2,(1,64))">
        scf.yield %1059#1, %arg7 : !mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3
      }
      %lay_1591 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %rmem_1592 = cute.memref.alloca(%lay_1591) : !memref_rmem_bf16_28
      %iter_1593 = cute.get_iter(%rmem_1592) : !memref_rmem_bf16_28
      %iter_1594 = cute.get_iter(%rmem_1592) : !memref_rmem_bf16_28
      %lay_1595 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %763 = cute.get_shape(%lay_1595) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_1596, %e1_1597, %e2_1598, %e3_1599 = cute.get_leaves(%763) : !cute.shape<"((2,2),1,16)">
      %764 = cute.memref.load_vec %rmem : !memref_rmem_f32_
      %765 = arith.truncf %764 : vector<64xf32> to vector<64xbf16>
      %lay_1600 = cute.get_layout(%rmem_1592) : !memref_rmem_bf16_28
      %766 = cute.get_shape(%lay_1600) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_1601, %e1_1602, %e2_1603, %e3_1604 = cute.get_leaves(%766) : !cute.shape<"((2,2),1,16)">
      %int_tuple_1605 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_1606 = cute.size(%int_tuple_1605) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_1607 = cute.get_leaves(%sz_1606) : !cute.int_tuple<"64">
      %int_tuple_1608 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_1609 = cute.size(%int_tuple_1608) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_1610 = cute.get_leaves(%sz_1609) : !cute.int_tuple<"64">
      cute.memref.store_vec %765, %rmem_1592 : !memref_rmem_bf16_28
      %767 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %iter_1611 = cute.recast_iter(%iter_350) : !cute.ptr<bf16, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>, S<3,4,3>>
      %768 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %view_1612 = cute.make_view(%iter_1611, %768) : !memref_smem_bf16_23
      %iter_1613 = cute.get_iter(%view_1612) : !memref_smem_bf16_23
      %atom_1614 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %769 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %770 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_1615, %e1_1616, %e2_1617 = cute.get_leaves(%770) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_1618 = cute.size(%e0_1615) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_1619 = cute.get_leaves(%sz_1618) : !cute.int_tuple<"64">
      %771 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_1620, %e1_1621, %e2_1622 = cute.get_leaves(%771) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_1623 = cute.size(%e1_1621) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_1624 = cute.get_leaves(%sz_1623) : !cute.int_tuple<"16">
      %tile_1625 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %772 = cute.make_tiled_copy(%atom_1614) : !copy_simt1
      %retiled_1626 = cute.tiled.copy.retile(%772, %rmem_1592) : (!copy_simt1, !memref_rmem_bf16_28) -> !memref_rmem_bf16_29
      %iter_1627 = cute.get_iter(%retiled_1626) : !memref_rmem_bf16_29
      %coord_1628 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_1629 = cute.tiled.copy.partition_D(%772, %view_1612, %coord_1628) : (!copy_simt1, !memref_smem_bf16_23, !cute.coord<"?">) -> !memref_smem_bf16_24
      %iter_1630 = cute.get_iter(%dst_partitioned_1629) : !memref_smem_bf16_24
      %lay_1631 = cute.get_layout(%retiled_1626) : !memref_rmem_bf16_29
      %773 = cute.get_shape(%lay_1631) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_1632, %e1_1633, %e2_1634, %e3_1635 = cute.get_leaves(%773) : !cute.shape<"((1,8),1,8)">
      %lay_1636 = cute.get_layout(%dst_partitioned_1629) : !memref_smem_bf16_24
      %774 = cute.get_shape(%lay_1636) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_1637, %e1_1638, %e2_1639, %e3_1640, %e4_1641, %e5_1642, %e6_1643 = cute.get_leaves(%774) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %lay_1644 = cute.get_layout(%retiled_1626) : !memref_rmem_bf16_29
      %shape_1645 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1646 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_1644, %lay_1646) : !cute.layout<"((1,8),1,8):((0,1),0,8)">, !cute.layout<"1:0">
      %view_1647 = cute.make_view(%iter_1627, %append) : !memref_rmem_bf16_29
      %iter_1648 = cute.get_iter(%view_1647) : !memref_rmem_bf16_29
      %lay_1649 = cute.get_layout(%view_1647) : !memref_rmem_bf16_29
      %775 = cute.get_shape(%lay_1649) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_1650, %e1_1651, %e2_1652, %e3_1653 = cute.get_leaves(%775) : !cute.shape<"((1,8),1,8)">
      %iter_1654 = cute.get_iter(%view_1647) : !memref_rmem_bf16_29
      %view_1655 = cute.make_view(%iter_1654) : !memref_rmem_bf16_30
      %iter_1656 = cute.get_iter(%view_1655) : !memref_rmem_bf16_30
      %iter_1657 = cute.get_iter(%view_1655) : !memref_rmem_bf16_30
      %lay_1658 = cute.get_layout(%dst_partitioned_1629) : !memref_smem_bf16_24
      %shape_1659 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1660 = cute.make_layout() : !cute.layout<"1:0">
      %append_1661 = cute.append_to_rank<2> (%lay_1658, %lay_1660) : !cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">, !cute.layout<"1:0">
      %view_1662 = cute.make_view(%iter_1630, %append_1661) : !memref_smem_bf16_24
      %iter_1663 = cute.get_iter(%view_1662) : !memref_smem_bf16_24
      %lay_1664 = cute.get_layout(%view_1662) : !memref_smem_bf16_24
      %776 = cute.get_shape(%lay_1664) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_1665, %e1_1666, %e2_1667, %e3_1668, %e4_1669, %e5_1670, %e6_1671 = cute.get_leaves(%776) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %iter_1672 = cute.get_iter(%view_1662) : !memref_smem_bf16_24
      %view_1673 = cute.make_view(%iter_1672) : !memref_smem_bf16_25
      %iter_1674 = cute.get_iter(%view_1673) : !memref_smem_bf16_25
      %iter_1675 = cute.get_iter(%view_1673) : !memref_smem_bf16_25
      %lay_1676 = cute.get_layout(%view_1655) : !memref_rmem_bf16_30
      %777 = cute.get_shape(%lay_1676) : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.shape<"((1,8),(1,8))">
      %e0_1677, %e1_1678, %e2_1679, %e3_1680 = cute.get_leaves(%777) : !cute.shape<"((1,8),(1,8))">
      %lay_1681 = cute.get_layout(%view_1673) : !memref_smem_bf16_25
      %778 = cute.get_shape(%lay_1681) : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %e0_1682, %e1_1683, %e2_1684, %e3_1685, %e4_1686, %e5_1687, %e6_1688 = cute.get_leaves(%778) : !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %lay_1689 = cute.get_layout(%view_1655) : !memref_rmem_bf16_30
      %sz_1690 = cute.size(%lay_1689) <{mode = [1]}> : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.int_tuple<"8">
      %e0_1691 = cute.get_leaves(%sz_1690) : !cute.int_tuple<"8">
      %lay_1692 = cute.get_layout(%view_1673) : !memref_smem_bf16_25
      %sz_1693 = cute.size(%lay_1692) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.int_tuple<"8">
      %e0_1694 = cute.get_leaves(%sz_1693) : !cute.int_tuple<"8">
      %779 = cute.static : !cute.layout<"1:0">
      %iter_1695 = cute.get_iter(%view_1655) : !memref_rmem_bf16_30
      %iter_1696 = cute.get_iter(%view_1673) : !memref_smem_bf16_25
      %lay_1697 = cute.get_layout(%view_1655) : !memref_rmem_bf16_30
      %lay_1698 = cute.get_layout(%view_1673) : !memref_smem_bf16_25
      %append_1699 = cute.append_to_rank<2> (%lay_1697, %779) : !cute.layout<"((1,8),(1,8)):((0,1),(0,8))">, !cute.layout<"1:0">
      %append_1700 = cute.append_to_rank<2> (%lay_1698, %779) : !cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">, !cute.layout<"1:0">
      %lay_1701 = cute.make_layout() : !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">
      %lay_1702 = cute.make_layout() : !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">
      %sz_1703 = cute.size(%lay_1701) <{mode = [1]}> : (!cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"8">
      %780 = cute.get_scalars(%sz_1703) : !cute.int_tuple<"8">
      %c0_i32_1704 = arith.constant 0 : i32
      %c1_i32_1705 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1704 to %780 step %c1_i32_1705  : i32 {
        %coord_2084 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_2085 = cute.slice(%lay_1701, %coord_2084) : !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">, !cute.coord<"(_,?)">
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_1701) : (!cute.coord<"(_,?)">, !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2087 = cute.add_offset(%iter_1695, %idx_2086) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2088 = cute.make_view(%ptr_2087, %slice_2085) : !memref_rmem_bf16_31
        %slice_2089 = cute.slice(%lay_1702, %coord_2084) : !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">, !cute.coord<"(_,?)">
        %idx_2090 = cute.crd2idx(%coord_2084, %lay_1702) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_2091 = cute.add_offset(%iter_1696, %idx_2090) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %view_2092 = cute.make_view(%ptr_2091, %slice_2089) : !memref_smem_bf16_26
        cute.copy_atom_call(%atom_1614, %view_2088, %view_2092) : (!cute_nvgpu.atom.universal_copy<bf16>, !memref_rmem_bf16_31, !memref_smem_bf16_26) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1706 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1707 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %slice_1708 = cute.slice(%lay_1707, %coord_1706) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_1709 = cute.crd2idx(%coord_1706, %lay_1707) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_1710 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_1711 = cute.add_offset(%iter_1710, %idx_1709) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_1712 = cute.make_view(%ptr_1711, %slice_1708) : !memref_gmem_bf16_1
      %iter_1713 = cute.get_iter(%view_1712) : !memref_gmem_bf16_1
      %iter_1714 = cute.get_iter(%view_1712) : !memref_gmem_bf16_1
      %tile_1715 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1716 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %781 = cute.get_scalars(%coord_1716) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1717 = cute.make_coord(%781) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1718 = cute.get_layout(%view_1712) : !memref_gmem_bf16_1
      %782:3 = cute.get_scalars(%lay_1718) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_1719 = arith.constant 64 : i32
      %783 = arith.ceildivsi %782#0, %c64_i32_1719 : i32
      %c64_i64_1720 = arith.constant 64 : i64
      %784 = arith.muli %782#2, %c64_i64_1720 : i64
      %c128_i32_1721 = arith.constant 128 : i32
      %785 = arith.ceildivsi %782#1, %c128_i32_1721 : i32
      %shape_1722 = cute.make_shape(%783, %785) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_1723 = cute.assume(%782#2) : (i64) -> !cute.i64<divby 8>
      %iv_1724 = cute.assume(%784) : (i64) -> !cute.i64<divby 512>
      %stride_1725 = cute.make_stride(%iv_1723, %iv_1724) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_1726 = cute.make_layout(%shape_1722, %stride_1725) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_1727 = cute.slice(%lay_1726, %coord_1717) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_1728 = cute.crd2idx(%coord_1717, %lay_1726) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_1729 = cute.get_iter(%view_1712) : !memref_gmem_bf16_1
      %ptr_1730 = cute.add_offset(%iter_1729, %idx_1728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_1731 = cute.make_view(%ptr_1730, %slice_1727) : !memref_gmem_bf16_2
      %iter_1732 = cute.get_iter(%view_1731) : !memref_gmem_bf16_2
      %coord_1733 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %src_partitioned_1734 = cute.tiled.copy.partition_S(%5, %view_1612, %coord_1733) : (!copy_simt, !memref_smem_bf16_23, !cute.coord<"?">) -> !memref_smem_bf16_27
      %iter_1735 = cute.get_iter(%src_partitioned_1734) : !memref_smem_bf16_27
      %coord_1736 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_1737 = cute.tiled.copy.partition_D(%5, %view_1731, %coord_1736) : (!copy_simt, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_1738 = cute.get_iter(%dst_partitioned_1737) : !memref_gmem_bf16_5
      %lay_1739 = cute.get_layout(%dst_partitioned_1737) : !memref_gmem_bf16_5
      %786 = cute.make_layout_like(%lay_1739) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)"> to !cute.layout<"((8,1),4,2):((1,0),16,8)">
      %rmem_1740 = cute.memref.alloca(%786) : !memref_rmem_bf16_32
      %iter_1741 = cute.get_iter(%rmem_1740) : !memref_rmem_bf16_32
      %iter_1742 = cute.get_iter(%rmem_1740) : !memref_rmem_bf16_32
      %c1_i32_1743 = arith.constant 1 : i32
      %c128_i32_1744 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_1743 number_of_threads = %c128_i32_1744
      %lay_1745 = cute.get_layout(%src_partitioned_1734) : !memref_smem_bf16_27
      %787 = cute.get_shape(%lay_1745) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1746, %e1_1747, %e2_1748, %e3_1749 = cute.get_leaves(%787) : !cute.shape<"((8,1),4,2)">
      %lay_1750 = cute.get_layout(%rmem_1740) : !memref_rmem_bf16_32
      %788 = cute.get_shape(%lay_1750) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1751, %e1_1752, %e2_1753, %e3_1754 = cute.get_leaves(%788) : !cute.shape<"((8,1),4,2)">
      %lay_1755 = cute.get_layout(%src_partitioned_1734) : !memref_smem_bf16_27
      %shape_1756 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1757 = cute.make_layout() : !cute.layout<"1:0">
      %append_1758 = cute.append_to_rank<2> (%lay_1755, %lay_1757) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
      %view_1759 = cute.make_view(%iter_1735, %append_1758) : !memref_smem_bf16_27
      %iter_1760 = cute.get_iter(%view_1759) : !memref_smem_bf16_27
      %lay_1761 = cute.get_layout(%view_1759) : !memref_smem_bf16_27
      %789 = cute.get_shape(%lay_1761) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1762, %e1_1763, %e2_1764, %e3_1765 = cute.get_leaves(%789) : !cute.shape<"((8,1),4,2)">
      %iter_1766 = cute.get_iter(%view_1759) : !memref_smem_bf16_27
      %view_1767 = cute.make_view(%iter_1766) : !memref_smem_bf16_28
      %iter_1768 = cute.get_iter(%view_1767) : !memref_smem_bf16_28
      %iter_1769 = cute.get_iter(%view_1767) : !memref_smem_bf16_28
      %lay_1770 = cute.get_layout(%rmem_1740) : !memref_rmem_bf16_32
      %shape_1771 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1772 = cute.make_layout() : !cute.layout<"1:0">
      %append_1773 = cute.append_to_rank<2> (%lay_1770, %lay_1772) : !cute.layout<"((8,1),4,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_1774 = cute.make_view(%iter_1742, %append_1773) : !memref_rmem_bf16_32
      %iter_1775 = cute.get_iter(%view_1774) : !memref_rmem_bf16_32
      %lay_1776 = cute.get_layout(%view_1774) : !memref_rmem_bf16_32
      %790 = cute.get_shape(%lay_1776) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1777, %e1_1778, %e2_1779, %e3_1780 = cute.get_leaves(%790) : !cute.shape<"((8,1),4,2)">
      %iter_1781 = cute.get_iter(%view_1774) : !memref_rmem_bf16_32
      %view_1782 = cute.make_view(%iter_1781) : !memref_rmem_bf16_33
      %iter_1783 = cute.get_iter(%view_1782) : !memref_rmem_bf16_33
      %iter_1784 = cute.get_iter(%view_1782) : !memref_rmem_bf16_33
      %lay_1785 = cute.get_layout(%view_1767) : !memref_smem_bf16_28
      %791 = cute.get_shape(%lay_1785) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_1786, %e1_1787, %e2_1788, %e3_1789 = cute.get_leaves(%791) : !cute.shape<"((8,1),(4,2))">
      %lay_1790 = cute.get_layout(%view_1782) : !memref_rmem_bf16_33
      %792 = cute.get_shape(%lay_1790) : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_1791, %e1_1792, %e2_1793, %e3_1794 = cute.get_leaves(%792) : !cute.shape<"((8,1),(4,2))">
      %lay_1795 = cute.get_layout(%view_1767) : !memref_smem_bf16_28
      %sz_1796 = cute.size(%lay_1795) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
      %e0_1797 = cute.get_leaves(%sz_1796) : !cute.int_tuple<"8">
      %lay_1798 = cute.get_layout(%view_1782) : !memref_rmem_bf16_33
      %sz_1799 = cute.size(%lay_1798) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.int_tuple<"8">
      %e0_1800 = cute.get_leaves(%sz_1799) : !cute.int_tuple<"8">
      %793 = cute.static : !cute.layout<"1:0">
      %iter_1801 = cute.get_iter(%view_1767) : !memref_smem_bf16_28
      %iter_1802 = cute.get_iter(%view_1782) : !memref_rmem_bf16_33
      %lay_1803 = cute.get_layout(%view_1767) : !memref_smem_bf16_28
      %lay_1804 = cute.get_layout(%view_1782) : !memref_rmem_bf16_33
      %append_1805 = cute.append_to_rank<2> (%lay_1803, %793) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
      %append_1806 = cute.append_to_rank<2> (%lay_1804, %793) : !cute.layout<"((8,1),(4,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_1807 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
      %lay_1808 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">
      %sz_1809 = cute.size(%lay_1807) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"8">
      %794 = cute.get_scalars(%sz_1809) : !cute.int_tuple<"8">
      %c0_i32_1810 = arith.constant 0 : i32
      %c1_i32_1811 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1810 to %794 step %c1_i32_1811  : i32 {
        %coord_2084 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_2085 = cute.slice(%lay_1807, %coord_2084) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_1807) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_2087 = cute.add_offset(%iter_1801, %idx_2086) : (!cute.ptr<bf16, smem, align<16>, S<3,4,3>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
        %view_2088 = cute.make_view(%ptr_2087, %slice_2085) : !memref_smem_bf16_29
        %slice_2089 = cute.slice(%lay_1808, %coord_2084) : !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">, !cute.coord<"(_,?)">
        %idx_2090 = cute.crd2idx(%coord_2084, %lay_1808) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2091 = cute.add_offset(%iter_1802, %idx_2090) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2092 = cute.make_view(%ptr_2091, %slice_2089) : !memref_rmem_bf16_9
        cute.copy_atom_call(%5, %view_2088, %view_2092) : (!copy_simt, !memref_smem_bf16_29, !memref_rmem_bf16_9) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_1812 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %795 = cute.get_shape(%lay_1812) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1813, %e1_1814, %e2_1815, %e3_1816 = cute.get_leaves(%795) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1817 = cute.to_int_tuple(%e0_1813) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %796 = cute.get_scalars(%itup_1817) : !cute.int_tuple<"?">
      %itup_1818 = cute.to_int_tuple(%e1_1814) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %797 = cute.get_scalars(%itup_1818) : !cute.int_tuple<"?">
      %itup_1819 = cute.to_int_tuple(%e2_1815) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %798 = cute.get_scalars(%itup_1819) : !cute.int_tuple<"?">
      %itup_1820 = cute.to_int_tuple(%e3_1816) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %799 = cute.get_scalars(%itup_1820) : !cute.int_tuple<"?{div=8}">
      %shape_1821 = cute.make_shape(%itup_1817, %itup_1818, %itup_1819, %itup_1820) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %800 = cute.make_identity_tensor(%shape_1821) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1822 = cute.get_iter(%800) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1823, %e1_1824, %e2_1825, %e3_1826 = cute.get_leaves(%iter_1822) : !cute.int_tuple<"(0,0,0,0)">
      %coord_1827 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1828 = cute.get_layout(%800) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_1829 = cute.slice(%lay_1828, %coord_1827) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_1830 = cute.crd2idx(%coord_1827, %lay_1828) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_1831 = cute.get_iter(%800) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_1832 = cute.add_offset(%iter_1831, %idx_1830) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_1833 = cute.make_view(%tup_1832, %slice_1829) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_1834 = cute.get_iter(%view_1833) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1835, %e1_1836, %e2_1837, %e3_1838 = cute.get_leaves(%iter_1834) : !cute.int_tuple<"(?,0,?,0)">
      %801 = cute.get_scalars(%e0_1835) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e2_1837) : !cute.int_tuple<"?">
      %iter_1839 = cute.get_iter(%view_1833) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1840, %e1_1841, %e2_1842, %e3_1843 = cute.get_leaves(%iter_1839) : !cute.int_tuple<"(?,0,?,0)">
      %803 = cute.get_scalars(%e0_1840) : !cute.int_tuple<"?">
      %804 = cute.get_scalars(%e2_1842) : !cute.int_tuple<"?">
      %tile_1844 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1845 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %805 = cute.get_scalars(%coord_1845) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1846 = cute.make_coord(%805) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1847 = cute.get_layout(%view_1833) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %806:2 = cute.get_scalars(%lay_1847) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_1848 = arith.constant 64 : i32
      %807 = arith.ceildivsi %806#0, %c64_i32_1848 : i32
      %c128_i32_1849 = arith.constant 128 : i32
      %808 = arith.ceildivsi %806#1, %c128_i32_1849 : i32
      %shape_1850 = cute.make_shape(%807, %808) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_1851 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_1852 = cute.make_layout(%shape_1850, %stride_1851) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_1853 = cute.crd2idx(%coord_1846, %lay_1852) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_1854 = cute.get_iter(%view_1833) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_1855 = cute.add_offset(%iter_1854, %idx_1853) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_1856 = cute.make_view(%tup_1855) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_1857 = cute.get_iter(%view_1856) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_1858, %e1_1859, %e2_1860, %e3_1861 = cute.get_leaves(%iter_1857) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %809 = cute.get_scalars(%e0_1858) : !cute.int_tuple<"?">
      %810 = cute.get_scalars(%e1_1859) : !cute.int_tuple<"?{div=64}">
      %811 = cute.get_scalars(%e2_1860) : !cute.int_tuple<"?">
      %coord_1862 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %dst_partitioned_1863 = cute.tiled.copy.partition_D(%5, %view_1856, %coord_1862) : (!copy_simt, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1864 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1865, %e1_1866, %e2_1867, %e3_1868 = cute.get_leaves(%iter_1864) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %812 = cute.get_scalars(%e0_1865) : !cute.int_tuple<"?">
      %813 = cute.get_scalars(%e1_1866) : !cute.int_tuple<"?">
      %814 = cute.get_scalars(%e2_1867) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e3_1868) : !cute.int_tuple<"?{div=8}">
      %lay_1869 = cute.get_layout(%dst_partitioned_1737) : !memref_gmem_bf16_5
      %816 = cute.get_shape(%lay_1869) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1870, %e1_1871, %e2_1872, %e3_1873 = cute.get_leaves(%816) : !cute.shape<"((8,1),4,2)">
      %shape_1874 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1875 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1876 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1877 = cute.memref.alloca(%lay_1876) : !memref_rmem_i8_
      %iter_1878 = cute.get_iter(%rmem_1877) : !memref_rmem_i8_
      %iter_1879 = cute.get_iter(%rmem_1877) : !memref_rmem_i8_
      %lay_1880 = cute.get_layout(%rmem_1877) : !memref_rmem_i8_
      %817 = cute.get_shape(%lay_1880) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1881, %e1_1882, %e2_1883 = cute.get_leaves(%817) : !cute.shape<"(1,4,2)">
      %int_tuple_1884 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_1885 = cute.size(%int_tuple_1884) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_1886 = cute.get_leaves(%sz_1885) : !cute.int_tuple<"2">
      %coord_1887 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1888 = cute.get_layout(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1889 = cute.crd2idx(%coord_1887, %lay_1888) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1890 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1891 = cute.add_offset(%iter_1890, %idx_1889) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1892 = cute.make_view(%tup_1891) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1893 = cute.get_iter(%view_1892) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1894, %e1_1895, %e2_1896, %e3_1897 = cute.get_leaves(%iter_1893) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %818 = cute.get_scalars(%e0_1894) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e1_1895) : !cute.int_tuple<"?">
      %820 = cute.get_scalars(%e2_1896) : !cute.int_tuple<"?">
      %821 = cute.get_scalars(%e3_1897) : !cute.int_tuple<"?{div=8}">
      %iter_1898 = cute.get_iter(%view_1892) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1899, %e1_1900, %e2_1901, %e3_1902 = cute.get_leaves(%iter_1898) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %822 = cute.get_scalars(%e0_1899) : !cute.int_tuple<"?">
      %823 = cute.get_scalars(%e1_1900) : !cute.int_tuple<"?">
      %824 = cute.get_scalars(%e2_1901) : !cute.int_tuple<"?">
      %825 = cute.get_scalars(%e3_1902) : !cute.int_tuple<"?{div=8}">
      %iter_1903 = cute.get_iter(%view_1892) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1904, %e1_1905, %e2_1906, %e3_1907 = cute.get_leaves(%iter_1903) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %826 = cute.get_scalars(%e0_1904) : !cute.int_tuple<"?">
      %827 = cute.get_scalars(%e1_1905) : !cute.int_tuple<"?">
      %828 = cute.get_scalars(%e2_1906) : !cute.int_tuple<"?">
      %829 = cute.get_scalars(%e3_1907) : !cute.int_tuple<"?{div=8}">
      %lay_1908 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %830 = cute.get_shape(%lay_1908) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1909, %e1_1910, %e2_1911, %e3_1912 = cute.get_leaves(%830) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1913 = cute.to_int_tuple(%e0_1909) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %831 = cute.get_scalars(%itup_1913) : !cute.int_tuple<"?">
      %itup_1914 = cute.to_int_tuple(%e1_1910) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %832 = cute.get_scalars(%itup_1914) : !cute.int_tuple<"?">
      %itup_1915 = cute.to_int_tuple(%e2_1911) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %833 = cute.get_scalars(%itup_1915) : !cute.int_tuple<"?">
      %itup_1916 = cute.to_int_tuple(%e3_1912) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %834 = cute.get_scalars(%itup_1916) : !cute.int_tuple<"?{div=8}">
      %coord_1917 = cute.make_coord(%e3_1907) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1918 = cute.make_coord(%itup_1916) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %835 = cute.elem_less(%coord_1917, %coord_1918) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %836 = arith.extui %835 : i1 to i8
      %coord_1919 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1877, %coord_1919, %836) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1920 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1921 = cute.get_layout(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1922 = cute.crd2idx(%coord_1920, %lay_1921) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1923 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1924 = cute.add_offset(%iter_1923, %idx_1922) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1925 = cute.make_view(%tup_1924) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1926 = cute.get_iter(%view_1925) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1927, %e1_1928, %e2_1929, %e3_1930 = cute.get_leaves(%iter_1926) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %837 = cute.get_scalars(%e0_1927) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e1_1928) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e2_1929) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e3_1930) : !cute.int_tuple<"?{div=8}">
      %iter_1931 = cute.get_iter(%view_1925) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1932, %e1_1933, %e2_1934, %e3_1935 = cute.get_leaves(%iter_1931) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %841 = cute.get_scalars(%e0_1932) : !cute.int_tuple<"?">
      %842 = cute.get_scalars(%e1_1933) : !cute.int_tuple<"?">
      %843 = cute.get_scalars(%e2_1934) : !cute.int_tuple<"?">
      %844 = cute.get_scalars(%e3_1935) : !cute.int_tuple<"?{div=8}">
      %iter_1936 = cute.get_iter(%view_1925) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1937, %e1_1938, %e2_1939, %e3_1940 = cute.get_leaves(%iter_1936) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %845 = cute.get_scalars(%e0_1937) : !cute.int_tuple<"?">
      %846 = cute.get_scalars(%e1_1938) : !cute.int_tuple<"?">
      %847 = cute.get_scalars(%e2_1939) : !cute.int_tuple<"?">
      %848 = cute.get_scalars(%e3_1940) : !cute.int_tuple<"?{div=8}">
      %lay_1941 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %849 = cute.get_shape(%lay_1941) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1942, %e1_1943, %e2_1944, %e3_1945 = cute.get_leaves(%849) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1946 = cute.to_int_tuple(%e0_1942) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %850 = cute.get_scalars(%itup_1946) : !cute.int_tuple<"?">
      %itup_1947 = cute.to_int_tuple(%e1_1943) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %851 = cute.get_scalars(%itup_1947) : !cute.int_tuple<"?">
      %itup_1948 = cute.to_int_tuple(%e2_1944) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %852 = cute.get_scalars(%itup_1948) : !cute.int_tuple<"?">
      %itup_1949 = cute.to_int_tuple(%e3_1945) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %853 = cute.get_scalars(%itup_1949) : !cute.int_tuple<"?{div=8}">
      %coord_1950 = cute.make_coord(%e3_1940) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1951 = cute.make_coord(%itup_1949) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %854 = cute.elem_less(%coord_1950, %coord_1951) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %855 = arith.extui %854 : i1 to i8
      %coord_1952 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1877, %coord_1952, %855) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_1953 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1954 = cute.size(%int_tuple_1953) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1955 = cute.get_leaves(%sz_1954) : !cute.int_tuple<"4">
      %coord_1956 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1957 = cute.get_layout(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1958 = cute.crd2idx(%coord_1956, %lay_1957) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1959 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1960 = cute.add_offset(%iter_1959, %idx_1958) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1961 = cute.make_view(%tup_1960) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1962 = cute.get_iter(%view_1961) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1963, %e1_1964, %e2_1965, %e3_1966 = cute.get_leaves(%iter_1962) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %856 = cute.get_scalars(%e0_1963) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e1_1964) : !cute.int_tuple<"?">
      %858 = cute.get_scalars(%e2_1965) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e3_1966) : !cute.int_tuple<"?{div=8}">
      %iter_1967 = cute.get_iter(%view_1961) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1968, %e1_1969, %e2_1970, %e3_1971 = cute.get_leaves(%iter_1967) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %860 = cute.get_scalars(%e0_1968) : !cute.int_tuple<"?">
      %861 = cute.get_scalars(%e1_1969) : !cute.int_tuple<"?">
      %862 = cute.get_scalars(%e2_1970) : !cute.int_tuple<"?">
      %863 = cute.get_scalars(%e3_1971) : !cute.int_tuple<"?{div=8}">
      %iter_1972 = cute.get_iter(%view_1961) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1973, %e1_1974, %e2_1975, %e3_1976 = cute.get_leaves(%iter_1972) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %864 = cute.get_scalars(%e0_1973) : !cute.int_tuple<"?">
      %865 = cute.get_scalars(%e1_1974) : !cute.int_tuple<"?">
      %866 = cute.get_scalars(%e2_1975) : !cute.int_tuple<"?">
      %867 = cute.get_scalars(%e3_1976) : !cute.int_tuple<"?{div=8}">
      %lay_1977 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %868 = cute.get_shape(%lay_1977) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1978, %e1_1979, %e2_1980, %e3_1981 = cute.get_leaves(%868) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1982 = cute.to_int_tuple(%e0_1978) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %869 = cute.get_scalars(%itup_1982) : !cute.int_tuple<"?">
      %itup_1983 = cute.to_int_tuple(%e1_1979) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %870 = cute.get_scalars(%itup_1983) : !cute.int_tuple<"?">
      %itup_1984 = cute.to_int_tuple(%e2_1980) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %871 = cute.get_scalars(%itup_1984) : !cute.int_tuple<"?">
      %itup_1985 = cute.to_int_tuple(%e3_1981) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %872 = cute.get_scalars(%itup_1985) : !cute.int_tuple<"?{div=8}">
      %coord_1986 = cute.make_coord(%e1_1974) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1987 = cute.make_coord(%itup_1983) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %873 = cute.elem_less(%coord_1986, %coord_1987) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %873 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2085 = cute.get_layout(%rmem_1740) : !memref_rmem_bf16_32
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_2087 = cute.get_iter(%rmem_1740) : !memref_rmem_bf16_32
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_rmem_bf16_34
        %iter_2090 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %iter_2091 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2095 = cute.get_iter(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_gmem_bf16_8
        %iter_2098 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %iter_2099 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2101 = cute.get_layout(%rmem_1877) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_1877) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_rmem_bf16_34
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_bf16_34
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %view_2127 = cute.make_view(%iter_2126) : !memref_rmem_bf16_35
        %iter_2128 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2129 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %lay_2130 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_gmem_bf16_8
        %iter_2135 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %lay_2136 = cute.get_layout(%view_2134) : !memref_gmem_bf16_8
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %view_2141 = cute.make_view(%iter_2140) : !memref_gmem_bf16_9
        %iter_2142 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %iter_2143 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2172 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2173 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %lay_2174 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_rmem_bf16_9
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_gmem_bf16_10
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2190, %view_2194, %view_2198) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_1988 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1989 = cute.get_layout(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1990 = cute.crd2idx(%coord_1988, %lay_1989) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1991 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1992 = cute.add_offset(%iter_1991, %idx_1990) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1993 = cute.make_view(%tup_1992) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1994 = cute.get_iter(%view_1993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1995, %e1_1996, %e2_1997, %e3_1998 = cute.get_leaves(%iter_1994) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %874 = cute.get_scalars(%e0_1995) : !cute.int_tuple<"?">
      %875 = cute.get_scalars(%e1_1996) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e2_1997) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e3_1998) : !cute.int_tuple<"?{div=8}">
      %iter_1999 = cute.get_iter(%view_1993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2000, %e1_2001, %e2_2002, %e3_2003 = cute.get_leaves(%iter_1999) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %878 = cute.get_scalars(%e0_2000) : !cute.int_tuple<"?">
      %879 = cute.get_scalars(%e1_2001) : !cute.int_tuple<"?">
      %880 = cute.get_scalars(%e2_2002) : !cute.int_tuple<"?">
      %881 = cute.get_scalars(%e3_2003) : !cute.int_tuple<"?{div=8}">
      %iter_2004 = cute.get_iter(%view_1993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2005, %e1_2006, %e2_2007, %e3_2008 = cute.get_leaves(%iter_2004) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %882 = cute.get_scalars(%e0_2005) : !cute.int_tuple<"?">
      %883 = cute.get_scalars(%e1_2006) : !cute.int_tuple<"?">
      %884 = cute.get_scalars(%e2_2007) : !cute.int_tuple<"?">
      %885 = cute.get_scalars(%e3_2008) : !cute.int_tuple<"?{div=8}">
      %lay_2009 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %886 = cute.get_shape(%lay_2009) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2010, %e1_2011, %e2_2012, %e3_2013 = cute.get_leaves(%886) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2014 = cute.to_int_tuple(%e0_2010) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %887 = cute.get_scalars(%itup_2014) : !cute.int_tuple<"?">
      %itup_2015 = cute.to_int_tuple(%e1_2011) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %888 = cute.get_scalars(%itup_2015) : !cute.int_tuple<"?">
      %itup_2016 = cute.to_int_tuple(%e2_2012) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %889 = cute.get_scalars(%itup_2016) : !cute.int_tuple<"?">
      %itup_2017 = cute.to_int_tuple(%e3_2013) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %890 = cute.get_scalars(%itup_2017) : !cute.int_tuple<"?{div=8}">
      %coord_2018 = cute.make_coord(%e1_2006) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2019 = cute.make_coord(%itup_2015) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %891 = cute.elem_less(%coord_2018, %coord_2019) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %891 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2085 = cute.get_layout(%rmem_1740) : !memref_rmem_bf16_32
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_2087 = cute.get_iter(%rmem_1740) : !memref_rmem_bf16_32
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_rmem_bf16_34
        %iter_2090 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %iter_2091 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2095 = cute.get_iter(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_gmem_bf16_8
        %iter_2098 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %iter_2099 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2101 = cute.get_layout(%rmem_1877) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_1877) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_rmem_bf16_34
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_bf16_34
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %view_2127 = cute.make_view(%iter_2126) : !memref_rmem_bf16_35
        %iter_2128 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2129 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %lay_2130 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_gmem_bf16_8
        %iter_2135 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %lay_2136 = cute.get_layout(%view_2134) : !memref_gmem_bf16_8
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %view_2141 = cute.make_view(%iter_2140) : !memref_gmem_bf16_9
        %iter_2142 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %iter_2143 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2172 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2173 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %lay_2174 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_rmem_bf16_9
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_gmem_bf16_10
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2190, %view_2194, %view_2198) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2020 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_2021 = cute.get_layout(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2022 = cute.crd2idx(%coord_2020, %lay_2021) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_2023 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2024 = cute.add_offset(%iter_2023, %idx_2022) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2025 = cute.make_view(%tup_2024) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2026 = cute.get_iter(%view_2025) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2027, %e1_2028, %e2_2029, %e3_2030 = cute.get_leaves(%iter_2026) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %892 = cute.get_scalars(%e0_2027) : !cute.int_tuple<"?">
      %893 = cute.get_scalars(%e1_2028) : !cute.int_tuple<"?">
      %894 = cute.get_scalars(%e2_2029) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e3_2030) : !cute.int_tuple<"?{div=8}">
      %iter_2031 = cute.get_iter(%view_2025) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2032, %e1_2033, %e2_2034, %e3_2035 = cute.get_leaves(%iter_2031) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %896 = cute.get_scalars(%e0_2032) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e1_2033) : !cute.int_tuple<"?">
      %898 = cute.get_scalars(%e2_2034) : !cute.int_tuple<"?">
      %899 = cute.get_scalars(%e3_2035) : !cute.int_tuple<"?{div=8}">
      %iter_2036 = cute.get_iter(%view_2025) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2037, %e1_2038, %e2_2039, %e3_2040 = cute.get_leaves(%iter_2036) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %900 = cute.get_scalars(%e0_2037) : !cute.int_tuple<"?">
      %901 = cute.get_scalars(%e1_2038) : !cute.int_tuple<"?">
      %902 = cute.get_scalars(%e2_2039) : !cute.int_tuple<"?">
      %903 = cute.get_scalars(%e3_2040) : !cute.int_tuple<"?{div=8}">
      %lay_2041 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %904 = cute.get_shape(%lay_2041) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2042, %e1_2043, %e2_2044, %e3_2045 = cute.get_leaves(%904) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2046 = cute.to_int_tuple(%e0_2042) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %905 = cute.get_scalars(%itup_2046) : !cute.int_tuple<"?">
      %itup_2047 = cute.to_int_tuple(%e1_2043) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %906 = cute.get_scalars(%itup_2047) : !cute.int_tuple<"?">
      %itup_2048 = cute.to_int_tuple(%e2_2044) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %907 = cute.get_scalars(%itup_2048) : !cute.int_tuple<"?">
      %itup_2049 = cute.to_int_tuple(%e3_2045) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %908 = cute.get_scalars(%itup_2049) : !cute.int_tuple<"?{div=8}">
      %coord_2050 = cute.make_coord(%e1_2038) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2051 = cute.make_coord(%itup_2047) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %909 = cute.elem_less(%coord_2050, %coord_2051) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %909 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2085 = cute.get_layout(%rmem_1740) : !memref_rmem_bf16_32
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_2087 = cute.get_iter(%rmem_1740) : !memref_rmem_bf16_32
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_rmem_bf16_34
        %iter_2090 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %iter_2091 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2095 = cute.get_iter(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_gmem_bf16_8
        %iter_2098 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %iter_2099 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2101 = cute.get_layout(%rmem_1877) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_1877) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_rmem_bf16_34
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_bf16_34
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %view_2127 = cute.make_view(%iter_2126) : !memref_rmem_bf16_35
        %iter_2128 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2129 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %lay_2130 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_gmem_bf16_8
        %iter_2135 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %lay_2136 = cute.get_layout(%view_2134) : !memref_gmem_bf16_8
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %view_2141 = cute.make_view(%iter_2140) : !memref_gmem_bf16_9
        %iter_2142 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %iter_2143 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2172 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2173 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %lay_2174 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_rmem_bf16_9
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_gmem_bf16_10
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2190, %view_2194, %view_2198) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2052 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_2053 = cute.get_layout(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2054 = cute.crd2idx(%coord_2052, %lay_2053) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_2055 = cute.get_iter(%dst_partitioned_1863) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2056 = cute.add_offset(%iter_2055, %idx_2054) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2057 = cute.make_view(%tup_2056) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2058 = cute.get_iter(%view_2057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2059, %e1_2060, %e2_2061, %e3_2062 = cute.get_leaves(%iter_2058) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %910 = cute.get_scalars(%e0_2059) : !cute.int_tuple<"?">
      %911 = cute.get_scalars(%e1_2060) : !cute.int_tuple<"?">
      %912 = cute.get_scalars(%e2_2061) : !cute.int_tuple<"?">
      %913 = cute.get_scalars(%e3_2062) : !cute.int_tuple<"?{div=8}">
      %iter_2063 = cute.get_iter(%view_2057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2064, %e1_2065, %e2_2066, %e3_2067 = cute.get_leaves(%iter_2063) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %914 = cute.get_scalars(%e0_2064) : !cute.int_tuple<"?">
      %915 = cute.get_scalars(%e1_2065) : !cute.int_tuple<"?">
      %916 = cute.get_scalars(%e2_2066) : !cute.int_tuple<"?">
      %917 = cute.get_scalars(%e3_2067) : !cute.int_tuple<"?{div=8}">
      %iter_2068 = cute.get_iter(%view_2057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2069, %e1_2070, %e2_2071, %e3_2072 = cute.get_leaves(%iter_2068) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %918 = cute.get_scalars(%e0_2069) : !cute.int_tuple<"?">
      %919 = cute.get_scalars(%e1_2070) : !cute.int_tuple<"?">
      %920 = cute.get_scalars(%e2_2071) : !cute.int_tuple<"?">
      %921 = cute.get_scalars(%e3_2072) : !cute.int_tuple<"?{div=8}">
      %lay_2073 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %922 = cute.get_shape(%lay_2073) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2074, %e1_2075, %e2_2076, %e3_2077 = cute.get_leaves(%922) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2078 = cute.to_int_tuple(%e0_2074) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %923 = cute.get_scalars(%itup_2078) : !cute.int_tuple<"?">
      %itup_2079 = cute.to_int_tuple(%e1_2075) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %924 = cute.get_scalars(%itup_2079) : !cute.int_tuple<"?">
      %itup_2080 = cute.to_int_tuple(%e2_2076) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %925 = cute.get_scalars(%itup_2080) : !cute.int_tuple<"?">
      %itup_2081 = cute.to_int_tuple(%e3_2077) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %926 = cute.get_scalars(%itup_2081) : !cute.int_tuple<"?{div=8}">
      %coord_2082 = cute.make_coord(%e1_2070) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2083 = cute.make_coord(%itup_2079) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %927 = cute.elem_less(%coord_2082, %coord_2083) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %927 {
        %coord_2084 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2085 = cute.get_layout(%rmem_1740) : !memref_rmem_bf16_32
        %idx_2086 = cute.crd2idx(%coord_2084, %lay_2085) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_2087 = cute.get_iter(%rmem_1740) : !memref_rmem_bf16_32
        %ptr_2088 = cute.add_offset(%iter_2087, %idx_2086) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2089 = cute.make_view(%ptr_2088) : !memref_rmem_bf16_34
        %iter_2090 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %iter_2091 = cute.get_iter(%view_2089) : !memref_rmem_bf16_34
        %coord_2092 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2093 = cute.get_layout(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %idx_2094 = cute.crd2idx(%coord_2092, %lay_2093) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2095 = cute.get_iter(%dst_partitioned_1737) : !memref_gmem_bf16_5
        %ptr_2096 = cute.add_offset(%iter_2095, %idx_2094) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2097 = cute.make_view(%ptr_2096) : !memref_gmem_bf16_8
        %iter_2098 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %iter_2099 = cute.get_iter(%view_2097) : !memref_gmem_bf16_8
        %coord_2100 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2101 = cute.get_layout(%rmem_1877) : !memref_rmem_i8_
        %idx_2102 = cute.crd2idx(%coord_2100, %lay_2101) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2103 = cute.get_iter(%rmem_1877) : !memref_rmem_i8_
        %ptr_2104 = cute.add_offset(%iter_2103, %idx_2102) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2105 = cute.make_view(%ptr_2104) : !memref_rmem_i8_1
        %iter_2106 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %iter_2107 = cute.get_iter(%view_2105) : !memref_rmem_i8_1
        %lay_2108 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %928 = cute.get_shape(%lay_2108) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2109, %e1_2110, %e2_2111 = cute.get_leaves(%928) : !cute.shape<"((8,1),2)">
        %lay_2112 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %929 = cute.get_shape(%lay_2112) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%929) : !cute.shape<"((8,1),2)">
        %lay_2116 = cute.get_layout(%view_2089) : !memref_rmem_bf16_34
        %shape_2117 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2118 = cute.make_layout() : !cute.layout<"1:0">
        %append_2119 = cute.append_to_rank<2> (%lay_2116, %lay_2118) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2120 = cute.make_view(%iter_2091, %append_2119) : !memref_rmem_bf16_34
        %iter_2121 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %lay_2122 = cute.get_layout(%view_2120) : !memref_rmem_bf16_34
        %930 = cute.get_shape(%lay_2122) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2123, %e1_2124, %e2_2125 = cute.get_leaves(%930) : !cute.shape<"((8,1),2)">
        %iter_2126 = cute.get_iter(%view_2120) : !memref_rmem_bf16_34
        %view_2127 = cute.make_view(%iter_2126) : !memref_rmem_bf16_35
        %iter_2128 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2129 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %lay_2130 = cute.get_layout(%view_2097) : !memref_gmem_bf16_8
        %shape_2131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2132 = cute.make_layout() : !cute.layout<"1:0">
        %append_2133 = cute.append_to_rank<2> (%lay_2130, %lay_2132) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2134 = cute.make_view(%iter_2099, %append_2133) : !memref_gmem_bf16_8
        %iter_2135 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %lay_2136 = cute.get_layout(%view_2134) : !memref_gmem_bf16_8
        %931 = cute.get_shape(%lay_2136) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2137, %e1_2138, %e2_2139 = cute.get_leaves(%931) : !cute.shape<"((8,1),2)">
        %iter_2140 = cute.get_iter(%view_2134) : !memref_gmem_bf16_8
        %view_2141 = cute.make_view(%iter_2140) : !memref_gmem_bf16_9
        %iter_2142 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %iter_2143 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2144 = cute.get_layout(%view_2105) : !memref_rmem_i8_1
        %shape_2145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2146 = cute.make_layout() : !cute.layout<"1:0">
        %append_2147 = cute.append_to_rank<2> (%lay_2144, %lay_2146) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2148 = cute.make_view(%iter_2107, %append_2147) : !memref_rmem_i8_1
        %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %lay_2150 = cute.get_layout(%view_2148) : !memref_rmem_i8_1
        %932 = cute.get_shape(%lay_2150) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2151, %e1_2152 = cute.get_leaves(%932) : !cute.shape<"(1,2)">
        %iter_2153 = cute.get_iter(%view_2148) : !memref_rmem_i8_1
        %view_2154 = cute.make_view(%iter_2153) : !memref_rmem_i8_2
        %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %iter_2156 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2157 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %933 = cute.get_shape(%lay_2157) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2158, %e1_2159, %e2_2160 = cute.get_leaves(%933) : !cute.shape<"((8,1),(2))">
        %lay_2161 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %934 = cute.get_shape(%lay_2161) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2162, %e1_2163, %e2_2164 = cute.get_leaves(%934) : !cute.shape<"((8,1),(2))">
        %lay_2165 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %sz_2166 = cute.size(%lay_2165) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2167 = cute.get_leaves(%sz_2166) : !cute.int_tuple<"2">
        %lay_2168 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %sz_2169 = cute.size(%lay_2168) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2170 = cute.get_leaves(%sz_2169) : !cute.int_tuple<"2">
        %935 = cute.static : !cute.layout<"1:0">
        %iter_2171 = cute.get_iter(%view_2127) : !memref_rmem_bf16_35
        %iter_2172 = cute.get_iter(%view_2141) : !memref_gmem_bf16_9
        %lay_2173 = cute.get_layout(%view_2127) : !memref_rmem_bf16_35
        %lay_2174 = cute.get_layout(%view_2141) : !memref_gmem_bf16_9
        %append_2175 = cute.append_to_rank<2> (%lay_2173, %935) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2176 = cute.append_to_rank<2> (%lay_2174, %935) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2177 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2179 = cute.get_iter(%view_2154) : !memref_rmem_i8_2
        %lay_2180 = cute.get_layout(%view_2154) : !memref_rmem_i8_2
        %append_2181 = cute.append_to_rank<2> (%lay_2180, %935) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2182 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2183 = cute.size(%lay_2177) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %936 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
        %c0_i32_2184 = arith.constant 0 : i32
        %c1_i32_2185 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2184 to %936 step %c1_i32_2185  : i32 {
          %coord_2186 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_2187 = cute.slice(%lay_2177, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_2188 = cute.crd2idx(%coord_2186, %lay_2177) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2189 = cute.add_offset(%iter_2171, %idx_2188) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2190 = cute.make_view(%ptr_2189, %slice_2187) : !memref_rmem_bf16_9
          %slice_2191 = cute.slice(%lay_2178, %coord_2186) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_2192 = cute.crd2idx(%coord_2186, %lay_2178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2193 = cute.add_offset(%iter_2172, %idx_2192) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2194 = cute.make_view(%ptr_2193, %slice_2191) : !memref_gmem_bf16_10
          %slice_2195 = cute.slice(%lay_2182, %coord_2186) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_2196 = cute.crd2idx(%coord_2186, %lay_2182) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2197 = cute.add_offset(%iter_2179, %idx_2196) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2198 = cute.make_view(%ptr_2197, %slice_2195) : !memref_rmem_i8_3
          cute.copy_atom_call(%5, %view_2190, %view_2194, %view_2198) : (!copy_simt, !memref_rmem_bf16_9, !memref_gmem_bf16_10, !memref_rmem_i8_3) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__HSTUAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Ten(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_, %arg5: !cuda.stream) -> i32 attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
    %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
    %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
    %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
    %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
    %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
    %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
    %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
    %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
    %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
    %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
    %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
    %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
    %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
    %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
    %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
    %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %36 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%36) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %37 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
    %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %38 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
    %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %39 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
    %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %40 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
    %41 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%41) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %42 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
    %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %43 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
    %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %44 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
    %45 = cute.static : !cute.swizzle<"S<3,4,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %46 = cute.get_stride(%lay_83) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_84, %e1_85 = cute.get_leaves(%46) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_86 = cute.make_composed_layout(%45, %int_tuple, %lay_83) : !cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">
    %shape_87 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_88 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %47 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_89 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_90 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %48 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_91 = cute.make_shape() : () -> !cute.shape<"(64,64)">
    %int_tuple_92 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %49 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
    %cosz = cute.cosize(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_93 = cute.get_leaves(%cosz) : !cute.int_tuple<"8192">
    %cosz_94 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_95 = cute.get_leaves(%cosz_94) : !cute.int_tuple<"8192">
    %cosz_96 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_97 = cute.get_leaves(%cosz_96) : !cute.int_tuple<"8192">
    %cosz_98 = cute.cosize(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"4096">
    %e0_99 = cute.get_leaves(%cosz_98) : !cute.int_tuple<"4096">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>
    %atom_100 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %50 = cute.composed_get_outer(%lay_86) : (!cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %51 = cute.get_shape(%50) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_101, %e1_102 = cute.get_leaves(%51) : !cute.shape<"(8,64)">
    %shape_103 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_104 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_105 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_106 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_107 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %prod = cute.raked_product(%lay_105, %lay_107) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_108 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_109 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_110 = cute.get_leaves(%sz_109) : !cute.int_tuple<"8">
    %shape_111 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_112 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_113 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %52 = cute.get_shape(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_114, %e1_115, %e2_116 = cute.get_leaves(%52) : !cute.shape<"(16,(8,8))">
    %int_tuple_117 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res = cute.tuple.product_each(%int_tuple_117) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_118, %e1_119 = cute.get_leaves(%res) : !cute.int_tuple<"(16,64)">
    %int_tuple_120 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_121 = cute.tuple.product_each(%int_tuple_120) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_122, %e1_123 = cute.get_leaves(%res_121) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %53 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %prod_124 = cute.raked_product(%lay_105, %lay_107) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_125 = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_126 = cute.get_leaves(%sz_125) : !cute.int_tuple<"128">
    %sz_127 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_128 = cute.get_leaves(%sz_127) : !cute.int_tuple<"8">
    %shape_129 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_130 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_131 = cute.right_inverse(%prod_124) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_132 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %54 = cute.get_shape(%prod_124) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_133, %e1_134, %e2_135 = cute.get_leaves(%54) : !cute.shape<"(16,(8,8))">
    %int_tuple_136 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res_137 = cute.tuple.product_each(%int_tuple_136) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_138, %e1_139 = cute.get_leaves(%res_137) : !cute.int_tuple<"(16,64)">
    %int_tuple_140 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_141 = cute.tuple.product_each(%int_tuple_140) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_142, %e1_143 = cute.get_leaves(%res_141) : !cute.int_tuple<"(16,64)">
    %tile_144 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %55 = cute.make_tiled_copy(%atom_100) : !copy_simt
    %shape_145 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_146 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_147 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_148 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %56 = cute.get_shape(%lay_148) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_149, %e1_150, %e2_151 = cute.get_leaves(%56) : !cute.shape<"(4,1,1)">
    %tile_152 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %57 = cute.make_tiled_mma(%atom_146) : !mma_bf16_bf16_f32_16x8x16_
    %lay_153 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %58 = cute.get_shape(%lay_153) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_154, %e1_155, %e2_156, %e3_157 = cute.get_leaves(%58) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_158 = cute.to_int_tuple(%e0_154) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %59 = cute.get_scalars(%itup_158) : !cute.int_tuple<"?">
    %itup_159 = cute.to_int_tuple(%e1_155) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_159) : !cute.int_tuple<"?">
    %itup_160 = cute.to_int_tuple(%e2_156) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_160) : !cute.int_tuple<"?">
    %itup_161 = cute.to_int_tuple(%e3_157) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %62 = cute.get_scalars(%itup_161) : !cute.int_tuple<"?{div=8}">
    %int_tuple_162 = cute.make_int_tuple(%itup_159) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_163 = cute.make_tile() : () -> !cute.tile<"64:1">
    %63 = cute.get_scalars(%int_tuple_162) <{only_dynamic}> : !cute.int_tuple<"?">
    %c64_i32 = arith.constant 64 : i32
    %64 = arith.ceildivsi %63, %c64_i32 : i32
    %int_tuple_164 = cute.make_int_tuple(%64) : (i32) -> !cute.int_tuple<"?">
    %e0_165 = cute.get_leaves(%int_tuple_164) : !cute.int_tuple<"?">
    %65 = cute.get_scalars(%e0_165) : !cute.int_tuple<"?">
    %lay_166 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %66 = cute.get_shape(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%66) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_171 = cute.to_int_tuple(%e0_167) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %67 = cute.get_scalars(%itup_171) : !cute.int_tuple<"?">
    %itup_172 = cute.to_int_tuple(%e1_168) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %68 = cute.get_scalars(%itup_172) : !cute.int_tuple<"?">
    %itup_173 = cute.to_int_tuple(%e2_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e3_170) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %70 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?{div=8}">
    %71 = cute.get_stride(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%71) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_179 = cute.to_int_tuple(%e0_175) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %72 = cute.get_scalars(%itup_179) : !cute.int_tuple<"?{i64 div=8}">
    %itup_180 = cute.to_int_tuple(%e1_176) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %73 = cute.get_scalars(%itup_180) : !cute.int_tuple<"?{i64 div=8}">
    %itup_181 = cute.to_int_tuple(%e2_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %lay_182 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %75 = cute.get_shape(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_183, %e1_184, %e2_185, %e3_186 = cute.get_leaves(%75) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_187 = cute.to_int_tuple(%e0_183) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %76 = cute.get_scalars(%itup_187) : !cute.int_tuple<"?">
    %itup_188 = cute.to_int_tuple(%e1_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %77 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
    %itup_189 = cute.to_int_tuple(%e2_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e3_186) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %79 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?{div=8}">
    %80 = cute.get_stride(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_191, %e1_192, %e2_193, %e3_194 = cute.get_leaves(%80) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_195 = cute.to_int_tuple(%e0_191) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %81 = cute.get_scalars(%itup_195) : !cute.int_tuple<"?{i64 div=8}">
    %itup_196 = cute.to_int_tuple(%e1_192) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %82 = cute.get_scalars(%itup_196) : !cute.int_tuple<"?{i64 div=8}">
    %itup_197 = cute.to_int_tuple(%e2_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %lay_198 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %84 = cute.get_shape(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_199, %e1_200, %e2_201, %e3_202 = cute.get_leaves(%84) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_203 = cute.to_int_tuple(%e0_199) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %85 = cute.get_scalars(%itup_203) : !cute.int_tuple<"?">
    %itup_204 = cute.to_int_tuple(%e1_200) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %86 = cute.get_scalars(%itup_204) : !cute.int_tuple<"?">
    %itup_205 = cute.to_int_tuple(%e2_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e3_202) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %88 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?{div=8}">
    %89 = cute.get_stride(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_207, %e1_208, %e2_209, %e3_210 = cute.get_leaves(%89) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_211 = cute.to_int_tuple(%e0_207) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %90 = cute.get_scalars(%itup_211) : !cute.int_tuple<"?{i64 div=8}">
    %itup_212 = cute.to_int_tuple(%e1_208) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %91 = cute.get_scalars(%itup_212) : !cute.int_tuple<"?{i64 div=8}">
    %itup_213 = cute.to_int_tuple(%e2_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %lay_214 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %93 = cute.get_shape(%lay_214) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_215, %e1_216, %e2_217, %e3_218 = cute.get_leaves(%93) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_219 = cute.to_int_tuple(%e0_215) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %94 = cute.get_scalars(%itup_219) : !cute.int_tuple<"?">
    %itup_220 = cute.to_int_tuple(%e1_216) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %95 = cute.get_scalars(%itup_220) : !cute.int_tuple<"?">
    %itup_221 = cute.to_int_tuple(%e2_217) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %96 = cute.get_scalars(%itup_221) : !cute.int_tuple<"?">
    %itup_222 = cute.to_int_tuple(%e3_218) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %97 = cute.get_scalars(%itup_222) : !cute.int_tuple<"?{div=8}">
    %98 = cute.get_stride(%lay_214) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_223, %e1_224, %e2_225, %e3_226 = cute.get_leaves(%98) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_227 = cute.to_int_tuple(%e0_223) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %99 = cute.get_scalars(%itup_227) : !cute.int_tuple<"?{i64 div=8}">
    %itup_228 = cute.to_int_tuple(%e1_224) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %100 = cute.get_scalars(%itup_228) : !cute.int_tuple<"?{i64 div=8}">
    %itup_229 = cute.to_int_tuple(%e2_225) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %101 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?{i64 div=8}">
    %lay_230 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %102 = cute.get_shape(%lay_230) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_231, %e1_232, %e2_233, %e3_234 = cute.get_leaves(%102) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_235 = cute.to_int_tuple(%e0_231) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %103 = cute.get_scalars(%itup_235) : !cute.int_tuple<"?">
    %itup_236 = cute.to_int_tuple(%e1_232) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %104 = cute.get_scalars(%itup_236) : !cute.int_tuple<"?">
    %itup_237 = cute.to_int_tuple(%e2_233) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %105 = cute.get_scalars(%itup_237) : !cute.int_tuple<"?">
    %itup_238 = cute.to_int_tuple(%e3_234) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %106 = cute.get_scalars(%itup_238) : !cute.int_tuple<"?{div=8}">
    %107 = cute.get_stride(%lay_230) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_239, %e1_240, %e2_241, %e3_242 = cute.get_leaves(%107) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_243 = cute.to_int_tuple(%e0_239) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %108 = cute.get_scalars(%itup_243) : !cute.int_tuple<"?{i64 div=8}">
    %itup_244 = cute.to_int_tuple(%e1_240) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %109 = cute.get_scalars(%itup_244) : !cute.int_tuple<"?{i64 div=8}">
    %itup_245 = cute.to_int_tuple(%e2_241) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %110 = cute.get_scalars(%itup_245) : !cute.int_tuple<"?{i64 div=8}">
    %111 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %112 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_246 = cute.get_leaves(%112) : !cute.int_tuple<"0">
    %113 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %114 = cute.get_shape(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_247, %e1_248, %e2_249, %e3_250 = cute.get_leaves(%114) : !cute.shape<"((8,8),(64,2))">
    %115 = cute.get_stride(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_251, %e1_252, %e2_253, %e3_254 = cute.get_leaves(%115) : !cute.stride<"((64,512),(1,4096))">
    %116 = cute.composed_get_inner(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %117 = cute.composed_get_offset(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_255 = cute.get_leaves(%117) : !cute.int_tuple<"0">
    %118 = cute.composed_get_outer(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %119 = cute.get_shape(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_256, %e1_257, %e2_258, %e3_259 = cute.get_leaves(%119) : !cute.shape<"((8,8),(64,2))">
    %120 = cute.get_stride(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_260, %e1_261, %e2_262, %e3_263 = cute.get_leaves(%120) : !cute.stride<"((64,512),(1,4096))">
    %121 = cute.composed_get_inner(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
    %122 = cute.composed_get_offset(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
    %e0_264 = cute.get_leaves(%122) : !cute.int_tuple<"0">
    %123 = cute.composed_get_outer(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
    %124 = cute.get_shape(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
    %e0_265, %e1_266, %e2_267, %e3_268 = cute.get_leaves(%124) : !cute.shape<"((8,8),(64,1))">
    %125 = cute.get_stride(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
    %e0_269, %e1_270, %e2_271, %e3_272 = cute.get_leaves(%125) : !cute.stride<"((64,512),(1,0))">
    %126 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %127 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_273 = cute.get_leaves(%127) : !cute.int_tuple<"0">
    %128 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %129 = cute.get_shape(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_274, %e1_275, %e2_276, %e3_277 = cute.get_leaves(%129) : !cute.shape<"((8,8),(64,2))">
    %130 = cute.get_stride(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_278, %e1_279, %e2_280, %e3_281 = cute.get_leaves(%130) : !cute.stride<"((64,512),(1,4096))">
    %131 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_282, %e1_283 = cute.get_leaves(%131) : !cute.tile<"[16:1;64:1]">
    %132 = cute.get_shape(%e0_282) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_284 = cute.get_leaves(%132) : !cute.shape<"16">
    %133 = cute.get_stride(%e0_282) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_285 = cute.get_leaves(%133) : !cute.stride<"1">
    %134 = cute.get_shape(%e1_283) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_286 = cute.get_leaves(%134) : !cute.shape<"64">
    %135 = cute.get_stride(%e1_283) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_287 = cute.get_leaves(%135) : !cute.stride<"1">
    %136 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %137 = cute.get_shape(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_288, %e1_289, %e2_290 = cute.get_leaves(%137) : !cute.shape<"((8,16),8)">
    %138 = cute.get_stride(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_291, %e1_292, %e2_293 = cute.get_leaves(%138) : !cute.stride<"((128,1),16)">
    %139 = cute.static : !cute.layout<"1:0">
    %140 = cute.get_shape(%139) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_294 = cute.get_leaves(%140) : !cute.shape<"1">
    %141 = cute.get_stride(%139) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_295 = cute.get_leaves(%141) : !cute.stride<"0">
    %142 = cute.static : !cute.layout<"(1,8):(0,1)">
    %143 = cute.get_shape(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_296, %e1_297 = cute.get_leaves(%143) : !cute.shape<"(1,8)">
    %144 = cute.get_stride(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_298, %e1_299 = cute.get_leaves(%144) : !cute.stride<"(0,1)">
    %145 = cute.static : !cute.layout<"(1,8):(0,1)">
    %146 = cute.get_shape(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_300, %e1_301 = cute.get_leaves(%146) : !cute.shape<"(1,8)">
    %147 = cute.get_stride(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_302, %e1_303 = cute.get_leaves(%147) : !cute.stride<"(0,1)">
    %148 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_304, %e1_305 = cute.get_leaves(%148) : !cute.tile<"[16:1;64:1]">
    %149 = cute.get_shape(%e0_304) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_306 = cute.get_leaves(%149) : !cute.shape<"16">
    %150 = cute.get_stride(%e0_304) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_307 = cute.get_leaves(%150) : !cute.stride<"1">
    %151 = cute.get_shape(%e1_305) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_308 = cute.get_leaves(%151) : !cute.shape<"64">
    %152 = cute.get_stride(%e1_305) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_309 = cute.get_leaves(%152) : !cute.stride<"1">
    %153 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %154 = cute.get_shape(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_310, %e1_311, %e2_312 = cute.get_leaves(%154) : !cute.shape<"((8,16),8)">
    %155 = cute.get_stride(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_313, %e1_314, %e2_315 = cute.get_leaves(%155) : !cute.stride<"((128,1),16)">
    %156 = cute.static : !cute.layout<"1:0">
    %157 = cute.get_shape(%156) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_316 = cute.get_leaves(%157) : !cute.shape<"1">
    %158 = cute.get_stride(%156) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_317 = cute.get_leaves(%158) : !cute.stride<"0">
    %159 = cute.static : !cute.layout<"(1,8):(0,1)">
    %160 = cute.get_shape(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_318, %e1_319 = cute.get_leaves(%160) : !cute.shape<"(1,8)">
    %161 = cute.get_stride(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_320, %e1_321 = cute.get_leaves(%161) : !cute.stride<"(0,1)">
    %162 = cute.static : !cute.layout<"(1,8):(0,1)">
    %163 = cute.get_shape(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_322, %e1_323 = cute.get_leaves(%163) : !cute.shape<"(1,8)">
    %164 = cute.get_stride(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_324, %e1_325 = cute.get_leaves(%164) : !cute.stride<"(0,1)">
    %165 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %166 = cute.get_shape(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%166) : !cute.shape<"(32,4,1,1)">
    %167 = cute.get_stride(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_330, %e1_331, %e2_332, %e3_333 = cute.get_leaves(%167) : !cute.stride<"(1,32,0,0)">
    %168 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_334, %e1_335, %e2_336 = cute.get_leaves(%168) : !cute.tile<"[64:1;16:1;16:1]">
    %169 = cute.get_shape(%e0_334) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_337 = cute.get_leaves(%169) : !cute.shape<"64">
    %170 = cute.get_stride(%e0_334) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_338 = cute.get_leaves(%170) : !cute.stride<"1">
    %171 = cute.get_shape(%e1_335) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_339 = cute.get_leaves(%171) : !cute.shape<"16">
    %172 = cute.get_stride(%e1_335) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_340 = cute.get_leaves(%172) : !cute.stride<"1">
    %173 = cute.get_shape(%e2_336) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_341 = cute.get_leaves(%173) : !cute.shape<"16">
    %174 = cute.get_stride(%e2_336) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_342 = cute.get_leaves(%174) : !cute.stride<"1">
    %175 = cute.static : !cute.layout<"32:1">
    %176 = cute.get_shape(%175) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_343 = cute.get_leaves(%176) : !cute.shape<"32">
    %177 = cute.get_stride(%175) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_344 = cute.get_leaves(%177) : !cute.stride<"1">
    %178 = cute.static : !cute.shape<"(16,8,16)">
    %e0_345, %e1_346, %e2_347 = cute.get_leaves(%178) : !cute.shape<"(16,8,16)">
    %179 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %180 = cute.get_shape(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_348, %e1_349, %e2_350, %e3_351, %e4 = cute.get_leaves(%180) : !cute.shape<"((4,8),(2,2,2))">
    %181 = cute.get_stride(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_352, %e1_353, %e2_354, %e3_355, %e4_356 = cute.get_leaves(%181) : !cute.stride<"((32,1),(16,8,128))">
    %182 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %183 = cute.get_shape(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_357, %e1_358, %e2_359, %e3_360 = cute.get_leaves(%183) : !cute.shape<"((4,8),(2,2))">
    %184 = cute.get_stride(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_361, %e1_362, %e2_363, %e3_364 = cute.get_leaves(%184) : !cute.stride<"((16,1),(8,64))">
    %185 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %186 = cute.get_shape(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_365, %e1_366, %e2_367, %e3_368 = cute.get_leaves(%186) : !cute.shape<"((4,8),(2,2))">
    %187 = cute.get_stride(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_369, %e1_370, %e2_371, %e3_372 = cute.get_leaves(%187) : !cute.stride<"((32,1),(16,8))">
    %c57344_i32 = arith.constant 57344 : i32
    %188 = arith.extsi %c57344_i32 : i32 to i64
    %c128_i32 = arith.constant 128 : i32
    %c1_i32 = arith.constant 1 : i32
    %c4_i32 = arith.constant 4 : i32
    %189 = cuda.launch_cfg.create<max_attrs = 2 : i32> (blockDim = (%c128_i32, %c1_i32, %c1_i32), dynamicSmemBytes = %188, gridDim = (%c4_i32, %c4_i32, %65), stream = %arg5) : i32, i32, i32, i64, i32, i32, i32, !cuda.stream -> !cuda.launch_cfg<max_attrs = 2>
    %190 = cuda.launch_ex @kernels::@kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gm_0<%189> (%arg0, %arg1, %arg2, %arg3, %arg4) : !cuda.launch_cfg<max_attrs = 2>, (!memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_) -> !cuda.result
    %191 = cuda.cast %190 : !cuda.result -> i32
    cuda.return_if_error %191 : i32
    %c0_i32 = arith.constant 0 : i32
    return %c0_i32 : i32
  }
}
