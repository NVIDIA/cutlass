!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_3 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(64,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "(64,64,?):(?{i64 div=8},1,64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_11 = !cute.memref<bf16, gmem, align<16>, "((8,1),1):((1,0),0)">
!memref_gmem_bf16_12 = !cute.memref<bf16, gmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_gmem_bf16_13 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),1,(4,2)):((1,0),0,(16,8))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<32>, "((8,1),1,4):((1,0),0,8)">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<32>, "((8,1),(1,4)):((1,0),(0,8))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<16>, "((8,1),1):((1,0),0)">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4):(((1,32),0),4)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),(4)):(((1,32),0),(4))">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1)):(((1,32),0))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1):((1,2,4),0)">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4)):((1,2),(32,4))">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1,4):(((1,2),4),0,8)">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((1,8),1,8):((0,1),0,8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((1,8),(1,8)):((0,1),(0,8))">
!memref_rmem_bf16_31 = !cute.memref<bf16, rmem, align<16>, "((1,8)):((0,1))">
!memref_rmem_bf16_32 = !cute.memref<bf16, rmem, align<32>, "((8,1),4,2):((1,0),16,8)">
!memref_rmem_bf16_33 = !cute.memref<bf16, rmem, align<32>, "((8,1),(4,2)):((1,0),(16,8))">
!memref_rmem_bf16_34 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_35 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,1):((1,0),1024,0)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),1,((2,2),2)):((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),(2,4),((2,2),2)):((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,4,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),1):((1,0),0)">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<1024>, S<3,4,3>, "((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">
!memref_smem_bf16_25 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">
!memref_smem_bf16_26 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2))):((0,(1,512,8)))">
!memref_smem_bf16_27 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_28 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_29 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1)):((1,0))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    cuda.kernel @kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gm_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_) attributes {cu_attrs = {max_dynamic_shared_size_bytes = #cuda.dev_max_shared_memory_optin, non_portable_cluster_size_allowed = 1 : i32}, cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %1 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
      %3 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %4 = cute.static : !copy_ldgsts
      %5 = cute.static : !copy_simt
      %6 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %7 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%7) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
      %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %10 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
      %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %11 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
      %12 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%12) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
      %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %15 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
      %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %16 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%16) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
      %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %19 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
      %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %20 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
      %21 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%21) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
      %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %24 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
      %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %25 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%25) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
      %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %28 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
      %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %29 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
      %30 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%30) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
      %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %33 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
      %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %34 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%34) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
      %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %37 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
      %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %38 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
      %39 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%39) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
      %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
      %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %43 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%43) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %44 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
      %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %45 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
      %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %46 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
      %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %47 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
      %48 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%48) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %49 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
      %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %50 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
      %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %51 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
      %52 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %53 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,8),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,4096))">
      %57 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %58 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_92 = cute.get_leaves(%58) : !cute.int_tuple<"0">
      %59 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %60 = cute.get_shape(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_93, %e1_94, %e2_95, %e3_96 = cute.get_leaves(%60) : !cute.shape<"((8,8),(64,2))">
      %61 = cute.get_stride(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_97, %e1_98, %e2_99, %e3_100 = cute.get_leaves(%61) : !cute.stride<"((64,512),(1,4096))">
      %62 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
      %63 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
      %e0_101 = cute.get_leaves(%63) : !cute.int_tuple<"0">
      %64 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
      %65 = cute.get_shape(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
      %e0_102, %e1_103, %e2_104, %e3_105 = cute.get_leaves(%65) : !cute.shape<"((8,8),(64,1))">
      %66 = cute.get_stride(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
      %e0_106, %e1_107, %e2_108, %e3_109 = cute.get_leaves(%66) : !cute.stride<"((64,512),(1,0))">
      %67 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %68 = cute.composed_get_offset(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_110 = cute.get_leaves(%68) : !cute.int_tuple<"0">
      %69 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %70 = cute.get_shape(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_111, %e1_112, %e2_113, %e3_114 = cute.get_leaves(%70) : !cute.shape<"((8,8),(64,2))">
      %71 = cute.get_stride(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_115, %e1_116, %e2_117, %e3_118 = cute.get_leaves(%71) : !cute.stride<"((64,512),(1,4096))">
      %72 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_119, %e1_120 = cute.get_leaves(%72) : !cute.tile<"[16:1;64:1]">
      %73 = cute.get_shape(%e0_119) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_121 = cute.get_leaves(%73) : !cute.shape<"16">
      %74 = cute.get_stride(%e0_119) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_122 = cute.get_leaves(%74) : !cute.stride<"1">
      %75 = cute.get_shape(%e1_120) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_123 = cute.get_leaves(%75) : !cute.shape<"64">
      %76 = cute.get_stride(%e1_120) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_124 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %78 = cute.get_shape(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_125, %e1_126, %e2_127 = cute.get_leaves(%78) : !cute.shape<"((8,16),8)">
      %79 = cute.get_stride(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_128, %e1_129, %e2_130 = cute.get_leaves(%79) : !cute.stride<"((128,1),16)">
      %80 = cute.static : !cute.layout<"1:0">
      %81 = cute.get_shape(%80) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_131 = cute.get_leaves(%81) : !cute.shape<"1">
      %82 = cute.get_stride(%80) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_132 = cute.get_leaves(%82) : !cute.stride<"0">
      %83 = cute.static : !cute.layout<"(1,8):(0,1)">
      %84 = cute.get_shape(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_133, %e1_134 = cute.get_leaves(%84) : !cute.shape<"(1,8)">
      %85 = cute.get_stride(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_135, %e1_136 = cute.get_leaves(%85) : !cute.stride<"(0,1)">
      %86 = cute.static : !cute.layout<"(1,8):(0,1)">
      %87 = cute.get_shape(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_137, %e1_138 = cute.get_leaves(%87) : !cute.shape<"(1,8)">
      %88 = cute.get_stride(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_139, %e1_140 = cute.get_leaves(%88) : !cute.stride<"(0,1)">
      %89 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_141, %e1_142 = cute.get_leaves(%89) : !cute.tile<"[16:1;64:1]">
      %90 = cute.get_shape(%e0_141) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_143 = cute.get_leaves(%90) : !cute.shape<"16">
      %91 = cute.get_stride(%e0_141) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_144 = cute.get_leaves(%91) : !cute.stride<"1">
      %92 = cute.get_shape(%e1_142) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_145 = cute.get_leaves(%92) : !cute.shape<"64">
      %93 = cute.get_stride(%e1_142) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_146 = cute.get_leaves(%93) : !cute.stride<"1">
      %94 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %95 = cute.get_shape(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_147, %e1_148, %e2_149 = cute.get_leaves(%95) : !cute.shape<"((8,16),8)">
      %96 = cute.get_stride(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_150, %e1_151, %e2_152 = cute.get_leaves(%96) : !cute.stride<"((128,1),16)">
      %97 = cute.static : !cute.layout<"1:0">
      %98 = cute.get_shape(%97) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_153 = cute.get_leaves(%98) : !cute.shape<"1">
      %99 = cute.get_stride(%97) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_154 = cute.get_leaves(%99) : !cute.stride<"0">
      %100 = cute.static : !cute.layout<"(1,8):(0,1)">
      %101 = cute.get_shape(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_155, %e1_156 = cute.get_leaves(%101) : !cute.shape<"(1,8)">
      %102 = cute.get_stride(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_157, %e1_158 = cute.get_leaves(%102) : !cute.stride<"(0,1)">
      %103 = cute.static : !cute.layout<"(1,8):(0,1)">
      %104 = cute.get_shape(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_159, %e1_160 = cute.get_leaves(%104) : !cute.shape<"(1,8)">
      %105 = cute.get_stride(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_161, %e1_162 = cute.get_leaves(%105) : !cute.stride<"(0,1)">
      %106 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %107 = cute.get_shape(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_163, %e1_164, %e2_165, %e3_166 = cute.get_leaves(%107) : !cute.shape<"(32,4,1,1)">
      %108 = cute.get_stride(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%108) : !cute.stride<"(1,32,0,0)">
      %109 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_171, %e1_172, %e2_173 = cute.get_leaves(%109) : !cute.tile<"[64:1;16:1;16:1]">
      %110 = cute.get_shape(%e0_171) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_174 = cute.get_leaves(%110) : !cute.shape<"64">
      %111 = cute.get_stride(%e0_171) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_175 = cute.get_leaves(%111) : !cute.stride<"1">
      %112 = cute.get_shape(%e1_172) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_176 = cute.get_leaves(%112) : !cute.shape<"16">
      %113 = cute.get_stride(%e1_172) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_177 = cute.get_leaves(%113) : !cute.stride<"1">
      %114 = cute.get_shape(%e2_173) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_178 = cute.get_leaves(%114) : !cute.shape<"16">
      %115 = cute.get_stride(%e2_173) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_179 = cute.get_leaves(%115) : !cute.stride<"1">
      %116 = cute.static : !cute.layout<"32:1">
      %117 = cute.get_shape(%116) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_180 = cute.get_leaves(%117) : !cute.shape<"32">
      %118 = cute.get_stride(%116) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_181 = cute.get_leaves(%118) : !cute.stride<"1">
      %119 = cute.static : !cute.shape<"(16,8,16)">
      %e0_182, %e1_183, %e2_184 = cute.get_leaves(%119) : !cute.shape<"(16,8,16)">
      %120 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %121 = cute.get_shape(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_185, %e1_186, %e2_187, %e3_188, %e4 = cute.get_leaves(%121) : !cute.shape<"((4,8),(2,2,2))">
      %122 = cute.get_stride(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_189, %e1_190, %e2_191, %e3_192, %e4_193 = cute.get_leaves(%122) : !cute.stride<"((32,1),(16,8,128))">
      %123 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %124 = cute.get_shape(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_194, %e1_195, %e2_196, %e3_197 = cute.get_leaves(%124) : !cute.shape<"((4,8),(2,2))">
      %125 = cute.get_stride(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_198, %e1_199, %e2_200, %e3_201 = cute.get_leaves(%125) : !cute.stride<"((16,1),(8,64))">
      %126 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %127 = cute.get_shape(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_202, %e1_203, %e2_204, %e3_205 = cute.get_leaves(%127) : !cute.shape<"((4,8),(2,2))">
      %128 = cute.get_stride(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_206, %e1_207, %e2_208, %e3_209 = cute.get_leaves(%128) : !cute.stride<"((32,1),(16,8))">
      %129 = nvvm.read.ptx.sreg.tid.x : i32
      %130 = nvvm.read.ptx.sreg.tid.y : i32
      %131 = nvvm.read.ptx.sreg.tid.z : i32
      %132 = nvvm.read.ptx.sreg.ctaid.x : i32
      %133 = nvvm.read.ptx.sreg.ctaid.y : i32
      %134 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_210 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %135 = cute.get_shape(%lay_210) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_211, %e1_212, %e2_213, %e3_214 = cute.get_leaves(%135) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_215 = cute.to_int_tuple(%e0_211) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %136 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?">
      %itup_216 = cute.to_int_tuple(%e1_212) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %137 = cute.get_scalars(%itup_216) : !cute.int_tuple<"?">
      %itup_217 = cute.to_int_tuple(%e2_213) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %138 = cute.get_scalars(%itup_217) : !cute.int_tuple<"?">
      %itup_218 = cute.to_int_tuple(%e3_214) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %139 = cute.get_scalars(%itup_218) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_216) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %140 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %141 = arith.ceildivsi %140, %c64_i32 : i32
      %int_tuple_219 = cute.make_int_tuple(%141) : (i32) -> !cute.int_tuple<"?">
      %e0_220 = cute.get_leaves(%int_tuple_219) : !cute.int_tuple<"?">
      %142 = cute.get_scalars(%e0_220) : !cute.int_tuple<"?">
      %int_tuple_221 = cute.make_int_tuple(%134) : (i32) -> !cute.int_tuple<"?">
      %sub = cute.tuple_sub(%e0_220, %int_tuple_221) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %143 = cute.get_scalars(%sub) : !cute.int_tuple<"?">
      %int_tuple_222 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_223 = cute.tuple_sub(%sub, %int_tuple_222) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %144 = cute.get_scalars(%sub_223) : !cute.int_tuple<"?">
      %lay_224 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %145 = cute.get_shape(%lay_224) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_225, %e1_226, %e2_227, %e3_228 = cute.get_leaves(%145) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_229 = cute.to_int_tuple(%e0_225) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %146 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?">
      %itup_230 = cute.to_int_tuple(%e1_226) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %147 = cute.get_scalars(%itup_230) : !cute.int_tuple<"?">
      %itup_231 = cute.to_int_tuple(%e2_227) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %148 = cute.get_scalars(%itup_231) : !cute.int_tuple<"?">
      %itup_232 = cute.to_int_tuple(%e3_228) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %149 = cute.get_scalars(%itup_232) : !cute.int_tuple<"?{div=8}">
      %int_tuple_233 = cute.make_int_tuple(%itup_230) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile_234 = cute.make_tile() : () -> !cute.tile<"64:1">
      %150 = cute.get_scalars(%int_tuple_233) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32_235 = arith.constant 64 : i32
      %151 = arith.ceildivsi %150, %c64_i32_235 : i32
      %int_tuple_236 = cute.make_int_tuple(%151) : (i32) -> !cute.int_tuple<"?">
      %e0_237 = cute.get_leaves(%int_tuple_236) : !cute.int_tuple<"?">
      %152 = cute.get_scalars(%e0_237) : !cute.int_tuple<"?">
      %int_tuple_238 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_239 = cute.tuple_sub(%e0_237, %int_tuple_238) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %153 = cute.get_scalars(%sub_239) : !cute.int_tuple<"?">
      %coord = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_240 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %154:7 = cute.get_scalars(%lay_240) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %155:2 = cute.get_scalars(%coord) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv = cute.assume(%154#3) : (i32) -> !cute.i32<divby 8>
      %shape = cute.make_shape(%154#1, %iv) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_241 = cute.assume(%154#5) : (i64) -> !cute.i64<divby 8>
      %stride = cute.make_stride(%iv_241) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_242 = cute.make_layout(%shape, %stride) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx = cute.crd2idx(%coord, %lay_240) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_243 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_243, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %lay_242) : !memref_gmem_bf16_1
      %iter_244 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %iter_245 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_246 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_247 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %156 = cute.get_scalars(%coord_247) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_248 = cute.make_coord(%156) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_249 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %157:3 = cute.get_scalars(%lay_249) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_250 = arith.constant 64 : i32
      %158 = arith.ceildivsi %157#0, %c64_i32_250 : i32
      %c64_i64 = arith.constant 64 : i64
      %159 = arith.muli %157#2, %c64_i64 : i64
      %c128_i32 = arith.constant 128 : i32
      %160 = arith.ceildivsi %157#1, %c128_i32 : i32
      %shape_251 = cute.make_shape(%158, %160) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_252 = cute.assume(%157#2) : (i64) -> !cute.i64<divby 8>
      %iv_253 = cute.assume(%159) : (i64) -> !cute.i64<divby 512>
      %stride_254 = cute.make_stride(%iv_252, %iv_253) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_255 = cute.make_layout(%shape_251, %stride_254) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %161:4 = cute.get_scalars(%lay_255) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %162 = cute.get_scalars(%coord_248) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_256 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %iv_257 = cute.assume(%161#2) : (i64) -> !cute.i64<divby 8>
      %stride_258 = cute.make_stride(%iv_257) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_259 = cute.make_layout(%shape_256, %stride_258) : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %idx_260 = cute.crd2idx(%coord_248, %lay_255) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_261 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_262 = cute.add_offset(%iter_261, %idx_260) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_263 = cute.make_view(%ptr_262, %lay_259) : !memref_gmem_bf16_2
      %iter_264 = cute.get_iter(%view_263) : !memref_gmem_bf16_2
      %coord_265 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_266 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %163:7 = cute.get_scalars(%lay_266) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %164:2 = cute.get_scalars(%coord_265) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_267 = cute.assume(%163#3) : (i32) -> !cute.i32<divby 8>
      %shape_268 = cute.make_shape(%163#1, %iv_267) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_269 = cute.assume(%163#5) : (i64) -> !cute.i64<divby 8>
      %stride_270 = cute.make_stride(%iv_269) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_271 = cute.make_layout(%shape_268, %stride_270) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_272 = cute.crd2idx(%coord_265, %lay_266) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_273 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_274 = cute.add_offset(%iter_273, %idx_272) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_275 = cute.make_view(%ptr_274, %lay_271) : !memref_gmem_bf16_1
      %iter_276 = cute.get_iter(%view_275) : !memref_gmem_bf16_1
      %iter_277 = cute.get_iter(%view_275) : !memref_gmem_bf16_1
      %tile_278 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_279 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_280 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_281 = cute.get_layout(%view_275) : !memref_gmem_bf16_1
      %165:3 = cute.get_scalars(%lay_281) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_282 = arith.constant 64 : i32
      %166 = arith.ceildivsi %165#0, %c64_i32_282 : i32
      %c64_i64_283 = arith.constant 64 : i64
      %167 = arith.muli %165#2, %c64_i64_283 : i64
      %c128_i32_284 = arith.constant 128 : i32
      %168 = arith.ceildivsi %165#1, %c128_i32_284 : i32
      %shape_285 = cute.make_shape(%166, %168) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_286 = cute.assume(%165#2) : (i64) -> !cute.i64<divby 8>
      %iv_287 = cute.assume(%167) : (i64) -> !cute.i64<divby 512>
      %stride_288 = cute.make_stride(%iv_286, %iv_287) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_289 = cute.make_layout(%shape_285, %stride_288) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %169:4 = cute.get_scalars(%lay_289) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_290 = cute.make_shape(%169#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_291 = cute.assume(%169#2) : (i64) -> !cute.i64<divby 8>
      %iv_292 = cute.assume(%169#3) : (i64) -> !cute.i64<divby 512>
      %stride_293 = cute.make_stride(%iv_291, %iv_292) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_294 = cute.make_layout(%shape_290, %stride_293) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_295 = cute.crd2idx(%coord_280, %lay_289) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_296 = cute.get_iter(%view_275) : !memref_gmem_bf16_1
      %ptr_297 = cute.add_offset(%iter_296, %idx_295) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_298 = cute.make_view(%ptr_297, %lay_294) : !memref_gmem_bf16_3
      %iter_299 = cute.get_iter(%view_298) : !memref_gmem_bf16_3
      %coord_300 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_301 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %170:7 = cute.get_scalars(%lay_301) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %171:2 = cute.get_scalars(%coord_300) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_302 = cute.assume(%170#3) : (i32) -> !cute.i32<divby 8>
      %shape_303 = cute.make_shape(%170#1, %iv_302) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_304 = cute.assume(%170#5) : (i64) -> !cute.i64<divby 8>
      %stride_305 = cute.make_stride(%iv_304) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_306 = cute.make_layout(%shape_303, %stride_305) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_307 = cute.crd2idx(%coord_300, %lay_301) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_308 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_309 = cute.add_offset(%iter_308, %idx_307) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_310 = cute.make_view(%ptr_309, %lay_306) : !memref_gmem_bf16_1
      %iter_311 = cute.get_iter(%view_310) : !memref_gmem_bf16_1
      %iter_312 = cute.get_iter(%view_310) : !memref_gmem_bf16_1
      %tile_313 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_314 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_315 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_316 = cute.get_layout(%view_310) : !memref_gmem_bf16_1
      %172:3 = cute.get_scalars(%lay_316) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_317 = arith.constant 64 : i32
      %173 = arith.ceildivsi %172#0, %c64_i32_317 : i32
      %c64_i64_318 = arith.constant 64 : i64
      %174 = arith.muli %172#2, %c64_i64_318 : i64
      %c128_i32_319 = arith.constant 128 : i32
      %175 = arith.ceildivsi %172#1, %c128_i32_319 : i32
      %shape_320 = cute.make_shape(%173, %175) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_321 = cute.assume(%172#2) : (i64) -> !cute.i64<divby 8>
      %iv_322 = cute.assume(%174) : (i64) -> !cute.i64<divby 512>
      %stride_323 = cute.make_stride(%iv_321, %iv_322) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_324 = cute.make_layout(%shape_320, %stride_323) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %176:4 = cute.get_scalars(%lay_324) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_325 = cute.make_shape(%176#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_326 = cute.assume(%176#2) : (i64) -> !cute.i64<divby 8>
      %iv_327 = cute.assume(%176#3) : (i64) -> !cute.i64<divby 512>
      %stride_328 = cute.make_stride(%iv_326, %iv_327) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_329 = cute.make_layout(%shape_325, %stride_328) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_330 = cute.crd2idx(%coord_315, %lay_324) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_331 = cute.get_iter(%view_310) : !memref_gmem_bf16_1
      %ptr_332 = cute.add_offset(%iter_331, %idx_330) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_333 = cute.make_view(%ptr_332, %lay_329) : !memref_gmem_bf16_3
      %iter_334 = cute.get_iter(%view_333) : !memref_gmem_bf16_3
      %coord_335 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_336 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %177:7 = cute.get_scalars(%lay_336) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %178:2 = cute.get_scalars(%coord_335) <{only_dynamic}> : !cute.coord<"(?,?,_,_)">
      %iv_337 = cute.assume(%177#3) : (i32) -> !cute.i32<divby 8>
      %shape_338 = cute.make_shape(%177#2, %iv_337) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_339 = cute.assume(%177#6) : (i64) -> !cute.i64<divby 8>
      %stride_340 = cute.make_stride(%iv_339) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_341 = cute.make_layout(%shape_338, %stride_340) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_342 = cute.crd2idx(%coord_335, %lay_336) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_343 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %ptr_344 = cute.add_offset(%iter_343, %idx_342) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_345 = cute.make_view(%ptr_344, %lay_341) : !memref_gmem_bf16_1
      %iter_346 = cute.get_iter(%view_345) : !memref_gmem_bf16_1
      %iter_347 = cute.get_iter(%view_345) : !memref_gmem_bf16_1
      %tile_348 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_349 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %179 = cute.get_scalars(%coord_349) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_350 = cute.make_coord(%179) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_351 = cute.get_layout(%view_345) : !memref_gmem_bf16_1
      %180:3 = cute.get_scalars(%lay_351) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_352 = arith.constant 64 : i32
      %181 = arith.ceildivsi %180#0, %c64_i32_352 : i32
      %c64_i64_353 = arith.constant 64 : i64
      %182 = arith.muli %180#2, %c64_i64_353 : i64
      %c64_i32_354 = arith.constant 64 : i32
      %183 = arith.ceildivsi %180#1, %c64_i32_354 : i32
      %shape_355 = cute.make_shape(%181, %183) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %iv_356 = cute.assume(%180#2) : (i64) -> !cute.i64<divby 8>
      %iv_357 = cute.assume(%182) : (i64) -> !cute.i64<divby 512>
      %stride_358 = cute.make_stride(%iv_356, %iv_357) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},64))">
      %lay_359 = cute.make_layout(%shape_355, %stride_358) : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">
      %184:4 = cute.get_scalars(%lay_359) <{only_dynamic}> : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">
      %185 = cute.get_scalars(%coord_350) <{only_dynamic}> : !cute.coord<"((_,_),(?,_))">
      %shape_360 = cute.make_shape(%184#1) : (i32) -> !cute.shape<"(64,64,?)">
      %iv_361 = cute.assume(%184#2) : (i64) -> !cute.i64<divby 8>
      %stride_362 = cute.make_stride(%iv_361) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1,64)">
      %lay_363 = cute.make_layout(%shape_360, %stride_362) : !cute.layout<"(64,64,?):(?{i64 div=8},1,64)">
      %idx_364 = cute.crd2idx(%coord_350, %lay_359) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_365 = cute.get_iter(%view_345) : !memref_gmem_bf16_1
      %ptr_366 = cute.add_offset(%iter_365, %idx_364) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_367 = cute.make_view(%ptr_366, %lay_363) : !memref_gmem_bf16_4
      %iter_368 = cute.get_iter(%view_367) : !memref_gmem_bf16_4
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_369 = cute.make_int_tuple() : () -> !cute.int_tuple<"57344">
      %ptr_370 = cute.add_offset(%smem_ptr, %int_tuple_369) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"57344">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c57344_i32 = arith.constant 57344 : i32
      %186 = arith.cmpi sge, %smem_size, %c57344_i32 : i32
      %int_tuple_371 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_372 = cute.add_offset(%smem_ptr, %int_tuple_371) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_373 = cute.make_int_tuple() : () -> !cute.int_tuple<"16384">
      %ptr_374 = cute.add_offset(%smem_ptr, %int_tuple_373) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"16384">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_375 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_376 = cute.add_offset(%smem_ptr, %int_tuple_375) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_377 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_378 = cute.add_offset(%smem_ptr, %int_tuple_377) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_379 = cute.recast_iter(%ptr_372) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_380 = cute.make_view(%iter_379, %0) : !memref_smem_bf16_
      %iter_381 = cute.get_iter(%view_380) : !memref_smem_bf16_
      %iter_382 = cute.recast_iter(%ptr_374) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_383 = cute.make_view(%iter_382, %1) : !memref_smem_bf16_
      %iter_384 = cute.get_iter(%view_383) : !memref_smem_bf16_
      %iter_385 = cute.recast_iter(%ptr_376) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_386 = cute.make_view(%iter_385, %1) : !memref_smem_bf16_
      %iter_387 = cute.get_iter(%view_386) : !memref_smem_bf16_
      %iter_388 = cute.recast_iter(%ptr_378) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_389 = cute.make_view(%iter_388, %2) : !memref_smem_bf16_1
      %iter_390 = cute.get_iter(%view_389) : !memref_smem_bf16_1
      %shape_391 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_392 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_393 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_394 = cute.get_iter(%view_386) : !memref_smem_bf16_
      %view_395 = cute.make_view(%iter_394) : !memref_smem_bf16_2
      %iter_396 = cute.get_iter(%view_395) : !memref_smem_bf16_2
      %coord_397 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_398 = cute.get_iter(%view_263) : !memref_gmem_bf16_2
      %lay_399 = cute.get_layout(%view_263) : !memref_gmem_bf16_2
      %187 = cute.get_scalars(%lay_399) <{only_dynamic}> : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %188 = cute.get_scalars(%coord_397) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64 = arith.constant 16 : i64
      %189 = arith.muli %187, %c16_i64 : i64
      %c128_i64 = arith.constant 128 : i64
      %190 = arith.muli %187, %c128_i64 : i64
      %c16_i64_400 = arith.constant 16 : i64
      %191 = arith.muli %187, %c16_i64_400 : i64
      %c8_i32 = arith.constant 8 : i32
      %192 = arith.divsi %188, %c8_i32 : i32
      %c8_i32_401 = arith.constant 8 : i32
      %193 = arith.remsi %188, %c8_i32_401 : i32
      %c8_i32_402 = arith.constant 8 : i32
      %194 = arith.muli %193, %c8_i32_402 : i32
      %195 = arith.extsi %192 : i32 to i64
      %196 = arith.muli %195, %187 : i64
      %197 = arith.extsi %194 : i32 to i64
      %198 = arith.addi %197, %196 : i64
      %iv_403 = cute.assume(%198) : (i64) -> !cute.i64<divby 8>
      %int_tuple_404 = cute.make_int_tuple(%iv_403) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_405 = cute.add_offset(%iter_398, %int_tuple_404) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_406 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
      %iv_407 = cute.assume(%189) : (i64) -> !cute.i64<divby 128>
      %stride_408 = cute.make_stride(%iv_407) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_409 = cute.make_layout(%shape_406, %stride_408) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
      %view_410 = cute.make_view(%ptr_405, %lay_409) : !memref_gmem_bf16_5
      %iter_411 = cute.get_iter(%view_410) : !memref_gmem_bf16_5
      %coord_412 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_413 = cute.get_iter(%view_380) : !memref_smem_bf16_
      %199 = cute.get_scalars(%coord_412) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_414 = arith.constant 8 : i32
      %200 = arith.divsi %199, %c8_i32_414 : i32
      %c8_i32_415 = arith.constant 8 : i32
      %201 = arith.remsi %199, %c8_i32_415 : i32
      %c2_i32 = arith.constant 2 : i32
      %202 = arith.divsi %201, %c2_i32 : i32
      %c2_i32_416 = arith.constant 2 : i32
      %203 = arith.remsi %201, %c2_i32_416 : i32
      %c16_i32 = arith.constant 16 : i32
      %204 = arith.muli %202, %c16_i32 : i32
      %c64_i32_417 = arith.constant 64 : i32
      %205 = arith.muli %200, %c64_i32_417 : i32
      %206 = arith.addi %204, %205 : i32
      %c0_i32 = arith.constant 0 : i32
      %207 = arith.xori %206, %c0_i32 : i32
      %c8_i32_418 = arith.constant 8 : i32
      %208 = arith.divsi %199, %c8_i32_418 : i32
      %c8_i32_419 = arith.constant 8 : i32
      %209 = arith.remsi %199, %c8_i32_419 : i32
      %c2_i32_420 = arith.constant 2 : i32
      %210 = arith.divsi %209, %c2_i32_420 : i32
      %c2_i32_421 = arith.constant 2 : i32
      %211 = arith.remsi %209, %c2_i32_421 : i32
      %c8_i32_422 = arith.constant 8 : i32
      %212 = arith.muli %211, %c8_i32_422 : i32
      %c128_i32_423 = arith.constant 128 : i32
      %213 = arith.andi %207, %c128_i32_423 : i32
      %c0_i32_424 = arith.constant 0 : i32
      %214 = arith.cmpi eq, %213, %c0_i32_424 : i32
      %215 = scf.if %214 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32 = arith.constant 256 : i32
      %216 = arith.andi %207, %c256_i32 : i32
      %c0_i32_425 = arith.constant 0 : i32
      %217 = arith.cmpi eq, %216, %c0_i32_425 : i32
      %218 = scf.if %217 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32 = arith.constant 512 : i32
      %219 = arith.andi %207, %c512_i32 : i32
      %c0_i32_426 = arith.constant 0 : i32
      %220 = arith.cmpi eq, %219, %c0_i32_426 : i32
      %221 = scf.if %220 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_427 = arith.constant 16 : i32
      %222 = arith.andi %207, %c16_i32_427 : i32
      %c0_i32_428 = arith.constant 0 : i32
      %223 = arith.cmpi eq, %222, %c0_i32_428 : i32
      %224 = scf.if %223 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32 = arith.constant 32 : i32
      %225 = arith.andi %207, %c32_i32 : i32
      %c0_i32_429 = arith.constant 0 : i32
      %226 = arith.cmpi eq, %225, %c0_i32_429 : i32
      %227 = scf.if %226 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_430 = arith.constant 64 : i32
      %228 = arith.andi %207, %c64_i32_430 : i32
      %c0_i32_431 = arith.constant 0 : i32
      %229 = arith.cmpi eq, %228, %c0_i32_431 : i32
      %230 = scf.if %229 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32 = arith.constant 896 : i32
      %231 = arith.andi %207, %c896_i32 : i32
      %c3_i32 = arith.constant 3 : i32
      %232 = arith.shrsi %231, %c3_i32 : i32
      %233 = arith.xori %207, %232 : i32
      %234 = arith.addi %233, %212 : i32
      %c64_i32_432 = arith.constant 64 : i32
      %235 = arith.muli %215, %c64_i32_432 : i32
      %c32_i32_433 = arith.constant 32 : i32
      %236 = arith.muli %218, %c32_i32_433 : i32
      %c16_i32_434 = arith.constant 16 : i32
      %237 = arith.muli %221, %c16_i32_434 : i32
      %c8_i32_435 = arith.constant 8 : i32
      %238 = arith.muli %224, %c8_i32_435 : i32
      %c4_i32 = arith.constant 4 : i32
      %239 = arith.muli %227, %c4_i32 : i32
      %c2_i32_436 = arith.constant 2 : i32
      %240 = arith.muli %230, %c2_i32_436 : i32
      %c256_i32_437 = arith.constant 256 : i32
      %241 = arith.muli %215, %c256_i32_437 : i32
      %c128_i32_438 = arith.constant 128 : i32
      %242 = arith.muli %218, %c128_i32_438 : i32
      %c64_i32_439 = arith.constant 64 : i32
      %243 = arith.muli %221, %c64_i32_439 : i32
      %c32_i32_440 = arith.constant 32 : i32
      %244 = arith.muli %224, %c32_i32_440 : i32
      %c16_i32_441 = arith.constant 16 : i32
      %245 = arith.muli %227, %c16_i32_441 : i32
      %c8_i32_442 = arith.constant 8 : i32
      %246 = arith.muli %230, %c8_i32_442 : i32
      %iv_443 = cute.assume(%234) : (i32) -> !cute.i32<divby 8>
      %int_tuple_444 = cute.make_int_tuple(%iv_443) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_445 = cute.add_offset(%iter_413, %int_tuple_444) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_446 = cute.make_view(%ptr_445) : !memref_smem_bf16_3
      %iter_447 = cute.get_iter(%view_446) : !memref_smem_bf16_3
      %coord_448 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_449 = cute.get_iter(%view_298) : !memref_gmem_bf16_3
      %lay_450 = cute.get_layout(%view_298) : !memref_gmem_bf16_3
      %247:3 = cute.get_scalars(%lay_450) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %248 = cute.get_scalars(%coord_448) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_451 = arith.constant 16 : i64
      %249 = arith.muli %247#1, %c16_i64_451 : i64
      %c128_i64_452 = arith.constant 128 : i64
      %250 = arith.muli %247#1, %c128_i64_452 : i64
      %c16_i64_453 = arith.constant 16 : i64
      %251 = arith.muli %247#1, %c16_i64_453 : i64
      %c8_i32_454 = arith.constant 8 : i32
      %252 = arith.divsi %248, %c8_i32_454 : i32
      %c8_i32_455 = arith.constant 8 : i32
      %253 = arith.remsi %248, %c8_i32_455 : i32
      %c8_i32_456 = arith.constant 8 : i32
      %254 = arith.muli %253, %c8_i32_456 : i32
      %255 = arith.extsi %252 : i32 to i64
      %256 = arith.muli %255, %247#1 : i64
      %257 = arith.extsi %254 : i32 to i64
      %258 = arith.addi %257, %256 : i64
      %iv_457 = cute.assume(%258) : (i64) -> !cute.i64<divby 8>
      %int_tuple_458 = cute.make_int_tuple(%iv_457) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_459 = cute.add_offset(%iter_449, %int_tuple_458) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_460 = cute.make_shape(%247#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_461 = cute.assume(%249) : (i64) -> !cute.i64<divby 128>
      %iv_462 = cute.assume(%247#2) : (i64) -> !cute.i64<divby 512>
      %stride_463 = cute.make_stride(%iv_461, %iv_462) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_464 = cute.make_layout(%shape_460, %stride_463) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_465 = cute.make_view(%ptr_459, %lay_464) : !memref_gmem_bf16_6
      %iter_466 = cute.get_iter(%view_465) : !memref_gmem_bf16_6
      %coord_467 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_468 = cute.get_iter(%view_383) : !memref_smem_bf16_
      %259 = cute.get_scalars(%coord_467) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_469 = arith.constant 8 : i32
      %260 = arith.divsi %259, %c8_i32_469 : i32
      %c8_i32_470 = arith.constant 8 : i32
      %261 = arith.remsi %259, %c8_i32_470 : i32
      %c2_i32_471 = arith.constant 2 : i32
      %262 = arith.divsi %261, %c2_i32_471 : i32
      %c2_i32_472 = arith.constant 2 : i32
      %263 = arith.remsi %261, %c2_i32_472 : i32
      %c16_i32_473 = arith.constant 16 : i32
      %264 = arith.muli %262, %c16_i32_473 : i32
      %c64_i32_474 = arith.constant 64 : i32
      %265 = arith.muli %260, %c64_i32_474 : i32
      %266 = arith.addi %264, %265 : i32
      %c0_i32_475 = arith.constant 0 : i32
      %267 = arith.xori %266, %c0_i32_475 : i32
      %c8_i32_476 = arith.constant 8 : i32
      %268 = arith.divsi %259, %c8_i32_476 : i32
      %c8_i32_477 = arith.constant 8 : i32
      %269 = arith.remsi %259, %c8_i32_477 : i32
      %c2_i32_478 = arith.constant 2 : i32
      %270 = arith.divsi %269, %c2_i32_478 : i32
      %c2_i32_479 = arith.constant 2 : i32
      %271 = arith.remsi %269, %c2_i32_479 : i32
      %c8_i32_480 = arith.constant 8 : i32
      %272 = arith.muli %271, %c8_i32_480 : i32
      %c128_i32_481 = arith.constant 128 : i32
      %273 = arith.andi %267, %c128_i32_481 : i32
      %c0_i32_482 = arith.constant 0 : i32
      %274 = arith.cmpi eq, %273, %c0_i32_482 : i32
      %275 = scf.if %274 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_483 = arith.constant 256 : i32
      %276 = arith.andi %267, %c256_i32_483 : i32
      %c0_i32_484 = arith.constant 0 : i32
      %277 = arith.cmpi eq, %276, %c0_i32_484 : i32
      %278 = scf.if %277 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_485 = arith.constant 512 : i32
      %279 = arith.andi %267, %c512_i32_485 : i32
      %c0_i32_486 = arith.constant 0 : i32
      %280 = arith.cmpi eq, %279, %c0_i32_486 : i32
      %281 = scf.if %280 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_487 = arith.constant 16 : i32
      %282 = arith.andi %267, %c16_i32_487 : i32
      %c0_i32_488 = arith.constant 0 : i32
      %283 = arith.cmpi eq, %282, %c0_i32_488 : i32
      %284 = scf.if %283 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_489 = arith.constant 32 : i32
      %285 = arith.andi %267, %c32_i32_489 : i32
      %c0_i32_490 = arith.constant 0 : i32
      %286 = arith.cmpi eq, %285, %c0_i32_490 : i32
      %287 = scf.if %286 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_491 = arith.constant 64 : i32
      %288 = arith.andi %267, %c64_i32_491 : i32
      %c0_i32_492 = arith.constant 0 : i32
      %289 = arith.cmpi eq, %288, %c0_i32_492 : i32
      %290 = scf.if %289 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_493 = arith.constant 896 : i32
      %291 = arith.andi %267, %c896_i32_493 : i32
      %c3_i32_494 = arith.constant 3 : i32
      %292 = arith.shrsi %291, %c3_i32_494 : i32
      %293 = arith.xori %267, %292 : i32
      %294 = arith.addi %293, %272 : i32
      %c64_i32_495 = arith.constant 64 : i32
      %295 = arith.muli %275, %c64_i32_495 : i32
      %c32_i32_496 = arith.constant 32 : i32
      %296 = arith.muli %278, %c32_i32_496 : i32
      %c16_i32_497 = arith.constant 16 : i32
      %297 = arith.muli %281, %c16_i32_497 : i32
      %c8_i32_498 = arith.constant 8 : i32
      %298 = arith.muli %284, %c8_i32_498 : i32
      %c4_i32_499 = arith.constant 4 : i32
      %299 = arith.muli %287, %c4_i32_499 : i32
      %c2_i32_500 = arith.constant 2 : i32
      %300 = arith.muli %290, %c2_i32_500 : i32
      %c256_i32_501 = arith.constant 256 : i32
      %301 = arith.muli %275, %c256_i32_501 : i32
      %c128_i32_502 = arith.constant 128 : i32
      %302 = arith.muli %278, %c128_i32_502 : i32
      %c64_i32_503 = arith.constant 64 : i32
      %303 = arith.muli %281, %c64_i32_503 : i32
      %c32_i32_504 = arith.constant 32 : i32
      %304 = arith.muli %284, %c32_i32_504 : i32
      %c16_i32_505 = arith.constant 16 : i32
      %305 = arith.muli %287, %c16_i32_505 : i32
      %c8_i32_506 = arith.constant 8 : i32
      %306 = arith.muli %290, %c8_i32_506 : i32
      %iv_507 = cute.assume(%294) : (i32) -> !cute.i32<divby 8>
      %int_tuple_508 = cute.make_int_tuple(%iv_507) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_509 = cute.add_offset(%iter_468, %int_tuple_508) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_510 = cute.make_view(%ptr_509) : !memref_smem_bf16_3
      %iter_511 = cute.get_iter(%view_510) : !memref_smem_bf16_3
      %coord_512 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_513 = cute.get_iter(%view_333) : !memref_gmem_bf16_3
      %lay_514 = cute.get_layout(%view_333) : !memref_gmem_bf16_3
      %307:3 = cute.get_scalars(%lay_514) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %308 = cute.get_scalars(%coord_512) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_515 = arith.constant 16 : i64
      %309 = arith.muli %307#1, %c16_i64_515 : i64
      %c128_i64_516 = arith.constant 128 : i64
      %310 = arith.muli %307#1, %c128_i64_516 : i64
      %c16_i64_517 = arith.constant 16 : i64
      %311 = arith.muli %307#1, %c16_i64_517 : i64
      %c8_i32_518 = arith.constant 8 : i32
      %312 = arith.divsi %308, %c8_i32_518 : i32
      %c8_i32_519 = arith.constant 8 : i32
      %313 = arith.remsi %308, %c8_i32_519 : i32
      %c8_i32_520 = arith.constant 8 : i32
      %314 = arith.muli %313, %c8_i32_520 : i32
      %315 = arith.extsi %312 : i32 to i64
      %316 = arith.muli %315, %307#1 : i64
      %317 = arith.extsi %314 : i32 to i64
      %318 = arith.addi %317, %316 : i64
      %iv_521 = cute.assume(%318) : (i64) -> !cute.i64<divby 8>
      %int_tuple_522 = cute.make_int_tuple(%iv_521) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_523 = cute.add_offset(%iter_513, %int_tuple_522) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_524 = cute.make_shape(%307#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_525 = cute.assume(%309) : (i64) -> !cute.i64<divby 128>
      %iv_526 = cute.assume(%307#2) : (i64) -> !cute.i64<divby 512>
      %stride_527 = cute.make_stride(%iv_525, %iv_526) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_528 = cute.make_layout(%shape_524, %stride_527) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_529 = cute.make_view(%ptr_523, %lay_528) : !memref_gmem_bf16_6
      %iter_530 = cute.get_iter(%view_529) : !memref_gmem_bf16_6
      %coord_531 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_532 = cute.get_iter(%view_386) : !memref_smem_bf16_
      %319 = cute.get_scalars(%coord_531) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_533 = arith.constant 8 : i32
      %320 = arith.divsi %319, %c8_i32_533 : i32
      %c8_i32_534 = arith.constant 8 : i32
      %321 = arith.remsi %319, %c8_i32_534 : i32
      %c2_i32_535 = arith.constant 2 : i32
      %322 = arith.divsi %321, %c2_i32_535 : i32
      %c2_i32_536 = arith.constant 2 : i32
      %323 = arith.remsi %321, %c2_i32_536 : i32
      %c16_i32_537 = arith.constant 16 : i32
      %324 = arith.muli %322, %c16_i32_537 : i32
      %c64_i32_538 = arith.constant 64 : i32
      %325 = arith.muli %320, %c64_i32_538 : i32
      %326 = arith.addi %324, %325 : i32
      %c0_i32_539 = arith.constant 0 : i32
      %327 = arith.xori %326, %c0_i32_539 : i32
      %c8_i32_540 = arith.constant 8 : i32
      %328 = arith.divsi %319, %c8_i32_540 : i32
      %c8_i32_541 = arith.constant 8 : i32
      %329 = arith.remsi %319, %c8_i32_541 : i32
      %c2_i32_542 = arith.constant 2 : i32
      %330 = arith.divsi %329, %c2_i32_542 : i32
      %c2_i32_543 = arith.constant 2 : i32
      %331 = arith.remsi %329, %c2_i32_543 : i32
      %c8_i32_544 = arith.constant 8 : i32
      %332 = arith.muli %331, %c8_i32_544 : i32
      %c128_i32_545 = arith.constant 128 : i32
      %333 = arith.andi %327, %c128_i32_545 : i32
      %c0_i32_546 = arith.constant 0 : i32
      %334 = arith.cmpi eq, %333, %c0_i32_546 : i32
      %335 = scf.if %334 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_547 = arith.constant 256 : i32
      %336 = arith.andi %327, %c256_i32_547 : i32
      %c0_i32_548 = arith.constant 0 : i32
      %337 = arith.cmpi eq, %336, %c0_i32_548 : i32
      %338 = scf.if %337 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_549 = arith.constant 512 : i32
      %339 = arith.andi %327, %c512_i32_549 : i32
      %c0_i32_550 = arith.constant 0 : i32
      %340 = arith.cmpi eq, %339, %c0_i32_550 : i32
      %341 = scf.if %340 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_551 = arith.constant 16 : i32
      %342 = arith.andi %327, %c16_i32_551 : i32
      %c0_i32_552 = arith.constant 0 : i32
      %343 = arith.cmpi eq, %342, %c0_i32_552 : i32
      %344 = scf.if %343 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_553 = arith.constant 32 : i32
      %345 = arith.andi %327, %c32_i32_553 : i32
      %c0_i32_554 = arith.constant 0 : i32
      %346 = arith.cmpi eq, %345, %c0_i32_554 : i32
      %347 = scf.if %346 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_555 = arith.constant 64 : i32
      %348 = arith.andi %327, %c64_i32_555 : i32
      %c0_i32_556 = arith.constant 0 : i32
      %349 = arith.cmpi eq, %348, %c0_i32_556 : i32
      %350 = scf.if %349 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_557 = arith.constant 896 : i32
      %351 = arith.andi %327, %c896_i32_557 : i32
      %c3_i32_558 = arith.constant 3 : i32
      %352 = arith.shrsi %351, %c3_i32_558 : i32
      %353 = arith.xori %327, %352 : i32
      %354 = arith.addi %353, %332 : i32
      %c64_i32_559 = arith.constant 64 : i32
      %355 = arith.muli %335, %c64_i32_559 : i32
      %c32_i32_560 = arith.constant 32 : i32
      %356 = arith.muli %338, %c32_i32_560 : i32
      %c16_i32_561 = arith.constant 16 : i32
      %357 = arith.muli %341, %c16_i32_561 : i32
      %c8_i32_562 = arith.constant 8 : i32
      %358 = arith.muli %344, %c8_i32_562 : i32
      %c4_i32_563 = arith.constant 4 : i32
      %359 = arith.muli %347, %c4_i32_563 : i32
      %c2_i32_564 = arith.constant 2 : i32
      %360 = arith.muli %350, %c2_i32_564 : i32
      %c256_i32_565 = arith.constant 256 : i32
      %361 = arith.muli %335, %c256_i32_565 : i32
      %c128_i32_566 = arith.constant 128 : i32
      %362 = arith.muli %338, %c128_i32_566 : i32
      %c64_i32_567 = arith.constant 64 : i32
      %363 = arith.muli %341, %c64_i32_567 : i32
      %c32_i32_568 = arith.constant 32 : i32
      %364 = arith.muli %344, %c32_i32_568 : i32
      %c16_i32_569 = arith.constant 16 : i32
      %365 = arith.muli %347, %c16_i32_569 : i32
      %c8_i32_570 = arith.constant 8 : i32
      %366 = arith.muli %350, %c8_i32_570 : i32
      %iv_571 = cute.assume(%354) : (i32) -> !cute.i32<divby 8>
      %int_tuple_572 = cute.make_int_tuple(%iv_571) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_573 = cute.add_offset(%iter_532, %int_tuple_572) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_574 = cute.make_view(%ptr_573) : !memref_smem_bf16_3
      %iter_575 = cute.get_iter(%view_574) : !memref_smem_bf16_3
      %coord_576 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_577 = cute.get_iter(%view_367) : !memref_gmem_bf16_4
      %lay_578 = cute.get_layout(%view_367) : !memref_gmem_bf16_4
      %367:2 = cute.get_scalars(%lay_578) <{only_dynamic}> : !cute.layout<"(64,64,?):(?{i64 div=8},1,64)">
      %368 = cute.get_scalars(%coord_576) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_579 = arith.constant 16 : i64
      %369 = arith.muli %367#1, %c16_i64_579 : i64
      %c128_i64_580 = arith.constant 128 : i64
      %370 = arith.muli %367#1, %c128_i64_580 : i64
      %c16_i64_581 = arith.constant 16 : i64
      %371 = arith.muli %367#1, %c16_i64_581 : i64
      %c8_i32_582 = arith.constant 8 : i32
      %372 = arith.divsi %368, %c8_i32_582 : i32
      %c8_i32_583 = arith.constant 8 : i32
      %373 = arith.remsi %368, %c8_i32_583 : i32
      %c8_i32_584 = arith.constant 8 : i32
      %374 = arith.muli %373, %c8_i32_584 : i32
      %375 = arith.extsi %372 : i32 to i64
      %376 = arith.muli %375, %367#1 : i64
      %377 = arith.extsi %374 : i32 to i64
      %378 = arith.addi %377, %376 : i64
      %iv_585 = cute.assume(%378) : (i64) -> !cute.i64<divby 8>
      %int_tuple_586 = cute.make_int_tuple(%iv_585) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_587 = cute.add_offset(%iter_577, %int_tuple_586) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_588 = cute.make_shape(%367#0) : (i32) -> !cute.shape<"((8,1),4,1,?)">
      %iv_589 = cute.assume(%369) : (i64) -> !cute.i64<divby 128>
      %stride_590 = cute.make_stride(%iv_589) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},0,64)">
      %lay_591 = cute.make_layout(%shape_588, %stride_590) : !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">
      %view_592 = cute.make_view(%ptr_587, %lay_591) : !memref_gmem_bf16_7
      %iter_593 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
      %coord_594 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_595 = cute.get_iter(%view_389) : !memref_smem_bf16_1
      %379 = cute.get_scalars(%coord_594) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_596 = arith.constant 8 : i32
      %380 = arith.divsi %379, %c8_i32_596 : i32
      %c8_i32_597 = arith.constant 8 : i32
      %381 = arith.remsi %379, %c8_i32_597 : i32
      %c2_i32_598 = arith.constant 2 : i32
      %382 = arith.divsi %381, %c2_i32_598 : i32
      %c2_i32_599 = arith.constant 2 : i32
      %383 = arith.remsi %381, %c2_i32_599 : i32
      %c16_i32_600 = arith.constant 16 : i32
      %384 = arith.muli %382, %c16_i32_600 : i32
      %c64_i32_601 = arith.constant 64 : i32
      %385 = arith.muli %380, %c64_i32_601 : i32
      %386 = arith.addi %384, %385 : i32
      %c0_i32_602 = arith.constant 0 : i32
      %387 = arith.xori %386, %c0_i32_602 : i32
      %c8_i32_603 = arith.constant 8 : i32
      %388 = arith.divsi %379, %c8_i32_603 : i32
      %c8_i32_604 = arith.constant 8 : i32
      %389 = arith.remsi %379, %c8_i32_604 : i32
      %c2_i32_605 = arith.constant 2 : i32
      %390 = arith.divsi %389, %c2_i32_605 : i32
      %c2_i32_606 = arith.constant 2 : i32
      %391 = arith.remsi %389, %c2_i32_606 : i32
      %c8_i32_607 = arith.constant 8 : i32
      %392 = arith.muli %391, %c8_i32_607 : i32
      %c128_i32_608 = arith.constant 128 : i32
      %393 = arith.andi %387, %c128_i32_608 : i32
      %c0_i32_609 = arith.constant 0 : i32
      %394 = arith.cmpi eq, %393, %c0_i32_609 : i32
      %395 = scf.if %394 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_610 = arith.constant 256 : i32
      %396 = arith.andi %387, %c256_i32_610 : i32
      %c0_i32_611 = arith.constant 0 : i32
      %397 = arith.cmpi eq, %396, %c0_i32_611 : i32
      %398 = scf.if %397 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_612 = arith.constant 512 : i32
      %399 = arith.andi %387, %c512_i32_612 : i32
      %c0_i32_613 = arith.constant 0 : i32
      %400 = arith.cmpi eq, %399, %c0_i32_613 : i32
      %401 = scf.if %400 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_614 = arith.constant 16 : i32
      %402 = arith.andi %387, %c16_i32_614 : i32
      %c0_i32_615 = arith.constant 0 : i32
      %403 = arith.cmpi eq, %402, %c0_i32_615 : i32
      %404 = scf.if %403 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_616 = arith.constant 32 : i32
      %405 = arith.andi %387, %c32_i32_616 : i32
      %c0_i32_617 = arith.constant 0 : i32
      %406 = arith.cmpi eq, %405, %c0_i32_617 : i32
      %407 = scf.if %406 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_618 = arith.constant 64 : i32
      %408 = arith.andi %387, %c64_i32_618 : i32
      %c0_i32_619 = arith.constant 0 : i32
      %409 = arith.cmpi eq, %408, %c0_i32_619 : i32
      %410 = scf.if %409 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_620 = arith.constant 896 : i32
      %411 = arith.andi %387, %c896_i32_620 : i32
      %c3_i32_621 = arith.constant 3 : i32
      %412 = arith.shrsi %411, %c3_i32_621 : i32
      %413 = arith.xori %387, %412 : i32
      %414 = arith.addi %413, %392 : i32
      %c64_i32_622 = arith.constant 64 : i32
      %415 = arith.muli %395, %c64_i32_622 : i32
      %c32_i32_623 = arith.constant 32 : i32
      %416 = arith.muli %398, %c32_i32_623 : i32
      %c16_i32_624 = arith.constant 16 : i32
      %417 = arith.muli %401, %c16_i32_624 : i32
      %c8_i32_625 = arith.constant 8 : i32
      %418 = arith.muli %404, %c8_i32_625 : i32
      %c4_i32_626 = arith.constant 4 : i32
      %419 = arith.muli %407, %c4_i32_626 : i32
      %c2_i32_627 = arith.constant 2 : i32
      %420 = arith.muli %410, %c2_i32_627 : i32
      %iv_628 = cute.assume(%414) : (i32) -> !cute.i32<divby 8>
      %int_tuple_629 = cute.make_int_tuple(%iv_628) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_630 = cute.add_offset(%iter_595, %int_tuple_629) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_631 = cute.make_view(%ptr_630) : !memref_smem_bf16_4
      %iter_632 = cute.get_iter(%view_631) : !memref_smem_bf16_4
      %coord_633 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_634 = cute.get_iter(%view_380) : !memref_smem_bf16_
      %421 = cute.get_scalars(%coord_633) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_635 = arith.constant 32 : i32
      %422 = arith.remsi %421, %c32_i32_635 : i32
      %c32_i32_636 = arith.constant 32 : i32
      %423 = arith.divsi %421, %c32_i32_636 : i32
      %c4_i32_637 = arith.constant 4 : i32
      %424 = arith.remsi %423, %c4_i32_637 : i32
      %c32_i32_638 = arith.constant 32 : i32
      %425 = arith.remsi %422, %c32_i32_638 : i32
      %c4_i32_639 = arith.constant 4 : i32
      %426 = arith.remsi %424, %c4_i32_639 : i32
      %c4_i32_640 = arith.constant 4 : i32
      %427 = arith.divsi %425, %c4_i32_640 : i32
      %c4_i32_641 = arith.constant 4 : i32
      %428 = arith.remsi %425, %c4_i32_641 : i32
      %c64_i32_642 = arith.constant 64 : i32
      %429 = arith.muli %427, %c64_i32_642 : i32
      %c0_i32_643 = arith.constant 0 : i32
      %430 = arith.xori %429, %c0_i32_643 : i32
      %c4_i32_644 = arith.constant 4 : i32
      %431 = arith.divsi %425, %c4_i32_644 : i32
      %c4_i32_645 = arith.constant 4 : i32
      %432 = arith.remsi %425, %c4_i32_645 : i32
      %c2_i32_646 = arith.constant 2 : i32
      %433 = arith.muli %432, %c2_i32_646 : i32
      %c1024_i32 = arith.constant 1024 : i32
      %434 = arith.muli %426, %c1024_i32 : i32
      %435 = arith.addi %433, %434 : i32
      %c128_i32_647 = arith.constant 128 : i32
      %436 = arith.andi %430, %c128_i32_647 : i32
      %c0_i32_648 = arith.constant 0 : i32
      %437 = arith.cmpi eq, %436, %c0_i32_648 : i32
      %438 = scf.if %437 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_649 = arith.constant 256 : i32
      %439 = arith.andi %430, %c256_i32_649 : i32
      %c0_i32_650 = arith.constant 0 : i32
      %440 = arith.cmpi eq, %439, %c0_i32_650 : i32
      %441 = scf.if %440 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_651 = arith.constant 512 : i32
      %442 = arith.andi %430, %c512_i32_651 : i32
      %c0_i32_652 = arith.constant 0 : i32
      %443 = arith.cmpi eq, %442, %c0_i32_652 : i32
      %444 = scf.if %443 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_653 = arith.constant 16 : i32
      %445 = arith.andi %430, %c16_i32_653 : i32
      %c0_i32_654 = arith.constant 0 : i32
      %446 = arith.cmpi eq, %445, %c0_i32_654 : i32
      %447 = scf.if %446 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_655 = arith.constant 32 : i32
      %448 = arith.andi %430, %c32_i32_655 : i32
      %c0_i32_656 = arith.constant 0 : i32
      %449 = arith.cmpi eq, %448, %c0_i32_656 : i32
      %450 = scf.if %449 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_657 = arith.constant 64 : i32
      %451 = arith.andi %430, %c64_i32_657 : i32
      %c0_i32_658 = arith.constant 0 : i32
      %452 = arith.cmpi eq, %451, %c0_i32_658 : i32
      %453 = scf.if %452 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_659 = arith.constant 896 : i32
      %454 = arith.andi %430, %c896_i32_659 : i32
      %c3_i32_660 = arith.constant 3 : i32
      %455 = arith.shrsi %454, %c3_i32_660 : i32
      %456 = arith.xori %430, %455 : i32
      %457 = arith.addi %456, %435 : i32
      %c32_i32_661 = arith.constant 32 : i32
      %458 = arith.muli %438, %c32_i32_661 : i32
      %c16_i32_662 = arith.constant 16 : i32
      %459 = arith.muli %441, %c16_i32_662 : i32
      %c8_i32_663 = arith.constant 8 : i32
      %460 = arith.muli %444, %c8_i32_663 : i32
      %c4_i32_664 = arith.constant 4 : i32
      %461 = arith.muli %447, %c4_i32_664 : i32
      %c2_i32_665 = arith.constant 2 : i32
      %462 = arith.muli %450, %c2_i32_665 : i32
      %c256_i32_666 = arith.constant 256 : i32
      %463 = arith.muli %438, %c256_i32_666 : i32
      %c128_i32_667 = arith.constant 128 : i32
      %464 = arith.muli %441, %c128_i32_667 : i32
      %c64_i32_668 = arith.constant 64 : i32
      %465 = arith.muli %444, %c64_i32_668 : i32
      %c32_i32_669 = arith.constant 32 : i32
      %466 = arith.muli %447, %c32_i32_669 : i32
      %c16_i32_670 = arith.constant 16 : i32
      %467 = arith.muli %450, %c16_i32_670 : i32
      %c8_i32_671 = arith.constant 8 : i32
      %468 = arith.muli %453, %c8_i32_671 : i32
      %iv_672 = cute.assume(%457) : (i32) -> !cute.i32<divby 2>
      %int_tuple_673 = cute.make_int_tuple(%iv_672) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_674 = cute.add_offset(%iter_634, %int_tuple_673) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_675 = cute.make_shape() : () -> !cute.shape<"((2,2,2),1,((2,2),2))">
      %iv_676 = cute.assume(%453) : (i32) -> !cute.i32<divby 64>
      %iv_677 = cute.assume(%438) : (i32) -> !cute.i32<divby 16>
      %iv_678 = cute.assume(%441) : (i32) -> !cute.i32<divby 32>
      %stride_679 = cute.make_stride(%iv_676, %iv_677, %iv_678) : (!cute.i32<divby 64>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
      %lay_680 = cute.make_layout(%shape_675, %stride_679) : !cute.layout<"((2,2,2),1,((2,2),2)):((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
      %view_681 = cute.make_view(%ptr_674, %lay_680) : !memref_smem_bf16_5
      %iter_682 = cute.get_iter(%view_681) : !memref_smem_bf16_5
      %rmem = cute.memref.alloca() : !memref_rmem_bf16_
      %iter_683 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %coord_684 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_685 = cute.get_iter(%view_383) : !memref_smem_bf16_
      %469 = cute.get_scalars(%coord_684) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_686 = arith.constant 32 : i32
      %470 = arith.remsi %469, %c32_i32_686 : i32
      %c32_i32_687 = arith.constant 32 : i32
      %471 = arith.divsi %469, %c32_i32_687 : i32
      %c4_i32_688 = arith.constant 4 : i32
      %472 = arith.remsi %471, %c4_i32_688 : i32
      %c32_i32_689 = arith.constant 32 : i32
      %473 = arith.remsi %470, %c32_i32_689 : i32
      %c4_i32_690 = arith.constant 4 : i32
      %474 = arith.remsi %472, %c4_i32_690 : i32
      %c4_i32_691 = arith.constant 4 : i32
      %475 = arith.divsi %473, %c4_i32_691 : i32
      %c4_i32_692 = arith.constant 4 : i32
      %476 = arith.remsi %473, %c4_i32_692 : i32
      %c64_i32_693 = arith.constant 64 : i32
      %477 = arith.muli %475, %c64_i32_693 : i32
      %c0_i32_694 = arith.constant 0 : i32
      %478 = arith.xori %477, %c0_i32_694 : i32
      %c4_i32_695 = arith.constant 4 : i32
      %479 = arith.divsi %473, %c4_i32_695 : i32
      %c4_i32_696 = arith.constant 4 : i32
      %480 = arith.remsi %473, %c4_i32_696 : i32
      %c2_i32_697 = arith.constant 2 : i32
      %481 = arith.muli %480, %c2_i32_697 : i32
      %c128_i32_698 = arith.constant 128 : i32
      %482 = arith.andi %478, %c128_i32_698 : i32
      %c0_i32_699 = arith.constant 0 : i32
      %483 = arith.cmpi eq, %482, %c0_i32_699 : i32
      %484 = scf.if %483 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_700 = arith.constant 256 : i32
      %485 = arith.andi %478, %c256_i32_700 : i32
      %c0_i32_701 = arith.constant 0 : i32
      %486 = arith.cmpi eq, %485, %c0_i32_701 : i32
      %487 = scf.if %486 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_702 = arith.constant 512 : i32
      %488 = arith.andi %478, %c512_i32_702 : i32
      %c0_i32_703 = arith.constant 0 : i32
      %489 = arith.cmpi eq, %488, %c0_i32_703 : i32
      %490 = scf.if %489 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_704 = arith.constant 16 : i32
      %491 = arith.andi %478, %c16_i32_704 : i32
      %c0_i32_705 = arith.constant 0 : i32
      %492 = arith.cmpi eq, %491, %c0_i32_705 : i32
      %493 = scf.if %492 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_706 = arith.constant 32 : i32
      %494 = arith.andi %478, %c32_i32_706 : i32
      %c0_i32_707 = arith.constant 0 : i32
      %495 = arith.cmpi eq, %494, %c0_i32_707 : i32
      %496 = scf.if %495 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_708 = arith.constant 64 : i32
      %497 = arith.andi %478, %c64_i32_708 : i32
      %c0_i32_709 = arith.constant 0 : i32
      %498 = arith.cmpi eq, %497, %c0_i32_709 : i32
      %499 = scf.if %498 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_710 = arith.constant 896 : i32
      %500 = arith.andi %478, %c896_i32_710 : i32
      %c3_i32_711 = arith.constant 3 : i32
      %501 = arith.shrsi %500, %c3_i32_711 : i32
      %502 = arith.xori %478, %501 : i32
      %503 = arith.addi %502, %481 : i32
      %c32_i32_712 = arith.constant 32 : i32
      %504 = arith.muli %484, %c32_i32_712 : i32
      %c16_i32_713 = arith.constant 16 : i32
      %505 = arith.muli %487, %c16_i32_713 : i32
      %c8_i32_714 = arith.constant 8 : i32
      %506 = arith.muli %490, %c8_i32_714 : i32
      %c4_i32_715 = arith.constant 4 : i32
      %507 = arith.muli %493, %c4_i32_715 : i32
      %c2_i32_716 = arith.constant 2 : i32
      %508 = arith.muli %496, %c2_i32_716 : i32
      %c256_i32_717 = arith.constant 256 : i32
      %509 = arith.muli %484, %c256_i32_717 : i32
      %c128_i32_718 = arith.constant 128 : i32
      %510 = arith.muli %487, %c128_i32_718 : i32
      %c64_i32_719 = arith.constant 64 : i32
      %511 = arith.muli %490, %c64_i32_719 : i32
      %c32_i32_720 = arith.constant 32 : i32
      %512 = arith.muli %493, %c32_i32_720 : i32
      %c16_i32_721 = arith.constant 16 : i32
      %513 = arith.muli %496, %c16_i32_721 : i32
      %c8_i32_722 = arith.constant 8 : i32
      %514 = arith.muli %499, %c8_i32_722 : i32
      %iv_723 = cute.assume(%503) : (i32) -> !cute.i32<divby 2>
      %int_tuple_724 = cute.make_int_tuple(%iv_723) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_725 = cute.add_offset(%iter_685, %int_tuple_724) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_726 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,4),((2,2),2))">
      %iv_727 = cute.assume(%499) : (i32) -> !cute.i32<divby 64>
      %iv_728 = cute.assume(%484) : (i32) -> !cute.i32<divby 16>
      %iv_729 = cute.assume(%487) : (i32) -> !cute.i32<divby 32>
      %stride_730 = cute.make_stride(%iv_727, %iv_728, %iv_729) : (!cute.i32<divby 64>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
      %lay_731 = cute.make_layout(%shape_726, %stride_730) : !cute.layout<"((2,2),(2,4),((2,2),2)):((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
      %view_732 = cute.make_view(%ptr_725, %lay_731) : !memref_smem_bf16_6
      %iter_733 = cute.get_iter(%view_732) : !memref_smem_bf16_6
      %rmem_734 = cute.memref.alloca() : !memref_rmem_bf16_1
      %iter_735 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
      %coord_736 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_737 = cute.get_iter(%view_395) : !memref_smem_bf16_2
      %515 = cute.get_scalars(%coord_736) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_738 = arith.constant 32 : i32
      %516 = arith.remsi %515, %c32_i32_738 : i32
      %c32_i32_739 = arith.constant 32 : i32
      %517 = arith.divsi %515, %c32_i32_739 : i32
      %c4_i32_740 = arith.constant 4 : i32
      %518 = arith.remsi %517, %c4_i32_740 : i32
      %c32_i32_741 = arith.constant 32 : i32
      %519 = arith.remsi %516, %c32_i32_741 : i32
      %c4_i32_742 = arith.constant 4 : i32
      %520 = arith.remsi %518, %c4_i32_742 : i32
      %c4_i32_743 = arith.constant 4 : i32
      %521 = arith.divsi %519, %c4_i32_743 : i32
      %c4_i32_744 = arith.constant 4 : i32
      %522 = arith.remsi %519, %c4_i32_744 : i32
      %c128_i32_745 = arith.constant 128 : i32
      %523 = arith.muli %522, %c128_i32_745 : i32
      %c0_i32_746 = arith.constant 0 : i32
      %524 = arith.xori %523, %c0_i32_746 : i32
      %c4_i32_747 = arith.constant 4 : i32
      %525 = arith.divsi %519, %c4_i32_747 : i32
      %c4_i32_748 = arith.constant 4 : i32
      %526 = arith.remsi %519, %c4_i32_748 : i32
      %int_tuple_749 = cute.make_int_tuple(%525) : (i32) -> !cute.int_tuple<"?">
      %ptr_750 = cute.add_offset(%iter_737, %int_tuple_749) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?">) -> !cute.ptr<bf16, smem>
      %lay_751 = cute.make_layout() : !cute.layout<"((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %iv_752 = cute.assume(%524) : (i32) -> !cute.i32<divby 128>
      %int_tuple_753 = cute.make_int_tuple(%iv_752) : (!cute.i32<divby 128>) -> !cute.int_tuple<"?{div=128}">
      %527 = cute.static : !cute.swizzle<"S<3,4,3>">
      %lay_754 = cute.make_composed_layout(%527, %int_tuple_753, %lay_751) : !cute.composed_layout<"S<3,4,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %view_755 = cute.make_view(%ptr_750, %lay_754) : !memref_smem_bf16_7
      %iter_756 = cute.get_iter(%view_755) : !memref_smem_bf16_7
      %rmem_757 = cute.memref.alloca() : !memref_rmem_bf16_2
      %iter_758 = cute.get_iter(%rmem_757) : !memref_rmem_bf16_2
      %shape_759 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %shape_760 = cute.make_shape() : () -> !cute.shape<"((2,2),1,16)">
      %e0_761, %e1_762, %e2_763, %e3_764 = cute.get_leaves(%shape_760) : !cute.shape<"((2,2),1,16)">
      %shape_765 = cute.make_shape() : () -> !cute.shape<"((2,2),1,16)">
      %lay_766 = cute.make_layout() : !cute.layout<"((2,2),1,16):((1,2),0,4)">
      %rmem_767 = cute.memref.alloca(%lay_766) : !memref_rmem_f32_
      %iter_768 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
      %iter_769 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
      %lay_770 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
      %sz = cute.size(%lay_770) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"64">
      %e0_771 = cute.get_leaves(%sz) : !cute.int_tuple<"64">
      %lay_772 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
      %528 = cute.get_shape(%lay_772) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_773, %e1_774, %e2_775, %e3_776 = cute.get_leaves(%528) : !cute.shape<"((2,2),1,16)">
      %int_tuple_777 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %int_tuple_778 = cute.make_int_tuple() : () -> !cute.int_tuple<"64">
      %e0_779 = cute.get_leaves(%int_tuple_778) : !cute.int_tuple<"64">
      %cst = arith.constant 0.000000e+00 : f32
      %529 = vector.splat %cst : vector<64xf32>
      %int_tuple_780 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_781 = cute.size(%int_tuple_780) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_782 = cute.get_leaves(%sz_781) : !cute.int_tuple<"64">
      %int_tuple_783 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_784 = cute.size(%int_tuple_783) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_785 = cute.get_leaves(%sz_784) : !cute.int_tuple<"64">
      cute.memref.store_vec %529, %rmem_767 : !memref_rmem_f32_
      %shape_786 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_787 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_788 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_789 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_790 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %shape_791 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_792 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %530 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %531 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_793, %e1_794, %e2_795 = cute.get_leaves(%531) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_796 = cute.size(%e0_793) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_797 = cute.get_leaves(%sz_796) : !cute.int_tuple<"64">
      %532 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_798, %e1_799, %e2_800 = cute.get_leaves(%532) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_801 = cute.size(%e2_800) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_802 = cute.get_leaves(%sz_801) : !cute.int_tuple<"16">
      %tile_803 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %533 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %534 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %535 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_804, %e1_805, %e2_806 = cute.get_leaves(%535) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_807 = cute.size(%e1_805) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_808 = cute.get_leaves(%sz_807) : !cute.int_tuple<"16">
      %536 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_809, %e1_810, %e2_811 = cute.get_leaves(%536) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_812 = cute.size(%e2_811) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_813 = cute.get_leaves(%sz_812) : !cute.int_tuple<"16">
      %tile_814 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %537 = cute.make_tiled_copy(%atom_788) : !copy_ldsm_4_1
      %538 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %539 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_815, %e1_816, %e2_817 = cute.get_leaves(%539) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_818 = cute.size(%e1_816) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_819 = cute.get_leaves(%sz_818) : !cute.int_tuple<"16">
      %540 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_820, %e1_821, %e2_822 = cute.get_leaves(%540) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_823 = cute.size(%e2_822) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_824 = cute.get_leaves(%sz_823) : !cute.int_tuple<"16">
      %tile_825 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %541 = cute.make_tiled_copy(%atom_790) : !copy_ldsm_4_2
      %542 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %543 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_826, %e1_827, %e2_828 = cute.get_leaves(%543) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_829 = cute.size(%e0_826) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_830 = cute.get_leaves(%sz_829) : !cute.int_tuple<"64">
      %544 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_831, %e1_832, %e2_833 = cute.get_leaves(%544) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_834 = cute.size(%e1_832) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_835 = cute.get_leaves(%sz_834) : !cute.int_tuple<"16">
      %tile_836 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %545 = cute.make_tiled_copy(%atom_792) : !copy_ldsm_4_3
      %coord_837 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_838 = cute.get_iter(%view_380) : !memref_smem_bf16_
      %546 = cute.get_scalars(%coord_837) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_839 = arith.constant 16 : i32
      %547 = arith.divsi %546, %c16_i32_839 : i32
      %c16_i32_840 = arith.constant 16 : i32
      %548 = arith.remsi %546, %c16_i32_840 : i32
      %c64_i32_841 = arith.constant 64 : i32
      %549 = arith.muli %548, %c64_i32_841 : i32
      %c2_i32_842 = arith.constant 2 : i32
      %550 = arith.divsi %547, %c2_i32_842 : i32
      %c2_i32_843 = arith.constant 2 : i32
      %551 = arith.remsi %547, %c2_i32_843 : i32
      %c0_i32_844 = arith.constant 0 : i32
      %552 = arith.xori %549, %c0_i32_844 : i32
      %c16_i32_845 = arith.constant 16 : i32
      %553 = arith.divsi %546, %c16_i32_845 : i32
      %c16_i32_846 = arith.constant 16 : i32
      %554 = arith.remsi %546, %c16_i32_846 : i32
      %c2_i32_847 = arith.constant 2 : i32
      %555 = arith.divsi %553, %c2_i32_847 : i32
      %c2_i32_848 = arith.constant 2 : i32
      %556 = arith.remsi %553, %c2_i32_848 : i32
      %c8_i32_849 = arith.constant 8 : i32
      %557 = arith.muli %556, %c8_i32_849 : i32
      %c1024_i32_850 = arith.constant 1024 : i32
      %558 = arith.muli %555, %c1024_i32_850 : i32
      %559 = arith.addi %557, %558 : i32
      %c128_i32_851 = arith.constant 128 : i32
      %560 = arith.andi %552, %c128_i32_851 : i32
      %c0_i32_852 = arith.constant 0 : i32
      %561 = arith.cmpi eq, %560, %c0_i32_852 : i32
      %562 = scf.if %561 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_853 = arith.constant 256 : i32
      %563 = arith.andi %552, %c256_i32_853 : i32
      %c0_i32_854 = arith.constant 0 : i32
      %564 = arith.cmpi eq, %563, %c0_i32_854 : i32
      %565 = scf.if %564 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_855 = arith.constant 512 : i32
      %566 = arith.andi %552, %c512_i32_855 : i32
      %c0_i32_856 = arith.constant 0 : i32
      %567 = arith.cmpi eq, %566, %c0_i32_856 : i32
      %568 = scf.if %567 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_857 = arith.constant 16 : i32
      %569 = arith.andi %552, %c16_i32_857 : i32
      %c0_i32_858 = arith.constant 0 : i32
      %570 = arith.cmpi eq, %569, %c0_i32_858 : i32
      %571 = scf.if %570 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_859 = arith.constant 32 : i32
      %572 = arith.andi %552, %c32_i32_859 : i32
      %c0_i32_860 = arith.constant 0 : i32
      %573 = arith.cmpi eq, %572, %c0_i32_860 : i32
      %574 = scf.if %573 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_861 = arith.constant 64 : i32
      %575 = arith.andi %552, %c64_i32_861 : i32
      %c0_i32_862 = arith.constant 0 : i32
      %576 = arith.cmpi eq, %575, %c0_i32_862 : i32
      %577 = scf.if %576 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_863 = arith.constant 896 : i32
      %578 = arith.andi %552, %c896_i32_863 : i32
      %c3_i32_864 = arith.constant 3 : i32
      %579 = arith.shrsi %578, %c3_i32_864 : i32
      %580 = arith.xori %552, %579 : i32
      %581 = arith.addi %580, %559 : i32
      %c256_i32_865 = arith.constant 256 : i32
      %582 = arith.muli %562, %c256_i32_865 : i32
      %c128_i32_866 = arith.constant 128 : i32
      %583 = arith.muli %565, %c128_i32_866 : i32
      %c64_i32_867 = arith.constant 64 : i32
      %584 = arith.muli %568, %c64_i32_867 : i32
      %c32_i32_868 = arith.constant 32 : i32
      %585 = arith.muli %571, %c32_i32_868 : i32
      %c16_i32_869 = arith.constant 16 : i32
      %586 = arith.muli %574, %c16_i32_869 : i32
      %c8_i32_870 = arith.constant 8 : i32
      %587 = arith.muli %577, %c8_i32_870 : i32
      %iv_871 = cute.assume(%581) : (i32) -> !cute.i32<divby 8>
      %int_tuple_872 = cute.make_int_tuple(%iv_871) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_873 = cute.add_offset(%iter_838, %int_tuple_872) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_874 = cute.make_shape() : () -> !cute.shape<"((8,1),1,((2,2),2))">
      %iv_875 = cute.assume(%562) : (i32) -> !cute.i32<divby 16>
      %iv_876 = cute.assume(%565) : (i32) -> !cute.i32<divby 32>
      %stride_877 = cute.make_stride(%iv_875, %iv_876) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),0,((?{div=16},?{div=32}),4096))">
      %lay_878 = cute.make_layout(%shape_874, %stride_877) : !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">
      %view_879 = cute.make_view(%ptr_873, %lay_878) : !memref_smem_bf16_8
      %iter_880 = cute.get_iter(%view_879) : !memref_smem_bf16_8
      %iter_881 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %view_882 = cute.make_view(%iter_881) : !memref_rmem_bf16_3
      %iter_883 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
      %coord_884 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_885 = cute.get_iter(%view_383) : !memref_smem_bf16_
      %588 = cute.get_scalars(%coord_884) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_886 = arith.constant 8 : i32
      %589 = arith.divsi %588, %c8_i32_886 : i32
      %c8_i32_887 = arith.constant 8 : i32
      %590 = arith.remsi %588, %c8_i32_887 : i32
      %c64_i32_888 = arith.constant 64 : i32
      %591 = arith.muli %590, %c64_i32_888 : i32
      %c2_i32_889 = arith.constant 2 : i32
      %592 = arith.divsi %589, %c2_i32_889 : i32
      %c2_i32_890 = arith.constant 2 : i32
      %593 = arith.remsi %589, %c2_i32_890 : i32
      %c2_i32_891 = arith.constant 2 : i32
      %594 = arith.divsi %592, %c2_i32_891 : i32
      %c2_i32_892 = arith.constant 2 : i32
      %595 = arith.remsi %592, %c2_i32_892 : i32
      %c512_i32_893 = arith.constant 512 : i32
      %596 = arith.muli %595, %c512_i32_893 : i32
      %597 = arith.addi %591, %596 : i32
      %c0_i32_894 = arith.constant 0 : i32
      %598 = arith.xori %597, %c0_i32_894 : i32
      %c8_i32_895 = arith.constant 8 : i32
      %599 = arith.divsi %588, %c8_i32_895 : i32
      %c8_i32_896 = arith.constant 8 : i32
      %600 = arith.remsi %588, %c8_i32_896 : i32
      %c2_i32_897 = arith.constant 2 : i32
      %601 = arith.divsi %599, %c2_i32_897 : i32
      %c2_i32_898 = arith.constant 2 : i32
      %602 = arith.remsi %599, %c2_i32_898 : i32
      %c8_i32_899 = arith.constant 8 : i32
      %603 = arith.muli %602, %c8_i32_899 : i32
      %c2_i32_900 = arith.constant 2 : i32
      %604 = arith.divsi %601, %c2_i32_900 : i32
      %c2_i32_901 = arith.constant 2 : i32
      %605 = arith.remsi %601, %c2_i32_901 : i32
      %c128_i32_902 = arith.constant 128 : i32
      %606 = arith.andi %598, %c128_i32_902 : i32
      %c0_i32_903 = arith.constant 0 : i32
      %607 = arith.cmpi eq, %606, %c0_i32_903 : i32
      %608 = scf.if %607 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_904 = arith.constant 256 : i32
      %609 = arith.andi %598, %c256_i32_904 : i32
      %c0_i32_905 = arith.constant 0 : i32
      %610 = arith.cmpi eq, %609, %c0_i32_905 : i32
      %611 = scf.if %610 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_906 = arith.constant 512 : i32
      %612 = arith.andi %598, %c512_i32_906 : i32
      %c0_i32_907 = arith.constant 0 : i32
      %613 = arith.cmpi eq, %612, %c0_i32_907 : i32
      %614 = scf.if %613 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_908 = arith.constant 16 : i32
      %615 = arith.andi %598, %c16_i32_908 : i32
      %c0_i32_909 = arith.constant 0 : i32
      %616 = arith.cmpi eq, %615, %c0_i32_909 : i32
      %617 = scf.if %616 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_910 = arith.constant 32 : i32
      %618 = arith.andi %598, %c32_i32_910 : i32
      %c0_i32_911 = arith.constant 0 : i32
      %619 = arith.cmpi eq, %618, %c0_i32_911 : i32
      %620 = scf.if %619 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_912 = arith.constant 64 : i32
      %621 = arith.andi %598, %c64_i32_912 : i32
      %c0_i32_913 = arith.constant 0 : i32
      %622 = arith.cmpi eq, %621, %c0_i32_913 : i32
      %623 = scf.if %622 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_914 = arith.constant 896 : i32
      %624 = arith.andi %598, %c896_i32_914 : i32
      %c3_i32_915 = arith.constant 3 : i32
      %625 = arith.shrsi %624, %c3_i32_915 : i32
      %626 = arith.xori %598, %625 : i32
      %627 = arith.addi %626, %603 : i32
      %c64_i32_916 = arith.constant 64 : i32
      %628 = arith.muli %608, %c64_i32_916 : i32
      %c32_i32_917 = arith.constant 32 : i32
      %629 = arith.muli %611, %c32_i32_917 : i32
      %c16_i32_918 = arith.constant 16 : i32
      %630 = arith.muli %614, %c16_i32_918 : i32
      %c8_i32_919 = arith.constant 8 : i32
      %631 = arith.muli %617, %c8_i32_919 : i32
      %c4_i32_920 = arith.constant 4 : i32
      %632 = arith.muli %620, %c4_i32_920 : i32
      %c2_i32_921 = arith.constant 2 : i32
      %633 = arith.muli %623, %c2_i32_921 : i32
      %c256_i32_922 = arith.constant 256 : i32
      %634 = arith.muli %608, %c256_i32_922 : i32
      %c128_i32_923 = arith.constant 128 : i32
      %635 = arith.muli %611, %c128_i32_923 : i32
      %c64_i32_924 = arith.constant 64 : i32
      %636 = arith.muli %614, %c64_i32_924 : i32
      %c32_i32_925 = arith.constant 32 : i32
      %637 = arith.muli %617, %c32_i32_925 : i32
      %c16_i32_926 = arith.constant 16 : i32
      %638 = arith.muli %620, %c16_i32_926 : i32
      %c8_i32_927 = arith.constant 8 : i32
      %639 = arith.muli %623, %c8_i32_927 : i32
      %iv_928 = cute.assume(%627) : (i32) -> !cute.i32<divby 8>
      %int_tuple_929 = cute.make_int_tuple(%iv_928) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_930 = cute.add_offset(%iter_885, %int_tuple_929) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_931 = cute.make_shape() : () -> !cute.shape<"((8,1),4,((2,2),2))">
      %iv_932 = cute.assume(%608) : (i32) -> !cute.i32<divby 16>
      %iv_933 = cute.assume(%611) : (i32) -> !cute.i32<divby 32>
      %stride_934 = cute.make_stride(%iv_932, %iv_933) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),1024,((?{div=16},?{div=32}),4096))">
      %lay_935 = cute.make_layout(%shape_931, %stride_934) : !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
      %view_936 = cute.make_view(%ptr_930, %lay_935) : !memref_smem_bf16_9
      %iter_937 = cute.get_iter(%view_936) : !memref_smem_bf16_9
      %iter_938 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
      %view_939 = cute.make_view(%iter_938) : !memref_rmem_bf16_4
      %iter_940 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
      %coord_941 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_942 = cute.get_iter(%view_395) : !memref_smem_bf16_2
      %640 = cute.get_scalars(%coord_941) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_943 = arith.constant 16 : i32
      %641 = arith.divsi %640, %c16_i32_943 : i32
      %c16_i32_944 = arith.constant 16 : i32
      %642 = arith.remsi %640, %c16_i32_944 : i32
      %c64_i32_945 = arith.constant 64 : i32
      %643 = arith.muli %642, %c64_i32_945 : i32
      %c2_i32_946 = arith.constant 2 : i32
      %644 = arith.divsi %641, %c2_i32_946 : i32
      %c2_i32_947 = arith.constant 2 : i32
      %645 = arith.remsi %641, %c2_i32_947 : i32
      %c0_i32_948 = arith.constant 0 : i32
      %646 = arith.xori %643, %c0_i32_948 : i32
      %c16_i32_949 = arith.constant 16 : i32
      %647 = arith.divsi %640, %c16_i32_949 : i32
      %c16_i32_950 = arith.constant 16 : i32
      %648 = arith.remsi %640, %c16_i32_950 : i32
      %c2_i32_951 = arith.constant 2 : i32
      %649 = arith.divsi %647, %c2_i32_951 : i32
      %c2_i32_952 = arith.constant 2 : i32
      %650 = arith.remsi %647, %c2_i32_952 : i32
      %c8_i32_953 = arith.constant 8 : i32
      %651 = arith.muli %650, %c8_i32_953 : i32
      %c128_i32_954 = arith.constant 128 : i32
      %652 = arith.andi %646, %c128_i32_954 : i32
      %c0_i32_955 = arith.constant 0 : i32
      %653 = arith.cmpi eq, %652, %c0_i32_955 : i32
      %654 = scf.if %653 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_956 = arith.constant 256 : i32
      %655 = arith.andi %646, %c256_i32_956 : i32
      %c0_i32_957 = arith.constant 0 : i32
      %656 = arith.cmpi eq, %655, %c0_i32_957 : i32
      %657 = scf.if %656 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_958 = arith.constant 512 : i32
      %658 = arith.andi %646, %c512_i32_958 : i32
      %c0_i32_959 = arith.constant 0 : i32
      %659 = arith.cmpi eq, %658, %c0_i32_959 : i32
      %660 = scf.if %659 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_960 = arith.constant 16 : i32
      %661 = arith.andi %646, %c16_i32_960 : i32
      %c0_i32_961 = arith.constant 0 : i32
      %662 = arith.cmpi eq, %661, %c0_i32_961 : i32
      %663 = scf.if %662 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_962 = arith.constant 32 : i32
      %664 = arith.andi %646, %c32_i32_962 : i32
      %c0_i32_963 = arith.constant 0 : i32
      %665 = arith.cmpi eq, %664, %c0_i32_963 : i32
      %666 = scf.if %665 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_964 = arith.constant 64 : i32
      %667 = arith.andi %646, %c64_i32_964 : i32
      %c0_i32_965 = arith.constant 0 : i32
      %668 = arith.cmpi eq, %667, %c0_i32_965 : i32
      %669 = scf.if %668 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_966 = arith.constant 896 : i32
      %670 = arith.andi %646, %c896_i32_966 : i32
      %c3_i32_967 = arith.constant 3 : i32
      %671 = arith.shrsi %670, %c3_i32_967 : i32
      %672 = arith.xori %646, %671 : i32
      %673 = arith.addi %672, %651 : i32
      %c256_i32_968 = arith.constant 256 : i32
      %674 = arith.muli %654, %c256_i32_968 : i32
      %c128_i32_969 = arith.constant 128 : i32
      %675 = arith.muli %657, %c128_i32_969 : i32
      %c64_i32_970 = arith.constant 64 : i32
      %676 = arith.muli %660, %c64_i32_970 : i32
      %c32_i32_971 = arith.constant 32 : i32
      %677 = arith.muli %663, %c32_i32_971 : i32
      %c16_i32_972 = arith.constant 16 : i32
      %678 = arith.muli %666, %c16_i32_972 : i32
      %c8_i32_973 = arith.constant 8 : i32
      %679 = arith.muli %669, %c8_i32_973 : i32
      %c64_i32_974 = arith.constant 64 : i32
      %680 = arith.muli %654, %c64_i32_974 : i32
      %c32_i32_975 = arith.constant 32 : i32
      %681 = arith.muli %657, %c32_i32_975 : i32
      %c16_i32_976 = arith.constant 16 : i32
      %682 = arith.muli %660, %c16_i32_976 : i32
      %c8_i32_977 = arith.constant 8 : i32
      %683 = arith.muli %663, %c8_i32_977 : i32
      %c4_i32_978 = arith.constant 4 : i32
      %684 = arith.muli %666, %c4_i32_978 : i32
      %c2_i32_979 = arith.constant 2 : i32
      %685 = arith.muli %669, %c2_i32_979 : i32
      %iv_980 = cute.assume(%673) : (i32) -> !cute.i32<divby 8>
      %int_tuple_981 = cute.make_int_tuple(%iv_980) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_982 = cute.add_offset(%iter_942, %int_tuple_981) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_983 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2),4)">
      %iv_984 = cute.assume(%654) : (i32) -> !cute.i32<divby 16>
      %iv_985 = cute.assume(%657) : (i32) -> !cute.i32<divby 32>
      %stride_986 = cute.make_stride(%iv_984, %iv_985) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096),1024)">
      %lay_987 = cute.make_layout(%shape_983, %stride_986) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %view_988 = cute.make_view(%ptr_982, %lay_987) : !memref_smem_bf16_10
      %iter_989 = cute.get_iter(%view_988) : !memref_smem_bf16_10
      %iter_990 = cute.get_iter(%rmem_757) : !memref_rmem_bf16_2
      %view_991 = cute.make_view(%iter_990) : !memref_rmem_bf16_5
      %iter_992 = cute.get_iter(%view_991) : !memref_rmem_bf16_5
      %coord_993 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_994 = cute.get_iter(%view_389) : !memref_smem_bf16_1
      %686 = cute.get_scalars(%coord_993) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_995 = arith.constant 16 : i32
      %687 = arith.divsi %686, %c16_i32_995 : i32
      %c16_i32_996 = arith.constant 16 : i32
      %688 = arith.remsi %686, %c16_i32_996 : i32
      %c64_i32_997 = arith.constant 64 : i32
      %689 = arith.muli %688, %c64_i32_997 : i32
      %c2_i32_998 = arith.constant 2 : i32
      %690 = arith.divsi %687, %c2_i32_998 : i32
      %c2_i32_999 = arith.constant 2 : i32
      %691 = arith.remsi %687, %c2_i32_999 : i32
      %c0_i32_1000 = arith.constant 0 : i32
      %692 = arith.xori %689, %c0_i32_1000 : i32
      %c16_i32_1001 = arith.constant 16 : i32
      %693 = arith.divsi %686, %c16_i32_1001 : i32
      %c16_i32_1002 = arith.constant 16 : i32
      %694 = arith.remsi %686, %c16_i32_1002 : i32
      %c2_i32_1003 = arith.constant 2 : i32
      %695 = arith.divsi %693, %c2_i32_1003 : i32
      %c2_i32_1004 = arith.constant 2 : i32
      %696 = arith.remsi %693, %c2_i32_1004 : i32
      %c8_i32_1005 = arith.constant 8 : i32
      %697 = arith.muli %696, %c8_i32_1005 : i32
      %c1024_i32_1006 = arith.constant 1024 : i32
      %698 = arith.muli %695, %c1024_i32_1006 : i32
      %699 = arith.addi %697, %698 : i32
      %c128_i32_1007 = arith.constant 128 : i32
      %700 = arith.andi %692, %c128_i32_1007 : i32
      %c0_i32_1008 = arith.constant 0 : i32
      %701 = arith.cmpi eq, %700, %c0_i32_1008 : i32
      %702 = scf.if %701 -> (i32) {
        %c16_i32_2759 = arith.constant 16 : i32
        scf.yield %c16_i32_2759 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_1009 = arith.constant 256 : i32
      %703 = arith.andi %692, %c256_i32_1009 : i32
      %c0_i32_1010 = arith.constant 0 : i32
      %704 = arith.cmpi eq, %703, %c0_i32_1010 : i32
      %705 = scf.if %704 -> (i32) {
        %c32_i32_2759 = arith.constant 32 : i32
        scf.yield %c32_i32_2759 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_1011 = arith.constant 512 : i32
      %706 = arith.andi %692, %c512_i32_1011 : i32
      %c0_i32_1012 = arith.constant 0 : i32
      %707 = arith.cmpi eq, %706, %c0_i32_1012 : i32
      %708 = scf.if %707 -> (i32) {
        %c64_i32_2759 = arith.constant 64 : i32
        scf.yield %c64_i32_2759 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_1013 = arith.constant 16 : i32
      %709 = arith.andi %692, %c16_i32_1013 : i32
      %c0_i32_1014 = arith.constant 0 : i32
      %710 = arith.cmpi eq, %709, %c0_i32_1014 : i32
      %711 = scf.if %710 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_1015 = arith.constant 32 : i32
      %712 = arith.andi %692, %c32_i32_1015 : i32
      %c0_i32_1016 = arith.constant 0 : i32
      %713 = arith.cmpi eq, %712, %c0_i32_1016 : i32
      %714 = scf.if %713 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_1017 = arith.constant 64 : i32
      %715 = arith.andi %692, %c64_i32_1017 : i32
      %c0_i32_1018 = arith.constant 0 : i32
      %716 = arith.cmpi eq, %715, %c0_i32_1018 : i32
      %717 = scf.if %716 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_1019 = arith.constant 896 : i32
      %718 = arith.andi %692, %c896_i32_1019 : i32
      %c3_i32_1020 = arith.constant 3 : i32
      %719 = arith.shrsi %718, %c3_i32_1020 : i32
      %720 = arith.xori %692, %719 : i32
      %721 = arith.addi %720, %699 : i32
      %iv_1021 = cute.assume(%721) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1022 = cute.make_int_tuple(%iv_1021) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_1023 = cute.add_offset(%iter_994, %int_tuple_1022) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_1024 = cute.make_shape() : () -> !cute.shape<"((8,1),1,(2,2))">
      %iv_1025 = cute.assume(%702) : (i32) -> !cute.i32<divby 16>
      %iv_1026 = cute.assume(%705) : (i32) -> !cute.i32<divby 32>
      %stride_1027 = cute.make_stride(%iv_1025, %iv_1026) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),0,(?{div=16},?{div=32}))">
      %lay_1028 = cute.make_layout(%shape_1024, %stride_1027) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
      %view_1029 = cute.make_view(%ptr_1023, %lay_1028) : !memref_smem_bf16_11
      %iter_1030 = cute.get_iter(%view_1029) : !memref_smem_bf16_11
      %lay_1031 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %722 = cute.get_shape(%lay_1031) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1032, %e1_1033, %e2_1034, %e3_1035 = cute.get_leaves(%722) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1036 = cute.to_int_tuple(%e0_1032) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %723 = cute.get_scalars(%itup_1036) : !cute.int_tuple<"?">
      %itup_1037 = cute.to_int_tuple(%e1_1033) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %724 = cute.get_scalars(%itup_1037) : !cute.int_tuple<"?">
      %itup_1038 = cute.to_int_tuple(%e2_1034) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %725 = cute.get_scalars(%itup_1038) : !cute.int_tuple<"?">
      %itup_1039 = cute.to_int_tuple(%e3_1035) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %726 = cute.get_scalars(%itup_1039) : !cute.int_tuple<"?{div=8}">
      %shape_1040 = cute.make_shape(%itup_1036, %itup_1037, %itup_1038, %itup_1039) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_1041 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_1042 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_1043 = cute.make_layout(%shape_1040, %stride_1042) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_1044 = cute.make_view(%int_tuple_1041, %lay_1043) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1045 = cute.get_iter(%view_1044) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1046, %e1_1047, %e2_1048, %e3_1049 = cute.get_leaves(%iter_1045) : !cute.int_tuple<"(0,0,0,0)">
      %lay_1050 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %727 = cute.get_shape(%lay_1050) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1051, %e1_1052, %e2_1053, %e3_1054 = cute.get_leaves(%727) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1055 = cute.to_int_tuple(%e0_1051) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %728 = cute.get_scalars(%itup_1055) : !cute.int_tuple<"?">
      %itup_1056 = cute.to_int_tuple(%e1_1052) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %729 = cute.get_scalars(%itup_1056) : !cute.int_tuple<"?">
      %itup_1057 = cute.to_int_tuple(%e2_1053) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %730 = cute.get_scalars(%itup_1057) : !cute.int_tuple<"?">
      %itup_1058 = cute.to_int_tuple(%e3_1054) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %731 = cute.get_scalars(%itup_1058) : !cute.int_tuple<"?{div=8}">
      %shape_1059 = cute.make_shape(%itup_1055, %itup_1056, %itup_1057, %itup_1058) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_1060 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_1061 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_1062 = cute.make_layout(%shape_1059, %stride_1061) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_1063 = cute.make_view(%int_tuple_1060, %lay_1062) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1064 = cute.get_iter(%view_1063) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1065, %e1_1066, %e2_1067, %e3_1068 = cute.get_leaves(%iter_1064) : !cute.int_tuple<"(0,0,0,0)">
      %lay_1069 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %732 = cute.get_shape(%lay_1069) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1070, %e1_1071, %e2_1072, %e3_1073 = cute.get_leaves(%732) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1074 = cute.to_int_tuple(%e0_1070) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %733 = cute.get_scalars(%itup_1074) : !cute.int_tuple<"?">
      %itup_1075 = cute.to_int_tuple(%e1_1071) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %734 = cute.get_scalars(%itup_1075) : !cute.int_tuple<"?">
      %itup_1076 = cute.to_int_tuple(%e2_1072) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %735 = cute.get_scalars(%itup_1076) : !cute.int_tuple<"?">
      %itup_1077 = cute.to_int_tuple(%e3_1073) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %736 = cute.get_scalars(%itup_1077) : !cute.int_tuple<"?{div=8}">
      %shape_1078 = cute.make_shape(%itup_1074, %itup_1075, %itup_1076, %itup_1077) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_1079 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_1080 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_1081 = cute.make_layout(%shape_1078, %stride_1080) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_1082 = cute.make_view(%int_tuple_1079, %lay_1081) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1083 = cute.get_iter(%view_1082) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1084, %e1_1085, %e2_1086, %e3_1087 = cute.get_leaves(%iter_1083) : !cute.int_tuple<"(0,0,0,0)">
      %coord_1088 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1089 = cute.get_layout(%view_1044) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %737:4 = cute.get_scalars(%lay_1089) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %738:2 = cute.get_scalars(%coord_1088) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_1090 = cute.assume(%737#3) : (i32) -> !cute.i32<divby 8>
      %shape_1091 = cute.make_shape(%737#1, %iv_1090) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_1092 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_1093 = cute.make_layout(%shape_1091, %stride_1092) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_1094 = cute.crd2idx(%coord_1088, %lay_1089) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_1095 = cute.get_iter(%view_1044) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_1095, %idx_1094) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_1096 = cute.make_view(%tup, %lay_1093) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_1097 = cute.get_iter(%view_1096) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1098, %e1_1099, %e2_1100, %e3_1101 = cute.get_leaves(%iter_1097) : !cute.int_tuple<"(?,0,?,0)">
      %739 = cute.get_scalars(%e0_1098) : !cute.int_tuple<"?">
      %740 = cute.get_scalars(%e2_1100) : !cute.int_tuple<"?">
      %iter_1102 = cute.get_iter(%view_1096) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1103, %e1_1104, %e2_1105, %e3_1106 = cute.get_leaves(%iter_1102) : !cute.int_tuple<"(?,0,?,0)">
      %741 = cute.get_scalars(%e0_1103) : !cute.int_tuple<"?">
      %742 = cute.get_scalars(%e2_1105) : !cute.int_tuple<"?">
      %tile_1107 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1108 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %743 = cute.get_scalars(%coord_1108) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1109 = cute.make_coord(%743) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1110 = cute.get_layout(%view_1096) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %744:2 = cute.get_scalars(%lay_1110) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_1111 = arith.constant 64 : i32
      %745 = arith.ceildivsi %744#0, %c64_i32_1111 : i32
      %c128_i32_1112 = arith.constant 128 : i32
      %746 = arith.ceildivsi %744#1, %c128_i32_1112 : i32
      %shape_1113 = cute.make_shape(%745, %746) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_1114 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_1115 = cute.make_layout(%shape_1113, %stride_1114) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_1116 = cute.crd2idx(%coord_1109, %lay_1115) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_1117 = cute.get_iter(%view_1096) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_1118 = cute.add_offset(%iter_1117, %idx_1116) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_1119 = cute.make_view(%tup_1118) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_1120 = cute.get_iter(%view_1119) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_1121, %e1_1122, %e2_1123, %e3_1124 = cute.get_leaves(%iter_1120) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %747 = cute.get_scalars(%e0_1121) : !cute.int_tuple<"?">
      %748 = cute.get_scalars(%e1_1122) : !cute.int_tuple<"?{div=64}">
      %749 = cute.get_scalars(%e2_1123) : !cute.int_tuple<"?">
      %coord_1125 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1126 = cute.get_layout(%view_1063) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %750:4 = cute.get_scalars(%lay_1126) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %751:2 = cute.get_scalars(%coord_1125) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_1127 = cute.assume(%750#3) : (i32) -> !cute.i32<divby 8>
      %shape_1128 = cute.make_shape(%750#1, %iv_1127) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_1129 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_1130 = cute.make_layout(%shape_1128, %stride_1129) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_1131 = cute.crd2idx(%coord_1125, %lay_1126) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_1132 = cute.get_iter(%view_1063) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_1133 = cute.add_offset(%iter_1132, %idx_1131) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_1134 = cute.make_view(%tup_1133, %lay_1130) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_1135 = cute.get_iter(%view_1134) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1136, %e1_1137, %e2_1138, %e3_1139 = cute.get_leaves(%iter_1135) : !cute.int_tuple<"(?,0,?,0)">
      %752 = cute.get_scalars(%e0_1136) : !cute.int_tuple<"?">
      %753 = cute.get_scalars(%e2_1138) : !cute.int_tuple<"?">
      %iter_1140 = cute.get_iter(%view_1134) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1141, %e1_1142, %e2_1143, %e3_1144 = cute.get_leaves(%iter_1140) : !cute.int_tuple<"(?,0,?,0)">
      %754 = cute.get_scalars(%e0_1141) : !cute.int_tuple<"?">
      %755 = cute.get_scalars(%e2_1143) : !cute.int_tuple<"?">
      %tile_1145 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1146 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %756 = cute.get_scalars(%coord_1146) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1147 = cute.make_coord(%756) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1148 = cute.get_layout(%view_1134) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %757:2 = cute.get_scalars(%lay_1148) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_1149 = arith.constant 64 : i32
      %758 = arith.ceildivsi %757#0, %c64_i32_1149 : i32
      %c128_i32_1150 = arith.constant 128 : i32
      %759 = arith.ceildivsi %757#1, %c128_i32_1150 : i32
      %shape_1151 = cute.make_shape(%758, %759) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_1152 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_1153 = cute.make_layout(%shape_1151, %stride_1152) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_1154 = cute.crd2idx(%coord_1147, %lay_1153) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_1155 = cute.get_iter(%view_1134) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_1156 = cute.add_offset(%iter_1155, %idx_1154) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_1157 = cute.make_view(%tup_1156) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_1158 = cute.get_iter(%view_1157) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_1159, %e1_1160, %e2_1161, %e3_1162 = cute.get_leaves(%iter_1158) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %760 = cute.get_scalars(%e0_1159) : !cute.int_tuple<"?">
      %761 = cute.get_scalars(%e1_1160) : !cute.int_tuple<"?{div=64}">
      %762 = cute.get_scalars(%e2_1161) : !cute.int_tuple<"?">
      %coord_1163 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_1164 = cute.get_layout(%view_1082) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %763:4 = cute.get_scalars(%lay_1164) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %764:2 = cute.get_scalars(%coord_1163) <{only_dynamic}> : !cute.coord<"(?,?,_,_)">
      %iv_1165 = cute.assume(%763#3) : (i32) -> !cute.i32<divby 8>
      %shape_1166 = cute.make_shape(%763#2, %iv_1165) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_1167 = cute.make_stride() : () -> !cute.stride<"(1@2,1@3)">
      %lay_1168 = cute.make_layout(%shape_1166, %stride_1167) : !cute.layout<"(?,?{div=8}):(1@2,1@3)">
      %idx_1169 = cute.crd2idx(%coord_1163, %lay_1164) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,?,0,0)">
      %iter_1170 = cute.get_iter(%view_1082) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_1171 = cute.add_offset(%iter_1170, %idx_1169) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,?,0,0)">) -> !cute.int_tuple<"(?,?,0,0)">
      %view_1172 = cute.make_view(%tup_1171, %lay_1168) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %iter_1173 = cute.get_iter(%view_1172) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %e0_1174, %e1_1175, %e2_1176, %e3_1177 = cute.get_leaves(%iter_1173) : !cute.int_tuple<"(?,?,0,0)">
      %765 = cute.get_scalars(%e0_1174) : !cute.int_tuple<"?">
      %766 = cute.get_scalars(%e1_1175) : !cute.int_tuple<"?">
      %iter_1178 = cute.get_iter(%view_1172) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %e0_1179, %e1_1180, %e2_1181, %e3_1182 = cute.get_leaves(%iter_1178) : !cute.int_tuple<"(?,?,0,0)">
      %767 = cute.get_scalars(%e0_1179) : !cute.int_tuple<"?">
      %768 = cute.get_scalars(%e1_1180) : !cute.int_tuple<"?">
      %tile_1183 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_1184 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %769 = cute.get_scalars(%coord_1184) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_1185 = cute.make_coord(%769) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_1186 = cute.get_layout(%view_1172) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %770:2 = cute.get_scalars(%lay_1186) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@2,1@3)">
      %c64_i32_1187 = arith.constant 64 : i32
      %771 = arith.ceildivsi %770#0, %c64_i32_1187 : i32
      %c64_i32_1188 = arith.constant 64 : i32
      %772 = arith.ceildivsi %770#1, %c64_i32_1188 : i32
      %shape_1189 = cute.make_shape(%771, %772) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %stride_1190 = cute.make_stride() : () -> !cute.stride<"((1@2,1@3),(64@2,64@3))">
      %lay_1191 = cute.make_layout(%shape_1189, %stride_1190) : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">
      %773:2 = cute.get_scalars(%lay_1191) <{only_dynamic}> : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">
      %774 = cute.get_scalars(%coord_1185) <{only_dynamic}> : !cute.coord<"((_,_),(?,_))">
      %shape_1192 = cute.make_shape(%773#1) : (i32) -> !cute.shape<"(64,64,?)">
      %stride_1193 = cute.make_stride() : () -> !cute.stride<"(1@2,1@3,64@3)">
      %lay_1194 = cute.make_layout(%shape_1192, %stride_1193) : !cute.layout<"(64,64,?):(1@2,1@3,64@3)">
      %idx_1195 = cute.crd2idx(%coord_1185, %lay_1191) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">) -> !cute.int_tuple<"(0,0,?{div=64},0)">
      %iter_1196 = cute.get_iter(%view_1172) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %tup_1197 = cute.add_offset(%iter_1196, %idx_1195) : (!cute.int_tuple<"(?,?,0,0)">, !cute.int_tuple<"(0,0,?{div=64},0)">) -> !cute.int_tuple<"(?,?,?{div=64},0)">
      %view_1198 = cute.make_view(%tup_1197, %lay_1194) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %iter_1199 = cute.get_iter(%view_1198) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %e0_1200, %e1_1201, %e2_1202, %e3_1203 = cute.get_leaves(%iter_1199) : !cute.int_tuple<"(?,?,?{div=64},0)">
      %775 = cute.get_scalars(%e0_1200) : !cute.int_tuple<"?">
      %776 = cute.get_scalars(%e1_1201) : !cute.int_tuple<"?">
      %777 = cute.get_scalars(%e2_1202) : !cute.int_tuple<"?{div=64}">
      %coord_1204 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_1205 = cute.get_iter(%view_1119) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %778 = cute.get_scalars(%coord_1204) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_1206 = arith.constant 8 : i32
      %779 = arith.divsi %778, %c8_i32_1206 : i32
      %c8_i32_1207 = arith.constant 8 : i32
      %780 = arith.remsi %778, %c8_i32_1207 : i32
      %c8_i32_1208 = arith.constant 8 : i32
      %781 = arith.muli %780, %c8_i32_1208 : i32
      %iv_1209 = cute.assume(%781) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1210 = cute.make_int_tuple(%779, %iv_1209) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_1211 = cute.add_offset(%iter_1205, %int_tuple_1210) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1212 = cute.make_view(%tup_1211) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1213 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1214, %e1_1215, %e2_1216, %e3_1217 = cute.get_leaves(%iter_1213) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %782 = cute.get_scalars(%e0_1214) : !cute.int_tuple<"?">
      %783 = cute.get_scalars(%e1_1215) : !cute.int_tuple<"?">
      %784 = cute.get_scalars(%e2_1216) : !cute.int_tuple<"?">
      %785 = cute.get_scalars(%e3_1217) : !cute.int_tuple<"?{div=8}">
      %coord_1218 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_1219 = cute.get_iter(%view_1157) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %786 = cute.get_scalars(%coord_1218) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_1220 = arith.constant 8 : i32
      %787 = arith.divsi %786, %c8_i32_1220 : i32
      %c8_i32_1221 = arith.constant 8 : i32
      %788 = arith.remsi %786, %c8_i32_1221 : i32
      %c8_i32_1222 = arith.constant 8 : i32
      %789 = arith.muli %788, %c8_i32_1222 : i32
      %iv_1223 = cute.assume(%789) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1224 = cute.make_int_tuple(%787, %iv_1223) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_1225 = cute.add_offset(%iter_1219, %int_tuple_1224) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1226 = cute.make_view(%tup_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1227 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1228, %e1_1229, %e2_1230, %e3_1231 = cute.get_leaves(%iter_1227) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %790 = cute.get_scalars(%e0_1228) : !cute.int_tuple<"?">
      %791 = cute.get_scalars(%e1_1229) : !cute.int_tuple<"?">
      %792 = cute.get_scalars(%e2_1230) : !cute.int_tuple<"?">
      %793 = cute.get_scalars(%e3_1231) : !cute.int_tuple<"?{div=8}">
      %coord_1232 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_1233 = cute.get_iter(%view_1198) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %lay_1234 = cute.get_layout(%view_1198) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %794 = cute.get_scalars(%lay_1234) <{only_dynamic}> : !cute.layout<"(64,64,?):(1@2,1@3,64@3)">
      %795 = cute.get_scalars(%coord_1232) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_1235 = arith.constant 8 : i32
      %796 = arith.divsi %795, %c8_i32_1235 : i32
      %c8_i32_1236 = arith.constant 8 : i32
      %797 = arith.remsi %795, %c8_i32_1236 : i32
      %c8_i32_1237 = arith.constant 8 : i32
      %798 = arith.muli %797, %c8_i32_1237 : i32
      %iv_1238 = cute.assume(%798) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1239 = cute.make_int_tuple(%796, %iv_1238) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,0,?,?{div=8})">
      %tup_1240 = cute.add_offset(%iter_1233, %int_tuple_1239) : (!cute.int_tuple<"(?,?,?{div=64},0)">, !cute.int_tuple<"(0,0,?,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %shape_1241 = cute.make_shape(%794) : (i32) -> !cute.shape<"((8,1),4,1,?)">
      %stride_1242 = cute.make_stride() : () -> !cute.stride<"((1@3,0),16@2,0,64@3)">
      %lay_1243 = cute.make_layout(%shape_1241, %stride_1242) : !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %view_1244 = cute.make_view(%tup_1240, %lay_1243) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %iter_1245 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %e0_1246, %e1_1247, %e2_1248, %e3_1249 = cute.get_leaves(%iter_1245) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %799 = cute.get_scalars(%e0_1246) : !cute.int_tuple<"?">
      %800 = cute.get_scalars(%e1_1247) : !cute.int_tuple<"?">
      %801 = cute.get_scalars(%e2_1248) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e3_1249) : !cute.int_tuple<"?{div=8}">
      %lay_1250 = cute.get_layout(%view_446) : !memref_smem_bf16_3
      %803 = cute.get_shape(%lay_1250) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1251, %e1_1252, %e2_1253, %e3_1254 = cute.get_leaves(%803) : !cute.shape<"((8,1),4,2)">
      %lay_1255 = cute.get_layout(%view_446) : !memref_smem_bf16_3
      %sz_1256 = cute.size(%lay_1255) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_1257 = cute.get_leaves(%sz_1256) : !cute.int_tuple<"4">
      %lay_1258 = cute.get_layout(%view_446) : !memref_smem_bf16_3
      %sz_1259 = cute.size(%lay_1258) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1260 = cute.get_leaves(%sz_1259) : !cute.int_tuple<"2">
      %lay_1261 = cute.get_layout(%view_446) : !memref_smem_bf16_3
      %sz_1262 = cute.size(%lay_1261) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1263 = cute.get_leaves(%sz_1262) : !cute.int_tuple<"2">
      %shape_1264 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1265 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1266 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1267 = cute.memref.alloca(%lay_1266) : !memref_rmem_i8_
      %iter_1268 = cute.get_iter(%rmem_1267) : !memref_rmem_i8_
      %iter_1269 = cute.get_iter(%rmem_1267) : !memref_rmem_i8_
      %lay_1270 = cute.get_layout(%view_510) : !memref_smem_bf16_3
      %804 = cute.get_shape(%lay_1270) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1271, %e1_1272, %e2_1273, %e3_1274 = cute.get_leaves(%804) : !cute.shape<"((8,1),4,2)">
      %lay_1275 = cute.get_layout(%view_510) : !memref_smem_bf16_3
      %sz_1276 = cute.size(%lay_1275) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_1277 = cute.get_leaves(%sz_1276) : !cute.int_tuple<"4">
      %lay_1278 = cute.get_layout(%view_510) : !memref_smem_bf16_3
      %sz_1279 = cute.size(%lay_1278) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1280 = cute.get_leaves(%sz_1279) : !cute.int_tuple<"2">
      %lay_1281 = cute.get_layout(%view_510) : !memref_smem_bf16_3
      %sz_1282 = cute.size(%lay_1281) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1283 = cute.get_leaves(%sz_1282) : !cute.int_tuple<"2">
      %shape_1284 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1285 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1286 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1287 = cute.memref.alloca(%lay_1286) : !memref_rmem_i8_
      %iter_1288 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
      %iter_1289 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
      %lay_1290 = cute.get_layout(%rmem_1267) : !memref_rmem_i8_
      %805 = cute.get_shape(%lay_1290) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1291, %e1_1292, %e2_1293 = cute.get_leaves(%805) : !cute.shape<"(1,4,2)">
      %coord_1294 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1295 = cute.get_layout(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1296 = cute.crd2idx(%coord_1294, %lay_1295) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1297 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1298 = cute.add_offset(%iter_1297, %idx_1296) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1299 = cute.make_view(%tup_1298) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1300 = cute.get_iter(%view_1299) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1301, %e1_1302, %e2_1303, %e3_1304 = cute.get_leaves(%iter_1300) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %806 = cute.get_scalars(%e0_1301) : !cute.int_tuple<"?">
      %807 = cute.get_scalars(%e1_1302) : !cute.int_tuple<"?">
      %808 = cute.get_scalars(%e2_1303) : !cute.int_tuple<"?">
      %809 = cute.get_scalars(%e3_1304) : !cute.int_tuple<"?{div=8}">
      %iter_1305 = cute.get_iter(%view_1299) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1306, %e1_1307, %e2_1308, %e3_1309 = cute.get_leaves(%iter_1305) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %810 = cute.get_scalars(%e0_1306) : !cute.int_tuple<"?">
      %811 = cute.get_scalars(%e1_1307) : !cute.int_tuple<"?">
      %812 = cute.get_scalars(%e2_1308) : !cute.int_tuple<"?">
      %813 = cute.get_scalars(%e3_1309) : !cute.int_tuple<"?{div=8}">
      %iter_1310 = cute.get_iter(%view_1299) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1311, %e1_1312, %e2_1313, %e3_1314 = cute.get_leaves(%iter_1310) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %814 = cute.get_scalars(%e0_1311) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e1_1312) : !cute.int_tuple<"?">
      %816 = cute.get_scalars(%e2_1313) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e3_1314) : !cute.int_tuple<"?{div=8}">
      %lay_1315 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %818 = cute.get_shape(%lay_1315) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1316, %e1_1317, %e2_1318, %e3_1319 = cute.get_leaves(%818) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1320 = cute.to_int_tuple(%e0_1316) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %819 = cute.get_scalars(%itup_1320) : !cute.int_tuple<"?">
      %itup_1321 = cute.to_int_tuple(%e1_1317) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %820 = cute.get_scalars(%itup_1321) : !cute.int_tuple<"?">
      %itup_1322 = cute.to_int_tuple(%e2_1318) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %821 = cute.get_scalars(%itup_1322) : !cute.int_tuple<"?">
      %itup_1323 = cute.to_int_tuple(%e3_1319) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %822 = cute.get_scalars(%itup_1323) : !cute.int_tuple<"?{div=8}">
      %coord_1324 = cute.make_coord(%e3_1314) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1325 = cute.make_coord(%itup_1323) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %823 = cute.get_scalars(%coord_1324) : !cute.coord<"?{div=8}">
      %824 = cute.get_scalars(%coord_1325) : !cute.coord<"?{div=8}">
      %true = arith.constant true
      %825 = arith.cmpi slt, %823, %824 : i32
      %826 = arith.andi %true, %825 : i1
      %827 = arith.extui %826 : i1 to i8
      %coord_1326 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1267, %coord_1326, %827) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1327 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1328 = cute.get_layout(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1329 = cute.crd2idx(%coord_1327, %lay_1328) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1330 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1331 = cute.add_offset(%iter_1330, %idx_1329) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1332 = cute.make_view(%tup_1331) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1333 = cute.get_iter(%view_1332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1334, %e1_1335, %e2_1336, %e3_1337 = cute.get_leaves(%iter_1333) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %828 = cute.get_scalars(%e0_1334) : !cute.int_tuple<"?">
      %829 = cute.get_scalars(%e1_1335) : !cute.int_tuple<"?">
      %830 = cute.get_scalars(%e2_1336) : !cute.int_tuple<"?">
      %831 = cute.get_scalars(%e3_1337) : !cute.int_tuple<"?{div=8}">
      %iter_1338 = cute.get_iter(%view_1332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1339, %e1_1340, %e2_1341, %e3_1342 = cute.get_leaves(%iter_1338) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %832 = cute.get_scalars(%e0_1339) : !cute.int_tuple<"?">
      %833 = cute.get_scalars(%e1_1340) : !cute.int_tuple<"?">
      %834 = cute.get_scalars(%e2_1341) : !cute.int_tuple<"?">
      %835 = cute.get_scalars(%e3_1342) : !cute.int_tuple<"?{div=8}">
      %iter_1343 = cute.get_iter(%view_1332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1344, %e1_1345, %e2_1346, %e3_1347 = cute.get_leaves(%iter_1343) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %836 = cute.get_scalars(%e0_1344) : !cute.int_tuple<"?">
      %837 = cute.get_scalars(%e1_1345) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e2_1346) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e3_1347) : !cute.int_tuple<"?{div=8}">
      %lay_1348 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %840 = cute.get_shape(%lay_1348) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1349, %e1_1350, %e2_1351, %e3_1352 = cute.get_leaves(%840) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1353 = cute.to_int_tuple(%e0_1349) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %841 = cute.get_scalars(%itup_1353) : !cute.int_tuple<"?">
      %itup_1354 = cute.to_int_tuple(%e1_1350) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %842 = cute.get_scalars(%itup_1354) : !cute.int_tuple<"?">
      %itup_1355 = cute.to_int_tuple(%e2_1351) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %843 = cute.get_scalars(%itup_1355) : !cute.int_tuple<"?">
      %itup_1356 = cute.to_int_tuple(%e3_1352) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %844 = cute.get_scalars(%itup_1356) : !cute.int_tuple<"?{div=8}">
      %coord_1357 = cute.make_coord(%e3_1347) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1358 = cute.make_coord(%itup_1356) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %845 = cute.get_scalars(%coord_1357) : !cute.coord<"?{div=8}">
      %846 = cute.get_scalars(%coord_1358) : !cute.coord<"?{div=8}">
      %true_1359 = arith.constant true
      %847 = arith.cmpi slt, %845, %846 : i32
      %848 = arith.andi %true_1359, %847 : i1
      %849 = arith.extui %848 : i1 to i8
      %coord_1360 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1267, %coord_1360, %849) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_1361 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
      %850 = cute.get_shape(%lay_1361) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1362, %e1_1363, %e2_1364 = cute.get_leaves(%850) : !cute.shape<"(1,4,2)">
      %coord_1365 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1366 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1367 = cute.crd2idx(%coord_1365, %lay_1366) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1368 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1369 = cute.add_offset(%iter_1368, %idx_1367) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1370 = cute.make_view(%tup_1369) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1371 = cute.get_iter(%view_1370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1372, %e1_1373, %e2_1374, %e3_1375 = cute.get_leaves(%iter_1371) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %851 = cute.get_scalars(%e0_1372) : !cute.int_tuple<"?">
      %852 = cute.get_scalars(%e1_1373) : !cute.int_tuple<"?">
      %853 = cute.get_scalars(%e2_1374) : !cute.int_tuple<"?">
      %854 = cute.get_scalars(%e3_1375) : !cute.int_tuple<"?{div=8}">
      %iter_1376 = cute.get_iter(%view_1370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1377, %e1_1378, %e2_1379, %e3_1380 = cute.get_leaves(%iter_1376) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %855 = cute.get_scalars(%e0_1377) : !cute.int_tuple<"?">
      %856 = cute.get_scalars(%e1_1378) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e2_1379) : !cute.int_tuple<"?">
      %858 = cute.get_scalars(%e3_1380) : !cute.int_tuple<"?{div=8}">
      %iter_1381 = cute.get_iter(%view_1370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1382, %e1_1383, %e2_1384, %e3_1385 = cute.get_leaves(%iter_1381) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %859 = cute.get_scalars(%e0_1382) : !cute.int_tuple<"?">
      %860 = cute.get_scalars(%e1_1383) : !cute.int_tuple<"?">
      %861 = cute.get_scalars(%e2_1384) : !cute.int_tuple<"?">
      %862 = cute.get_scalars(%e3_1385) : !cute.int_tuple<"?{div=8}">
      %lay_1386 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %863 = cute.get_shape(%lay_1386) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1387, %e1_1388, %e2_1389, %e3_1390 = cute.get_leaves(%863) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1391 = cute.to_int_tuple(%e0_1387) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %864 = cute.get_scalars(%itup_1391) : !cute.int_tuple<"?">
      %itup_1392 = cute.to_int_tuple(%e1_1388) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %865 = cute.get_scalars(%itup_1392) : !cute.int_tuple<"?">
      %itup_1393 = cute.to_int_tuple(%e2_1389) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %866 = cute.get_scalars(%itup_1393) : !cute.int_tuple<"?">
      %itup_1394 = cute.to_int_tuple(%e3_1390) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %867 = cute.get_scalars(%itup_1394) : !cute.int_tuple<"?{div=8}">
      %coord_1395 = cute.make_coord(%e3_1385) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1396 = cute.make_coord(%itup_1394) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %868 = cute.get_scalars(%coord_1395) : !cute.coord<"?{div=8}">
      %869 = cute.get_scalars(%coord_1396) : !cute.coord<"?{div=8}">
      %true_1397 = arith.constant true
      %870 = arith.cmpi slt, %868, %869 : i32
      %871 = arith.andi %true_1397, %870 : i1
      %872 = arith.extui %871 : i1 to i8
      %coord_1398 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1287, %coord_1398, %872) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1399 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1400 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1401 = cute.crd2idx(%coord_1399, %lay_1400) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1402 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1403 = cute.add_offset(%iter_1402, %idx_1401) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1404 = cute.make_view(%tup_1403) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1405 = cute.get_iter(%view_1404) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1406, %e1_1407, %e2_1408, %e3_1409 = cute.get_leaves(%iter_1405) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %873 = cute.get_scalars(%e0_1406) : !cute.int_tuple<"?">
      %874 = cute.get_scalars(%e1_1407) : !cute.int_tuple<"?">
      %875 = cute.get_scalars(%e2_1408) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e3_1409) : !cute.int_tuple<"?{div=8}">
      %iter_1410 = cute.get_iter(%view_1404) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1411, %e1_1412, %e2_1413, %e3_1414 = cute.get_leaves(%iter_1410) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %877 = cute.get_scalars(%e0_1411) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e1_1412) : !cute.int_tuple<"?">
      %879 = cute.get_scalars(%e2_1413) : !cute.int_tuple<"?">
      %880 = cute.get_scalars(%e3_1414) : !cute.int_tuple<"?{div=8}">
      %iter_1415 = cute.get_iter(%view_1404) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1416, %e1_1417, %e2_1418, %e3_1419 = cute.get_leaves(%iter_1415) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %881 = cute.get_scalars(%e0_1416) : !cute.int_tuple<"?">
      %882 = cute.get_scalars(%e1_1417) : !cute.int_tuple<"?">
      %883 = cute.get_scalars(%e2_1418) : !cute.int_tuple<"?">
      %884 = cute.get_scalars(%e3_1419) : !cute.int_tuple<"?{div=8}">
      %lay_1420 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %885 = cute.get_shape(%lay_1420) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1421, %e1_1422, %e2_1423, %e3_1424 = cute.get_leaves(%885) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1425 = cute.to_int_tuple(%e0_1421) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %886 = cute.get_scalars(%itup_1425) : !cute.int_tuple<"?">
      %itup_1426 = cute.to_int_tuple(%e1_1422) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %887 = cute.get_scalars(%itup_1426) : !cute.int_tuple<"?">
      %itup_1427 = cute.to_int_tuple(%e2_1423) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %888 = cute.get_scalars(%itup_1427) : !cute.int_tuple<"?">
      %itup_1428 = cute.to_int_tuple(%e3_1424) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %889 = cute.get_scalars(%itup_1428) : !cute.int_tuple<"?{div=8}">
      %coord_1429 = cute.make_coord(%e3_1419) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1430 = cute.make_coord(%itup_1428) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %890 = cute.get_scalars(%coord_1429) : !cute.coord<"?{div=8}">
      %891 = cute.get_scalars(%coord_1430) : !cute.coord<"?{div=8}">
      %true_1431 = arith.constant true
      %892 = arith.cmpi slt, %890, %891 : i32
      %893 = arith.andi %true_1431, %892 : i1
      %894 = arith.extui %893 : i1 to i8
      %coord_1432 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1287, %coord_1432, %894) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_1433 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1434 = cute.size(%int_tuple_1433) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1435 = cute.get_leaves(%sz_1434) : !cute.int_tuple<"4">
      %coord_1436 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1437 = cute.get_layout(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1438 = cute.crd2idx(%coord_1436, %lay_1437) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1439 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1440 = cute.add_offset(%iter_1439, %idx_1438) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1441 = cute.make_view(%tup_1440) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1442 = cute.get_iter(%view_1441) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1443, %e1_1444, %e2_1445, %e3_1446 = cute.get_leaves(%iter_1442) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %895 = cute.get_scalars(%e0_1443) : !cute.int_tuple<"?">
      %896 = cute.get_scalars(%e1_1444) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e2_1445) : !cute.int_tuple<"?">
      %898 = cute.get_scalars(%e3_1446) : !cute.int_tuple<"?{div=8}">
      %iter_1447 = cute.get_iter(%view_1441) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1448, %e1_1449, %e2_1450, %e3_1451 = cute.get_leaves(%iter_1447) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %899 = cute.get_scalars(%e0_1448) : !cute.int_tuple<"?">
      %900 = cute.get_scalars(%e1_1449) : !cute.int_tuple<"?">
      %901 = cute.get_scalars(%e2_1450) : !cute.int_tuple<"?">
      %902 = cute.get_scalars(%e3_1451) : !cute.int_tuple<"?{div=8}">
      %iter_1452 = cute.get_iter(%view_1441) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1453, %e1_1454, %e2_1455, %e3_1456 = cute.get_leaves(%iter_1452) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %903 = cute.get_scalars(%e0_1453) : !cute.int_tuple<"?">
      %904 = cute.get_scalars(%e1_1454) : !cute.int_tuple<"?">
      %905 = cute.get_scalars(%e2_1455) : !cute.int_tuple<"?">
      %906 = cute.get_scalars(%e3_1456) : !cute.int_tuple<"?{div=8}">
      %lay_1457 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %907 = cute.get_shape(%lay_1457) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1458, %e1_1459, %e2_1460, %e3_1461 = cute.get_leaves(%907) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1462 = cute.to_int_tuple(%e0_1458) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %908 = cute.get_scalars(%itup_1462) : !cute.int_tuple<"?">
      %itup_1463 = cute.to_int_tuple(%e1_1459) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %909 = cute.get_scalars(%itup_1463) : !cute.int_tuple<"?">
      %itup_1464 = cute.to_int_tuple(%e2_1460) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %910 = cute.get_scalars(%itup_1464) : !cute.int_tuple<"?">
      %itup_1465 = cute.to_int_tuple(%e3_1461) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %911 = cute.get_scalars(%itup_1465) : !cute.int_tuple<"?{div=8}">
      %coord_1466 = cute.make_coord(%e1_1454) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1467 = cute.make_coord(%itup_1463) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %912 = cute.get_scalars(%coord_1466) : !cute.coord<"?">
      %913 = cute.get_scalars(%coord_1467) : !cute.coord<"?">
      %true_1468 = arith.constant true
      %914 = arith.cmpi slt, %912, %913 : i32
      %915 = arith.andi %true_1468, %914 : i1
      scf.if %915 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2760 = cute.get_layout(%view_410) : !memref_gmem_bf16_5
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2762 = cute.get_iter(%view_410) : !memref_gmem_bf16_5
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2768 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2770 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2776 = cute.get_layout(%rmem_1267) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1267) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2760 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2762 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %coord_1469 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1470 = cute.get_layout(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1471 = cute.crd2idx(%coord_1469, %lay_1470) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1472 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1473 = cute.add_offset(%iter_1472, %idx_1471) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1474 = cute.make_view(%tup_1473) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1475 = cute.get_iter(%view_1474) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1476, %e1_1477, %e2_1478, %e3_1479 = cute.get_leaves(%iter_1475) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %916 = cute.get_scalars(%e0_1476) : !cute.int_tuple<"?">
      %917 = cute.get_scalars(%e1_1477) : !cute.int_tuple<"?">
      %918 = cute.get_scalars(%e2_1478) : !cute.int_tuple<"?">
      %919 = cute.get_scalars(%e3_1479) : !cute.int_tuple<"?{div=8}">
      %iter_1480 = cute.get_iter(%view_1474) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1481, %e1_1482, %e2_1483, %e3_1484 = cute.get_leaves(%iter_1480) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %920 = cute.get_scalars(%e0_1481) : !cute.int_tuple<"?">
      %921 = cute.get_scalars(%e1_1482) : !cute.int_tuple<"?">
      %922 = cute.get_scalars(%e2_1483) : !cute.int_tuple<"?">
      %923 = cute.get_scalars(%e3_1484) : !cute.int_tuple<"?{div=8}">
      %iter_1485 = cute.get_iter(%view_1474) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1486, %e1_1487, %e2_1488, %e3_1489 = cute.get_leaves(%iter_1485) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %924 = cute.get_scalars(%e0_1486) : !cute.int_tuple<"?">
      %925 = cute.get_scalars(%e1_1487) : !cute.int_tuple<"?">
      %926 = cute.get_scalars(%e2_1488) : !cute.int_tuple<"?">
      %927 = cute.get_scalars(%e3_1489) : !cute.int_tuple<"?{div=8}">
      %lay_1490 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %928 = cute.get_shape(%lay_1490) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1491, %e1_1492, %e2_1493, %e3_1494 = cute.get_leaves(%928) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1495 = cute.to_int_tuple(%e0_1491) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %929 = cute.get_scalars(%itup_1495) : !cute.int_tuple<"?">
      %itup_1496 = cute.to_int_tuple(%e1_1492) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %930 = cute.get_scalars(%itup_1496) : !cute.int_tuple<"?">
      %itup_1497 = cute.to_int_tuple(%e2_1493) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %931 = cute.get_scalars(%itup_1497) : !cute.int_tuple<"?">
      %itup_1498 = cute.to_int_tuple(%e3_1494) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %932 = cute.get_scalars(%itup_1498) : !cute.int_tuple<"?{div=8}">
      %coord_1499 = cute.make_coord(%e1_1487) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1500 = cute.make_coord(%itup_1496) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %933 = cute.get_scalars(%coord_1499) : !cute.coord<"?">
      %934 = cute.get_scalars(%coord_1500) : !cute.coord<"?">
      %true_1501 = arith.constant true
      %935 = arith.cmpi slt, %933, %934 : i32
      %936 = arith.andi %true_1501, %935 : i1
      scf.if %936 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2760 = cute.get_layout(%view_410) : !memref_gmem_bf16_5
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2762 = cute.get_iter(%view_410) : !memref_gmem_bf16_5
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2768 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2770 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2776 = cute.get_layout(%rmem_1267) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1267) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2760 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2762 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %coord_1502 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1503 = cute.get_layout(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1504 = cute.crd2idx(%coord_1502, %lay_1503) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1505 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1506 = cute.add_offset(%iter_1505, %idx_1504) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1507 = cute.make_view(%tup_1506) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1508 = cute.get_iter(%view_1507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1509, %e1_1510, %e2_1511, %e3_1512 = cute.get_leaves(%iter_1508) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %937 = cute.get_scalars(%e0_1509) : !cute.int_tuple<"?">
      %938 = cute.get_scalars(%e1_1510) : !cute.int_tuple<"?">
      %939 = cute.get_scalars(%e2_1511) : !cute.int_tuple<"?">
      %940 = cute.get_scalars(%e3_1512) : !cute.int_tuple<"?{div=8}">
      %iter_1513 = cute.get_iter(%view_1507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1514, %e1_1515, %e2_1516, %e3_1517 = cute.get_leaves(%iter_1513) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %941 = cute.get_scalars(%e0_1514) : !cute.int_tuple<"?">
      %942 = cute.get_scalars(%e1_1515) : !cute.int_tuple<"?">
      %943 = cute.get_scalars(%e2_1516) : !cute.int_tuple<"?">
      %944 = cute.get_scalars(%e3_1517) : !cute.int_tuple<"?{div=8}">
      %iter_1518 = cute.get_iter(%view_1507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1519, %e1_1520, %e2_1521, %e3_1522 = cute.get_leaves(%iter_1518) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %945 = cute.get_scalars(%e0_1519) : !cute.int_tuple<"?">
      %946 = cute.get_scalars(%e1_1520) : !cute.int_tuple<"?">
      %947 = cute.get_scalars(%e2_1521) : !cute.int_tuple<"?">
      %948 = cute.get_scalars(%e3_1522) : !cute.int_tuple<"?{div=8}">
      %lay_1523 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %949 = cute.get_shape(%lay_1523) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1524, %e1_1525, %e2_1526, %e3_1527 = cute.get_leaves(%949) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1528 = cute.to_int_tuple(%e0_1524) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %950 = cute.get_scalars(%itup_1528) : !cute.int_tuple<"?">
      %itup_1529 = cute.to_int_tuple(%e1_1525) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %951 = cute.get_scalars(%itup_1529) : !cute.int_tuple<"?">
      %itup_1530 = cute.to_int_tuple(%e2_1526) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %952 = cute.get_scalars(%itup_1530) : !cute.int_tuple<"?">
      %itup_1531 = cute.to_int_tuple(%e3_1527) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %953 = cute.get_scalars(%itup_1531) : !cute.int_tuple<"?{div=8}">
      %coord_1532 = cute.make_coord(%e1_1520) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1533 = cute.make_coord(%itup_1529) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %954 = cute.get_scalars(%coord_1532) : !cute.coord<"?">
      %955 = cute.get_scalars(%coord_1533) : !cute.coord<"?">
      %true_1534 = arith.constant true
      %956 = arith.cmpi slt, %954, %955 : i32
      %957 = arith.andi %true_1534, %956 : i1
      scf.if %957 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2760 = cute.get_layout(%view_410) : !memref_gmem_bf16_5
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2762 = cute.get_iter(%view_410) : !memref_gmem_bf16_5
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2768 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2770 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2776 = cute.get_layout(%rmem_1267) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1267) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2760 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2762 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %coord_1535 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1536 = cute.get_layout(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1537 = cute.crd2idx(%coord_1535, %lay_1536) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1538 = cute.get_iter(%view_1212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1539 = cute.add_offset(%iter_1538, %idx_1537) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1540 = cute.make_view(%tup_1539) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1541 = cute.get_iter(%view_1540) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1542, %e1_1543, %e2_1544, %e3_1545 = cute.get_leaves(%iter_1541) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %958 = cute.get_scalars(%e0_1542) : !cute.int_tuple<"?">
      %959 = cute.get_scalars(%e1_1543) : !cute.int_tuple<"?">
      %960 = cute.get_scalars(%e2_1544) : !cute.int_tuple<"?">
      %961 = cute.get_scalars(%e3_1545) : !cute.int_tuple<"?{div=8}">
      %iter_1546 = cute.get_iter(%view_1540) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1547, %e1_1548, %e2_1549, %e3_1550 = cute.get_leaves(%iter_1546) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %962 = cute.get_scalars(%e0_1547) : !cute.int_tuple<"?">
      %963 = cute.get_scalars(%e1_1548) : !cute.int_tuple<"?">
      %964 = cute.get_scalars(%e2_1549) : !cute.int_tuple<"?">
      %965 = cute.get_scalars(%e3_1550) : !cute.int_tuple<"?{div=8}">
      %iter_1551 = cute.get_iter(%view_1540) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1552, %e1_1553, %e2_1554, %e3_1555 = cute.get_leaves(%iter_1551) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %966 = cute.get_scalars(%e0_1552) : !cute.int_tuple<"?">
      %967 = cute.get_scalars(%e1_1553) : !cute.int_tuple<"?">
      %968 = cute.get_scalars(%e2_1554) : !cute.int_tuple<"?">
      %969 = cute.get_scalars(%e3_1555) : !cute.int_tuple<"?{div=8}">
      %lay_1556 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %970 = cute.get_shape(%lay_1556) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1557, %e1_1558, %e2_1559, %e3_1560 = cute.get_leaves(%970) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1561 = cute.to_int_tuple(%e0_1557) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %971 = cute.get_scalars(%itup_1561) : !cute.int_tuple<"?">
      %itup_1562 = cute.to_int_tuple(%e1_1558) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %972 = cute.get_scalars(%itup_1562) : !cute.int_tuple<"?">
      %itup_1563 = cute.to_int_tuple(%e2_1559) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %973 = cute.get_scalars(%itup_1563) : !cute.int_tuple<"?">
      %itup_1564 = cute.to_int_tuple(%e3_1560) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %974 = cute.get_scalars(%itup_1564) : !cute.int_tuple<"?{div=8}">
      %coord_1565 = cute.make_coord(%e1_1553) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1566 = cute.make_coord(%itup_1562) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %975 = cute.get_scalars(%coord_1565) : !cute.coord<"?">
      %976 = cute.get_scalars(%coord_1566) : !cute.coord<"?">
      %true_1567 = arith.constant true
      %977 = arith.cmpi slt, %975, %976 : i32
      %978 = arith.andi %true_1567, %977 : i1
      scf.if %978 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2760 = cute.get_layout(%view_410) : !memref_gmem_bf16_5
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2762 = cute.get_iter(%view_410) : !memref_gmem_bf16_5
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2768 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2770 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2776 = cute.get_layout(%rmem_1267) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1267) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2760 = cute.get_layout(%view_446) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2762 = cute.get_iter(%view_446) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %int_tuple_1568 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1569 = cute.size(%int_tuple_1568) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1570 = cute.get_leaves(%sz_1569) : !cute.int_tuple<"4">
      %coord_1571 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1572 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1573 = cute.crd2idx(%coord_1571, %lay_1572) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1574 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1575 = cute.add_offset(%iter_1574, %idx_1573) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1576 = cute.make_view(%tup_1575) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1577 = cute.get_iter(%view_1576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1578, %e1_1579, %e2_1580, %e3_1581 = cute.get_leaves(%iter_1577) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %979 = cute.get_scalars(%e0_1578) : !cute.int_tuple<"?">
      %980 = cute.get_scalars(%e1_1579) : !cute.int_tuple<"?">
      %981 = cute.get_scalars(%e2_1580) : !cute.int_tuple<"?">
      %982 = cute.get_scalars(%e3_1581) : !cute.int_tuple<"?{div=8}">
      %iter_1582 = cute.get_iter(%view_1576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1583, %e1_1584, %e2_1585, %e3_1586 = cute.get_leaves(%iter_1582) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %983 = cute.get_scalars(%e0_1583) : !cute.int_tuple<"?">
      %984 = cute.get_scalars(%e1_1584) : !cute.int_tuple<"?">
      %985 = cute.get_scalars(%e2_1585) : !cute.int_tuple<"?">
      %986 = cute.get_scalars(%e3_1586) : !cute.int_tuple<"?{div=8}">
      %iter_1587 = cute.get_iter(%view_1576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1588, %e1_1589, %e2_1590, %e3_1591 = cute.get_leaves(%iter_1587) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %987 = cute.get_scalars(%e0_1588) : !cute.int_tuple<"?">
      %988 = cute.get_scalars(%e1_1589) : !cute.int_tuple<"?">
      %989 = cute.get_scalars(%e2_1590) : !cute.int_tuple<"?">
      %990 = cute.get_scalars(%e3_1591) : !cute.int_tuple<"?{div=8}">
      %lay_1592 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %991 = cute.get_shape(%lay_1592) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1593, %e1_1594, %e2_1595, %e3_1596 = cute.get_leaves(%991) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1597 = cute.to_int_tuple(%e0_1593) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %992 = cute.get_scalars(%itup_1597) : !cute.int_tuple<"?">
      %itup_1598 = cute.to_int_tuple(%e1_1594) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %993 = cute.get_scalars(%itup_1598) : !cute.int_tuple<"?">
      %itup_1599 = cute.to_int_tuple(%e2_1595) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %994 = cute.get_scalars(%itup_1599) : !cute.int_tuple<"?">
      %itup_1600 = cute.to_int_tuple(%e3_1596) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %995 = cute.get_scalars(%itup_1600) : !cute.int_tuple<"?{div=8}">
      %coord_1601 = cute.make_coord(%e1_1589) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1602 = cute.make_coord(%itup_1598) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %996 = cute.get_scalars(%coord_1601) : !cute.coord<"?">
      %997 = cute.get_scalars(%coord_1602) : !cute.coord<"?">
      %true_1603 = arith.constant true
      %998 = arith.cmpi slt, %996, %997 : i32
      %999 = arith.andi %true_1603, %998 : i1
      scf.if %999 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
        %lay_2760 = cute.get_layout(%view_465) : !memref_gmem_bf16_6
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_2762 = cute.get_iter(%view_465) : !memref_gmem_bf16_6
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2768 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2770 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2776 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2760 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2762 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %coord_1604 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1605 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1606 = cute.crd2idx(%coord_1604, %lay_1605) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1607 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1608 = cute.add_offset(%iter_1607, %idx_1606) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1609 = cute.make_view(%tup_1608) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1610 = cute.get_iter(%view_1609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1611, %e1_1612, %e2_1613, %e3_1614 = cute.get_leaves(%iter_1610) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1000 = cute.get_scalars(%e0_1611) : !cute.int_tuple<"?">
      %1001 = cute.get_scalars(%e1_1612) : !cute.int_tuple<"?">
      %1002 = cute.get_scalars(%e2_1613) : !cute.int_tuple<"?">
      %1003 = cute.get_scalars(%e3_1614) : !cute.int_tuple<"?{div=8}">
      %iter_1615 = cute.get_iter(%view_1609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1616, %e1_1617, %e2_1618, %e3_1619 = cute.get_leaves(%iter_1615) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1004 = cute.get_scalars(%e0_1616) : !cute.int_tuple<"?">
      %1005 = cute.get_scalars(%e1_1617) : !cute.int_tuple<"?">
      %1006 = cute.get_scalars(%e2_1618) : !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%e3_1619) : !cute.int_tuple<"?{div=8}">
      %iter_1620 = cute.get_iter(%view_1609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1621, %e1_1622, %e2_1623, %e3_1624 = cute.get_leaves(%iter_1620) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1008 = cute.get_scalars(%e0_1621) : !cute.int_tuple<"?">
      %1009 = cute.get_scalars(%e1_1622) : !cute.int_tuple<"?">
      %1010 = cute.get_scalars(%e2_1623) : !cute.int_tuple<"?">
      %1011 = cute.get_scalars(%e3_1624) : !cute.int_tuple<"?{div=8}">
      %lay_1625 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1012 = cute.get_shape(%lay_1625) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1626, %e1_1627, %e2_1628, %e3_1629 = cute.get_leaves(%1012) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1630 = cute.to_int_tuple(%e0_1626) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1013 = cute.get_scalars(%itup_1630) : !cute.int_tuple<"?">
      %itup_1631 = cute.to_int_tuple(%e1_1627) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1014 = cute.get_scalars(%itup_1631) : !cute.int_tuple<"?">
      %itup_1632 = cute.to_int_tuple(%e2_1628) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1015 = cute.get_scalars(%itup_1632) : !cute.int_tuple<"?">
      %itup_1633 = cute.to_int_tuple(%e3_1629) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1016 = cute.get_scalars(%itup_1633) : !cute.int_tuple<"?{div=8}">
      %coord_1634 = cute.make_coord(%e1_1622) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1635 = cute.make_coord(%itup_1631) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1017 = cute.get_scalars(%coord_1634) : !cute.coord<"?">
      %1018 = cute.get_scalars(%coord_1635) : !cute.coord<"?">
      %true_1636 = arith.constant true
      %1019 = arith.cmpi slt, %1017, %1018 : i32
      %1020 = arith.andi %true_1636, %1019 : i1
      scf.if %1020 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
        %lay_2760 = cute.get_layout(%view_465) : !memref_gmem_bf16_6
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2762 = cute.get_iter(%view_465) : !memref_gmem_bf16_6
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2768 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2770 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2776 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2760 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2762 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %coord_1637 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1638 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1639 = cute.crd2idx(%coord_1637, %lay_1638) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1640 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1641 = cute.add_offset(%iter_1640, %idx_1639) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1642 = cute.make_view(%tup_1641) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1643 = cute.get_iter(%view_1642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1644, %e1_1645, %e2_1646, %e3_1647 = cute.get_leaves(%iter_1643) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1021 = cute.get_scalars(%e0_1644) : !cute.int_tuple<"?">
      %1022 = cute.get_scalars(%e1_1645) : !cute.int_tuple<"?">
      %1023 = cute.get_scalars(%e2_1646) : !cute.int_tuple<"?">
      %1024 = cute.get_scalars(%e3_1647) : !cute.int_tuple<"?{div=8}">
      %iter_1648 = cute.get_iter(%view_1642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1649, %e1_1650, %e2_1651, %e3_1652 = cute.get_leaves(%iter_1648) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1025 = cute.get_scalars(%e0_1649) : !cute.int_tuple<"?">
      %1026 = cute.get_scalars(%e1_1650) : !cute.int_tuple<"?">
      %1027 = cute.get_scalars(%e2_1651) : !cute.int_tuple<"?">
      %1028 = cute.get_scalars(%e3_1652) : !cute.int_tuple<"?{div=8}">
      %iter_1653 = cute.get_iter(%view_1642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1654, %e1_1655, %e2_1656, %e3_1657 = cute.get_leaves(%iter_1653) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1029 = cute.get_scalars(%e0_1654) : !cute.int_tuple<"?">
      %1030 = cute.get_scalars(%e1_1655) : !cute.int_tuple<"?">
      %1031 = cute.get_scalars(%e2_1656) : !cute.int_tuple<"?">
      %1032 = cute.get_scalars(%e3_1657) : !cute.int_tuple<"?{div=8}">
      %lay_1658 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1033 = cute.get_shape(%lay_1658) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1659, %e1_1660, %e2_1661, %e3_1662 = cute.get_leaves(%1033) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1663 = cute.to_int_tuple(%e0_1659) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1034 = cute.get_scalars(%itup_1663) : !cute.int_tuple<"?">
      %itup_1664 = cute.to_int_tuple(%e1_1660) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1035 = cute.get_scalars(%itup_1664) : !cute.int_tuple<"?">
      %itup_1665 = cute.to_int_tuple(%e2_1661) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1036 = cute.get_scalars(%itup_1665) : !cute.int_tuple<"?">
      %itup_1666 = cute.to_int_tuple(%e3_1662) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1037 = cute.get_scalars(%itup_1666) : !cute.int_tuple<"?{div=8}">
      %coord_1667 = cute.make_coord(%e1_1655) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1668 = cute.make_coord(%itup_1664) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1038 = cute.get_scalars(%coord_1667) : !cute.coord<"?">
      %1039 = cute.get_scalars(%coord_1668) : !cute.coord<"?">
      %true_1669 = arith.constant true
      %1040 = arith.cmpi slt, %1038, %1039 : i32
      %1041 = arith.andi %true_1669, %1040 : i1
      scf.if %1041 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
        %lay_2760 = cute.get_layout(%view_465) : !memref_gmem_bf16_6
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2762 = cute.get_iter(%view_465) : !memref_gmem_bf16_6
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2768 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2770 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2776 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2760 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2762 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %coord_1670 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1671 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1672 = cute.crd2idx(%coord_1670, %lay_1671) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1673 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1674 = cute.add_offset(%iter_1673, %idx_1672) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1675 = cute.make_view(%tup_1674) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1676 = cute.get_iter(%view_1675) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1677, %e1_1678, %e2_1679, %e3_1680 = cute.get_leaves(%iter_1676) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1042 = cute.get_scalars(%e0_1677) : !cute.int_tuple<"?">
      %1043 = cute.get_scalars(%e1_1678) : !cute.int_tuple<"?">
      %1044 = cute.get_scalars(%e2_1679) : !cute.int_tuple<"?">
      %1045 = cute.get_scalars(%e3_1680) : !cute.int_tuple<"?{div=8}">
      %iter_1681 = cute.get_iter(%view_1675) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1682, %e1_1683, %e2_1684, %e3_1685 = cute.get_leaves(%iter_1681) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1046 = cute.get_scalars(%e0_1682) : !cute.int_tuple<"?">
      %1047 = cute.get_scalars(%e1_1683) : !cute.int_tuple<"?">
      %1048 = cute.get_scalars(%e2_1684) : !cute.int_tuple<"?">
      %1049 = cute.get_scalars(%e3_1685) : !cute.int_tuple<"?{div=8}">
      %iter_1686 = cute.get_iter(%view_1675) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1687, %e1_1688, %e2_1689, %e3_1690 = cute.get_leaves(%iter_1686) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1050 = cute.get_scalars(%e0_1687) : !cute.int_tuple<"?">
      %1051 = cute.get_scalars(%e1_1688) : !cute.int_tuple<"?">
      %1052 = cute.get_scalars(%e2_1689) : !cute.int_tuple<"?">
      %1053 = cute.get_scalars(%e3_1690) : !cute.int_tuple<"?{div=8}">
      %lay_1691 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1054 = cute.get_shape(%lay_1691) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1692, %e1_1693, %e2_1694, %e3_1695 = cute.get_leaves(%1054) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1696 = cute.to_int_tuple(%e0_1692) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1055 = cute.get_scalars(%itup_1696) : !cute.int_tuple<"?">
      %itup_1697 = cute.to_int_tuple(%e1_1693) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1056 = cute.get_scalars(%itup_1697) : !cute.int_tuple<"?">
      %itup_1698 = cute.to_int_tuple(%e2_1694) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1057 = cute.get_scalars(%itup_1698) : !cute.int_tuple<"?">
      %itup_1699 = cute.to_int_tuple(%e3_1695) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1058 = cute.get_scalars(%itup_1699) : !cute.int_tuple<"?{div=8}">
      %coord_1700 = cute.make_coord(%e1_1688) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1701 = cute.make_coord(%itup_1697) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1059 = cute.get_scalars(%coord_1700) : !cute.coord<"?">
      %1060 = cute.get_scalars(%coord_1701) : !cute.coord<"?">
      %true_1702 = arith.constant true
      %1061 = arith.cmpi slt, %1059, %1060 : i32
      %1062 = arith.andi %true_1702, %1061 : i1
      scf.if %1062 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
        %lay_2760 = cute.get_layout(%view_465) : !memref_gmem_bf16_6
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2762 = cute.get_iter(%view_465) : !memref_gmem_bf16_6
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_8
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_8
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2768 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2770 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_12
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_12
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2776 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_gmem_bf16_8
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_gmem_bf16_8
        %iter_2796 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %lay_2797 = cute.get_layout(%view_2795) : !memref_gmem_bf16_8
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_gmem_bf16_8
        %view_2802 = cute.make_view(%iter_2801) : !memref_gmem_bf16_9
        %iter_2803 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2804 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %lay_2805 = cute.get_layout(%view_2772) : !memref_smem_bf16_12
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_smem_bf16_12
        %iter_2810 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %lay_2811 = cute.get_layout(%view_2809) : !memref_smem_bf16_12
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_smem_bf16_12
        %view_2816 = cute.make_view(%iter_2815) : !memref_smem_bf16_13
        %iter_2817 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %iter_2818 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_gmem_bf16_9
        %iter_2847 = cute.get_iter(%view_2816) : !memref_smem_bf16_13
        %lay_2848 = cute.get_layout(%view_2802) : !memref_gmem_bf16_9
        %lay_2849 = cute.get_layout(%view_2816) : !memref_smem_bf16_13
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_gmem_bf16_10
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_smem_bf16_14
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_gmem_bf16_10
          %iter_2875 = cute.get_iter(%view_2869) : !memref_smem_bf16_14
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.trunc %1616 : i8 to i1
          %iter_2877 = cute.recast_iter(%iter_2874) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2878 = cute.recast_iter(%iter_2875) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2878 : !cute.ptr<i128, smem>, %iter_2877 : !cute.ptr<i128, gmem>, %1617 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2760 = cute.get_layout(%view_510) : !memref_smem_bf16_3
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2762 = cute.get_iter(%view_510) : !memref_smem_bf16_3
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_12
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_12
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"16">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_12
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2771, %e1_2772, %e2_2773 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2776 = cute.get_leaves(%int_tuple_2775) : !cute.int_tuple<"16">
        %cst_2777 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2777 : vector<16xbf16>
        %int_tuple_2778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2779 = cute.size(%int_tuple_2778) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2780 = cute.get_leaves(%sz_2779) : !cute.int_tuple<"16">
        %int_tuple_2781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2782 = cute.size(%int_tuple_2781) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2783 = cute.get_leaves(%sz_2782) : !cute.int_tuple<"16">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_12
      }
      %lay_1703 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %1063 = cute.get_shape(%lay_1703) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
      %e0_1704, %e1_1705, %e2_1706, %e3_1707, %e4_1708 = cute.get_leaves(%1063) : !cute.shape<"((8,1),4,1,?)">
      %itup_1709 = cute.to_int_tuple(%e4_1708) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1064 = cute.get_scalars(%itup_1709) : !cute.int_tuple<"?">
      %int_tuple_1710 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1711 = cute.size(%int_tuple_1710) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1712 = cute.get_leaves(%sz_1711) : !cute.int_tuple<"4">
      %int_tuple_1713 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1714 = cute.size(%int_tuple_1713) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1715 = cute.get_leaves(%sz_1714) : !cute.int_tuple<"1">
      %coord_1716 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1717 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1718 = cute.crd2idx(%coord_1716, %lay_1717) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1719 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1720 = cute.add_offset(%iter_1719, %idx_1718) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1721 = cute.make_view(%tup_1720) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1722 = cute.get_iter(%view_1721) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1723, %e1_1724, %e2_1725, %e3_1726 = cute.get_leaves(%iter_1722) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1065 = cute.get_scalars(%e0_1723) : !cute.int_tuple<"?">
      %1066 = cute.get_scalars(%e1_1724) : !cute.int_tuple<"?">
      %1067 = cute.get_scalars(%e2_1725) : !cute.int_tuple<"?">
      %1068 = cute.get_scalars(%e3_1726) : !cute.int_tuple<"?{div=8}">
      %iter_1727 = cute.get_iter(%view_1721) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1728, %e1_1729, %e2_1730, %e3_1731 = cute.get_leaves(%iter_1727) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1069 = cute.get_scalars(%e0_1728) : !cute.int_tuple<"?">
      %1070 = cute.get_scalars(%e1_1729) : !cute.int_tuple<"?">
      %1071 = cute.get_scalars(%e2_1730) : !cute.int_tuple<"?">
      %1072 = cute.get_scalars(%e3_1731) : !cute.int_tuple<"?{div=8}">
      %iter_1732 = cute.get_iter(%view_1721) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1733, %e1_1734, %e2_1735, %e3_1736 = cute.get_leaves(%iter_1732) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1073 = cute.get_scalars(%e0_1733) : !cute.int_tuple<"?">
      %1074 = cute.get_scalars(%e1_1734) : !cute.int_tuple<"?">
      %1075 = cute.get_scalars(%e2_1735) : !cute.int_tuple<"?">
      %1076 = cute.get_scalars(%e3_1736) : !cute.int_tuple<"?{div=8}">
      %lay_1737 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1077 = cute.get_shape(%lay_1737) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1738, %e1_1739, %e2_1740, %e3_1741 = cute.get_leaves(%1077) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1742 = cute.to_int_tuple(%e0_1738) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1078 = cute.get_scalars(%itup_1742) : !cute.int_tuple<"?">
      %itup_1743 = cute.to_int_tuple(%e1_1739) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1079 = cute.get_scalars(%itup_1743) : !cute.int_tuple<"?">
      %itup_1744 = cute.to_int_tuple(%e2_1740) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1080 = cute.get_scalars(%itup_1744) : !cute.int_tuple<"?">
      %itup_1745 = cute.to_int_tuple(%e3_1741) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1081 = cute.get_scalars(%itup_1745) : !cute.int_tuple<"?{div=8}">
      %coord_1746 = cute.make_coord(%e1_1734) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1747 = cute.make_coord(%itup_1744) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1082 = cute.get_scalars(%coord_1746) : !cute.coord<"?">
      %1083 = cute.get_scalars(%coord_1747) : !cute.coord<"?">
      %true_1748 = arith.constant true
      %1084 = arith.cmpi slt, %1082, %1083 : i32
      %1085 = arith.andi %true_1748, %1084 : i1
      %coord_1749 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1750 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1751 = cute.crd2idx(%coord_1749, %lay_1750) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1752 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1753 = cute.add_offset(%iter_1752, %idx_1751) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1754 = cute.make_view(%tup_1753) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1755 = cute.get_iter(%view_1754) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1756, %e1_1757, %e2_1758, %e3_1759 = cute.get_leaves(%iter_1755) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1086 = cute.get_scalars(%e0_1756) : !cute.int_tuple<"?">
      %1087 = cute.get_scalars(%e1_1757) : !cute.int_tuple<"?">
      %1088 = cute.get_scalars(%e2_1758) : !cute.int_tuple<"?">
      %1089 = cute.get_scalars(%e3_1759) : !cute.int_tuple<"?{div=8}">
      %iter_1760 = cute.get_iter(%view_1754) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1761, %e1_1762, %e2_1763, %e3_1764 = cute.get_leaves(%iter_1760) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1090 = cute.get_scalars(%e0_1761) : !cute.int_tuple<"?">
      %1091 = cute.get_scalars(%e1_1762) : !cute.int_tuple<"?">
      %1092 = cute.get_scalars(%e2_1763) : !cute.int_tuple<"?">
      %1093 = cute.get_scalars(%e3_1764) : !cute.int_tuple<"?{div=8}">
      %iter_1765 = cute.get_iter(%view_1754) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1766, %e1_1767, %e2_1768, %e3_1769 = cute.get_leaves(%iter_1765) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1094 = cute.get_scalars(%e0_1766) : !cute.int_tuple<"?">
      %1095 = cute.get_scalars(%e1_1767) : !cute.int_tuple<"?">
      %1096 = cute.get_scalars(%e2_1768) : !cute.int_tuple<"?">
      %1097 = cute.get_scalars(%e3_1769) : !cute.int_tuple<"?{div=8}">
      %lay_1770 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1098 = cute.get_shape(%lay_1770) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1771, %e1_1772, %e2_1773, %e3_1774 = cute.get_leaves(%1098) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1775 = cute.to_int_tuple(%e0_1771) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1099 = cute.get_scalars(%itup_1775) : !cute.int_tuple<"?">
      %itup_1776 = cute.to_int_tuple(%e1_1772) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1100 = cute.get_scalars(%itup_1776) : !cute.int_tuple<"?">
      %itup_1777 = cute.to_int_tuple(%e2_1773) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1101 = cute.get_scalars(%itup_1777) : !cute.int_tuple<"?">
      %itup_1778 = cute.to_int_tuple(%e3_1774) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1102 = cute.get_scalars(%itup_1778) : !cute.int_tuple<"?{div=8}">
      %coord_1779 = cute.make_coord(%e1_1767) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1780 = cute.make_coord(%itup_1777) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1103 = cute.get_scalars(%coord_1779) : !cute.coord<"?">
      %1104 = cute.get_scalars(%coord_1780) : !cute.coord<"?">
      %true_1781 = arith.constant true
      %1105 = arith.cmpi slt, %1103, %1104 : i32
      %1106 = arith.andi %true_1781, %1105 : i1
      %coord_1782 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1783 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1784 = cute.crd2idx(%coord_1782, %lay_1783) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1785 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1786 = cute.add_offset(%iter_1785, %idx_1784) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1787 = cute.make_view(%tup_1786) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1788 = cute.get_iter(%view_1787) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1789, %e1_1790, %e2_1791, %e3_1792 = cute.get_leaves(%iter_1788) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1107 = cute.get_scalars(%e0_1789) : !cute.int_tuple<"?">
      %1108 = cute.get_scalars(%e1_1790) : !cute.int_tuple<"?">
      %1109 = cute.get_scalars(%e2_1791) : !cute.int_tuple<"?">
      %1110 = cute.get_scalars(%e3_1792) : !cute.int_tuple<"?{div=8}">
      %iter_1793 = cute.get_iter(%view_1787) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1794, %e1_1795, %e2_1796, %e3_1797 = cute.get_leaves(%iter_1793) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1111 = cute.get_scalars(%e0_1794) : !cute.int_tuple<"?">
      %1112 = cute.get_scalars(%e1_1795) : !cute.int_tuple<"?">
      %1113 = cute.get_scalars(%e2_1796) : !cute.int_tuple<"?">
      %1114 = cute.get_scalars(%e3_1797) : !cute.int_tuple<"?{div=8}">
      %iter_1798 = cute.get_iter(%view_1787) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1799, %e1_1800, %e2_1801, %e3_1802 = cute.get_leaves(%iter_1798) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1115 = cute.get_scalars(%e0_1799) : !cute.int_tuple<"?">
      %1116 = cute.get_scalars(%e1_1800) : !cute.int_tuple<"?">
      %1117 = cute.get_scalars(%e2_1801) : !cute.int_tuple<"?">
      %1118 = cute.get_scalars(%e3_1802) : !cute.int_tuple<"?{div=8}">
      %lay_1803 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1119 = cute.get_shape(%lay_1803) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1804, %e1_1805, %e2_1806, %e3_1807 = cute.get_leaves(%1119) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1808 = cute.to_int_tuple(%e0_1804) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1120 = cute.get_scalars(%itup_1808) : !cute.int_tuple<"?">
      %itup_1809 = cute.to_int_tuple(%e1_1805) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1121 = cute.get_scalars(%itup_1809) : !cute.int_tuple<"?">
      %itup_1810 = cute.to_int_tuple(%e2_1806) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1122 = cute.get_scalars(%itup_1810) : !cute.int_tuple<"?">
      %itup_1811 = cute.to_int_tuple(%e3_1807) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1123 = cute.get_scalars(%itup_1811) : !cute.int_tuple<"?{div=8}">
      %coord_1812 = cute.make_coord(%e2_1801) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1813 = cute.make_coord(%itup_1811) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1124 = cute.get_scalars(%coord_1812) : !cute.coord<"?">
      %1125 = cute.get_scalars(%coord_1813) : !cute.coord<"?{div=8}">
      %true_1814 = arith.constant true
      %1126 = arith.cmpi slt, %1124, %1125 : i32
      %1127 = arith.andi %true_1814, %1126 : i1
      %1128 = arith.extui %1106 : i1 to i32
      %c0_i32_1815 = arith.constant 0 : i32
      %1129 = arith.cmpi ne, %1128, %c0_i32_1815 : i32
      %1130 = arith.extui %1106 : i1 to i32
      %1131 = arith.extui %1127 : i1 to i32
      %1132 = arith.select %1129, %1131, %1130 : i32
      %c0_i32_1816 = arith.constant 0 : i32
      %1133 = arith.cmpi ne, %1132, %c0_i32_1816 : i32
      scf.if %1133 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,0,?)">
        %lay_2760 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
        %iter_2762 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_10
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2768 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2770 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_14
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %lay_2775 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %1603 = cute.get_shape(%lay_2775) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2776, %e1_2777 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %lay_2778 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %1604 = cute.get_shape(%lay_2778) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2779, %e1_2780 = cute.get_leaves(%1604) : !cute.shape<"((8,1))">
        %lay_2781 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %shape_2782 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2783 = cute.make_layout() : !cute.layout<"1:0">
        %append_2784 = cute.append_to_rank<2> (%lay_2781, %lay_2783) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2785 = cute.make_view(%iter_2766, %append_2784) : !memref_gmem_bf16_11
        %iter_2786 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %lay_2787 = cute.get_layout(%view_2785) : !memref_gmem_bf16_11
        %1605 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1605) : !cute.shape<"((8,1),1)">
        %iter_2791 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %view_2792 = cute.make_view(%iter_2791) : !memref_gmem_bf16_12
        %iter_2793 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2794 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %lay_2795 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %shape_2796 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2797 = cute.make_layout() : !cute.layout<"1:0">
        %append_2798 = cute.append_to_rank<2> (%lay_2795, %lay_2797) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2799 = cute.make_view(%iter_2774, %append_2798) : !memref_smem_bf16_15
        %iter_2800 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %lay_2801 = cute.get_layout(%view_2799) : !memref_smem_bf16_15
        %1606 = cute.get_shape(%lay_2801) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2802, %e1_2803, %e2_2804 = cute.get_leaves(%1606) : !cute.shape<"((8,1),1)">
        %iter_2805 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %view_2806 = cute.make_view(%iter_2805) : !memref_smem_bf16_16
        %iter_2807 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %iter_2808 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2809 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %1607 = cute.get_shape(%lay_2809) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2810, %e1_2811, %e2_2812 = cute.get_leaves(%1607) : !cute.shape<"((8,1),(1))">
        %lay_2813 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %1608 = cute.get_shape(%lay_2813) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2814, %e1_2815, %e2_2816 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(1))">
        %lay_2817 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %sz_2818 = cute.size(%lay_2817) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2819 = cute.get_leaves(%sz_2818) : !cute.int_tuple<"1">
        %lay_2820 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %sz_2821 = cute.size(%lay_2820) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2822 = cute.get_leaves(%sz_2821) : !cute.int_tuple<"1">
        %1609 = cute.static : !cute.layout<"1:0">
        %iter_2823 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2824 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2825 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %lay_2826 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %append_2827 = cute.append_to_rank<2> (%lay_2825, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2828 = cute.append_to_rank<2> (%lay_2826, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2830 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2831 = cute.size(%lay_2829) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1610 = cute.get_scalars(%sz_2831) : !cute.int_tuple<"1">
        %c0_i32_2832 = arith.constant 0 : i32
        %c1_i32_2833 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2832 to %1610 step %c1_i32_2833  : i32 {
          %coord_2834 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1611 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2835 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2836 = cute.crd2idx(%coord_2834, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2837 = cute.add_offset(%iter_2823, %idx_2836) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2838 = cute.make_view(%ptr_2837, %lay_2835) : !memref_gmem_bf16_10
          %1612 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2839 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2840 = cute.crd2idx(%coord_2834, %lay_2830) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2841 = cute.add_offset(%iter_2824, %idx_2840) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2842 = cute.make_view(%ptr_2841, %lay_2839) : !memref_smem_bf16_14
          %iter_2843 = cute.get_iter(%view_2838) : !memref_gmem_bf16_10
          %iter_2844 = cute.get_iter(%view_2842) : !memref_smem_bf16_14
          %iter_2845 = cute.recast_iter(%iter_2843) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2846 = cute.recast_iter(%iter_2844) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2846 : !cute.ptr<i128, smem>, %iter_2845 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2760 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2762 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_14
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"8">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2771, %e1_2772 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %int_tuple_2773 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2775 = cute.get_leaves(%int_tuple_2774) : !cute.int_tuple<"8">
        %cst_2776 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2776 : vector<8xbf16>
        %int_tuple_2777 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2778 = cute.size(%int_tuple_2777) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2779 = cute.get_leaves(%sz_2778) : !cute.int_tuple<"8">
        %int_tuple_2780 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2781 = cute.size(%int_tuple_2780) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2782 = cute.get_leaves(%sz_2781) : !cute.int_tuple<"8">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_14
      }
      %int_tuple_1817 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1818 = cute.size(%int_tuple_1817) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1819 = cute.get_leaves(%sz_1818) : !cute.int_tuple<"1">
      %coord_1820 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1821 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1822 = cute.crd2idx(%coord_1820, %lay_1821) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1823 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1824 = cute.add_offset(%iter_1823, %idx_1822) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1825 = cute.make_view(%tup_1824) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1826 = cute.get_iter(%view_1825) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1827, %e1_1828, %e2_1829, %e3_1830 = cute.get_leaves(%iter_1826) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1134 = cute.get_scalars(%e0_1827) : !cute.int_tuple<"?">
      %1135 = cute.get_scalars(%e1_1828) : !cute.int_tuple<"?">
      %1136 = cute.get_scalars(%e2_1829) : !cute.int_tuple<"?">
      %1137 = cute.get_scalars(%e3_1830) : !cute.int_tuple<"?{div=8}">
      %iter_1831 = cute.get_iter(%view_1825) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1832, %e1_1833, %e2_1834, %e3_1835 = cute.get_leaves(%iter_1831) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1138 = cute.get_scalars(%e0_1832) : !cute.int_tuple<"?">
      %1139 = cute.get_scalars(%e1_1833) : !cute.int_tuple<"?">
      %1140 = cute.get_scalars(%e2_1834) : !cute.int_tuple<"?">
      %1141 = cute.get_scalars(%e3_1835) : !cute.int_tuple<"?{div=8}">
      %iter_1836 = cute.get_iter(%view_1825) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1837, %e1_1838, %e2_1839, %e3_1840 = cute.get_leaves(%iter_1836) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1142 = cute.get_scalars(%e0_1837) : !cute.int_tuple<"?">
      %1143 = cute.get_scalars(%e1_1838) : !cute.int_tuple<"?">
      %1144 = cute.get_scalars(%e2_1839) : !cute.int_tuple<"?">
      %1145 = cute.get_scalars(%e3_1840) : !cute.int_tuple<"?{div=8}">
      %lay_1841 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1146 = cute.get_shape(%lay_1841) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1842, %e1_1843, %e2_1844, %e3_1845 = cute.get_leaves(%1146) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1846 = cute.to_int_tuple(%e0_1842) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1147 = cute.get_scalars(%itup_1846) : !cute.int_tuple<"?">
      %itup_1847 = cute.to_int_tuple(%e1_1843) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1148 = cute.get_scalars(%itup_1847) : !cute.int_tuple<"?">
      %itup_1848 = cute.to_int_tuple(%e2_1844) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1149 = cute.get_scalars(%itup_1848) : !cute.int_tuple<"?">
      %itup_1849 = cute.to_int_tuple(%e3_1845) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1150 = cute.get_scalars(%itup_1849) : !cute.int_tuple<"?{div=8}">
      %coord_1850 = cute.make_coord(%e1_1838) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1851 = cute.make_coord(%itup_1848) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1151 = cute.get_scalars(%coord_1850) : !cute.coord<"?">
      %1152 = cute.get_scalars(%coord_1851) : !cute.coord<"?">
      %true_1852 = arith.constant true
      %1153 = arith.cmpi slt, %1151, %1152 : i32
      %1154 = arith.andi %true_1852, %1153 : i1
      %coord_1853 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1854 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1855 = cute.crd2idx(%coord_1853, %lay_1854) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1856 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1857 = cute.add_offset(%iter_1856, %idx_1855) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1858 = cute.make_view(%tup_1857) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1859 = cute.get_iter(%view_1858) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1860, %e1_1861, %e2_1862, %e3_1863 = cute.get_leaves(%iter_1859) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1155 = cute.get_scalars(%e0_1860) : !cute.int_tuple<"?">
      %1156 = cute.get_scalars(%e1_1861) : !cute.int_tuple<"?">
      %1157 = cute.get_scalars(%e2_1862) : !cute.int_tuple<"?">
      %1158 = cute.get_scalars(%e3_1863) : !cute.int_tuple<"?{div=8}">
      %iter_1864 = cute.get_iter(%view_1858) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1865, %e1_1866, %e2_1867, %e3_1868 = cute.get_leaves(%iter_1864) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1159 = cute.get_scalars(%e0_1865) : !cute.int_tuple<"?">
      %1160 = cute.get_scalars(%e1_1866) : !cute.int_tuple<"?">
      %1161 = cute.get_scalars(%e2_1867) : !cute.int_tuple<"?">
      %1162 = cute.get_scalars(%e3_1868) : !cute.int_tuple<"?{div=8}">
      %iter_1869 = cute.get_iter(%view_1858) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1870, %e1_1871, %e2_1872, %e3_1873 = cute.get_leaves(%iter_1869) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1163 = cute.get_scalars(%e0_1870) : !cute.int_tuple<"?">
      %1164 = cute.get_scalars(%e1_1871) : !cute.int_tuple<"?">
      %1165 = cute.get_scalars(%e2_1872) : !cute.int_tuple<"?">
      %1166 = cute.get_scalars(%e3_1873) : !cute.int_tuple<"?{div=8}">
      %lay_1874 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1167 = cute.get_shape(%lay_1874) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1875, %e1_1876, %e2_1877, %e3_1878 = cute.get_leaves(%1167) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1879 = cute.to_int_tuple(%e0_1875) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1168 = cute.get_scalars(%itup_1879) : !cute.int_tuple<"?">
      %itup_1880 = cute.to_int_tuple(%e1_1876) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1169 = cute.get_scalars(%itup_1880) : !cute.int_tuple<"?">
      %itup_1881 = cute.to_int_tuple(%e2_1877) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1170 = cute.get_scalars(%itup_1881) : !cute.int_tuple<"?">
      %itup_1882 = cute.to_int_tuple(%e3_1878) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1171 = cute.get_scalars(%itup_1882) : !cute.int_tuple<"?{div=8}">
      %coord_1883 = cute.make_coord(%e1_1871) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1884 = cute.make_coord(%itup_1881) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1172 = cute.get_scalars(%coord_1883) : !cute.coord<"?">
      %1173 = cute.get_scalars(%coord_1884) : !cute.coord<"?">
      %true_1885 = arith.constant true
      %1174 = arith.cmpi slt, %1172, %1173 : i32
      %1175 = arith.andi %true_1885, %1174 : i1
      %coord_1886 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1887 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1888 = cute.crd2idx(%coord_1886, %lay_1887) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1889 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1890 = cute.add_offset(%iter_1889, %idx_1888) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1891 = cute.make_view(%tup_1890) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1892 = cute.get_iter(%view_1891) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1893, %e1_1894, %e2_1895, %e3_1896 = cute.get_leaves(%iter_1892) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1176 = cute.get_scalars(%e0_1893) : !cute.int_tuple<"?">
      %1177 = cute.get_scalars(%e1_1894) : !cute.int_tuple<"?">
      %1178 = cute.get_scalars(%e2_1895) : !cute.int_tuple<"?">
      %1179 = cute.get_scalars(%e3_1896) : !cute.int_tuple<"?{div=8}">
      %iter_1897 = cute.get_iter(%view_1891) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1898, %e1_1899, %e2_1900, %e3_1901 = cute.get_leaves(%iter_1897) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1180 = cute.get_scalars(%e0_1898) : !cute.int_tuple<"?">
      %1181 = cute.get_scalars(%e1_1899) : !cute.int_tuple<"?">
      %1182 = cute.get_scalars(%e2_1900) : !cute.int_tuple<"?">
      %1183 = cute.get_scalars(%e3_1901) : !cute.int_tuple<"?{div=8}">
      %iter_1902 = cute.get_iter(%view_1891) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1903, %e1_1904, %e2_1905, %e3_1906 = cute.get_leaves(%iter_1902) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1184 = cute.get_scalars(%e0_1903) : !cute.int_tuple<"?">
      %1185 = cute.get_scalars(%e1_1904) : !cute.int_tuple<"?">
      %1186 = cute.get_scalars(%e2_1905) : !cute.int_tuple<"?">
      %1187 = cute.get_scalars(%e3_1906) : !cute.int_tuple<"?{div=8}">
      %lay_1907 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1188 = cute.get_shape(%lay_1907) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1908, %e1_1909, %e2_1910, %e3_1911 = cute.get_leaves(%1188) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1912 = cute.to_int_tuple(%e0_1908) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1189 = cute.get_scalars(%itup_1912) : !cute.int_tuple<"?">
      %itup_1913 = cute.to_int_tuple(%e1_1909) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1190 = cute.get_scalars(%itup_1913) : !cute.int_tuple<"?">
      %itup_1914 = cute.to_int_tuple(%e2_1910) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1191 = cute.get_scalars(%itup_1914) : !cute.int_tuple<"?">
      %itup_1915 = cute.to_int_tuple(%e3_1911) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1192 = cute.get_scalars(%itup_1915) : !cute.int_tuple<"?{div=8}">
      %coord_1916 = cute.make_coord(%e2_1905) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1917 = cute.make_coord(%itup_1915) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1193 = cute.get_scalars(%coord_1916) : !cute.coord<"?">
      %1194 = cute.get_scalars(%coord_1917) : !cute.coord<"?{div=8}">
      %true_1918 = arith.constant true
      %1195 = arith.cmpi slt, %1193, %1194 : i32
      %1196 = arith.andi %true_1918, %1195 : i1
      %1197 = arith.extui %1175 : i1 to i32
      %1198 = arith.cmpi ne, %1197, %c0_i32_1815 : i32
      %1199 = arith.extui %1175 : i1 to i32
      %1200 = arith.extui %1196 : i1 to i32
      %1201 = arith.select %1198, %1200, %1199 : i32
      %1202 = arith.cmpi ne, %1201, %c0_i32_1816 : i32
      scf.if %1202 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,0,?)">
        %lay_2760 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2762 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_10
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2768 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2770 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_14
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %lay_2775 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %1603 = cute.get_shape(%lay_2775) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2776, %e1_2777 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %lay_2778 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %1604 = cute.get_shape(%lay_2778) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2779, %e1_2780 = cute.get_leaves(%1604) : !cute.shape<"((8,1))">
        %lay_2781 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %shape_2782 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2783 = cute.make_layout() : !cute.layout<"1:0">
        %append_2784 = cute.append_to_rank<2> (%lay_2781, %lay_2783) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2785 = cute.make_view(%iter_2766, %append_2784) : !memref_gmem_bf16_11
        %iter_2786 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %lay_2787 = cute.get_layout(%view_2785) : !memref_gmem_bf16_11
        %1605 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1605) : !cute.shape<"((8,1),1)">
        %iter_2791 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %view_2792 = cute.make_view(%iter_2791) : !memref_gmem_bf16_12
        %iter_2793 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2794 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %lay_2795 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %shape_2796 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2797 = cute.make_layout() : !cute.layout<"1:0">
        %append_2798 = cute.append_to_rank<2> (%lay_2795, %lay_2797) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2799 = cute.make_view(%iter_2774, %append_2798) : !memref_smem_bf16_15
        %iter_2800 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %lay_2801 = cute.get_layout(%view_2799) : !memref_smem_bf16_15
        %1606 = cute.get_shape(%lay_2801) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2802, %e1_2803, %e2_2804 = cute.get_leaves(%1606) : !cute.shape<"((8,1),1)">
        %iter_2805 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %view_2806 = cute.make_view(%iter_2805) : !memref_smem_bf16_16
        %iter_2807 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %iter_2808 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2809 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %1607 = cute.get_shape(%lay_2809) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2810, %e1_2811, %e2_2812 = cute.get_leaves(%1607) : !cute.shape<"((8,1),(1))">
        %lay_2813 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %1608 = cute.get_shape(%lay_2813) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2814, %e1_2815, %e2_2816 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(1))">
        %lay_2817 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %sz_2818 = cute.size(%lay_2817) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2819 = cute.get_leaves(%sz_2818) : !cute.int_tuple<"1">
        %lay_2820 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %sz_2821 = cute.size(%lay_2820) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2822 = cute.get_leaves(%sz_2821) : !cute.int_tuple<"1">
        %1609 = cute.static : !cute.layout<"1:0">
        %iter_2823 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2824 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2825 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %lay_2826 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %append_2827 = cute.append_to_rank<2> (%lay_2825, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2828 = cute.append_to_rank<2> (%lay_2826, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2830 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2831 = cute.size(%lay_2829) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1610 = cute.get_scalars(%sz_2831) : !cute.int_tuple<"1">
        %c0_i32_2832 = arith.constant 0 : i32
        %c1_i32_2833 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2832 to %1610 step %c1_i32_2833  : i32 {
          %coord_2834 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1611 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2835 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2836 = cute.crd2idx(%coord_2834, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2837 = cute.add_offset(%iter_2823, %idx_2836) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2838 = cute.make_view(%ptr_2837, %lay_2835) : !memref_gmem_bf16_10
          %1612 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2839 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2840 = cute.crd2idx(%coord_2834, %lay_2830) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2841 = cute.add_offset(%iter_2824, %idx_2840) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2842 = cute.make_view(%ptr_2841, %lay_2839) : !memref_smem_bf16_14
          %iter_2843 = cute.get_iter(%view_2838) : !memref_gmem_bf16_10
          %iter_2844 = cute.get_iter(%view_2842) : !memref_smem_bf16_14
          %iter_2845 = cute.recast_iter(%iter_2843) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2846 = cute.recast_iter(%iter_2844) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2846 : !cute.ptr<i128, smem>, %iter_2845 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2760 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2762 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_14
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"8">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2771, %e1_2772 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %int_tuple_2773 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2775 = cute.get_leaves(%int_tuple_2774) : !cute.int_tuple<"8">
        %cst_2776 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2776 : vector<8xbf16>
        %int_tuple_2777 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2778 = cute.size(%int_tuple_2777) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2779 = cute.get_leaves(%sz_2778) : !cute.int_tuple<"8">
        %int_tuple_2780 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2781 = cute.size(%int_tuple_2780) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2782 = cute.get_leaves(%sz_2781) : !cute.int_tuple<"8">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_14
      }
      %int_tuple_1919 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1920 = cute.size(%int_tuple_1919) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1921 = cute.get_leaves(%sz_1920) : !cute.int_tuple<"1">
      %coord_1922 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1923 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1924 = cute.crd2idx(%coord_1922, %lay_1923) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1925 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1926 = cute.add_offset(%iter_1925, %idx_1924) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1927 = cute.make_view(%tup_1926) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1928 = cute.get_iter(%view_1927) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1929, %e1_1930, %e2_1931, %e3_1932 = cute.get_leaves(%iter_1928) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1203 = cute.get_scalars(%e0_1929) : !cute.int_tuple<"?">
      %1204 = cute.get_scalars(%e1_1930) : !cute.int_tuple<"?">
      %1205 = cute.get_scalars(%e2_1931) : !cute.int_tuple<"?">
      %1206 = cute.get_scalars(%e3_1932) : !cute.int_tuple<"?{div=8}">
      %iter_1933 = cute.get_iter(%view_1927) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1934, %e1_1935, %e2_1936, %e3_1937 = cute.get_leaves(%iter_1933) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1207 = cute.get_scalars(%e0_1934) : !cute.int_tuple<"?">
      %1208 = cute.get_scalars(%e1_1935) : !cute.int_tuple<"?">
      %1209 = cute.get_scalars(%e2_1936) : !cute.int_tuple<"?">
      %1210 = cute.get_scalars(%e3_1937) : !cute.int_tuple<"?{div=8}">
      %iter_1938 = cute.get_iter(%view_1927) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1939, %e1_1940, %e2_1941, %e3_1942 = cute.get_leaves(%iter_1938) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1211 = cute.get_scalars(%e0_1939) : !cute.int_tuple<"?">
      %1212 = cute.get_scalars(%e1_1940) : !cute.int_tuple<"?">
      %1213 = cute.get_scalars(%e2_1941) : !cute.int_tuple<"?">
      %1214 = cute.get_scalars(%e3_1942) : !cute.int_tuple<"?{div=8}">
      %lay_1943 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1215 = cute.get_shape(%lay_1943) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1944, %e1_1945, %e2_1946, %e3_1947 = cute.get_leaves(%1215) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1948 = cute.to_int_tuple(%e0_1944) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1216 = cute.get_scalars(%itup_1948) : !cute.int_tuple<"?">
      %itup_1949 = cute.to_int_tuple(%e1_1945) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1217 = cute.get_scalars(%itup_1949) : !cute.int_tuple<"?">
      %itup_1950 = cute.to_int_tuple(%e2_1946) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1218 = cute.get_scalars(%itup_1950) : !cute.int_tuple<"?">
      %itup_1951 = cute.to_int_tuple(%e3_1947) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1219 = cute.get_scalars(%itup_1951) : !cute.int_tuple<"?{div=8}">
      %coord_1952 = cute.make_coord(%e1_1940) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1953 = cute.make_coord(%itup_1950) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1220 = cute.get_scalars(%coord_1952) : !cute.coord<"?">
      %1221 = cute.get_scalars(%coord_1953) : !cute.coord<"?">
      %true_1954 = arith.constant true
      %1222 = arith.cmpi slt, %1220, %1221 : i32
      %1223 = arith.andi %true_1954, %1222 : i1
      %coord_1955 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1956 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1957 = cute.crd2idx(%coord_1955, %lay_1956) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1958 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1959 = cute.add_offset(%iter_1958, %idx_1957) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1960 = cute.make_view(%tup_1959) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1961 = cute.get_iter(%view_1960) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1962, %e1_1963, %e2_1964, %e3_1965 = cute.get_leaves(%iter_1961) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1224 = cute.get_scalars(%e0_1962) : !cute.int_tuple<"?">
      %1225 = cute.get_scalars(%e1_1963) : !cute.int_tuple<"?">
      %1226 = cute.get_scalars(%e2_1964) : !cute.int_tuple<"?">
      %1227 = cute.get_scalars(%e3_1965) : !cute.int_tuple<"?{div=8}">
      %iter_1966 = cute.get_iter(%view_1960) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1967, %e1_1968, %e2_1969, %e3_1970 = cute.get_leaves(%iter_1966) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1228 = cute.get_scalars(%e0_1967) : !cute.int_tuple<"?">
      %1229 = cute.get_scalars(%e1_1968) : !cute.int_tuple<"?">
      %1230 = cute.get_scalars(%e2_1969) : !cute.int_tuple<"?">
      %1231 = cute.get_scalars(%e3_1970) : !cute.int_tuple<"?{div=8}">
      %iter_1971 = cute.get_iter(%view_1960) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1972, %e1_1973, %e2_1974, %e3_1975 = cute.get_leaves(%iter_1971) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1232 = cute.get_scalars(%e0_1972) : !cute.int_tuple<"?">
      %1233 = cute.get_scalars(%e1_1973) : !cute.int_tuple<"?">
      %1234 = cute.get_scalars(%e2_1974) : !cute.int_tuple<"?">
      %1235 = cute.get_scalars(%e3_1975) : !cute.int_tuple<"?{div=8}">
      %lay_1976 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1236 = cute.get_shape(%lay_1976) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1977, %e1_1978, %e2_1979, %e3_1980 = cute.get_leaves(%1236) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1981 = cute.to_int_tuple(%e0_1977) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1237 = cute.get_scalars(%itup_1981) : !cute.int_tuple<"?">
      %itup_1982 = cute.to_int_tuple(%e1_1978) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1238 = cute.get_scalars(%itup_1982) : !cute.int_tuple<"?">
      %itup_1983 = cute.to_int_tuple(%e2_1979) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1239 = cute.get_scalars(%itup_1983) : !cute.int_tuple<"?">
      %itup_1984 = cute.to_int_tuple(%e3_1980) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1240 = cute.get_scalars(%itup_1984) : !cute.int_tuple<"?{div=8}">
      %coord_1985 = cute.make_coord(%e1_1973) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1986 = cute.make_coord(%itup_1983) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1241 = cute.get_scalars(%coord_1985) : !cute.coord<"?">
      %1242 = cute.get_scalars(%coord_1986) : !cute.coord<"?">
      %true_1987 = arith.constant true
      %1243 = arith.cmpi slt, %1241, %1242 : i32
      %1244 = arith.andi %true_1987, %1243 : i1
      %coord_1988 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1989 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1990 = cute.crd2idx(%coord_1988, %lay_1989) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1991 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1992 = cute.add_offset(%iter_1991, %idx_1990) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1993 = cute.make_view(%tup_1992) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1994 = cute.get_iter(%view_1993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1995, %e1_1996, %e2_1997, %e3_1998 = cute.get_leaves(%iter_1994) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1245 = cute.get_scalars(%e0_1995) : !cute.int_tuple<"?">
      %1246 = cute.get_scalars(%e1_1996) : !cute.int_tuple<"?">
      %1247 = cute.get_scalars(%e2_1997) : !cute.int_tuple<"?">
      %1248 = cute.get_scalars(%e3_1998) : !cute.int_tuple<"?{div=8}">
      %iter_1999 = cute.get_iter(%view_1993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2000, %e1_2001, %e2_2002, %e3_2003 = cute.get_leaves(%iter_1999) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1249 = cute.get_scalars(%e0_2000) : !cute.int_tuple<"?">
      %1250 = cute.get_scalars(%e1_2001) : !cute.int_tuple<"?">
      %1251 = cute.get_scalars(%e2_2002) : !cute.int_tuple<"?">
      %1252 = cute.get_scalars(%e3_2003) : !cute.int_tuple<"?{div=8}">
      %iter_2004 = cute.get_iter(%view_1993) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2005, %e1_2006, %e2_2007, %e3_2008 = cute.get_leaves(%iter_2004) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1253 = cute.get_scalars(%e0_2005) : !cute.int_tuple<"?">
      %1254 = cute.get_scalars(%e1_2006) : !cute.int_tuple<"?">
      %1255 = cute.get_scalars(%e2_2007) : !cute.int_tuple<"?">
      %1256 = cute.get_scalars(%e3_2008) : !cute.int_tuple<"?{div=8}">
      %lay_2009 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1257 = cute.get_shape(%lay_2009) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2010, %e1_2011, %e2_2012, %e3_2013 = cute.get_leaves(%1257) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2014 = cute.to_int_tuple(%e0_2010) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1258 = cute.get_scalars(%itup_2014) : !cute.int_tuple<"?">
      %itup_2015 = cute.to_int_tuple(%e1_2011) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1259 = cute.get_scalars(%itup_2015) : !cute.int_tuple<"?">
      %itup_2016 = cute.to_int_tuple(%e2_2012) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1260 = cute.get_scalars(%itup_2016) : !cute.int_tuple<"?">
      %itup_2017 = cute.to_int_tuple(%e3_2013) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1261 = cute.get_scalars(%itup_2017) : !cute.int_tuple<"?{div=8}">
      %coord_2018 = cute.make_coord(%e2_2007) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2019 = cute.make_coord(%itup_2017) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1262 = cute.get_scalars(%coord_2018) : !cute.coord<"?">
      %1263 = cute.get_scalars(%coord_2019) : !cute.coord<"?{div=8}">
      %true_2020 = arith.constant true
      %1264 = arith.cmpi slt, %1262, %1263 : i32
      %1265 = arith.andi %true_2020, %1264 : i1
      %1266 = arith.extui %1244 : i1 to i32
      %1267 = arith.cmpi ne, %1266, %c0_i32_1815 : i32
      %1268 = arith.extui %1244 : i1 to i32
      %1269 = arith.extui %1265 : i1 to i32
      %1270 = arith.select %1267, %1269, %1268 : i32
      %1271 = arith.cmpi ne, %1270, %c0_i32_1816 : i32
      scf.if %1271 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,0,?)">
        %lay_2760 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2762 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_10
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2768 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2770 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_14
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %lay_2775 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %1603 = cute.get_shape(%lay_2775) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2776, %e1_2777 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %lay_2778 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %1604 = cute.get_shape(%lay_2778) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2779, %e1_2780 = cute.get_leaves(%1604) : !cute.shape<"((8,1))">
        %lay_2781 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %shape_2782 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2783 = cute.make_layout() : !cute.layout<"1:0">
        %append_2784 = cute.append_to_rank<2> (%lay_2781, %lay_2783) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2785 = cute.make_view(%iter_2766, %append_2784) : !memref_gmem_bf16_11
        %iter_2786 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %lay_2787 = cute.get_layout(%view_2785) : !memref_gmem_bf16_11
        %1605 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1605) : !cute.shape<"((8,1),1)">
        %iter_2791 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %view_2792 = cute.make_view(%iter_2791) : !memref_gmem_bf16_12
        %iter_2793 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2794 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %lay_2795 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %shape_2796 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2797 = cute.make_layout() : !cute.layout<"1:0">
        %append_2798 = cute.append_to_rank<2> (%lay_2795, %lay_2797) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2799 = cute.make_view(%iter_2774, %append_2798) : !memref_smem_bf16_15
        %iter_2800 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %lay_2801 = cute.get_layout(%view_2799) : !memref_smem_bf16_15
        %1606 = cute.get_shape(%lay_2801) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2802, %e1_2803, %e2_2804 = cute.get_leaves(%1606) : !cute.shape<"((8,1),1)">
        %iter_2805 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %view_2806 = cute.make_view(%iter_2805) : !memref_smem_bf16_16
        %iter_2807 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %iter_2808 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2809 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %1607 = cute.get_shape(%lay_2809) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2810, %e1_2811, %e2_2812 = cute.get_leaves(%1607) : !cute.shape<"((8,1),(1))">
        %lay_2813 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %1608 = cute.get_shape(%lay_2813) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2814, %e1_2815, %e2_2816 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(1))">
        %lay_2817 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %sz_2818 = cute.size(%lay_2817) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2819 = cute.get_leaves(%sz_2818) : !cute.int_tuple<"1">
        %lay_2820 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %sz_2821 = cute.size(%lay_2820) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2822 = cute.get_leaves(%sz_2821) : !cute.int_tuple<"1">
        %1609 = cute.static : !cute.layout<"1:0">
        %iter_2823 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2824 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2825 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %lay_2826 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %append_2827 = cute.append_to_rank<2> (%lay_2825, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2828 = cute.append_to_rank<2> (%lay_2826, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2830 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2831 = cute.size(%lay_2829) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1610 = cute.get_scalars(%sz_2831) : !cute.int_tuple<"1">
        %c0_i32_2832 = arith.constant 0 : i32
        %c1_i32_2833 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2832 to %1610 step %c1_i32_2833  : i32 {
          %coord_2834 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1611 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2835 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2836 = cute.crd2idx(%coord_2834, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2837 = cute.add_offset(%iter_2823, %idx_2836) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2838 = cute.make_view(%ptr_2837, %lay_2835) : !memref_gmem_bf16_10
          %1612 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2839 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2840 = cute.crd2idx(%coord_2834, %lay_2830) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2841 = cute.add_offset(%iter_2824, %idx_2840) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2842 = cute.make_view(%ptr_2841, %lay_2839) : !memref_smem_bf16_14
          %iter_2843 = cute.get_iter(%view_2838) : !memref_gmem_bf16_10
          %iter_2844 = cute.get_iter(%view_2842) : !memref_smem_bf16_14
          %iter_2845 = cute.recast_iter(%iter_2843) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2846 = cute.recast_iter(%iter_2844) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2846 : !cute.ptr<i128, smem>, %iter_2845 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2760 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2762 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_14
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"8">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2771, %e1_2772 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %int_tuple_2773 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2775 = cute.get_leaves(%int_tuple_2774) : !cute.int_tuple<"8">
        %cst_2776 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2776 : vector<8xbf16>
        %int_tuple_2777 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2778 = cute.size(%int_tuple_2777) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2779 = cute.get_leaves(%sz_2778) : !cute.int_tuple<"8">
        %int_tuple_2780 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2781 = cute.size(%int_tuple_2780) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2782 = cute.get_leaves(%sz_2781) : !cute.int_tuple<"8">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_14
      }
      %int_tuple_2021 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_2022 = cute.size(%int_tuple_2021) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_2023 = cute.get_leaves(%sz_2022) : !cute.int_tuple<"1">
      %coord_2024 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_2025 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_2026 = cute.crd2idx(%coord_2024, %lay_2025) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_2027 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_2028 = cute.add_offset(%iter_2027, %idx_2026) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2029 = cute.make_view(%tup_2028) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2030 = cute.get_iter(%view_2029) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2031, %e1_2032, %e2_2033, %e3_2034 = cute.get_leaves(%iter_2030) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1272 = cute.get_scalars(%e0_2031) : !cute.int_tuple<"?">
      %1273 = cute.get_scalars(%e1_2032) : !cute.int_tuple<"?">
      %1274 = cute.get_scalars(%e2_2033) : !cute.int_tuple<"?">
      %1275 = cute.get_scalars(%e3_2034) : !cute.int_tuple<"?{div=8}">
      %iter_2035 = cute.get_iter(%view_2029) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2036, %e1_2037, %e2_2038, %e3_2039 = cute.get_leaves(%iter_2035) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1276 = cute.get_scalars(%e0_2036) : !cute.int_tuple<"?">
      %1277 = cute.get_scalars(%e1_2037) : !cute.int_tuple<"?">
      %1278 = cute.get_scalars(%e2_2038) : !cute.int_tuple<"?">
      %1279 = cute.get_scalars(%e3_2039) : !cute.int_tuple<"?{div=8}">
      %iter_2040 = cute.get_iter(%view_2029) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2041, %e1_2042, %e2_2043, %e3_2044 = cute.get_leaves(%iter_2040) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1280 = cute.get_scalars(%e0_2041) : !cute.int_tuple<"?">
      %1281 = cute.get_scalars(%e1_2042) : !cute.int_tuple<"?">
      %1282 = cute.get_scalars(%e2_2043) : !cute.int_tuple<"?">
      %1283 = cute.get_scalars(%e3_2044) : !cute.int_tuple<"?{div=8}">
      %lay_2045 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1284 = cute.get_shape(%lay_2045) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2046, %e1_2047, %e2_2048, %e3_2049 = cute.get_leaves(%1284) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2050 = cute.to_int_tuple(%e0_2046) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1285 = cute.get_scalars(%itup_2050) : !cute.int_tuple<"?">
      %itup_2051 = cute.to_int_tuple(%e1_2047) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1286 = cute.get_scalars(%itup_2051) : !cute.int_tuple<"?">
      %itup_2052 = cute.to_int_tuple(%e2_2048) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1287 = cute.get_scalars(%itup_2052) : !cute.int_tuple<"?">
      %itup_2053 = cute.to_int_tuple(%e3_2049) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1288 = cute.get_scalars(%itup_2053) : !cute.int_tuple<"?{div=8}">
      %coord_2054 = cute.make_coord(%e1_2042) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2055 = cute.make_coord(%itup_2052) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1289 = cute.get_scalars(%coord_2054) : !cute.coord<"?">
      %1290 = cute.get_scalars(%coord_2055) : !cute.coord<"?">
      %true_2056 = arith.constant true
      %1291 = arith.cmpi slt, %1289, %1290 : i32
      %1292 = arith.andi %true_2056, %1291 : i1
      %coord_2057 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_2058 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_2059 = cute.crd2idx(%coord_2057, %lay_2058) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_2060 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_2061 = cute.add_offset(%iter_2060, %idx_2059) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2062 = cute.make_view(%tup_2061) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2063 = cute.get_iter(%view_2062) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2064, %e1_2065, %e2_2066, %e3_2067 = cute.get_leaves(%iter_2063) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1293 = cute.get_scalars(%e0_2064) : !cute.int_tuple<"?">
      %1294 = cute.get_scalars(%e1_2065) : !cute.int_tuple<"?">
      %1295 = cute.get_scalars(%e2_2066) : !cute.int_tuple<"?">
      %1296 = cute.get_scalars(%e3_2067) : !cute.int_tuple<"?{div=8}">
      %iter_2068 = cute.get_iter(%view_2062) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2069, %e1_2070, %e2_2071, %e3_2072 = cute.get_leaves(%iter_2068) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1297 = cute.get_scalars(%e0_2069) : !cute.int_tuple<"?">
      %1298 = cute.get_scalars(%e1_2070) : !cute.int_tuple<"?">
      %1299 = cute.get_scalars(%e2_2071) : !cute.int_tuple<"?">
      %1300 = cute.get_scalars(%e3_2072) : !cute.int_tuple<"?{div=8}">
      %iter_2073 = cute.get_iter(%view_2062) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2074, %e1_2075, %e2_2076, %e3_2077 = cute.get_leaves(%iter_2073) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1301 = cute.get_scalars(%e0_2074) : !cute.int_tuple<"?">
      %1302 = cute.get_scalars(%e1_2075) : !cute.int_tuple<"?">
      %1303 = cute.get_scalars(%e2_2076) : !cute.int_tuple<"?">
      %1304 = cute.get_scalars(%e3_2077) : !cute.int_tuple<"?{div=8}">
      %lay_2078 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1305 = cute.get_shape(%lay_2078) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2079, %e1_2080, %e2_2081, %e3_2082 = cute.get_leaves(%1305) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2083 = cute.to_int_tuple(%e0_2079) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1306 = cute.get_scalars(%itup_2083) : !cute.int_tuple<"?">
      %itup_2084 = cute.to_int_tuple(%e1_2080) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1307 = cute.get_scalars(%itup_2084) : !cute.int_tuple<"?">
      %itup_2085 = cute.to_int_tuple(%e2_2081) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1308 = cute.get_scalars(%itup_2085) : !cute.int_tuple<"?">
      %itup_2086 = cute.to_int_tuple(%e3_2082) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1309 = cute.get_scalars(%itup_2086) : !cute.int_tuple<"?{div=8}">
      %coord_2087 = cute.make_coord(%e1_2075) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2088 = cute.make_coord(%itup_2085) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1310 = cute.get_scalars(%coord_2087) : !cute.coord<"?">
      %1311 = cute.get_scalars(%coord_2088) : !cute.coord<"?">
      %true_2089 = arith.constant true
      %1312 = arith.cmpi slt, %1310, %1311 : i32
      %1313 = arith.andi %true_2089, %1312 : i1
      %coord_2090 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_2091 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_2092 = cute.crd2idx(%coord_2090, %lay_2091) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_2093 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_2094 = cute.add_offset(%iter_2093, %idx_2092) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2095 = cute.make_view(%tup_2094) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2096 = cute.get_iter(%view_2095) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2097, %e1_2098, %e2_2099, %e3_2100 = cute.get_leaves(%iter_2096) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1314 = cute.get_scalars(%e0_2097) : !cute.int_tuple<"?">
      %1315 = cute.get_scalars(%e1_2098) : !cute.int_tuple<"?">
      %1316 = cute.get_scalars(%e2_2099) : !cute.int_tuple<"?">
      %1317 = cute.get_scalars(%e3_2100) : !cute.int_tuple<"?{div=8}">
      %iter_2101 = cute.get_iter(%view_2095) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2102, %e1_2103, %e2_2104, %e3_2105 = cute.get_leaves(%iter_2101) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1318 = cute.get_scalars(%e0_2102) : !cute.int_tuple<"?">
      %1319 = cute.get_scalars(%e1_2103) : !cute.int_tuple<"?">
      %1320 = cute.get_scalars(%e2_2104) : !cute.int_tuple<"?">
      %1321 = cute.get_scalars(%e3_2105) : !cute.int_tuple<"?{div=8}">
      %iter_2106 = cute.get_iter(%view_2095) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2107, %e1_2108, %e2_2109, %e3_2110 = cute.get_leaves(%iter_2106) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1322 = cute.get_scalars(%e0_2107) : !cute.int_tuple<"?">
      %1323 = cute.get_scalars(%e1_2108) : !cute.int_tuple<"?">
      %1324 = cute.get_scalars(%e2_2109) : !cute.int_tuple<"?">
      %1325 = cute.get_scalars(%e3_2110) : !cute.int_tuple<"?{div=8}">
      %lay_2111 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1326 = cute.get_shape(%lay_2111) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2112, %e1_2113, %e2_2114, %e3_2115 = cute.get_leaves(%1326) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2116 = cute.to_int_tuple(%e0_2112) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1327 = cute.get_scalars(%itup_2116) : !cute.int_tuple<"?">
      %itup_2117 = cute.to_int_tuple(%e1_2113) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1328 = cute.get_scalars(%itup_2117) : !cute.int_tuple<"?">
      %itup_2118 = cute.to_int_tuple(%e2_2114) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1329 = cute.get_scalars(%itup_2118) : !cute.int_tuple<"?">
      %itup_2119 = cute.to_int_tuple(%e3_2115) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1330 = cute.get_scalars(%itup_2119) : !cute.int_tuple<"?{div=8}">
      %coord_2120 = cute.make_coord(%e2_2109) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2121 = cute.make_coord(%itup_2119) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1331 = cute.get_scalars(%coord_2120) : !cute.coord<"?">
      %1332 = cute.get_scalars(%coord_2121) : !cute.coord<"?{div=8}">
      %true_2122 = arith.constant true
      %1333 = arith.cmpi slt, %1331, %1332 : i32
      %1334 = arith.andi %true_2122, %1333 : i1
      %1335 = arith.extui %1313 : i1 to i32
      %1336 = arith.cmpi ne, %1335, %c0_i32_1815 : i32
      %1337 = arith.extui %1313 : i1 to i32
      %1338 = arith.extui %1334 : i1 to i32
      %1339 = arith.select %1336, %1338, %1337 : i32
      %1340 = arith.cmpi ne, %1339, %c0_i32_1816 : i32
      scf.if %1340 {
        %coord_2759 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,0,?)">
        %lay_2760 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2762 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_gmem_bf16_10
        %iter_2765 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %iter_2766 = cute.get_iter(%view_2764) : !memref_gmem_bf16_10
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2768 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2770 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_smem_bf16_14
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %iter_2774 = cute.get_iter(%view_2772) : !memref_smem_bf16_14
        %lay_2775 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %1603 = cute.get_shape(%lay_2775) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2776, %e1_2777 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %lay_2778 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %1604 = cute.get_shape(%lay_2778) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2779, %e1_2780 = cute.get_leaves(%1604) : !cute.shape<"((8,1))">
        %lay_2781 = cute.get_layout(%view_2764) : !memref_gmem_bf16_10
        %shape_2782 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2783 = cute.make_layout() : !cute.layout<"1:0">
        %append_2784 = cute.append_to_rank<2> (%lay_2781, %lay_2783) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2785 = cute.make_view(%iter_2766, %append_2784) : !memref_gmem_bf16_11
        %iter_2786 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %lay_2787 = cute.get_layout(%view_2785) : !memref_gmem_bf16_11
        %1605 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1605) : !cute.shape<"((8,1),1)">
        %iter_2791 = cute.get_iter(%view_2785) : !memref_gmem_bf16_11
        %view_2792 = cute.make_view(%iter_2791) : !memref_gmem_bf16_12
        %iter_2793 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2794 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %lay_2795 = cute.get_layout(%view_2772) : !memref_smem_bf16_14
        %shape_2796 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2797 = cute.make_layout() : !cute.layout<"1:0">
        %append_2798 = cute.append_to_rank<2> (%lay_2795, %lay_2797) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2799 = cute.make_view(%iter_2774, %append_2798) : !memref_smem_bf16_15
        %iter_2800 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %lay_2801 = cute.get_layout(%view_2799) : !memref_smem_bf16_15
        %1606 = cute.get_shape(%lay_2801) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2802, %e1_2803, %e2_2804 = cute.get_leaves(%1606) : !cute.shape<"((8,1),1)">
        %iter_2805 = cute.get_iter(%view_2799) : !memref_smem_bf16_15
        %view_2806 = cute.make_view(%iter_2805) : !memref_smem_bf16_16
        %iter_2807 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %iter_2808 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2809 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %1607 = cute.get_shape(%lay_2809) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2810, %e1_2811, %e2_2812 = cute.get_leaves(%1607) : !cute.shape<"((8,1),(1))">
        %lay_2813 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %1608 = cute.get_shape(%lay_2813) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2814, %e1_2815, %e2_2816 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(1))">
        %lay_2817 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %sz_2818 = cute.size(%lay_2817) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2819 = cute.get_leaves(%sz_2818) : !cute.int_tuple<"1">
        %lay_2820 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %sz_2821 = cute.size(%lay_2820) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2822 = cute.get_leaves(%sz_2821) : !cute.int_tuple<"1">
        %1609 = cute.static : !cute.layout<"1:0">
        %iter_2823 = cute.get_iter(%view_2792) : !memref_gmem_bf16_12
        %iter_2824 = cute.get_iter(%view_2806) : !memref_smem_bf16_16
        %lay_2825 = cute.get_layout(%view_2792) : !memref_gmem_bf16_12
        %lay_2826 = cute.get_layout(%view_2806) : !memref_smem_bf16_16
        %append_2827 = cute.append_to_rank<2> (%lay_2825, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2828 = cute.append_to_rank<2> (%lay_2826, %1609) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2830 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2831 = cute.size(%lay_2829) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1610 = cute.get_scalars(%sz_2831) : !cute.int_tuple<"1">
        %c0_i32_2832 = arith.constant 0 : i32
        %c1_i32_2833 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2832 to %1610 step %c1_i32_2833  : i32 {
          %coord_2834 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1611 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2835 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2836 = cute.crd2idx(%coord_2834, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2837 = cute.add_offset(%iter_2823, %idx_2836) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2838 = cute.make_view(%ptr_2837, %lay_2835) : !memref_gmem_bf16_10
          %1612 = cute.get_scalars(%coord_2834) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2839 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2840 = cute.crd2idx(%coord_2834, %lay_2830) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2841 = cute.add_offset(%iter_2824, %idx_2840) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2842 = cute.make_view(%ptr_2841, %lay_2839) : !memref_smem_bf16_14
          %iter_2843 = cute.get_iter(%view_2838) : !memref_gmem_bf16_10
          %iter_2844 = cute.get_iter(%view_2842) : !memref_smem_bf16_14
          %iter_2845 = cute.recast_iter(%iter_2843) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2846 = cute.recast_iter(%iter_2844) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2846 : !cute.ptr<i128, smem>, %iter_2845 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2760 = cute.get_layout(%view_631) : !memref_smem_bf16_4
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2762 = cute.get_iter(%view_631) : !memref_smem_bf16_4
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_smem_bf16_14
        %iter_2765 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %iter_2766 = cute.get_iter(%view_2764) : !memref_smem_bf16_14
        %lay_2767 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %sz_2768 = cute.size(%lay_2767) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2769 = cute.get_leaves(%sz_2768) : !cute.int_tuple<"8">
        %lay_2770 = cute.get_layout(%view_2764) : !memref_smem_bf16_14
        %1603 = cute.get_shape(%lay_2770) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2771, %e1_2772 = cute.get_leaves(%1603) : !cute.shape<"((8,1))">
        %int_tuple_2773 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2774 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2775 = cute.get_leaves(%int_tuple_2774) : !cute.int_tuple<"8">
        %cst_2776 = arith.constant 0.000000e+00 : bf16
        %1604 = vector.splat %cst_2776 : vector<8xbf16>
        %int_tuple_2777 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2778 = cute.size(%int_tuple_2777) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2779 = cute.get_leaves(%sz_2778) : !cute.int_tuple<"8">
        %int_tuple_2780 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2781 = cute.size(%int_tuple_2780) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2782 = cute.get_leaves(%sz_2781) : !cute.int_tuple<"8">
        cute.memref.store_vec %1604, %view_2764 : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %int_tuple_2123 = cute.make_int_tuple() : () -> !cute.int_tuple<"-1">
      %tup_2124 = cute.add_offset(%sub_239, %int_tuple_2123) : (!cute.int_tuple<"?">, !cute.int_tuple<"-1">) -> !cute.int_tuple<"?">
      %1341 = cute.get_scalars(%tup_2124) : !cute.int_tuple<"?">
      %1342 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %1343 = cute.get_shape(%1342) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_2125, %e1_2126, %e2_2127, %e3_2128 = cute.get_leaves(%1343) : !cute.shape<"(32,4,1,1)">
      %1344 = cute.get_stride(%1342) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_2129, %e1_2130, %e2_2131, %e3_2132 = cute.get_leaves(%1344) : !cute.stride<"(1,32,0,0)">
      %1345 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_2133, %e1_2134, %e2_2135 = cute.get_leaves(%1345) : !cute.tile<"[64:1;16:1;16:1]">
      %1346 = cute.get_shape(%e0_2133) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_2136 = cute.get_leaves(%1346) : !cute.shape<"64">
      %1347 = cute.get_stride(%e0_2133) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_2137 = cute.get_leaves(%1347) : !cute.stride<"1">
      %1348 = cute.get_shape(%e1_2134) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_2138 = cute.get_leaves(%1348) : !cute.shape<"16">
      %1349 = cute.get_stride(%e1_2134) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_2139 = cute.get_leaves(%1349) : !cute.stride<"1">
      %1350 = cute.get_shape(%e2_2135) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_2140 = cute.get_leaves(%1350) : !cute.shape<"16">
      %1351 = cute.get_stride(%e2_2135) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_2141 = cute.get_leaves(%1351) : !cute.stride<"1">
      %1352 = cute.static : !cute.layout<"32:1">
      %1353 = cute.get_shape(%1352) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_2142 = cute.get_leaves(%1353) : !cute.shape<"32">
      %1354 = cute.get_stride(%1352) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_2143 = cute.get_leaves(%1354) : !cute.stride<"1">
      %1355 = cute.static : !cute.shape<"(16,8,16)">
      %e0_2144, %e1_2145, %e2_2146 = cute.get_leaves(%1355) : !cute.shape<"(16,8,16)">
      %1356 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %1357 = cute.get_shape(%1356) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_2147, %e1_2148, %e2_2149, %e3_2150, %e4_2151 = cute.get_leaves(%1357) : !cute.shape<"((4,8),(2,2,2))">
      %1358 = cute.get_stride(%1356) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_2152, %e1_2153, %e2_2154, %e3_2155, %e4_2156 = cute.get_leaves(%1358) : !cute.stride<"((32,1),(16,8,128))">
      %1359 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %1360 = cute.get_shape(%1359) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_2157, %e1_2158, %e2_2159, %e3_2160 = cute.get_leaves(%1360) : !cute.shape<"((4,8),(2,2))">
      %1361 = cute.get_stride(%1359) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_2161, %e1_2162, %e2_2163, %e3_2164 = cute.get_leaves(%1361) : !cute.stride<"((16,1),(8,64))">
      %1362 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %1363 = cute.get_shape(%1362) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_2165, %e1_2166, %e2_2167, %e3_2168 = cute.get_leaves(%1363) : !cute.shape<"((4,8),(2,2))">
      %1364 = cute.get_stride(%1362) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_2169, %e1_2170, %e2_2171, %e3_2172 = cute.get_leaves(%1364) : !cute.stride<"((32,1),(16,8))">
      %1365 = cute.static : !cute.tile<"[64:1;16:1]">
      %e0_2173, %e1_2174 = cute.get_leaves(%1365) : !cute.tile<"[64:1;16:1]">
      %1366 = cute.get_shape(%e0_2173) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_2175 = cute.get_leaves(%1366) : !cute.shape<"64">
      %1367 = cute.get_stride(%e0_2173) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_2176 = cute.get_leaves(%1367) : !cute.stride<"1">
      %1368 = cute.get_shape(%e1_2174) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_2177 = cute.get_leaves(%1368) : !cute.shape<"16">
      %1369 = cute.get_stride(%e1_2174) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_2178 = cute.get_leaves(%1369) : !cute.stride<"1">
      %1370 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %1371 = cute.get_shape(%1370) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %e0_2179, %e1_2180, %e2_2181, %e3_2182, %e4_2183, %e5, %e6 = cute.get_leaves(%1371) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %1372 = cute.get_stride(%1370) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %e0_2184, %e1_2185, %e2_2186, %e3_2187, %e4_2188, %e5_2189, %e6_2190 = cute.get_leaves(%1372) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %1373 = cute.static : !cute.layout<"32:1">
      %1374 = cute.get_shape(%1373) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_2191 = cute.get_leaves(%1374) : !cute.shape<"32">
      %1375 = cute.get_stride(%1373) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_2192 = cute.get_leaves(%1375) : !cute.stride<"1">
      %1376 = cute.static : !cute.layout<"(32,8):(8,1)">
      %1377 = cute.get_shape(%1376) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
      %e0_2193, %e1_2194 = cute.get_leaves(%1377) : !cute.shape<"(32,8)">
      %1378 = cute.get_stride(%1376) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
      %e0_2195, %e1_2196 = cute.get_leaves(%1378) : !cute.stride<"(8,1)">
      %1379 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
      %1380 = cute.get_shape(%1379) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
      %e0_2197, %e1_2198, %e2_2199 = cute.get_leaves(%1380) : !cute.shape<"(32,(2,4))">
      %1381 = cute.get_stride(%1379) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
      %e0_2200, %e1_2201, %e2_2202 = cute.get_leaves(%1381) : !cute.stride<"(2,(1,64))">
      %c-1_i32 = arith.constant -1 : i32
      %c1_i32 = arith.constant 1 : i32
      %1382:2 = scf.for %arg5 = %c-1_i32 to %153 step %c1_i32 iter_args(%arg6 = %6, %arg7 = %545) -> (!mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3)  : i32 {
        %int_tuple_2759 = cute.make_int_tuple(%arg5) : (i32) -> !cute.int_tuple<"?">
        %sub_2760 = cute.tuple_sub(%tup_2124, %int_tuple_2759) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
        %1603 = cute.get_scalars(%sub_2760) : !cute.int_tuple<"?">
        nvvm.cp.async.wait.group 0
        %c1_i32_2761 = arith.constant 1 : i32
        %c128_i32_2762 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_2761 number_of_threads = %c128_i32_2762
        %1604 = arith.cmpi eq, %1603, %153 : i32
        scf.if %1604 {
          %lay_4014 = cute.get_layout(%view_574) : !memref_smem_bf16_3
          %1825 = cute.get_shape(%lay_4014) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4015, %e1_4016, %e2_4017, %e3_4018 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4,2)">
          %int_tuple_4019 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_4020 = cute.size(%int_tuple_4019) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_4021 = cute.get_leaves(%sz_4020) : !cute.int_tuple<"4">
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_4023 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_4025 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4027 = cute.make_view(%tup_4026) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4028 = cute.get_iter(%view_4027) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4029, %e1_4030, %e2_4031, %e3_4032 = cute.get_leaves(%iter_4028) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1826 = cute.get_scalars(%e0_4029) : !cute.int_tuple<"?">
          %1827 = cute.get_scalars(%e1_4030) : !cute.int_tuple<"?">
          %1828 = cute.get_scalars(%e2_4031) : !cute.int_tuple<"?">
          %1829 = cute.get_scalars(%e3_4032) : !cute.int_tuple<"?{div=8}">
          %iter_4033 = cute.get_iter(%view_4027) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4034, %e1_4035, %e2_4036, %e3_4037 = cute.get_leaves(%iter_4033) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1830 = cute.get_scalars(%e0_4034) : !cute.int_tuple<"?">
          %1831 = cute.get_scalars(%e1_4035) : !cute.int_tuple<"?">
          %1832 = cute.get_scalars(%e2_4036) : !cute.int_tuple<"?">
          %1833 = cute.get_scalars(%e3_4037) : !cute.int_tuple<"?{div=8}">
          %iter_4038 = cute.get_iter(%view_4027) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4039, %e1_4040, %e2_4041, %e3_4042 = cute.get_leaves(%iter_4038) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1834 = cute.get_scalars(%e0_4039) : !cute.int_tuple<"?">
          %1835 = cute.get_scalars(%e1_4040) : !cute.int_tuple<"?">
          %1836 = cute.get_scalars(%e2_4041) : !cute.int_tuple<"?">
          %1837 = cute.get_scalars(%e3_4042) : !cute.int_tuple<"?{div=8}">
          %lay_4043 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1838 = cute.get_shape(%lay_4043) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4044, %e1_4045, %e2_4046, %e3_4047 = cute.get_leaves(%1838) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4048 = cute.to_int_tuple(%e0_4044) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1839 = cute.get_scalars(%itup_4048) : !cute.int_tuple<"?">
          %itup_4049 = cute.to_int_tuple(%e1_4045) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1840 = cute.get_scalars(%itup_4049) : !cute.int_tuple<"?">
          %itup_4050 = cute.to_int_tuple(%e2_4046) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1841 = cute.get_scalars(%itup_4050) : !cute.int_tuple<"?">
          %itup_4051 = cute.to_int_tuple(%e3_4047) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1842 = cute.get_scalars(%itup_4051) : !cute.int_tuple<"?{div=8}">
          %coord_4052 = cute.make_coord(%e1_4040) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4053 = cute.make_coord(%itup_4049) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1843 = cute.get_scalars(%coord_4052) : !cute.coord<"?">
          %1844 = cute.get_scalars(%coord_4053) : !cute.coord<"?">
          %true_4054 = arith.constant true
          %1845 = arith.cmpi slt, %1843, %1844 : i32
          %1846 = arith.andi %true_4054, %1845 : i1
          scf.if %1846 {
            %coord_4154 = cute.make_coord(%sub_2760) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_4155 = cute.get_layout(%view_529) : !memref_gmem_bf16_6
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_4157 = cute.get_iter(%view_529) : !memref_gmem_bf16_6
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_gmem_bf16_8
            %iter_4160 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %iter_4161 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %coord_4162 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4163 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4164 = cute.crd2idx(%coord_4162, %lay_4163) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_4165 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4166 = cute.add_offset(%iter_4165, %idx_4164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4167 = cute.make_view(%ptr_4166) : !memref_smem_bf16_12
            %iter_4168 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %iter_4169 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %coord_4170 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4171 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
            %idx_4172 = cute.crd2idx(%coord_4170, %lay_4171) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4173 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
            %ptr_4174 = cute.add_offset(%iter_4173, %idx_4172) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4175 = cute.make_view(%ptr_4174) : !memref_rmem_i8_1
            %iter_4176 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %iter_4177 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %lay_4178 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %1910 = cute.get_shape(%lay_4178) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4179, %e1_4180, %e2_4181 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %lay_4182 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %1911 = cute.get_shape(%lay_4182) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4183, %e1_4184, %e2_4185 = cute.get_leaves(%1911) : !cute.shape<"((8,1),2)">
            %lay_4186 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %shape_4187 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4188 = cute.make_layout() : !cute.layout<"1:0">
            %append_4189 = cute.append_to_rank<2> (%lay_4186, %lay_4188) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4190 = cute.make_view(%iter_4161, %append_4189) : !memref_gmem_bf16_8
            %iter_4191 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %lay_4192 = cute.get_layout(%view_4190) : !memref_gmem_bf16_8
            %1912 = cute.get_shape(%lay_4192) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4193, %e1_4194, %e2_4195 = cute.get_leaves(%1912) : !cute.shape<"((8,1),2)">
            %iter_4196 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %view_4197 = cute.make_view(%iter_4196) : !memref_gmem_bf16_9
            %iter_4198 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4199 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %lay_4200 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %shape_4201 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4202 = cute.make_layout() : !cute.layout<"1:0">
            %append_4203 = cute.append_to_rank<2> (%lay_4200, %lay_4202) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4204 = cute.make_view(%iter_4169, %append_4203) : !memref_smem_bf16_12
            %iter_4205 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %lay_4206 = cute.get_layout(%view_4204) : !memref_smem_bf16_12
            %1913 = cute.get_shape(%lay_4206) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4207, %e1_4208, %e2_4209 = cute.get_leaves(%1913) : !cute.shape<"((8,1),2)">
            %iter_4210 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %view_4211 = cute.make_view(%iter_4210) : !memref_smem_bf16_13
            %iter_4212 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %iter_4213 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4214 = cute.get_layout(%view_4175) : !memref_rmem_i8_1
            %shape_4215 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4216 = cute.make_layout() : !cute.layout<"1:0">
            %append_4217 = cute.append_to_rank<2> (%lay_4214, %lay_4216) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4218 = cute.make_view(%iter_4177, %append_4217) : !memref_rmem_i8_1
            %iter_4219 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %lay_4220 = cute.get_layout(%view_4218) : !memref_rmem_i8_1
            %1914 = cute.get_shape(%lay_4220) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4221, %e1_4222 = cute.get_leaves(%1914) : !cute.shape<"(1,2)">
            %iter_4223 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %view_4224 = cute.make_view(%iter_4223) : !memref_rmem_i8_2
            %iter_4225 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %iter_4226 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4227 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %1915 = cute.get_shape(%lay_4227) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4228, %e1_4229, %e2_4230 = cute.get_leaves(%1915) : !cute.shape<"((8,1),(2))">
            %lay_4231 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %1916 = cute.get_shape(%lay_4231) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4232, %e1_4233, %e2_4234 = cute.get_leaves(%1916) : !cute.shape<"((8,1),(2))">
            %lay_4235 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %sz_4236 = cute.size(%lay_4235) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4237 = cute.get_leaves(%sz_4236) : !cute.int_tuple<"2">
            %lay_4238 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %sz_4239 = cute.size(%lay_4238) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4240 = cute.get_leaves(%sz_4239) : !cute.int_tuple<"2">
            %1917 = cute.static : !cute.layout<"1:0">
            %iter_4241 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4242 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4243 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %lay_4244 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %append_4245 = cute.append_to_rank<2> (%lay_4243, %1917) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4246 = cute.append_to_rank<2> (%lay_4244, %1917) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4247 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4248 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4249 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4250 = cute.get_layout(%view_4224) : !memref_rmem_i8_2
            %append_4251 = cute.append_to_rank<2> (%lay_4250, %1917) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4252 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4253 = cute.size(%lay_4247) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1918 = cute.get_scalars(%sz_4253) : !cute.int_tuple<"2">
            %c0_i32_4254 = arith.constant 0 : i32
            %c1_i32_4255 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4254 to %1918 step %c1_i32_4255  : i32 {
              %coord_4256 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1919 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4257 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4258 = cute.crd2idx(%coord_4256, %lay_4247) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4259 = cute.add_offset(%iter_4241, %idx_4258) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4260 = cute.make_view(%ptr_4259, %lay_4257) : !memref_gmem_bf16_10
              %1920 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4261 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4262 = cute.crd2idx(%coord_4256, %lay_4248) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4263 = cute.add_offset(%iter_4242, %idx_4262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4264 = cute.make_view(%ptr_4263, %lay_4261) : !memref_smem_bf16_14
              %1921 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4265 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4266 = cute.crd2idx(%coord_4256, %lay_4252) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4267 = cute.add_offset(%iter_4249, %idx_4266) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4268 = cute.make_view(%ptr_4267, %lay_4265) : !memref_rmem_i8_3
              %iter_4269 = cute.get_iter(%view_4260) : !memref_gmem_bf16_10
              %iter_4270 = cute.get_iter(%view_4264) : !memref_smem_bf16_14
              %iter_4271 = cute.get_iter(%view_4268) : !memref_rmem_i8_3
              %1922 = builtin.unrealized_conversion_cast %iter_4271 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1923 = llvm.load %1922 : !llvm.ptr -> i8
              %1924 = llvm.trunc %1923 : i8 to i1
              %iter_4272 = cute.recast_iter(%iter_4269) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4273 = cute.recast_iter(%iter_4270) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4273 : !cute.ptr<i128, smem>, %iter_4272 : !cute.ptr<i128, gmem>, %1924 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4154 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4155 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_4157 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_smem_bf16_12
            %iter_4160 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %iter_4161 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %lay_4162 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %sz_4163 = cute.size(%lay_4162) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4164 = cute.get_leaves(%sz_4163) : !cute.int_tuple<"16">
            %lay_4165 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %1910 = cute.get_shape(%lay_4165) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4166, %e1_4167, %e2_4168 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %int_tuple_4169 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4170 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4171 = cute.get_leaves(%int_tuple_4170) : !cute.int_tuple<"16">
            %cst_4172 = arith.constant 0.000000e+00 : bf16
            %1911 = vector.splat %cst_4172 : vector<16xbf16>
            %int_tuple_4173 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4174 = cute.size(%int_tuple_4173) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4175 = cute.get_leaves(%sz_4174) : !cute.int_tuple<"16">
            %int_tuple_4176 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4177 = cute.size(%int_tuple_4176) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4178 = cute.get_leaves(%sz_4177) : !cute.int_tuple<"16">
            cute.memref.store_vec %1911, %view_4159 : !memref_smem_bf16_12
          }
          %coord_4055 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_4056 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_4057 = cute.crd2idx(%coord_4055, %lay_4056) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_4058 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_4059 = cute.add_offset(%iter_4058, %idx_4057) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4060 = cute.make_view(%tup_4059) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4061 = cute.get_iter(%view_4060) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4062, %e1_4063, %e2_4064, %e3_4065 = cute.get_leaves(%iter_4061) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1847 = cute.get_scalars(%e0_4062) : !cute.int_tuple<"?">
          %1848 = cute.get_scalars(%e1_4063) : !cute.int_tuple<"?">
          %1849 = cute.get_scalars(%e2_4064) : !cute.int_tuple<"?">
          %1850 = cute.get_scalars(%e3_4065) : !cute.int_tuple<"?{div=8}">
          %iter_4066 = cute.get_iter(%view_4060) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4067, %e1_4068, %e2_4069, %e3_4070 = cute.get_leaves(%iter_4066) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1851 = cute.get_scalars(%e0_4067) : !cute.int_tuple<"?">
          %1852 = cute.get_scalars(%e1_4068) : !cute.int_tuple<"?">
          %1853 = cute.get_scalars(%e2_4069) : !cute.int_tuple<"?">
          %1854 = cute.get_scalars(%e3_4070) : !cute.int_tuple<"?{div=8}">
          %iter_4071 = cute.get_iter(%view_4060) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4072, %e1_4073, %e2_4074, %e3_4075 = cute.get_leaves(%iter_4071) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1855 = cute.get_scalars(%e0_4072) : !cute.int_tuple<"?">
          %1856 = cute.get_scalars(%e1_4073) : !cute.int_tuple<"?">
          %1857 = cute.get_scalars(%e2_4074) : !cute.int_tuple<"?">
          %1858 = cute.get_scalars(%e3_4075) : !cute.int_tuple<"?{div=8}">
          %lay_4076 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1859 = cute.get_shape(%lay_4076) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4077, %e1_4078, %e2_4079, %e3_4080 = cute.get_leaves(%1859) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4081 = cute.to_int_tuple(%e0_4077) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1860 = cute.get_scalars(%itup_4081) : !cute.int_tuple<"?">
          %itup_4082 = cute.to_int_tuple(%e1_4078) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1861 = cute.get_scalars(%itup_4082) : !cute.int_tuple<"?">
          %itup_4083 = cute.to_int_tuple(%e2_4079) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1862 = cute.get_scalars(%itup_4083) : !cute.int_tuple<"?">
          %itup_4084 = cute.to_int_tuple(%e3_4080) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1863 = cute.get_scalars(%itup_4084) : !cute.int_tuple<"?{div=8}">
          %coord_4085 = cute.make_coord(%e1_4073) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4086 = cute.make_coord(%itup_4082) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1864 = cute.get_scalars(%coord_4085) : !cute.coord<"?">
          %1865 = cute.get_scalars(%coord_4086) : !cute.coord<"?">
          %true_4087 = arith.constant true
          %1866 = arith.cmpi slt, %1864, %1865 : i32
          %1867 = arith.andi %true_4087, %1866 : i1
          scf.if %1867 {
            %coord_4154 = cute.make_coord(%sub_2760) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_4155 = cute.get_layout(%view_529) : !memref_gmem_bf16_6
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_4157 = cute.get_iter(%view_529) : !memref_gmem_bf16_6
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_gmem_bf16_8
            %iter_4160 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %iter_4161 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %coord_4162 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4163 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4164 = cute.crd2idx(%coord_4162, %lay_4163) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_4165 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4166 = cute.add_offset(%iter_4165, %idx_4164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4167 = cute.make_view(%ptr_4166) : !memref_smem_bf16_12
            %iter_4168 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %iter_4169 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %coord_4170 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4171 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
            %idx_4172 = cute.crd2idx(%coord_4170, %lay_4171) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4173 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
            %ptr_4174 = cute.add_offset(%iter_4173, %idx_4172) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4175 = cute.make_view(%ptr_4174) : !memref_rmem_i8_1
            %iter_4176 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %iter_4177 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %lay_4178 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %1910 = cute.get_shape(%lay_4178) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4179, %e1_4180, %e2_4181 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %lay_4182 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %1911 = cute.get_shape(%lay_4182) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4183, %e1_4184, %e2_4185 = cute.get_leaves(%1911) : !cute.shape<"((8,1),2)">
            %lay_4186 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %shape_4187 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4188 = cute.make_layout() : !cute.layout<"1:0">
            %append_4189 = cute.append_to_rank<2> (%lay_4186, %lay_4188) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4190 = cute.make_view(%iter_4161, %append_4189) : !memref_gmem_bf16_8
            %iter_4191 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %lay_4192 = cute.get_layout(%view_4190) : !memref_gmem_bf16_8
            %1912 = cute.get_shape(%lay_4192) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4193, %e1_4194, %e2_4195 = cute.get_leaves(%1912) : !cute.shape<"((8,1),2)">
            %iter_4196 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %view_4197 = cute.make_view(%iter_4196) : !memref_gmem_bf16_9
            %iter_4198 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4199 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %lay_4200 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %shape_4201 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4202 = cute.make_layout() : !cute.layout<"1:0">
            %append_4203 = cute.append_to_rank<2> (%lay_4200, %lay_4202) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4204 = cute.make_view(%iter_4169, %append_4203) : !memref_smem_bf16_12
            %iter_4205 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %lay_4206 = cute.get_layout(%view_4204) : !memref_smem_bf16_12
            %1913 = cute.get_shape(%lay_4206) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4207, %e1_4208, %e2_4209 = cute.get_leaves(%1913) : !cute.shape<"((8,1),2)">
            %iter_4210 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %view_4211 = cute.make_view(%iter_4210) : !memref_smem_bf16_13
            %iter_4212 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %iter_4213 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4214 = cute.get_layout(%view_4175) : !memref_rmem_i8_1
            %shape_4215 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4216 = cute.make_layout() : !cute.layout<"1:0">
            %append_4217 = cute.append_to_rank<2> (%lay_4214, %lay_4216) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4218 = cute.make_view(%iter_4177, %append_4217) : !memref_rmem_i8_1
            %iter_4219 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %lay_4220 = cute.get_layout(%view_4218) : !memref_rmem_i8_1
            %1914 = cute.get_shape(%lay_4220) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4221, %e1_4222 = cute.get_leaves(%1914) : !cute.shape<"(1,2)">
            %iter_4223 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %view_4224 = cute.make_view(%iter_4223) : !memref_rmem_i8_2
            %iter_4225 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %iter_4226 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4227 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %1915 = cute.get_shape(%lay_4227) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4228, %e1_4229, %e2_4230 = cute.get_leaves(%1915) : !cute.shape<"((8,1),(2))">
            %lay_4231 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %1916 = cute.get_shape(%lay_4231) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4232, %e1_4233, %e2_4234 = cute.get_leaves(%1916) : !cute.shape<"((8,1),(2))">
            %lay_4235 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %sz_4236 = cute.size(%lay_4235) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4237 = cute.get_leaves(%sz_4236) : !cute.int_tuple<"2">
            %lay_4238 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %sz_4239 = cute.size(%lay_4238) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4240 = cute.get_leaves(%sz_4239) : !cute.int_tuple<"2">
            %1917 = cute.static : !cute.layout<"1:0">
            %iter_4241 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4242 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4243 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %lay_4244 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %append_4245 = cute.append_to_rank<2> (%lay_4243, %1917) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4246 = cute.append_to_rank<2> (%lay_4244, %1917) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4247 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4248 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4249 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4250 = cute.get_layout(%view_4224) : !memref_rmem_i8_2
            %append_4251 = cute.append_to_rank<2> (%lay_4250, %1917) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4252 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4253 = cute.size(%lay_4247) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1918 = cute.get_scalars(%sz_4253) : !cute.int_tuple<"2">
            %c0_i32_4254 = arith.constant 0 : i32
            %c1_i32_4255 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4254 to %1918 step %c1_i32_4255  : i32 {
              %coord_4256 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1919 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4257 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4258 = cute.crd2idx(%coord_4256, %lay_4247) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4259 = cute.add_offset(%iter_4241, %idx_4258) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4260 = cute.make_view(%ptr_4259, %lay_4257) : !memref_gmem_bf16_10
              %1920 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4261 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4262 = cute.crd2idx(%coord_4256, %lay_4248) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4263 = cute.add_offset(%iter_4242, %idx_4262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4264 = cute.make_view(%ptr_4263, %lay_4261) : !memref_smem_bf16_14
              %1921 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4265 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4266 = cute.crd2idx(%coord_4256, %lay_4252) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4267 = cute.add_offset(%iter_4249, %idx_4266) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4268 = cute.make_view(%ptr_4267, %lay_4265) : !memref_rmem_i8_3
              %iter_4269 = cute.get_iter(%view_4260) : !memref_gmem_bf16_10
              %iter_4270 = cute.get_iter(%view_4264) : !memref_smem_bf16_14
              %iter_4271 = cute.get_iter(%view_4268) : !memref_rmem_i8_3
              %1922 = builtin.unrealized_conversion_cast %iter_4271 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1923 = llvm.load %1922 : !llvm.ptr -> i8
              %1924 = llvm.trunc %1923 : i8 to i1
              %iter_4272 = cute.recast_iter(%iter_4269) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4273 = cute.recast_iter(%iter_4270) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4273 : !cute.ptr<i128, smem>, %iter_4272 : !cute.ptr<i128, gmem>, %1924 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4154 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4155 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_4157 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_smem_bf16_12
            %iter_4160 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %iter_4161 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %lay_4162 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %sz_4163 = cute.size(%lay_4162) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4164 = cute.get_leaves(%sz_4163) : !cute.int_tuple<"16">
            %lay_4165 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %1910 = cute.get_shape(%lay_4165) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4166, %e1_4167, %e2_4168 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %int_tuple_4169 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4170 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4171 = cute.get_leaves(%int_tuple_4170) : !cute.int_tuple<"16">
            %cst_4172 = arith.constant 0.000000e+00 : bf16
            %1911 = vector.splat %cst_4172 : vector<16xbf16>
            %int_tuple_4173 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4174 = cute.size(%int_tuple_4173) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4175 = cute.get_leaves(%sz_4174) : !cute.int_tuple<"16">
            %int_tuple_4176 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4177 = cute.size(%int_tuple_4176) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4178 = cute.get_leaves(%sz_4177) : !cute.int_tuple<"16">
            cute.memref.store_vec %1911, %view_4159 : !memref_smem_bf16_12
          }
          %coord_4088 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_4089 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_4090 = cute.crd2idx(%coord_4088, %lay_4089) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_4091 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_4092 = cute.add_offset(%iter_4091, %idx_4090) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4093 = cute.make_view(%tup_4092) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4094 = cute.get_iter(%view_4093) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4095, %e1_4096, %e2_4097, %e3_4098 = cute.get_leaves(%iter_4094) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1868 = cute.get_scalars(%e0_4095) : !cute.int_tuple<"?">
          %1869 = cute.get_scalars(%e1_4096) : !cute.int_tuple<"?">
          %1870 = cute.get_scalars(%e2_4097) : !cute.int_tuple<"?">
          %1871 = cute.get_scalars(%e3_4098) : !cute.int_tuple<"?{div=8}">
          %iter_4099 = cute.get_iter(%view_4093) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4100, %e1_4101, %e2_4102, %e3_4103 = cute.get_leaves(%iter_4099) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1872 = cute.get_scalars(%e0_4100) : !cute.int_tuple<"?">
          %1873 = cute.get_scalars(%e1_4101) : !cute.int_tuple<"?">
          %1874 = cute.get_scalars(%e2_4102) : !cute.int_tuple<"?">
          %1875 = cute.get_scalars(%e3_4103) : !cute.int_tuple<"?{div=8}">
          %iter_4104 = cute.get_iter(%view_4093) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4105, %e1_4106, %e2_4107, %e3_4108 = cute.get_leaves(%iter_4104) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1876 = cute.get_scalars(%e0_4105) : !cute.int_tuple<"?">
          %1877 = cute.get_scalars(%e1_4106) : !cute.int_tuple<"?">
          %1878 = cute.get_scalars(%e2_4107) : !cute.int_tuple<"?">
          %1879 = cute.get_scalars(%e3_4108) : !cute.int_tuple<"?{div=8}">
          %lay_4109 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1880 = cute.get_shape(%lay_4109) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4110, %e1_4111, %e2_4112, %e3_4113 = cute.get_leaves(%1880) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4114 = cute.to_int_tuple(%e0_4110) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1881 = cute.get_scalars(%itup_4114) : !cute.int_tuple<"?">
          %itup_4115 = cute.to_int_tuple(%e1_4111) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1882 = cute.get_scalars(%itup_4115) : !cute.int_tuple<"?">
          %itup_4116 = cute.to_int_tuple(%e2_4112) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1883 = cute.get_scalars(%itup_4116) : !cute.int_tuple<"?">
          %itup_4117 = cute.to_int_tuple(%e3_4113) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1884 = cute.get_scalars(%itup_4117) : !cute.int_tuple<"?{div=8}">
          %coord_4118 = cute.make_coord(%e1_4106) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4119 = cute.make_coord(%itup_4115) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1885 = cute.get_scalars(%coord_4118) : !cute.coord<"?">
          %1886 = cute.get_scalars(%coord_4119) : !cute.coord<"?">
          %true_4120 = arith.constant true
          %1887 = arith.cmpi slt, %1885, %1886 : i32
          %1888 = arith.andi %true_4120, %1887 : i1
          scf.if %1888 {
            %coord_4154 = cute.make_coord(%sub_2760) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_4155 = cute.get_layout(%view_529) : !memref_gmem_bf16_6
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_4157 = cute.get_iter(%view_529) : !memref_gmem_bf16_6
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_gmem_bf16_8
            %iter_4160 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %iter_4161 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %coord_4162 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4163 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4164 = cute.crd2idx(%coord_4162, %lay_4163) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_4165 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4166 = cute.add_offset(%iter_4165, %idx_4164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4167 = cute.make_view(%ptr_4166) : !memref_smem_bf16_12
            %iter_4168 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %iter_4169 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %coord_4170 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4171 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
            %idx_4172 = cute.crd2idx(%coord_4170, %lay_4171) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4173 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
            %ptr_4174 = cute.add_offset(%iter_4173, %idx_4172) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4175 = cute.make_view(%ptr_4174) : !memref_rmem_i8_1
            %iter_4176 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %iter_4177 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %lay_4178 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %1910 = cute.get_shape(%lay_4178) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4179, %e1_4180, %e2_4181 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %lay_4182 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %1911 = cute.get_shape(%lay_4182) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4183, %e1_4184, %e2_4185 = cute.get_leaves(%1911) : !cute.shape<"((8,1),2)">
            %lay_4186 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %shape_4187 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4188 = cute.make_layout() : !cute.layout<"1:0">
            %append_4189 = cute.append_to_rank<2> (%lay_4186, %lay_4188) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4190 = cute.make_view(%iter_4161, %append_4189) : !memref_gmem_bf16_8
            %iter_4191 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %lay_4192 = cute.get_layout(%view_4190) : !memref_gmem_bf16_8
            %1912 = cute.get_shape(%lay_4192) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4193, %e1_4194, %e2_4195 = cute.get_leaves(%1912) : !cute.shape<"((8,1),2)">
            %iter_4196 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %view_4197 = cute.make_view(%iter_4196) : !memref_gmem_bf16_9
            %iter_4198 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4199 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %lay_4200 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %shape_4201 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4202 = cute.make_layout() : !cute.layout<"1:0">
            %append_4203 = cute.append_to_rank<2> (%lay_4200, %lay_4202) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4204 = cute.make_view(%iter_4169, %append_4203) : !memref_smem_bf16_12
            %iter_4205 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %lay_4206 = cute.get_layout(%view_4204) : !memref_smem_bf16_12
            %1913 = cute.get_shape(%lay_4206) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4207, %e1_4208, %e2_4209 = cute.get_leaves(%1913) : !cute.shape<"((8,1),2)">
            %iter_4210 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %view_4211 = cute.make_view(%iter_4210) : !memref_smem_bf16_13
            %iter_4212 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %iter_4213 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4214 = cute.get_layout(%view_4175) : !memref_rmem_i8_1
            %shape_4215 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4216 = cute.make_layout() : !cute.layout<"1:0">
            %append_4217 = cute.append_to_rank<2> (%lay_4214, %lay_4216) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4218 = cute.make_view(%iter_4177, %append_4217) : !memref_rmem_i8_1
            %iter_4219 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %lay_4220 = cute.get_layout(%view_4218) : !memref_rmem_i8_1
            %1914 = cute.get_shape(%lay_4220) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4221, %e1_4222 = cute.get_leaves(%1914) : !cute.shape<"(1,2)">
            %iter_4223 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %view_4224 = cute.make_view(%iter_4223) : !memref_rmem_i8_2
            %iter_4225 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %iter_4226 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4227 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %1915 = cute.get_shape(%lay_4227) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4228, %e1_4229, %e2_4230 = cute.get_leaves(%1915) : !cute.shape<"((8,1),(2))">
            %lay_4231 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %1916 = cute.get_shape(%lay_4231) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4232, %e1_4233, %e2_4234 = cute.get_leaves(%1916) : !cute.shape<"((8,1),(2))">
            %lay_4235 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %sz_4236 = cute.size(%lay_4235) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4237 = cute.get_leaves(%sz_4236) : !cute.int_tuple<"2">
            %lay_4238 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %sz_4239 = cute.size(%lay_4238) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4240 = cute.get_leaves(%sz_4239) : !cute.int_tuple<"2">
            %1917 = cute.static : !cute.layout<"1:0">
            %iter_4241 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4242 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4243 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %lay_4244 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %append_4245 = cute.append_to_rank<2> (%lay_4243, %1917) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4246 = cute.append_to_rank<2> (%lay_4244, %1917) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4247 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4248 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4249 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4250 = cute.get_layout(%view_4224) : !memref_rmem_i8_2
            %append_4251 = cute.append_to_rank<2> (%lay_4250, %1917) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4252 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4253 = cute.size(%lay_4247) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1918 = cute.get_scalars(%sz_4253) : !cute.int_tuple<"2">
            %c0_i32_4254 = arith.constant 0 : i32
            %c1_i32_4255 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4254 to %1918 step %c1_i32_4255  : i32 {
              %coord_4256 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1919 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4257 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4258 = cute.crd2idx(%coord_4256, %lay_4247) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4259 = cute.add_offset(%iter_4241, %idx_4258) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4260 = cute.make_view(%ptr_4259, %lay_4257) : !memref_gmem_bf16_10
              %1920 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4261 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4262 = cute.crd2idx(%coord_4256, %lay_4248) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4263 = cute.add_offset(%iter_4242, %idx_4262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4264 = cute.make_view(%ptr_4263, %lay_4261) : !memref_smem_bf16_14
              %1921 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4265 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4266 = cute.crd2idx(%coord_4256, %lay_4252) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4267 = cute.add_offset(%iter_4249, %idx_4266) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4268 = cute.make_view(%ptr_4267, %lay_4265) : !memref_rmem_i8_3
              %iter_4269 = cute.get_iter(%view_4260) : !memref_gmem_bf16_10
              %iter_4270 = cute.get_iter(%view_4264) : !memref_smem_bf16_14
              %iter_4271 = cute.get_iter(%view_4268) : !memref_rmem_i8_3
              %1922 = builtin.unrealized_conversion_cast %iter_4271 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1923 = llvm.load %1922 : !llvm.ptr -> i8
              %1924 = llvm.trunc %1923 : i8 to i1
              %iter_4272 = cute.recast_iter(%iter_4269) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4273 = cute.recast_iter(%iter_4270) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4273 : !cute.ptr<i128, smem>, %iter_4272 : !cute.ptr<i128, gmem>, %1924 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4154 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4155 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_4157 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_smem_bf16_12
            %iter_4160 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %iter_4161 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %lay_4162 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %sz_4163 = cute.size(%lay_4162) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4164 = cute.get_leaves(%sz_4163) : !cute.int_tuple<"16">
            %lay_4165 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %1910 = cute.get_shape(%lay_4165) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4166, %e1_4167, %e2_4168 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %int_tuple_4169 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4170 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4171 = cute.get_leaves(%int_tuple_4170) : !cute.int_tuple<"16">
            %cst_4172 = arith.constant 0.000000e+00 : bf16
            %1911 = vector.splat %cst_4172 : vector<16xbf16>
            %int_tuple_4173 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4174 = cute.size(%int_tuple_4173) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4175 = cute.get_leaves(%sz_4174) : !cute.int_tuple<"16">
            %int_tuple_4176 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4177 = cute.size(%int_tuple_4176) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4178 = cute.get_leaves(%sz_4177) : !cute.int_tuple<"16">
            cute.memref.store_vec %1911, %view_4159 : !memref_smem_bf16_12
          }
          %coord_4121 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_4122 = cute.get_layout(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_4123 = cute.crd2idx(%coord_4121, %lay_4122) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_4124 = cute.get_iter(%view_1226) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_4125 = cute.add_offset(%iter_4124, %idx_4123) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4126 = cute.make_view(%tup_4125) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4127 = cute.get_iter(%view_4126) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4128, %e1_4129, %e2_4130, %e3_4131 = cute.get_leaves(%iter_4127) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1889 = cute.get_scalars(%e0_4128) : !cute.int_tuple<"?">
          %1890 = cute.get_scalars(%e1_4129) : !cute.int_tuple<"?">
          %1891 = cute.get_scalars(%e2_4130) : !cute.int_tuple<"?">
          %1892 = cute.get_scalars(%e3_4131) : !cute.int_tuple<"?{div=8}">
          %iter_4132 = cute.get_iter(%view_4126) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4133, %e1_4134, %e2_4135, %e3_4136 = cute.get_leaves(%iter_4132) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1893 = cute.get_scalars(%e0_4133) : !cute.int_tuple<"?">
          %1894 = cute.get_scalars(%e1_4134) : !cute.int_tuple<"?">
          %1895 = cute.get_scalars(%e2_4135) : !cute.int_tuple<"?">
          %1896 = cute.get_scalars(%e3_4136) : !cute.int_tuple<"?{div=8}">
          %iter_4137 = cute.get_iter(%view_4126) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4138, %e1_4139, %e2_4140, %e3_4141 = cute.get_leaves(%iter_4137) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1897 = cute.get_scalars(%e0_4138) : !cute.int_tuple<"?">
          %1898 = cute.get_scalars(%e1_4139) : !cute.int_tuple<"?">
          %1899 = cute.get_scalars(%e2_4140) : !cute.int_tuple<"?">
          %1900 = cute.get_scalars(%e3_4141) : !cute.int_tuple<"?{div=8}">
          %lay_4142 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1901 = cute.get_shape(%lay_4142) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4143, %e1_4144, %e2_4145, %e3_4146 = cute.get_leaves(%1901) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4147 = cute.to_int_tuple(%e0_4143) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1902 = cute.get_scalars(%itup_4147) : !cute.int_tuple<"?">
          %itup_4148 = cute.to_int_tuple(%e1_4144) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1903 = cute.get_scalars(%itup_4148) : !cute.int_tuple<"?">
          %itup_4149 = cute.to_int_tuple(%e2_4145) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1904 = cute.get_scalars(%itup_4149) : !cute.int_tuple<"?">
          %itup_4150 = cute.to_int_tuple(%e3_4146) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1905 = cute.get_scalars(%itup_4150) : !cute.int_tuple<"?{div=8}">
          %coord_4151 = cute.make_coord(%e1_4139) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4152 = cute.make_coord(%itup_4148) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1906 = cute.get_scalars(%coord_4151) : !cute.coord<"?">
          %1907 = cute.get_scalars(%coord_4152) : !cute.coord<"?">
          %true_4153 = arith.constant true
          %1908 = arith.cmpi slt, %1906, %1907 : i32
          %1909 = arith.andi %true_4153, %1908 : i1
          scf.if %1909 {
            %coord_4154 = cute.make_coord(%sub_2760) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_4155 = cute.get_layout(%view_529) : !memref_gmem_bf16_6
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_4157 = cute.get_iter(%view_529) : !memref_gmem_bf16_6
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_gmem_bf16_8
            %iter_4160 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %iter_4161 = cute.get_iter(%view_4159) : !memref_gmem_bf16_8
            %coord_4162 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4163 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4164 = cute.crd2idx(%coord_4162, %lay_4163) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_4165 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4166 = cute.add_offset(%iter_4165, %idx_4164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4167 = cute.make_view(%ptr_4166) : !memref_smem_bf16_12
            %iter_4168 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %iter_4169 = cute.get_iter(%view_4167) : !memref_smem_bf16_12
            %coord_4170 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4171 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
            %idx_4172 = cute.crd2idx(%coord_4170, %lay_4171) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4173 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
            %ptr_4174 = cute.add_offset(%iter_4173, %idx_4172) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4175 = cute.make_view(%ptr_4174) : !memref_rmem_i8_1
            %iter_4176 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %iter_4177 = cute.get_iter(%view_4175) : !memref_rmem_i8_1
            %lay_4178 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %1910 = cute.get_shape(%lay_4178) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4179, %e1_4180, %e2_4181 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %lay_4182 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %1911 = cute.get_shape(%lay_4182) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4183, %e1_4184, %e2_4185 = cute.get_leaves(%1911) : !cute.shape<"((8,1),2)">
            %lay_4186 = cute.get_layout(%view_4159) : !memref_gmem_bf16_8
            %shape_4187 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4188 = cute.make_layout() : !cute.layout<"1:0">
            %append_4189 = cute.append_to_rank<2> (%lay_4186, %lay_4188) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4190 = cute.make_view(%iter_4161, %append_4189) : !memref_gmem_bf16_8
            %iter_4191 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %lay_4192 = cute.get_layout(%view_4190) : !memref_gmem_bf16_8
            %1912 = cute.get_shape(%lay_4192) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4193, %e1_4194, %e2_4195 = cute.get_leaves(%1912) : !cute.shape<"((8,1),2)">
            %iter_4196 = cute.get_iter(%view_4190) : !memref_gmem_bf16_8
            %view_4197 = cute.make_view(%iter_4196) : !memref_gmem_bf16_9
            %iter_4198 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4199 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %lay_4200 = cute.get_layout(%view_4167) : !memref_smem_bf16_12
            %shape_4201 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4202 = cute.make_layout() : !cute.layout<"1:0">
            %append_4203 = cute.append_to_rank<2> (%lay_4200, %lay_4202) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4204 = cute.make_view(%iter_4169, %append_4203) : !memref_smem_bf16_12
            %iter_4205 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %lay_4206 = cute.get_layout(%view_4204) : !memref_smem_bf16_12
            %1913 = cute.get_shape(%lay_4206) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4207, %e1_4208, %e2_4209 = cute.get_leaves(%1913) : !cute.shape<"((8,1),2)">
            %iter_4210 = cute.get_iter(%view_4204) : !memref_smem_bf16_12
            %view_4211 = cute.make_view(%iter_4210) : !memref_smem_bf16_13
            %iter_4212 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %iter_4213 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4214 = cute.get_layout(%view_4175) : !memref_rmem_i8_1
            %shape_4215 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4216 = cute.make_layout() : !cute.layout<"1:0">
            %append_4217 = cute.append_to_rank<2> (%lay_4214, %lay_4216) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4218 = cute.make_view(%iter_4177, %append_4217) : !memref_rmem_i8_1
            %iter_4219 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %lay_4220 = cute.get_layout(%view_4218) : !memref_rmem_i8_1
            %1914 = cute.get_shape(%lay_4220) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4221, %e1_4222 = cute.get_leaves(%1914) : !cute.shape<"(1,2)">
            %iter_4223 = cute.get_iter(%view_4218) : !memref_rmem_i8_1
            %view_4224 = cute.make_view(%iter_4223) : !memref_rmem_i8_2
            %iter_4225 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %iter_4226 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4227 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %1915 = cute.get_shape(%lay_4227) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4228, %e1_4229, %e2_4230 = cute.get_leaves(%1915) : !cute.shape<"((8,1),(2))">
            %lay_4231 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %1916 = cute.get_shape(%lay_4231) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4232, %e1_4233, %e2_4234 = cute.get_leaves(%1916) : !cute.shape<"((8,1),(2))">
            %lay_4235 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %sz_4236 = cute.size(%lay_4235) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4237 = cute.get_leaves(%sz_4236) : !cute.int_tuple<"2">
            %lay_4238 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %sz_4239 = cute.size(%lay_4238) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4240 = cute.get_leaves(%sz_4239) : !cute.int_tuple<"2">
            %1917 = cute.static : !cute.layout<"1:0">
            %iter_4241 = cute.get_iter(%view_4197) : !memref_gmem_bf16_9
            %iter_4242 = cute.get_iter(%view_4211) : !memref_smem_bf16_13
            %lay_4243 = cute.get_layout(%view_4197) : !memref_gmem_bf16_9
            %lay_4244 = cute.get_layout(%view_4211) : !memref_smem_bf16_13
            %append_4245 = cute.append_to_rank<2> (%lay_4243, %1917) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4246 = cute.append_to_rank<2> (%lay_4244, %1917) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4247 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4248 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4249 = cute.get_iter(%view_4224) : !memref_rmem_i8_2
            %lay_4250 = cute.get_layout(%view_4224) : !memref_rmem_i8_2
            %append_4251 = cute.append_to_rank<2> (%lay_4250, %1917) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4252 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4253 = cute.size(%lay_4247) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1918 = cute.get_scalars(%sz_4253) : !cute.int_tuple<"2">
            %c0_i32_4254 = arith.constant 0 : i32
            %c1_i32_4255 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4254 to %1918 step %c1_i32_4255  : i32 {
              %coord_4256 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1919 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4257 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4258 = cute.crd2idx(%coord_4256, %lay_4247) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4259 = cute.add_offset(%iter_4241, %idx_4258) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4260 = cute.make_view(%ptr_4259, %lay_4257) : !memref_gmem_bf16_10
              %1920 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4261 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4262 = cute.crd2idx(%coord_4256, %lay_4248) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4263 = cute.add_offset(%iter_4242, %idx_4262) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4264 = cute.make_view(%ptr_4263, %lay_4261) : !memref_smem_bf16_14
              %1921 = cute.get_scalars(%coord_4256) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4265 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4266 = cute.crd2idx(%coord_4256, %lay_4252) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4267 = cute.add_offset(%iter_4249, %idx_4266) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4268 = cute.make_view(%ptr_4267, %lay_4265) : !memref_rmem_i8_3
              %iter_4269 = cute.get_iter(%view_4260) : !memref_gmem_bf16_10
              %iter_4270 = cute.get_iter(%view_4264) : !memref_smem_bf16_14
              %iter_4271 = cute.get_iter(%view_4268) : !memref_rmem_i8_3
              %1922 = builtin.unrealized_conversion_cast %iter_4271 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1923 = llvm.load %1922 : !llvm.ptr -> i8
              %1924 = llvm.trunc %1923 : i8 to i1
              %iter_4272 = cute.recast_iter(%iter_4269) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4273 = cute.recast_iter(%iter_4270) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4273 : !cute.ptr<i128, smem>, %iter_4272 : !cute.ptr<i128, gmem>, %1924 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4154 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4155 = cute.get_layout(%view_574) : !memref_smem_bf16_3
            %idx_4156 = cute.crd2idx(%coord_4154, %lay_4155) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_4157 = cute.get_iter(%view_574) : !memref_smem_bf16_3
            %ptr_4158 = cute.add_offset(%iter_4157, %idx_4156) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4159 = cute.make_view(%ptr_4158) : !memref_smem_bf16_12
            %iter_4160 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %iter_4161 = cute.get_iter(%view_4159) : !memref_smem_bf16_12
            %lay_4162 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %sz_4163 = cute.size(%lay_4162) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4164 = cute.get_leaves(%sz_4163) : !cute.int_tuple<"16">
            %lay_4165 = cute.get_layout(%view_4159) : !memref_smem_bf16_12
            %1910 = cute.get_shape(%lay_4165) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4166, %e1_4167, %e2_4168 = cute.get_leaves(%1910) : !cute.shape<"((8,1),2)">
            %int_tuple_4169 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4170 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4171 = cute.get_leaves(%int_tuple_4170) : !cute.int_tuple<"16">
            %cst_4172 = arith.constant 0.000000e+00 : bf16
            %1911 = vector.splat %cst_4172 : vector<16xbf16>
            %int_tuple_4173 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4174 = cute.size(%int_tuple_4173) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4175 = cute.get_leaves(%sz_4174) : !cute.int_tuple<"16">
            %int_tuple_4176 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4177 = cute.size(%int_tuple_4176) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4178 = cute.get_leaves(%sz_4177) : !cute.int_tuple<"16">
            cute.memref.store_vec %1911, %view_4159 : !memref_smem_bf16_12
          }
        } else {
          %coord_4014 = cute.make_coord(%sub_2760) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_4015 = cute.get_layout(%view_529) : !memref_gmem_bf16_6
          %1825:3 = cute.get_scalars(%lay_4015) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %1826 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_4016 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_4017 = cute.assume(%1825#1) : (i64) -> !cute.i64<divby 128>
          %stride_4018 = cute.make_stride(%iv_4017) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_4019 = cute.make_layout(%shape_4016, %stride_4018) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_4020 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_4021 = cute.get_iter(%view_529) : !memref_gmem_bf16_6
          %ptr_4022 = cute.add_offset(%iter_4021, %idx_4020) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_4023 = cute.make_view(%ptr_4022, %lay_4019) : !memref_gmem_bf16_5
          %iter_4024 = cute.get_iter(%view_4023) : !memref_gmem_bf16_5
          %iter_4025 = cute.get_iter(%view_4023) : !memref_gmem_bf16_5
          %coord_4026 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_4027 = cute.get_layout(%view_574) : !memref_smem_bf16_3
          %idx_4028 = cute.crd2idx(%coord_4026, %lay_4027) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_4029 = cute.get_iter(%view_574) : !memref_smem_bf16_3
          %ptr_4030 = cute.add_offset(%iter_4029, %idx_4028) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4031 = cute.make_view(%ptr_4030) : !memref_smem_bf16_3
          %iter_4032 = cute.get_iter(%view_4031) : !memref_smem_bf16_3
          %iter_4033 = cute.get_iter(%view_4031) : !memref_smem_bf16_3
          %coord_4034 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_4035 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
          %idx_4036 = cute.crd2idx(%coord_4034, %lay_4035) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_4037 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
          %ptr_4038 = cute.add_offset(%iter_4037, %idx_4036) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_4039 = cute.make_view(%ptr_4038) : !memref_rmem_i8_
          %iter_4040 = cute.get_iter(%view_4039) : !memref_rmem_i8_
          %iter_4041 = cute.get_iter(%view_4039) : !memref_rmem_i8_
          %lay_4042 = cute.get_layout(%view_4023) : !memref_gmem_bf16_5
          %1827 = cute.get_shape(%lay_4042) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4043, %e1_4044, %e2_4045, %e3_4046 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4,2)">
          %lay_4047 = cute.get_layout(%view_4031) : !memref_smem_bf16_3
          %1828 = cute.get_shape(%lay_4047) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1828) : !cute.shape<"((8,1),4,2)">
          %lay_4052 = cute.get_layout(%view_4023) : !memref_gmem_bf16_5
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4025, %append_4055) : !memref_gmem_bf16_5
          %iter_4057 = cute.get_iter(%view_4056) : !memref_gmem_bf16_5
          %lay_4058 = cute.get_layout(%view_4056) : !memref_gmem_bf16_5
          %1829 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4059, %e1_4060, %e2_4061, %e3_4062 = cute.get_leaves(%1829) : !cute.shape<"((8,1),4,2)">
          %iter_4063 = cute.get_iter(%view_4056) : !memref_gmem_bf16_5
          %lay_4064 = cute.get_layout(%view_4056) : !memref_gmem_bf16_5
          %1830 = cute.get_scalars(%lay_4064) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_4065 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_4066 = cute.assume(%1830) : (i64) -> !cute.i64<divby 128>
          %stride_4067 = cute.make_stride(%iv_4066) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_4068 = cute.make_layout(%shape_4065, %stride_4067) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_4069 = cute.make_view(%iter_4063, %lay_4068) : !memref_gmem_bf16_13
          %iter_4070 = cute.get_iter(%view_4069) : !memref_gmem_bf16_13
          %iter_4071 = cute.get_iter(%view_4069) : !memref_gmem_bf16_13
          %lay_4072 = cute.get_layout(%view_4031) : !memref_smem_bf16_3
          %shape_4073 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4074 = cute.make_layout() : !cute.layout<"1:0">
          %append_4075 = cute.append_to_rank<2> (%lay_4072, %lay_4074) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_4076 = cute.make_view(%iter_4033, %append_4075) : !memref_smem_bf16_3
          %iter_4077 = cute.get_iter(%view_4076) : !memref_smem_bf16_3
          %lay_4078 = cute.get_layout(%view_4076) : !memref_smem_bf16_3
          %1831 = cute.get_shape(%lay_4078) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4079, %e1_4080, %e2_4081, %e3_4082 = cute.get_leaves(%1831) : !cute.shape<"((8,1),4,2)">
          %iter_4083 = cute.get_iter(%view_4076) : !memref_smem_bf16_3
          %view_4084 = cute.make_view(%iter_4083) : !memref_smem_bf16_17
          %iter_4085 = cute.get_iter(%view_4084) : !memref_smem_bf16_17
          %iter_4086 = cute.get_iter(%view_4084) : !memref_smem_bf16_17
          %lay_4087 = cute.get_layout(%view_4039) : !memref_rmem_i8_
          %shape_4088 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4089 = cute.make_layout() : !cute.layout<"1:0">
          %append_4090 = cute.append_to_rank<2> (%lay_4087, %lay_4089) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_4091 = cute.make_view(%iter_4041, %append_4090) : !memref_rmem_i8_
          %iter_4092 = cute.get_iter(%view_4091) : !memref_rmem_i8_
          %lay_4093 = cute.get_layout(%view_4091) : !memref_rmem_i8_
          %1832 = cute.get_shape(%lay_4093) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_4094, %e1_4095, %e2_4096 = cute.get_leaves(%1832) : !cute.shape<"(1,4,2)">
          %iter_4097 = cute.get_iter(%view_4091) : !memref_rmem_i8_
          %view_4098 = cute.make_view(%iter_4097) : !memref_rmem_i8_4
          %iter_4099 = cute.get_iter(%view_4098) : !memref_rmem_i8_4
          %iter_4100 = cute.get_iter(%view_4098) : !memref_rmem_i8_4
          %lay_4101 = cute.get_layout(%view_4069) : !memref_gmem_bf16_13
          %1833 = cute.get_shape(%lay_4101) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4102, %e1_4103, %e2_4104, %e3_4105 = cute.get_leaves(%1833) : !cute.shape<"((8,1),(4,2))">
          %lay_4106 = cute.get_layout(%view_4084) : !memref_smem_bf16_17
          %1834 = cute.get_shape(%lay_4106) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4107, %e1_4108, %e2_4109, %e3_4110 = cute.get_leaves(%1834) : !cute.shape<"((8,1),(4,2))">
          %lay_4111 = cute.get_layout(%view_4069) : !memref_gmem_bf16_13
          %sz_4112 = cute.size(%lay_4111) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_4113 = cute.get_leaves(%sz_4112) : !cute.int_tuple<"8">
          %lay_4114 = cute.get_layout(%view_4084) : !memref_smem_bf16_17
          %sz_4115 = cute.size(%lay_4114) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_4116 = cute.get_leaves(%sz_4115) : !cute.int_tuple<"8">
          %1835 = cute.static : !cute.layout<"1:0">
          %iter_4117 = cute.get_iter(%view_4069) : !memref_gmem_bf16_13
          %iter_4118 = cute.get_iter(%view_4084) : !memref_smem_bf16_17
          %lay_4119 = cute.get_layout(%view_4069) : !memref_gmem_bf16_13
          %lay_4120 = cute.get_layout(%view_4084) : !memref_smem_bf16_17
          %append_4121 = cute.append_to_rank<2> (%lay_4119, %1835) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_4122 = cute.append_to_rank<2> (%lay_4120, %1835) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1836 = cute.get_scalars(%append_4121) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_4123 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_4124 = cute.assume(%1836) : (i64) -> !cute.i64<divby 128>
          %stride_4125 = cute.make_stride(%iv_4124) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_4126 = cute.make_layout(%shape_4123, %stride_4125) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_4127 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_4128 = cute.get_iter(%view_4098) : !memref_rmem_i8_4
          %lay_4129 = cute.get_layout(%view_4098) : !memref_rmem_i8_4
          %append_4130 = cute.append_to_rank<2> (%lay_4129, %1835) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_4131 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_4132 = cute.size(%lay_4126) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1837 = cute.get_scalars(%sz_4132) : !cute.int_tuple<"8">
          %c0_i32_4133 = arith.constant 0 : i32
          %c1_i32_4134 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4133 to %1837 step %c1_i32_4134  : i32 {
            %coord_4135 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1838 = cute.get_scalars(%lay_4126) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %1839 = cute.get_scalars(%coord_4135) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4136 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4137 = cute.crd2idx(%coord_4135, %lay_4126) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_4138 = cute.add_offset(%iter_4117, %idx_4137) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4139 = cute.make_view(%ptr_4138, %lay_4136) : !memref_gmem_bf16_10
            %1840 = cute.get_scalars(%coord_4135) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4140 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4141 = cute.crd2idx(%coord_4135, %lay_4127) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4142 = cute.add_offset(%iter_4118, %idx_4141) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4143 = cute.make_view(%ptr_4142, %lay_4140) : !memref_smem_bf16_14
            %1841 = cute.get_scalars(%coord_4135) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4144 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_4145 = cute.crd2idx(%coord_4135, %lay_4131) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_4146 = cute.add_offset(%iter_4128, %idx_4145) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_4147 = cute.make_view(%ptr_4146, %lay_4144) : !memref_rmem_i8_3
            %iter_4148 = cute.get_iter(%view_4139) : !memref_gmem_bf16_10
            %iter_4149 = cute.get_iter(%view_4143) : !memref_smem_bf16_14
            %iter_4150 = cute.get_iter(%view_4147) : !memref_rmem_i8_3
            %1842 = builtin.unrealized_conversion_cast %iter_4150 : !cute.ptr<i8, rmem> to !llvm.ptr
            %1843 = llvm.load %1842 : !llvm.ptr -> i8
            %1844 = llvm.trunc %1843 : i8 to i1
            %iter_4151 = cute.recast_iter(%iter_4148) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_4152 = cute.recast_iter(%iter_4149) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_4152 : !cute.ptr<i128, smem>, %iter_4151 : !cute.ptr<i128, gmem>, %1844 : i1) {cache_mode = <always>}
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %shape_2763 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %e0_2765, %e1_2766, %e2_2767, %e3_2768 = cute.get_leaves(%shape_2764) : !cute.shape<"((2,2),1,8)">
        %shape_2769 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2770 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2771 = cute.memref.alloca(%lay_2770) : !memref_rmem_f32_1
        %iter_2772 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_2773 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %shape_2774 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %shape_2775 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %e0_2776, %e1_2777, %e2_2778, %e3_2779 = cute.get_leaves(%shape_2775) : !cute.shape<"((2,2),1,8)">
        %shape_2780 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2781 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2782 = cute.memref.alloca(%lay_2781) : !memref_rmem_bf16_6
        %iter_2783 = cute.get_iter(%rmem_2782) : !memref_rmem_bf16_6
        %iter_2784 = cute.get_iter(%rmem_2782) : !memref_rmem_bf16_6
        %iter_2785 = cute.get_iter(%rmem_2782) : !memref_rmem_bf16_6
        %view_2786 = cute.make_view(%iter_2785) : !memref_rmem_bf16_7
        %iter_2787 = cute.get_iter(%view_2786) : !memref_rmem_bf16_7
        %coord_2788 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2789 = cute.get_layout(%view_1029) : !memref_smem_bf16_11
        %1605:2 = cute.get_scalars(%lay_2789) <{only_dynamic}> : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %shape_2790 = cute.make_shape() : () -> !cute.shape<"((8,1),1,(2,2))">
        %iv_2791 = cute.assume(%1605#0) : (i32) -> !cute.i32<divby 16>
        %iv_2792 = cute.assume(%1605#1) : (i32) -> !cute.i32<divby 32>
        %stride_2793 = cute.make_stride(%iv_2791, %iv_2792) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),0,(?{div=16},?{div=32}))">
        %lay_2794 = cute.make_layout(%shape_2790, %stride_2793) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %idx_2795 = cute.crd2idx(%coord_2788, %lay_2789) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.int_tuple<"0">
        %iter_2796 = cute.get_iter(%view_1029) : !memref_smem_bf16_11
        %ptr_2797 = cute.add_offset(%iter_2796, %idx_2795) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2798 = cute.make_view(%ptr_2797, %lay_2794) : !memref_smem_bf16_11
        %iter_2799 = cute.get_iter(%view_2798) : !memref_smem_bf16_11
        %iter_2800 = cute.get_iter(%view_2798) : !memref_smem_bf16_11
        %coord_2801 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2802 = cute.get_layout(%view_2786) : !memref_rmem_bf16_7
        %idx_2803 = cute.crd2idx(%coord_2801, %lay_2802) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.int_tuple<"0">
        %iter_2804 = cute.get_iter(%view_2786) : !memref_rmem_bf16_7
        %ptr_2805 = cute.add_offset(%iter_2804, %idx_2803) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2806 = cute.make_view(%ptr_2805) : !memref_rmem_bf16_7
        %iter_2807 = cute.get_iter(%view_2806) : !memref_rmem_bf16_7
        %iter_2808 = cute.get_iter(%view_2806) : !memref_rmem_bf16_7
        %lay_2809 = cute.get_layout(%view_2798) : !memref_smem_bf16_11
        %1606 = cute.get_shape(%lay_2809) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2810, %e1_2811, %e2_2812, %e3_2813, %e4_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),1,(2,2))">
        %lay_2815 = cute.get_layout(%view_2806) : !memref_rmem_bf16_7
        %1607 = cute.get_shape(%lay_2815) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2816, %e1_2817, %e2_2818, %e3_2819 = cute.get_leaves(%1607) : !cute.shape<"((8,1),1,4)">
        %lay_2820 = cute.get_layout(%view_2798) : !memref_smem_bf16_11
        %shape_2821 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2822 = cute.make_layout() : !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2820, %lay_2822) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">, !cute.layout<"1:0">
        %view_2824 = cute.make_view(%iter_2800, %append_2823) : !memref_smem_bf16_11
        %iter_2825 = cute.get_iter(%view_2824) : !memref_smem_bf16_11
        %lay_2826 = cute.get_layout(%view_2824) : !memref_smem_bf16_11
        %1608 = cute.get_shape(%lay_2826) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2827, %e1_2828, %e2_2829, %e3_2830, %e4_2831 = cute.get_leaves(%1608) : !cute.shape<"((8,1),1,(2,2))">
        %iter_2832 = cute.get_iter(%view_2824) : !memref_smem_bf16_11
        %lay_2833 = cute.get_layout(%view_2824) : !memref_smem_bf16_11
        %1609:2 = cute.get_scalars(%lay_2833) <{only_dynamic}> : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %shape_2834 = cute.make_shape() : () -> !cute.shape<"((8,1),(1,(2,2)))">
        %iv_2835 = cute.assume(%1609#0) : (i32) -> !cute.i32<divby 16>
        %iv_2836 = cute.assume(%1609#1) : (i32) -> !cute.i32<divby 32>
        %stride_2837 = cute.make_stride(%iv_2835, %iv_2836) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(0,(?{div=16},?{div=32})))">
        %lay_2838 = cute.make_layout(%shape_2834, %stride_2837) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %view_2839 = cute.make_view(%iter_2832, %lay_2838) : !memref_smem_bf16_18
        %iter_2840 = cute.get_iter(%view_2839) : !memref_smem_bf16_18
        %iter_2841 = cute.get_iter(%view_2839) : !memref_smem_bf16_18
        %lay_2842 = cute.get_layout(%view_2806) : !memref_rmem_bf16_7
        %shape_2843 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2844 = cute.make_layout() : !cute.layout<"1:0">
        %append_2845 = cute.append_to_rank<2> (%lay_2842, %lay_2844) : !cute.layout<"((8,1),1,4):((1,0),0,8)">, !cute.layout<"1:0">
        %view_2846 = cute.make_view(%iter_2808, %append_2845) : !memref_rmem_bf16_7
        %iter_2847 = cute.get_iter(%view_2846) : !memref_rmem_bf16_7
        %lay_2848 = cute.get_layout(%view_2846) : !memref_rmem_bf16_7
        %1610 = cute.get_shape(%lay_2848) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2849, %e1_2850, %e2_2851, %e3_2852 = cute.get_leaves(%1610) : !cute.shape<"((8,1),1,4)">
        %iter_2853 = cute.get_iter(%view_2846) : !memref_rmem_bf16_7
        %view_2854 = cute.make_view(%iter_2853) : !memref_rmem_bf16_8
        %iter_2855 = cute.get_iter(%view_2854) : !memref_rmem_bf16_8
        %iter_2856 = cute.get_iter(%view_2854) : !memref_rmem_bf16_8
        %lay_2857 = cute.get_layout(%view_2839) : !memref_smem_bf16_18
        %1611 = cute.get_shape(%lay_2857) : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.shape<"((8,1),(1,(2,2)))">
        %e0_2858, %e1_2859, %e2_2860, %e3_2861, %e4_2862 = cute.get_leaves(%1611) : !cute.shape<"((8,1),(1,(2,2)))">
        %lay_2863 = cute.get_layout(%view_2854) : !memref_rmem_bf16_8
        %1612 = cute.get_shape(%lay_2863) : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.shape<"((8,1),(1,4))">
        %e0_2864, %e1_2865, %e2_2866, %e3_2867 = cute.get_leaves(%1612) : !cute.shape<"((8,1),(1,4))">
        %lay_2868 = cute.get_layout(%view_2839) : !memref_smem_bf16_18
        %sz_2869 = cute.size(%lay_2868) <{mode = [1]}> : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.int_tuple<"4">
        %e0_2870 = cute.get_leaves(%sz_2869) : !cute.int_tuple<"4">
        %lay_2871 = cute.get_layout(%view_2854) : !memref_rmem_bf16_8
        %sz_2872 = cute.size(%lay_2871) <{mode = [1]}> : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.int_tuple<"4">
        %e0_2873 = cute.get_leaves(%sz_2872) : !cute.int_tuple<"4">
        %1613 = cute.static : !cute.layout<"1:0">
        %iter_2874 = cute.get_iter(%view_2839) : !memref_smem_bf16_18
        %iter_2875 = cute.get_iter(%view_2854) : !memref_rmem_bf16_8
        %lay_2876 = cute.get_layout(%view_2839) : !memref_smem_bf16_18
        %lay_2877 = cute.get_layout(%view_2854) : !memref_rmem_bf16_8
        %append_2878 = cute.append_to_rank<2> (%lay_2876, %1613) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">, !cute.layout<"1:0">
        %append_2879 = cute.append_to_rank<2> (%lay_2877, %1613) : !cute.layout<"((8,1),(1,4)):((1,0),(0,8))">, !cute.layout<"1:0">
        %1614:2 = cute.get_scalars(%append_2878) <{only_dynamic}> : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %shape_2880 = cute.make_shape() : () -> !cute.shape<"((8,1),((1,(2,2))))">
        %iv_2881 = cute.assume(%1614#0) : (i32) -> !cute.i32<divby 16>
        %iv_2882 = cute.assume(%1614#1) : (i32) -> !cute.i32<divby 32>
        %stride_2883 = cute.make_stride(%iv_2881, %iv_2882) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2884 = cute.make_layout(%shape_2880, %stride_2883) : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2885 = cute.make_layout() : !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">
        %sz_2886 = cute.size(%lay_2884) <{mode = [1]}> : (!cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"4">
        %1615 = cute.get_scalars(%sz_2886) : !cute.int_tuple<"4">
        %c0_i32_2887 = arith.constant 0 : i32
        %c1_i32_2888 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2887 to %1615 step %c1_i32_2888  : i32 {
          %coord_4014 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1825:2 = cute.get_scalars(%lay_2884) <{only_dynamic}> : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">
          %1826 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4015 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_2884) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_4017 = cute.add_offset(%iter_2874, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4018 = cute.make_view(%ptr_4017, %lay_4015) : !memref_smem_bf16_14
          %1827 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4019 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4020 = cute.crd2idx(%coord_4014, %lay_2885) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_4021 = cute.add_offset(%iter_2875, %idx_4020) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4022 = cute.make_view(%ptr_4021, %lay_4019) : !memref_rmem_bf16_9
          %iter_4023 = cute.get_iter(%view_4018) : !memref_smem_bf16_14
          %iter_4024 = cute.get_iter(%view_4022) : !memref_rmem_bf16_9
          %swizzled = cute.apply_swizzle(%iter_4023) : !cute.ptr<bf16, smem, align<16>>
          %1828 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %1829 = llvm.mlir.constant(0 : i32) : i32
          %1830 = vector.extractelement %1828[%1829 : i32] : vector<4xi32>
          %1831 = builtin.unrealized_conversion_cast %iter_4024 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %1830, %1831 : i32, !llvm.ptr
          %1832 = llvm.mlir.constant(1 : i32) : i32
          %1833 = vector.extractelement %1828[%1832 : i32] : vector<4xi32>
          %int_tuple_4025 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_4026 = cute.add_offset(%iter_4024, %int_tuple_4025) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1834 = builtin.unrealized_conversion_cast %ptr_4026 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1833, %1834 : i32, !llvm.ptr
          %1835 = llvm.mlir.constant(2 : i32) : i32
          %1836 = vector.extractelement %1828[%1835 : i32] : vector<4xi32>
          %int_tuple_4027 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_4028 = cute.add_offset(%iter_4024, %int_tuple_4027) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %1837 = builtin.unrealized_conversion_cast %ptr_4028 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1836, %1837 : i32, !llvm.ptr
          %1838 = llvm.mlir.constant(3 : i32) : i32
          %1839 = vector.extractelement %1828[%1838 : i32] : vector<4xi32>
          %int_tuple_4029 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_4030 = cute.add_offset(%iter_4024, %int_tuple_4029) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %1840 = builtin.unrealized_conversion_cast %ptr_4030 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1839, %1840 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2889 = cute.get_layout(%rmem_2782) : !memref_rmem_bf16_6
        %1616 = cute.get_shape(%lay_2889) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2890, %e1_2891, %e2_2892, %e3_2893 = cute.get_leaves(%1616) : !cute.shape<"((2,2),1,8)">
        %1617 = cute.memref.load_vec %rmem_2782 : !memref_rmem_bf16_6
        %1618 = arith.extf %1617 : vector<32xbf16> to vector<32xf32>
        %lay_2894 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1619 = cute.get_shape(%lay_2894) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2895, %e1_2896, %e2_2897, %e3_2898 = cute.get_leaves(%1619) : !cute.shape<"((2,2),1,8)">
        %int_tuple_2899 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2900 = cute.size(%int_tuple_2899) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2901 = cute.get_leaves(%sz_2900) : !cute.int_tuple<"32">
        %int_tuple_2902 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2903 = cute.size(%int_tuple_2902) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2904 = cute.get_leaves(%sz_2903) : !cute.int_tuple<"32">
        cute.memref.store_vec %1618, %rmem_2771 : !memref_rmem_f32_1
        %coord_2905 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2906 = cute.get_layout(%view_879) : !memref_smem_bf16_8
        %idx_2907 = cute.crd2idx(%coord_2905, %lay_2906) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2908 = cute.get_iter(%view_879) : !memref_smem_bf16_8
        %ptr_2909 = cute.add_offset(%iter_2908, %idx_2907) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2910 = cute.make_view(%ptr_2909) : !memref_smem_bf16_15
        %iter_2911 = cute.get_iter(%view_2910) : !memref_smem_bf16_15
        %iter_2912 = cute.get_iter(%view_2910) : !memref_smem_bf16_15
        %coord_2913 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2914 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
        %idx_2915 = cute.crd2idx(%coord_2913, %lay_2914) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"0">
        %iter_2916 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
        %ptr_2917 = cute.add_offset(%iter_2916, %idx_2915) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2918 = cute.make_view(%ptr_2917) : !memref_rmem_bf16_10
        %iter_2919 = cute.get_iter(%view_2918) : !memref_rmem_bf16_10
        %iter_2920 = cute.get_iter(%view_2918) : !memref_rmem_bf16_10
        %lay_2921 = cute.get_layout(%view_2910) : !memref_smem_bf16_15
        %1620 = cute.get_shape(%lay_2921) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2922, %e1_2923, %e2_2924 = cute.get_leaves(%1620) : !cute.shape<"((8,1),1)">
        %lay_2925 = cute.get_layout(%view_2918) : !memref_rmem_bf16_10
        %1621 = cute.get_shape(%lay_2925) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2926, %e1_2927, %e2_2928 = cute.get_leaves(%1621) : !cute.shape<"((8,1),1)">
        %lay_2929 = cute.get_layout(%view_2910) : !memref_smem_bf16_15
        %shape_2930 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2931 = cute.make_layout() : !cute.layout<"1:0">
        %append_2932 = cute.append_to_rank<2> (%lay_2929, %lay_2931) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2933 = cute.make_view(%iter_2912, %append_2932) : !memref_smem_bf16_15
        %iter_2934 = cute.get_iter(%view_2933) : !memref_smem_bf16_15
        %lay_2935 = cute.get_layout(%view_2933) : !memref_smem_bf16_15
        %1622 = cute.get_shape(%lay_2935) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2936, %e1_2937, %e2_2938 = cute.get_leaves(%1622) : !cute.shape<"((8,1),1)">
        %iter_2939 = cute.get_iter(%view_2933) : !memref_smem_bf16_15
        %view_2940 = cute.make_view(%iter_2939) : !memref_smem_bf16_16
        %iter_2941 = cute.get_iter(%view_2940) : !memref_smem_bf16_16
        %iter_2942 = cute.get_iter(%view_2940) : !memref_smem_bf16_16
        %lay_2943 = cute.get_layout(%view_2918) : !memref_rmem_bf16_10
        %shape_2944 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2945 = cute.make_layout() : !cute.layout<"1:0">
        %append_2946 = cute.append_to_rank<2> (%lay_2943, %lay_2945) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2947 = cute.make_view(%iter_2920, %append_2946) : !memref_rmem_bf16_10
        %iter_2948 = cute.get_iter(%view_2947) : !memref_rmem_bf16_10
        %lay_2949 = cute.get_layout(%view_2947) : !memref_rmem_bf16_10
        %1623 = cute.get_shape(%lay_2949) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2950, %e1_2951, %e2_2952 = cute.get_leaves(%1623) : !cute.shape<"((8,1),1)">
        %iter_2953 = cute.get_iter(%view_2947) : !memref_rmem_bf16_10
        %view_2954 = cute.make_view(%iter_2953) : !memref_rmem_bf16_11
        %iter_2955 = cute.get_iter(%view_2954) : !memref_rmem_bf16_11
        %iter_2956 = cute.get_iter(%view_2954) : !memref_rmem_bf16_11
        %lay_2957 = cute.get_layout(%view_2940) : !memref_smem_bf16_16
        %1624 = cute.get_shape(%lay_2957) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2958, %e1_2959, %e2_2960 = cute.get_leaves(%1624) : !cute.shape<"((8,1),(1))">
        %lay_2961 = cute.get_layout(%view_2954) : !memref_rmem_bf16_11
        %1625 = cute.get_shape(%lay_2961) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2962, %e1_2963, %e2_2964 = cute.get_leaves(%1625) : !cute.shape<"((8,1),(1))">
        %lay_2965 = cute.get_layout(%view_2940) : !memref_smem_bf16_16
        %sz_2966 = cute.size(%lay_2965) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2967 = cute.get_leaves(%sz_2966) : !cute.int_tuple<"1">
        %lay_2968 = cute.get_layout(%view_2954) : !memref_rmem_bf16_11
        %sz_2969 = cute.size(%lay_2968) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2970 = cute.get_leaves(%sz_2969) : !cute.int_tuple<"1">
        %1626 = cute.static : !cute.layout<"1:0">
        %iter_2971 = cute.get_iter(%view_2940) : !memref_smem_bf16_16
        %iter_2972 = cute.get_iter(%view_2954) : !memref_rmem_bf16_11
        %lay_2973 = cute.get_layout(%view_2940) : !memref_smem_bf16_16
        %lay_2974 = cute.get_layout(%view_2954) : !memref_rmem_bf16_11
        %append_2975 = cute.append_to_rank<2> (%lay_2973, %1626) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2976 = cute.append_to_rank<2> (%lay_2974, %1626) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2977 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2978 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2979 = cute.size(%lay_2977) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1627 = cute.get_scalars(%sz_2979) : !cute.int_tuple<"1">
        %c0_i32_2980 = arith.constant 0 : i32
        %c1_i32_2981 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2980 to %1627 step %c1_i32_2981  : i32 {
          %coord_4014 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1825 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4015 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_2977) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_4017 = cute.add_offset(%iter_2971, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4018 = cute.make_view(%ptr_4017, %lay_4015) : !memref_smem_bf16_14
          %1826 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4019 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4020 = cute.crd2idx(%coord_4014, %lay_2978) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_4021 = cute.add_offset(%iter_2972, %idx_4020) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4022 = cute.make_view(%ptr_4021, %lay_4019) : !memref_rmem_bf16_9
          %iter_4023 = cute.get_iter(%view_4018) : !memref_smem_bf16_14
          %iter_4024 = cute.get_iter(%view_4022) : !memref_rmem_bf16_9
          %swizzled = cute.apply_swizzle(%iter_4023) : !cute.ptr<bf16, smem, align<16>>
          %1827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %1828 = llvm.mlir.constant(0 : i32) : i32
          %1829 = vector.extractelement %1827[%1828 : i32] : vector<4xi32>
          %1830 = builtin.unrealized_conversion_cast %iter_4024 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %1829, %1830 : i32, !llvm.ptr
          %1831 = llvm.mlir.constant(1 : i32) : i32
          %1832 = vector.extractelement %1827[%1831 : i32] : vector<4xi32>
          %int_tuple_4025 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_4026 = cute.add_offset(%iter_4024, %int_tuple_4025) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1833 = builtin.unrealized_conversion_cast %ptr_4026 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1832, %1833 : i32, !llvm.ptr
          %1834 = llvm.mlir.constant(2 : i32) : i32
          %1835 = vector.extractelement %1827[%1834 : i32] : vector<4xi32>
          %int_tuple_4027 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_4028 = cute.add_offset(%iter_4024, %int_tuple_4027) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %1836 = builtin.unrealized_conversion_cast %ptr_4028 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1835, %1836 : i32, !llvm.ptr
          %1837 = llvm.mlir.constant(3 : i32) : i32
          %1838 = vector.extractelement %1827[%1837 : i32] : vector<4xi32>
          %int_tuple_4029 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_4030 = cute.add_offset(%iter_4024, %int_tuple_4029) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %1839 = builtin.unrealized_conversion_cast %ptr_4030 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1838, %1839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_2982 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2983 = cute.get_layout(%view_936) : !memref_smem_bf16_9
        %idx_2984 = cute.crd2idx(%coord_2982, %lay_2983) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2985 = cute.get_iter(%view_936) : !memref_smem_bf16_9
        %ptr_2986 = cute.add_offset(%iter_2985, %idx_2984) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2987 = cute.make_view(%ptr_2986) : !memref_smem_bf16_19
        %iter_2988 = cute.get_iter(%view_2987) : !memref_smem_bf16_19
        %iter_2989 = cute.get_iter(%view_2987) : !memref_smem_bf16_19
        %coord_2990 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2991 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
        %idx_2992 = cute.crd2idx(%coord_2990, %lay_2991) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"0">
        %iter_2993 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
        %ptr_2994 = cute.add_offset(%iter_2993, %idx_2992) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2995 = cute.make_view(%ptr_2994) : !memref_rmem_bf16_12
        %iter_2996 = cute.get_iter(%view_2995) : !memref_rmem_bf16_12
        %iter_2997 = cute.get_iter(%view_2995) : !memref_rmem_bf16_12
        %lay_2998 = cute.get_layout(%view_2987) : !memref_smem_bf16_19
        %1628 = cute.get_shape(%lay_2998) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2999, %e1_3000, %e2_3001 = cute.get_leaves(%1628) : !cute.shape<"((8,1),4)">
        %lay_3002 = cute.get_layout(%view_2995) : !memref_rmem_bf16_12
        %1629 = cute.get_shape(%lay_3002) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_3003, %e1_3004, %e2_3005, %e3_3006 = cute.get_leaves(%1629) : !cute.shape<"(((4,2),1),4)">
        %lay_3007 = cute.get_layout(%view_2987) : !memref_smem_bf16_19
        %shape_3008 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3009 = cute.make_layout() : !cute.layout<"1:0">
        %append_3010 = cute.append_to_rank<2> (%lay_3007, %lay_3009) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_3011 = cute.make_view(%iter_2989, %append_3010) : !memref_smem_bf16_19
        %iter_3012 = cute.get_iter(%view_3011) : !memref_smem_bf16_19
        %lay_3013 = cute.get_layout(%view_3011) : !memref_smem_bf16_19
        %1630 = cute.get_shape(%lay_3013) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_3014, %e1_3015, %e2_3016 = cute.get_leaves(%1630) : !cute.shape<"((8,1),4)">
        %iter_3017 = cute.get_iter(%view_3011) : !memref_smem_bf16_19
        %view_3018 = cute.make_view(%iter_3017) : !memref_smem_bf16_20
        %iter_3019 = cute.get_iter(%view_3018) : !memref_smem_bf16_20
        %iter_3020 = cute.get_iter(%view_3018) : !memref_smem_bf16_20
        %lay_3021 = cute.get_layout(%view_2995) : !memref_rmem_bf16_12
        %shape_3022 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3023 = cute.make_layout() : !cute.layout<"1:0">
        %append_3024 = cute.append_to_rank<2> (%lay_3021, %lay_3023) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
        %view_3025 = cute.make_view(%iter_2997, %append_3024) : !memref_rmem_bf16_12
        %iter_3026 = cute.get_iter(%view_3025) : !memref_rmem_bf16_12
        %lay_3027 = cute.get_layout(%view_3025) : !memref_rmem_bf16_12
        %1631 = cute.get_shape(%lay_3027) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_3028, %e1_3029, %e2_3030, %e3_3031 = cute.get_leaves(%1631) : !cute.shape<"(((4,2),1),4)">
        %iter_3032 = cute.get_iter(%view_3025) : !memref_rmem_bf16_12
        %view_3033 = cute.make_view(%iter_3032) : !memref_rmem_bf16_13
        %iter_3034 = cute.get_iter(%view_3033) : !memref_rmem_bf16_13
        %iter_3035 = cute.get_iter(%view_3033) : !memref_rmem_bf16_13
        %lay_3036 = cute.get_layout(%view_3018) : !memref_smem_bf16_20
        %1632 = cute.get_shape(%lay_3036) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_3037, %e1_3038, %e2_3039 = cute.get_leaves(%1632) : !cute.shape<"((8,1),(4))">
        %lay_3040 = cute.get_layout(%view_3033) : !memref_rmem_bf16_13
        %1633 = cute.get_shape(%lay_3040) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
        %e0_3041, %e1_3042, %e2_3043, %e3_3044 = cute.get_leaves(%1633) : !cute.shape<"(((4,2),1),(4))">
        %lay_3045 = cute.get_layout(%view_3018) : !memref_smem_bf16_20
        %sz_3046 = cute.size(%lay_3045) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_3047 = cute.get_leaves(%sz_3046) : !cute.int_tuple<"4">
        %lay_3048 = cute.get_layout(%view_3033) : !memref_rmem_bf16_13
        %sz_3049 = cute.size(%lay_3048) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
        %e0_3050 = cute.get_leaves(%sz_3049) : !cute.int_tuple<"4">
        %1634 = cute.static : !cute.layout<"1:0">
        %iter_3051 = cute.get_iter(%view_3018) : !memref_smem_bf16_20
        %iter_3052 = cute.get_iter(%view_3033) : !memref_rmem_bf16_13
        %lay_3053 = cute.get_layout(%view_3018) : !memref_smem_bf16_20
        %lay_3054 = cute.get_layout(%view_3033) : !memref_rmem_bf16_13
        %append_3055 = cute.append_to_rank<2> (%lay_3053, %1634) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_3056 = cute.append_to_rank<2> (%lay_3054, %1634) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
        %lay_3057 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_3058 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
        %sz_3059 = cute.size(%lay_3057) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %1635 = cute.get_scalars(%sz_3059) : !cute.int_tuple<"4">
        %c0_i32_3060 = arith.constant 0 : i32
        %c1_i32_3061 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3060 to %1635 step %c1_i32_3061  : i32 {
          %coord_4014 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1825 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4015 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_3057) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_4017 = cute.add_offset(%iter_3051, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4018 = cute.make_view(%ptr_4017, %lay_4015) : !memref_smem_bf16_14
          %1826 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4019 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
          %idx_4020 = cute.crd2idx(%coord_4014, %lay_3058) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
          %ptr_4021 = cute.add_offset(%iter_3052, %idx_4020) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4022 = cute.make_view(%ptr_4021, %lay_4019) : !memref_rmem_bf16_14
          %iter_4023 = cute.get_iter(%view_4018) : !memref_smem_bf16_14
          %iter_4024 = cute.get_iter(%view_4022) : !memref_rmem_bf16_14
          %swizzled = cute.apply_swizzle(%iter_4023) : !cute.ptr<bf16, smem, align<16>>
          %1827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %1828 = llvm.mlir.constant(0 : i32) : i32
          %1829 = vector.extractelement %1827[%1828 : i32] : vector<4xi32>
          %1830 = builtin.unrealized_conversion_cast %iter_4024 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1829, %1830 : i32, !llvm.ptr
          %1831 = llvm.mlir.constant(1 : i32) : i32
          %1832 = vector.extractelement %1827[%1831 : i32] : vector<4xi32>
          %int_tuple_4025 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_4026 = cute.add_offset(%iter_4024, %int_tuple_4025) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1833 = builtin.unrealized_conversion_cast %ptr_4026 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1832, %1833 : i32, !llvm.ptr
          %1834 = llvm.mlir.constant(2 : i32) : i32
          %1835 = vector.extractelement %1827[%1834 : i32] : vector<4xi32>
          %int_tuple_4027 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
          %ptr_4028 = cute.add_offset(%iter_4024, %int_tuple_4027) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %1836 = builtin.unrealized_conversion_cast %ptr_4028 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1835, %1836 : i32, !llvm.ptr
          %1837 = llvm.mlir.constant(3 : i32) : i32
          %1838 = vector.extractelement %1827[%1837 : i32] : vector<4xi32>
          %int_tuple_4029 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
          %ptr_4030 = cute.add_offset(%iter_4024, %int_tuple_4029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
          %1839 = builtin.unrealized_conversion_cast %ptr_4030 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1838, %1839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_3062 = cute.get_layout(%view_879) : !memref_smem_bf16_8
        %1636 = cute.get_shape(%lay_3062) : (!cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),1,((2,2),2))">
        %e0_3063, %e1_3064, %e2_3065, %e3_3066, %e4_3067, %e5_3068 = cute.get_leaves(%1636) : !cute.shape<"((8,1),1,((2,2),2))">
        %int_tuple_3069 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3070 = cute.size(%int_tuple_3069) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3071 = cute.get_leaves(%sz_3070) : !cute.int_tuple<"8">
        %int_tuple_3072 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3073 = cute.size(%int_tuple_3072) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3074 = cute.get_leaves(%sz_3073) : !cute.int_tuple<"8">
        %true_3075 = arith.constant true
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"64">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3076 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3077 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3078 = cute.crd2idx(%coord_3076, %lay_3077) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"0">
        %iter_3079 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3080 = cute.add_offset(%iter_3079, %idx_3078) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3081 = cute.make_view(%ptr_3080) : !memref_rmem_bf16_15
        %iter_3082 = cute.get_iter(%view_3081) : !memref_rmem_bf16_15
        %iter_3083 = cute.get_iter(%view_3081) : !memref_rmem_bf16_15
        %coord_3084 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3085 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3086 = cute.crd2idx(%coord_3084, %lay_3085) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"0">
        %iter_3087 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3088 = cute.add_offset(%iter_3087, %idx_3086) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3089 = cute.make_view(%ptr_3088) : !memref_rmem_bf16_16
        %iter_3090 = cute.get_iter(%view_3089) : !memref_rmem_bf16_16
        %iter_3091 = cute.get_iter(%view_3089) : !memref_rmem_bf16_16
        %lay_3092 = cute.get_layout(%view_3081) : !memref_rmem_bf16_15
        %1637 = cute.get_shape(%lay_3092) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3093, %e1_3094, %e2_3095, %e3_3096 = cute.get_leaves(%1637) : !cute.shape<"((2,2,2),1)">
        %lay_3097 = cute.get_layout(%view_3089) : !memref_rmem_bf16_16
        %1638 = cute.get_shape(%lay_3097) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3098, %e1_3099, %e2_3100, %e3_3101 = cute.get_leaves(%1638) : !cute.shape<"((2,2),(2,4))">
        %iter_3102 = cute.get_iter(%view_3081) : !memref_rmem_bf16_15
        %iter_3103 = cute.get_iter(%view_3089) : !memref_rmem_bf16_16
        %iter_3104 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3105 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3106 = cute.get_layout(%view_3081) : !memref_rmem_bf16_15
        %lay_3107 = cute.get_layout(%view_3089) : !memref_rmem_bf16_16
        %lay_3108 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3109 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1639 = cute.static : !cute.layout<"1:0">
        %append_3110 = cute.append_to_rank<3> (%lay_3106, %1639) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3111 = cute.append_to_rank<3> (%lay_3107, %1639) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3112 = cute.size(%append_3110) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3113 = cute.size(%append_3110) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3114 = cute.size(%append_3111) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1640 = cute.get_scalars(%sz_3112) : !cute.int_tuple<"1">
        %1641 = cute.get_scalars(%sz_3113) : !cute.int_tuple<"1">
        %1642 = cute.get_scalars(%sz_3114) : !cute.int_tuple<"8">
        %c0_i32_3115 = arith.constant 0 : i32
        %c1_i32_3116 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3115 to %1640 step %c1_i32_3116  : i32 {
          scf.for %arg9 = %c0_i32_3115 to %1641 step %c1_i32_3116  : i32 {
            scf.for %arg10 = %c0_i32_3115 to %1642 step %c1_i32_3116  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3110) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3102, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3111) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3103, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3108) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3104, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3109) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3105, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3117 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3118 = cute.size(%int_tuple_3117) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3119 = cute.get_leaves(%sz_3118) : !cute.int_tuple<"8">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"32">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"128">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3120 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3121 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3122 = cute.crd2idx(%coord_3120, %lay_3121) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"16">
        %iter_3123 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3124 = cute.add_offset(%iter_3123, %idx_3122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3125 = cute.make_view(%ptr_3124) : !memref_rmem_bf16_15
        %iter_3126 = cute.get_iter(%view_3125) : !memref_rmem_bf16_15
        %iter_3127 = cute.get_iter(%view_3125) : !memref_rmem_bf16_15
        %coord_3128 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3129 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3130 = cute.crd2idx(%coord_3128, %lay_3129) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"64">
        %iter_3131 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3132 = cute.add_offset(%iter_3131, %idx_3130) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3133 = cute.make_view(%ptr_3132) : !memref_rmem_bf16_16
        %iter_3134 = cute.get_iter(%view_3133) : !memref_rmem_bf16_16
        %iter_3135 = cute.get_iter(%view_3133) : !memref_rmem_bf16_16
        %lay_3136 = cute.get_layout(%view_3125) : !memref_rmem_bf16_15
        %1643 = cute.get_shape(%lay_3136) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3137, %e1_3138, %e2_3139, %e3_3140 = cute.get_leaves(%1643) : !cute.shape<"((2,2,2),1)">
        %lay_3141 = cute.get_layout(%view_3133) : !memref_rmem_bf16_16
        %1644 = cute.get_shape(%lay_3141) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3142, %e1_3143, %e2_3144, %e3_3145 = cute.get_leaves(%1644) : !cute.shape<"((2,2),(2,4))">
        %iter_3146 = cute.get_iter(%view_3125) : !memref_rmem_bf16_15
        %iter_3147 = cute.get_iter(%view_3133) : !memref_rmem_bf16_16
        %iter_3148 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3149 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3150 = cute.get_layout(%view_3125) : !memref_rmem_bf16_15
        %lay_3151 = cute.get_layout(%view_3133) : !memref_rmem_bf16_16
        %lay_3152 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3153 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1645 = cute.static : !cute.layout<"1:0">
        %append_3154 = cute.append_to_rank<3> (%lay_3150, %1645) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3155 = cute.append_to_rank<3> (%lay_3151, %1645) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3156 = cute.size(%append_3154) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3157 = cute.size(%append_3154) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3158 = cute.size(%append_3155) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1646 = cute.get_scalars(%sz_3156) : !cute.int_tuple<"1">
        %1647 = cute.get_scalars(%sz_3157) : !cute.int_tuple<"1">
        %1648 = cute.get_scalars(%sz_3158) : !cute.int_tuple<"8">
        %c0_i32_3159 = arith.constant 0 : i32
        %c1_i32_3160 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3159 to %1646 step %c1_i32_3160  : i32 {
          scf.for %arg9 = %c0_i32_3159 to %1647 step %c1_i32_3160  : i32 {
            scf.for %arg10 = %c0_i32_3159 to %1648 step %c1_i32_3160  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3154) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3146, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3155) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3147, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3152) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3148, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3153) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3149, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3161 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3162 = cute.size(%int_tuple_3161) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3163 = cute.get_leaves(%sz_3162) : !cute.int_tuple<"8">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"48">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"192">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3164 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3165 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3166 = cute.crd2idx(%coord_3164, %lay_3165) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"32">
        %iter_3167 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3168 = cute.add_offset(%iter_3167, %idx_3166) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3169 = cute.make_view(%ptr_3168) : !memref_rmem_bf16_15
        %iter_3170 = cute.get_iter(%view_3169) : !memref_rmem_bf16_15
        %iter_3171 = cute.get_iter(%view_3169) : !memref_rmem_bf16_15
        %coord_3172 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3173 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3174 = cute.crd2idx(%coord_3172, %lay_3173) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"128">
        %iter_3175 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3176 = cute.add_offset(%iter_3175, %idx_3174) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3177 = cute.make_view(%ptr_3176) : !memref_rmem_bf16_16
        %iter_3178 = cute.get_iter(%view_3177) : !memref_rmem_bf16_16
        %iter_3179 = cute.get_iter(%view_3177) : !memref_rmem_bf16_16
        %lay_3180 = cute.get_layout(%view_3169) : !memref_rmem_bf16_15
        %1649 = cute.get_shape(%lay_3180) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3181, %e1_3182, %e2_3183, %e3_3184 = cute.get_leaves(%1649) : !cute.shape<"((2,2,2),1)">
        %lay_3185 = cute.get_layout(%view_3177) : !memref_rmem_bf16_16
        %1650 = cute.get_shape(%lay_3185) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3186, %e1_3187, %e2_3188, %e3_3189 = cute.get_leaves(%1650) : !cute.shape<"((2,2),(2,4))">
        %iter_3190 = cute.get_iter(%view_3169) : !memref_rmem_bf16_15
        %iter_3191 = cute.get_iter(%view_3177) : !memref_rmem_bf16_16
        %iter_3192 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3193 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3194 = cute.get_layout(%view_3169) : !memref_rmem_bf16_15
        %lay_3195 = cute.get_layout(%view_3177) : !memref_rmem_bf16_16
        %lay_3196 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3197 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1651 = cute.static : !cute.layout<"1:0">
        %append_3198 = cute.append_to_rank<3> (%lay_3194, %1651) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3199 = cute.append_to_rank<3> (%lay_3195, %1651) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3200 = cute.size(%append_3198) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3201 = cute.size(%append_3198) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3202 = cute.size(%append_3199) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1652 = cute.get_scalars(%sz_3200) : !cute.int_tuple<"1">
        %1653 = cute.get_scalars(%sz_3201) : !cute.int_tuple<"1">
        %1654 = cute.get_scalars(%sz_3202) : !cute.int_tuple<"8">
        %c0_i32_3203 = arith.constant 0 : i32
        %c1_i32_3204 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3203 to %1652 step %c1_i32_3204  : i32 {
          scf.for %arg9 = %c0_i32_3203 to %1653 step %c1_i32_3204  : i32 {
            scf.for %arg10 = %c0_i32_3203 to %1654 step %c1_i32_3204  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3198) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3190, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3199) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3191, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3196) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3192, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3197) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3193, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3205 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3206 = cute.size(%int_tuple_3205) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3207 = cute.get_leaves(%sz_3206) : !cute.int_tuple<"8">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"8">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,4)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"16">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3208 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3209 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3210 = cute.crd2idx(%coord_3208, %lay_3209) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"48">
        %iter_3211 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3212 = cute.add_offset(%iter_3211, %idx_3210) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3213 = cute.make_view(%ptr_3212) : !memref_rmem_bf16_15
        %iter_3214 = cute.get_iter(%view_3213) : !memref_rmem_bf16_15
        %iter_3215 = cute.get_iter(%view_3213) : !memref_rmem_bf16_15
        %coord_3216 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3217 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3218 = cute.crd2idx(%coord_3216, %lay_3217) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"192">
        %iter_3219 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3220 = cute.add_offset(%iter_3219, %idx_3218) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3221 = cute.make_view(%ptr_3220) : !memref_rmem_bf16_16
        %iter_3222 = cute.get_iter(%view_3221) : !memref_rmem_bf16_16
        %iter_3223 = cute.get_iter(%view_3221) : !memref_rmem_bf16_16
        %lay_3224 = cute.get_layout(%view_3213) : !memref_rmem_bf16_15
        %1655 = cute.get_shape(%lay_3224) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3225, %e1_3226, %e2_3227, %e3_3228 = cute.get_leaves(%1655) : !cute.shape<"((2,2,2),1)">
        %lay_3229 = cute.get_layout(%view_3221) : !memref_rmem_bf16_16
        %1656 = cute.get_shape(%lay_3229) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3230, %e1_3231, %e2_3232, %e3_3233 = cute.get_leaves(%1656) : !cute.shape<"((2,2),(2,4))">
        %iter_3234 = cute.get_iter(%view_3213) : !memref_rmem_bf16_15
        %iter_3235 = cute.get_iter(%view_3221) : !memref_rmem_bf16_16
        %iter_3236 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3237 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3238 = cute.get_layout(%view_3213) : !memref_rmem_bf16_15
        %lay_3239 = cute.get_layout(%view_3221) : !memref_rmem_bf16_16
        %lay_3240 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3241 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1657 = cute.static : !cute.layout<"1:0">
        %append_3242 = cute.append_to_rank<3> (%lay_3238, %1657) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3243 = cute.append_to_rank<3> (%lay_3239, %1657) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3244 = cute.size(%append_3242) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3245 = cute.size(%append_3242) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3246 = cute.size(%append_3243) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1658 = cute.get_scalars(%sz_3244) : !cute.int_tuple<"1">
        %1659 = cute.get_scalars(%sz_3245) : !cute.int_tuple<"1">
        %1660 = cute.get_scalars(%sz_3246) : !cute.int_tuple<"8">
        %c0_i32_3247 = arith.constant 0 : i32
        %c1_i32_3248 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3247 to %1658 step %c1_i32_3248  : i32 {
          scf.for %arg9 = %c0_i32_3247 to %1659 step %c1_i32_3248  : i32 {
            scf.for %arg10 = %c0_i32_3247 to %1660 step %c1_i32_3248  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3242) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3234, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3243) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3235, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3240) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3236, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3241) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3237, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3249 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3250 = cute.size(%int_tuple_3249) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3251 = cute.get_leaves(%sz_3250) : !cute.int_tuple<"8">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"24">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,5)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"80">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3252 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_3253 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3254 = cute.crd2idx(%coord_3252, %lay_3253) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"8">
        %iter_3255 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3256 = cute.add_offset(%iter_3255, %idx_3254) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3257 = cute.make_view(%ptr_3256) : !memref_rmem_bf16_15
        %iter_3258 = cute.get_iter(%view_3257) : !memref_rmem_bf16_15
        %iter_3259 = cute.get_iter(%view_3257) : !memref_rmem_bf16_15
        %coord_3260 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_3261 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3262 = cute.crd2idx(%coord_3260, %lay_3261) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"16">
        %iter_3263 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3264 = cute.add_offset(%iter_3263, %idx_3262) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3265 = cute.make_view(%ptr_3264) : !memref_rmem_bf16_16
        %iter_3266 = cute.get_iter(%view_3265) : !memref_rmem_bf16_16
        %iter_3267 = cute.get_iter(%view_3265) : !memref_rmem_bf16_16
        %lay_3268 = cute.get_layout(%view_3257) : !memref_rmem_bf16_15
        %1661 = cute.get_shape(%lay_3268) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3269, %e1_3270, %e2_3271, %e3_3272 = cute.get_leaves(%1661) : !cute.shape<"((2,2,2),1)">
        %lay_3273 = cute.get_layout(%view_3265) : !memref_rmem_bf16_16
        %1662 = cute.get_shape(%lay_3273) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3274, %e1_3275, %e2_3276, %e3_3277 = cute.get_leaves(%1662) : !cute.shape<"((2,2),(2,4))">
        %iter_3278 = cute.get_iter(%view_3257) : !memref_rmem_bf16_15
        %iter_3279 = cute.get_iter(%view_3265) : !memref_rmem_bf16_16
        %iter_3280 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3281 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3282 = cute.get_layout(%view_3257) : !memref_rmem_bf16_15
        %lay_3283 = cute.get_layout(%view_3265) : !memref_rmem_bf16_16
        %lay_3284 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3285 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1663 = cute.static : !cute.layout<"1:0">
        %append_3286 = cute.append_to_rank<3> (%lay_3282, %1663) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3287 = cute.append_to_rank<3> (%lay_3283, %1663) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3288 = cute.size(%append_3286) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3289 = cute.size(%append_3286) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3290 = cute.size(%append_3287) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1664 = cute.get_scalars(%sz_3288) : !cute.int_tuple<"1">
        %1665 = cute.get_scalars(%sz_3289) : !cute.int_tuple<"1">
        %1666 = cute.get_scalars(%sz_3290) : !cute.int_tuple<"8">
        %c0_i32_3291 = arith.constant 0 : i32
        %c1_i32_3292 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3291 to %1664 step %c1_i32_3292  : i32 {
          scf.for %arg9 = %c0_i32_3291 to %1665 step %c1_i32_3292  : i32 {
            scf.for %arg10 = %c0_i32_3291 to %1666 step %c1_i32_3292  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3286) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3278, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3287) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3279, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3284) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3280, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3285) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3281, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3293 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3294 = cute.size(%int_tuple_3293) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3295 = cute.get_leaves(%sz_3294) : !cute.int_tuple<"8">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"40">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,6)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"144">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3296 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_3297 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3298 = cute.crd2idx(%coord_3296, %lay_3297) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"24">
        %iter_3299 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3300 = cute.add_offset(%iter_3299, %idx_3298) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3301 = cute.make_view(%ptr_3300) : !memref_rmem_bf16_15
        %iter_3302 = cute.get_iter(%view_3301) : !memref_rmem_bf16_15
        %iter_3303 = cute.get_iter(%view_3301) : !memref_rmem_bf16_15
        %coord_3304 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_3305 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3306 = cute.crd2idx(%coord_3304, %lay_3305) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"80">
        %iter_3307 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3308 = cute.add_offset(%iter_3307, %idx_3306) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3309 = cute.make_view(%ptr_3308) : !memref_rmem_bf16_16
        %iter_3310 = cute.get_iter(%view_3309) : !memref_rmem_bf16_16
        %iter_3311 = cute.get_iter(%view_3309) : !memref_rmem_bf16_16
        %lay_3312 = cute.get_layout(%view_3301) : !memref_rmem_bf16_15
        %1667 = cute.get_shape(%lay_3312) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3313, %e1_3314, %e2_3315, %e3_3316 = cute.get_leaves(%1667) : !cute.shape<"((2,2,2),1)">
        %lay_3317 = cute.get_layout(%view_3309) : !memref_rmem_bf16_16
        %1668 = cute.get_shape(%lay_3317) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3318, %e1_3319, %e2_3320, %e3_3321 = cute.get_leaves(%1668) : !cute.shape<"((2,2),(2,4))">
        %iter_3322 = cute.get_iter(%view_3301) : !memref_rmem_bf16_15
        %iter_3323 = cute.get_iter(%view_3309) : !memref_rmem_bf16_16
        %iter_3324 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3325 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3326 = cute.get_layout(%view_3301) : !memref_rmem_bf16_15
        %lay_3327 = cute.get_layout(%view_3309) : !memref_rmem_bf16_16
        %lay_3328 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3329 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1669 = cute.static : !cute.layout<"1:0">
        %append_3330 = cute.append_to_rank<3> (%lay_3326, %1669) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3331 = cute.append_to_rank<3> (%lay_3327, %1669) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3332 = cute.size(%append_3330) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3333 = cute.size(%append_3330) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3334 = cute.size(%append_3331) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1670 = cute.get_scalars(%sz_3332) : !cute.int_tuple<"1">
        %1671 = cute.get_scalars(%sz_3333) : !cute.int_tuple<"1">
        %1672 = cute.get_scalars(%sz_3334) : !cute.int_tuple<"8">
        %c0_i32_3335 = arith.constant 0 : i32
        %c1_i32_3336 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3335 to %1670 step %c1_i32_3336  : i32 {
          scf.for %arg9 = %c0_i32_3335 to %1671 step %c1_i32_3336  : i32 {
            scf.for %arg10 = %c0_i32_3335 to %1672 step %c1_i32_3336  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3330) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3322, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3331) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3323, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3328) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3324, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3329) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3325, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3337 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3338 = cute.size(%int_tuple_3337) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3339 = cute.get_leaves(%sz_3338) : !cute.int_tuple<"8">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"56">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,7)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"208">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3340 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_3341 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3342 = cute.crd2idx(%coord_3340, %lay_3341) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"40">
        %iter_3343 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3344 = cute.add_offset(%iter_3343, %idx_3342) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3345 = cute.make_view(%ptr_3344) : !memref_rmem_bf16_15
        %iter_3346 = cute.get_iter(%view_3345) : !memref_rmem_bf16_15
        %iter_3347 = cute.get_iter(%view_3345) : !memref_rmem_bf16_15
        %coord_3348 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_3349 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3350 = cute.crd2idx(%coord_3348, %lay_3349) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"144">
        %iter_3351 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3352 = cute.add_offset(%iter_3351, %idx_3350) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3353 = cute.make_view(%ptr_3352) : !memref_rmem_bf16_16
        %iter_3354 = cute.get_iter(%view_3353) : !memref_rmem_bf16_16
        %iter_3355 = cute.get_iter(%view_3353) : !memref_rmem_bf16_16
        %lay_3356 = cute.get_layout(%view_3345) : !memref_rmem_bf16_15
        %1673 = cute.get_shape(%lay_3356) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3357, %e1_3358, %e2_3359, %e3_3360 = cute.get_leaves(%1673) : !cute.shape<"((2,2,2),1)">
        %lay_3361 = cute.get_layout(%view_3353) : !memref_rmem_bf16_16
        %1674 = cute.get_shape(%lay_3361) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3362, %e1_3363, %e2_3364, %e3_3365 = cute.get_leaves(%1674) : !cute.shape<"((2,2),(2,4))">
        %iter_3366 = cute.get_iter(%view_3345) : !memref_rmem_bf16_15
        %iter_3367 = cute.get_iter(%view_3353) : !memref_rmem_bf16_16
        %iter_3368 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3369 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3370 = cute.get_layout(%view_3345) : !memref_rmem_bf16_15
        %lay_3371 = cute.get_layout(%view_3353) : !memref_rmem_bf16_16
        %lay_3372 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3373 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1675 = cute.static : !cute.layout<"1:0">
        %append_3374 = cute.append_to_rank<3> (%lay_3370, %1675) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3375 = cute.append_to_rank<3> (%lay_3371, %1675) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3376 = cute.size(%append_3374) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3377 = cute.size(%append_3374) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3378 = cute.size(%append_3375) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1676 = cute.get_scalars(%sz_3376) : !cute.int_tuple<"1">
        %1677 = cute.get_scalars(%sz_3377) : !cute.int_tuple<"1">
        %1678 = cute.get_scalars(%sz_3378) : !cute.int_tuple<"8">
        %c0_i32_3379 = arith.constant 0 : i32
        %c1_i32_3380 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3379 to %1676 step %c1_i32_3380  : i32 {
          scf.for %arg9 = %c0_i32_3379 to %1677 step %c1_i32_3380  : i32 {
            scf.for %arg10 = %c0_i32_3379 to %1678 step %c1_i32_3380  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3374) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3366, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3375) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3367, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3372) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3368, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3373) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3369, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3381 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3382 = cute.size(%int_tuple_3381) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3383 = cute.get_leaves(%sz_3382) : !cute.int_tuple<"8">
        %false = arith.constant false
        scf.if %false {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_4015 = cute.get_layout(%view_879) : !memref_smem_bf16_8
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_4017 = cute.get_iter(%view_879) : !memref_smem_bf16_8
          %ptr_4018 = cute.add_offset(%iter_4017, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4019 = cute.make_view(%ptr_4018) : !memref_smem_bf16_15
          %iter_4020 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %iter_4021 = cute.get_iter(%view_4019) : !memref_smem_bf16_15
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_4023 = cute.get_layout(%view_882) : !memref_rmem_bf16_3
          %idx_4024 = cute.crd2idx(%coord_4022, %lay_4023) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_4025 = cute.get_iter(%view_882) : !memref_rmem_bf16_3
          %ptr_4026 = cute.add_offset(%iter_4025, %idx_4024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_4027 = cute.make_view(%ptr_4026) : !memref_rmem_bf16_10
          %iter_4028 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %iter_4029 = cute.get_iter(%view_4027) : !memref_rmem_bf16_10
          %lay_4030 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %1825 = cute.get_shape(%lay_4030) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1825) : !cute.shape<"((8,1),1)">
          %lay_4034 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %1826 = cute.get_shape(%lay_4034) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4035, %e1_4036, %e2_4037 = cute.get_leaves(%1826) : !cute.shape<"((8,1),1)">
          %lay_4038 = cute.get_layout(%view_4019) : !memref_smem_bf16_15
          %shape_4039 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4040 = cute.make_layout() : !cute.layout<"1:0">
          %append_4041 = cute.append_to_rank<2> (%lay_4038, %lay_4040) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4042 = cute.make_view(%iter_4021, %append_4041) : !memref_smem_bf16_15
          %iter_4043 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %lay_4044 = cute.get_layout(%view_4042) : !memref_smem_bf16_15
          %1827 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4045, %e1_4046, %e2_4047 = cute.get_leaves(%1827) : !cute.shape<"((8,1),1)">
          %iter_4048 = cute.get_iter(%view_4042) : !memref_smem_bf16_15
          %view_4049 = cute.make_view(%iter_4048) : !memref_smem_bf16_16
          %iter_4050 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4051 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %lay_4052 = cute.get_layout(%view_4027) : !memref_rmem_bf16_10
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4029, %append_4055) : !memref_rmem_bf16_10
          %iter_4057 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %lay_4058 = cute.get_layout(%view_4056) : !memref_rmem_bf16_10
          %1828 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1828) : !cute.shape<"((8,1),1)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_rmem_bf16_10
          %view_4063 = cute.make_view(%iter_4062) : !memref_rmem_bf16_11
          %iter_4064 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %iter_4065 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4066 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %1829 = cute.get_shape(%lay_4066) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4067, %e1_4068, %e2_4069 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(1))">
          %lay_4070 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %1830 = cute.get_shape(%lay_4070) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4071, %e1_4072, %e2_4073 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(1))">
          %lay_4074 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %sz_4075 = cute.size(%lay_4074) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %lay_4077 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %sz_4078 = cute.size(%lay_4077) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"1">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4080 = cute.get_iter(%view_4049) : !memref_smem_bf16_16
          %iter_4081 = cute.get_iter(%view_4063) : !memref_rmem_bf16_11
          %lay_4082 = cute.get_layout(%view_4049) : !memref_smem_bf16_16
          %lay_4083 = cute.get_layout(%view_4063) : !memref_rmem_bf16_11
          %append_4084 = cute.append_to_rank<2> (%lay_4082, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4085 = cute.append_to_rank<2> (%lay_4083, %1831) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4086 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4087 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4088 = cute.size(%lay_4086) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1832 = cute.get_scalars(%sz_4088) : !cute.int_tuple<"1">
          %c0_i32_4089 = arith.constant 0 : i32
          %c1_i32_4090 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4089 to %1832 step %c1_i32_4090  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4086) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4174 = cute.add_offset(%iter_4080, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4087) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4178 = cute.add_offset(%iter_4081, %idx_4177) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_9
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_4092 = cute.get_layout(%view_936) : !memref_smem_bf16_9
          %idx_4093 = cute.crd2idx(%coord_4091, %lay_4092) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_4094 = cute.get_iter(%view_936) : !memref_smem_bf16_9
          %ptr_4095 = cute.add_offset(%iter_4094, %idx_4093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4096 = cute.make_view(%ptr_4095) : !memref_smem_bf16_19
          %iter_4097 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %iter_4098 = cute.get_iter(%view_4096) : !memref_smem_bf16_19
          %coord_4099 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_4100 = cute.get_layout(%view_939) : !memref_rmem_bf16_4
          %idx_4101 = cute.crd2idx(%coord_4099, %lay_4100) : (!cute.coord<"(_,_,8)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"32">
          %iter_4102 = cute.get_iter(%view_939) : !memref_rmem_bf16_4
          %ptr_4103 = cute.add_offset(%iter_4102, %idx_4101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4104 = cute.make_view(%ptr_4103) : !memref_rmem_bf16_12
          %iter_4105 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %iter_4106 = cute.get_iter(%view_4104) : !memref_rmem_bf16_12
          %lay_4107 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %1833 = cute.get_shape(%lay_4107) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4108, %e1_4109, %e2_4110 = cute.get_leaves(%1833) : !cute.shape<"((8,1),4)">
          %lay_4111 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %1834 = cute.get_shape(%lay_4111) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%1834) : !cute.shape<"(((4,2),1),4)">
          %lay_4116 = cute.get_layout(%view_4096) : !memref_smem_bf16_19
          %shape_4117 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4118 = cute.make_layout() : !cute.layout<"1:0">
          %append_4119 = cute.append_to_rank<2> (%lay_4116, %lay_4118) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4120 = cute.make_view(%iter_4098, %append_4119) : !memref_smem_bf16_19
          %iter_4121 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %lay_4122 = cute.get_layout(%view_4120) : !memref_smem_bf16_19
          %1835 = cute.get_shape(%lay_4122) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4123, %e1_4124, %e2_4125 = cute.get_leaves(%1835) : !cute.shape<"((8,1),4)">
          %iter_4126 = cute.get_iter(%view_4120) : !memref_smem_bf16_19
          %view_4127 = cute.make_view(%iter_4126) : !memref_smem_bf16_20
          %iter_4128 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4129 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %lay_4130 = cute.get_layout(%view_4104) : !memref_rmem_bf16_12
          %shape_4131 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4132 = cute.make_layout() : !cute.layout<"1:0">
          %append_4133 = cute.append_to_rank<2> (%lay_4130, %lay_4132) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4134 = cute.make_view(%iter_4106, %append_4133) : !memref_rmem_bf16_12
          %iter_4135 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %lay_4136 = cute.get_layout(%view_4134) : !memref_rmem_bf16_12
          %1836 = cute.get_shape(%lay_4136) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%1836) : !cute.shape<"(((4,2),1),4)">
          %iter_4141 = cute.get_iter(%view_4134) : !memref_rmem_bf16_12
          %view_4142 = cute.make_view(%iter_4141) : !memref_rmem_bf16_13
          %iter_4143 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %iter_4144 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4145 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %1837 = cute.get_shape(%lay_4145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4146, %e1_4147, %e2_4148 = cute.get_leaves(%1837) : !cute.shape<"((8,1),(4))">
          %lay_4149 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %1838 = cute.get_shape(%lay_4149) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1838) : !cute.shape<"(((4,2),1),(4))">
          %lay_4154 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %sz_4155 = cute.size(%lay_4154) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4156 = cute.get_leaves(%sz_4155) : !cute.int_tuple<"4">
          %lay_4157 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %sz_4158 = cute.size(%lay_4157) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4159 = cute.get_leaves(%sz_4158) : !cute.int_tuple<"4">
          %1839 = cute.static : !cute.layout<"1:0">
          %iter_4160 = cute.get_iter(%view_4127) : !memref_smem_bf16_20
          %iter_4161 = cute.get_iter(%view_4142) : !memref_rmem_bf16_13
          %lay_4162 = cute.get_layout(%view_4127) : !memref_smem_bf16_20
          %lay_4163 = cute.get_layout(%view_4142) : !memref_rmem_bf16_13
          %append_4164 = cute.append_to_rank<2> (%lay_4162, %1839) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4165 = cute.append_to_rank<2> (%lay_4163, %1839) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4166 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4167 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4168 = cute.size(%lay_4166) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1840 = cute.get_scalars(%sz_4168) : !cute.int_tuple<"4">
          %c0_i32_4169 = arith.constant 0 : i32
          %c1_i32_4170 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4169 to %1840 step %c1_i32_4170  : i32 {
            %coord_4171 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1841 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4172 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4173 = cute.crd2idx(%coord_4171, %lay_4166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4174 = cute.add_offset(%iter_4160, %idx_4173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4175 = cute.make_view(%ptr_4174, %lay_4172) : !memref_smem_bf16_14
            %1842 = cute.get_scalars(%coord_4171) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4176 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4177 = cute.crd2idx(%coord_4171, %lay_4167) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4178 = cute.add_offset(%iter_4161, %idx_4177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4179 = cute.make_view(%ptr_4178, %lay_4176) : !memref_rmem_bf16_14
            %iter_4180 = cute.get_iter(%view_4175) : !memref_smem_bf16_14
            %iter_4181 = cute.get_iter(%view_4179) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4180) : !cute.ptr<bf16, smem, align<16>>
            %1843 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1844 = llvm.mlir.constant(0 : i32) : i32
            %1845 = vector.extractelement %1843[%1844 : i32] : vector<4xi32>
            %1846 = builtin.unrealized_conversion_cast %iter_4181 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1845, %1846 : i32, !llvm.ptr
            %1847 = llvm.mlir.constant(1 : i32) : i32
            %1848 = vector.extractelement %1843[%1847 : i32] : vector<4xi32>
            %int_tuple_4182 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4183 = cute.add_offset(%iter_4181, %int_tuple_4182) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1849 = builtin.unrealized_conversion_cast %ptr_4183 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1848, %1849 : i32, !llvm.ptr
            %1850 = llvm.mlir.constant(2 : i32) : i32
            %1851 = vector.extractelement %1843[%1850 : i32] : vector<4xi32>
            %int_tuple_4184 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4185 = cute.add_offset(%iter_4181, %int_tuple_4184) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1852 = builtin.unrealized_conversion_cast %ptr_4185 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1851, %1852 : i32, !llvm.ptr
            %1853 = llvm.mlir.constant(3 : i32) : i32
            %1854 = vector.extractelement %1843[%1853 : i32] : vector<4xi32>
            %int_tuple_4186 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4187 = cute.add_offset(%iter_4181, %int_tuple_4186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1855 = builtin.unrealized_conversion_cast %ptr_4187 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1854, %1855 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3384 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_3385 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3386 = cute.crd2idx(%coord_3384, %lay_3385) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"56">
        %iter_3387 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3388 = cute.add_offset(%iter_3387, %idx_3386) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3389 = cute.make_view(%ptr_3388) : !memref_rmem_bf16_15
        %iter_3390 = cute.get_iter(%view_3389) : !memref_rmem_bf16_15
        %iter_3391 = cute.get_iter(%view_3389) : !memref_rmem_bf16_15
        %coord_3392 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_3393 = cute.get_layout(%rmem_734) : !memref_rmem_bf16_1
        %idx_3394 = cute.crd2idx(%coord_3392, %lay_3393) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"208">
        %iter_3395 = cute.get_iter(%rmem_734) : !memref_rmem_bf16_1
        %ptr_3396 = cute.add_offset(%iter_3395, %idx_3394) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3397 = cute.make_view(%ptr_3396) : !memref_rmem_bf16_16
        %iter_3398 = cute.get_iter(%view_3397) : !memref_rmem_bf16_16
        %iter_3399 = cute.get_iter(%view_3397) : !memref_rmem_bf16_16
        %lay_3400 = cute.get_layout(%view_3389) : !memref_rmem_bf16_15
        %1679 = cute.get_shape(%lay_3400) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3401, %e1_3402, %e2_3403, %e3_3404 = cute.get_leaves(%1679) : !cute.shape<"((2,2,2),1)">
        %lay_3405 = cute.get_layout(%view_3397) : !memref_rmem_bf16_16
        %1680 = cute.get_shape(%lay_3405) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3406, %e1_3407, %e2_3408, %e3_3409 = cute.get_leaves(%1680) : !cute.shape<"((2,2),(2,4))">
        %iter_3410 = cute.get_iter(%view_3389) : !memref_rmem_bf16_15
        %iter_3411 = cute.get_iter(%view_3397) : !memref_rmem_bf16_16
        %iter_3412 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %iter_3413 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
        %lay_3414 = cute.get_layout(%view_3389) : !memref_rmem_bf16_15
        %lay_3415 = cute.get_layout(%view_3397) : !memref_rmem_bf16_16
        %lay_3416 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %lay_3417 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1681 = cute.static : !cute.layout<"1:0">
        %append_3418 = cute.append_to_rank<3> (%lay_3414, %1681) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3419 = cute.append_to_rank<3> (%lay_3415, %1681) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3420 = cute.size(%append_3418) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3421 = cute.size(%append_3418) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3422 = cute.size(%append_3419) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1682 = cute.get_scalars(%sz_3420) : !cute.int_tuple<"1">
        %1683 = cute.get_scalars(%sz_3421) : !cute.int_tuple<"1">
        %1684 = cute.get_scalars(%sz_3422) : !cute.int_tuple<"8">
        %c0_i32_3423 = arith.constant 0 : i32
        %c1_i32_3424 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3423 to %1682 step %c1_i32_3424  : i32 {
          scf.for %arg9 = %c0_i32_3423 to %1683 step %c1_i32_3424  : i32 {
            scf.for %arg10 = %c0_i32_3423 to %1684 step %c1_i32_3424  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3418) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3410, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_17
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3419) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3411, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3416) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3412, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3417) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3413, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_17
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_3425 = arith.constant 1 : i32
        %c128_i32_3426 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_3425 number_of_threads = %c128_i32_3426
        %c0_i32_3427 = arith.constant 0 : i32
        %1685 = arith.cmpi sgt, %1603, %c0_i32_3427 : i32
        scf.if %1685 {
          %int_tuple_4014 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_4015 = cute.tuple_sub(%sub_2760, %int_tuple_4014) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1825 = cute.get_scalars(%sub_4015) : !cute.int_tuple<"?">
          %coord_4016 = cute.make_coord(%sub_4015) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_4017 = cute.get_layout(%view_465) : !memref_gmem_bf16_6
          %1826:3 = cute.get_scalars(%lay_4017) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %1827 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_4018 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_4019 = cute.assume(%1826#1) : (i64) -> !cute.i64<divby 128>
          %stride_4020 = cute.make_stride(%iv_4019) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_4021 = cute.make_layout(%shape_4018, %stride_4020) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_4022 = cute.crd2idx(%coord_4016, %lay_4017) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_4023 = cute.get_iter(%view_465) : !memref_gmem_bf16_6
          %ptr_4024 = cute.add_offset(%iter_4023, %idx_4022) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_4025 = cute.make_view(%ptr_4024, %lay_4021) : !memref_gmem_bf16_5
          %iter_4026 = cute.get_iter(%view_4025) : !memref_gmem_bf16_5
          %iter_4027 = cute.get_iter(%view_4025) : !memref_gmem_bf16_5
          %coord_4028 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_4029 = cute.get_layout(%view_510) : !memref_smem_bf16_3
          %idx_4030 = cute.crd2idx(%coord_4028, %lay_4029) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_4031 = cute.get_iter(%view_510) : !memref_smem_bf16_3
          %ptr_4032 = cute.add_offset(%iter_4031, %idx_4030) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4033 = cute.make_view(%ptr_4032) : !memref_smem_bf16_3
          %iter_4034 = cute.get_iter(%view_4033) : !memref_smem_bf16_3
          %iter_4035 = cute.get_iter(%view_4033) : !memref_smem_bf16_3
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_4037 = cute.get_layout(%rmem_1287) : !memref_rmem_i8_
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_4039 = cute.get_iter(%rmem_1287) : !memref_rmem_i8_
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_i8_
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_i8_
          %iter_4043 = cute.get_iter(%view_4041) : !memref_rmem_i8_
          %lay_4044 = cute.get_layout(%view_4025) : !memref_gmem_bf16_5
          %1828 = cute.get_shape(%lay_4044) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4045, %e1_4046, %e2_4047, %e3_4048 = cute.get_leaves(%1828) : !cute.shape<"((8,1),4,2)">
          %lay_4049 = cute.get_layout(%view_4033) : !memref_smem_bf16_3
          %1829 = cute.get_shape(%lay_4049) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4050, %e1_4051, %e2_4052, %e3_4053 = cute.get_leaves(%1829) : !cute.shape<"((8,1),4,2)">
          %lay_4054 = cute.get_layout(%view_4025) : !memref_gmem_bf16_5
          %shape_4055 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4056 = cute.make_layout() : !cute.layout<"1:0">
          %append_4057 = cute.append_to_rank<2> (%lay_4054, %lay_4056) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_4058 = cute.make_view(%iter_4027, %append_4057) : !memref_gmem_bf16_5
          %iter_4059 = cute.get_iter(%view_4058) : !memref_gmem_bf16_5
          %lay_4060 = cute.get_layout(%view_4058) : !memref_gmem_bf16_5
          %1830 = cute.get_shape(%lay_4060) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4061, %e1_4062, %e2_4063, %e3_4064 = cute.get_leaves(%1830) : !cute.shape<"((8,1),4,2)">
          %iter_4065 = cute.get_iter(%view_4058) : !memref_gmem_bf16_5
          %lay_4066 = cute.get_layout(%view_4058) : !memref_gmem_bf16_5
          %1831 = cute.get_scalars(%lay_4066) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_4068 = cute.assume(%1831) : (i64) -> !cute.i64<divby 128>
          %stride_4069 = cute.make_stride(%iv_4068) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_4070 = cute.make_layout(%shape_4067, %stride_4069) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_4071 = cute.make_view(%iter_4065, %lay_4070) : !memref_gmem_bf16_13
          %iter_4072 = cute.get_iter(%view_4071) : !memref_gmem_bf16_13
          %iter_4073 = cute.get_iter(%view_4071) : !memref_gmem_bf16_13
          %lay_4074 = cute.get_layout(%view_4033) : !memref_smem_bf16_3
          %shape_4075 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4076 = cute.make_layout() : !cute.layout<"1:0">
          %append_4077 = cute.append_to_rank<2> (%lay_4074, %lay_4076) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_4078 = cute.make_view(%iter_4035, %append_4077) : !memref_smem_bf16_3
          %iter_4079 = cute.get_iter(%view_4078) : !memref_smem_bf16_3
          %lay_4080 = cute.get_layout(%view_4078) : !memref_smem_bf16_3
          %1832 = cute.get_shape(%lay_4080) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4081, %e1_4082, %e2_4083, %e3_4084 = cute.get_leaves(%1832) : !cute.shape<"((8,1),4,2)">
          %iter_4085 = cute.get_iter(%view_4078) : !memref_smem_bf16_3
          %view_4086 = cute.make_view(%iter_4085) : !memref_smem_bf16_17
          %iter_4087 = cute.get_iter(%view_4086) : !memref_smem_bf16_17
          %iter_4088 = cute.get_iter(%view_4086) : !memref_smem_bf16_17
          %lay_4089 = cute.get_layout(%view_4041) : !memref_rmem_i8_
          %shape_4090 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4091 = cute.make_layout() : !cute.layout<"1:0">
          %append_4092 = cute.append_to_rank<2> (%lay_4089, %lay_4091) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_4093 = cute.make_view(%iter_4043, %append_4092) : !memref_rmem_i8_
          %iter_4094 = cute.get_iter(%view_4093) : !memref_rmem_i8_
          %lay_4095 = cute.get_layout(%view_4093) : !memref_rmem_i8_
          %1833 = cute.get_shape(%lay_4095) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_4096, %e1_4097, %e2_4098 = cute.get_leaves(%1833) : !cute.shape<"(1,4,2)">
          %iter_4099 = cute.get_iter(%view_4093) : !memref_rmem_i8_
          %view_4100 = cute.make_view(%iter_4099) : !memref_rmem_i8_4
          %iter_4101 = cute.get_iter(%view_4100) : !memref_rmem_i8_4
          %iter_4102 = cute.get_iter(%view_4100) : !memref_rmem_i8_4
          %lay_4103 = cute.get_layout(%view_4071) : !memref_gmem_bf16_13
          %1834 = cute.get_shape(%lay_4103) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4104, %e1_4105, %e2_4106, %e3_4107 = cute.get_leaves(%1834) : !cute.shape<"((8,1),(4,2))">
          %lay_4108 = cute.get_layout(%view_4086) : !memref_smem_bf16_17
          %1835 = cute.get_shape(%lay_4108) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4109, %e1_4110, %e2_4111, %e3_4112 = cute.get_leaves(%1835) : !cute.shape<"((8,1),(4,2))">
          %lay_4113 = cute.get_layout(%view_4071) : !memref_gmem_bf16_13
          %sz_4114 = cute.size(%lay_4113) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_4115 = cute.get_leaves(%sz_4114) : !cute.int_tuple<"8">
          %lay_4116 = cute.get_layout(%view_4086) : !memref_smem_bf16_17
          %sz_4117 = cute.size(%lay_4116) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_4118 = cute.get_leaves(%sz_4117) : !cute.int_tuple<"8">
          %1836 = cute.static : !cute.layout<"1:0">
          %iter_4119 = cute.get_iter(%view_4071) : !memref_gmem_bf16_13
          %iter_4120 = cute.get_iter(%view_4086) : !memref_smem_bf16_17
          %lay_4121 = cute.get_layout(%view_4071) : !memref_gmem_bf16_13
          %lay_4122 = cute.get_layout(%view_4086) : !memref_smem_bf16_17
          %append_4123 = cute.append_to_rank<2> (%lay_4121, %1836) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_4124 = cute.append_to_rank<2> (%lay_4122, %1836) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1837 = cute.get_scalars(%append_4123) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_4125 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_4126 = cute.assume(%1837) : (i64) -> !cute.i64<divby 128>
          %stride_4127 = cute.make_stride(%iv_4126) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_4128 = cute.make_layout(%shape_4125, %stride_4127) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_4129 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_4130 = cute.get_iter(%view_4100) : !memref_rmem_i8_4
          %lay_4131 = cute.get_layout(%view_4100) : !memref_rmem_i8_4
          %append_4132 = cute.append_to_rank<2> (%lay_4131, %1836) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_4133 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_4134 = cute.size(%lay_4128) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1838 = cute.get_scalars(%sz_4134) : !cute.int_tuple<"8">
          %c0_i32_4135 = arith.constant 0 : i32
          %c1_i32_4136 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4135 to %1838 step %c1_i32_4136  : i32 {
            %coord_4279 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1925 = cute.get_scalars(%lay_4128) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %1926 = cute.get_scalars(%coord_4279) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4280 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4281 = cute.crd2idx(%coord_4279, %lay_4128) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_4282 = cute.add_offset(%iter_4119, %idx_4281) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4283 = cute.make_view(%ptr_4282, %lay_4280) : !memref_gmem_bf16_10
            %1927 = cute.get_scalars(%coord_4279) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4284 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4285 = cute.crd2idx(%coord_4279, %lay_4129) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4286 = cute.add_offset(%iter_4120, %idx_4285) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4287 = cute.make_view(%ptr_4286, %lay_4284) : !memref_smem_bf16_14
            %1928 = cute.get_scalars(%coord_4279) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4288 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_4289 = cute.crd2idx(%coord_4279, %lay_4133) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_4290 = cute.add_offset(%iter_4130, %idx_4289) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_4291 = cute.make_view(%ptr_4290, %lay_4288) : !memref_rmem_i8_3
            %iter_4292 = cute.get_iter(%view_4283) : !memref_gmem_bf16_10
            %iter_4293 = cute.get_iter(%view_4287) : !memref_smem_bf16_14
            %iter_4294 = cute.get_iter(%view_4291) : !memref_rmem_i8_3
            %1929 = builtin.unrealized_conversion_cast %iter_4294 : !cute.ptr<i8, rmem> to !llvm.ptr
            %1930 = llvm.load %1929 : !llvm.ptr -> i8
            %1931 = llvm.trunc %1930 : i8 to i1
            %iter_4295 = cute.recast_iter(%iter_4292) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_4296 = cute.recast_iter(%iter_4293) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_4296 : !cute.ptr<i128, smem>, %iter_4295 : !cute.ptr<i128, gmem>, %1931 : i1) {cache_mode = <always>}
          } {llvm.loop_annotation = #loop_annotation}
          %lay_4137 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %1839 = cute.get_shape(%lay_4137) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
          %e0_4138, %e1_4139, %e2_4140, %e3_4141, %e4_4142 = cute.get_leaves(%1839) : !cute.shape<"((8,1),4,1,?)">
          %itup_4143 = cute.to_int_tuple(%e4_4142) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1840 = cute.get_scalars(%itup_4143) : !cute.int_tuple<"?">
          %int_tuple_4144 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_4145 = cute.size(%int_tuple_4144) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_4146 = cute.get_leaves(%sz_4145) : !cute.int_tuple<"4">
          %coord_4147 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
          %lay_4148 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4149 = cute.crd2idx(%coord_4147, %lay_4148) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
          %iter_4150 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4151 = cute.add_offset(%iter_4150, %idx_4149) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4152 = cute.make_view(%tup_4151) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4153 = cute.get_iter(%view_4152) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4154, %e1_4155, %e2_4156, %e3_4157 = cute.get_leaves(%iter_4153) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1841 = cute.get_scalars(%e0_4154) : !cute.int_tuple<"?">
          %1842 = cute.get_scalars(%e1_4155) : !cute.int_tuple<"?">
          %1843 = cute.get_scalars(%e2_4156) : !cute.int_tuple<"?">
          %1844 = cute.get_scalars(%e3_4157) : !cute.int_tuple<"?{div=8}">
          %iter_4158 = cute.get_iter(%view_4152) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4159, %e1_4160, %e2_4161, %e3_4162 = cute.get_leaves(%iter_4158) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1845 = cute.get_scalars(%e0_4159) : !cute.int_tuple<"?">
          %1846 = cute.get_scalars(%e1_4160) : !cute.int_tuple<"?">
          %1847 = cute.get_scalars(%e2_4161) : !cute.int_tuple<"?">
          %1848 = cute.get_scalars(%e3_4162) : !cute.int_tuple<"?{div=8}">
          %iter_4163 = cute.get_iter(%view_4152) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4164, %e1_4165, %e2_4166, %e3_4167 = cute.get_leaves(%iter_4163) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1849 = cute.get_scalars(%e0_4164) : !cute.int_tuple<"?">
          %1850 = cute.get_scalars(%e1_4165) : !cute.int_tuple<"?">
          %1851 = cute.get_scalars(%e2_4166) : !cute.int_tuple<"?">
          %1852 = cute.get_scalars(%e3_4167) : !cute.int_tuple<"?{div=8}">
          %lay_4168 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1853 = cute.get_shape(%lay_4168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4169, %e1_4170, %e2_4171, %e3_4172 = cute.get_leaves(%1853) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4173 = cute.to_int_tuple(%e0_4169) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1854 = cute.get_scalars(%itup_4173) : !cute.int_tuple<"?">
          %itup_4174 = cute.to_int_tuple(%e1_4170) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1855 = cute.get_scalars(%itup_4174) : !cute.int_tuple<"?">
          %itup_4175 = cute.to_int_tuple(%e2_4171) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1856 = cute.get_scalars(%itup_4175) : !cute.int_tuple<"?">
          %itup_4176 = cute.to_int_tuple(%e3_4172) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1857 = cute.get_scalars(%itup_4176) : !cute.int_tuple<"?{div=8}">
          %coord_4177 = cute.make_coord(%e1_4165) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4178 = cute.make_coord(%itup_4175) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1858 = cute.get_scalars(%coord_4177) : !cute.coord<"?">
          %1859 = cute.get_scalars(%coord_4178) : !cute.coord<"?">
          %true_4179 = arith.constant true
          %1860 = arith.cmpi slt, %1858, %1859 : i32
          %1861 = arith.andi %true_4179, %1860 : i1
          scf.if %1861 {
            %int_tuple_4279 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4280 = cute.tuple_sub(%sub_2760, %int_tuple_4279) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1925 = cute.get_scalars(%sub_4280) : !cute.int_tuple<"?">
            %coord_4281 = cute.make_coord(%sub_4280) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_4282 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
            %idx_4283 = cute.crd2idx(%coord_4281, %lay_4282) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
            %iter_4284 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
            %ptr_4285 = cute.add_offset(%iter_4284, %idx_4283) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4286 = cute.make_view(%ptr_4285) : !memref_gmem_bf16_11
            %iter_4287 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %iter_4288 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %coord_4289 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4290 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4291 = cute.crd2idx(%coord_4289, %lay_4290) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_4292 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4293 = cute.add_offset(%iter_4292, %idx_4291) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4294 = cute.make_view(%ptr_4293) : !memref_smem_bf16_15
            %iter_4295 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %iter_4296 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %lay_4297 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %1926 = cute.get_shape(%lay_4297) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4298, %e1_4299, %e2_4300 = cute.get_leaves(%1926) : !cute.shape<"((8,1),1)">
            %lay_4301 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %1927 = cute.get_shape(%lay_4301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4302, %e1_4303, %e2_4304 = cute.get_leaves(%1927) : !cute.shape<"((8,1),1)">
            %lay_4305 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %shape_4306 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4307 = cute.make_layout() : !cute.layout<"1:0">
            %append_4308 = cute.append_to_rank<2> (%lay_4305, %lay_4307) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4309 = cute.make_view(%iter_4288, %append_4308) : !memref_gmem_bf16_11
            %iter_4310 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %lay_4311 = cute.get_layout(%view_4309) : !memref_gmem_bf16_11
            %1928 = cute.get_shape(%lay_4311) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4312, %e1_4313, %e2_4314 = cute.get_leaves(%1928) : !cute.shape<"((8,1),1)">
            %iter_4315 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %view_4316 = cute.make_view(%iter_4315) : !memref_gmem_bf16_12
            %iter_4317 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4318 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %lay_4319 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %shape_4320 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4321 = cute.make_layout() : !cute.layout<"1:0">
            %append_4322 = cute.append_to_rank<2> (%lay_4319, %lay_4321) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4323 = cute.make_view(%iter_4296, %append_4322) : !memref_smem_bf16_15
            %iter_4324 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %lay_4325 = cute.get_layout(%view_4323) : !memref_smem_bf16_15
            %1929 = cute.get_shape(%lay_4325) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4326, %e1_4327, %e2_4328 = cute.get_leaves(%1929) : !cute.shape<"((8,1),1)">
            %iter_4329 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %view_4330 = cute.make_view(%iter_4329) : !memref_smem_bf16_16
            %iter_4331 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %iter_4332 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4333 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %1930 = cute.get_shape(%lay_4333) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4334, %e1_4335, %e2_4336 = cute.get_leaves(%1930) : !cute.shape<"((8,1),(1))">
            %lay_4337 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %1931 = cute.get_shape(%lay_4337) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4338, %e1_4339, %e2_4340 = cute.get_leaves(%1931) : !cute.shape<"((8,1),(1))">
            %lay_4341 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %sz_4342 = cute.size(%lay_4341) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4343 = cute.get_leaves(%sz_4342) : !cute.int_tuple<"1">
            %lay_4344 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %sz_4345 = cute.size(%lay_4344) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4346 = cute.get_leaves(%sz_4345) : !cute.int_tuple<"1">
            %1932 = cute.static : !cute.layout<"1:0">
            %iter_4347 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4348 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4349 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %lay_4350 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %append_4351 = cute.append_to_rank<2> (%lay_4349, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4352 = cute.append_to_rank<2> (%lay_4350, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4353 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4354 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4355 = cute.size(%lay_4353) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1933 = cute.get_scalars(%sz_4355) : !cute.int_tuple<"1">
            %c0_i32_4356 = arith.constant 0 : i32
            %c1_i32_4357 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4356 to %1933 step %c1_i32_4357  : i32 {
              %coord_4358 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1934 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4359 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4360 = cute.crd2idx(%coord_4358, %lay_4353) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4361 = cute.add_offset(%iter_4347, %idx_4360) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4362 = cute.make_view(%ptr_4361, %lay_4359) : !memref_gmem_bf16_10
              %1935 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4363 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4364 = cute.crd2idx(%coord_4358, %lay_4354) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4365 = cute.add_offset(%iter_4348, %idx_4364) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4366 = cute.make_view(%ptr_4365, %lay_4363) : !memref_smem_bf16_14
              %iter_4367 = cute.get_iter(%view_4362) : !memref_gmem_bf16_10
              %iter_4368 = cute.get_iter(%view_4366) : !memref_smem_bf16_14
              %iter_4369 = cute.recast_iter(%iter_4367) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4370 = cute.recast_iter(%iter_4368) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4370 : !cute.ptr<i128, smem>, %iter_4369 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4279 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4280 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4281 = cute.crd2idx(%coord_4279, %lay_4280) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_4282 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4283 = cute.add_offset(%iter_4282, %idx_4281) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4284 = cute.make_view(%ptr_4283) : !memref_smem_bf16_15
            %iter_4285 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %iter_4286 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %lay_4287 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %sz_4288 = cute.size(%lay_4287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4289 = cute.get_leaves(%sz_4288) : !cute.int_tuple<"8">
            %lay_4290 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %1925 = cute.get_shape(%lay_4290) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4291, %e1_4292, %e2_4293 = cute.get_leaves(%1925) : !cute.shape<"((8,1),1)">
            %int_tuple_4294 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4295 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4296 = cute.get_leaves(%int_tuple_4295) : !cute.int_tuple<"8">
            %cst_4297 = arith.constant 0.000000e+00 : bf16
            %1926 = vector.splat %cst_4297 : vector<8xbf16>
            %int_tuple_4298 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4299 = cute.size(%int_tuple_4298) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4300 = cute.get_leaves(%sz_4299) : !cute.int_tuple<"8">
            %int_tuple_4301 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4302 = cute.size(%int_tuple_4301) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4303 = cute.get_leaves(%sz_4302) : !cute.int_tuple<"8">
            cute.memref.store_vec %1926, %view_4284 : !memref_smem_bf16_15
          }
          %coord_4180 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
          %lay_4181 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4182 = cute.crd2idx(%coord_4180, %lay_4181) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
          %iter_4183 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4184 = cute.add_offset(%iter_4183, %idx_4182) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4185 = cute.make_view(%tup_4184) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4186 = cute.get_iter(%view_4185) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4187, %e1_4188, %e2_4189, %e3_4190 = cute.get_leaves(%iter_4186) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1862 = cute.get_scalars(%e0_4187) : !cute.int_tuple<"?">
          %1863 = cute.get_scalars(%e1_4188) : !cute.int_tuple<"?">
          %1864 = cute.get_scalars(%e2_4189) : !cute.int_tuple<"?">
          %1865 = cute.get_scalars(%e3_4190) : !cute.int_tuple<"?{div=8}">
          %iter_4191 = cute.get_iter(%view_4185) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4192, %e1_4193, %e2_4194, %e3_4195 = cute.get_leaves(%iter_4191) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1866 = cute.get_scalars(%e0_4192) : !cute.int_tuple<"?">
          %1867 = cute.get_scalars(%e1_4193) : !cute.int_tuple<"?">
          %1868 = cute.get_scalars(%e2_4194) : !cute.int_tuple<"?">
          %1869 = cute.get_scalars(%e3_4195) : !cute.int_tuple<"?{div=8}">
          %iter_4196 = cute.get_iter(%view_4185) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4197, %e1_4198, %e2_4199, %e3_4200 = cute.get_leaves(%iter_4196) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1870 = cute.get_scalars(%e0_4197) : !cute.int_tuple<"?">
          %1871 = cute.get_scalars(%e1_4198) : !cute.int_tuple<"?">
          %1872 = cute.get_scalars(%e2_4199) : !cute.int_tuple<"?">
          %1873 = cute.get_scalars(%e3_4200) : !cute.int_tuple<"?{div=8}">
          %lay_4201 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1874 = cute.get_shape(%lay_4201) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4202, %e1_4203, %e2_4204, %e3_4205 = cute.get_leaves(%1874) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4206 = cute.to_int_tuple(%e0_4202) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1875 = cute.get_scalars(%itup_4206) : !cute.int_tuple<"?">
          %itup_4207 = cute.to_int_tuple(%e1_4203) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1876 = cute.get_scalars(%itup_4207) : !cute.int_tuple<"?">
          %itup_4208 = cute.to_int_tuple(%e2_4204) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1877 = cute.get_scalars(%itup_4208) : !cute.int_tuple<"?">
          %itup_4209 = cute.to_int_tuple(%e3_4205) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1878 = cute.get_scalars(%itup_4209) : !cute.int_tuple<"?{div=8}">
          %coord_4210 = cute.make_coord(%e1_4198) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4211 = cute.make_coord(%itup_4208) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1879 = cute.get_scalars(%coord_4210) : !cute.coord<"?">
          %1880 = cute.get_scalars(%coord_4211) : !cute.coord<"?">
          %true_4212 = arith.constant true
          %1881 = arith.cmpi slt, %1879, %1880 : i32
          %1882 = arith.andi %true_4212, %1881 : i1
          scf.if %1882 {
            %int_tuple_4279 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4280 = cute.tuple_sub(%sub_2760, %int_tuple_4279) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1925 = cute.get_scalars(%sub_4280) : !cute.int_tuple<"?">
            %coord_4281 = cute.make_coord(%sub_4280) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_4282 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
            %idx_4283 = cute.crd2idx(%coord_4281, %lay_4282) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_4284 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
            %ptr_4285 = cute.add_offset(%iter_4284, %idx_4283) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4286 = cute.make_view(%ptr_4285) : !memref_gmem_bf16_11
            %iter_4287 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %iter_4288 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %coord_4289 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4290 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4291 = cute.crd2idx(%coord_4289, %lay_4290) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_4292 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4293 = cute.add_offset(%iter_4292, %idx_4291) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4294 = cute.make_view(%ptr_4293) : !memref_smem_bf16_15
            %iter_4295 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %iter_4296 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %lay_4297 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %1926 = cute.get_shape(%lay_4297) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4298, %e1_4299, %e2_4300 = cute.get_leaves(%1926) : !cute.shape<"((8,1),1)">
            %lay_4301 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %1927 = cute.get_shape(%lay_4301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4302, %e1_4303, %e2_4304 = cute.get_leaves(%1927) : !cute.shape<"((8,1),1)">
            %lay_4305 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %shape_4306 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4307 = cute.make_layout() : !cute.layout<"1:0">
            %append_4308 = cute.append_to_rank<2> (%lay_4305, %lay_4307) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4309 = cute.make_view(%iter_4288, %append_4308) : !memref_gmem_bf16_11
            %iter_4310 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %lay_4311 = cute.get_layout(%view_4309) : !memref_gmem_bf16_11
            %1928 = cute.get_shape(%lay_4311) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4312, %e1_4313, %e2_4314 = cute.get_leaves(%1928) : !cute.shape<"((8,1),1)">
            %iter_4315 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %view_4316 = cute.make_view(%iter_4315) : !memref_gmem_bf16_12
            %iter_4317 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4318 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %lay_4319 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %shape_4320 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4321 = cute.make_layout() : !cute.layout<"1:0">
            %append_4322 = cute.append_to_rank<2> (%lay_4319, %lay_4321) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4323 = cute.make_view(%iter_4296, %append_4322) : !memref_smem_bf16_15
            %iter_4324 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %lay_4325 = cute.get_layout(%view_4323) : !memref_smem_bf16_15
            %1929 = cute.get_shape(%lay_4325) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4326, %e1_4327, %e2_4328 = cute.get_leaves(%1929) : !cute.shape<"((8,1),1)">
            %iter_4329 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %view_4330 = cute.make_view(%iter_4329) : !memref_smem_bf16_16
            %iter_4331 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %iter_4332 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4333 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %1930 = cute.get_shape(%lay_4333) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4334, %e1_4335, %e2_4336 = cute.get_leaves(%1930) : !cute.shape<"((8,1),(1))">
            %lay_4337 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %1931 = cute.get_shape(%lay_4337) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4338, %e1_4339, %e2_4340 = cute.get_leaves(%1931) : !cute.shape<"((8,1),(1))">
            %lay_4341 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %sz_4342 = cute.size(%lay_4341) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4343 = cute.get_leaves(%sz_4342) : !cute.int_tuple<"1">
            %lay_4344 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %sz_4345 = cute.size(%lay_4344) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4346 = cute.get_leaves(%sz_4345) : !cute.int_tuple<"1">
            %1932 = cute.static : !cute.layout<"1:0">
            %iter_4347 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4348 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4349 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %lay_4350 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %append_4351 = cute.append_to_rank<2> (%lay_4349, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4352 = cute.append_to_rank<2> (%lay_4350, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4353 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4354 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4355 = cute.size(%lay_4353) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1933 = cute.get_scalars(%sz_4355) : !cute.int_tuple<"1">
            %c0_i32_4356 = arith.constant 0 : i32
            %c1_i32_4357 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4356 to %1933 step %c1_i32_4357  : i32 {
              %coord_4358 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1934 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4359 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4360 = cute.crd2idx(%coord_4358, %lay_4353) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4361 = cute.add_offset(%iter_4347, %idx_4360) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4362 = cute.make_view(%ptr_4361, %lay_4359) : !memref_gmem_bf16_10
              %1935 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4363 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4364 = cute.crd2idx(%coord_4358, %lay_4354) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4365 = cute.add_offset(%iter_4348, %idx_4364) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4366 = cute.make_view(%ptr_4365, %lay_4363) : !memref_smem_bf16_14
              %iter_4367 = cute.get_iter(%view_4362) : !memref_gmem_bf16_10
              %iter_4368 = cute.get_iter(%view_4366) : !memref_smem_bf16_14
              %iter_4369 = cute.recast_iter(%iter_4367) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4370 = cute.recast_iter(%iter_4368) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4370 : !cute.ptr<i128, smem>, %iter_4369 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4279 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4280 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4281 = cute.crd2idx(%coord_4279, %lay_4280) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_4282 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4283 = cute.add_offset(%iter_4282, %idx_4281) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4284 = cute.make_view(%ptr_4283) : !memref_smem_bf16_15
            %iter_4285 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %iter_4286 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %lay_4287 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %sz_4288 = cute.size(%lay_4287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4289 = cute.get_leaves(%sz_4288) : !cute.int_tuple<"8">
            %lay_4290 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %1925 = cute.get_shape(%lay_4290) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4291, %e1_4292, %e2_4293 = cute.get_leaves(%1925) : !cute.shape<"((8,1),1)">
            %int_tuple_4294 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4295 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4296 = cute.get_leaves(%int_tuple_4295) : !cute.int_tuple<"8">
            %cst_4297 = arith.constant 0.000000e+00 : bf16
            %1926 = vector.splat %cst_4297 : vector<8xbf16>
            %int_tuple_4298 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4299 = cute.size(%int_tuple_4298) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4300 = cute.get_leaves(%sz_4299) : !cute.int_tuple<"8">
            %int_tuple_4301 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4302 = cute.size(%int_tuple_4301) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4303 = cute.get_leaves(%sz_4302) : !cute.int_tuple<"8">
            cute.memref.store_vec %1926, %view_4284 : !memref_smem_bf16_15
          }
          %coord_4213 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
          %lay_4214 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4215 = cute.crd2idx(%coord_4213, %lay_4214) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
          %iter_4216 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4217 = cute.add_offset(%iter_4216, %idx_4215) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4218 = cute.make_view(%tup_4217) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4219 = cute.get_iter(%view_4218) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4220, %e1_4221, %e2_4222, %e3_4223 = cute.get_leaves(%iter_4219) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1883 = cute.get_scalars(%e0_4220) : !cute.int_tuple<"?">
          %1884 = cute.get_scalars(%e1_4221) : !cute.int_tuple<"?">
          %1885 = cute.get_scalars(%e2_4222) : !cute.int_tuple<"?">
          %1886 = cute.get_scalars(%e3_4223) : !cute.int_tuple<"?{div=8}">
          %iter_4224 = cute.get_iter(%view_4218) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4225, %e1_4226, %e2_4227, %e3_4228 = cute.get_leaves(%iter_4224) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1887 = cute.get_scalars(%e0_4225) : !cute.int_tuple<"?">
          %1888 = cute.get_scalars(%e1_4226) : !cute.int_tuple<"?">
          %1889 = cute.get_scalars(%e2_4227) : !cute.int_tuple<"?">
          %1890 = cute.get_scalars(%e3_4228) : !cute.int_tuple<"?{div=8}">
          %iter_4229 = cute.get_iter(%view_4218) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4230, %e1_4231, %e2_4232, %e3_4233 = cute.get_leaves(%iter_4229) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1891 = cute.get_scalars(%e0_4230) : !cute.int_tuple<"?">
          %1892 = cute.get_scalars(%e1_4231) : !cute.int_tuple<"?">
          %1893 = cute.get_scalars(%e2_4232) : !cute.int_tuple<"?">
          %1894 = cute.get_scalars(%e3_4233) : !cute.int_tuple<"?{div=8}">
          %lay_4234 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1895 = cute.get_shape(%lay_4234) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4235, %e1_4236, %e2_4237, %e3_4238 = cute.get_leaves(%1895) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4239 = cute.to_int_tuple(%e0_4235) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1896 = cute.get_scalars(%itup_4239) : !cute.int_tuple<"?">
          %itup_4240 = cute.to_int_tuple(%e1_4236) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1897 = cute.get_scalars(%itup_4240) : !cute.int_tuple<"?">
          %itup_4241 = cute.to_int_tuple(%e2_4237) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1898 = cute.get_scalars(%itup_4241) : !cute.int_tuple<"?">
          %itup_4242 = cute.to_int_tuple(%e3_4238) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1899 = cute.get_scalars(%itup_4242) : !cute.int_tuple<"?{div=8}">
          %coord_4243 = cute.make_coord(%e1_4231) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4244 = cute.make_coord(%itup_4241) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1900 = cute.get_scalars(%coord_4243) : !cute.coord<"?">
          %1901 = cute.get_scalars(%coord_4244) : !cute.coord<"?">
          %true_4245 = arith.constant true
          %1902 = arith.cmpi slt, %1900, %1901 : i32
          %1903 = arith.andi %true_4245, %1902 : i1
          scf.if %1903 {
            %int_tuple_4279 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4280 = cute.tuple_sub(%sub_2760, %int_tuple_4279) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1925 = cute.get_scalars(%sub_4280) : !cute.int_tuple<"?">
            %coord_4281 = cute.make_coord(%sub_4280) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_4282 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
            %idx_4283 = cute.crd2idx(%coord_4281, %lay_4282) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_4284 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
            %ptr_4285 = cute.add_offset(%iter_4284, %idx_4283) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4286 = cute.make_view(%ptr_4285) : !memref_gmem_bf16_11
            %iter_4287 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %iter_4288 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %coord_4289 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4290 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4291 = cute.crd2idx(%coord_4289, %lay_4290) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_4292 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4293 = cute.add_offset(%iter_4292, %idx_4291) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4294 = cute.make_view(%ptr_4293) : !memref_smem_bf16_15
            %iter_4295 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %iter_4296 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %lay_4297 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %1926 = cute.get_shape(%lay_4297) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4298, %e1_4299, %e2_4300 = cute.get_leaves(%1926) : !cute.shape<"((8,1),1)">
            %lay_4301 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %1927 = cute.get_shape(%lay_4301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4302, %e1_4303, %e2_4304 = cute.get_leaves(%1927) : !cute.shape<"((8,1),1)">
            %lay_4305 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %shape_4306 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4307 = cute.make_layout() : !cute.layout<"1:0">
            %append_4308 = cute.append_to_rank<2> (%lay_4305, %lay_4307) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4309 = cute.make_view(%iter_4288, %append_4308) : !memref_gmem_bf16_11
            %iter_4310 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %lay_4311 = cute.get_layout(%view_4309) : !memref_gmem_bf16_11
            %1928 = cute.get_shape(%lay_4311) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4312, %e1_4313, %e2_4314 = cute.get_leaves(%1928) : !cute.shape<"((8,1),1)">
            %iter_4315 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %view_4316 = cute.make_view(%iter_4315) : !memref_gmem_bf16_12
            %iter_4317 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4318 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %lay_4319 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %shape_4320 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4321 = cute.make_layout() : !cute.layout<"1:0">
            %append_4322 = cute.append_to_rank<2> (%lay_4319, %lay_4321) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4323 = cute.make_view(%iter_4296, %append_4322) : !memref_smem_bf16_15
            %iter_4324 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %lay_4325 = cute.get_layout(%view_4323) : !memref_smem_bf16_15
            %1929 = cute.get_shape(%lay_4325) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4326, %e1_4327, %e2_4328 = cute.get_leaves(%1929) : !cute.shape<"((8,1),1)">
            %iter_4329 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %view_4330 = cute.make_view(%iter_4329) : !memref_smem_bf16_16
            %iter_4331 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %iter_4332 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4333 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %1930 = cute.get_shape(%lay_4333) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4334, %e1_4335, %e2_4336 = cute.get_leaves(%1930) : !cute.shape<"((8,1),(1))">
            %lay_4337 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %1931 = cute.get_shape(%lay_4337) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4338, %e1_4339, %e2_4340 = cute.get_leaves(%1931) : !cute.shape<"((8,1),(1))">
            %lay_4341 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %sz_4342 = cute.size(%lay_4341) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4343 = cute.get_leaves(%sz_4342) : !cute.int_tuple<"1">
            %lay_4344 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %sz_4345 = cute.size(%lay_4344) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4346 = cute.get_leaves(%sz_4345) : !cute.int_tuple<"1">
            %1932 = cute.static : !cute.layout<"1:0">
            %iter_4347 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4348 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4349 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %lay_4350 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %append_4351 = cute.append_to_rank<2> (%lay_4349, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4352 = cute.append_to_rank<2> (%lay_4350, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4353 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4354 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4355 = cute.size(%lay_4353) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1933 = cute.get_scalars(%sz_4355) : !cute.int_tuple<"1">
            %c0_i32_4356 = arith.constant 0 : i32
            %c1_i32_4357 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4356 to %1933 step %c1_i32_4357  : i32 {
              %coord_4358 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1934 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4359 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4360 = cute.crd2idx(%coord_4358, %lay_4353) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4361 = cute.add_offset(%iter_4347, %idx_4360) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4362 = cute.make_view(%ptr_4361, %lay_4359) : !memref_gmem_bf16_10
              %1935 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4363 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4364 = cute.crd2idx(%coord_4358, %lay_4354) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4365 = cute.add_offset(%iter_4348, %idx_4364) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4366 = cute.make_view(%ptr_4365, %lay_4363) : !memref_smem_bf16_14
              %iter_4367 = cute.get_iter(%view_4362) : !memref_gmem_bf16_10
              %iter_4368 = cute.get_iter(%view_4366) : !memref_smem_bf16_14
              %iter_4369 = cute.recast_iter(%iter_4367) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4370 = cute.recast_iter(%iter_4368) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4370 : !cute.ptr<i128, smem>, %iter_4369 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4279 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4280 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4281 = cute.crd2idx(%coord_4279, %lay_4280) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_4282 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4283 = cute.add_offset(%iter_4282, %idx_4281) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4284 = cute.make_view(%ptr_4283) : !memref_smem_bf16_15
            %iter_4285 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %iter_4286 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %lay_4287 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %sz_4288 = cute.size(%lay_4287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4289 = cute.get_leaves(%sz_4288) : !cute.int_tuple<"8">
            %lay_4290 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %1925 = cute.get_shape(%lay_4290) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4291, %e1_4292, %e2_4293 = cute.get_leaves(%1925) : !cute.shape<"((8,1),1)">
            %int_tuple_4294 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4295 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4296 = cute.get_leaves(%int_tuple_4295) : !cute.int_tuple<"8">
            %cst_4297 = arith.constant 0.000000e+00 : bf16
            %1926 = vector.splat %cst_4297 : vector<8xbf16>
            %int_tuple_4298 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4299 = cute.size(%int_tuple_4298) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4300 = cute.get_leaves(%sz_4299) : !cute.int_tuple<"8">
            %int_tuple_4301 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4302 = cute.size(%int_tuple_4301) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4303 = cute.get_leaves(%sz_4302) : !cute.int_tuple<"8">
            cute.memref.store_vec %1926, %view_4284 : !memref_smem_bf16_15
          }
          %coord_4246 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
          %lay_4247 = cute.get_layout(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4248 = cute.crd2idx(%coord_4246, %lay_4247) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
          %iter_4249 = cute.get_iter(%view_1244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4250 = cute.add_offset(%iter_4249, %idx_4248) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4251 = cute.make_view(%tup_4250) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4252 = cute.get_iter(%view_4251) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4253, %e1_4254, %e2_4255, %e3_4256 = cute.get_leaves(%iter_4252) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1904 = cute.get_scalars(%e0_4253) : !cute.int_tuple<"?">
          %1905 = cute.get_scalars(%e1_4254) : !cute.int_tuple<"?">
          %1906 = cute.get_scalars(%e2_4255) : !cute.int_tuple<"?">
          %1907 = cute.get_scalars(%e3_4256) : !cute.int_tuple<"?{div=8}">
          %iter_4257 = cute.get_iter(%view_4251) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4258, %e1_4259, %e2_4260, %e3_4261 = cute.get_leaves(%iter_4257) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1908 = cute.get_scalars(%e0_4258) : !cute.int_tuple<"?">
          %1909 = cute.get_scalars(%e1_4259) : !cute.int_tuple<"?">
          %1910 = cute.get_scalars(%e2_4260) : !cute.int_tuple<"?">
          %1911 = cute.get_scalars(%e3_4261) : !cute.int_tuple<"?{div=8}">
          %iter_4262 = cute.get_iter(%view_4251) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4263, %e1_4264, %e2_4265, %e3_4266 = cute.get_leaves(%iter_4262) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1912 = cute.get_scalars(%e0_4263) : !cute.int_tuple<"?">
          %1913 = cute.get_scalars(%e1_4264) : !cute.int_tuple<"?">
          %1914 = cute.get_scalars(%e2_4265) : !cute.int_tuple<"?">
          %1915 = cute.get_scalars(%e3_4266) : !cute.int_tuple<"?{div=8}">
          %lay_4267 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1916 = cute.get_shape(%lay_4267) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4268, %e1_4269, %e2_4270, %e3_4271 = cute.get_leaves(%1916) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4272 = cute.to_int_tuple(%e0_4268) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1917 = cute.get_scalars(%itup_4272) : !cute.int_tuple<"?">
          %itup_4273 = cute.to_int_tuple(%e1_4269) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1918 = cute.get_scalars(%itup_4273) : !cute.int_tuple<"?">
          %itup_4274 = cute.to_int_tuple(%e2_4270) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1919 = cute.get_scalars(%itup_4274) : !cute.int_tuple<"?">
          %itup_4275 = cute.to_int_tuple(%e3_4271) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1920 = cute.get_scalars(%itup_4275) : !cute.int_tuple<"?{div=8}">
          %coord_4276 = cute.make_coord(%e1_4264) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4277 = cute.make_coord(%itup_4274) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1921 = cute.get_scalars(%coord_4276) : !cute.coord<"?">
          %1922 = cute.get_scalars(%coord_4277) : !cute.coord<"?">
          %true_4278 = arith.constant true
          %1923 = arith.cmpi slt, %1921, %1922 : i32
          %1924 = arith.andi %true_4278, %1923 : i1
          scf.if %1924 {
            %int_tuple_4279 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4280 = cute.tuple_sub(%sub_2760, %int_tuple_4279) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1925 = cute.get_scalars(%sub_4280) : !cute.int_tuple<"?">
            %coord_4281 = cute.make_coord(%sub_4280) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_4282 = cute.get_layout(%view_592) : !memref_gmem_bf16_7
            %idx_4283 = cute.crd2idx(%coord_4281, %lay_4282) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_4284 = cute.get_iter(%view_592) : !memref_gmem_bf16_7
            %ptr_4285 = cute.add_offset(%iter_4284, %idx_4283) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4286 = cute.make_view(%ptr_4285) : !memref_gmem_bf16_11
            %iter_4287 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %iter_4288 = cute.get_iter(%view_4286) : !memref_gmem_bf16_11
            %coord_4289 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4290 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4291 = cute.crd2idx(%coord_4289, %lay_4290) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_4292 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4293 = cute.add_offset(%iter_4292, %idx_4291) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4294 = cute.make_view(%ptr_4293) : !memref_smem_bf16_15
            %iter_4295 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %iter_4296 = cute.get_iter(%view_4294) : !memref_smem_bf16_15
            %lay_4297 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %1926 = cute.get_shape(%lay_4297) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4298, %e1_4299, %e2_4300 = cute.get_leaves(%1926) : !cute.shape<"((8,1),1)">
            %lay_4301 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %1927 = cute.get_shape(%lay_4301) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4302, %e1_4303, %e2_4304 = cute.get_leaves(%1927) : !cute.shape<"((8,1),1)">
            %lay_4305 = cute.get_layout(%view_4286) : !memref_gmem_bf16_11
            %shape_4306 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4307 = cute.make_layout() : !cute.layout<"1:0">
            %append_4308 = cute.append_to_rank<2> (%lay_4305, %lay_4307) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4309 = cute.make_view(%iter_4288, %append_4308) : !memref_gmem_bf16_11
            %iter_4310 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %lay_4311 = cute.get_layout(%view_4309) : !memref_gmem_bf16_11
            %1928 = cute.get_shape(%lay_4311) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4312, %e1_4313, %e2_4314 = cute.get_leaves(%1928) : !cute.shape<"((8,1),1)">
            %iter_4315 = cute.get_iter(%view_4309) : !memref_gmem_bf16_11
            %view_4316 = cute.make_view(%iter_4315) : !memref_gmem_bf16_12
            %iter_4317 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4318 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %lay_4319 = cute.get_layout(%view_4294) : !memref_smem_bf16_15
            %shape_4320 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4321 = cute.make_layout() : !cute.layout<"1:0">
            %append_4322 = cute.append_to_rank<2> (%lay_4319, %lay_4321) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4323 = cute.make_view(%iter_4296, %append_4322) : !memref_smem_bf16_15
            %iter_4324 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %lay_4325 = cute.get_layout(%view_4323) : !memref_smem_bf16_15
            %1929 = cute.get_shape(%lay_4325) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4326, %e1_4327, %e2_4328 = cute.get_leaves(%1929) : !cute.shape<"((8,1),1)">
            %iter_4329 = cute.get_iter(%view_4323) : !memref_smem_bf16_15
            %view_4330 = cute.make_view(%iter_4329) : !memref_smem_bf16_16
            %iter_4331 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %iter_4332 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4333 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %1930 = cute.get_shape(%lay_4333) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4334, %e1_4335, %e2_4336 = cute.get_leaves(%1930) : !cute.shape<"((8,1),(1))">
            %lay_4337 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %1931 = cute.get_shape(%lay_4337) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4338, %e1_4339, %e2_4340 = cute.get_leaves(%1931) : !cute.shape<"((8,1),(1))">
            %lay_4341 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %sz_4342 = cute.size(%lay_4341) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4343 = cute.get_leaves(%sz_4342) : !cute.int_tuple<"1">
            %lay_4344 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %sz_4345 = cute.size(%lay_4344) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4346 = cute.get_leaves(%sz_4345) : !cute.int_tuple<"1">
            %1932 = cute.static : !cute.layout<"1:0">
            %iter_4347 = cute.get_iter(%view_4316) : !memref_gmem_bf16_12
            %iter_4348 = cute.get_iter(%view_4330) : !memref_smem_bf16_16
            %lay_4349 = cute.get_layout(%view_4316) : !memref_gmem_bf16_12
            %lay_4350 = cute.get_layout(%view_4330) : !memref_smem_bf16_16
            %append_4351 = cute.append_to_rank<2> (%lay_4349, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4352 = cute.append_to_rank<2> (%lay_4350, %1932) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4353 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4354 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4355 = cute.size(%lay_4353) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1933 = cute.get_scalars(%sz_4355) : !cute.int_tuple<"1">
            %c0_i32_4356 = arith.constant 0 : i32
            %c1_i32_4357 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4356 to %1933 step %c1_i32_4357  : i32 {
              %coord_4358 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1934 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4359 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4360 = cute.crd2idx(%coord_4358, %lay_4353) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4361 = cute.add_offset(%iter_4347, %idx_4360) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4362 = cute.make_view(%ptr_4361, %lay_4359) : !memref_gmem_bf16_10
              %1935 = cute.get_scalars(%coord_4358) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4363 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4364 = cute.crd2idx(%coord_4358, %lay_4354) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4365 = cute.add_offset(%iter_4348, %idx_4364) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4366 = cute.make_view(%ptr_4365, %lay_4363) : !memref_smem_bf16_14
              %iter_4367 = cute.get_iter(%view_4362) : !memref_gmem_bf16_10
              %iter_4368 = cute.get_iter(%view_4366) : !memref_smem_bf16_14
              %iter_4369 = cute.recast_iter(%iter_4367) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4370 = cute.recast_iter(%iter_4368) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4370 : !cute.ptr<i128, smem>, %iter_4369 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4279 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4280 = cute.get_layout(%view_631) : !memref_smem_bf16_4
            %idx_4281 = cute.crd2idx(%coord_4279, %lay_4280) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_4282 = cute.get_iter(%view_631) : !memref_smem_bf16_4
            %ptr_4283 = cute.add_offset(%iter_4282, %idx_4281) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4284 = cute.make_view(%ptr_4283) : !memref_smem_bf16_15
            %iter_4285 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %iter_4286 = cute.get_iter(%view_4284) : !memref_smem_bf16_15
            %lay_4287 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %sz_4288 = cute.size(%lay_4287) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4289 = cute.get_leaves(%sz_4288) : !cute.int_tuple<"8">
            %lay_4290 = cute.get_layout(%view_4284) : !memref_smem_bf16_15
            %1925 = cute.get_shape(%lay_4290) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4291, %e1_4292, %e2_4293 = cute.get_leaves(%1925) : !cute.shape<"((8,1),1)">
            %int_tuple_4294 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4295 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4296 = cute.get_leaves(%int_tuple_4295) : !cute.int_tuple<"8">
            %cst_4297 = arith.constant 0.000000e+00 : bf16
            %1926 = vector.splat %cst_4297 : vector<8xbf16>
            %int_tuple_4298 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4299 = cute.size(%int_tuple_4298) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4300 = cute.get_leaves(%sz_4299) : !cute.int_tuple<"8">
            %int_tuple_4301 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4302 = cute.size(%int_tuple_4301) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4303 = cute.get_leaves(%sz_4302) : !cute.int_tuple<"8">
            cute.memref.store_vec %1926, %view_4284 : !memref_smem_bf16_15
          }
          nvvm.cp.async.commit.group
        }
        %lay_3428 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
        %1686 = cute.get_shape(%lay_3428) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3429, %e1_3430, %e2_3431, %e3_3432 = cute.get_leaves(%1686) : !cute.shape<"((2,2),1,8)">
        %1687 = cute.get_stride(%lay_3428) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3433, %e1_3434, %e2_3435, %e3_3436 = cute.get_leaves(%1687) : !cute.stride<"((1,2),0,4)">
        %1688 = scf.if %true_3075 -> (!memref_rmem_f32_1) {
          %iter_4014 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
          %lay_4015 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
          %1825 = cute.get_shape(%lay_4015) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4016, %e1_4017, %e2_4018, %e3_4019 = cute.get_leaves(%1825) : !cute.shape<"((2,2),1,8)">
          %1826 = cute.memref.load_vec %rmem_2771 : !memref_rmem_f32_1
          %cst_4020 = arith.constant 5.000000e-01 : f32
          %1827 = vector.broadcast %cst_4020 : f32 to vector<32xf32>
          %1828 = arith.mulf %1826, %1827 : vector<32xf32>
          %int_tuple_4021 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4022 = cute.size(%int_tuple_4021) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4023 = cute.get_leaves(%sz_4022) : !cute.int_tuple<"32">
          %int_tuple_4024 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4025 = cute.size(%int_tuple_4024) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4026 = cute.get_leaves(%sz_4025) : !cute.int_tuple<"32">
          cute.memref.store_vec %1828, %rmem_2771 : !memref_rmem_f32_1
          %int_tuple_4027 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_4028 = cute.size(%int_tuple_4027) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_4029 = cute.get_leaves(%sz_4028) : !cute.int_tuple<"4">
          %int_tuple_4030 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4031 = cute.size(%int_tuple_4030) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4032 = cute.get_leaves(%sz_4031) : !cute.int_tuple<"1">
          %int_tuple_4033 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4034 = cute.size(%int_tuple_4033) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4035 = cute.get_leaves(%sz_4034) : !cute.int_tuple<"8">
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %1829 = cute.memref.load(%rmem_2771, %coord_4036) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">) -> f32
          %1830 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1829 : (f32) -> f32
          %coord_4037 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          cute.memref.store(%rmem_2771, %coord_4037, %1830) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
          %coord_4038 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %1831 = cute.memref.load(%rmem_2771, %coord_4038) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">) -> f32
          %1832 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1831 : (f32) -> f32
          %coord_4039 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          cute.memref.store(%rmem_2771, %coord_4039, %1832) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
          %coord_4040 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %1833 = cute.memref.load(%rmem_2771, %coord_4040) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">) -> f32
          %1834 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1833 : (f32) -> f32
          %coord_4041 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          cute.memref.store(%rmem_2771, %coord_4041, %1834) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
          %coord_4042 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %1835 = cute.memref.load(%rmem_2771, %coord_4042) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">) -> f32
          %1836 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1835 : (f32) -> f32
          %coord_4043 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          cute.memref.store(%rmem_2771, %coord_4043, %1836) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
          %coord_4044 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %1837 = cute.memref.load(%rmem_2771, %coord_4044) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">) -> f32
          %1838 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1837 : (f32) -> f32
          %coord_4045 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          cute.memref.store(%rmem_2771, %coord_4045, %1838) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
          %coord_4046 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %1839 = cute.memref.load(%rmem_2771, %coord_4046) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">) -> f32
          %1840 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1839 : (f32) -> f32
          %coord_4047 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          cute.memref.store(%rmem_2771, %coord_4047, %1840) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
          %coord_4048 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %1841 = cute.memref.load(%rmem_2771, %coord_4048) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">) -> f32
          %1842 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1841 : (f32) -> f32
          %coord_4049 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          cute.memref.store(%rmem_2771, %coord_4049, %1842) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
          %coord_4050 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %1843 = cute.memref.load(%rmem_2771, %coord_4050) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">) -> f32
          %1844 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1843 : (f32) -> f32
          %coord_4051 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          cute.memref.store(%rmem_2771, %coord_4051, %1844) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
          %int_tuple_4052 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4053 = cute.size(%int_tuple_4052) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4054 = cute.get_leaves(%sz_4053) : !cute.int_tuple<"1">
          %int_tuple_4055 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4056 = cute.size(%int_tuple_4055) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4057 = cute.get_leaves(%sz_4056) : !cute.int_tuple<"8">
          %coord_4058 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %1845 = cute.memref.load(%rmem_2771, %coord_4058) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">) -> f32
          %1846 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1845 : (f32) -> f32
          %coord_4059 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          cute.memref.store(%rmem_2771, %coord_4059, %1846) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
          %coord_4060 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %1847 = cute.memref.load(%rmem_2771, %coord_4060) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">) -> f32
          %1848 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1847 : (f32) -> f32
          %coord_4061 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          cute.memref.store(%rmem_2771, %coord_4061, %1848) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
          %coord_4062 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %1849 = cute.memref.load(%rmem_2771, %coord_4062) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">) -> f32
          %1850 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1849 : (f32) -> f32
          %coord_4063 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          cute.memref.store(%rmem_2771, %coord_4063, %1850) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
          %coord_4064 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %1851 = cute.memref.load(%rmem_2771, %coord_4064) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">) -> f32
          %1852 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1851 : (f32) -> f32
          %coord_4065 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          cute.memref.store(%rmem_2771, %coord_4065, %1852) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
          %coord_4066 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %1853 = cute.memref.load(%rmem_2771, %coord_4066) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">) -> f32
          %1854 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1853 : (f32) -> f32
          %coord_4067 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          cute.memref.store(%rmem_2771, %coord_4067, %1854) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
          %coord_4068 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %1855 = cute.memref.load(%rmem_2771, %coord_4068) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">) -> f32
          %1856 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1855 : (f32) -> f32
          %coord_4069 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          cute.memref.store(%rmem_2771, %coord_4069, %1856) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
          %coord_4070 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %1857 = cute.memref.load(%rmem_2771, %coord_4070) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">) -> f32
          %1858 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1857 : (f32) -> f32
          %coord_4071 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          cute.memref.store(%rmem_2771, %coord_4071, %1858) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
          %coord_4072 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %1859 = cute.memref.load(%rmem_2771, %coord_4072) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">) -> f32
          %1860 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1859 : (f32) -> f32
          %coord_4073 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          cute.memref.store(%rmem_2771, %coord_4073, %1860) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
          %int_tuple_4074 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4075 = cute.size(%int_tuple_4074) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4076 = cute.get_leaves(%sz_4075) : !cute.int_tuple<"1">
          %int_tuple_4077 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4078 = cute.size(%int_tuple_4077) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4079 = cute.get_leaves(%sz_4078) : !cute.int_tuple<"8">
          %coord_4080 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %1861 = cute.memref.load(%rmem_2771, %coord_4080) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">) -> f32
          %1862 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1861 : (f32) -> f32
          %coord_4081 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          cute.memref.store(%rmem_2771, %coord_4081, %1862) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
          %coord_4082 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %1863 = cute.memref.load(%rmem_2771, %coord_4082) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">) -> f32
          %1864 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1863 : (f32) -> f32
          %coord_4083 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          cute.memref.store(%rmem_2771, %coord_4083, %1864) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
          %coord_4084 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %1865 = cute.memref.load(%rmem_2771, %coord_4084) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">) -> f32
          %1866 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1865 : (f32) -> f32
          %coord_4085 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          cute.memref.store(%rmem_2771, %coord_4085, %1866) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
          %coord_4086 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %1867 = cute.memref.load(%rmem_2771, %coord_4086) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">) -> f32
          %1868 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1867 : (f32) -> f32
          %coord_4087 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          cute.memref.store(%rmem_2771, %coord_4087, %1868) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
          %coord_4088 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %1869 = cute.memref.load(%rmem_2771, %coord_4088) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">) -> f32
          %1870 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1869 : (f32) -> f32
          %coord_4089 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          cute.memref.store(%rmem_2771, %coord_4089, %1870) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
          %coord_4090 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %1871 = cute.memref.load(%rmem_2771, %coord_4090) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">) -> f32
          %1872 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1871 : (f32) -> f32
          %coord_4091 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          cute.memref.store(%rmem_2771, %coord_4091, %1872) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
          %coord_4092 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %1873 = cute.memref.load(%rmem_2771, %coord_4092) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">) -> f32
          %1874 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1873 : (f32) -> f32
          %coord_4093 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          cute.memref.store(%rmem_2771, %coord_4093, %1874) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
          %coord_4094 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %1875 = cute.memref.load(%rmem_2771, %coord_4094) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">) -> f32
          %1876 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1875 : (f32) -> f32
          %coord_4095 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          cute.memref.store(%rmem_2771, %coord_4095, %1876) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
          %int_tuple_4096 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4097 = cute.size(%int_tuple_4096) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4098 = cute.get_leaves(%sz_4097) : !cute.int_tuple<"1">
          %int_tuple_4099 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4100 = cute.size(%int_tuple_4099) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4101 = cute.get_leaves(%sz_4100) : !cute.int_tuple<"8">
          %coord_4102 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %1877 = cute.memref.load(%rmem_2771, %coord_4102) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">) -> f32
          %1878 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1877 : (f32) -> f32
          %coord_4103 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          cute.memref.store(%rmem_2771, %coord_4103, %1878) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
          %coord_4104 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %1879 = cute.memref.load(%rmem_2771, %coord_4104) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">) -> f32
          %1880 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1879 : (f32) -> f32
          %coord_4105 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          cute.memref.store(%rmem_2771, %coord_4105, %1880) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
          %coord_4106 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %1881 = cute.memref.load(%rmem_2771, %coord_4106) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">) -> f32
          %1882 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1881 : (f32) -> f32
          %coord_4107 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          cute.memref.store(%rmem_2771, %coord_4107, %1882) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
          %coord_4108 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %1883 = cute.memref.load(%rmem_2771, %coord_4108) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">) -> f32
          %1884 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1883 : (f32) -> f32
          %coord_4109 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          cute.memref.store(%rmem_2771, %coord_4109, %1884) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
          %coord_4110 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %1885 = cute.memref.load(%rmem_2771, %coord_4110) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">) -> f32
          %1886 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1885 : (f32) -> f32
          %coord_4111 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          cute.memref.store(%rmem_2771, %coord_4111, %1886) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
          %coord_4112 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %1887 = cute.memref.load(%rmem_2771, %coord_4112) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">) -> f32
          %1888 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1887 : (f32) -> f32
          %coord_4113 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          cute.memref.store(%rmem_2771, %coord_4113, %1888) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
          %coord_4114 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %1889 = cute.memref.load(%rmem_2771, %coord_4114) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">) -> f32
          %1890 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1889 : (f32) -> f32
          %coord_4115 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          cute.memref.store(%rmem_2771, %coord_4115, %1890) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
          %coord_4116 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %1891 = cute.memref.load(%rmem_2771, %coord_4116) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">) -> f32
          %1892 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1891 : (f32) -> f32
          %coord_4117 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          cute.memref.store(%rmem_2771, %coord_4117, %1892) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
          %1893 = cute.memref.load_vec %rmem_2771 : !memref_rmem_f32_1
          %1894 = arith.mulf %1828, %1893 : vector<32xf32>
          %1895 = arith.addf %1894, %1828 : vector<32xf32>
          %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4119 = cute.size(%int_tuple_4118) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4120 = cute.get_leaves(%sz_4119) : !cute.int_tuple<"32">
          %int_tuple_4121 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4122 = cute.size(%int_tuple_4121) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4123 = cute.get_leaves(%sz_4122) : !cute.int_tuple<"32">
          cute.memref.store_vec %1895, %rmem_2771 : !memref_rmem_f32_1
          %lay_4124 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
          %1896 = cute.get_shape(%lay_4124) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4125, %e1_4126, %e2_4127, %e3_4128 = cute.get_leaves(%1896) : !cute.shape<"((2,2),1,8)">
          %1897 = cute.get_stride(%lay_4124) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4129, %e1_4130, %e2_4131, %e3_4132 = cute.get_leaves(%1897) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2771 : !memref_rmem_f32_1
        } else {
          %iter_4014 = cute.get_iter(%rmem_2771) : !memref_rmem_f32_1
          %lay_4015 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
          %1825 = cute.get_shape(%lay_4015) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4016, %e1_4017, %e2_4018, %e3_4019 = cute.get_leaves(%1825) : !cute.shape<"((2,2),1,8)">
          %1826 = cute.memref.load_vec %rmem_2771 : !memref_rmem_f32_1
          %cst_4020 = arith.constant -1.44269502 : f32
          %1827 = vector.broadcast %cst_4020 : f32 to vector<32xf32>
          %1828 = arith.mulf %1826, %1827 : vector<32xf32>
          %1829 = math.exp2 %1828 fastmath<fast> : vector<32xf32>
          %cst_4021 = arith.constant 1.000000e+00 : f32
          %1830 = vector.broadcast %cst_4021 : f32 to vector<32xf32>
          %1831 = arith.addf %1829, %1830 : vector<32xf32>
          %1832 = arith.divf %1826, %1831 : vector<32xf32>
          %int_tuple_4022 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4023 = cute.size(%int_tuple_4022) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4024 = cute.get_leaves(%sz_4023) : !cute.int_tuple<"32">
          %int_tuple_4025 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4026 = cute.size(%int_tuple_4025) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4027 = cute.get_leaves(%sz_4026) : !cute.int_tuple<"32">
          cute.memref.store_vec %1832, %rmem_2771 : !memref_rmem_f32_1
          %lay_4028 = cute.get_layout(%rmem_2771) : !memref_rmem_f32_1
          %1833 = cute.get_shape(%lay_4028) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4029, %e1_4030, %e2_4031, %e3_4032 = cute.get_leaves(%1833) : !cute.shape<"((2,2),1,8)">
          %1834 = cute.get_stride(%lay_4028) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4033, %e1_4034, %e2_4035, %e3_4036 = cute.get_leaves(%1834) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2771 : !memref_rmem_f32_1
        }
        %iter_3437 = cute.get_iter(%1688) : !memref_rmem_f32_1
        %lay_3438 = cute.get_layout(%1688) : !memref_rmem_f32_1
        %1689 = cute.get_shape(%lay_3438) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3439, %e1_3440, %e2_3441, %e3_3442 = cute.get_leaves(%1689) : !cute.shape<"((2,2),1,8)">
        %1690 = cute.get_stride(%lay_3438) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3443, %e1_3444, %e2_3445, %e3_3446 = cute.get_leaves(%1690) : !cute.stride<"((1,2),0,4)">
        %iter_3447 = cute.get_iter(%1688) : !memref_rmem_f32_1
        %iter_3448 = cute.get_iter(%1688) : !memref_rmem_f32_1
        %lay_3449 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1691 = cute.get_shape(%lay_3449) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_3450, %e1_3451, %e2_3452, %e3_3453 = cute.get_leaves(%1691) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_3454 = cute.to_int_tuple(%e0_3450) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1692 = cute.get_scalars(%itup_3454) : !cute.int_tuple<"?">
        %itup_3455 = cute.to_int_tuple(%e1_3451) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1693 = cute.get_scalars(%itup_3455) : !cute.int_tuple<"?">
        %itup_3456 = cute.to_int_tuple(%e2_3452) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1694 = cute.get_scalars(%itup_3456) : !cute.int_tuple<"?">
        %itup_3457 = cute.to_int_tuple(%e3_3453) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1695 = cute.get_scalars(%itup_3457) : !cute.int_tuple<"?{div=8}">
        %lay_3458 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1696 = cute.get_shape(%lay_3458) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_3459, %e1_3460, %e2_3461, %e3_3462 = cute.get_leaves(%1696) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_3463 = cute.to_int_tuple(%e0_3459) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1697 = cute.get_scalars(%itup_3463) : !cute.int_tuple<"?">
        %itup_3464 = cute.to_int_tuple(%e1_3460) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1698 = cute.get_scalars(%itup_3464) : !cute.int_tuple<"?">
        %itup_3465 = cute.to_int_tuple(%e2_3461) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1699 = cute.get_scalars(%itup_3465) : !cute.int_tuple<"?">
        %itup_3466 = cute.to_int_tuple(%e3_3462) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1700 = cute.get_scalars(%itup_3466) : !cute.int_tuple<"?{div=8}">
        %shape_3467 = cute.make_shape(%itup_3456, %itup_3466) : (!cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?{div=8})">
        %int_tuple_3468 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0)">
        %stride_3469 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1)">
        %lay_3470 = cute.make_layout(%shape_3467, %stride_3469) : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %view_3471 = cute.make_view(%int_tuple_3468, %lay_3470) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_3472 = cute.get_iter(%view_3471) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_3473, %e1_3474 = cute.get_leaves(%iter_3472) : !cute.int_tuple<"(0,0)">
        %coord_3475 = cute.make_coord() : () -> !cute.coord<"(_,_)">
        %lay_3476 = cute.get_layout(%view_3471) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %1701:2 = cute.get_scalars(%lay_3476) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %iv_3477 = cute.assume(%1701#1) : (i32) -> !cute.i32<divby 8>
        %shape_3478 = cute.make_shape(%1701#0, %iv_3477) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
        %stride_3479 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1)">
        %lay_3480 = cute.make_layout(%shape_3478, %stride_3479) : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %int_tuple_3481 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0)">
        %view_3482 = cute.make_view(%int_tuple_3481, %lay_3480) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_3483 = cute.get_iter(%view_3482) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_3484, %e1_3485 = cute.get_leaves(%iter_3483) : !cute.int_tuple<"(0,0)">
        %iter_3486 = cute.get_iter(%view_3482) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_3487, %e1_3488 = cute.get_leaves(%iter_3486) : !cute.int_tuple<"(0,0)">
        %tile_3489 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
        %coord_3490 = cute.make_coord(%sub_223, %sub_2760) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.coord<"(?,?)">
        %1702:2 = cute.get_scalars(%coord_3490) <{only_dynamic}> : !cute.coord<"(?,?)">
        %coord_3491 = cute.make_coord(%1702#0, %1702#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
        %lay_3492 = cute.get_layout(%view_3482) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %1703:2 = cute.get_scalars(%lay_3492) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %c64_i32_3493 = arith.constant 64 : i32
        %1704 = arith.ceildivsi %1703#0, %c64_i32_3493 : i32
        %c64_i32_3494 = arith.constant 64 : i32
        %1705 = arith.ceildivsi %1703#1, %c64_i32_3494 : i32
        %shape_3495 = cute.make_shape(%1704, %1705) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
        %stride_3496 = cute.make_stride() : () -> !cute.stride<"((1@0,1@1),(64@0,64@1))">
        %lay_3497 = cute.make_layout(%shape_3495, %stride_3496) : !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">
        %idx_3498 = cute.crd2idx(%coord_3491, %lay_3497) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %iter_3499 = cute.get_iter(%view_3482) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %tup_3500 = cute.add_offset(%iter_3499, %idx_3498) : (!cute.int_tuple<"(0,0)">, !cute.int_tuple<"(?{div=64},?{div=64})">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %view_3501 = cute.make_view(%tup_3500) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %iter_3502 = cute.get_iter(%view_3501) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %e0_3503, %e1_3504 = cute.get_leaves(%iter_3502) : !cute.int_tuple<"(?{div=64},?{div=64})">
        %1706 = cute.get_scalars(%e0_3503) : !cute.int_tuple<"?{div=64}">
        %1707 = cute.get_scalars(%e1_3504) : !cute.int_tuple<"?{div=64}">
        %lay_3505 = cute.get_layout(%1688) : !memref_rmem_f32_1
        %1708 = cute.get_shape(%lay_3505) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3506, %e1_3507, %e2_3508, %e3_3509 = cute.get_leaves(%1708) : !cute.shape<"((2,2),1,8)">
        %1709 = cute.get_stride(%lay_3505) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3510, %e1_3511, %e2_3512, %e3_3513 = cute.get_leaves(%1709) : !cute.stride<"((1,2),0,4)">
        %1710 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1711 = cute.get_shape(%1710) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_3514, %e1_3515, %e2_3516, %e3_3517 = cute.get_leaves(%1711) : !cute.shape<"(32,4,1,1)">
        %1712 = cute.get_stride(%1710) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_3518, %e1_3519, %e2_3520, %e3_3521 = cute.get_leaves(%1712) : !cute.stride<"(1,32,0,0)">
        %1713 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_3522, %e1_3523, %e2_3524 = cute.get_leaves(%1713) : !cute.tile<"[64:1;16:1;16:1]">
        %1714 = cute.get_shape(%e0_3522) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3525 = cute.get_leaves(%1714) : !cute.shape<"64">
        %1715 = cute.get_stride(%e0_3522) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3526 = cute.get_leaves(%1715) : !cute.stride<"1">
        %1716 = cute.get_shape(%e1_3523) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3527 = cute.get_leaves(%1716) : !cute.shape<"16">
        %1717 = cute.get_stride(%e1_3523) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3528 = cute.get_leaves(%1717) : !cute.stride<"1">
        %1718 = cute.get_shape(%e2_3524) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3529 = cute.get_leaves(%1718) : !cute.shape<"16">
        %1719 = cute.get_stride(%e2_3524) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3530 = cute.get_leaves(%1719) : !cute.stride<"1">
        %1720 = cute.static : !cute.layout<"32:1">
        %1721 = cute.get_shape(%1720) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3531 = cute.get_leaves(%1721) : !cute.shape<"32">
        %1722 = cute.get_stride(%1720) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3532 = cute.get_leaves(%1722) : !cute.stride<"1">
        %1723 = cute.static : !cute.shape<"(16,8,16)">
        %e0_3533, %e1_3534, %e2_3535 = cute.get_leaves(%1723) : !cute.shape<"(16,8,16)">
        %1724 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1725 = cute.get_shape(%1724) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_3536, %e1_3537, %e2_3538, %e3_3539, %e4_3540 = cute.get_leaves(%1725) : !cute.shape<"((4,8),(2,2,2))">
        %1726 = cute.get_stride(%1724) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_3541, %e1_3542, %e2_3543, %e3_3544, %e4_3545 = cute.get_leaves(%1726) : !cute.stride<"((32,1),(16,8,128))">
        %1727 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1728 = cute.get_shape(%1727) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3546, %e1_3547, %e2_3548, %e3_3549 = cute.get_leaves(%1728) : !cute.shape<"((4,8),(2,2))">
        %1729 = cute.get_stride(%1727) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_3550, %e1_3551, %e2_3552, %e3_3553 = cute.get_leaves(%1729) : !cute.stride<"((16,1),(8,64))">
        %1730 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1731 = cute.get_shape(%1730) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3554, %e1_3555, %e2_3556, %e3_3557 = cute.get_leaves(%1731) : !cute.shape<"((4,8),(2,2))">
        %1732 = cute.get_stride(%1730) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_3558, %e1_3559, %e2_3560, %e3_3561 = cute.get_leaves(%1732) : !cute.stride<"((32,1),(16,8))">
        %1733:2 = scf.if %false -> (!memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_) {
          %iter_4014 = cute.get_iter(%1688) : !memref_rmem_f32_1
          %coord_4015 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
          %iter_4016 = cute.get_iter(%view_3501) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
          %1825 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"?">
          %c32_i32_4017 = arith.constant 32 : i32
          %1826 = arith.remsi %1825, %c32_i32_4017 : i32
          %c32_i32_4018 = arith.constant 32 : i32
          %1827 = arith.divsi %1825, %c32_i32_4018 : i32
          %c4_i32_4019 = arith.constant 4 : i32
          %1828 = arith.remsi %1827, %c4_i32_4019 : i32
          %c32_i32_4020 = arith.constant 32 : i32
          %1829 = arith.remsi %1826, %c32_i32_4020 : i32
          %c4_i32_4021 = arith.constant 4 : i32
          %1830 = arith.remsi %1828, %c4_i32_4021 : i32
          %c4_i32_4022 = arith.constant 4 : i32
          %1831 = arith.divsi %1829, %c4_i32_4022 : i32
          %c4_i32_4023 = arith.constant 4 : i32
          %1832 = arith.remsi %1829, %c4_i32_4023 : i32
          %c2_i32_4024 = arith.constant 2 : i32
          %1833 = arith.muli %1832, %c2_i32_4024 : i32
          %c16_i32_4025 = arith.constant 16 : i32
          %1834 = arith.muli %1830, %c16_i32_4025 : i32
          %1835 = arith.addi %1831, %1834 : i32
          %iv_4026 = cute.assume(%1833) : (i32) -> !cute.i32<divby 2>
          %int_tuple_4027 = cute.make_int_tuple(%1835, %iv_4026) : (i32, !cute.i32<divby 2>) -> !cute.int_tuple<"(?,?{div=2})">
          %tup_4028 = cute.add_offset(%iter_4016, %int_tuple_4027) : (!cute.int_tuple<"(?{div=64},?{div=64})">, !cute.int_tuple<"(?,?{div=2})">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4029 = cute.make_view(%tup_4028) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %iter_4030 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %e0_4031, %e1_4032 = cute.get_leaves(%iter_4030) : !cute.int_tuple<"(?,?{div=2})">
          %1836 = cute.get_scalars(%e0_4031) : !cute.int_tuple<"?">
          %1837 = cute.get_scalars(%e1_4032) : !cute.int_tuple<"?{div=2}">
          %lay_4033 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %1838 = cute.get_shape(%lay_4033) : (!cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4034, %e1_4035, %e2_4036, %e3_4037 = cute.get_leaves(%1838) : !cute.shape<"((2,2),1,8)">
          %int_tuple_4038 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_4039 = cute.size(%int_tuple_4038) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_4040 = cute.get_leaves(%sz_4039) : !cute.int_tuple<"4">
          %int_tuple_4041 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4042 = cute.size(%int_tuple_4041) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4043 = cute.get_leaves(%sz_4042) : !cute.int_tuple<"1">
          %int_tuple_4044 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4045 = cute.size(%int_tuple_4044) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4046 = cute.get_leaves(%sz_4045) : !cute.int_tuple<"8">
          %coord_4047 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_4048 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4049 = cute.crd2idx(%coord_4047, %lay_4048) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_4050 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4051 = cute.add_offset(%iter_4050, %idx_4049) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4052 = cute.make_view(%tup_4051) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4053 = cute.get_iter(%view_4052) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4054, %e1_4055 = cute.get_leaves(%iter_4053) : !cute.int_tuple<"(?,?{div=2})">
          %1839 = cute.get_scalars(%e0_4054) : !cute.int_tuple<"?">
          %1840 = cute.get_scalars(%e1_4055) : !cute.int_tuple<"?{div=2}">
          %iter_4056 = cute.get_iter(%view_4052) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4057, %e1_4058 = cute.get_leaves(%iter_4056) : !cute.int_tuple<"(?,?{div=2})">
          %1841 = cute.get_scalars(%e0_4057) : !cute.int_tuple<"?">
          %1842 = cute.get_scalars(%e1_4058) : !cute.int_tuple<"?{div=2}">
          %iter_4059 = cute.get_iter(%view_4052) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4060, %e1_4061 = cute.get_leaves(%iter_4059) : !cute.int_tuple<"(?,?{div=2})">
          %1843 = cute.get_scalars(%e0_4060) : !cute.int_tuple<"?">
          %1844 = cute.get_scalars(%e1_4061) : !cute.int_tuple<"?{div=2}">
          %coord_4062 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_4063 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4064 = cute.crd2idx(%coord_4062, %lay_4063) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_4065 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4066 = cute.add_offset(%iter_4065, %idx_4064) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4067 = cute.make_view(%tup_4066) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4068 = cute.get_iter(%view_4067) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4069, %e1_4070 = cute.get_leaves(%iter_4068) : !cute.int_tuple<"(?,?{div=2})">
          %1845 = cute.get_scalars(%e0_4069) : !cute.int_tuple<"?">
          %1846 = cute.get_scalars(%e1_4070) : !cute.int_tuple<"?{div=2}">
          %iter_4071 = cute.get_iter(%view_4067) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4072, %e1_4073 = cute.get_leaves(%iter_4071) : !cute.int_tuple<"(?,?{div=2})">
          %1847 = cute.get_scalars(%e0_4072) : !cute.int_tuple<"?">
          %1848 = cute.get_scalars(%e1_4073) : !cute.int_tuple<"?{div=2}">
          %iter_4074 = cute.get_iter(%view_4067) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4075, %e1_4076 = cute.get_leaves(%iter_4074) : !cute.int_tuple<"(?,?{div=2})">
          %1849 = cute.get_scalars(%e0_4075) : !cute.int_tuple<"?">
          %1850 = cute.get_scalars(%e1_4076) : !cute.int_tuple<"?{div=2}">
          %coord_4077 = cute.make_coord(%e0_4060) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4078 = cute.make_coord(%e1_4076) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1851 = cute.get_scalars(%coord_4077) : !cute.coord<"?">
          %1852 = cute.get_scalars(%coord_4078) : !cute.coord<"?{div=2}">
          %true_4079 = arith.constant true
          %1853 = arith.cmpi slt, %1851, %1852 : i32
          %1854 = arith.andi %true_4079, %1853 : i1
          %lay_4080 = cute.get_layout(%1688) : !memref_rmem_f32_1
          %1855 = cute.get_shape(%lay_4080) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4081, %e1_4082, %e2_4083, %e3_4084 = cute.get_leaves(%1855) : !cute.shape<"((2,2),1,8)">
          %1856 = cute.get_stride(%lay_4080) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4085, %e1_4086, %e2_4087, %e3_4088 = cute.get_leaves(%1856) : !cute.stride<"((1,2),0,4)">
          %1857 = scf.if %1854 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1688) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
            cute.memref.store(%1688, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1688) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1688 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1688) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1688) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1688 : !memref_rmem_f32_1
          }
          %iter_4089 = cute.get_iter(%1857) : !memref_rmem_f32_1
          %lay_4090 = cute.get_layout(%1857) : !memref_rmem_f32_1
          %1858 = cute.get_shape(%lay_4090) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4091, %e1_4092, %e2_4093, %e3_4094 = cute.get_leaves(%1858) : !cute.shape<"((2,2),1,8)">
          %1859 = cute.get_stride(%lay_4090) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4095, %e1_4096, %e2_4097, %e3_4098 = cute.get_leaves(%1859) : !cute.stride<"((1,2),0,4)">
          %iter_4099 = cute.get_iter(%1857) : !memref_rmem_f32_1
          %iter_4100 = cute.get_iter(%1857) : !memref_rmem_f32_1
          %coord_4101 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_4102 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4103 = cute.crd2idx(%coord_4101, %lay_4102) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_4104 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4105 = cute.add_offset(%iter_4104, %idx_4103) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4106 = cute.make_view(%tup_4105) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4107 = cute.get_iter(%view_4106) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4108, %e1_4109 = cute.get_leaves(%iter_4107) : !cute.int_tuple<"(?,?{div=2})">
          %1860 = cute.get_scalars(%e0_4108) : !cute.int_tuple<"?">
          %1861 = cute.get_scalars(%e1_4109) : !cute.int_tuple<"?{div=2}">
          %iter_4110 = cute.get_iter(%view_4106) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4111, %e1_4112 = cute.get_leaves(%iter_4110) : !cute.int_tuple<"(?,?{div=2})">
          %1862 = cute.get_scalars(%e0_4111) : !cute.int_tuple<"?">
          %1863 = cute.get_scalars(%e1_4112) : !cute.int_tuple<"?{div=2}">
          %iter_4113 = cute.get_iter(%view_4106) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4114, %e1_4115 = cute.get_leaves(%iter_4113) : !cute.int_tuple<"(?,?{div=2})">
          %1864 = cute.get_scalars(%e0_4114) : !cute.int_tuple<"?">
          %1865 = cute.get_scalars(%e1_4115) : !cute.int_tuple<"?{div=2}">
          %coord_4116 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_4117 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4118 = cute.crd2idx(%coord_4116, %lay_4117) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_4119 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4120 = cute.add_offset(%iter_4119, %idx_4118) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4121 = cute.make_view(%tup_4120) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4122 = cute.get_iter(%view_4121) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4123, %e1_4124 = cute.get_leaves(%iter_4122) : !cute.int_tuple<"(?,?{div=2})">
          %1866 = cute.get_scalars(%e0_4123) : !cute.int_tuple<"?">
          %1867 = cute.get_scalars(%e1_4124) : !cute.int_tuple<"?{div=2}">
          %iter_4125 = cute.get_iter(%view_4121) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4126, %e1_4127 = cute.get_leaves(%iter_4125) : !cute.int_tuple<"(?,?{div=2})">
          %1868 = cute.get_scalars(%e0_4126) : !cute.int_tuple<"?">
          %1869 = cute.get_scalars(%e1_4127) : !cute.int_tuple<"?{div=2}">
          %iter_4128 = cute.get_iter(%view_4121) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4129, %e1_4130 = cute.get_leaves(%iter_4128) : !cute.int_tuple<"(?,?{div=2})">
          %1870 = cute.get_scalars(%e0_4129) : !cute.int_tuple<"?">
          %1871 = cute.get_scalars(%e1_4130) : !cute.int_tuple<"?{div=2}">
          %coord_4131 = cute.make_coord(%e0_4114) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4132 = cute.make_coord(%e1_4130) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1872 = cute.get_scalars(%coord_4131) : !cute.coord<"?">
          %1873 = cute.get_scalars(%coord_4132) : !cute.coord<"?{div=2}">
          %true_4133 = arith.constant true
          %1874 = arith.cmpi slt, %1872, %1873 : i32
          %1875 = arith.andi %true_4133, %1874 : i1
          %lay_4134 = cute.get_layout(%1857) : !memref_rmem_f32_1
          %1876 = cute.get_shape(%lay_4134) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4135, %e1_4136, %e2_4137, %e3_4138 = cute.get_leaves(%1876) : !cute.shape<"((2,2),1,8)">
          %1877 = cute.get_stride(%lay_4134) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4139, %e1_4140, %e2_4141, %e3_4142 = cute.get_leaves(%1877) : !cute.stride<"((1,2),0,4)">
          %1878 = scf.if %1875 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1857) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
            cute.memref.store(%1857, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1857) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1857 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1857) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1857) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1857 : !memref_rmem_f32_1
          }
          %iter_4143 = cute.get_iter(%1878) : !memref_rmem_f32_1
          %lay_4144 = cute.get_layout(%1878) : !memref_rmem_f32_1
          %1879 = cute.get_shape(%lay_4144) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4145, %e1_4146, %e2_4147, %e3_4148 = cute.get_leaves(%1879) : !cute.shape<"((2,2),1,8)">
          %1880 = cute.get_stride(%lay_4144) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4149, %e1_4150, %e2_4151, %e3_4152 = cute.get_leaves(%1880) : !cute.stride<"((1,2),0,4)">
          %iter_4153 = cute.get_iter(%1878) : !memref_rmem_f32_1
          %iter_4154 = cute.get_iter(%1878) : !memref_rmem_f32_1
          %coord_4155 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_4156 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4157 = cute.crd2idx(%coord_4155, %lay_4156) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_4158 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4159 = cute.add_offset(%iter_4158, %idx_4157) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4160 = cute.make_view(%tup_4159) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4161 = cute.get_iter(%view_4160) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4162, %e1_4163 = cute.get_leaves(%iter_4161) : !cute.int_tuple<"(?,?{div=2})">
          %1881 = cute.get_scalars(%e0_4162) : !cute.int_tuple<"?">
          %1882 = cute.get_scalars(%e1_4163) : !cute.int_tuple<"?{div=2}">
          %iter_4164 = cute.get_iter(%view_4160) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4165, %e1_4166 = cute.get_leaves(%iter_4164) : !cute.int_tuple<"(?,?{div=2})">
          %1883 = cute.get_scalars(%e0_4165) : !cute.int_tuple<"?">
          %1884 = cute.get_scalars(%e1_4166) : !cute.int_tuple<"?{div=2}">
          %iter_4167 = cute.get_iter(%view_4160) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4168, %e1_4169 = cute.get_leaves(%iter_4167) : !cute.int_tuple<"(?,?{div=2})">
          %1885 = cute.get_scalars(%e0_4168) : !cute.int_tuple<"?">
          %1886 = cute.get_scalars(%e1_4169) : !cute.int_tuple<"?{div=2}">
          %coord_4170 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_4171 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4172 = cute.crd2idx(%coord_4170, %lay_4171) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_4173 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4174 = cute.add_offset(%iter_4173, %idx_4172) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4175 = cute.make_view(%tup_4174) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4176 = cute.get_iter(%view_4175) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4177, %e1_4178 = cute.get_leaves(%iter_4176) : !cute.int_tuple<"(?,?{div=2})">
          %1887 = cute.get_scalars(%e0_4177) : !cute.int_tuple<"?">
          %1888 = cute.get_scalars(%e1_4178) : !cute.int_tuple<"?{div=2}">
          %iter_4179 = cute.get_iter(%view_4175) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4180, %e1_4181 = cute.get_leaves(%iter_4179) : !cute.int_tuple<"(?,?{div=2})">
          %1889 = cute.get_scalars(%e0_4180) : !cute.int_tuple<"?">
          %1890 = cute.get_scalars(%e1_4181) : !cute.int_tuple<"?{div=2}">
          %iter_4182 = cute.get_iter(%view_4175) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4183, %e1_4184 = cute.get_leaves(%iter_4182) : !cute.int_tuple<"(?,?{div=2})">
          %1891 = cute.get_scalars(%e0_4183) : !cute.int_tuple<"?">
          %1892 = cute.get_scalars(%e1_4184) : !cute.int_tuple<"?{div=2}">
          %coord_4185 = cute.make_coord(%e0_4168) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4186 = cute.make_coord(%e1_4184) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1893 = cute.get_scalars(%coord_4185) : !cute.coord<"?">
          %1894 = cute.get_scalars(%coord_4186) : !cute.coord<"?{div=2}">
          %true_4187 = arith.constant true
          %1895 = arith.cmpi slt, %1893, %1894 : i32
          %1896 = arith.andi %true_4187, %1895 : i1
          %lay_4188 = cute.get_layout(%1878) : !memref_rmem_f32_1
          %1897 = cute.get_shape(%lay_4188) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4189, %e1_4190, %e2_4191, %e3_4192 = cute.get_leaves(%1897) : !cute.shape<"((2,2),1,8)">
          %1898 = cute.get_stride(%lay_4188) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4193, %e1_4194, %e2_4195, %e3_4196 = cute.get_leaves(%1898) : !cute.stride<"((1,2),0,4)">
          %1899 = scf.if %1896 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1878) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
            cute.memref.store(%1878, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1878) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1878 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1878) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1878) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1878 : !memref_rmem_f32_1
          }
          %iter_4197 = cute.get_iter(%1899) : !memref_rmem_f32_1
          %lay_4198 = cute.get_layout(%1899) : !memref_rmem_f32_1
          %1900 = cute.get_shape(%lay_4198) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4199, %e1_4200, %e2_4201, %e3_4202 = cute.get_leaves(%1900) : !cute.shape<"((2,2),1,8)">
          %1901 = cute.get_stride(%lay_4198) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4203, %e1_4204, %e2_4205, %e3_4206 = cute.get_leaves(%1901) : !cute.stride<"((1,2),0,4)">
          %iter_4207 = cute.get_iter(%1899) : !memref_rmem_f32_1
          %iter_4208 = cute.get_iter(%1899) : !memref_rmem_f32_1
          %coord_4209 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_4210 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4211 = cute.crd2idx(%coord_4209, %lay_4210) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_4212 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4213 = cute.add_offset(%iter_4212, %idx_4211) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4214 = cute.make_view(%tup_4213) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4215 = cute.get_iter(%view_4214) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4216, %e1_4217 = cute.get_leaves(%iter_4215) : !cute.int_tuple<"(?,?{div=2})">
          %1902 = cute.get_scalars(%e0_4216) : !cute.int_tuple<"?">
          %1903 = cute.get_scalars(%e1_4217) : !cute.int_tuple<"?{div=2}">
          %iter_4218 = cute.get_iter(%view_4214) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4219, %e1_4220 = cute.get_leaves(%iter_4218) : !cute.int_tuple<"(?,?{div=2})">
          %1904 = cute.get_scalars(%e0_4219) : !cute.int_tuple<"?">
          %1905 = cute.get_scalars(%e1_4220) : !cute.int_tuple<"?{div=2}">
          %iter_4221 = cute.get_iter(%view_4214) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4222, %e1_4223 = cute.get_leaves(%iter_4221) : !cute.int_tuple<"(?,?{div=2})">
          %1906 = cute.get_scalars(%e0_4222) : !cute.int_tuple<"?">
          %1907 = cute.get_scalars(%e1_4223) : !cute.int_tuple<"?{div=2}">
          %coord_4224 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_4225 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4226 = cute.crd2idx(%coord_4224, %lay_4225) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_4227 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4228 = cute.add_offset(%iter_4227, %idx_4226) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4229 = cute.make_view(%tup_4228) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4230 = cute.get_iter(%view_4229) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4231, %e1_4232 = cute.get_leaves(%iter_4230) : !cute.int_tuple<"(?,?{div=2})">
          %1908 = cute.get_scalars(%e0_4231) : !cute.int_tuple<"?">
          %1909 = cute.get_scalars(%e1_4232) : !cute.int_tuple<"?{div=2}">
          %iter_4233 = cute.get_iter(%view_4229) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4234, %e1_4235 = cute.get_leaves(%iter_4233) : !cute.int_tuple<"(?,?{div=2})">
          %1910 = cute.get_scalars(%e0_4234) : !cute.int_tuple<"?">
          %1911 = cute.get_scalars(%e1_4235) : !cute.int_tuple<"?{div=2}">
          %iter_4236 = cute.get_iter(%view_4229) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4237, %e1_4238 = cute.get_leaves(%iter_4236) : !cute.int_tuple<"(?,?{div=2})">
          %1912 = cute.get_scalars(%e0_4237) : !cute.int_tuple<"?">
          %1913 = cute.get_scalars(%e1_4238) : !cute.int_tuple<"?{div=2}">
          %coord_4239 = cute.make_coord(%e0_4222) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4240 = cute.make_coord(%e1_4238) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1914 = cute.get_scalars(%coord_4239) : !cute.coord<"?">
          %1915 = cute.get_scalars(%coord_4240) : !cute.coord<"?{div=2}">
          %true_4241 = arith.constant true
          %1916 = arith.cmpi slt, %1914, %1915 : i32
          %1917 = arith.andi %true_4241, %1916 : i1
          %lay_4242 = cute.get_layout(%1899) : !memref_rmem_f32_1
          %1918 = cute.get_shape(%lay_4242) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4243, %e1_4244, %e2_4245, %e3_4246 = cute.get_leaves(%1918) : !cute.shape<"((2,2),1,8)">
          %1919 = cute.get_stride(%lay_4242) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4247, %e1_4248, %e2_4249, %e3_4250 = cute.get_leaves(%1919) : !cute.stride<"((1,2),0,4)">
          %1920 = scf.if %1917 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1899) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
            cute.memref.store(%1899, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1899) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1899 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1899) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1899) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1899 : !memref_rmem_f32_1
          }
          %iter_4251 = cute.get_iter(%1920) : !memref_rmem_f32_1
          %lay_4252 = cute.get_layout(%1920) : !memref_rmem_f32_1
          %1921 = cute.get_shape(%lay_4252) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4253, %e1_4254, %e2_4255, %e3_4256 = cute.get_leaves(%1921) : !cute.shape<"((2,2),1,8)">
          %1922 = cute.get_stride(%lay_4252) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4257, %e1_4258, %e2_4259, %e3_4260 = cute.get_leaves(%1922) : !cute.stride<"((1,2),0,4)">
          %iter_4261 = cute.get_iter(%1920) : !memref_rmem_f32_1
          %iter_4262 = cute.get_iter(%1920) : !memref_rmem_f32_1
          %coord_4263 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_4264 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4265 = cute.crd2idx(%coord_4263, %lay_4264) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_4266 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4267 = cute.add_offset(%iter_4266, %idx_4265) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4268 = cute.make_view(%tup_4267) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4269 = cute.get_iter(%view_4268) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4270, %e1_4271 = cute.get_leaves(%iter_4269) : !cute.int_tuple<"(?,?{div=2})">
          %1923 = cute.get_scalars(%e0_4270) : !cute.int_tuple<"?">
          %1924 = cute.get_scalars(%e1_4271) : !cute.int_tuple<"?{div=2}">
          %iter_4272 = cute.get_iter(%view_4268) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4273, %e1_4274 = cute.get_leaves(%iter_4272) : !cute.int_tuple<"(?,?{div=2})">
          %1925 = cute.get_scalars(%e0_4273) : !cute.int_tuple<"?">
          %1926 = cute.get_scalars(%e1_4274) : !cute.int_tuple<"?{div=2}">
          %iter_4275 = cute.get_iter(%view_4268) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4276, %e1_4277 = cute.get_leaves(%iter_4275) : !cute.int_tuple<"(?,?{div=2})">
          %1927 = cute.get_scalars(%e0_4276) : !cute.int_tuple<"?">
          %1928 = cute.get_scalars(%e1_4277) : !cute.int_tuple<"?{div=2}">
          %coord_4278 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_4279 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4280 = cute.crd2idx(%coord_4278, %lay_4279) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_4281 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4282 = cute.add_offset(%iter_4281, %idx_4280) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4283 = cute.make_view(%tup_4282) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4284 = cute.get_iter(%view_4283) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4285, %e1_4286 = cute.get_leaves(%iter_4284) : !cute.int_tuple<"(?,?{div=2})">
          %1929 = cute.get_scalars(%e0_4285) : !cute.int_tuple<"?">
          %1930 = cute.get_scalars(%e1_4286) : !cute.int_tuple<"?{div=2}">
          %iter_4287 = cute.get_iter(%view_4283) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4288, %e1_4289 = cute.get_leaves(%iter_4287) : !cute.int_tuple<"(?,?{div=2})">
          %1931 = cute.get_scalars(%e0_4288) : !cute.int_tuple<"?">
          %1932 = cute.get_scalars(%e1_4289) : !cute.int_tuple<"?{div=2}">
          %iter_4290 = cute.get_iter(%view_4283) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4291, %e1_4292 = cute.get_leaves(%iter_4290) : !cute.int_tuple<"(?,?{div=2})">
          %1933 = cute.get_scalars(%e0_4291) : !cute.int_tuple<"?">
          %1934 = cute.get_scalars(%e1_4292) : !cute.int_tuple<"?{div=2}">
          %coord_4293 = cute.make_coord(%e0_4276) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4294 = cute.make_coord(%e1_4292) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1935 = cute.get_scalars(%coord_4293) : !cute.coord<"?">
          %1936 = cute.get_scalars(%coord_4294) : !cute.coord<"?{div=2}">
          %true_4295 = arith.constant true
          %1937 = arith.cmpi slt, %1935, %1936 : i32
          %1938 = arith.andi %true_4295, %1937 : i1
          %lay_4296 = cute.get_layout(%1920) : !memref_rmem_f32_1
          %1939 = cute.get_shape(%lay_4296) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4297, %e1_4298, %e2_4299, %e3_4300 = cute.get_leaves(%1939) : !cute.shape<"((2,2),1,8)">
          %1940 = cute.get_stride(%lay_4296) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4301, %e1_4302, %e2_4303, %e3_4304 = cute.get_leaves(%1940) : !cute.stride<"((1,2),0,4)">
          %1941 = scf.if %1938 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1920) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
            cute.memref.store(%1920, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1920) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1920 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1920) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1920) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1920 : !memref_rmem_f32_1
          }
          %iter_4305 = cute.get_iter(%1941) : !memref_rmem_f32_1
          %lay_4306 = cute.get_layout(%1941) : !memref_rmem_f32_1
          %1942 = cute.get_shape(%lay_4306) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4307, %e1_4308, %e2_4309, %e3_4310 = cute.get_leaves(%1942) : !cute.shape<"((2,2),1,8)">
          %1943 = cute.get_stride(%lay_4306) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4311, %e1_4312, %e2_4313, %e3_4314 = cute.get_leaves(%1943) : !cute.stride<"((1,2),0,4)">
          %iter_4315 = cute.get_iter(%1941) : !memref_rmem_f32_1
          %iter_4316 = cute.get_iter(%1941) : !memref_rmem_f32_1
          %coord_4317 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_4318 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4319 = cute.crd2idx(%coord_4317, %lay_4318) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_4320 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4321 = cute.add_offset(%iter_4320, %idx_4319) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4322 = cute.make_view(%tup_4321) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4323 = cute.get_iter(%view_4322) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4324, %e1_4325 = cute.get_leaves(%iter_4323) : !cute.int_tuple<"(?,?{div=2})">
          %1944 = cute.get_scalars(%e0_4324) : !cute.int_tuple<"?">
          %1945 = cute.get_scalars(%e1_4325) : !cute.int_tuple<"?{div=2}">
          %iter_4326 = cute.get_iter(%view_4322) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4327, %e1_4328 = cute.get_leaves(%iter_4326) : !cute.int_tuple<"(?,?{div=2})">
          %1946 = cute.get_scalars(%e0_4327) : !cute.int_tuple<"?">
          %1947 = cute.get_scalars(%e1_4328) : !cute.int_tuple<"?{div=2}">
          %iter_4329 = cute.get_iter(%view_4322) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4330, %e1_4331 = cute.get_leaves(%iter_4329) : !cute.int_tuple<"(?,?{div=2})">
          %1948 = cute.get_scalars(%e0_4330) : !cute.int_tuple<"?">
          %1949 = cute.get_scalars(%e1_4331) : !cute.int_tuple<"?{div=2}">
          %coord_4332 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_4333 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4334 = cute.crd2idx(%coord_4332, %lay_4333) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_4335 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4336 = cute.add_offset(%iter_4335, %idx_4334) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4337 = cute.make_view(%tup_4336) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4338 = cute.get_iter(%view_4337) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4339, %e1_4340 = cute.get_leaves(%iter_4338) : !cute.int_tuple<"(?,?{div=2})">
          %1950 = cute.get_scalars(%e0_4339) : !cute.int_tuple<"?">
          %1951 = cute.get_scalars(%e1_4340) : !cute.int_tuple<"?{div=2}">
          %iter_4341 = cute.get_iter(%view_4337) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4342, %e1_4343 = cute.get_leaves(%iter_4341) : !cute.int_tuple<"(?,?{div=2})">
          %1952 = cute.get_scalars(%e0_4342) : !cute.int_tuple<"?">
          %1953 = cute.get_scalars(%e1_4343) : !cute.int_tuple<"?{div=2}">
          %iter_4344 = cute.get_iter(%view_4337) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4345, %e1_4346 = cute.get_leaves(%iter_4344) : !cute.int_tuple<"(?,?{div=2})">
          %1954 = cute.get_scalars(%e0_4345) : !cute.int_tuple<"?">
          %1955 = cute.get_scalars(%e1_4346) : !cute.int_tuple<"?{div=2}">
          %coord_4347 = cute.make_coord(%e0_4330) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4348 = cute.make_coord(%e1_4346) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1956 = cute.get_scalars(%coord_4347) : !cute.coord<"?">
          %1957 = cute.get_scalars(%coord_4348) : !cute.coord<"?{div=2}">
          %true_4349 = arith.constant true
          %1958 = arith.cmpi slt, %1956, %1957 : i32
          %1959 = arith.andi %true_4349, %1958 : i1
          %lay_4350 = cute.get_layout(%1941) : !memref_rmem_f32_1
          %1960 = cute.get_shape(%lay_4350) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4351, %e1_4352, %e2_4353, %e3_4354 = cute.get_leaves(%1960) : !cute.shape<"((2,2),1,8)">
          %1961 = cute.get_stride(%lay_4350) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4355, %e1_4356, %e2_4357, %e3_4358 = cute.get_leaves(%1961) : !cute.stride<"((1,2),0,4)">
          %1962 = scf.if %1959 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1941) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
            cute.memref.store(%1941, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1941) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1941 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1941) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1941) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1941 : !memref_rmem_f32_1
          }
          %iter_4359 = cute.get_iter(%1962) : !memref_rmem_f32_1
          %lay_4360 = cute.get_layout(%1962) : !memref_rmem_f32_1
          %1963 = cute.get_shape(%lay_4360) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4361, %e1_4362, %e2_4363, %e3_4364 = cute.get_leaves(%1963) : !cute.shape<"((2,2),1,8)">
          %1964 = cute.get_stride(%lay_4360) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4365, %e1_4366, %e2_4367, %e3_4368 = cute.get_leaves(%1964) : !cute.stride<"((1,2),0,4)">
          %iter_4369 = cute.get_iter(%1962) : !memref_rmem_f32_1
          %iter_4370 = cute.get_iter(%1962) : !memref_rmem_f32_1
          %coord_4371 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_4372 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4373 = cute.crd2idx(%coord_4371, %lay_4372) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_4374 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4375 = cute.add_offset(%iter_4374, %idx_4373) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4376 = cute.make_view(%tup_4375) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4377 = cute.get_iter(%view_4376) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4378, %e1_4379 = cute.get_leaves(%iter_4377) : !cute.int_tuple<"(?,?{div=2})">
          %1965 = cute.get_scalars(%e0_4378) : !cute.int_tuple<"?">
          %1966 = cute.get_scalars(%e1_4379) : !cute.int_tuple<"?{div=2}">
          %iter_4380 = cute.get_iter(%view_4376) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4381, %e1_4382 = cute.get_leaves(%iter_4380) : !cute.int_tuple<"(?,?{div=2})">
          %1967 = cute.get_scalars(%e0_4381) : !cute.int_tuple<"?">
          %1968 = cute.get_scalars(%e1_4382) : !cute.int_tuple<"?{div=2}">
          %iter_4383 = cute.get_iter(%view_4376) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4384, %e1_4385 = cute.get_leaves(%iter_4383) : !cute.int_tuple<"(?,?{div=2})">
          %1969 = cute.get_scalars(%e0_4384) : !cute.int_tuple<"?">
          %1970 = cute.get_scalars(%e1_4385) : !cute.int_tuple<"?{div=2}">
          %coord_4386 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_4387 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4388 = cute.crd2idx(%coord_4386, %lay_4387) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_4389 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4390 = cute.add_offset(%iter_4389, %idx_4388) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4391 = cute.make_view(%tup_4390) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4392 = cute.get_iter(%view_4391) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4393, %e1_4394 = cute.get_leaves(%iter_4392) : !cute.int_tuple<"(?,?{div=2})">
          %1971 = cute.get_scalars(%e0_4393) : !cute.int_tuple<"?">
          %1972 = cute.get_scalars(%e1_4394) : !cute.int_tuple<"?{div=2}">
          %iter_4395 = cute.get_iter(%view_4391) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4396, %e1_4397 = cute.get_leaves(%iter_4395) : !cute.int_tuple<"(?,?{div=2})">
          %1973 = cute.get_scalars(%e0_4396) : !cute.int_tuple<"?">
          %1974 = cute.get_scalars(%e1_4397) : !cute.int_tuple<"?{div=2}">
          %iter_4398 = cute.get_iter(%view_4391) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4399, %e1_4400 = cute.get_leaves(%iter_4398) : !cute.int_tuple<"(?,?{div=2})">
          %1975 = cute.get_scalars(%e0_4399) : !cute.int_tuple<"?">
          %1976 = cute.get_scalars(%e1_4400) : !cute.int_tuple<"?{div=2}">
          %coord_4401 = cute.make_coord(%e0_4384) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4402 = cute.make_coord(%e1_4400) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1977 = cute.get_scalars(%coord_4401) : !cute.coord<"?">
          %1978 = cute.get_scalars(%coord_4402) : !cute.coord<"?{div=2}">
          %true_4403 = arith.constant true
          %1979 = arith.cmpi slt, %1977, %1978 : i32
          %1980 = arith.andi %true_4403, %1979 : i1
          %lay_4404 = cute.get_layout(%1962) : !memref_rmem_f32_1
          %1981 = cute.get_shape(%lay_4404) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4405, %e1_4406, %e2_4407, %e3_4408 = cute.get_leaves(%1981) : !cute.shape<"((2,2),1,8)">
          %1982 = cute.get_stride(%lay_4404) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4409, %e1_4410, %e2_4411, %e3_4412 = cute.get_leaves(%1982) : !cute.stride<"((1,2),0,4)">
          %1983 = scf.if %1980 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1962) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
            cute.memref.store(%1962, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1962) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1962 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1962) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1962) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1962 : !memref_rmem_f32_1
          }
          %iter_4413 = cute.get_iter(%1983) : !memref_rmem_f32_1
          %lay_4414 = cute.get_layout(%1983) : !memref_rmem_f32_1
          %1984 = cute.get_shape(%lay_4414) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4415, %e1_4416, %e2_4417, %e3_4418 = cute.get_leaves(%1984) : !cute.shape<"((2,2),1,8)">
          %1985 = cute.get_stride(%lay_4414) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4419, %e1_4420, %e2_4421, %e3_4422 = cute.get_leaves(%1985) : !cute.stride<"((1,2),0,4)">
          %iter_4423 = cute.get_iter(%1983) : !memref_rmem_f32_1
          %iter_4424 = cute.get_iter(%1983) : !memref_rmem_f32_1
          %coord_4425 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_4426 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4427 = cute.crd2idx(%coord_4425, %lay_4426) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_4428 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4429 = cute.add_offset(%iter_4428, %idx_4427) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4430 = cute.make_view(%tup_4429) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4431 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4432, %e1_4433 = cute.get_leaves(%iter_4431) : !cute.int_tuple<"(?,?{div=2})">
          %1986 = cute.get_scalars(%e0_4432) : !cute.int_tuple<"?">
          %1987 = cute.get_scalars(%e1_4433) : !cute.int_tuple<"?{div=2}">
          %iter_4434 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4435, %e1_4436 = cute.get_leaves(%iter_4434) : !cute.int_tuple<"(?,?{div=2})">
          %1988 = cute.get_scalars(%e0_4435) : !cute.int_tuple<"?">
          %1989 = cute.get_scalars(%e1_4436) : !cute.int_tuple<"?{div=2}">
          %iter_4437 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4438, %e1_4439 = cute.get_leaves(%iter_4437) : !cute.int_tuple<"(?,?{div=2})">
          %1990 = cute.get_scalars(%e0_4438) : !cute.int_tuple<"?">
          %1991 = cute.get_scalars(%e1_4439) : !cute.int_tuple<"?{div=2}">
          %coord_4440 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_4441 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4442 = cute.crd2idx(%coord_4440, %lay_4441) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_4443 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4444 = cute.add_offset(%iter_4443, %idx_4442) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4445 = cute.make_view(%tup_4444) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4446 = cute.get_iter(%view_4445) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4447, %e1_4448 = cute.get_leaves(%iter_4446) : !cute.int_tuple<"(?,?{div=2})">
          %1992 = cute.get_scalars(%e0_4447) : !cute.int_tuple<"?">
          %1993 = cute.get_scalars(%e1_4448) : !cute.int_tuple<"?{div=2}">
          %iter_4449 = cute.get_iter(%view_4445) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4450, %e1_4451 = cute.get_leaves(%iter_4449) : !cute.int_tuple<"(?,?{div=2})">
          %1994 = cute.get_scalars(%e0_4450) : !cute.int_tuple<"?">
          %1995 = cute.get_scalars(%e1_4451) : !cute.int_tuple<"?{div=2}">
          %iter_4452 = cute.get_iter(%view_4445) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4453, %e1_4454 = cute.get_leaves(%iter_4452) : !cute.int_tuple<"(?,?{div=2})">
          %1996 = cute.get_scalars(%e0_4453) : !cute.int_tuple<"?">
          %1997 = cute.get_scalars(%e1_4454) : !cute.int_tuple<"?{div=2}">
          %coord_4455 = cute.make_coord(%e0_4438) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4456 = cute.make_coord(%e1_4454) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1998 = cute.get_scalars(%coord_4455) : !cute.coord<"?">
          %1999 = cute.get_scalars(%coord_4456) : !cute.coord<"?{div=2}">
          %true_4457 = arith.constant true
          %2000 = arith.cmpi slt, %1998, %1999 : i32
          %2001 = arith.andi %true_4457, %2000 : i1
          %lay_4458 = cute.get_layout(%1983) : !memref_rmem_f32_1
          %2002 = cute.get_shape(%lay_4458) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4459, %e1_4460, %e2_4461, %e3_4462 = cute.get_leaves(%2002) : !cute.shape<"((2,2),1,8)">
          %2003 = cute.get_stride(%lay_4458) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4463, %e1_4464, %e2_4465, %e3_4466 = cute.get_leaves(%2003) : !cute.stride<"((1,2),0,4)">
          %2004 = scf.if %2001 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%1983) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
            cute.memref.store(%1983, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
            %lay_5853 = cute.get_layout(%1983) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1983 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%1983) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%1983) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %1983 : !memref_rmem_f32_1
          }
          %iter_4467 = cute.get_iter(%2004) : !memref_rmem_f32_1
          %lay_4468 = cute.get_layout(%2004) : !memref_rmem_f32_1
          %2005 = cute.get_shape(%lay_4468) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4469, %e1_4470, %e2_4471, %e3_4472 = cute.get_leaves(%2005) : !cute.shape<"((2,2),1,8)">
          %2006 = cute.get_stride(%lay_4468) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4473, %e1_4474, %e2_4475, %e3_4476 = cute.get_leaves(%2006) : !cute.stride<"((1,2),0,4)">
          %iter_4477 = cute.get_iter(%2004) : !memref_rmem_f32_1
          %iter_4478 = cute.get_iter(%2004) : !memref_rmem_f32_1
          %int_tuple_4479 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4480 = cute.size(%int_tuple_4479) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4481 = cute.get_leaves(%sz_4480) : !cute.int_tuple<"1">
          %int_tuple_4482 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4483 = cute.size(%int_tuple_4482) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4484 = cute.get_leaves(%sz_4483) : !cute.int_tuple<"8">
          %coord_4485 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_4486 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4487 = cute.crd2idx(%coord_4485, %lay_4486) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_4488 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4489 = cute.add_offset(%iter_4488, %idx_4487) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4490 = cute.make_view(%tup_4489) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4491 = cute.get_iter(%view_4490) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4492, %e1_4493 = cute.get_leaves(%iter_4491) : !cute.int_tuple<"(?,?)">
          %2007 = cute.get_scalars(%e0_4492) : !cute.int_tuple<"?">
          %2008 = cute.get_scalars(%e1_4493) : !cute.int_tuple<"?">
          %iter_4494 = cute.get_iter(%view_4490) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4495, %e1_4496 = cute.get_leaves(%iter_4494) : !cute.int_tuple<"(?,?)">
          %2009 = cute.get_scalars(%e0_4495) : !cute.int_tuple<"?">
          %2010 = cute.get_scalars(%e1_4496) : !cute.int_tuple<"?">
          %iter_4497 = cute.get_iter(%view_4490) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4498, %e1_4499 = cute.get_leaves(%iter_4497) : !cute.int_tuple<"(?,?)">
          %2011 = cute.get_scalars(%e0_4498) : !cute.int_tuple<"?">
          %2012 = cute.get_scalars(%e1_4499) : !cute.int_tuple<"?">
          %coord_4500 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_4501 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4502 = cute.crd2idx(%coord_4500, %lay_4501) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_4503 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4504 = cute.add_offset(%iter_4503, %idx_4502) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4505 = cute.make_view(%tup_4504) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4506 = cute.get_iter(%view_4505) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4507, %e1_4508 = cute.get_leaves(%iter_4506) : !cute.int_tuple<"(?,?)">
          %2013 = cute.get_scalars(%e0_4507) : !cute.int_tuple<"?">
          %2014 = cute.get_scalars(%e1_4508) : !cute.int_tuple<"?">
          %iter_4509 = cute.get_iter(%view_4505) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4510, %e1_4511 = cute.get_leaves(%iter_4509) : !cute.int_tuple<"(?,?)">
          %2015 = cute.get_scalars(%e0_4510) : !cute.int_tuple<"?">
          %2016 = cute.get_scalars(%e1_4511) : !cute.int_tuple<"?">
          %iter_4512 = cute.get_iter(%view_4505) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4513, %e1_4514 = cute.get_leaves(%iter_4512) : !cute.int_tuple<"(?,?)">
          %2017 = cute.get_scalars(%e0_4513) : !cute.int_tuple<"?">
          %2018 = cute.get_scalars(%e1_4514) : !cute.int_tuple<"?">
          %coord_4515 = cute.make_coord(%e0_4498) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4516 = cute.make_coord(%e1_4514) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2019 = cute.get_scalars(%coord_4515) : !cute.coord<"?">
          %2020 = cute.get_scalars(%coord_4516) : !cute.coord<"?">
          %true_4517 = arith.constant true
          %2021 = arith.cmpi slt, %2019, %2020 : i32
          %2022 = arith.andi %true_4517, %2021 : i1
          %lay_4518 = cute.get_layout(%2004) : !memref_rmem_f32_1
          %2023 = cute.get_shape(%lay_4518) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4519, %e1_4520, %e2_4521, %e3_4522 = cute.get_leaves(%2023) : !cute.shape<"((2,2),1,8)">
          %2024 = cute.get_stride(%lay_4518) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4523, %e1_4524, %e2_4525, %e3_4526 = cute.get_leaves(%2024) : !cute.stride<"((1,2),0,4)">
          %2025 = scf.if %2022 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2004) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
            cute.memref.store(%2004, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2004) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2004 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2004) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2004) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2004 : !memref_rmem_f32_1
          }
          %iter_4527 = cute.get_iter(%2025) : !memref_rmem_f32_1
          %lay_4528 = cute.get_layout(%2025) : !memref_rmem_f32_1
          %2026 = cute.get_shape(%lay_4528) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4529, %e1_4530, %e2_4531, %e3_4532 = cute.get_leaves(%2026) : !cute.shape<"((2,2),1,8)">
          %2027 = cute.get_stride(%lay_4528) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4533, %e1_4534, %e2_4535, %e3_4536 = cute.get_leaves(%2027) : !cute.stride<"((1,2),0,4)">
          %iter_4537 = cute.get_iter(%2025) : !memref_rmem_f32_1
          %iter_4538 = cute.get_iter(%2025) : !memref_rmem_f32_1
          %coord_4539 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_4540 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4541 = cute.crd2idx(%coord_4539, %lay_4540) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_4542 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4543 = cute.add_offset(%iter_4542, %idx_4541) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4544 = cute.make_view(%tup_4543) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4545 = cute.get_iter(%view_4544) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4546, %e1_4547 = cute.get_leaves(%iter_4545) : !cute.int_tuple<"(?,?)">
          %2028 = cute.get_scalars(%e0_4546) : !cute.int_tuple<"?">
          %2029 = cute.get_scalars(%e1_4547) : !cute.int_tuple<"?">
          %iter_4548 = cute.get_iter(%view_4544) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4549, %e1_4550 = cute.get_leaves(%iter_4548) : !cute.int_tuple<"(?,?)">
          %2030 = cute.get_scalars(%e0_4549) : !cute.int_tuple<"?">
          %2031 = cute.get_scalars(%e1_4550) : !cute.int_tuple<"?">
          %iter_4551 = cute.get_iter(%view_4544) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4552, %e1_4553 = cute.get_leaves(%iter_4551) : !cute.int_tuple<"(?,?)">
          %2032 = cute.get_scalars(%e0_4552) : !cute.int_tuple<"?">
          %2033 = cute.get_scalars(%e1_4553) : !cute.int_tuple<"?">
          %coord_4554 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_4555 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4556 = cute.crd2idx(%coord_4554, %lay_4555) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_4557 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4558 = cute.add_offset(%iter_4557, %idx_4556) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4559 = cute.make_view(%tup_4558) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4560 = cute.get_iter(%view_4559) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4561, %e1_4562 = cute.get_leaves(%iter_4560) : !cute.int_tuple<"(?,?)">
          %2034 = cute.get_scalars(%e0_4561) : !cute.int_tuple<"?">
          %2035 = cute.get_scalars(%e1_4562) : !cute.int_tuple<"?">
          %iter_4563 = cute.get_iter(%view_4559) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4564, %e1_4565 = cute.get_leaves(%iter_4563) : !cute.int_tuple<"(?,?)">
          %2036 = cute.get_scalars(%e0_4564) : !cute.int_tuple<"?">
          %2037 = cute.get_scalars(%e1_4565) : !cute.int_tuple<"?">
          %iter_4566 = cute.get_iter(%view_4559) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4567, %e1_4568 = cute.get_leaves(%iter_4566) : !cute.int_tuple<"(?,?)">
          %2038 = cute.get_scalars(%e0_4567) : !cute.int_tuple<"?">
          %2039 = cute.get_scalars(%e1_4568) : !cute.int_tuple<"?">
          %coord_4569 = cute.make_coord(%e0_4552) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4570 = cute.make_coord(%e1_4568) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2040 = cute.get_scalars(%coord_4569) : !cute.coord<"?">
          %2041 = cute.get_scalars(%coord_4570) : !cute.coord<"?">
          %true_4571 = arith.constant true
          %2042 = arith.cmpi slt, %2040, %2041 : i32
          %2043 = arith.andi %true_4571, %2042 : i1
          %lay_4572 = cute.get_layout(%2025) : !memref_rmem_f32_1
          %2044 = cute.get_shape(%lay_4572) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4573, %e1_4574, %e2_4575, %e3_4576 = cute.get_leaves(%2044) : !cute.shape<"((2,2),1,8)">
          %2045 = cute.get_stride(%lay_4572) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4577, %e1_4578, %e2_4579, %e3_4580 = cute.get_leaves(%2045) : !cute.stride<"((1,2),0,4)">
          %2046 = scf.if %2043 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2025) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
            cute.memref.store(%2025, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2025) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2025 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2025) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2025) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2025 : !memref_rmem_f32_1
          }
          %iter_4581 = cute.get_iter(%2046) : !memref_rmem_f32_1
          %lay_4582 = cute.get_layout(%2046) : !memref_rmem_f32_1
          %2047 = cute.get_shape(%lay_4582) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4583, %e1_4584, %e2_4585, %e3_4586 = cute.get_leaves(%2047) : !cute.shape<"((2,2),1,8)">
          %2048 = cute.get_stride(%lay_4582) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4587, %e1_4588, %e2_4589, %e3_4590 = cute.get_leaves(%2048) : !cute.stride<"((1,2),0,4)">
          %iter_4591 = cute.get_iter(%2046) : !memref_rmem_f32_1
          %iter_4592 = cute.get_iter(%2046) : !memref_rmem_f32_1
          %coord_4593 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_4594 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4595 = cute.crd2idx(%coord_4593, %lay_4594) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_4596 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4597 = cute.add_offset(%iter_4596, %idx_4595) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4598 = cute.make_view(%tup_4597) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4599 = cute.get_iter(%view_4598) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4600, %e1_4601 = cute.get_leaves(%iter_4599) : !cute.int_tuple<"(?,?)">
          %2049 = cute.get_scalars(%e0_4600) : !cute.int_tuple<"?">
          %2050 = cute.get_scalars(%e1_4601) : !cute.int_tuple<"?">
          %iter_4602 = cute.get_iter(%view_4598) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4603, %e1_4604 = cute.get_leaves(%iter_4602) : !cute.int_tuple<"(?,?)">
          %2051 = cute.get_scalars(%e0_4603) : !cute.int_tuple<"?">
          %2052 = cute.get_scalars(%e1_4604) : !cute.int_tuple<"?">
          %iter_4605 = cute.get_iter(%view_4598) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4606, %e1_4607 = cute.get_leaves(%iter_4605) : !cute.int_tuple<"(?,?)">
          %2053 = cute.get_scalars(%e0_4606) : !cute.int_tuple<"?">
          %2054 = cute.get_scalars(%e1_4607) : !cute.int_tuple<"?">
          %coord_4608 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_4609 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4610 = cute.crd2idx(%coord_4608, %lay_4609) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_4611 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4612 = cute.add_offset(%iter_4611, %idx_4610) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4613 = cute.make_view(%tup_4612) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4614 = cute.get_iter(%view_4613) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4615, %e1_4616 = cute.get_leaves(%iter_4614) : !cute.int_tuple<"(?,?)">
          %2055 = cute.get_scalars(%e0_4615) : !cute.int_tuple<"?">
          %2056 = cute.get_scalars(%e1_4616) : !cute.int_tuple<"?">
          %iter_4617 = cute.get_iter(%view_4613) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4618, %e1_4619 = cute.get_leaves(%iter_4617) : !cute.int_tuple<"(?,?)">
          %2057 = cute.get_scalars(%e0_4618) : !cute.int_tuple<"?">
          %2058 = cute.get_scalars(%e1_4619) : !cute.int_tuple<"?">
          %iter_4620 = cute.get_iter(%view_4613) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4621, %e1_4622 = cute.get_leaves(%iter_4620) : !cute.int_tuple<"(?,?)">
          %2059 = cute.get_scalars(%e0_4621) : !cute.int_tuple<"?">
          %2060 = cute.get_scalars(%e1_4622) : !cute.int_tuple<"?">
          %coord_4623 = cute.make_coord(%e0_4606) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4624 = cute.make_coord(%e1_4622) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2061 = cute.get_scalars(%coord_4623) : !cute.coord<"?">
          %2062 = cute.get_scalars(%coord_4624) : !cute.coord<"?">
          %true_4625 = arith.constant true
          %2063 = arith.cmpi slt, %2061, %2062 : i32
          %2064 = arith.andi %true_4625, %2063 : i1
          %lay_4626 = cute.get_layout(%2046) : !memref_rmem_f32_1
          %2065 = cute.get_shape(%lay_4626) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4627, %e1_4628, %e2_4629, %e3_4630 = cute.get_leaves(%2065) : !cute.shape<"((2,2),1,8)">
          %2066 = cute.get_stride(%lay_4626) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4631, %e1_4632, %e2_4633, %e3_4634 = cute.get_leaves(%2066) : !cute.stride<"((1,2),0,4)">
          %2067 = scf.if %2064 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2046) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
            cute.memref.store(%2046, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2046) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2046 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2046) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2046) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2046 : !memref_rmem_f32_1
          }
          %iter_4635 = cute.get_iter(%2067) : !memref_rmem_f32_1
          %lay_4636 = cute.get_layout(%2067) : !memref_rmem_f32_1
          %2068 = cute.get_shape(%lay_4636) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4637, %e1_4638, %e2_4639, %e3_4640 = cute.get_leaves(%2068) : !cute.shape<"((2,2),1,8)">
          %2069 = cute.get_stride(%lay_4636) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4641, %e1_4642, %e2_4643, %e3_4644 = cute.get_leaves(%2069) : !cute.stride<"((1,2),0,4)">
          %iter_4645 = cute.get_iter(%2067) : !memref_rmem_f32_1
          %iter_4646 = cute.get_iter(%2067) : !memref_rmem_f32_1
          %coord_4647 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_4648 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4649 = cute.crd2idx(%coord_4647, %lay_4648) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_4650 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4651 = cute.add_offset(%iter_4650, %idx_4649) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4652 = cute.make_view(%tup_4651) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4653 = cute.get_iter(%view_4652) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4654, %e1_4655 = cute.get_leaves(%iter_4653) : !cute.int_tuple<"(?,?)">
          %2070 = cute.get_scalars(%e0_4654) : !cute.int_tuple<"?">
          %2071 = cute.get_scalars(%e1_4655) : !cute.int_tuple<"?">
          %iter_4656 = cute.get_iter(%view_4652) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4657, %e1_4658 = cute.get_leaves(%iter_4656) : !cute.int_tuple<"(?,?)">
          %2072 = cute.get_scalars(%e0_4657) : !cute.int_tuple<"?">
          %2073 = cute.get_scalars(%e1_4658) : !cute.int_tuple<"?">
          %iter_4659 = cute.get_iter(%view_4652) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4660, %e1_4661 = cute.get_leaves(%iter_4659) : !cute.int_tuple<"(?,?)">
          %2074 = cute.get_scalars(%e0_4660) : !cute.int_tuple<"?">
          %2075 = cute.get_scalars(%e1_4661) : !cute.int_tuple<"?">
          %coord_4662 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_4663 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4664 = cute.crd2idx(%coord_4662, %lay_4663) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_4665 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4666 = cute.add_offset(%iter_4665, %idx_4664) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4667 = cute.make_view(%tup_4666) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4668 = cute.get_iter(%view_4667) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4669, %e1_4670 = cute.get_leaves(%iter_4668) : !cute.int_tuple<"(?,?)">
          %2076 = cute.get_scalars(%e0_4669) : !cute.int_tuple<"?">
          %2077 = cute.get_scalars(%e1_4670) : !cute.int_tuple<"?">
          %iter_4671 = cute.get_iter(%view_4667) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4672, %e1_4673 = cute.get_leaves(%iter_4671) : !cute.int_tuple<"(?,?)">
          %2078 = cute.get_scalars(%e0_4672) : !cute.int_tuple<"?">
          %2079 = cute.get_scalars(%e1_4673) : !cute.int_tuple<"?">
          %iter_4674 = cute.get_iter(%view_4667) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4675, %e1_4676 = cute.get_leaves(%iter_4674) : !cute.int_tuple<"(?,?)">
          %2080 = cute.get_scalars(%e0_4675) : !cute.int_tuple<"?">
          %2081 = cute.get_scalars(%e1_4676) : !cute.int_tuple<"?">
          %coord_4677 = cute.make_coord(%e0_4660) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4678 = cute.make_coord(%e1_4676) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2082 = cute.get_scalars(%coord_4677) : !cute.coord<"?">
          %2083 = cute.get_scalars(%coord_4678) : !cute.coord<"?">
          %true_4679 = arith.constant true
          %2084 = arith.cmpi slt, %2082, %2083 : i32
          %2085 = arith.andi %true_4679, %2084 : i1
          %lay_4680 = cute.get_layout(%2067) : !memref_rmem_f32_1
          %2086 = cute.get_shape(%lay_4680) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4681, %e1_4682, %e2_4683, %e3_4684 = cute.get_leaves(%2086) : !cute.shape<"((2,2),1,8)">
          %2087 = cute.get_stride(%lay_4680) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4685, %e1_4686, %e2_4687, %e3_4688 = cute.get_leaves(%2087) : !cute.stride<"((1,2),0,4)">
          %2088 = scf.if %2085 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2067) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
            cute.memref.store(%2067, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2067) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2067 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2067) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2067) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2067 : !memref_rmem_f32_1
          }
          %iter_4689 = cute.get_iter(%2088) : !memref_rmem_f32_1
          %lay_4690 = cute.get_layout(%2088) : !memref_rmem_f32_1
          %2089 = cute.get_shape(%lay_4690) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4691, %e1_4692, %e2_4693, %e3_4694 = cute.get_leaves(%2089) : !cute.shape<"((2,2),1,8)">
          %2090 = cute.get_stride(%lay_4690) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4695, %e1_4696, %e2_4697, %e3_4698 = cute.get_leaves(%2090) : !cute.stride<"((1,2),0,4)">
          %iter_4699 = cute.get_iter(%2088) : !memref_rmem_f32_1
          %iter_4700 = cute.get_iter(%2088) : !memref_rmem_f32_1
          %coord_4701 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_4702 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4703 = cute.crd2idx(%coord_4701, %lay_4702) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_4704 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4705 = cute.add_offset(%iter_4704, %idx_4703) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4706 = cute.make_view(%tup_4705) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4707 = cute.get_iter(%view_4706) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4708, %e1_4709 = cute.get_leaves(%iter_4707) : !cute.int_tuple<"(?,?)">
          %2091 = cute.get_scalars(%e0_4708) : !cute.int_tuple<"?">
          %2092 = cute.get_scalars(%e1_4709) : !cute.int_tuple<"?">
          %iter_4710 = cute.get_iter(%view_4706) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4711, %e1_4712 = cute.get_leaves(%iter_4710) : !cute.int_tuple<"(?,?)">
          %2093 = cute.get_scalars(%e0_4711) : !cute.int_tuple<"?">
          %2094 = cute.get_scalars(%e1_4712) : !cute.int_tuple<"?">
          %iter_4713 = cute.get_iter(%view_4706) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4714, %e1_4715 = cute.get_leaves(%iter_4713) : !cute.int_tuple<"(?,?)">
          %2095 = cute.get_scalars(%e0_4714) : !cute.int_tuple<"?">
          %2096 = cute.get_scalars(%e1_4715) : !cute.int_tuple<"?">
          %coord_4716 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_4717 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4718 = cute.crd2idx(%coord_4716, %lay_4717) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_4719 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4720 = cute.add_offset(%iter_4719, %idx_4718) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4721 = cute.make_view(%tup_4720) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4722 = cute.get_iter(%view_4721) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4723, %e1_4724 = cute.get_leaves(%iter_4722) : !cute.int_tuple<"(?,?)">
          %2097 = cute.get_scalars(%e0_4723) : !cute.int_tuple<"?">
          %2098 = cute.get_scalars(%e1_4724) : !cute.int_tuple<"?">
          %iter_4725 = cute.get_iter(%view_4721) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4726, %e1_4727 = cute.get_leaves(%iter_4725) : !cute.int_tuple<"(?,?)">
          %2099 = cute.get_scalars(%e0_4726) : !cute.int_tuple<"?">
          %2100 = cute.get_scalars(%e1_4727) : !cute.int_tuple<"?">
          %iter_4728 = cute.get_iter(%view_4721) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4729, %e1_4730 = cute.get_leaves(%iter_4728) : !cute.int_tuple<"(?,?)">
          %2101 = cute.get_scalars(%e0_4729) : !cute.int_tuple<"?">
          %2102 = cute.get_scalars(%e1_4730) : !cute.int_tuple<"?">
          %coord_4731 = cute.make_coord(%e0_4714) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4732 = cute.make_coord(%e1_4730) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2103 = cute.get_scalars(%coord_4731) : !cute.coord<"?">
          %2104 = cute.get_scalars(%coord_4732) : !cute.coord<"?">
          %true_4733 = arith.constant true
          %2105 = arith.cmpi slt, %2103, %2104 : i32
          %2106 = arith.andi %true_4733, %2105 : i1
          %lay_4734 = cute.get_layout(%2088) : !memref_rmem_f32_1
          %2107 = cute.get_shape(%lay_4734) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4735, %e1_4736, %e2_4737, %e3_4738 = cute.get_leaves(%2107) : !cute.shape<"((2,2),1,8)">
          %2108 = cute.get_stride(%lay_4734) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4739, %e1_4740, %e2_4741, %e3_4742 = cute.get_leaves(%2108) : !cute.stride<"((1,2),0,4)">
          %2109 = scf.if %2106 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2088) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
            cute.memref.store(%2088, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2088) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2088 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2088) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2088) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2088 : !memref_rmem_f32_1
          }
          %iter_4743 = cute.get_iter(%2109) : !memref_rmem_f32_1
          %lay_4744 = cute.get_layout(%2109) : !memref_rmem_f32_1
          %2110 = cute.get_shape(%lay_4744) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4745, %e1_4746, %e2_4747, %e3_4748 = cute.get_leaves(%2110) : !cute.shape<"((2,2),1,8)">
          %2111 = cute.get_stride(%lay_4744) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4749, %e1_4750, %e2_4751, %e3_4752 = cute.get_leaves(%2111) : !cute.stride<"((1,2),0,4)">
          %iter_4753 = cute.get_iter(%2109) : !memref_rmem_f32_1
          %iter_4754 = cute.get_iter(%2109) : !memref_rmem_f32_1
          %coord_4755 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_4756 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4757 = cute.crd2idx(%coord_4755, %lay_4756) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_4758 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4759 = cute.add_offset(%iter_4758, %idx_4757) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4760 = cute.make_view(%tup_4759) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4761 = cute.get_iter(%view_4760) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4762, %e1_4763 = cute.get_leaves(%iter_4761) : !cute.int_tuple<"(?,?)">
          %2112 = cute.get_scalars(%e0_4762) : !cute.int_tuple<"?">
          %2113 = cute.get_scalars(%e1_4763) : !cute.int_tuple<"?">
          %iter_4764 = cute.get_iter(%view_4760) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4765, %e1_4766 = cute.get_leaves(%iter_4764) : !cute.int_tuple<"(?,?)">
          %2114 = cute.get_scalars(%e0_4765) : !cute.int_tuple<"?">
          %2115 = cute.get_scalars(%e1_4766) : !cute.int_tuple<"?">
          %iter_4767 = cute.get_iter(%view_4760) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4768, %e1_4769 = cute.get_leaves(%iter_4767) : !cute.int_tuple<"(?,?)">
          %2116 = cute.get_scalars(%e0_4768) : !cute.int_tuple<"?">
          %2117 = cute.get_scalars(%e1_4769) : !cute.int_tuple<"?">
          %coord_4770 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_4771 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4772 = cute.crd2idx(%coord_4770, %lay_4771) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_4773 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4774 = cute.add_offset(%iter_4773, %idx_4772) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4775 = cute.make_view(%tup_4774) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4776 = cute.get_iter(%view_4775) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4777, %e1_4778 = cute.get_leaves(%iter_4776) : !cute.int_tuple<"(?,?)">
          %2118 = cute.get_scalars(%e0_4777) : !cute.int_tuple<"?">
          %2119 = cute.get_scalars(%e1_4778) : !cute.int_tuple<"?">
          %iter_4779 = cute.get_iter(%view_4775) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4780, %e1_4781 = cute.get_leaves(%iter_4779) : !cute.int_tuple<"(?,?)">
          %2120 = cute.get_scalars(%e0_4780) : !cute.int_tuple<"?">
          %2121 = cute.get_scalars(%e1_4781) : !cute.int_tuple<"?">
          %iter_4782 = cute.get_iter(%view_4775) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4783, %e1_4784 = cute.get_leaves(%iter_4782) : !cute.int_tuple<"(?,?)">
          %2122 = cute.get_scalars(%e0_4783) : !cute.int_tuple<"?">
          %2123 = cute.get_scalars(%e1_4784) : !cute.int_tuple<"?">
          %coord_4785 = cute.make_coord(%e0_4768) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4786 = cute.make_coord(%e1_4784) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2124 = cute.get_scalars(%coord_4785) : !cute.coord<"?">
          %2125 = cute.get_scalars(%coord_4786) : !cute.coord<"?">
          %true_4787 = arith.constant true
          %2126 = arith.cmpi slt, %2124, %2125 : i32
          %2127 = arith.andi %true_4787, %2126 : i1
          %lay_4788 = cute.get_layout(%2109) : !memref_rmem_f32_1
          %2128 = cute.get_shape(%lay_4788) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4789, %e1_4790, %e2_4791, %e3_4792 = cute.get_leaves(%2128) : !cute.shape<"((2,2),1,8)">
          %2129 = cute.get_stride(%lay_4788) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4793, %e1_4794, %e2_4795, %e3_4796 = cute.get_leaves(%2129) : !cute.stride<"((1,2),0,4)">
          %2130 = scf.if %2127 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2109) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
            cute.memref.store(%2109, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2109) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2109 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2109) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2109) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2109 : !memref_rmem_f32_1
          }
          %iter_4797 = cute.get_iter(%2130) : !memref_rmem_f32_1
          %lay_4798 = cute.get_layout(%2130) : !memref_rmem_f32_1
          %2131 = cute.get_shape(%lay_4798) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4799, %e1_4800, %e2_4801, %e3_4802 = cute.get_leaves(%2131) : !cute.shape<"((2,2),1,8)">
          %2132 = cute.get_stride(%lay_4798) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4803, %e1_4804, %e2_4805, %e3_4806 = cute.get_leaves(%2132) : !cute.stride<"((1,2),0,4)">
          %iter_4807 = cute.get_iter(%2130) : !memref_rmem_f32_1
          %iter_4808 = cute.get_iter(%2130) : !memref_rmem_f32_1
          %coord_4809 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4810 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4811 = cute.crd2idx(%coord_4809, %lay_4810) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4812 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4813 = cute.add_offset(%iter_4812, %idx_4811) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4814 = cute.make_view(%tup_4813) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4815 = cute.get_iter(%view_4814) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4816, %e1_4817 = cute.get_leaves(%iter_4815) : !cute.int_tuple<"(?,?)">
          %2133 = cute.get_scalars(%e0_4816) : !cute.int_tuple<"?">
          %2134 = cute.get_scalars(%e1_4817) : !cute.int_tuple<"?">
          %iter_4818 = cute.get_iter(%view_4814) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4819, %e1_4820 = cute.get_leaves(%iter_4818) : !cute.int_tuple<"(?,?)">
          %2135 = cute.get_scalars(%e0_4819) : !cute.int_tuple<"?">
          %2136 = cute.get_scalars(%e1_4820) : !cute.int_tuple<"?">
          %iter_4821 = cute.get_iter(%view_4814) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4822, %e1_4823 = cute.get_leaves(%iter_4821) : !cute.int_tuple<"(?,?)">
          %2137 = cute.get_scalars(%e0_4822) : !cute.int_tuple<"?">
          %2138 = cute.get_scalars(%e1_4823) : !cute.int_tuple<"?">
          %coord_4824 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4825 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4826 = cute.crd2idx(%coord_4824, %lay_4825) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4827 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4828 = cute.add_offset(%iter_4827, %idx_4826) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4829 = cute.make_view(%tup_4828) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4830 = cute.get_iter(%view_4829) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4831, %e1_4832 = cute.get_leaves(%iter_4830) : !cute.int_tuple<"(?,?)">
          %2139 = cute.get_scalars(%e0_4831) : !cute.int_tuple<"?">
          %2140 = cute.get_scalars(%e1_4832) : !cute.int_tuple<"?">
          %iter_4833 = cute.get_iter(%view_4829) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4834, %e1_4835 = cute.get_leaves(%iter_4833) : !cute.int_tuple<"(?,?)">
          %2141 = cute.get_scalars(%e0_4834) : !cute.int_tuple<"?">
          %2142 = cute.get_scalars(%e1_4835) : !cute.int_tuple<"?">
          %iter_4836 = cute.get_iter(%view_4829) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4837, %e1_4838 = cute.get_leaves(%iter_4836) : !cute.int_tuple<"(?,?)">
          %2143 = cute.get_scalars(%e0_4837) : !cute.int_tuple<"?">
          %2144 = cute.get_scalars(%e1_4838) : !cute.int_tuple<"?">
          %coord_4839 = cute.make_coord(%e0_4822) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4840 = cute.make_coord(%e1_4838) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2145 = cute.get_scalars(%coord_4839) : !cute.coord<"?">
          %2146 = cute.get_scalars(%coord_4840) : !cute.coord<"?">
          %true_4841 = arith.constant true
          %2147 = arith.cmpi slt, %2145, %2146 : i32
          %2148 = arith.andi %true_4841, %2147 : i1
          %lay_4842 = cute.get_layout(%2130) : !memref_rmem_f32_1
          %2149 = cute.get_shape(%lay_4842) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4843, %e1_4844, %e2_4845, %e3_4846 = cute.get_leaves(%2149) : !cute.shape<"((2,2),1,8)">
          %2150 = cute.get_stride(%lay_4842) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4847, %e1_4848, %e2_4849, %e3_4850 = cute.get_leaves(%2150) : !cute.stride<"((1,2),0,4)">
          %2151 = scf.if %2148 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2130) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
            cute.memref.store(%2130, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2130) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2130 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2130) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2130) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2130 : !memref_rmem_f32_1
          }
          %iter_4851 = cute.get_iter(%2151) : !memref_rmem_f32_1
          %lay_4852 = cute.get_layout(%2151) : !memref_rmem_f32_1
          %2152 = cute.get_shape(%lay_4852) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4853, %e1_4854, %e2_4855, %e3_4856 = cute.get_leaves(%2152) : !cute.shape<"((2,2),1,8)">
          %2153 = cute.get_stride(%lay_4852) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4857, %e1_4858, %e2_4859, %e3_4860 = cute.get_leaves(%2153) : !cute.stride<"((1,2),0,4)">
          %iter_4861 = cute.get_iter(%2151) : !memref_rmem_f32_1
          %iter_4862 = cute.get_iter(%2151) : !memref_rmem_f32_1
          %coord_4863 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4864 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4865 = cute.crd2idx(%coord_4863, %lay_4864) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4866 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4867 = cute.add_offset(%iter_4866, %idx_4865) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4868 = cute.make_view(%tup_4867) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4869 = cute.get_iter(%view_4868) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4870, %e1_4871 = cute.get_leaves(%iter_4869) : !cute.int_tuple<"(?,?)">
          %2154 = cute.get_scalars(%e0_4870) : !cute.int_tuple<"?">
          %2155 = cute.get_scalars(%e1_4871) : !cute.int_tuple<"?">
          %iter_4872 = cute.get_iter(%view_4868) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4873, %e1_4874 = cute.get_leaves(%iter_4872) : !cute.int_tuple<"(?,?)">
          %2156 = cute.get_scalars(%e0_4873) : !cute.int_tuple<"?">
          %2157 = cute.get_scalars(%e1_4874) : !cute.int_tuple<"?">
          %iter_4875 = cute.get_iter(%view_4868) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4876, %e1_4877 = cute.get_leaves(%iter_4875) : !cute.int_tuple<"(?,?)">
          %2158 = cute.get_scalars(%e0_4876) : !cute.int_tuple<"?">
          %2159 = cute.get_scalars(%e1_4877) : !cute.int_tuple<"?">
          %coord_4878 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4879 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4880 = cute.crd2idx(%coord_4878, %lay_4879) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4881 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4882 = cute.add_offset(%iter_4881, %idx_4880) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4883 = cute.make_view(%tup_4882) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4884 = cute.get_iter(%view_4883) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4885, %e1_4886 = cute.get_leaves(%iter_4884) : !cute.int_tuple<"(?,?)">
          %2160 = cute.get_scalars(%e0_4885) : !cute.int_tuple<"?">
          %2161 = cute.get_scalars(%e1_4886) : !cute.int_tuple<"?">
          %iter_4887 = cute.get_iter(%view_4883) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4888, %e1_4889 = cute.get_leaves(%iter_4887) : !cute.int_tuple<"(?,?)">
          %2162 = cute.get_scalars(%e0_4888) : !cute.int_tuple<"?">
          %2163 = cute.get_scalars(%e1_4889) : !cute.int_tuple<"?">
          %iter_4890 = cute.get_iter(%view_4883) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4891, %e1_4892 = cute.get_leaves(%iter_4890) : !cute.int_tuple<"(?,?)">
          %2164 = cute.get_scalars(%e0_4891) : !cute.int_tuple<"?">
          %2165 = cute.get_scalars(%e1_4892) : !cute.int_tuple<"?">
          %coord_4893 = cute.make_coord(%e0_4876) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4894 = cute.make_coord(%e1_4892) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2166 = cute.get_scalars(%coord_4893) : !cute.coord<"?">
          %2167 = cute.get_scalars(%coord_4894) : !cute.coord<"?">
          %true_4895 = arith.constant true
          %2168 = arith.cmpi slt, %2166, %2167 : i32
          %2169 = arith.andi %true_4895, %2168 : i1
          %lay_4896 = cute.get_layout(%2151) : !memref_rmem_f32_1
          %2170 = cute.get_shape(%lay_4896) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4897, %e1_4898, %e2_4899, %e3_4900 = cute.get_leaves(%2170) : !cute.shape<"((2,2),1,8)">
          %2171 = cute.get_stride(%lay_4896) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4901, %e1_4902, %e2_4903, %e3_4904 = cute.get_leaves(%2171) : !cute.stride<"((1,2),0,4)">
          %2172 = scf.if %2169 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2151) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
            cute.memref.store(%2151, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2151) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2151 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2151) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2151) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2151 : !memref_rmem_f32_1
          }
          %iter_4905 = cute.get_iter(%2172) : !memref_rmem_f32_1
          %lay_4906 = cute.get_layout(%2172) : !memref_rmem_f32_1
          %2173 = cute.get_shape(%lay_4906) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4907, %e1_4908, %e2_4909, %e3_4910 = cute.get_leaves(%2173) : !cute.shape<"((2,2),1,8)">
          %2174 = cute.get_stride(%lay_4906) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4911, %e1_4912, %e2_4913, %e3_4914 = cute.get_leaves(%2174) : !cute.stride<"((1,2),0,4)">
          %iter_4915 = cute.get_iter(%2172) : !memref_rmem_f32_1
          %iter_4916 = cute.get_iter(%2172) : !memref_rmem_f32_1
          %int_tuple_4917 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4918 = cute.size(%int_tuple_4917) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4919 = cute.get_leaves(%sz_4918) : !cute.int_tuple<"1">
          %int_tuple_4920 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4921 = cute.size(%int_tuple_4920) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4922 = cute.get_leaves(%sz_4921) : !cute.int_tuple<"8">
          %coord_4923 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4924 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4925 = cute.crd2idx(%coord_4923, %lay_4924) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4926 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4927 = cute.add_offset(%iter_4926, %idx_4925) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4928 = cute.make_view(%tup_4927) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4929 = cute.get_iter(%view_4928) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4930, %e1_4931 = cute.get_leaves(%iter_4929) : !cute.int_tuple<"(?,?{div=2})">
          %2175 = cute.get_scalars(%e0_4930) : !cute.int_tuple<"?">
          %2176 = cute.get_scalars(%e1_4931) : !cute.int_tuple<"?{div=2}">
          %iter_4932 = cute.get_iter(%view_4928) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4933, %e1_4934 = cute.get_leaves(%iter_4932) : !cute.int_tuple<"(?,?{div=2})">
          %2177 = cute.get_scalars(%e0_4933) : !cute.int_tuple<"?">
          %2178 = cute.get_scalars(%e1_4934) : !cute.int_tuple<"?{div=2}">
          %iter_4935 = cute.get_iter(%view_4928) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4936, %e1_4937 = cute.get_leaves(%iter_4935) : !cute.int_tuple<"(?,?{div=2})">
          %2179 = cute.get_scalars(%e0_4936) : !cute.int_tuple<"?">
          %2180 = cute.get_scalars(%e1_4937) : !cute.int_tuple<"?{div=2}">
          %coord_4938 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4939 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4940 = cute.crd2idx(%coord_4938, %lay_4939) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4941 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4942 = cute.add_offset(%iter_4941, %idx_4940) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4943 = cute.make_view(%tup_4942) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4944 = cute.get_iter(%view_4943) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4945, %e1_4946 = cute.get_leaves(%iter_4944) : !cute.int_tuple<"(?,?{div=2})">
          %2181 = cute.get_scalars(%e0_4945) : !cute.int_tuple<"?">
          %2182 = cute.get_scalars(%e1_4946) : !cute.int_tuple<"?{div=2}">
          %iter_4947 = cute.get_iter(%view_4943) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4948, %e1_4949 = cute.get_leaves(%iter_4947) : !cute.int_tuple<"(?,?{div=2})">
          %2183 = cute.get_scalars(%e0_4948) : !cute.int_tuple<"?">
          %2184 = cute.get_scalars(%e1_4949) : !cute.int_tuple<"?{div=2}">
          %iter_4950 = cute.get_iter(%view_4943) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4951, %e1_4952 = cute.get_leaves(%iter_4950) : !cute.int_tuple<"(?,?{div=2})">
          %2185 = cute.get_scalars(%e0_4951) : !cute.int_tuple<"?">
          %2186 = cute.get_scalars(%e1_4952) : !cute.int_tuple<"?{div=2}">
          %coord_4953 = cute.make_coord(%e0_4936) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4954 = cute.make_coord(%e1_4952) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2187 = cute.get_scalars(%coord_4953) : !cute.coord<"?">
          %2188 = cute.get_scalars(%coord_4954) : !cute.coord<"?{div=2}">
          %true_4955 = arith.constant true
          %2189 = arith.cmpi slt, %2187, %2188 : i32
          %2190 = arith.andi %true_4955, %2189 : i1
          %lay_4956 = cute.get_layout(%2172) : !memref_rmem_f32_1
          %2191 = cute.get_shape(%lay_4956) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4957, %e1_4958, %e2_4959, %e3_4960 = cute.get_leaves(%2191) : !cute.shape<"((2,2),1,8)">
          %2192 = cute.get_stride(%lay_4956) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4961, %e1_4962, %e2_4963, %e3_4964 = cute.get_leaves(%2192) : !cute.stride<"((1,2),0,4)">
          %2193 = scf.if %2190 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2172) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
            cute.memref.store(%2172, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2172) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2172 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2172) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2172) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2172 : !memref_rmem_f32_1
          }
          %iter_4965 = cute.get_iter(%2193) : !memref_rmem_f32_1
          %lay_4966 = cute.get_layout(%2193) : !memref_rmem_f32_1
          %2194 = cute.get_shape(%lay_4966) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4967, %e1_4968, %e2_4969, %e3_4970 = cute.get_leaves(%2194) : !cute.shape<"((2,2),1,8)">
          %2195 = cute.get_stride(%lay_4966) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4971, %e1_4972, %e2_4973, %e3_4974 = cute.get_leaves(%2195) : !cute.stride<"((1,2),0,4)">
          %iter_4975 = cute.get_iter(%2193) : !memref_rmem_f32_1
          %iter_4976 = cute.get_iter(%2193) : !memref_rmem_f32_1
          %coord_4977 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4978 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4979 = cute.crd2idx(%coord_4977, %lay_4978) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4980 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4981 = cute.add_offset(%iter_4980, %idx_4979) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4982 = cute.make_view(%tup_4981) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4983 = cute.get_iter(%view_4982) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4984, %e1_4985 = cute.get_leaves(%iter_4983) : !cute.int_tuple<"(?,?{div=2})">
          %2196 = cute.get_scalars(%e0_4984) : !cute.int_tuple<"?">
          %2197 = cute.get_scalars(%e1_4985) : !cute.int_tuple<"?{div=2}">
          %iter_4986 = cute.get_iter(%view_4982) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4987, %e1_4988 = cute.get_leaves(%iter_4986) : !cute.int_tuple<"(?,?{div=2})">
          %2198 = cute.get_scalars(%e0_4987) : !cute.int_tuple<"?">
          %2199 = cute.get_scalars(%e1_4988) : !cute.int_tuple<"?{div=2}">
          %iter_4989 = cute.get_iter(%view_4982) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4990, %e1_4991 = cute.get_leaves(%iter_4989) : !cute.int_tuple<"(?,?{div=2})">
          %2200 = cute.get_scalars(%e0_4990) : !cute.int_tuple<"?">
          %2201 = cute.get_scalars(%e1_4991) : !cute.int_tuple<"?{div=2}">
          %coord_4992 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4993 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4994 = cute.crd2idx(%coord_4992, %lay_4993) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4995 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4996 = cute.add_offset(%iter_4995, %idx_4994) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4997 = cute.make_view(%tup_4996) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4998 = cute.get_iter(%view_4997) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4999, %e1_5000 = cute.get_leaves(%iter_4998) : !cute.int_tuple<"(?,?{div=2})">
          %2202 = cute.get_scalars(%e0_4999) : !cute.int_tuple<"?">
          %2203 = cute.get_scalars(%e1_5000) : !cute.int_tuple<"?{div=2}">
          %iter_5001 = cute.get_iter(%view_4997) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5002, %e1_5003 = cute.get_leaves(%iter_5001) : !cute.int_tuple<"(?,?{div=2})">
          %2204 = cute.get_scalars(%e0_5002) : !cute.int_tuple<"?">
          %2205 = cute.get_scalars(%e1_5003) : !cute.int_tuple<"?{div=2}">
          %iter_5004 = cute.get_iter(%view_4997) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5005, %e1_5006 = cute.get_leaves(%iter_5004) : !cute.int_tuple<"(?,?{div=2})">
          %2206 = cute.get_scalars(%e0_5005) : !cute.int_tuple<"?">
          %2207 = cute.get_scalars(%e1_5006) : !cute.int_tuple<"?{div=2}">
          %coord_5007 = cute.make_coord(%e0_4990) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5008 = cute.make_coord(%e1_5006) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2208 = cute.get_scalars(%coord_5007) : !cute.coord<"?">
          %2209 = cute.get_scalars(%coord_5008) : !cute.coord<"?{div=2}">
          %true_5009 = arith.constant true
          %2210 = arith.cmpi slt, %2208, %2209 : i32
          %2211 = arith.andi %true_5009, %2210 : i1
          %lay_5010 = cute.get_layout(%2193) : !memref_rmem_f32_1
          %2212 = cute.get_shape(%lay_5010) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5011, %e1_5012, %e2_5013, %e3_5014 = cute.get_leaves(%2212) : !cute.shape<"((2,2),1,8)">
          %2213 = cute.get_stride(%lay_5010) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5015, %e1_5016, %e2_5017, %e3_5018 = cute.get_leaves(%2213) : !cute.stride<"((1,2),0,4)">
          %2214 = scf.if %2211 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2193) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
            cute.memref.store(%2193, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2193) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2193 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2193) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2193) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2193 : !memref_rmem_f32_1
          }
          %iter_5019 = cute.get_iter(%2214) : !memref_rmem_f32_1
          %lay_5020 = cute.get_layout(%2214) : !memref_rmem_f32_1
          %2215 = cute.get_shape(%lay_5020) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5021, %e1_5022, %e2_5023, %e3_5024 = cute.get_leaves(%2215) : !cute.shape<"((2,2),1,8)">
          %2216 = cute.get_stride(%lay_5020) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5025, %e1_5026, %e2_5027, %e3_5028 = cute.get_leaves(%2216) : !cute.stride<"((1,2),0,4)">
          %iter_5029 = cute.get_iter(%2214) : !memref_rmem_f32_1
          %iter_5030 = cute.get_iter(%2214) : !memref_rmem_f32_1
          %coord_5031 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_5032 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5033 = cute.crd2idx(%coord_5031, %lay_5032) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_5034 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5035 = cute.add_offset(%iter_5034, %idx_5033) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5036 = cute.make_view(%tup_5035) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5037 = cute.get_iter(%view_5036) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5038, %e1_5039 = cute.get_leaves(%iter_5037) : !cute.int_tuple<"(?,?{div=2})">
          %2217 = cute.get_scalars(%e0_5038) : !cute.int_tuple<"?">
          %2218 = cute.get_scalars(%e1_5039) : !cute.int_tuple<"?{div=2}">
          %iter_5040 = cute.get_iter(%view_5036) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5041, %e1_5042 = cute.get_leaves(%iter_5040) : !cute.int_tuple<"(?,?{div=2})">
          %2219 = cute.get_scalars(%e0_5041) : !cute.int_tuple<"?">
          %2220 = cute.get_scalars(%e1_5042) : !cute.int_tuple<"?{div=2}">
          %iter_5043 = cute.get_iter(%view_5036) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5044, %e1_5045 = cute.get_leaves(%iter_5043) : !cute.int_tuple<"(?,?{div=2})">
          %2221 = cute.get_scalars(%e0_5044) : !cute.int_tuple<"?">
          %2222 = cute.get_scalars(%e1_5045) : !cute.int_tuple<"?{div=2}">
          %coord_5046 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_5047 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5048 = cute.crd2idx(%coord_5046, %lay_5047) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_5049 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5050 = cute.add_offset(%iter_5049, %idx_5048) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5051 = cute.make_view(%tup_5050) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5052 = cute.get_iter(%view_5051) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5053, %e1_5054 = cute.get_leaves(%iter_5052) : !cute.int_tuple<"(?,?{div=2})">
          %2223 = cute.get_scalars(%e0_5053) : !cute.int_tuple<"?">
          %2224 = cute.get_scalars(%e1_5054) : !cute.int_tuple<"?{div=2}">
          %iter_5055 = cute.get_iter(%view_5051) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5056, %e1_5057 = cute.get_leaves(%iter_5055) : !cute.int_tuple<"(?,?{div=2})">
          %2225 = cute.get_scalars(%e0_5056) : !cute.int_tuple<"?">
          %2226 = cute.get_scalars(%e1_5057) : !cute.int_tuple<"?{div=2}">
          %iter_5058 = cute.get_iter(%view_5051) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5059, %e1_5060 = cute.get_leaves(%iter_5058) : !cute.int_tuple<"(?,?{div=2})">
          %2227 = cute.get_scalars(%e0_5059) : !cute.int_tuple<"?">
          %2228 = cute.get_scalars(%e1_5060) : !cute.int_tuple<"?{div=2}">
          %coord_5061 = cute.make_coord(%e0_5044) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5062 = cute.make_coord(%e1_5060) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2229 = cute.get_scalars(%coord_5061) : !cute.coord<"?">
          %2230 = cute.get_scalars(%coord_5062) : !cute.coord<"?{div=2}">
          %true_5063 = arith.constant true
          %2231 = arith.cmpi slt, %2229, %2230 : i32
          %2232 = arith.andi %true_5063, %2231 : i1
          %lay_5064 = cute.get_layout(%2214) : !memref_rmem_f32_1
          %2233 = cute.get_shape(%lay_5064) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5065, %e1_5066, %e2_5067, %e3_5068 = cute.get_leaves(%2233) : !cute.shape<"((2,2),1,8)">
          %2234 = cute.get_stride(%lay_5064) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5069, %e1_5070, %e2_5071, %e3_5072 = cute.get_leaves(%2234) : !cute.stride<"((1,2),0,4)">
          %2235 = scf.if %2232 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2214) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
            cute.memref.store(%2214, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2214) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2214 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2214) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2214) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2214 : !memref_rmem_f32_1
          }
          %iter_5073 = cute.get_iter(%2235) : !memref_rmem_f32_1
          %lay_5074 = cute.get_layout(%2235) : !memref_rmem_f32_1
          %2236 = cute.get_shape(%lay_5074) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5075, %e1_5076, %e2_5077, %e3_5078 = cute.get_leaves(%2236) : !cute.shape<"((2,2),1,8)">
          %2237 = cute.get_stride(%lay_5074) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5079, %e1_5080, %e2_5081, %e3_5082 = cute.get_leaves(%2237) : !cute.stride<"((1,2),0,4)">
          %iter_5083 = cute.get_iter(%2235) : !memref_rmem_f32_1
          %iter_5084 = cute.get_iter(%2235) : !memref_rmem_f32_1
          %coord_5085 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_5086 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5087 = cute.crd2idx(%coord_5085, %lay_5086) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_5088 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5089 = cute.add_offset(%iter_5088, %idx_5087) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5090 = cute.make_view(%tup_5089) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5091 = cute.get_iter(%view_5090) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5092, %e1_5093 = cute.get_leaves(%iter_5091) : !cute.int_tuple<"(?,?{div=2})">
          %2238 = cute.get_scalars(%e0_5092) : !cute.int_tuple<"?">
          %2239 = cute.get_scalars(%e1_5093) : !cute.int_tuple<"?{div=2}">
          %iter_5094 = cute.get_iter(%view_5090) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5095, %e1_5096 = cute.get_leaves(%iter_5094) : !cute.int_tuple<"(?,?{div=2})">
          %2240 = cute.get_scalars(%e0_5095) : !cute.int_tuple<"?">
          %2241 = cute.get_scalars(%e1_5096) : !cute.int_tuple<"?{div=2}">
          %iter_5097 = cute.get_iter(%view_5090) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5098, %e1_5099 = cute.get_leaves(%iter_5097) : !cute.int_tuple<"(?,?{div=2})">
          %2242 = cute.get_scalars(%e0_5098) : !cute.int_tuple<"?">
          %2243 = cute.get_scalars(%e1_5099) : !cute.int_tuple<"?{div=2}">
          %coord_5100 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_5101 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5102 = cute.crd2idx(%coord_5100, %lay_5101) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_5103 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5104 = cute.add_offset(%iter_5103, %idx_5102) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5105 = cute.make_view(%tup_5104) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5106 = cute.get_iter(%view_5105) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5107, %e1_5108 = cute.get_leaves(%iter_5106) : !cute.int_tuple<"(?,?{div=2})">
          %2244 = cute.get_scalars(%e0_5107) : !cute.int_tuple<"?">
          %2245 = cute.get_scalars(%e1_5108) : !cute.int_tuple<"?{div=2}">
          %iter_5109 = cute.get_iter(%view_5105) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5110, %e1_5111 = cute.get_leaves(%iter_5109) : !cute.int_tuple<"(?,?{div=2})">
          %2246 = cute.get_scalars(%e0_5110) : !cute.int_tuple<"?">
          %2247 = cute.get_scalars(%e1_5111) : !cute.int_tuple<"?{div=2}">
          %iter_5112 = cute.get_iter(%view_5105) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5113, %e1_5114 = cute.get_leaves(%iter_5112) : !cute.int_tuple<"(?,?{div=2})">
          %2248 = cute.get_scalars(%e0_5113) : !cute.int_tuple<"?">
          %2249 = cute.get_scalars(%e1_5114) : !cute.int_tuple<"?{div=2}">
          %coord_5115 = cute.make_coord(%e0_5098) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5116 = cute.make_coord(%e1_5114) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2250 = cute.get_scalars(%coord_5115) : !cute.coord<"?">
          %2251 = cute.get_scalars(%coord_5116) : !cute.coord<"?{div=2}">
          %true_5117 = arith.constant true
          %2252 = arith.cmpi slt, %2250, %2251 : i32
          %2253 = arith.andi %true_5117, %2252 : i1
          %lay_5118 = cute.get_layout(%2235) : !memref_rmem_f32_1
          %2254 = cute.get_shape(%lay_5118) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5119, %e1_5120, %e2_5121, %e3_5122 = cute.get_leaves(%2254) : !cute.shape<"((2,2),1,8)">
          %2255 = cute.get_stride(%lay_5118) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5123, %e1_5124, %e2_5125, %e3_5126 = cute.get_leaves(%2255) : !cute.stride<"((1,2),0,4)">
          %2256 = scf.if %2253 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2235) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
            cute.memref.store(%2235, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2235) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2235 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2235) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2235) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2235 : !memref_rmem_f32_1
          }
          %iter_5127 = cute.get_iter(%2256) : !memref_rmem_f32_1
          %lay_5128 = cute.get_layout(%2256) : !memref_rmem_f32_1
          %2257 = cute.get_shape(%lay_5128) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5129, %e1_5130, %e2_5131, %e3_5132 = cute.get_leaves(%2257) : !cute.shape<"((2,2),1,8)">
          %2258 = cute.get_stride(%lay_5128) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5133, %e1_5134, %e2_5135, %e3_5136 = cute.get_leaves(%2258) : !cute.stride<"((1,2),0,4)">
          %iter_5137 = cute.get_iter(%2256) : !memref_rmem_f32_1
          %iter_5138 = cute.get_iter(%2256) : !memref_rmem_f32_1
          %coord_5139 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_5140 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5141 = cute.crd2idx(%coord_5139, %lay_5140) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_5142 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5143 = cute.add_offset(%iter_5142, %idx_5141) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5144 = cute.make_view(%tup_5143) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5145 = cute.get_iter(%view_5144) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5146, %e1_5147 = cute.get_leaves(%iter_5145) : !cute.int_tuple<"(?,?{div=2})">
          %2259 = cute.get_scalars(%e0_5146) : !cute.int_tuple<"?">
          %2260 = cute.get_scalars(%e1_5147) : !cute.int_tuple<"?{div=2}">
          %iter_5148 = cute.get_iter(%view_5144) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5149, %e1_5150 = cute.get_leaves(%iter_5148) : !cute.int_tuple<"(?,?{div=2})">
          %2261 = cute.get_scalars(%e0_5149) : !cute.int_tuple<"?">
          %2262 = cute.get_scalars(%e1_5150) : !cute.int_tuple<"?{div=2}">
          %iter_5151 = cute.get_iter(%view_5144) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5152, %e1_5153 = cute.get_leaves(%iter_5151) : !cute.int_tuple<"(?,?{div=2})">
          %2263 = cute.get_scalars(%e0_5152) : !cute.int_tuple<"?">
          %2264 = cute.get_scalars(%e1_5153) : !cute.int_tuple<"?{div=2}">
          %coord_5154 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_5155 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5156 = cute.crd2idx(%coord_5154, %lay_5155) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_5157 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5158 = cute.add_offset(%iter_5157, %idx_5156) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5159 = cute.make_view(%tup_5158) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5160 = cute.get_iter(%view_5159) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5161, %e1_5162 = cute.get_leaves(%iter_5160) : !cute.int_tuple<"(?,?{div=2})">
          %2265 = cute.get_scalars(%e0_5161) : !cute.int_tuple<"?">
          %2266 = cute.get_scalars(%e1_5162) : !cute.int_tuple<"?{div=2}">
          %iter_5163 = cute.get_iter(%view_5159) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5164, %e1_5165 = cute.get_leaves(%iter_5163) : !cute.int_tuple<"(?,?{div=2})">
          %2267 = cute.get_scalars(%e0_5164) : !cute.int_tuple<"?">
          %2268 = cute.get_scalars(%e1_5165) : !cute.int_tuple<"?{div=2}">
          %iter_5166 = cute.get_iter(%view_5159) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5167, %e1_5168 = cute.get_leaves(%iter_5166) : !cute.int_tuple<"(?,?{div=2})">
          %2269 = cute.get_scalars(%e0_5167) : !cute.int_tuple<"?">
          %2270 = cute.get_scalars(%e1_5168) : !cute.int_tuple<"?{div=2}">
          %coord_5169 = cute.make_coord(%e0_5152) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5170 = cute.make_coord(%e1_5168) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2271 = cute.get_scalars(%coord_5169) : !cute.coord<"?">
          %2272 = cute.get_scalars(%coord_5170) : !cute.coord<"?{div=2}">
          %true_5171 = arith.constant true
          %2273 = arith.cmpi slt, %2271, %2272 : i32
          %2274 = arith.andi %true_5171, %2273 : i1
          %lay_5172 = cute.get_layout(%2256) : !memref_rmem_f32_1
          %2275 = cute.get_shape(%lay_5172) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5173, %e1_5174, %e2_5175, %e3_5176 = cute.get_leaves(%2275) : !cute.shape<"((2,2),1,8)">
          %2276 = cute.get_stride(%lay_5172) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5177, %e1_5178, %e2_5179, %e3_5180 = cute.get_leaves(%2276) : !cute.stride<"((1,2),0,4)">
          %2277 = scf.if %2274 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2256) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
            cute.memref.store(%2256, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2256) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2256 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2256) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2256) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2256 : !memref_rmem_f32_1
          }
          %iter_5181 = cute.get_iter(%2277) : !memref_rmem_f32_1
          %lay_5182 = cute.get_layout(%2277) : !memref_rmem_f32_1
          %2278 = cute.get_shape(%lay_5182) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5183, %e1_5184, %e2_5185, %e3_5186 = cute.get_leaves(%2278) : !cute.shape<"((2,2),1,8)">
          %2279 = cute.get_stride(%lay_5182) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5187, %e1_5188, %e2_5189, %e3_5190 = cute.get_leaves(%2279) : !cute.stride<"((1,2),0,4)">
          %iter_5191 = cute.get_iter(%2277) : !memref_rmem_f32_1
          %iter_5192 = cute.get_iter(%2277) : !memref_rmem_f32_1
          %coord_5193 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_5194 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5195 = cute.crd2idx(%coord_5193, %lay_5194) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_5196 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5197 = cute.add_offset(%iter_5196, %idx_5195) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5198 = cute.make_view(%tup_5197) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5199 = cute.get_iter(%view_5198) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5200, %e1_5201 = cute.get_leaves(%iter_5199) : !cute.int_tuple<"(?,?{div=2})">
          %2280 = cute.get_scalars(%e0_5200) : !cute.int_tuple<"?">
          %2281 = cute.get_scalars(%e1_5201) : !cute.int_tuple<"?{div=2}">
          %iter_5202 = cute.get_iter(%view_5198) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5203, %e1_5204 = cute.get_leaves(%iter_5202) : !cute.int_tuple<"(?,?{div=2})">
          %2282 = cute.get_scalars(%e0_5203) : !cute.int_tuple<"?">
          %2283 = cute.get_scalars(%e1_5204) : !cute.int_tuple<"?{div=2}">
          %iter_5205 = cute.get_iter(%view_5198) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5206, %e1_5207 = cute.get_leaves(%iter_5205) : !cute.int_tuple<"(?,?{div=2})">
          %2284 = cute.get_scalars(%e0_5206) : !cute.int_tuple<"?">
          %2285 = cute.get_scalars(%e1_5207) : !cute.int_tuple<"?{div=2}">
          %coord_5208 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_5209 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5210 = cute.crd2idx(%coord_5208, %lay_5209) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_5211 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5212 = cute.add_offset(%iter_5211, %idx_5210) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5213 = cute.make_view(%tup_5212) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5214 = cute.get_iter(%view_5213) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5215, %e1_5216 = cute.get_leaves(%iter_5214) : !cute.int_tuple<"(?,?{div=2})">
          %2286 = cute.get_scalars(%e0_5215) : !cute.int_tuple<"?">
          %2287 = cute.get_scalars(%e1_5216) : !cute.int_tuple<"?{div=2}">
          %iter_5217 = cute.get_iter(%view_5213) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5218, %e1_5219 = cute.get_leaves(%iter_5217) : !cute.int_tuple<"(?,?{div=2})">
          %2288 = cute.get_scalars(%e0_5218) : !cute.int_tuple<"?">
          %2289 = cute.get_scalars(%e1_5219) : !cute.int_tuple<"?{div=2}">
          %iter_5220 = cute.get_iter(%view_5213) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5221, %e1_5222 = cute.get_leaves(%iter_5220) : !cute.int_tuple<"(?,?{div=2})">
          %2290 = cute.get_scalars(%e0_5221) : !cute.int_tuple<"?">
          %2291 = cute.get_scalars(%e1_5222) : !cute.int_tuple<"?{div=2}">
          %coord_5223 = cute.make_coord(%e0_5206) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5224 = cute.make_coord(%e1_5222) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2292 = cute.get_scalars(%coord_5223) : !cute.coord<"?">
          %2293 = cute.get_scalars(%coord_5224) : !cute.coord<"?{div=2}">
          %true_5225 = arith.constant true
          %2294 = arith.cmpi slt, %2292, %2293 : i32
          %2295 = arith.andi %true_5225, %2294 : i1
          %lay_5226 = cute.get_layout(%2277) : !memref_rmem_f32_1
          %2296 = cute.get_shape(%lay_5226) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5227, %e1_5228, %e2_5229, %e3_5230 = cute.get_leaves(%2296) : !cute.shape<"((2,2),1,8)">
          %2297 = cute.get_stride(%lay_5226) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5231, %e1_5232, %e2_5233, %e3_5234 = cute.get_leaves(%2297) : !cute.stride<"((1,2),0,4)">
          %2298 = scf.if %2295 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2277) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
            cute.memref.store(%2277, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2277) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2277 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2277) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2277) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2277 : !memref_rmem_f32_1
          }
          %iter_5235 = cute.get_iter(%2298) : !memref_rmem_f32_1
          %lay_5236 = cute.get_layout(%2298) : !memref_rmem_f32_1
          %2299 = cute.get_shape(%lay_5236) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5237, %e1_5238, %e2_5239, %e3_5240 = cute.get_leaves(%2299) : !cute.shape<"((2,2),1,8)">
          %2300 = cute.get_stride(%lay_5236) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5241, %e1_5242, %e2_5243, %e3_5244 = cute.get_leaves(%2300) : !cute.stride<"((1,2),0,4)">
          %iter_5245 = cute.get_iter(%2298) : !memref_rmem_f32_1
          %iter_5246 = cute.get_iter(%2298) : !memref_rmem_f32_1
          %coord_5247 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_5248 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5249 = cute.crd2idx(%coord_5247, %lay_5248) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_5250 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5251 = cute.add_offset(%iter_5250, %idx_5249) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5252 = cute.make_view(%tup_5251) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5253 = cute.get_iter(%view_5252) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5254, %e1_5255 = cute.get_leaves(%iter_5253) : !cute.int_tuple<"(?,?{div=2})">
          %2301 = cute.get_scalars(%e0_5254) : !cute.int_tuple<"?">
          %2302 = cute.get_scalars(%e1_5255) : !cute.int_tuple<"?{div=2}">
          %iter_5256 = cute.get_iter(%view_5252) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5257, %e1_5258 = cute.get_leaves(%iter_5256) : !cute.int_tuple<"(?,?{div=2})">
          %2303 = cute.get_scalars(%e0_5257) : !cute.int_tuple<"?">
          %2304 = cute.get_scalars(%e1_5258) : !cute.int_tuple<"?{div=2}">
          %iter_5259 = cute.get_iter(%view_5252) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5260, %e1_5261 = cute.get_leaves(%iter_5259) : !cute.int_tuple<"(?,?{div=2})">
          %2305 = cute.get_scalars(%e0_5260) : !cute.int_tuple<"?">
          %2306 = cute.get_scalars(%e1_5261) : !cute.int_tuple<"?{div=2}">
          %coord_5262 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_5263 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5264 = cute.crd2idx(%coord_5262, %lay_5263) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_5265 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5266 = cute.add_offset(%iter_5265, %idx_5264) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5267 = cute.make_view(%tup_5266) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5268 = cute.get_iter(%view_5267) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5269, %e1_5270 = cute.get_leaves(%iter_5268) : !cute.int_tuple<"(?,?{div=2})">
          %2307 = cute.get_scalars(%e0_5269) : !cute.int_tuple<"?">
          %2308 = cute.get_scalars(%e1_5270) : !cute.int_tuple<"?{div=2}">
          %iter_5271 = cute.get_iter(%view_5267) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5272, %e1_5273 = cute.get_leaves(%iter_5271) : !cute.int_tuple<"(?,?{div=2})">
          %2309 = cute.get_scalars(%e0_5272) : !cute.int_tuple<"?">
          %2310 = cute.get_scalars(%e1_5273) : !cute.int_tuple<"?{div=2}">
          %iter_5274 = cute.get_iter(%view_5267) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5275, %e1_5276 = cute.get_leaves(%iter_5274) : !cute.int_tuple<"(?,?{div=2})">
          %2311 = cute.get_scalars(%e0_5275) : !cute.int_tuple<"?">
          %2312 = cute.get_scalars(%e1_5276) : !cute.int_tuple<"?{div=2}">
          %coord_5277 = cute.make_coord(%e0_5260) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5278 = cute.make_coord(%e1_5276) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2313 = cute.get_scalars(%coord_5277) : !cute.coord<"?">
          %2314 = cute.get_scalars(%coord_5278) : !cute.coord<"?{div=2}">
          %true_5279 = arith.constant true
          %2315 = arith.cmpi slt, %2313, %2314 : i32
          %2316 = arith.andi %true_5279, %2315 : i1
          %lay_5280 = cute.get_layout(%2298) : !memref_rmem_f32_1
          %2317 = cute.get_shape(%lay_5280) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5281, %e1_5282, %e2_5283, %e3_5284 = cute.get_leaves(%2317) : !cute.shape<"((2,2),1,8)">
          %2318 = cute.get_stride(%lay_5280) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5285, %e1_5286, %e2_5287, %e3_5288 = cute.get_leaves(%2318) : !cute.stride<"((1,2),0,4)">
          %2319 = scf.if %2316 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2298) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
            cute.memref.store(%2298, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2298) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2298 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2298) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2298) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2298 : !memref_rmem_f32_1
          }
          %iter_5289 = cute.get_iter(%2319) : !memref_rmem_f32_1
          %lay_5290 = cute.get_layout(%2319) : !memref_rmem_f32_1
          %2320 = cute.get_shape(%lay_5290) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5291, %e1_5292, %e2_5293, %e3_5294 = cute.get_leaves(%2320) : !cute.shape<"((2,2),1,8)">
          %2321 = cute.get_stride(%lay_5290) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5295, %e1_5296, %e2_5297, %e3_5298 = cute.get_leaves(%2321) : !cute.stride<"((1,2),0,4)">
          %iter_5299 = cute.get_iter(%2319) : !memref_rmem_f32_1
          %iter_5300 = cute.get_iter(%2319) : !memref_rmem_f32_1
          %coord_5301 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_5302 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5303 = cute.crd2idx(%coord_5301, %lay_5302) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_5304 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5305 = cute.add_offset(%iter_5304, %idx_5303) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5306 = cute.make_view(%tup_5305) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5307 = cute.get_iter(%view_5306) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5308, %e1_5309 = cute.get_leaves(%iter_5307) : !cute.int_tuple<"(?,?{div=2})">
          %2322 = cute.get_scalars(%e0_5308) : !cute.int_tuple<"?">
          %2323 = cute.get_scalars(%e1_5309) : !cute.int_tuple<"?{div=2}">
          %iter_5310 = cute.get_iter(%view_5306) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5311, %e1_5312 = cute.get_leaves(%iter_5310) : !cute.int_tuple<"(?,?{div=2})">
          %2324 = cute.get_scalars(%e0_5311) : !cute.int_tuple<"?">
          %2325 = cute.get_scalars(%e1_5312) : !cute.int_tuple<"?{div=2}">
          %iter_5313 = cute.get_iter(%view_5306) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5314, %e1_5315 = cute.get_leaves(%iter_5313) : !cute.int_tuple<"(?,?{div=2})">
          %2326 = cute.get_scalars(%e0_5314) : !cute.int_tuple<"?">
          %2327 = cute.get_scalars(%e1_5315) : !cute.int_tuple<"?{div=2}">
          %coord_5316 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_5317 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5318 = cute.crd2idx(%coord_5316, %lay_5317) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_5319 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5320 = cute.add_offset(%iter_5319, %idx_5318) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5321 = cute.make_view(%tup_5320) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5322 = cute.get_iter(%view_5321) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5323, %e1_5324 = cute.get_leaves(%iter_5322) : !cute.int_tuple<"(?,?{div=2})">
          %2328 = cute.get_scalars(%e0_5323) : !cute.int_tuple<"?">
          %2329 = cute.get_scalars(%e1_5324) : !cute.int_tuple<"?{div=2}">
          %iter_5325 = cute.get_iter(%view_5321) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5326, %e1_5327 = cute.get_leaves(%iter_5325) : !cute.int_tuple<"(?,?{div=2})">
          %2330 = cute.get_scalars(%e0_5326) : !cute.int_tuple<"?">
          %2331 = cute.get_scalars(%e1_5327) : !cute.int_tuple<"?{div=2}">
          %iter_5328 = cute.get_iter(%view_5321) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5329, %e1_5330 = cute.get_leaves(%iter_5328) : !cute.int_tuple<"(?,?{div=2})">
          %2332 = cute.get_scalars(%e0_5329) : !cute.int_tuple<"?">
          %2333 = cute.get_scalars(%e1_5330) : !cute.int_tuple<"?{div=2}">
          %coord_5331 = cute.make_coord(%e0_5314) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5332 = cute.make_coord(%e1_5330) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2334 = cute.get_scalars(%coord_5331) : !cute.coord<"?">
          %2335 = cute.get_scalars(%coord_5332) : !cute.coord<"?{div=2}">
          %true_5333 = arith.constant true
          %2336 = arith.cmpi slt, %2334, %2335 : i32
          %2337 = arith.andi %true_5333, %2336 : i1
          %lay_5334 = cute.get_layout(%2319) : !memref_rmem_f32_1
          %2338 = cute.get_shape(%lay_5334) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5335, %e1_5336, %e2_5337, %e3_5338 = cute.get_leaves(%2338) : !cute.shape<"((2,2),1,8)">
          %2339 = cute.get_stride(%lay_5334) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5339, %e1_5340, %e2_5341, %e3_5342 = cute.get_leaves(%2339) : !cute.stride<"((1,2),0,4)">
          %2340 = scf.if %2337 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2319) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
            cute.memref.store(%2319, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2319) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2319 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2319) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2319) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2319 : !memref_rmem_f32_1
          }
          %iter_5343 = cute.get_iter(%2340) : !memref_rmem_f32_1
          %lay_5344 = cute.get_layout(%2340) : !memref_rmem_f32_1
          %2341 = cute.get_shape(%lay_5344) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5345, %e1_5346, %e2_5347, %e3_5348 = cute.get_leaves(%2341) : !cute.shape<"((2,2),1,8)">
          %2342 = cute.get_stride(%lay_5344) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5349, %e1_5350, %e2_5351, %e3_5352 = cute.get_leaves(%2342) : !cute.stride<"((1,2),0,4)">
          %iter_5353 = cute.get_iter(%2340) : !memref_rmem_f32_1
          %iter_5354 = cute.get_iter(%2340) : !memref_rmem_f32_1
          %int_tuple_5355 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_5356 = cute.size(%int_tuple_5355) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_5357 = cute.get_leaves(%sz_5356) : !cute.int_tuple<"1">
          %int_tuple_5358 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_5359 = cute.size(%int_tuple_5358) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_5360 = cute.get_leaves(%sz_5359) : !cute.int_tuple<"8">
          %coord_5361 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_5362 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5363 = cute.crd2idx(%coord_5361, %lay_5362) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_5364 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5365 = cute.add_offset(%iter_5364, %idx_5363) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_5366 = cute.make_view(%tup_5365) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5367 = cute.get_iter(%view_5366) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5368, %e1_5369 = cute.get_leaves(%iter_5367) : !cute.int_tuple<"(?,?)">
          %2343 = cute.get_scalars(%e0_5368) : !cute.int_tuple<"?">
          %2344 = cute.get_scalars(%e1_5369) : !cute.int_tuple<"?">
          %iter_5370 = cute.get_iter(%view_5366) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5371, %e1_5372 = cute.get_leaves(%iter_5370) : !cute.int_tuple<"(?,?)">
          %2345 = cute.get_scalars(%e0_5371) : !cute.int_tuple<"?">
          %2346 = cute.get_scalars(%e1_5372) : !cute.int_tuple<"?">
          %iter_5373 = cute.get_iter(%view_5366) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5374, %e1_5375 = cute.get_leaves(%iter_5373) : !cute.int_tuple<"(?,?)">
          %2347 = cute.get_scalars(%e0_5374) : !cute.int_tuple<"?">
          %2348 = cute.get_scalars(%e1_5375) : !cute.int_tuple<"?">
          %coord_5376 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_5377 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5378 = cute.crd2idx(%coord_5376, %lay_5377) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_5379 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5380 = cute.add_offset(%iter_5379, %idx_5378) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_5381 = cute.make_view(%tup_5380) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5382 = cute.get_iter(%view_5381) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5383, %e1_5384 = cute.get_leaves(%iter_5382) : !cute.int_tuple<"(?,?)">
          %2349 = cute.get_scalars(%e0_5383) : !cute.int_tuple<"?">
          %2350 = cute.get_scalars(%e1_5384) : !cute.int_tuple<"?">
          %iter_5385 = cute.get_iter(%view_5381) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5386, %e1_5387 = cute.get_leaves(%iter_5385) : !cute.int_tuple<"(?,?)">
          %2351 = cute.get_scalars(%e0_5386) : !cute.int_tuple<"?">
          %2352 = cute.get_scalars(%e1_5387) : !cute.int_tuple<"?">
          %iter_5388 = cute.get_iter(%view_5381) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5389, %e1_5390 = cute.get_leaves(%iter_5388) : !cute.int_tuple<"(?,?)">
          %2353 = cute.get_scalars(%e0_5389) : !cute.int_tuple<"?">
          %2354 = cute.get_scalars(%e1_5390) : !cute.int_tuple<"?">
          %coord_5391 = cute.make_coord(%e0_5374) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5392 = cute.make_coord(%e1_5390) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2355 = cute.get_scalars(%coord_5391) : !cute.coord<"?">
          %2356 = cute.get_scalars(%coord_5392) : !cute.coord<"?">
          %true_5393 = arith.constant true
          %2357 = arith.cmpi slt, %2355, %2356 : i32
          %2358 = arith.andi %true_5393, %2357 : i1
          %lay_5394 = cute.get_layout(%2340) : !memref_rmem_f32_1
          %2359 = cute.get_shape(%lay_5394) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5395, %e1_5396, %e2_5397, %e3_5398 = cute.get_leaves(%2359) : !cute.shape<"((2,2),1,8)">
          %2360 = cute.get_stride(%lay_5394) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5399, %e1_5400, %e2_5401, %e3_5402 = cute.get_leaves(%2360) : !cute.stride<"((1,2),0,4)">
          %2361 = scf.if %2358 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2340) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
            cute.memref.store(%2340, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2340) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2340 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2340) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2340) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2340 : !memref_rmem_f32_1
          }
          %iter_5403 = cute.get_iter(%2361) : !memref_rmem_f32_1
          %lay_5404 = cute.get_layout(%2361) : !memref_rmem_f32_1
          %2362 = cute.get_shape(%lay_5404) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5405, %e1_5406, %e2_5407, %e3_5408 = cute.get_leaves(%2362) : !cute.shape<"((2,2),1,8)">
          %2363 = cute.get_stride(%lay_5404) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5409, %e1_5410, %e2_5411, %e3_5412 = cute.get_leaves(%2363) : !cute.stride<"((1,2),0,4)">
          %iter_5413 = cute.get_iter(%2361) : !memref_rmem_f32_1
          %iter_5414 = cute.get_iter(%2361) : !memref_rmem_f32_1
          %coord_5415 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_5416 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5417 = cute.crd2idx(%coord_5415, %lay_5416) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_5418 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5419 = cute.add_offset(%iter_5418, %idx_5417) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_5420 = cute.make_view(%tup_5419) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5421 = cute.get_iter(%view_5420) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5422, %e1_5423 = cute.get_leaves(%iter_5421) : !cute.int_tuple<"(?,?)">
          %2364 = cute.get_scalars(%e0_5422) : !cute.int_tuple<"?">
          %2365 = cute.get_scalars(%e1_5423) : !cute.int_tuple<"?">
          %iter_5424 = cute.get_iter(%view_5420) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5425, %e1_5426 = cute.get_leaves(%iter_5424) : !cute.int_tuple<"(?,?)">
          %2366 = cute.get_scalars(%e0_5425) : !cute.int_tuple<"?">
          %2367 = cute.get_scalars(%e1_5426) : !cute.int_tuple<"?">
          %iter_5427 = cute.get_iter(%view_5420) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5428, %e1_5429 = cute.get_leaves(%iter_5427) : !cute.int_tuple<"(?,?)">
          %2368 = cute.get_scalars(%e0_5428) : !cute.int_tuple<"?">
          %2369 = cute.get_scalars(%e1_5429) : !cute.int_tuple<"?">
          %coord_5430 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_5431 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5432 = cute.crd2idx(%coord_5430, %lay_5431) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_5433 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5434 = cute.add_offset(%iter_5433, %idx_5432) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_5435 = cute.make_view(%tup_5434) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5436 = cute.get_iter(%view_5435) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5437, %e1_5438 = cute.get_leaves(%iter_5436) : !cute.int_tuple<"(?,?)">
          %2370 = cute.get_scalars(%e0_5437) : !cute.int_tuple<"?">
          %2371 = cute.get_scalars(%e1_5438) : !cute.int_tuple<"?">
          %iter_5439 = cute.get_iter(%view_5435) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5440, %e1_5441 = cute.get_leaves(%iter_5439) : !cute.int_tuple<"(?,?)">
          %2372 = cute.get_scalars(%e0_5440) : !cute.int_tuple<"?">
          %2373 = cute.get_scalars(%e1_5441) : !cute.int_tuple<"?">
          %iter_5442 = cute.get_iter(%view_5435) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5443, %e1_5444 = cute.get_leaves(%iter_5442) : !cute.int_tuple<"(?,?)">
          %2374 = cute.get_scalars(%e0_5443) : !cute.int_tuple<"?">
          %2375 = cute.get_scalars(%e1_5444) : !cute.int_tuple<"?">
          %coord_5445 = cute.make_coord(%e0_5428) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5446 = cute.make_coord(%e1_5444) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2376 = cute.get_scalars(%coord_5445) : !cute.coord<"?">
          %2377 = cute.get_scalars(%coord_5446) : !cute.coord<"?">
          %true_5447 = arith.constant true
          %2378 = arith.cmpi slt, %2376, %2377 : i32
          %2379 = arith.andi %true_5447, %2378 : i1
          %lay_5448 = cute.get_layout(%2361) : !memref_rmem_f32_1
          %2380 = cute.get_shape(%lay_5448) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5449, %e1_5450, %e2_5451, %e3_5452 = cute.get_leaves(%2380) : !cute.shape<"((2,2),1,8)">
          %2381 = cute.get_stride(%lay_5448) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5453, %e1_5454, %e2_5455, %e3_5456 = cute.get_leaves(%2381) : !cute.stride<"((1,2),0,4)">
          %2382 = scf.if %2379 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2361) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
            cute.memref.store(%2361, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2361) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2361 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2361) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2361) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2361 : !memref_rmem_f32_1
          }
          %iter_5457 = cute.get_iter(%2382) : !memref_rmem_f32_1
          %lay_5458 = cute.get_layout(%2382) : !memref_rmem_f32_1
          %2383 = cute.get_shape(%lay_5458) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5459, %e1_5460, %e2_5461, %e3_5462 = cute.get_leaves(%2383) : !cute.shape<"((2,2),1,8)">
          %2384 = cute.get_stride(%lay_5458) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5463, %e1_5464, %e2_5465, %e3_5466 = cute.get_leaves(%2384) : !cute.stride<"((1,2),0,4)">
          %iter_5467 = cute.get_iter(%2382) : !memref_rmem_f32_1
          %iter_5468 = cute.get_iter(%2382) : !memref_rmem_f32_1
          %coord_5469 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_5470 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5471 = cute.crd2idx(%coord_5469, %lay_5470) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_5472 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5473 = cute.add_offset(%iter_5472, %idx_5471) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_5474 = cute.make_view(%tup_5473) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5475 = cute.get_iter(%view_5474) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5476, %e1_5477 = cute.get_leaves(%iter_5475) : !cute.int_tuple<"(?,?)">
          %2385 = cute.get_scalars(%e0_5476) : !cute.int_tuple<"?">
          %2386 = cute.get_scalars(%e1_5477) : !cute.int_tuple<"?">
          %iter_5478 = cute.get_iter(%view_5474) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5479, %e1_5480 = cute.get_leaves(%iter_5478) : !cute.int_tuple<"(?,?)">
          %2387 = cute.get_scalars(%e0_5479) : !cute.int_tuple<"?">
          %2388 = cute.get_scalars(%e1_5480) : !cute.int_tuple<"?">
          %iter_5481 = cute.get_iter(%view_5474) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5482, %e1_5483 = cute.get_leaves(%iter_5481) : !cute.int_tuple<"(?,?)">
          %2389 = cute.get_scalars(%e0_5482) : !cute.int_tuple<"?">
          %2390 = cute.get_scalars(%e1_5483) : !cute.int_tuple<"?">
          %coord_5484 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_5485 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5486 = cute.crd2idx(%coord_5484, %lay_5485) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_5487 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5488 = cute.add_offset(%iter_5487, %idx_5486) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_5489 = cute.make_view(%tup_5488) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5490 = cute.get_iter(%view_5489) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5491, %e1_5492 = cute.get_leaves(%iter_5490) : !cute.int_tuple<"(?,?)">
          %2391 = cute.get_scalars(%e0_5491) : !cute.int_tuple<"?">
          %2392 = cute.get_scalars(%e1_5492) : !cute.int_tuple<"?">
          %iter_5493 = cute.get_iter(%view_5489) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5494, %e1_5495 = cute.get_leaves(%iter_5493) : !cute.int_tuple<"(?,?)">
          %2393 = cute.get_scalars(%e0_5494) : !cute.int_tuple<"?">
          %2394 = cute.get_scalars(%e1_5495) : !cute.int_tuple<"?">
          %iter_5496 = cute.get_iter(%view_5489) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5497, %e1_5498 = cute.get_leaves(%iter_5496) : !cute.int_tuple<"(?,?)">
          %2395 = cute.get_scalars(%e0_5497) : !cute.int_tuple<"?">
          %2396 = cute.get_scalars(%e1_5498) : !cute.int_tuple<"?">
          %coord_5499 = cute.make_coord(%e0_5482) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5500 = cute.make_coord(%e1_5498) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2397 = cute.get_scalars(%coord_5499) : !cute.coord<"?">
          %2398 = cute.get_scalars(%coord_5500) : !cute.coord<"?">
          %true_5501 = arith.constant true
          %2399 = arith.cmpi slt, %2397, %2398 : i32
          %2400 = arith.andi %true_5501, %2399 : i1
          %lay_5502 = cute.get_layout(%2382) : !memref_rmem_f32_1
          %2401 = cute.get_shape(%lay_5502) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5503, %e1_5504, %e2_5505, %e3_5506 = cute.get_leaves(%2401) : !cute.shape<"((2,2),1,8)">
          %2402 = cute.get_stride(%lay_5502) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5507, %e1_5508, %e2_5509, %e3_5510 = cute.get_leaves(%2402) : !cute.stride<"((1,2),0,4)">
          %2403 = scf.if %2400 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2382) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
            cute.memref.store(%2382, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2382) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2382 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2382) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2382) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2382 : !memref_rmem_f32_1
          }
          %iter_5511 = cute.get_iter(%2403) : !memref_rmem_f32_1
          %lay_5512 = cute.get_layout(%2403) : !memref_rmem_f32_1
          %2404 = cute.get_shape(%lay_5512) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5513, %e1_5514, %e2_5515, %e3_5516 = cute.get_leaves(%2404) : !cute.shape<"((2,2),1,8)">
          %2405 = cute.get_stride(%lay_5512) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5517, %e1_5518, %e2_5519, %e3_5520 = cute.get_leaves(%2405) : !cute.stride<"((1,2),0,4)">
          %iter_5521 = cute.get_iter(%2403) : !memref_rmem_f32_1
          %iter_5522 = cute.get_iter(%2403) : !memref_rmem_f32_1
          %coord_5523 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_5524 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5525 = cute.crd2idx(%coord_5523, %lay_5524) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_5526 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5527 = cute.add_offset(%iter_5526, %idx_5525) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_5528 = cute.make_view(%tup_5527) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5529 = cute.get_iter(%view_5528) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5530, %e1_5531 = cute.get_leaves(%iter_5529) : !cute.int_tuple<"(?,?)">
          %2406 = cute.get_scalars(%e0_5530) : !cute.int_tuple<"?">
          %2407 = cute.get_scalars(%e1_5531) : !cute.int_tuple<"?">
          %iter_5532 = cute.get_iter(%view_5528) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5533, %e1_5534 = cute.get_leaves(%iter_5532) : !cute.int_tuple<"(?,?)">
          %2408 = cute.get_scalars(%e0_5533) : !cute.int_tuple<"?">
          %2409 = cute.get_scalars(%e1_5534) : !cute.int_tuple<"?">
          %iter_5535 = cute.get_iter(%view_5528) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5536, %e1_5537 = cute.get_leaves(%iter_5535) : !cute.int_tuple<"(?,?)">
          %2410 = cute.get_scalars(%e0_5536) : !cute.int_tuple<"?">
          %2411 = cute.get_scalars(%e1_5537) : !cute.int_tuple<"?">
          %coord_5538 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_5539 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5540 = cute.crd2idx(%coord_5538, %lay_5539) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_5541 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5542 = cute.add_offset(%iter_5541, %idx_5540) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_5543 = cute.make_view(%tup_5542) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5544 = cute.get_iter(%view_5543) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5545, %e1_5546 = cute.get_leaves(%iter_5544) : !cute.int_tuple<"(?,?)">
          %2412 = cute.get_scalars(%e0_5545) : !cute.int_tuple<"?">
          %2413 = cute.get_scalars(%e1_5546) : !cute.int_tuple<"?">
          %iter_5547 = cute.get_iter(%view_5543) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5548, %e1_5549 = cute.get_leaves(%iter_5547) : !cute.int_tuple<"(?,?)">
          %2414 = cute.get_scalars(%e0_5548) : !cute.int_tuple<"?">
          %2415 = cute.get_scalars(%e1_5549) : !cute.int_tuple<"?">
          %iter_5550 = cute.get_iter(%view_5543) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5551, %e1_5552 = cute.get_leaves(%iter_5550) : !cute.int_tuple<"(?,?)">
          %2416 = cute.get_scalars(%e0_5551) : !cute.int_tuple<"?">
          %2417 = cute.get_scalars(%e1_5552) : !cute.int_tuple<"?">
          %coord_5553 = cute.make_coord(%e0_5536) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5554 = cute.make_coord(%e1_5552) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2418 = cute.get_scalars(%coord_5553) : !cute.coord<"?">
          %2419 = cute.get_scalars(%coord_5554) : !cute.coord<"?">
          %true_5555 = arith.constant true
          %2420 = arith.cmpi slt, %2418, %2419 : i32
          %2421 = arith.andi %true_5555, %2420 : i1
          %lay_5556 = cute.get_layout(%2403) : !memref_rmem_f32_1
          %2422 = cute.get_shape(%lay_5556) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5557, %e1_5558, %e2_5559, %e3_5560 = cute.get_leaves(%2422) : !cute.shape<"((2,2),1,8)">
          %2423 = cute.get_stride(%lay_5556) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5561, %e1_5562, %e2_5563, %e3_5564 = cute.get_leaves(%2423) : !cute.stride<"((1,2),0,4)">
          %2424 = scf.if %2421 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2403) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
            cute.memref.store(%2403, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2403) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2403 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2403) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2403) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2403 : !memref_rmem_f32_1
          }
          %iter_5565 = cute.get_iter(%2424) : !memref_rmem_f32_1
          %lay_5566 = cute.get_layout(%2424) : !memref_rmem_f32_1
          %2425 = cute.get_shape(%lay_5566) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5567, %e1_5568, %e2_5569, %e3_5570 = cute.get_leaves(%2425) : !cute.shape<"((2,2),1,8)">
          %2426 = cute.get_stride(%lay_5566) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5571, %e1_5572, %e2_5573, %e3_5574 = cute.get_leaves(%2426) : !cute.stride<"((1,2),0,4)">
          %iter_5575 = cute.get_iter(%2424) : !memref_rmem_f32_1
          %iter_5576 = cute.get_iter(%2424) : !memref_rmem_f32_1
          %coord_5577 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_5578 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5579 = cute.crd2idx(%coord_5577, %lay_5578) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_5580 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5581 = cute.add_offset(%iter_5580, %idx_5579) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_5582 = cute.make_view(%tup_5581) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5583 = cute.get_iter(%view_5582) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5584, %e1_5585 = cute.get_leaves(%iter_5583) : !cute.int_tuple<"(?,?)">
          %2427 = cute.get_scalars(%e0_5584) : !cute.int_tuple<"?">
          %2428 = cute.get_scalars(%e1_5585) : !cute.int_tuple<"?">
          %iter_5586 = cute.get_iter(%view_5582) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5587, %e1_5588 = cute.get_leaves(%iter_5586) : !cute.int_tuple<"(?,?)">
          %2429 = cute.get_scalars(%e0_5587) : !cute.int_tuple<"?">
          %2430 = cute.get_scalars(%e1_5588) : !cute.int_tuple<"?">
          %iter_5589 = cute.get_iter(%view_5582) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5590, %e1_5591 = cute.get_leaves(%iter_5589) : !cute.int_tuple<"(?,?)">
          %2431 = cute.get_scalars(%e0_5590) : !cute.int_tuple<"?">
          %2432 = cute.get_scalars(%e1_5591) : !cute.int_tuple<"?">
          %coord_5592 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_5593 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5594 = cute.crd2idx(%coord_5592, %lay_5593) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_5595 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5596 = cute.add_offset(%iter_5595, %idx_5594) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_5597 = cute.make_view(%tup_5596) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5598 = cute.get_iter(%view_5597) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5599, %e1_5600 = cute.get_leaves(%iter_5598) : !cute.int_tuple<"(?,?)">
          %2433 = cute.get_scalars(%e0_5599) : !cute.int_tuple<"?">
          %2434 = cute.get_scalars(%e1_5600) : !cute.int_tuple<"?">
          %iter_5601 = cute.get_iter(%view_5597) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5602, %e1_5603 = cute.get_leaves(%iter_5601) : !cute.int_tuple<"(?,?)">
          %2435 = cute.get_scalars(%e0_5602) : !cute.int_tuple<"?">
          %2436 = cute.get_scalars(%e1_5603) : !cute.int_tuple<"?">
          %iter_5604 = cute.get_iter(%view_5597) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5605, %e1_5606 = cute.get_leaves(%iter_5604) : !cute.int_tuple<"(?,?)">
          %2437 = cute.get_scalars(%e0_5605) : !cute.int_tuple<"?">
          %2438 = cute.get_scalars(%e1_5606) : !cute.int_tuple<"?">
          %coord_5607 = cute.make_coord(%e0_5590) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5608 = cute.make_coord(%e1_5606) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2439 = cute.get_scalars(%coord_5607) : !cute.coord<"?">
          %2440 = cute.get_scalars(%coord_5608) : !cute.coord<"?">
          %true_5609 = arith.constant true
          %2441 = arith.cmpi slt, %2439, %2440 : i32
          %2442 = arith.andi %true_5609, %2441 : i1
          %lay_5610 = cute.get_layout(%2424) : !memref_rmem_f32_1
          %2443 = cute.get_shape(%lay_5610) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5611, %e1_5612, %e2_5613, %e3_5614 = cute.get_leaves(%2443) : !cute.shape<"((2,2),1,8)">
          %2444 = cute.get_stride(%lay_5610) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5615, %e1_5616, %e2_5617, %e3_5618 = cute.get_leaves(%2444) : !cute.stride<"((1,2),0,4)">
          %2445 = scf.if %2442 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2424) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
            cute.memref.store(%2424, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2424) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2424 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2424) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2424) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2424 : !memref_rmem_f32_1
          }
          %iter_5619 = cute.get_iter(%2445) : !memref_rmem_f32_1
          %lay_5620 = cute.get_layout(%2445) : !memref_rmem_f32_1
          %2446 = cute.get_shape(%lay_5620) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5621, %e1_5622, %e2_5623, %e3_5624 = cute.get_leaves(%2446) : !cute.shape<"((2,2),1,8)">
          %2447 = cute.get_stride(%lay_5620) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5625, %e1_5626, %e2_5627, %e3_5628 = cute.get_leaves(%2447) : !cute.stride<"((1,2),0,4)">
          %iter_5629 = cute.get_iter(%2445) : !memref_rmem_f32_1
          %iter_5630 = cute.get_iter(%2445) : !memref_rmem_f32_1
          %coord_5631 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_5632 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5633 = cute.crd2idx(%coord_5631, %lay_5632) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_5634 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5635 = cute.add_offset(%iter_5634, %idx_5633) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_5636 = cute.make_view(%tup_5635) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5637 = cute.get_iter(%view_5636) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5638, %e1_5639 = cute.get_leaves(%iter_5637) : !cute.int_tuple<"(?,?)">
          %2448 = cute.get_scalars(%e0_5638) : !cute.int_tuple<"?">
          %2449 = cute.get_scalars(%e1_5639) : !cute.int_tuple<"?">
          %iter_5640 = cute.get_iter(%view_5636) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5641, %e1_5642 = cute.get_leaves(%iter_5640) : !cute.int_tuple<"(?,?)">
          %2450 = cute.get_scalars(%e0_5641) : !cute.int_tuple<"?">
          %2451 = cute.get_scalars(%e1_5642) : !cute.int_tuple<"?">
          %iter_5643 = cute.get_iter(%view_5636) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5644, %e1_5645 = cute.get_leaves(%iter_5643) : !cute.int_tuple<"(?,?)">
          %2452 = cute.get_scalars(%e0_5644) : !cute.int_tuple<"?">
          %2453 = cute.get_scalars(%e1_5645) : !cute.int_tuple<"?">
          %coord_5646 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_5647 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5648 = cute.crd2idx(%coord_5646, %lay_5647) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_5649 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5650 = cute.add_offset(%iter_5649, %idx_5648) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_5651 = cute.make_view(%tup_5650) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5652 = cute.get_iter(%view_5651) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5653, %e1_5654 = cute.get_leaves(%iter_5652) : !cute.int_tuple<"(?,?)">
          %2454 = cute.get_scalars(%e0_5653) : !cute.int_tuple<"?">
          %2455 = cute.get_scalars(%e1_5654) : !cute.int_tuple<"?">
          %iter_5655 = cute.get_iter(%view_5651) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5656, %e1_5657 = cute.get_leaves(%iter_5655) : !cute.int_tuple<"(?,?)">
          %2456 = cute.get_scalars(%e0_5656) : !cute.int_tuple<"?">
          %2457 = cute.get_scalars(%e1_5657) : !cute.int_tuple<"?">
          %iter_5658 = cute.get_iter(%view_5651) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5659, %e1_5660 = cute.get_leaves(%iter_5658) : !cute.int_tuple<"(?,?)">
          %2458 = cute.get_scalars(%e0_5659) : !cute.int_tuple<"?">
          %2459 = cute.get_scalars(%e1_5660) : !cute.int_tuple<"?">
          %coord_5661 = cute.make_coord(%e0_5644) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5662 = cute.make_coord(%e1_5660) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2460 = cute.get_scalars(%coord_5661) : !cute.coord<"?">
          %2461 = cute.get_scalars(%coord_5662) : !cute.coord<"?">
          %true_5663 = arith.constant true
          %2462 = arith.cmpi slt, %2460, %2461 : i32
          %2463 = arith.andi %true_5663, %2462 : i1
          %lay_5664 = cute.get_layout(%2445) : !memref_rmem_f32_1
          %2464 = cute.get_shape(%lay_5664) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5665, %e1_5666, %e2_5667, %e3_5668 = cute.get_leaves(%2464) : !cute.shape<"((2,2),1,8)">
          %2465 = cute.get_stride(%lay_5664) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5669, %e1_5670, %e2_5671, %e3_5672 = cute.get_leaves(%2465) : !cute.stride<"((1,2),0,4)">
          %2466 = scf.if %2463 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2445) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
            cute.memref.store(%2445, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2445) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2445 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2445) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2445) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2445 : !memref_rmem_f32_1
          }
          %iter_5673 = cute.get_iter(%2466) : !memref_rmem_f32_1
          %lay_5674 = cute.get_layout(%2466) : !memref_rmem_f32_1
          %2467 = cute.get_shape(%lay_5674) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5675, %e1_5676, %e2_5677, %e3_5678 = cute.get_leaves(%2467) : !cute.shape<"((2,2),1,8)">
          %2468 = cute.get_stride(%lay_5674) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5679, %e1_5680, %e2_5681, %e3_5682 = cute.get_leaves(%2468) : !cute.stride<"((1,2),0,4)">
          %iter_5683 = cute.get_iter(%2466) : !memref_rmem_f32_1
          %iter_5684 = cute.get_iter(%2466) : !memref_rmem_f32_1
          %coord_5685 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_5686 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5687 = cute.crd2idx(%coord_5685, %lay_5686) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_5688 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5689 = cute.add_offset(%iter_5688, %idx_5687) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_5690 = cute.make_view(%tup_5689) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5691 = cute.get_iter(%view_5690) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5692, %e1_5693 = cute.get_leaves(%iter_5691) : !cute.int_tuple<"(?,?)">
          %2469 = cute.get_scalars(%e0_5692) : !cute.int_tuple<"?">
          %2470 = cute.get_scalars(%e1_5693) : !cute.int_tuple<"?">
          %iter_5694 = cute.get_iter(%view_5690) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5695, %e1_5696 = cute.get_leaves(%iter_5694) : !cute.int_tuple<"(?,?)">
          %2471 = cute.get_scalars(%e0_5695) : !cute.int_tuple<"?">
          %2472 = cute.get_scalars(%e1_5696) : !cute.int_tuple<"?">
          %iter_5697 = cute.get_iter(%view_5690) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5698, %e1_5699 = cute.get_leaves(%iter_5697) : !cute.int_tuple<"(?,?)">
          %2473 = cute.get_scalars(%e0_5698) : !cute.int_tuple<"?">
          %2474 = cute.get_scalars(%e1_5699) : !cute.int_tuple<"?">
          %coord_5700 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_5701 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5702 = cute.crd2idx(%coord_5700, %lay_5701) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_5703 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5704 = cute.add_offset(%iter_5703, %idx_5702) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_5705 = cute.make_view(%tup_5704) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5706 = cute.get_iter(%view_5705) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5707, %e1_5708 = cute.get_leaves(%iter_5706) : !cute.int_tuple<"(?,?)">
          %2475 = cute.get_scalars(%e0_5707) : !cute.int_tuple<"?">
          %2476 = cute.get_scalars(%e1_5708) : !cute.int_tuple<"?">
          %iter_5709 = cute.get_iter(%view_5705) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5710, %e1_5711 = cute.get_leaves(%iter_5709) : !cute.int_tuple<"(?,?)">
          %2477 = cute.get_scalars(%e0_5710) : !cute.int_tuple<"?">
          %2478 = cute.get_scalars(%e1_5711) : !cute.int_tuple<"?">
          %iter_5712 = cute.get_iter(%view_5705) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5713, %e1_5714 = cute.get_leaves(%iter_5712) : !cute.int_tuple<"(?,?)">
          %2479 = cute.get_scalars(%e0_5713) : !cute.int_tuple<"?">
          %2480 = cute.get_scalars(%e1_5714) : !cute.int_tuple<"?">
          %coord_5715 = cute.make_coord(%e0_5698) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5716 = cute.make_coord(%e1_5714) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2481 = cute.get_scalars(%coord_5715) : !cute.coord<"?">
          %2482 = cute.get_scalars(%coord_5716) : !cute.coord<"?">
          %true_5717 = arith.constant true
          %2483 = arith.cmpi slt, %2481, %2482 : i32
          %2484 = arith.andi %true_5717, %2483 : i1
          %lay_5718 = cute.get_layout(%2466) : !memref_rmem_f32_1
          %2485 = cute.get_shape(%lay_5718) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5719, %e1_5720, %e2_5721, %e3_5722 = cute.get_leaves(%2485) : !cute.shape<"((2,2),1,8)">
          %2486 = cute.get_stride(%lay_5718) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5723, %e1_5724, %e2_5725, %e3_5726 = cute.get_leaves(%2486) : !cute.stride<"((1,2),0,4)">
          %2487 = scf.if %2484 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2466) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
            cute.memref.store(%2466, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2466) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2466 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2466) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2466) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2466 : !memref_rmem_f32_1
          }
          %iter_5727 = cute.get_iter(%2487) : !memref_rmem_f32_1
          %lay_5728 = cute.get_layout(%2487) : !memref_rmem_f32_1
          %2488 = cute.get_shape(%lay_5728) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5729, %e1_5730, %e2_5731, %e3_5732 = cute.get_leaves(%2488) : !cute.shape<"((2,2),1,8)">
          %2489 = cute.get_stride(%lay_5728) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5733, %e1_5734, %e2_5735, %e3_5736 = cute.get_leaves(%2489) : !cute.stride<"((1,2),0,4)">
          %iter_5737 = cute.get_iter(%2487) : !memref_rmem_f32_1
          %iter_5738 = cute.get_iter(%2487) : !memref_rmem_f32_1
          %coord_5739 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_5740 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5741 = cute.crd2idx(%coord_5739, %lay_5740) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_5742 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5743 = cute.add_offset(%iter_5742, %idx_5741) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_5744 = cute.make_view(%tup_5743) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5745 = cute.get_iter(%view_5744) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5746, %e1_5747 = cute.get_leaves(%iter_5745) : !cute.int_tuple<"(?,?)">
          %2490 = cute.get_scalars(%e0_5746) : !cute.int_tuple<"?">
          %2491 = cute.get_scalars(%e1_5747) : !cute.int_tuple<"?">
          %iter_5748 = cute.get_iter(%view_5744) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5749, %e1_5750 = cute.get_leaves(%iter_5748) : !cute.int_tuple<"(?,?)">
          %2492 = cute.get_scalars(%e0_5749) : !cute.int_tuple<"?">
          %2493 = cute.get_scalars(%e1_5750) : !cute.int_tuple<"?">
          %iter_5751 = cute.get_iter(%view_5744) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5752, %e1_5753 = cute.get_leaves(%iter_5751) : !cute.int_tuple<"(?,?)">
          %2494 = cute.get_scalars(%e0_5752) : !cute.int_tuple<"?">
          %2495 = cute.get_scalars(%e1_5753) : !cute.int_tuple<"?">
          %coord_5754 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_5755 = cute.get_layout(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5756 = cute.crd2idx(%coord_5754, %lay_5755) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_5757 = cute.get_iter(%view_4029) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5758 = cute.add_offset(%iter_5757, %idx_5756) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_5759 = cute.make_view(%tup_5758) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5760 = cute.get_iter(%view_5759) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5761, %e1_5762 = cute.get_leaves(%iter_5760) : !cute.int_tuple<"(?,?)">
          %2496 = cute.get_scalars(%e0_5761) : !cute.int_tuple<"?">
          %2497 = cute.get_scalars(%e1_5762) : !cute.int_tuple<"?">
          %iter_5763 = cute.get_iter(%view_5759) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5764, %e1_5765 = cute.get_leaves(%iter_5763) : !cute.int_tuple<"(?,?)">
          %2498 = cute.get_scalars(%e0_5764) : !cute.int_tuple<"?">
          %2499 = cute.get_scalars(%e1_5765) : !cute.int_tuple<"?">
          %iter_5766 = cute.get_iter(%view_5759) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5767, %e1_5768 = cute.get_leaves(%iter_5766) : !cute.int_tuple<"(?,?)">
          %2500 = cute.get_scalars(%e0_5767) : !cute.int_tuple<"?">
          %2501 = cute.get_scalars(%e1_5768) : !cute.int_tuple<"?">
          %coord_5769 = cute.make_coord(%e0_5752) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5770 = cute.make_coord(%e1_5768) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2502 = cute.get_scalars(%coord_5769) : !cute.coord<"?">
          %2503 = cute.get_scalars(%coord_5770) : !cute.coord<"?">
          %true_5771 = arith.constant true
          %2504 = arith.cmpi slt, %2502, %2503 : i32
          %2505 = arith.andi %true_5771, %2504 : i1
          %lay_5772 = cute.get_layout(%2487) : !memref_rmem_f32_1
          %2506 = cute.get_shape(%lay_5772) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5773, %e1_5774, %e2_5775, %e3_5776 = cute.get_leaves(%2506) : !cute.shape<"((2,2),1,8)">
          %2507 = cute.get_stride(%lay_5772) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5777, %e1_5778, %e2_5779, %e3_5780 = cute.get_leaves(%2507) : !cute.stride<"((1,2),0,4)">
          %2508 = scf.if %2505 -> (!memref_rmem_f32_1) {
            %iter_5850 = cute.get_iter(%2487) : !memref_rmem_f32_1
            %cst_5851 = arith.constant 0.000000e+00 : f32
            %coord_5852 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
            cute.memref.store(%2487, %coord_5852, %cst_5851) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
            %lay_5853 = cute.get_layout(%2487) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5854, %e1_5855, %e2_5856, %e3_5857 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5853) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5858, %e1_5859, %e2_5860, %e3_5861 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2487 : !memref_rmem_f32_1
          } else {
            %iter_5850 = cute.get_iter(%2487) : !memref_rmem_f32_1
            %lay_5851 = cute.get_layout(%2487) : !memref_rmem_f32_1
            %2536 = cute.get_shape(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5852, %e1_5853, %e2_5854, %e3_5855 = cute.get_leaves(%2536) : !cute.shape<"((2,2),1,8)">
            %2537 = cute.get_stride(%lay_5851) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5856, %e1_5857, %e2_5858, %e3_5859 = cute.get_leaves(%2537) : !cute.stride<"((1,2),0,4)">
            scf.yield %2487 : !memref_rmem_f32_1
          }
          %iter_5781 = cute.get_iter(%2508) : !memref_rmem_f32_1
          %lay_5782 = cute.get_layout(%2508) : !memref_rmem_f32_1
          %2509 = cute.get_shape(%lay_5782) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5783, %e1_5784, %e2_5785, %e3_5786 = cute.get_leaves(%2509) : !cute.shape<"((2,2),1,8)">
          %2510 = cute.get_stride(%lay_5782) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5787, %e1_5788, %e2_5789, %e3_5790 = cute.get_leaves(%2510) : !cute.stride<"((1,2),0,4)">
          %iter_5791 = cute.get_iter(%2508) : !memref_rmem_f32_1
          %iter_5792 = cute.get_iter(%2508) : !memref_rmem_f32_1
          %lay_5793 = cute.get_layout(%2508) : !memref_rmem_f32_1
          %2511 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2511) : !cute.shape<"((2,2),1,8)">
          %2512 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2512) : !cute.stride<"((1,2),0,4)">
          %2513 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %2514 = cute.get_shape(%2513) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_5802, %e1_5803, %e2_5804, %e3_5805 = cute.get_leaves(%2514) : !cute.shape<"(32,4,1,1)">
          %2515 = cute.get_stride(%2513) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_5806, %e1_5807, %e2_5808, %e3_5809 = cute.get_leaves(%2515) : !cute.stride<"(1,32,0,0)">
          %2516 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_5810, %e1_5811, %e2_5812 = cute.get_leaves(%2516) : !cute.tile<"[64:1;16:1;16:1]">
          %2517 = cute.get_shape(%e0_5810) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_5813 = cute.get_leaves(%2517) : !cute.shape<"64">
          %2518 = cute.get_stride(%e0_5810) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_5814 = cute.get_leaves(%2518) : !cute.stride<"1">
          %2519 = cute.get_shape(%e1_5811) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5815 = cute.get_leaves(%2519) : !cute.shape<"16">
          %2520 = cute.get_stride(%e1_5811) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5816 = cute.get_leaves(%2520) : !cute.stride<"1">
          %2521 = cute.get_shape(%e2_5812) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5817 = cute.get_leaves(%2521) : !cute.shape<"16">
          %2522 = cute.get_stride(%e2_5812) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5818 = cute.get_leaves(%2522) : !cute.stride<"1">
          %2523 = cute.static : !cute.layout<"32:1">
          %2524 = cute.get_shape(%2523) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_5819 = cute.get_leaves(%2524) : !cute.shape<"32">
          %2525 = cute.get_stride(%2523) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_5820 = cute.get_leaves(%2525) : !cute.stride<"1">
          %2526 = cute.static : !cute.shape<"(16,8,16)">
          %e0_5821, %e1_5822, %e2_5823 = cute.get_leaves(%2526) : !cute.shape<"(16,8,16)">
          %2527 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %2528 = cute.get_shape(%2527) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_5824, %e1_5825, %e2_5826, %e3_5827, %e4_5828 = cute.get_leaves(%2528) : !cute.shape<"((4,8),(2,2,2))">
          %2529 = cute.get_stride(%2527) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_5829, %e1_5830, %e2_5831, %e3_5832, %e4_5833 = cute.get_leaves(%2529) : !cute.stride<"((32,1),(16,8,128))">
          %2530 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %2531 = cute.get_shape(%2530) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5834, %e1_5835, %e2_5836, %e3_5837 = cute.get_leaves(%2531) : !cute.shape<"((4,8),(2,2))">
          %2532 = cute.get_stride(%2530) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_5838, %e1_5839, %e2_5840, %e3_5841 = cute.get_leaves(%2532) : !cute.stride<"((16,1),(8,64))">
          %2533 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %2534 = cute.get_shape(%2533) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5842, %e1_5843, %e2_5844, %e3_5845 = cute.get_leaves(%2534) : !cute.shape<"((4,8),(2,2))">
          %2535 = cute.get_stride(%2533) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_5846, %e1_5847, %e2_5848, %e3_5849 = cute.get_leaves(%2535) : !cute.stride<"((32,1),(16,8))">
          scf.yield %2508, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        } else {
          %iter_4014 = cute.get_iter(%1688) : !memref_rmem_f32_1
          %lay_4015 = cute.get_layout(%1688) : !memref_rmem_f32_1
          %1825 = cute.get_shape(%lay_4015) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4016, %e1_4017, %e2_4018, %e3_4019 = cute.get_leaves(%1825) : !cute.shape<"((2,2),1,8)">
          %1826 = cute.get_stride(%lay_4015) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4020, %e1_4021, %e2_4022, %e3_4023 = cute.get_leaves(%1826) : !cute.stride<"((1,2),0,4)">
          %1827 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %1828 = cute.get_shape(%1827) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_4024, %e1_4025, %e2_4026, %e3_4027 = cute.get_leaves(%1828) : !cute.shape<"(32,4,1,1)">
          %1829 = cute.get_stride(%1827) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_4028, %e1_4029, %e2_4030, %e3_4031 = cute.get_leaves(%1829) : !cute.stride<"(1,32,0,0)">
          %1830 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_4032, %e1_4033, %e2_4034 = cute.get_leaves(%1830) : !cute.tile<"[64:1;16:1;16:1]">
          %1831 = cute.get_shape(%e0_4032) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_4035 = cute.get_leaves(%1831) : !cute.shape<"64">
          %1832 = cute.get_stride(%e0_4032) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_4036 = cute.get_leaves(%1832) : !cute.stride<"1">
          %1833 = cute.get_shape(%e1_4033) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_4037 = cute.get_leaves(%1833) : !cute.shape<"16">
          %1834 = cute.get_stride(%e1_4033) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_4038 = cute.get_leaves(%1834) : !cute.stride<"1">
          %1835 = cute.get_shape(%e2_4034) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_4039 = cute.get_leaves(%1835) : !cute.shape<"16">
          %1836 = cute.get_stride(%e2_4034) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_4040 = cute.get_leaves(%1836) : !cute.stride<"1">
          %1837 = cute.static : !cute.layout<"32:1">
          %1838 = cute.get_shape(%1837) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_4041 = cute.get_leaves(%1838) : !cute.shape<"32">
          %1839 = cute.get_stride(%1837) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_4042 = cute.get_leaves(%1839) : !cute.stride<"1">
          %1840 = cute.static : !cute.shape<"(16,8,16)">
          %e0_4043, %e1_4044, %e2_4045 = cute.get_leaves(%1840) : !cute.shape<"(16,8,16)">
          %1841 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %1842 = cute.get_shape(%1841) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_4046, %e1_4047, %e2_4048, %e3_4049, %e4_4050 = cute.get_leaves(%1842) : !cute.shape<"((4,8),(2,2,2))">
          %1843 = cute.get_stride(%1841) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_4051, %e1_4052, %e2_4053, %e3_4054, %e4_4055 = cute.get_leaves(%1843) : !cute.stride<"((32,1),(16,8,128))">
          %1844 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %1845 = cute.get_shape(%1844) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_4056, %e1_4057, %e2_4058, %e3_4059 = cute.get_leaves(%1845) : !cute.shape<"((4,8),(2,2))">
          %1846 = cute.get_stride(%1844) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_4060, %e1_4061, %e2_4062, %e3_4063 = cute.get_leaves(%1846) : !cute.stride<"((16,1),(8,64))">
          %1847 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %1848 = cute.get_shape(%1847) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_4064, %e1_4065, %e2_4066, %e3_4067 = cute.get_leaves(%1848) : !cute.shape<"((4,8),(2,2))">
          %1849 = cute.get_stride(%1847) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_4068, %e1_4069, %e2_4070, %e3_4071 = cute.get_leaves(%1849) : !cute.stride<"((32,1),(16,8))">
          scf.yield %1688, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        }
        %iter_3562 = cute.get_iter(%1733#0) : !memref_rmem_f32_1
        %lay_3563 = cute.get_layout(%1733#0) : !memref_rmem_f32_1
        %1734 = cute.get_shape(%lay_3563) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3564, %e1_3565, %e2_3566, %e3_3567 = cute.get_leaves(%1734) : !cute.shape<"((2,2),1,8)">
        %1735 = cute.get_stride(%lay_3563) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3568, %e1_3569, %e2_3570, %e3_3571 = cute.get_leaves(%1735) : !cute.stride<"((1,2),0,4)">
        %iter_3572 = cute.get_iter(%1733#0) : !memref_rmem_f32_1
        %iter_3573 = cute.get_iter(%1733#0) : !memref_rmem_f32_1
        %lay_3574 = cute.get_layout(%1733#0) : !memref_rmem_f32_1
        %lay_3575 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_3576 = cute.memref.alloca(%lay_3575) : !memref_rmem_bf16_6
        %iter_3577 = cute.get_iter(%rmem_3576) : !memref_rmem_bf16_6
        %iter_3578 = cute.get_iter(%rmem_3576) : !memref_rmem_bf16_6
        %lay_3579 = cute.get_layout(%1733#0) : !memref_rmem_f32_1
        %1736 = cute.get_shape(%lay_3579) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3580, %e1_3581, %e2_3582, %e3_3583 = cute.get_leaves(%1736) : !cute.shape<"((2,2),1,8)">
        %1737 = cute.memref.load_vec %1733#0 : !memref_rmem_f32_1
        %1738 = arith.truncf %1737 : vector<32xf32> to vector<32xbf16>
        %lay_3584 = cute.get_layout(%rmem_3576) : !memref_rmem_bf16_6
        %1739 = cute.get_shape(%lay_3584) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3585, %e1_3586, %e2_3587, %e3_3588 = cute.get_leaves(%1739) : !cute.shape<"((2,2),1,8)">
        %int_tuple_3589 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_3590 = cute.size(%int_tuple_3589) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_3591 = cute.get_leaves(%sz_3590) : !cute.int_tuple<"32">
        %int_tuple_3592 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_3593 = cute.size(%int_tuple_3592) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_3594 = cute.get_leaves(%sz_3593) : !cute.int_tuple<"32">
        cute.memref.store_vec %1738, %rmem_3576 : !memref_rmem_bf16_6
        %lay_3595 = cute.get_layout(%rmem_3576) : !memref_rmem_bf16_6
        %tile_3596 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_3597 = cute.make_layout() : !cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">
        %1740 = cute.get_shape(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3598, %e1_3599, %e2_3600, %e3_3601, %e4_3602 = cute.get_leaves(%1740) : !cute.shape<"((2,2),1,(2,4))">
        %1741 = cute.get_shape(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3603, %e1_3604, %e2_3605, %e3_3606, %e4_3607 = cute.get_leaves(%1741) : !cute.shape<"((2,2),1,(2,4))">
        %1742 = cute.get_shape(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3608, %e1_3609, %e2_3610, %e3_3611, %e4_3612 = cute.get_leaves(%1742) : !cute.shape<"((2,2),1,(2,4))">
        %1743 = cute.get_shape(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3613, %e1_3614, %e2_3615, %e3_3616, %e4_3617 = cute.get_leaves(%1743) : !cute.shape<"((2,2),1,(2,4))">
        %1744 = cute.get_stride(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3618, %e1_3619, %e2_3620, %e3_3621, %e4_3622 = cute.get_leaves(%1744) : !cute.stride<"((1,2),0,(4,8))">
        %1745 = cute.get_stride(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3623, %e1_3624, %e2_3625, %e3_3626, %e4_3627 = cute.get_leaves(%1745) : !cute.stride<"((1,2),0,(4,8))">
        %1746 = cute.get_stride(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3628, %e1_3629, %e2_3630, %e3_3631, %e4_3632 = cute.get_leaves(%1746) : !cute.stride<"((1,2),0,(4,8))">
        %1747 = cute.get_stride(%lay_3597) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3633, %e1_3634, %e2_3635, %e3_3636, %e4_3637 = cute.get_leaves(%1747) : !cute.stride<"((1,2),0,(4,8))">
        %shape_3638 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),1,4)">
        %stride_3639 = cute.make_stride() : () -> !cute.stride<"(((1,2),4),0,8)">
        %lay_3640 = cute.make_layout() : !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">
        %view_3641 = cute.make_view(%iter_3578, %lay_3640) : !memref_rmem_bf16_19
        %iter_3642 = cute.get_iter(%view_3641) : !memref_rmem_bf16_19
        %coord_3643 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3644 = cute.get_layout(%view_988) : !memref_smem_bf16_10
        %1748:2 = cute.get_scalars(%lay_3644) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_3645 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_3646 = cute.assume(%1748#0) : (i32) -> !cute.i32<divby 16>
        %iv_3647 = cute.assume(%1748#1) : (i32) -> !cute.i32<divby 32>
        %stride_3648 = cute.make_stride(%iv_3646, %iv_3647) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_3649 = cute.make_layout(%shape_3645, %stride_3648) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_3650 = cute.crd2idx(%coord_3643, %lay_3644) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_3651 = cute.get_iter(%view_988) : !memref_smem_bf16_10
        %ptr_3652 = cute.add_offset(%iter_3651, %idx_3650) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_3653 = cute.make_view(%ptr_3652, %lay_3649) : !memref_smem_bf16_21
        %iter_3654 = cute.get_iter(%view_3653) : !memref_smem_bf16_21
        %iter_3655 = cute.get_iter(%view_3653) : !memref_smem_bf16_21
        %coord_3656 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3657 = cute.get_layout(%view_991) : !memref_rmem_bf16_5
        %idx_3658 = cute.crd2idx(%coord_3656, %lay_3657) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_3659 = cute.get_iter(%view_991) : !memref_rmem_bf16_5
        %ptr_3660 = cute.add_offset(%iter_3659, %idx_3658) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3661 = cute.make_view(%ptr_3660) : !memref_rmem_bf16_20
        %iter_3662 = cute.get_iter(%view_3661) : !memref_rmem_bf16_20
        %iter_3663 = cute.get_iter(%view_3661) : !memref_rmem_bf16_20
        %lay_3664 = cute.get_layout(%view_3653) : !memref_smem_bf16_21
        %1749 = cute.get_shape(%lay_3664) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_3665, %e1_3666, %e2_3667, %e3_3668, %e4_3669 = cute.get_leaves(%1749) : !cute.shape<"((8,1),((2,2),2))">
        %lay_3670 = cute.get_layout(%view_3661) : !memref_rmem_bf16_20
        %1750 = cute.get_shape(%lay_3670) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_3671, %e1_3672, %e2_3673, %e3_3674 = cute.get_leaves(%1750) : !cute.shape<"((8,1),(4,2))">
        %lay_3675 = cute.get_layout(%view_3653) : !memref_smem_bf16_21
        %shape_3676 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3677 = cute.make_layout() : !cute.layout<"1:0">
        %append_3678 = cute.append_to_rank<2> (%lay_3675, %lay_3677) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_3679 = cute.make_view(%iter_3655, %append_3678) : !memref_smem_bf16_21
        %iter_3680 = cute.get_iter(%view_3679) : !memref_smem_bf16_21
        %lay_3681 = cute.get_layout(%view_3679) : !memref_smem_bf16_21
        %1751 = cute.get_shape(%lay_3681) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_3682, %e1_3683, %e2_3684, %e3_3685, %e4_3686 = cute.get_leaves(%1751) : !cute.shape<"((8,1),((2,2),2))">
        %iter_3687 = cute.get_iter(%view_3679) : !memref_smem_bf16_21
        %lay_3688 = cute.get_layout(%view_3679) : !memref_smem_bf16_21
        %1752:2 = cute.get_scalars(%lay_3688) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_3689 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_3690 = cute.assume(%1752#0) : (i32) -> !cute.i32<divby 16>
        %iv_3691 = cute.assume(%1752#1) : (i32) -> !cute.i32<divby 32>
        %stride_3692 = cute.make_stride(%iv_3690, %iv_3691) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_3693 = cute.make_layout(%shape_3689, %stride_3692) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_3694 = cute.make_view(%iter_3687, %lay_3693) : !memref_smem_bf16_22
        %iter_3695 = cute.get_iter(%view_3694) : !memref_smem_bf16_22
        %iter_3696 = cute.get_iter(%view_3694) : !memref_smem_bf16_22
        %lay_3697 = cute.get_layout(%view_3661) : !memref_rmem_bf16_20
        %shape_3698 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3699 = cute.make_layout() : !cute.layout<"1:0">
        %append_3700 = cute.append_to_rank<2> (%lay_3697, %lay_3699) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_3701 = cute.make_view(%iter_3663, %append_3700) : !memref_rmem_bf16_20
        %iter_3702 = cute.get_iter(%view_3701) : !memref_rmem_bf16_20
        %lay_3703 = cute.get_layout(%view_3701) : !memref_rmem_bf16_20
        %1753 = cute.get_shape(%lay_3703) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_3704, %e1_3705, %e2_3706, %e3_3707 = cute.get_leaves(%1753) : !cute.shape<"((8,1),(4,2))">
        %iter_3708 = cute.get_iter(%view_3701) : !memref_rmem_bf16_20
        %view_3709 = cute.make_view(%iter_3708) : !memref_rmem_bf16_21
        %iter_3710 = cute.get_iter(%view_3709) : !memref_rmem_bf16_21
        %iter_3711 = cute.get_iter(%view_3709) : !memref_rmem_bf16_21
        %lay_3712 = cute.get_layout(%view_3694) : !memref_smem_bf16_22
        %1754 = cute.get_shape(%lay_3712) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_3713, %e1_3714, %e2_3715, %e3_3716, %e4_3717 = cute.get_leaves(%1754) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_3718 = cute.get_layout(%view_3709) : !memref_rmem_bf16_21
        %1755 = cute.get_shape(%lay_3718) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_3719, %e1_3720, %e2_3721, %e3_3722 = cute.get_leaves(%1755) : !cute.shape<"((8,1),((4,2)))">
        %lay_3723 = cute.get_layout(%view_3694) : !memref_smem_bf16_22
        %sz_3724 = cute.size(%lay_3723) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_3725 = cute.get_leaves(%sz_3724) : !cute.int_tuple<"8">
        %lay_3726 = cute.get_layout(%view_3709) : !memref_rmem_bf16_21
        %sz_3727 = cute.size(%lay_3726) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_3728 = cute.get_leaves(%sz_3727) : !cute.int_tuple<"8">
        %1756 = cute.static : !cute.layout<"1:0">
        %iter_3729 = cute.get_iter(%view_3694) : !memref_smem_bf16_22
        %iter_3730 = cute.get_iter(%view_3709) : !memref_rmem_bf16_21
        %lay_3731 = cute.get_layout(%view_3694) : !memref_smem_bf16_22
        %lay_3732 = cute.get_layout(%view_3709) : !memref_rmem_bf16_21
        %append_3733 = cute.append_to_rank<2> (%lay_3731, %1756) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_3734 = cute.append_to_rank<2> (%lay_3732, %1756) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %1757:2 = cute.get_scalars(%append_3733) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_3735 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_3736 = cute.assume(%1757#0) : (i32) -> !cute.i32<divby 16>
        %iv_3737 = cute.assume(%1757#1) : (i32) -> !cute.i32<divby 32>
        %stride_3738 = cute.make_stride(%iv_3736, %iv_3737) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_3739 = cute.make_layout(%shape_3735, %stride_3738) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_3740 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_3741 = cute.size(%lay_3739) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %1758 = cute.get_scalars(%sz_3741) : !cute.int_tuple<"8">
        %c0_i32_3742 = arith.constant 0 : i32
        %c1_i32_3743 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3742 to %1758 step %c1_i32_3743  : i32 {
          %coord_4014 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1825:2 = cute.get_scalars(%lay_3739) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %1826 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4015 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4016 = cute.crd2idx(%coord_4014, %lay_3739) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_4017 = cute.add_offset(%iter_3729, %idx_4016) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4018 = cute.make_view(%ptr_4017, %lay_4015) : !memref_smem_bf16_14
          %1827 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_4019 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_4020 = cute.crd2idx(%coord_4014, %lay_3740) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_4021 = cute.add_offset(%iter_3730, %idx_4020) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4022 = cute.make_view(%ptr_4021, %lay_4019) : !memref_rmem_bf16_22
          %iter_4023 = cute.get_iter(%view_4018) : !memref_smem_bf16_14
          %iter_4024 = cute.get_iter(%view_4022) : !memref_rmem_bf16_22
          %swizzled = cute.apply_swizzle(%iter_4023) : !cute.ptr<bf16, smem, align<16>>
          %1828 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %1829 = llvm.mlir.constant(0 : i32) : i32
          %1830 = vector.extractelement %1828[%1829 : i32] : vector<4xi32>
          %1831 = builtin.unrealized_conversion_cast %iter_4024 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1830, %1831 : i32, !llvm.ptr
          %1832 = llvm.mlir.constant(1 : i32) : i32
          %1833 = vector.extractelement %1828[%1832 : i32] : vector<4xi32>
          %int_tuple_4025 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_4026 = cute.add_offset(%iter_4024, %int_tuple_4025) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1834 = builtin.unrealized_conversion_cast %ptr_4026 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1833, %1834 : i32, !llvm.ptr
          %1835 = llvm.mlir.constant(2 : i32) : i32
          %1836 = vector.extractelement %1828[%1835 : i32] : vector<4xi32>
          %int_tuple_4027 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_4028 = cute.add_offset(%iter_4024, %int_tuple_4027) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %1837 = builtin.unrealized_conversion_cast %ptr_4028 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1836, %1837 : i32, !llvm.ptr
          %1838 = llvm.mlir.constant(3 : i32) : i32
          %1839 = vector.extractelement %1828[%1838 : i32] : vector<4xi32>
          %int_tuple_4029 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_4030 = cute.add_offset(%iter_4024, %int_tuple_4029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %1840 = builtin.unrealized_conversion_cast %ptr_4030 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1839, %1840 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_3744 = cute.get_layout(%view_3641) : !memref_rmem_bf16_19
        %1759 = cute.get_shape(%lay_3744) : (!cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.shape<"(((2,2),2),1,4)">
        %e0_3745, %e1_3746, %e2_3747, %e3_3748, %e4_3749 = cute.get_leaves(%1759) : !cute.shape<"(((2,2),2),1,4)">
        %int_tuple_3750 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3751 = cute.size(%int_tuple_3750) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3752 = cute.get_leaves(%sz_3751) : !cute.int_tuple<"4">
        %int_tuple_3753 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3754 = cute.size(%int_tuple_3753) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3755 = cute.get_leaves(%sz_3754) : !cute.int_tuple<"4">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4015 = cute.get_layout(%view_988) : !memref_smem_bf16_10
          %1825:2 = cute.get_scalars(%lay_4015) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_4016 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_4017 = cute.assume(%1825#0) : (i32) -> !cute.i32<divby 16>
          %iv_4018 = cute.assume(%1825#1) : (i32) -> !cute.i32<divby 32>
          %stride_4019 = cute.make_stride(%iv_4017, %iv_4018) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_4020 = cute.make_layout(%shape_4016, %stride_4019) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_4021 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
          %iter_4022 = cute.get_iter(%view_988) : !memref_smem_bf16_10
          %ptr_4023 = cute.add_offset(%iter_4022, %idx_4021) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4024 = cute.make_view(%ptr_4023, %lay_4020) : !memref_smem_bf16_21
          %iter_4025 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %iter_4026 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %coord_4027 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4028 = cute.get_layout(%view_991) : !memref_rmem_bf16_5
          %idx_4029 = cute.crd2idx(%coord_4027, %lay_4028) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
          %iter_4030 = cute.get_iter(%view_991) : !memref_rmem_bf16_5
          %ptr_4031 = cute.add_offset(%iter_4030, %idx_4029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4032 = cute.make_view(%ptr_4031) : !memref_rmem_bf16_20
          %iter_4033 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %iter_4034 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %lay_4035 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %1826 = cute.get_shape(%lay_4035) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4036, %e1_4037, %e2_4038, %e3_4039, %e4_4040 = cute.get_leaves(%1826) : !cute.shape<"((8,1),((2,2),2))">
          %lay_4041 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %1827 = cute.get_shape(%lay_4041) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4042, %e1_4043, %e2_4044, %e3_4045 = cute.get_leaves(%1827) : !cute.shape<"((8,1),(4,2))">
          %lay_4046 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %shape_4047 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4048 = cute.make_layout() : !cute.layout<"1:0">
          %append_4049 = cute.append_to_rank<2> (%lay_4046, %lay_4048) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_4050 = cute.make_view(%iter_4026, %append_4049) : !memref_smem_bf16_21
          %iter_4051 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4052 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1828 = cute.get_shape(%lay_4052) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4053, %e1_4054, %e2_4055, %e3_4056, %e4_4057 = cute.get_leaves(%1828) : !cute.shape<"((8,1),((2,2),2))">
          %iter_4058 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4059 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1829:2 = cute.get_scalars(%lay_4059) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_4060 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_4061 = cute.assume(%1829#0) : (i32) -> !cute.i32<divby 16>
          %iv_4062 = cute.assume(%1829#1) : (i32) -> !cute.i32<divby 32>
          %stride_4063 = cute.make_stride(%iv_4061, %iv_4062) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4064 = cute.make_layout(%shape_4060, %stride_4063) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4065 = cute.make_view(%iter_4058, %lay_4064) : !memref_smem_bf16_22
          %iter_4066 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4067 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %lay_4068 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %shape_4069 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4070 = cute.make_layout() : !cute.layout<"1:0">
          %append_4071 = cute.append_to_rank<2> (%lay_4068, %lay_4070) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4072 = cute.make_view(%iter_4034, %append_4071) : !memref_rmem_bf16_20
          %iter_4073 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %lay_4074 = cute.get_layout(%view_4072) : !memref_rmem_bf16_20
          %1830 = cute.get_shape(%lay_4074) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4075, %e1_4076, %e2_4077, %e3_4078 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(4,2))">
          %iter_4079 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %view_4080 = cute.make_view(%iter_4079) : !memref_rmem_bf16_21
          %iter_4081 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %iter_4082 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4083 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %1831 = cute.get_shape(%lay_4083) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4084, %e1_4085, %e2_4086, %e3_4087, %e4_4088 = cute.get_leaves(%1831) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4089 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %1832 = cute.get_shape(%lay_4089) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4090, %e1_4091, %e2_4092, %e3_4093 = cute.get_leaves(%1832) : !cute.shape<"((8,1),((4,2)))">
          %lay_4094 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %sz_4095 = cute.size(%lay_4094) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4096 = cute.get_leaves(%sz_4095) : !cute.int_tuple<"8">
          %lay_4097 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %sz_4098 = cute.size(%lay_4097) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4099 = cute.get_leaves(%sz_4098) : !cute.int_tuple<"8">
          %1833 = cute.static : !cute.layout<"1:0">
          %iter_4100 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4101 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4102 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %lay_4103 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %append_4104 = cute.append_to_rank<2> (%lay_4102, %1833) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4105 = cute.append_to_rank<2> (%lay_4103, %1833) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1834:2 = cute.get_scalars(%append_4104) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4106 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4107 = cute.assume(%1834#0) : (i32) -> !cute.i32<divby 16>
          %iv_4108 = cute.assume(%1834#1) : (i32) -> !cute.i32<divby 32>
          %stride_4109 = cute.make_stride(%iv_4107, %iv_4108) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4110 = cute.make_layout(%shape_4106, %stride_4109) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4111 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4112 = cute.size(%lay_4110) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1835 = cute.get_scalars(%sz_4112) : !cute.int_tuple<"8">
          %c0_i32_4113 = arith.constant 0 : i32
          %c1_i32_4114 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4113 to %1835 step %c1_i32_4114  : i32 {
            %coord_4115 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1836:2 = cute.get_scalars(%lay_4110) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1837 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4116 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4117 = cute.crd2idx(%coord_4115, %lay_4110) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4118 = cute.add_offset(%iter_4100, %idx_4117) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4119 = cute.make_view(%ptr_4118, %lay_4116) : !memref_smem_bf16_14
            %1838 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4120 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4121 = cute.crd2idx(%coord_4115, %lay_4111) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4122 = cute.add_offset(%iter_4101, %idx_4121) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4123 = cute.make_view(%ptr_4122, %lay_4120) : !memref_rmem_bf16_22
            %iter_4124 = cute.get_iter(%view_4119) : !memref_smem_bf16_14
            %iter_4125 = cute.get_iter(%view_4123) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4124) : !cute.ptr<bf16, smem, align<16>>
            %1839 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1840 = llvm.mlir.constant(0 : i32) : i32
            %1841 = vector.extractelement %1839[%1840 : i32] : vector<4xi32>
            %1842 = builtin.unrealized_conversion_cast %iter_4125 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1841, %1842 : i32, !llvm.ptr
            %1843 = llvm.mlir.constant(1 : i32) : i32
            %1844 = vector.extractelement %1839[%1843 : i32] : vector<4xi32>
            %int_tuple_4126 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4127 = cute.add_offset(%iter_4125, %int_tuple_4126) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1845 = builtin.unrealized_conversion_cast %ptr_4127 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1844, %1845 : i32, !llvm.ptr
            %1846 = llvm.mlir.constant(2 : i32) : i32
            %1847 = vector.extractelement %1839[%1846 : i32] : vector<4xi32>
            %int_tuple_4128 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4129 = cute.add_offset(%iter_4125, %int_tuple_4128) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1848 = builtin.unrealized_conversion_cast %ptr_4129 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1847, %1848 : i32, !llvm.ptr
            %1849 = llvm.mlir.constant(3 : i32) : i32
            %1850 = vector.extractelement %1839[%1849 : i32] : vector<4xi32>
            %int_tuple_4130 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4131 = cute.add_offset(%iter_4125, %int_tuple_4130) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1851 = builtin.unrealized_conversion_cast %ptr_4131 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1850, %1851 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3756 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3757 = cute.get_layout(%view_3641) : !memref_rmem_bf16_19
        %idx_3758 = cute.crd2idx(%coord_3756, %lay_3757) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"0">
        %iter_3759 = cute.get_iter(%view_3641) : !memref_rmem_bf16_19
        %ptr_3760 = cute.add_offset(%iter_3759, %idx_3758) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3761 = cute.make_view(%ptr_3760) : !memref_rmem_bf16_23
        %iter_3762 = cute.get_iter(%view_3761) : !memref_rmem_bf16_23
        %iter_3763 = cute.get_iter(%view_3761) : !memref_rmem_bf16_23
        %coord_3764 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3765 = cute.get_layout(%rmem_757) : !memref_rmem_bf16_2
        %idx_3766 = cute.crd2idx(%coord_3764, %lay_3765) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_3767 = cute.get_iter(%rmem_757) : !memref_rmem_bf16_2
        %ptr_3768 = cute.add_offset(%iter_3767, %idx_3766) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3769 = cute.make_view(%ptr_3768) : !memref_rmem_bf16_24
        %iter_3770 = cute.get_iter(%view_3769) : !memref_rmem_bf16_24
        %iter_3771 = cute.get_iter(%view_3769) : !memref_rmem_bf16_24
        %lay_3772 = cute.get_layout(%view_3761) : !memref_rmem_bf16_23
        %1760 = cute.get_shape(%lay_3772) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3773, %e1_3774, %e2_3775, %e3_3776 = cute.get_leaves(%1760) : !cute.shape<"(((2,2),2),1)">
        %lay_3777 = cute.get_layout(%view_3769) : !memref_rmem_bf16_24
        %1761 = cute.get_shape(%lay_3777) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3778, %e1_3779, %e2_3780, %e3_3781 = cute.get_leaves(%1761) : !cute.shape<"((2,2),(8,2))">
        %lay_3782 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %1762 = cute.get_shape(%lay_3782) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
        %e0_3783, %e1_3784, %e2_3785, %e3_3786 = cute.get_leaves(%1762) : !cute.shape<"((2,2),1,16)">
        %iter_3787 = cute.get_iter(%view_3761) : !memref_rmem_bf16_23
        %iter_3788 = cute.get_iter(%view_3769) : !memref_rmem_bf16_24
        %iter_3789 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %iter_3790 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %lay_3791 = cute.get_layout(%view_3761) : !memref_rmem_bf16_23
        %lay_3792 = cute.get_layout(%view_3769) : !memref_rmem_bf16_24
        %lay_3793 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %lay_3794 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %1763 = cute.static : !cute.layout<"1:0">
        %append_3795 = cute.append_to_rank<3> (%lay_3791, %1763) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3796 = cute.append_to_rank<3> (%lay_3792, %1763) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3797 = cute.size(%append_3795) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3798 = cute.size(%append_3795) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3799 = cute.size(%append_3796) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1764 = cute.get_scalars(%sz_3797) : !cute.int_tuple<"1">
        %1765 = cute.get_scalars(%sz_3798) : !cute.int_tuple<"1">
        %1766 = cute.get_scalars(%sz_3799) : !cute.int_tuple<"16">
        %c0_i32_3800 = arith.constant 0 : i32
        %c1_i32_3801 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3800 to %1764 step %c1_i32_3801  : i32 {
          scf.for %arg9 = %c0_i32_3800 to %1765 step %c1_i32_3801  : i32 {
            scf.for %arg10 = %c0_i32_3800 to %1766 step %c1_i32_3801  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3795) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3787, %idx_4018) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_25
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3796) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3788, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3793) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3789, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3794) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3790, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_25
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<32>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3802 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3803 = cute.size(%int_tuple_3802) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3804 = cute.get_leaves(%sz_3803) : !cute.int_tuple<"4">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4015 = cute.get_layout(%view_988) : !memref_smem_bf16_10
          %1825:2 = cute.get_scalars(%lay_4015) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_4016 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_4017 = cute.assume(%1825#0) : (i32) -> !cute.i32<divby 16>
          %iv_4018 = cute.assume(%1825#1) : (i32) -> !cute.i32<divby 32>
          %stride_4019 = cute.make_stride(%iv_4017, %iv_4018) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_4020 = cute.make_layout(%shape_4016, %stride_4019) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_4021 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
          %iter_4022 = cute.get_iter(%view_988) : !memref_smem_bf16_10
          %ptr_4023 = cute.add_offset(%iter_4022, %idx_4021) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4024 = cute.make_view(%ptr_4023, %lay_4020) : !memref_smem_bf16_21
          %iter_4025 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %iter_4026 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %coord_4027 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4028 = cute.get_layout(%view_991) : !memref_rmem_bf16_5
          %idx_4029 = cute.crd2idx(%coord_4027, %lay_4028) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
          %iter_4030 = cute.get_iter(%view_991) : !memref_rmem_bf16_5
          %ptr_4031 = cute.add_offset(%iter_4030, %idx_4029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4032 = cute.make_view(%ptr_4031) : !memref_rmem_bf16_20
          %iter_4033 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %iter_4034 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %lay_4035 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %1826 = cute.get_shape(%lay_4035) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4036, %e1_4037, %e2_4038, %e3_4039, %e4_4040 = cute.get_leaves(%1826) : !cute.shape<"((8,1),((2,2),2))">
          %lay_4041 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %1827 = cute.get_shape(%lay_4041) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4042, %e1_4043, %e2_4044, %e3_4045 = cute.get_leaves(%1827) : !cute.shape<"((8,1),(4,2))">
          %lay_4046 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %shape_4047 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4048 = cute.make_layout() : !cute.layout<"1:0">
          %append_4049 = cute.append_to_rank<2> (%lay_4046, %lay_4048) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_4050 = cute.make_view(%iter_4026, %append_4049) : !memref_smem_bf16_21
          %iter_4051 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4052 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1828 = cute.get_shape(%lay_4052) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4053, %e1_4054, %e2_4055, %e3_4056, %e4_4057 = cute.get_leaves(%1828) : !cute.shape<"((8,1),((2,2),2))">
          %iter_4058 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4059 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1829:2 = cute.get_scalars(%lay_4059) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_4060 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_4061 = cute.assume(%1829#0) : (i32) -> !cute.i32<divby 16>
          %iv_4062 = cute.assume(%1829#1) : (i32) -> !cute.i32<divby 32>
          %stride_4063 = cute.make_stride(%iv_4061, %iv_4062) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4064 = cute.make_layout(%shape_4060, %stride_4063) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4065 = cute.make_view(%iter_4058, %lay_4064) : !memref_smem_bf16_22
          %iter_4066 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4067 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %lay_4068 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %shape_4069 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4070 = cute.make_layout() : !cute.layout<"1:0">
          %append_4071 = cute.append_to_rank<2> (%lay_4068, %lay_4070) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4072 = cute.make_view(%iter_4034, %append_4071) : !memref_rmem_bf16_20
          %iter_4073 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %lay_4074 = cute.get_layout(%view_4072) : !memref_rmem_bf16_20
          %1830 = cute.get_shape(%lay_4074) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4075, %e1_4076, %e2_4077, %e3_4078 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(4,2))">
          %iter_4079 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %view_4080 = cute.make_view(%iter_4079) : !memref_rmem_bf16_21
          %iter_4081 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %iter_4082 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4083 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %1831 = cute.get_shape(%lay_4083) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4084, %e1_4085, %e2_4086, %e3_4087, %e4_4088 = cute.get_leaves(%1831) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4089 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %1832 = cute.get_shape(%lay_4089) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4090, %e1_4091, %e2_4092, %e3_4093 = cute.get_leaves(%1832) : !cute.shape<"((8,1),((4,2)))">
          %lay_4094 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %sz_4095 = cute.size(%lay_4094) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4096 = cute.get_leaves(%sz_4095) : !cute.int_tuple<"8">
          %lay_4097 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %sz_4098 = cute.size(%lay_4097) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4099 = cute.get_leaves(%sz_4098) : !cute.int_tuple<"8">
          %1833 = cute.static : !cute.layout<"1:0">
          %iter_4100 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4101 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4102 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %lay_4103 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %append_4104 = cute.append_to_rank<2> (%lay_4102, %1833) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4105 = cute.append_to_rank<2> (%lay_4103, %1833) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1834:2 = cute.get_scalars(%append_4104) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4106 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4107 = cute.assume(%1834#0) : (i32) -> !cute.i32<divby 16>
          %iv_4108 = cute.assume(%1834#1) : (i32) -> !cute.i32<divby 32>
          %stride_4109 = cute.make_stride(%iv_4107, %iv_4108) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4110 = cute.make_layout(%shape_4106, %stride_4109) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4111 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4112 = cute.size(%lay_4110) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1835 = cute.get_scalars(%sz_4112) : !cute.int_tuple<"8">
          %c0_i32_4113 = arith.constant 0 : i32
          %c1_i32_4114 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4113 to %1835 step %c1_i32_4114  : i32 {
            %coord_4115 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1836:2 = cute.get_scalars(%lay_4110) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1837 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4116 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4117 = cute.crd2idx(%coord_4115, %lay_4110) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4118 = cute.add_offset(%iter_4100, %idx_4117) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4119 = cute.make_view(%ptr_4118, %lay_4116) : !memref_smem_bf16_14
            %1838 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4120 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4121 = cute.crd2idx(%coord_4115, %lay_4111) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4122 = cute.add_offset(%iter_4101, %idx_4121) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4123 = cute.make_view(%ptr_4122, %lay_4120) : !memref_rmem_bf16_22
            %iter_4124 = cute.get_iter(%view_4119) : !memref_smem_bf16_14
            %iter_4125 = cute.get_iter(%view_4123) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4124) : !cute.ptr<bf16, smem, align<16>>
            %1839 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1840 = llvm.mlir.constant(0 : i32) : i32
            %1841 = vector.extractelement %1839[%1840 : i32] : vector<4xi32>
            %1842 = builtin.unrealized_conversion_cast %iter_4125 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1841, %1842 : i32, !llvm.ptr
            %1843 = llvm.mlir.constant(1 : i32) : i32
            %1844 = vector.extractelement %1839[%1843 : i32] : vector<4xi32>
            %int_tuple_4126 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4127 = cute.add_offset(%iter_4125, %int_tuple_4126) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1845 = builtin.unrealized_conversion_cast %ptr_4127 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1844, %1845 : i32, !llvm.ptr
            %1846 = llvm.mlir.constant(2 : i32) : i32
            %1847 = vector.extractelement %1839[%1846 : i32] : vector<4xi32>
            %int_tuple_4128 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4129 = cute.add_offset(%iter_4125, %int_tuple_4128) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1848 = builtin.unrealized_conversion_cast %ptr_4129 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1847, %1848 : i32, !llvm.ptr
            %1849 = llvm.mlir.constant(3 : i32) : i32
            %1850 = vector.extractelement %1839[%1849 : i32] : vector<4xi32>
            %int_tuple_4130 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4131 = cute.add_offset(%iter_4125, %int_tuple_4130) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1851 = builtin.unrealized_conversion_cast %ptr_4131 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1850, %1851 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3805 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3806 = cute.get_layout(%view_3641) : !memref_rmem_bf16_19
        %idx_3807 = cute.crd2idx(%coord_3805, %lay_3806) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"8">
        %iter_3808 = cute.get_iter(%view_3641) : !memref_rmem_bf16_19
        %ptr_3809 = cute.add_offset(%iter_3808, %idx_3807) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3810 = cute.make_view(%ptr_3809) : !memref_rmem_bf16_26
        %iter_3811 = cute.get_iter(%view_3810) : !memref_rmem_bf16_26
        %iter_3812 = cute.get_iter(%view_3810) : !memref_rmem_bf16_26
        %coord_3813 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3814 = cute.get_layout(%rmem_757) : !memref_rmem_bf16_2
        %idx_3815 = cute.crd2idx(%coord_3813, %lay_3814) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_3816 = cute.get_iter(%rmem_757) : !memref_rmem_bf16_2
        %ptr_3817 = cute.add_offset(%iter_3816, %idx_3815) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3818 = cute.make_view(%ptr_3817) : !memref_rmem_bf16_24
        %iter_3819 = cute.get_iter(%view_3818) : !memref_rmem_bf16_24
        %iter_3820 = cute.get_iter(%view_3818) : !memref_rmem_bf16_24
        %lay_3821 = cute.get_layout(%view_3810) : !memref_rmem_bf16_26
        %1767 = cute.get_shape(%lay_3821) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3822, %e1_3823, %e2_3824, %e3_3825 = cute.get_leaves(%1767) : !cute.shape<"(((2,2),2),1)">
        %lay_3826 = cute.get_layout(%view_3818) : !memref_rmem_bf16_24
        %1768 = cute.get_shape(%lay_3826) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3827, %e1_3828, %e2_3829, %e3_3830 = cute.get_leaves(%1768) : !cute.shape<"((2,2),(8,2))">
        %iter_3831 = cute.get_iter(%view_3810) : !memref_rmem_bf16_26
        %iter_3832 = cute.get_iter(%view_3818) : !memref_rmem_bf16_24
        %iter_3833 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %iter_3834 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %lay_3835 = cute.get_layout(%view_3810) : !memref_rmem_bf16_26
        %lay_3836 = cute.get_layout(%view_3818) : !memref_rmem_bf16_24
        %lay_3837 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %lay_3838 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %1769 = cute.static : !cute.layout<"1:0">
        %append_3839 = cute.append_to_rank<3> (%lay_3835, %1769) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3840 = cute.append_to_rank<3> (%lay_3836, %1769) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3841 = cute.size(%append_3839) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3842 = cute.size(%append_3839) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3843 = cute.size(%append_3840) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1770 = cute.get_scalars(%sz_3841) : !cute.int_tuple<"1">
        %1771 = cute.get_scalars(%sz_3842) : !cute.int_tuple<"1">
        %1772 = cute.get_scalars(%sz_3843) : !cute.int_tuple<"16">
        %c0_i32_3844 = arith.constant 0 : i32
        %c1_i32_3845 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3844 to %1770 step %c1_i32_3845  : i32 {
          scf.for %arg9 = %c0_i32_3844 to %1771 step %c1_i32_3845  : i32 {
            scf.for %arg10 = %c0_i32_3844 to %1772 step %c1_i32_3845  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3839) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3831, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_27
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3840) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3832, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3837) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3833, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3838) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3834, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_27
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3846 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3847 = cute.size(%int_tuple_3846) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3848 = cute.get_leaves(%sz_3847) : !cute.int_tuple<"4">
        scf.if %true_3075 {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4015 = cute.get_layout(%view_988) : !memref_smem_bf16_10
          %1825:2 = cute.get_scalars(%lay_4015) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_4016 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_4017 = cute.assume(%1825#0) : (i32) -> !cute.i32<divby 16>
          %iv_4018 = cute.assume(%1825#1) : (i32) -> !cute.i32<divby 32>
          %stride_4019 = cute.make_stride(%iv_4017, %iv_4018) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_4020 = cute.make_layout(%shape_4016, %stride_4019) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_4021 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
          %iter_4022 = cute.get_iter(%view_988) : !memref_smem_bf16_10
          %ptr_4023 = cute.add_offset(%iter_4022, %idx_4021) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4024 = cute.make_view(%ptr_4023, %lay_4020) : !memref_smem_bf16_21
          %iter_4025 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %iter_4026 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %coord_4027 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4028 = cute.get_layout(%view_991) : !memref_rmem_bf16_5
          %idx_4029 = cute.crd2idx(%coord_4027, %lay_4028) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
          %iter_4030 = cute.get_iter(%view_991) : !memref_rmem_bf16_5
          %ptr_4031 = cute.add_offset(%iter_4030, %idx_4029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4032 = cute.make_view(%ptr_4031) : !memref_rmem_bf16_20
          %iter_4033 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %iter_4034 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %lay_4035 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %1826 = cute.get_shape(%lay_4035) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4036, %e1_4037, %e2_4038, %e3_4039, %e4_4040 = cute.get_leaves(%1826) : !cute.shape<"((8,1),((2,2),2))">
          %lay_4041 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %1827 = cute.get_shape(%lay_4041) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4042, %e1_4043, %e2_4044, %e3_4045 = cute.get_leaves(%1827) : !cute.shape<"((8,1),(4,2))">
          %lay_4046 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %shape_4047 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4048 = cute.make_layout() : !cute.layout<"1:0">
          %append_4049 = cute.append_to_rank<2> (%lay_4046, %lay_4048) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_4050 = cute.make_view(%iter_4026, %append_4049) : !memref_smem_bf16_21
          %iter_4051 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4052 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1828 = cute.get_shape(%lay_4052) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4053, %e1_4054, %e2_4055, %e3_4056, %e4_4057 = cute.get_leaves(%1828) : !cute.shape<"((8,1),((2,2),2))">
          %iter_4058 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4059 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1829:2 = cute.get_scalars(%lay_4059) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_4060 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_4061 = cute.assume(%1829#0) : (i32) -> !cute.i32<divby 16>
          %iv_4062 = cute.assume(%1829#1) : (i32) -> !cute.i32<divby 32>
          %stride_4063 = cute.make_stride(%iv_4061, %iv_4062) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4064 = cute.make_layout(%shape_4060, %stride_4063) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4065 = cute.make_view(%iter_4058, %lay_4064) : !memref_smem_bf16_22
          %iter_4066 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4067 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %lay_4068 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %shape_4069 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4070 = cute.make_layout() : !cute.layout<"1:0">
          %append_4071 = cute.append_to_rank<2> (%lay_4068, %lay_4070) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4072 = cute.make_view(%iter_4034, %append_4071) : !memref_rmem_bf16_20
          %iter_4073 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %lay_4074 = cute.get_layout(%view_4072) : !memref_rmem_bf16_20
          %1830 = cute.get_shape(%lay_4074) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4075, %e1_4076, %e2_4077, %e3_4078 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(4,2))">
          %iter_4079 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %view_4080 = cute.make_view(%iter_4079) : !memref_rmem_bf16_21
          %iter_4081 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %iter_4082 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4083 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %1831 = cute.get_shape(%lay_4083) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4084, %e1_4085, %e2_4086, %e3_4087, %e4_4088 = cute.get_leaves(%1831) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4089 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %1832 = cute.get_shape(%lay_4089) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4090, %e1_4091, %e2_4092, %e3_4093 = cute.get_leaves(%1832) : !cute.shape<"((8,1),((4,2)))">
          %lay_4094 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %sz_4095 = cute.size(%lay_4094) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4096 = cute.get_leaves(%sz_4095) : !cute.int_tuple<"8">
          %lay_4097 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %sz_4098 = cute.size(%lay_4097) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4099 = cute.get_leaves(%sz_4098) : !cute.int_tuple<"8">
          %1833 = cute.static : !cute.layout<"1:0">
          %iter_4100 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4101 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4102 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %lay_4103 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %append_4104 = cute.append_to_rank<2> (%lay_4102, %1833) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4105 = cute.append_to_rank<2> (%lay_4103, %1833) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1834:2 = cute.get_scalars(%append_4104) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4106 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4107 = cute.assume(%1834#0) : (i32) -> !cute.i32<divby 16>
          %iv_4108 = cute.assume(%1834#1) : (i32) -> !cute.i32<divby 32>
          %stride_4109 = cute.make_stride(%iv_4107, %iv_4108) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4110 = cute.make_layout(%shape_4106, %stride_4109) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4111 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4112 = cute.size(%lay_4110) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1835 = cute.get_scalars(%sz_4112) : !cute.int_tuple<"8">
          %c0_i32_4113 = arith.constant 0 : i32
          %c1_i32_4114 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4113 to %1835 step %c1_i32_4114  : i32 {
            %coord_4115 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1836:2 = cute.get_scalars(%lay_4110) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1837 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4116 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4117 = cute.crd2idx(%coord_4115, %lay_4110) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4118 = cute.add_offset(%iter_4100, %idx_4117) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4119 = cute.make_view(%ptr_4118, %lay_4116) : !memref_smem_bf16_14
            %1838 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4120 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4121 = cute.crd2idx(%coord_4115, %lay_4111) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4122 = cute.add_offset(%iter_4101, %idx_4121) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4123 = cute.make_view(%ptr_4122, %lay_4120) : !memref_rmem_bf16_22
            %iter_4124 = cute.get_iter(%view_4119) : !memref_smem_bf16_14
            %iter_4125 = cute.get_iter(%view_4123) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4124) : !cute.ptr<bf16, smem, align<16>>
            %1839 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1840 = llvm.mlir.constant(0 : i32) : i32
            %1841 = vector.extractelement %1839[%1840 : i32] : vector<4xi32>
            %1842 = builtin.unrealized_conversion_cast %iter_4125 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1841, %1842 : i32, !llvm.ptr
            %1843 = llvm.mlir.constant(1 : i32) : i32
            %1844 = vector.extractelement %1839[%1843 : i32] : vector<4xi32>
            %int_tuple_4126 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4127 = cute.add_offset(%iter_4125, %int_tuple_4126) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1845 = builtin.unrealized_conversion_cast %ptr_4127 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1844, %1845 : i32, !llvm.ptr
            %1846 = llvm.mlir.constant(2 : i32) : i32
            %1847 = vector.extractelement %1839[%1846 : i32] : vector<4xi32>
            %int_tuple_4128 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4129 = cute.add_offset(%iter_4125, %int_tuple_4128) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1848 = builtin.unrealized_conversion_cast %ptr_4129 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1847, %1848 : i32, !llvm.ptr
            %1849 = llvm.mlir.constant(3 : i32) : i32
            %1850 = vector.extractelement %1839[%1849 : i32] : vector<4xi32>
            %int_tuple_4130 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4131 = cute.add_offset(%iter_4125, %int_tuple_4130) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1851 = builtin.unrealized_conversion_cast %ptr_4131 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1850, %1851 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3849 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3850 = cute.get_layout(%view_3641) : !memref_rmem_bf16_19
        %idx_3851 = cute.crd2idx(%coord_3849, %lay_3850) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"16">
        %iter_3852 = cute.get_iter(%view_3641) : !memref_rmem_bf16_19
        %ptr_3853 = cute.add_offset(%iter_3852, %idx_3851) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3854 = cute.make_view(%ptr_3853) : !memref_rmem_bf16_23
        %iter_3855 = cute.get_iter(%view_3854) : !memref_rmem_bf16_23
        %iter_3856 = cute.get_iter(%view_3854) : !memref_rmem_bf16_23
        %coord_3857 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3858 = cute.get_layout(%rmem_757) : !memref_rmem_bf16_2
        %idx_3859 = cute.crd2idx(%coord_3857, %lay_3858) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_3860 = cute.get_iter(%rmem_757) : !memref_rmem_bf16_2
        %ptr_3861 = cute.add_offset(%iter_3860, %idx_3859) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3862 = cute.make_view(%ptr_3861) : !memref_rmem_bf16_24
        %iter_3863 = cute.get_iter(%view_3862) : !memref_rmem_bf16_24
        %iter_3864 = cute.get_iter(%view_3862) : !memref_rmem_bf16_24
        %lay_3865 = cute.get_layout(%view_3854) : !memref_rmem_bf16_23
        %1773 = cute.get_shape(%lay_3865) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3866, %e1_3867, %e2_3868, %e3_3869 = cute.get_leaves(%1773) : !cute.shape<"(((2,2),2),1)">
        %lay_3870 = cute.get_layout(%view_3862) : !memref_rmem_bf16_24
        %1774 = cute.get_shape(%lay_3870) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3871, %e1_3872, %e2_3873, %e3_3874 = cute.get_leaves(%1774) : !cute.shape<"((2,2),(8,2))">
        %iter_3875 = cute.get_iter(%view_3854) : !memref_rmem_bf16_23
        %iter_3876 = cute.get_iter(%view_3862) : !memref_rmem_bf16_24
        %iter_3877 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %iter_3878 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %lay_3879 = cute.get_layout(%view_3854) : !memref_rmem_bf16_23
        %lay_3880 = cute.get_layout(%view_3862) : !memref_rmem_bf16_24
        %lay_3881 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %lay_3882 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %1775 = cute.static : !cute.layout<"1:0">
        %append_3883 = cute.append_to_rank<3> (%lay_3879, %1775) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3884 = cute.append_to_rank<3> (%lay_3880, %1775) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3885 = cute.size(%append_3883) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3886 = cute.size(%append_3883) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3887 = cute.size(%append_3884) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1776 = cute.get_scalars(%sz_3885) : !cute.int_tuple<"1">
        %1777 = cute.get_scalars(%sz_3886) : !cute.int_tuple<"1">
        %1778 = cute.get_scalars(%sz_3887) : !cute.int_tuple<"16">
        %c0_i32_3888 = arith.constant 0 : i32
        %c1_i32_3889 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3888 to %1776 step %c1_i32_3889  : i32 {
          scf.for %arg9 = %c0_i32_3888 to %1777 step %c1_i32_3889  : i32 {
            scf.for %arg10 = %c0_i32_3888 to %1778 step %c1_i32_3889  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3883) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3875, %idx_4018) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_25
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3884) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3876, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3881) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3877, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3882) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3878, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_25
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<32>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3890 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3891 = cute.size(%int_tuple_3890) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3892 = cute.get_leaves(%sz_3891) : !cute.int_tuple<"4">
        scf.if %false {
          %coord_4014 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4015 = cute.get_layout(%view_988) : !memref_smem_bf16_10
          %1825:2 = cute.get_scalars(%lay_4015) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_4016 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_4017 = cute.assume(%1825#0) : (i32) -> !cute.i32<divby 16>
          %iv_4018 = cute.assume(%1825#1) : (i32) -> !cute.i32<divby 32>
          %stride_4019 = cute.make_stride(%iv_4017, %iv_4018) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_4020 = cute.make_layout(%shape_4016, %stride_4019) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_4021 = cute.crd2idx(%coord_4014, %lay_4015) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"4096">
          %iter_4022 = cute.get_iter(%view_988) : !memref_smem_bf16_10
          %ptr_4023 = cute.add_offset(%iter_4022, %idx_4021) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4024 = cute.make_view(%ptr_4023, %lay_4020) : !memref_smem_bf16_21
          %iter_4025 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %iter_4026 = cute.get_iter(%view_4024) : !memref_smem_bf16_21
          %coord_4027 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4028 = cute.get_layout(%view_991) : !memref_rmem_bf16_5
          %idx_4029 = cute.crd2idx(%coord_4027, %lay_4028) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"128">
          %iter_4030 = cute.get_iter(%view_991) : !memref_rmem_bf16_5
          %ptr_4031 = cute.add_offset(%iter_4030, %idx_4029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4032 = cute.make_view(%ptr_4031) : !memref_rmem_bf16_20
          %iter_4033 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %iter_4034 = cute.get_iter(%view_4032) : !memref_rmem_bf16_20
          %lay_4035 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %1826 = cute.get_shape(%lay_4035) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4036, %e1_4037, %e2_4038, %e3_4039, %e4_4040 = cute.get_leaves(%1826) : !cute.shape<"((8,1),((2,2),2))">
          %lay_4041 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %1827 = cute.get_shape(%lay_4041) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4042, %e1_4043, %e2_4044, %e3_4045 = cute.get_leaves(%1827) : !cute.shape<"((8,1),(4,2))">
          %lay_4046 = cute.get_layout(%view_4024) : !memref_smem_bf16_21
          %shape_4047 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4048 = cute.make_layout() : !cute.layout<"1:0">
          %append_4049 = cute.append_to_rank<2> (%lay_4046, %lay_4048) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_4050 = cute.make_view(%iter_4026, %append_4049) : !memref_smem_bf16_21
          %iter_4051 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4052 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1828 = cute.get_shape(%lay_4052) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_4053, %e1_4054, %e2_4055, %e3_4056, %e4_4057 = cute.get_leaves(%1828) : !cute.shape<"((8,1),((2,2),2))">
          %iter_4058 = cute.get_iter(%view_4050) : !memref_smem_bf16_21
          %lay_4059 = cute.get_layout(%view_4050) : !memref_smem_bf16_21
          %1829:2 = cute.get_scalars(%lay_4059) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_4060 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_4061 = cute.assume(%1829#0) : (i32) -> !cute.i32<divby 16>
          %iv_4062 = cute.assume(%1829#1) : (i32) -> !cute.i32<divby 32>
          %stride_4063 = cute.make_stride(%iv_4061, %iv_4062) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4064 = cute.make_layout(%shape_4060, %stride_4063) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4065 = cute.make_view(%iter_4058, %lay_4064) : !memref_smem_bf16_22
          %iter_4066 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4067 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %lay_4068 = cute.get_layout(%view_4032) : !memref_rmem_bf16_20
          %shape_4069 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4070 = cute.make_layout() : !cute.layout<"1:0">
          %append_4071 = cute.append_to_rank<2> (%lay_4068, %lay_4070) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4072 = cute.make_view(%iter_4034, %append_4071) : !memref_rmem_bf16_20
          %iter_4073 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %lay_4074 = cute.get_layout(%view_4072) : !memref_rmem_bf16_20
          %1830 = cute.get_shape(%lay_4074) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4075, %e1_4076, %e2_4077, %e3_4078 = cute.get_leaves(%1830) : !cute.shape<"((8,1),(4,2))">
          %iter_4079 = cute.get_iter(%view_4072) : !memref_rmem_bf16_20
          %view_4080 = cute.make_view(%iter_4079) : !memref_rmem_bf16_21
          %iter_4081 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %iter_4082 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4083 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %1831 = cute.get_shape(%lay_4083) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4084, %e1_4085, %e2_4086, %e3_4087, %e4_4088 = cute.get_leaves(%1831) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4089 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %1832 = cute.get_shape(%lay_4089) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4090, %e1_4091, %e2_4092, %e3_4093 = cute.get_leaves(%1832) : !cute.shape<"((8,1),((4,2)))">
          %lay_4094 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %sz_4095 = cute.size(%lay_4094) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4096 = cute.get_leaves(%sz_4095) : !cute.int_tuple<"8">
          %lay_4097 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %sz_4098 = cute.size(%lay_4097) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4099 = cute.get_leaves(%sz_4098) : !cute.int_tuple<"8">
          %1833 = cute.static : !cute.layout<"1:0">
          %iter_4100 = cute.get_iter(%view_4065) : !memref_smem_bf16_22
          %iter_4101 = cute.get_iter(%view_4080) : !memref_rmem_bf16_21
          %lay_4102 = cute.get_layout(%view_4065) : !memref_smem_bf16_22
          %lay_4103 = cute.get_layout(%view_4080) : !memref_rmem_bf16_21
          %append_4104 = cute.append_to_rank<2> (%lay_4102, %1833) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4105 = cute.append_to_rank<2> (%lay_4103, %1833) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1834:2 = cute.get_scalars(%append_4104) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4106 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4107 = cute.assume(%1834#0) : (i32) -> !cute.i32<divby 16>
          %iv_4108 = cute.assume(%1834#1) : (i32) -> !cute.i32<divby 32>
          %stride_4109 = cute.make_stride(%iv_4107, %iv_4108) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4110 = cute.make_layout(%shape_4106, %stride_4109) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4111 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4112 = cute.size(%lay_4110) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1835 = cute.get_scalars(%sz_4112) : !cute.int_tuple<"8">
          %c0_i32_4113 = arith.constant 0 : i32
          %c1_i32_4114 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4113 to %1835 step %c1_i32_4114  : i32 {
            %coord_4115 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1836:2 = cute.get_scalars(%lay_4110) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1837 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4116 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4117 = cute.crd2idx(%coord_4115, %lay_4110) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4118 = cute.add_offset(%iter_4100, %idx_4117) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4119 = cute.make_view(%ptr_4118, %lay_4116) : !memref_smem_bf16_14
            %1838 = cute.get_scalars(%coord_4115) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4120 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4121 = cute.crd2idx(%coord_4115, %lay_4111) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4122 = cute.add_offset(%iter_4101, %idx_4121) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4123 = cute.make_view(%ptr_4122, %lay_4120) : !memref_rmem_bf16_22
            %iter_4124 = cute.get_iter(%view_4119) : !memref_smem_bf16_14
            %iter_4125 = cute.get_iter(%view_4123) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4124) : !cute.ptr<bf16, smem, align<16>>
            %1839 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1840 = llvm.mlir.constant(0 : i32) : i32
            %1841 = vector.extractelement %1839[%1840 : i32] : vector<4xi32>
            %1842 = builtin.unrealized_conversion_cast %iter_4125 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1841, %1842 : i32, !llvm.ptr
            %1843 = llvm.mlir.constant(1 : i32) : i32
            %1844 = vector.extractelement %1839[%1843 : i32] : vector<4xi32>
            %int_tuple_4126 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4127 = cute.add_offset(%iter_4125, %int_tuple_4126) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1845 = builtin.unrealized_conversion_cast %ptr_4127 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1844, %1845 : i32, !llvm.ptr
            %1846 = llvm.mlir.constant(2 : i32) : i32
            %1847 = vector.extractelement %1839[%1846 : i32] : vector<4xi32>
            %int_tuple_4128 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4129 = cute.add_offset(%iter_4125, %int_tuple_4128) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1848 = builtin.unrealized_conversion_cast %ptr_4129 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1847, %1848 : i32, !llvm.ptr
            %1849 = llvm.mlir.constant(3 : i32) : i32
            %1850 = vector.extractelement %1839[%1849 : i32] : vector<4xi32>
            %int_tuple_4130 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4131 = cute.add_offset(%iter_4125, %int_tuple_4130) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1851 = builtin.unrealized_conversion_cast %ptr_4131 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1850, %1851 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3893 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3894 = cute.get_layout(%view_3641) : !memref_rmem_bf16_19
        %idx_3895 = cute.crd2idx(%coord_3893, %lay_3894) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"24">
        %iter_3896 = cute.get_iter(%view_3641) : !memref_rmem_bf16_19
        %ptr_3897 = cute.add_offset(%iter_3896, %idx_3895) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3898 = cute.make_view(%ptr_3897) : !memref_rmem_bf16_26
        %iter_3899 = cute.get_iter(%view_3898) : !memref_rmem_bf16_26
        %iter_3900 = cute.get_iter(%view_3898) : !memref_rmem_bf16_26
        %coord_3901 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3902 = cute.get_layout(%rmem_757) : !memref_rmem_bf16_2
        %idx_3903 = cute.crd2idx(%coord_3901, %lay_3902) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_3904 = cute.get_iter(%rmem_757) : !memref_rmem_bf16_2
        %ptr_3905 = cute.add_offset(%iter_3904, %idx_3903) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3906 = cute.make_view(%ptr_3905) : !memref_rmem_bf16_24
        %iter_3907 = cute.get_iter(%view_3906) : !memref_rmem_bf16_24
        %iter_3908 = cute.get_iter(%view_3906) : !memref_rmem_bf16_24
        %lay_3909 = cute.get_layout(%view_3898) : !memref_rmem_bf16_26
        %1779 = cute.get_shape(%lay_3909) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3910, %e1_3911, %e2_3912, %e3_3913 = cute.get_leaves(%1779) : !cute.shape<"(((2,2),2),1)">
        %lay_3914 = cute.get_layout(%view_3906) : !memref_rmem_bf16_24
        %1780 = cute.get_shape(%lay_3914) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3915, %e1_3916, %e2_3917, %e3_3918 = cute.get_leaves(%1780) : !cute.shape<"((2,2),(8,2))">
        %iter_3919 = cute.get_iter(%view_3898) : !memref_rmem_bf16_26
        %iter_3920 = cute.get_iter(%view_3906) : !memref_rmem_bf16_24
        %iter_3921 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %iter_3922 = cute.get_iter(%rmem_767) : !memref_rmem_f32_
        %lay_3923 = cute.get_layout(%view_3898) : !memref_rmem_bf16_26
        %lay_3924 = cute.get_layout(%view_3906) : !memref_rmem_bf16_24
        %lay_3925 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %lay_3926 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
        %1781 = cute.static : !cute.layout<"1:0">
        %append_3927 = cute.append_to_rank<3> (%lay_3923, %1781) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3928 = cute.append_to_rank<3> (%lay_3924, %1781) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3929 = cute.size(%append_3927) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3930 = cute.size(%append_3927) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3931 = cute.size(%append_3928) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1782 = cute.get_scalars(%sz_3929) : !cute.int_tuple<"1">
        %1783 = cute.get_scalars(%sz_3930) : !cute.int_tuple<"1">
        %1784 = cute.get_scalars(%sz_3931) : !cute.int_tuple<"16">
        %c0_i32_3932 = arith.constant 0 : i32
        %c1_i32_3933 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3932 to %1782 step %c1_i32_3933  : i32 {
          scf.for %arg9 = %c0_i32_3932 to %1783 step %c1_i32_3933  : i32 {
            scf.for %arg10 = %c0_i32_3932 to %1784 step %c1_i32_3933  : i32 {
              %coord_4014 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4015 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_4016 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1825:2 = cute.get_scalars(%coord_4014) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4017 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_4018 = cute.crd2idx(%coord_4014, %append_3927) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_4019 = cute.add_offset(%iter_3919, %idx_4018) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_4020 = cute.make_view(%ptr_4019, %lay_4017) : !memref_rmem_bf16_27
              %1826:2 = cute.get_scalars(%coord_4015) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4021 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4022 = cute.crd2idx(%coord_4015, %append_3928) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4023 = cute.add_offset(%iter_3920, %idx_4022) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_4024 = cute.make_view(%ptr_4023, %lay_4021) : !memref_rmem_bf16_18
              %1827:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4025 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4026 = cute.crd2idx(%coord_4016, %lay_3925) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4027 = cute.add_offset(%iter_3921, %idx_4026) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4028 = cute.make_view(%ptr_4027, %lay_4025) : !memref_rmem_f32_2
              %1828:2 = cute.get_scalars(%coord_4016) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_4029 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_4030 = cute.crd2idx(%coord_4016, %lay_3926) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_4031 = cute.add_offset(%iter_3922, %idx_4030) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_4032 = cute.make_view(%ptr_4031, %lay_4029) : !memref_rmem_f32_2
              %iter_4033 = cute.get_iter(%view_4020) : !memref_rmem_bf16_27
              %iter_4034 = cute.get_iter(%view_4024) : !memref_rmem_bf16_18
              %iter_4035 = cute.get_iter(%view_4028) : !memref_rmem_f32_2
              %iter_4036 = cute.get_iter(%view_4032) : !memref_rmem_f32_2
              %1829 = builtin.unrealized_conversion_cast %iter_4033 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = llvm.getelementptr %1829[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1834 = llvm.load %1833 : !llvm.ptr -> i32
              %1835 = llvm.getelementptr %1829[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1836 = llvm.load %1835 : !llvm.ptr -> i32
              %1837 = builtin.unrealized_conversion_cast %iter_4034 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1838 = llvm.load %1837 : !llvm.ptr -> i32
              %1839 = llvm.getelementptr %1837[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1840 = llvm.load %1839 : !llvm.ptr -> i32
              %1841 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1842 = llvm.load %1841 : !llvm.ptr -> f32
              %1843 = llvm.getelementptr %1841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1844 = llvm.load %1843 : !llvm.ptr -> f32
              %1845 = llvm.getelementptr %1841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1846 = llvm.load %1845 : !llvm.ptr -> f32
              %1847 = llvm.getelementptr %1841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1848 = llvm.load %1847 : !llvm.ptr -> f32
              %1849:4 = cute_nvgpu.arch.mma.SM80 A[%1830, %1832, %1834, %1836]  B[%1838, %1840]  C[%1842, %1844, %1846, %1848] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1850 = builtin.unrealized_conversion_cast %iter_4035 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1849#0, %1850 : f32, !llvm.ptr
              %1851 = llvm.getelementptr %1850[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#1, %1851 : f32, !llvm.ptr
              %1852 = llvm.getelementptr %1850[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#2, %1852 : f32, !llvm.ptr
              %1853 = llvm.getelementptr %1850[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1849#3, %1853 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %1785 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1786 = cute.get_shape(%1785) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_3934, %e1_3935, %e2_3936, %e3_3937 = cute.get_leaves(%1786) : !cute.shape<"(32,4,1,1)">
        %1787 = cute.get_stride(%1785) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_3938, %e1_3939, %e2_3940, %e3_3941 = cute.get_leaves(%1787) : !cute.stride<"(1,32,0,0)">
        %1788 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_3942, %e1_3943, %e2_3944 = cute.get_leaves(%1788) : !cute.tile<"[64:1;16:1;16:1]">
        %1789 = cute.get_shape(%e0_3942) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3945 = cute.get_leaves(%1789) : !cute.shape<"64">
        %1790 = cute.get_stride(%e0_3942) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3946 = cute.get_leaves(%1790) : !cute.stride<"1">
        %1791 = cute.get_shape(%e1_3943) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3947 = cute.get_leaves(%1791) : !cute.shape<"16">
        %1792 = cute.get_stride(%e1_3943) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3948 = cute.get_leaves(%1792) : !cute.stride<"1">
        %1793 = cute.get_shape(%e2_3944) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3949 = cute.get_leaves(%1793) : !cute.shape<"16">
        %1794 = cute.get_stride(%e2_3944) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3950 = cute.get_leaves(%1794) : !cute.stride<"1">
        %1795 = cute.static : !cute.layout<"32:1">
        %1796 = cute.get_shape(%1795) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3951 = cute.get_leaves(%1796) : !cute.shape<"32">
        %1797 = cute.get_stride(%1795) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3952 = cute.get_leaves(%1797) : !cute.stride<"1">
        %1798 = cute.static : !cute.shape<"(16,8,16)">
        %e0_3953, %e1_3954, %e2_3955 = cute.get_leaves(%1798) : !cute.shape<"(16,8,16)">
        %1799 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1800 = cute.get_shape(%1799) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_3956, %e1_3957, %e2_3958, %e3_3959, %e4_3960 = cute.get_leaves(%1800) : !cute.shape<"((4,8),(2,2,2))">
        %1801 = cute.get_stride(%1799) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_3961, %e1_3962, %e2_3963, %e3_3964, %e4_3965 = cute.get_leaves(%1801) : !cute.stride<"((32,1),(16,8,128))">
        %1802 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1803 = cute.get_shape(%1802) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3966, %e1_3967, %e2_3968, %e3_3969 = cute.get_leaves(%1803) : !cute.shape<"((4,8),(2,2))">
        %1804 = cute.get_stride(%1802) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_3970, %e1_3971, %e2_3972, %e3_3973 = cute.get_leaves(%1804) : !cute.stride<"((16,1),(8,64))">
        %1805 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1806 = cute.get_shape(%1805) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3974, %e1_3975, %e2_3976, %e3_3977 = cute.get_leaves(%1806) : !cute.shape<"((4,8),(2,2))">
        %1807 = cute.get_stride(%1805) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_3978, %e1_3979, %e2_3980, %e3_3981 = cute.get_leaves(%1807) : !cute.stride<"((32,1),(16,8))">
        %1808 = cute.static : !cute.tile<"[64:1;16:1]">
        %e0_3982, %e1_3983 = cute.get_leaves(%1808) : !cute.tile<"[64:1;16:1]">
        %1809 = cute.get_shape(%e0_3982) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3984 = cute.get_leaves(%1809) : !cute.shape<"64">
        %1810 = cute.get_stride(%e0_3982) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3985 = cute.get_leaves(%1810) : !cute.stride<"1">
        %1811 = cute.get_shape(%e1_3983) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3986 = cute.get_leaves(%1811) : !cute.shape<"16">
        %1812 = cute.get_stride(%e1_3983) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3987 = cute.get_leaves(%1812) : !cute.stride<"1">
        %1813 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
        %1814 = cute.get_shape(%1813) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %e0_3988, %e1_3989, %e2_3990, %e3_3991, %e4_3992, %e5_3993, %e6_3994 = cute.get_leaves(%1814) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %1815 = cute.get_stride(%1813) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %e0_3995, %e1_3996, %e2_3997, %e3_3998, %e4_3999, %e5_4000, %e6_4001 = cute.get_leaves(%1815) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %1816 = cute.static : !cute.layout<"32:1">
        %1817 = cute.get_shape(%1816) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_4002 = cute.get_leaves(%1817) : !cute.shape<"32">
        %1818 = cute.get_stride(%1816) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_4003 = cute.get_leaves(%1818) : !cute.stride<"1">
        %1819 = cute.static : !cute.layout<"(32,8):(8,1)">
        %1820 = cute.get_shape(%1819) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
        %e0_4004, %e1_4005 = cute.get_leaves(%1820) : !cute.shape<"(32,8)">
        %1821 = cute.get_stride(%1819) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
        %e0_4006, %e1_4007 = cute.get_leaves(%1821) : !cute.stride<"(8,1)">
        %1822 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
        %1823 = cute.get_shape(%1822) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
        %e0_4008, %e1_4009, %e2_4010 = cute.get_leaves(%1823) : !cute.shape<"(32,(2,4))">
        %1824 = cute.get_stride(%1822) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
        %e0_4011, %e1_4012, %e2_4013 = cute.get_leaves(%1824) : !cute.stride<"(2,(1,64))">
        scf.yield %1733#1, %arg7 : !mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3
      }
      %lay_2203 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
      %rmem_2204 = cute.memref.alloca(%lay_2203) : !memref_rmem_bf16_28
      %iter_2205 = cute.get_iter(%rmem_2204) : !memref_rmem_bf16_28
      %iter_2206 = cute.get_iter(%rmem_2204) : !memref_rmem_bf16_28
      %lay_2207 = cute.get_layout(%rmem_767) : !memref_rmem_f32_
      %1383 = cute.get_shape(%lay_2207) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_2208, %e1_2209, %e2_2210, %e3_2211 = cute.get_leaves(%1383) : !cute.shape<"((2,2),1,16)">
      %1384 = cute.memref.load_vec %rmem_767 : !memref_rmem_f32_
      %1385 = arith.truncf %1384 : vector<64xf32> to vector<64xbf16>
      %lay_2212 = cute.get_layout(%rmem_2204) : !memref_rmem_bf16_28
      %1386 = cute.get_shape(%lay_2212) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_2213, %e1_2214, %e2_2215, %e3_2216 = cute.get_leaves(%1386) : !cute.shape<"((2,2),1,16)">
      %int_tuple_2217 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_2218 = cute.size(%int_tuple_2217) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_2219 = cute.get_leaves(%sz_2218) : !cute.int_tuple<"64">
      %int_tuple_2220 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_2221 = cute.size(%int_tuple_2220) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_2222 = cute.get_leaves(%sz_2221) : !cute.int_tuple<"64">
      cute.memref.store_vec %1385, %rmem_2204 : !memref_rmem_bf16_28
      %1387 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %iter_2223 = cute.recast_iter(%iter_381) : !cute.ptr<bf16, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>, S<3,4,3>>
      %1388 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %view_2224 = cute.make_view(%iter_2223, %1388) : !memref_smem_bf16_23
      %iter_2225 = cute.get_iter(%view_2224) : !memref_smem_bf16_23
      %atom_2226 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %1389 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %1390 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_2227, %e1_2228, %e2_2229 = cute.get_leaves(%1390) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_2230 = cute.size(%e0_2227) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_2231 = cute.get_leaves(%sz_2230) : !cute.int_tuple<"64">
      %1391 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_2232, %e1_2233, %e2_2234 = cute.get_leaves(%1391) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_2235 = cute.size(%e1_2233) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_2236 = cute.get_leaves(%sz_2235) : !cute.int_tuple<"16">
      %tile_2237 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %1392 = cute.make_tiled_copy(%atom_2226) : !copy_simt1
      %iter_2238 = cute.get_iter(%rmem_2204) : !memref_rmem_bf16_28
      %view_2239 = cute.make_view(%iter_2238) : !memref_rmem_bf16_29
      %iter_2240 = cute.get_iter(%view_2239) : !memref_rmem_bf16_29
      %coord_2241 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2242 = cute.get_iter(%view_2224) : !memref_smem_bf16_23
      %1393 = cute.get_scalars(%coord_2241) <{only_dynamic}> : !cute.coord<"?">
      %c4_i32_2243 = arith.constant 4 : i32
      %1394 = arith.divsi %1393, %c4_i32_2243 : i32
      %c4_i32_2244 = arith.constant 4 : i32
      %1395 = arith.remsi %1393, %c4_i32_2244 : i32
      %c2_i32_2245 = arith.constant 2 : i32
      %1396 = arith.muli %1395, %c2_i32_2245 : i32
      %c8_i32_2246 = arith.constant 8 : i32
      %1397 = arith.divsi %1394, %c8_i32_2246 : i32
      %c8_i32_2247 = arith.constant 8 : i32
      %1398 = arith.remsi %1394, %c8_i32_2247 : i32
      %c64_i32_2248 = arith.constant 64 : i32
      %1399 = arith.muli %1398, %c64_i32_2248 : i32
      %1400 = arith.addi %1396, %1399 : i32
      %c1024_i32_2249 = arith.constant 1024 : i32
      %1401 = arith.muli %1397, %c1024_i32_2249 : i32
      %1402 = arith.addi %1400, %1401 : i32
      %iv_2250 = cute.assume(%1402) : (i32) -> !cute.i32<divby 2>
      %int_tuple_2251 = cute.make_int_tuple(%iv_2250) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_2252 = cute.add_offset(%iter_2242, %int_tuple_2251) : (!cute.ptr<bf16, smem, align<1024>, S<3,4,3>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
      %view_2253 = cute.make_view(%ptr_2252) : !memref_smem_bf16_24
      %iter_2254 = cute.get_iter(%view_2253) : !memref_smem_bf16_24
      %lay_2255 = cute.get_layout(%view_2239) : !memref_rmem_bf16_29
      %1403 = cute.get_shape(%lay_2255) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_2256, %e1_2257, %e2_2258, %e3_2259 = cute.get_leaves(%1403) : !cute.shape<"((1,8),1,8)">
      %lay_2260 = cute.get_layout(%view_2253) : !memref_smem_bf16_24
      %1404 = cute.get_shape(%lay_2260) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_2261, %e1_2262, %e2_2263, %e3_2264, %e4_2265, %e5_2266, %e6_2267 = cute.get_leaves(%1404) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %lay_2268 = cute.get_layout(%view_2239) : !memref_rmem_bf16_29
      %shape_2269 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2270 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_2268, %lay_2270) : !cute.layout<"((1,8),1,8):((0,1),0,8)">, !cute.layout<"1:0">
      %view_2271 = cute.make_view(%iter_2240, %append) : !memref_rmem_bf16_29
      %iter_2272 = cute.get_iter(%view_2271) : !memref_rmem_bf16_29
      %lay_2273 = cute.get_layout(%view_2271) : !memref_rmem_bf16_29
      %1405 = cute.get_shape(%lay_2273) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_2274, %e1_2275, %e2_2276, %e3_2277 = cute.get_leaves(%1405) : !cute.shape<"((1,8),1,8)">
      %iter_2278 = cute.get_iter(%view_2271) : !memref_rmem_bf16_29
      %view_2279 = cute.make_view(%iter_2278) : !memref_rmem_bf16_30
      %iter_2280 = cute.get_iter(%view_2279) : !memref_rmem_bf16_30
      %iter_2281 = cute.get_iter(%view_2279) : !memref_rmem_bf16_30
      %lay_2282 = cute.get_layout(%view_2253) : !memref_smem_bf16_24
      %shape_2283 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2284 = cute.make_layout() : !cute.layout<"1:0">
      %append_2285 = cute.append_to_rank<2> (%lay_2282, %lay_2284) : !cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">, !cute.layout<"1:0">
      %view_2286 = cute.make_view(%iter_2254, %append_2285) : !memref_smem_bf16_24
      %iter_2287 = cute.get_iter(%view_2286) : !memref_smem_bf16_24
      %lay_2288 = cute.get_layout(%view_2286) : !memref_smem_bf16_24
      %1406 = cute.get_shape(%lay_2288) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_2289, %e1_2290, %e2_2291, %e3_2292, %e4_2293, %e5_2294, %e6_2295 = cute.get_leaves(%1406) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %iter_2296 = cute.get_iter(%view_2286) : !memref_smem_bf16_24
      %view_2297 = cute.make_view(%iter_2296) : !memref_smem_bf16_25
      %iter_2298 = cute.get_iter(%view_2297) : !memref_smem_bf16_25
      %iter_2299 = cute.get_iter(%view_2297) : !memref_smem_bf16_25
      %lay_2300 = cute.get_layout(%view_2279) : !memref_rmem_bf16_30
      %1407 = cute.get_shape(%lay_2300) : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.shape<"((1,8),(1,8))">
      %e0_2301, %e1_2302, %e2_2303, %e3_2304 = cute.get_leaves(%1407) : !cute.shape<"((1,8),(1,8))">
      %lay_2305 = cute.get_layout(%view_2297) : !memref_smem_bf16_25
      %1408 = cute.get_shape(%lay_2305) : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %e0_2306, %e1_2307, %e2_2308, %e3_2309, %e4_2310, %e5_2311, %e6_2312 = cute.get_leaves(%1408) : !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %lay_2313 = cute.get_layout(%view_2279) : !memref_rmem_bf16_30
      %sz_2314 = cute.size(%lay_2313) <{mode = [1]}> : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.int_tuple<"8">
      %e0_2315 = cute.get_leaves(%sz_2314) : !cute.int_tuple<"8">
      %lay_2316 = cute.get_layout(%view_2297) : !memref_smem_bf16_25
      %sz_2317 = cute.size(%lay_2316) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.int_tuple<"8">
      %e0_2318 = cute.get_leaves(%sz_2317) : !cute.int_tuple<"8">
      %1409 = cute.static : !cute.layout<"1:0">
      %iter_2319 = cute.get_iter(%view_2279) : !memref_rmem_bf16_30
      %iter_2320 = cute.get_iter(%view_2297) : !memref_smem_bf16_25
      %lay_2321 = cute.get_layout(%view_2279) : !memref_rmem_bf16_30
      %lay_2322 = cute.get_layout(%view_2297) : !memref_smem_bf16_25
      %append_2323 = cute.append_to_rank<2> (%lay_2321, %1409) : !cute.layout<"((1,8),(1,8)):((0,1),(0,8))">, !cute.layout<"1:0">
      %append_2324 = cute.append_to_rank<2> (%lay_2322, %1409) : !cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">, !cute.layout<"1:0">
      %lay_2325 = cute.make_layout() : !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">
      %lay_2326 = cute.make_layout() : !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">
      %sz_2327 = cute.size(%lay_2325) <{mode = [1]}> : (!cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"8">
      %1410 = cute.get_scalars(%sz_2327) : !cute.int_tuple<"8">
      %c0_i32_2328 = arith.constant 0 : i32
      %c1_i32_2329 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2328 to %1410 step %c1_i32_2329  : i32 {
        %coord_2759 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %1603 = cute.get_scalars(%coord_2759) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2760 = cute.make_layout() : !cute.layout<"((1,8)):((0,1))">
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2325) : (!cute.coord<"(_,?)">, !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2762 = cute.add_offset(%iter_2319, %idx_2761) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2763 = cute.make_view(%ptr_2762, %lay_2760) : !memref_rmem_bf16_31
        %1604 = cute.get_scalars(%coord_2759) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2764 = cute.make_layout() : !cute.layout<"((1,(2,2,2))):((0,(1,512,8)))">
        %idx_2765 = cute.crd2idx(%coord_2759, %lay_2326) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_2766 = cute.add_offset(%iter_2320, %idx_2765) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %view_2767 = cute.make_view(%ptr_2766, %lay_2764) : !memref_smem_bf16_26
        %iter_2768 = cute.get_iter(%view_2763) : !memref_rmem_bf16_31
        %iter_2769 = cute.get_iter(%view_2767) : !memref_smem_bf16_26
        %swizzled = cute.apply_swizzle(%iter_2769) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1605 = builtin.unrealized_conversion_cast %iter_2768 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        %1606 = builtin.unrealized_conversion_cast %swizzled : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1607 = llvm.load %1605 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1607, %1606 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_2770 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_2771 = cute.add_offset(%iter_2768, %int_tuple_2770) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %int_tuple_2772 = cute.make_int_tuple() : () -> !cute.int_tuple<"512">
        %ptr_2773 = cute.add_offset(%iter_2769, %int_tuple_2772) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"512">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %swizzled_2774 = cute.apply_swizzle(%ptr_2773) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1608 = builtin.unrealized_conversion_cast %ptr_2771 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %1609 = builtin.unrealized_conversion_cast %swizzled_2774 : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1610 = llvm.load %1608 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1610, %1609 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_2775 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_2776 = cute.add_offset(%iter_2768, %int_tuple_2775) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %int_tuple_2777 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %ptr_2778 = cute.add_offset(%iter_2769, %int_tuple_2777) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %swizzled_2779 = cute.apply_swizzle(%ptr_2778) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1611 = builtin.unrealized_conversion_cast %ptr_2776 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        %1612 = builtin.unrealized_conversion_cast %swizzled_2779 : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1613 = llvm.load %1611 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1613, %1612 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_2780 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_2781 = cute.add_offset(%iter_2768, %int_tuple_2780) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %int_tuple_2782 = cute.make_int_tuple() : () -> !cute.int_tuple<"520">
        %ptr_2783 = cute.add_offset(%iter_2769, %int_tuple_2782) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"520">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %swizzled_2784 = cute.apply_swizzle(%ptr_2783) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1614 = builtin.unrealized_conversion_cast %ptr_2781 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %1615 = builtin.unrealized_conversion_cast %swizzled_2784 : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1616 = llvm.load %1614 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1616, %1615 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2330 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_2331 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1411:7 = cute.get_scalars(%lay_2331) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %1412:2 = cute.get_scalars(%coord_2330) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_2332 = cute.assume(%1411#3) : (i32) -> !cute.i32<divby 8>
      %shape_2333 = cute.make_shape(%1411#1, %iv_2332) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_2334 = cute.assume(%1411#5) : (i64) -> !cute.i64<divby 8>
      %stride_2335 = cute.make_stride(%iv_2334) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_2336 = cute.make_layout(%shape_2333, %stride_2335) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_2337 = cute.crd2idx(%coord_2330, %lay_2331) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_2338 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_2339 = cute.add_offset(%iter_2338, %idx_2337) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_2340 = cute.make_view(%ptr_2339, %lay_2336) : !memref_gmem_bf16_1
      %iter_2341 = cute.get_iter(%view_2340) : !memref_gmem_bf16_1
      %iter_2342 = cute.get_iter(%view_2340) : !memref_gmem_bf16_1
      %tile_2343 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_2344 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %1413 = cute.get_scalars(%coord_2344) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_2345 = cute.make_coord(%1413) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_2346 = cute.get_layout(%view_2340) : !memref_gmem_bf16_1
      %1414:3 = cute.get_scalars(%lay_2346) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_2347 = arith.constant 64 : i32
      %1415 = arith.ceildivsi %1414#0, %c64_i32_2347 : i32
      %c64_i64_2348 = arith.constant 64 : i64
      %1416 = arith.muli %1414#2, %c64_i64_2348 : i64
      %c128_i32_2349 = arith.constant 128 : i32
      %1417 = arith.ceildivsi %1414#1, %c128_i32_2349 : i32
      %shape_2350 = cute.make_shape(%1415, %1417) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_2351 = cute.assume(%1414#2) : (i64) -> !cute.i64<divby 8>
      %iv_2352 = cute.assume(%1416) : (i64) -> !cute.i64<divby 512>
      %stride_2353 = cute.make_stride(%iv_2351, %iv_2352) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_2354 = cute.make_layout(%shape_2350, %stride_2353) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %1418:4 = cute.get_scalars(%lay_2354) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %1419 = cute.get_scalars(%coord_2345) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_2355 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %iv_2356 = cute.assume(%1418#2) : (i64) -> !cute.i64<divby 8>
      %stride_2357 = cute.make_stride(%iv_2356) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_2358 = cute.make_layout(%shape_2355, %stride_2357) : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %idx_2359 = cute.crd2idx(%coord_2345, %lay_2354) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_2360 = cute.get_iter(%view_2340) : !memref_gmem_bf16_1
      %ptr_2361 = cute.add_offset(%iter_2360, %idx_2359) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_2362 = cute.make_view(%ptr_2361, %lay_2358) : !memref_gmem_bf16_2
      %iter_2363 = cute.get_iter(%view_2362) : !memref_gmem_bf16_2
      %coord_2364 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2365 = cute.get_iter(%view_2224) : !memref_smem_bf16_23
      %1420 = cute.get_scalars(%coord_2364) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_2366 = arith.constant 8 : i32
      %1421 = arith.divsi %1420, %c8_i32_2366 : i32
      %c8_i32_2367 = arith.constant 8 : i32
      %1422 = arith.remsi %1420, %c8_i32_2367 : i32
      %c8_i32_2368 = arith.constant 8 : i32
      %1423 = arith.muli %1422, %c8_i32_2368 : i32
      %c64_i32_2369 = arith.constant 64 : i32
      %1424 = arith.muli %1421, %c64_i32_2369 : i32
      %1425 = arith.addi %1423, %1424 : i32
      %iv_2370 = cute.assume(%1425) : (i32) -> !cute.i32<divby 8>
      %int_tuple_2371 = cute.make_int_tuple(%iv_2370) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_2372 = cute.add_offset(%iter_2365, %int_tuple_2371) : (!cute.ptr<bf16, smem, align<1024>, S<3,4,3>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
      %view_2373 = cute.make_view(%ptr_2372) : !memref_smem_bf16_27
      %iter_2374 = cute.get_iter(%view_2373) : !memref_smem_bf16_27
      %coord_2375 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2376 = cute.get_iter(%view_2362) : !memref_gmem_bf16_2
      %lay_2377 = cute.get_layout(%view_2362) : !memref_gmem_bf16_2
      %1426 = cute.get_scalars(%lay_2377) <{only_dynamic}> : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %1427 = cute.get_scalars(%coord_2375) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_2378 = arith.constant 16 : i64
      %1428 = arith.muli %1426, %c16_i64_2378 : i64
      %c128_i64_2379 = arith.constant 128 : i64
      %1429 = arith.muli %1426, %c128_i64_2379 : i64
      %c16_i64_2380 = arith.constant 16 : i64
      %1430 = arith.muli %1426, %c16_i64_2380 : i64
      %c8_i32_2381 = arith.constant 8 : i32
      %1431 = arith.divsi %1427, %c8_i32_2381 : i32
      %c8_i32_2382 = arith.constant 8 : i32
      %1432 = arith.remsi %1427, %c8_i32_2382 : i32
      %c8_i32_2383 = arith.constant 8 : i32
      %1433 = arith.muli %1432, %c8_i32_2383 : i32
      %1434 = arith.extsi %1431 : i32 to i64
      %1435 = arith.muli %1434, %1426 : i64
      %1436 = arith.extsi %1433 : i32 to i64
      %1437 = arith.addi %1436, %1435 : i64
      %iv_2384 = cute.assume(%1437) : (i64) -> !cute.i64<divby 8>
      %int_tuple_2385 = cute.make_int_tuple(%iv_2384) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_2386 = cute.add_offset(%iter_2376, %int_tuple_2385) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_2387 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
      %iv_2388 = cute.assume(%1428) : (i64) -> !cute.i64<divby 128>
      %stride_2389 = cute.make_stride(%iv_2388) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_2390 = cute.make_layout(%shape_2387, %stride_2389) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
      %view_2391 = cute.make_view(%ptr_2386, %lay_2390) : !memref_gmem_bf16_5
      %iter_2392 = cute.get_iter(%view_2391) : !memref_gmem_bf16_5
      %lay_2393 = cute.get_layout(%view_2391) : !memref_gmem_bf16_5
      %1438 = cute.get_scalars(%lay_2393) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
      %lay_2394 = cute.make_layout() : !cute.layout<"((8,1),4,2):((1,0),16,8)">
      %rmem_2395 = cute.memref.alloca(%lay_2394) : !memref_rmem_bf16_32
      %iter_2396 = cute.get_iter(%rmem_2395) : !memref_rmem_bf16_32
      %iter_2397 = cute.get_iter(%rmem_2395) : !memref_rmem_bf16_32
      %c1_i32_2398 = arith.constant 1 : i32
      %c128_i32_2399 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_2398 number_of_threads = %c128_i32_2399
      %lay_2400 = cute.get_layout(%view_2373) : !memref_smem_bf16_27
      %1439 = cute.get_shape(%lay_2400) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2401, %e1_2402, %e2_2403, %e3_2404 = cute.get_leaves(%1439) : !cute.shape<"((8,1),4,2)">
      %lay_2405 = cute.get_layout(%rmem_2395) : !memref_rmem_bf16_32
      %1440 = cute.get_shape(%lay_2405) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2406, %e1_2407, %e2_2408, %e3_2409 = cute.get_leaves(%1440) : !cute.shape<"((8,1),4,2)">
      %lay_2410 = cute.get_layout(%view_2373) : !memref_smem_bf16_27
      %shape_2411 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2412 = cute.make_layout() : !cute.layout<"1:0">
      %append_2413 = cute.append_to_rank<2> (%lay_2410, %lay_2412) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
      %view_2414 = cute.make_view(%iter_2374, %append_2413) : !memref_smem_bf16_27
      %iter_2415 = cute.get_iter(%view_2414) : !memref_smem_bf16_27
      %lay_2416 = cute.get_layout(%view_2414) : !memref_smem_bf16_27
      %1441 = cute.get_shape(%lay_2416) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2417, %e1_2418, %e2_2419, %e3_2420 = cute.get_leaves(%1441) : !cute.shape<"((8,1),4,2)">
      %iter_2421 = cute.get_iter(%view_2414) : !memref_smem_bf16_27
      %view_2422 = cute.make_view(%iter_2421) : !memref_smem_bf16_28
      %iter_2423 = cute.get_iter(%view_2422) : !memref_smem_bf16_28
      %iter_2424 = cute.get_iter(%view_2422) : !memref_smem_bf16_28
      %lay_2425 = cute.get_layout(%rmem_2395) : !memref_rmem_bf16_32
      %shape_2426 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2427 = cute.make_layout() : !cute.layout<"1:0">
      %append_2428 = cute.append_to_rank<2> (%lay_2425, %lay_2427) : !cute.layout<"((8,1),4,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_2429 = cute.make_view(%iter_2397, %append_2428) : !memref_rmem_bf16_32
      %iter_2430 = cute.get_iter(%view_2429) : !memref_rmem_bf16_32
      %lay_2431 = cute.get_layout(%view_2429) : !memref_rmem_bf16_32
      %1442 = cute.get_shape(%lay_2431) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2432, %e1_2433, %e2_2434, %e3_2435 = cute.get_leaves(%1442) : !cute.shape<"((8,1),4,2)">
      %iter_2436 = cute.get_iter(%view_2429) : !memref_rmem_bf16_32
      %view_2437 = cute.make_view(%iter_2436) : !memref_rmem_bf16_33
      %iter_2438 = cute.get_iter(%view_2437) : !memref_rmem_bf16_33
      %iter_2439 = cute.get_iter(%view_2437) : !memref_rmem_bf16_33
      %lay_2440 = cute.get_layout(%view_2422) : !memref_smem_bf16_28
      %1443 = cute.get_shape(%lay_2440) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_2441, %e1_2442, %e2_2443, %e3_2444 = cute.get_leaves(%1443) : !cute.shape<"((8,1),(4,2))">
      %lay_2445 = cute.get_layout(%view_2437) : !memref_rmem_bf16_33
      %1444 = cute.get_shape(%lay_2445) : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_2446, %e1_2447, %e2_2448, %e3_2449 = cute.get_leaves(%1444) : !cute.shape<"((8,1),(4,2))">
      %lay_2450 = cute.get_layout(%view_2422) : !memref_smem_bf16_28
      %sz_2451 = cute.size(%lay_2450) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
      %e0_2452 = cute.get_leaves(%sz_2451) : !cute.int_tuple<"8">
      %lay_2453 = cute.get_layout(%view_2437) : !memref_rmem_bf16_33
      %sz_2454 = cute.size(%lay_2453) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.int_tuple<"8">
      %e0_2455 = cute.get_leaves(%sz_2454) : !cute.int_tuple<"8">
      %1445 = cute.static : !cute.layout<"1:0">
      %iter_2456 = cute.get_iter(%view_2422) : !memref_smem_bf16_28
      %iter_2457 = cute.get_iter(%view_2437) : !memref_rmem_bf16_33
      %lay_2458 = cute.get_layout(%view_2422) : !memref_smem_bf16_28
      %lay_2459 = cute.get_layout(%view_2437) : !memref_rmem_bf16_33
      %append_2460 = cute.append_to_rank<2> (%lay_2458, %1445) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
      %append_2461 = cute.append_to_rank<2> (%lay_2459, %1445) : !cute.layout<"((8,1),(4,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_2462 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
      %lay_2463 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">
      %sz_2464 = cute.size(%lay_2462) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"8">
      %1446 = cute.get_scalars(%sz_2464) : !cute.int_tuple<"8">
      %c0_i32_2465 = arith.constant 0 : i32
      %c1_i32_2466 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2465 to %1446 step %c1_i32_2466  : i32 {
        %coord_2759 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %1603 = cute.get_scalars(%coord_2759) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2760 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2462) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_2762 = cute.add_offset(%iter_2456, %idx_2761) : (!cute.ptr<bf16, smem, align<16>, S<3,4,3>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
        %view_2763 = cute.make_view(%ptr_2762, %lay_2760) : !memref_smem_bf16_29
        %1604 = cute.get_scalars(%coord_2759) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2764 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_2765 = cute.crd2idx(%coord_2759, %lay_2463) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2766 = cute.add_offset(%iter_2457, %idx_2765) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2767 = cute.make_view(%ptr_2766, %lay_2764) : !memref_rmem_bf16_9
        %iter_2768 = cute.get_iter(%view_2763) : !memref_smem_bf16_29
        %iter_2769 = cute.get_iter(%view_2767) : !memref_rmem_bf16_9
        %swizzled = cute.apply_swizzle(%iter_2768) : !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
        %1605 = builtin.unrealized_conversion_cast %swizzled : !cute.ptr<bf16, smem, align<16>, S<3,4,3>> to !llvm.ptr<3>
        %1606 = builtin.unrealized_conversion_cast %iter_2769 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        %1607 = llvm.load %1605 {alignment = 16 : i64} : !llvm.ptr<3> -> vector<8xbf16>
        llvm.store %1607, %1606 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_2467 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1447 = cute.get_shape(%lay_2467) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2468, %e1_2469, %e2_2470, %e3_2471 = cute.get_leaves(%1447) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2472 = cute.to_int_tuple(%e0_2468) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1448 = cute.get_scalars(%itup_2472) : !cute.int_tuple<"?">
      %itup_2473 = cute.to_int_tuple(%e1_2469) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1449 = cute.get_scalars(%itup_2473) : !cute.int_tuple<"?">
      %itup_2474 = cute.to_int_tuple(%e2_2470) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1450 = cute.get_scalars(%itup_2474) : !cute.int_tuple<"?">
      %itup_2475 = cute.to_int_tuple(%e3_2471) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1451 = cute.get_scalars(%itup_2475) : !cute.int_tuple<"?{div=8}">
      %shape_2476 = cute.make_shape(%itup_2472, %itup_2473, %itup_2474, %itup_2475) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_2477 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_2478 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_2479 = cute.make_layout(%shape_2476, %stride_2478) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_2480 = cute.make_view(%int_tuple_2477, %lay_2479) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_2481 = cute.get_iter(%view_2480) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_2482, %e1_2483, %e2_2484, %e3_2485 = cute.get_leaves(%iter_2481) : !cute.int_tuple<"(0,0,0,0)">
      %coord_2486 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_2487 = cute.get_layout(%view_2480) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %1452:4 = cute.get_scalars(%lay_2487) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %1453:2 = cute.get_scalars(%coord_2486) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_2488 = cute.assume(%1452#3) : (i32) -> !cute.i32<divby 8>
      %shape_2489 = cute.make_shape(%1452#1, %iv_2488) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_2490 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_2491 = cute.make_layout(%shape_2489, %stride_2490) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_2492 = cute.crd2idx(%coord_2486, %lay_2487) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_2493 = cute.get_iter(%view_2480) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_2494 = cute.add_offset(%iter_2493, %idx_2492) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_2495 = cute.make_view(%tup_2494, %lay_2491) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_2496 = cute.get_iter(%view_2495) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_2497, %e1_2498, %e2_2499, %e3_2500 = cute.get_leaves(%iter_2496) : !cute.int_tuple<"(?,0,?,0)">
      %1454 = cute.get_scalars(%e0_2497) : !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%e2_2499) : !cute.int_tuple<"?">
      %iter_2501 = cute.get_iter(%view_2495) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_2502, %e1_2503, %e2_2504, %e3_2505 = cute.get_leaves(%iter_2501) : !cute.int_tuple<"(?,0,?,0)">
      %1456 = cute.get_scalars(%e0_2502) : !cute.int_tuple<"?">
      %1457 = cute.get_scalars(%e2_2504) : !cute.int_tuple<"?">
      %tile_2506 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_2507 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %1458 = cute.get_scalars(%coord_2507) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_2508 = cute.make_coord(%1458) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_2509 = cute.get_layout(%view_2495) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %1459:2 = cute.get_scalars(%lay_2509) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_2510 = arith.constant 64 : i32
      %1460 = arith.ceildivsi %1459#0, %c64_i32_2510 : i32
      %c128_i32_2511 = arith.constant 128 : i32
      %1461 = arith.ceildivsi %1459#1, %c128_i32_2511 : i32
      %shape_2512 = cute.make_shape(%1460, %1461) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_2513 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_2514 = cute.make_layout(%shape_2512, %stride_2513) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_2515 = cute.crd2idx(%coord_2508, %lay_2514) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_2516 = cute.get_iter(%view_2495) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_2517 = cute.add_offset(%iter_2516, %idx_2515) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_2518 = cute.make_view(%tup_2517) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_2519 = cute.get_iter(%view_2518) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_2520, %e1_2521, %e2_2522, %e3_2523 = cute.get_leaves(%iter_2519) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %1462 = cute.get_scalars(%e0_2520) : !cute.int_tuple<"?">
      %1463 = cute.get_scalars(%e1_2521) : !cute.int_tuple<"?{div=64}">
      %1464 = cute.get_scalars(%e2_2522) : !cute.int_tuple<"?">
      %coord_2524 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2525 = cute.get_iter(%view_2518) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %1465 = cute.get_scalars(%coord_2524) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_2526 = arith.constant 8 : i32
      %1466 = arith.divsi %1465, %c8_i32_2526 : i32
      %c8_i32_2527 = arith.constant 8 : i32
      %1467 = arith.remsi %1465, %c8_i32_2527 : i32
      %c8_i32_2528 = arith.constant 8 : i32
      %1468 = arith.muli %1467, %c8_i32_2528 : i32
      %iv_2529 = cute.assume(%1468) : (i32) -> !cute.i32<divby 8>
      %int_tuple_2530 = cute.make_int_tuple(%1466, %iv_2529) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_2531 = cute.add_offset(%iter_2525, %int_tuple_2530) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2532 = cute.make_view(%tup_2531) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_2533 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_2534, %e1_2535, %e2_2536, %e3_2537 = cute.get_leaves(%iter_2533) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1469 = cute.get_scalars(%e0_2534) : !cute.int_tuple<"?">
      %1470 = cute.get_scalars(%e1_2535) : !cute.int_tuple<"?">
      %1471 = cute.get_scalars(%e2_2536) : !cute.int_tuple<"?">
      %1472 = cute.get_scalars(%e3_2537) : !cute.int_tuple<"?{div=8}">
      %lay_2538 = cute.get_layout(%view_2391) : !memref_gmem_bf16_5
      %1473 = cute.get_shape(%lay_2538) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2539, %e1_2540, %e2_2541, %e3_2542 = cute.get_leaves(%1473) : !cute.shape<"((8,1),4,2)">
      %shape_2543 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_2544 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_2545 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_2546 = cute.memref.alloca(%lay_2545) : !memref_rmem_i8_
      %iter_2547 = cute.get_iter(%rmem_2546) : !memref_rmem_i8_
      %iter_2548 = cute.get_iter(%rmem_2546) : !memref_rmem_i8_
      %lay_2549 = cute.get_layout(%rmem_2546) : !memref_rmem_i8_
      %1474 = cute.get_shape(%lay_2549) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_2550, %e1_2551, %e2_2552 = cute.get_leaves(%1474) : !cute.shape<"(1,4,2)">
      %int_tuple_2553 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_2554 = cute.size(%int_tuple_2553) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_2555 = cute.get_leaves(%sz_2554) : !cute.int_tuple<"2">
      %coord_2556 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_2557 = cute.get_layout(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2558 = cute.crd2idx(%coord_2556, %lay_2557) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_2559 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2560 = cute.add_offset(%iter_2559, %idx_2558) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2561 = cute.make_view(%tup_2560) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2562 = cute.get_iter(%view_2561) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2563, %e1_2564, %e2_2565, %e3_2566 = cute.get_leaves(%iter_2562) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1475 = cute.get_scalars(%e0_2563) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e1_2564) : !cute.int_tuple<"?">
      %1477 = cute.get_scalars(%e2_2565) : !cute.int_tuple<"?">
      %1478 = cute.get_scalars(%e3_2566) : !cute.int_tuple<"?{div=8}">
      %iter_2567 = cute.get_iter(%view_2561) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2568, %e1_2569, %e2_2570, %e3_2571 = cute.get_leaves(%iter_2567) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1479 = cute.get_scalars(%e0_2568) : !cute.int_tuple<"?">
      %1480 = cute.get_scalars(%e1_2569) : !cute.int_tuple<"?">
      %1481 = cute.get_scalars(%e2_2570) : !cute.int_tuple<"?">
      %1482 = cute.get_scalars(%e3_2571) : !cute.int_tuple<"?{div=8}">
      %iter_2572 = cute.get_iter(%view_2561) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2573, %e1_2574, %e2_2575, %e3_2576 = cute.get_leaves(%iter_2572) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1483 = cute.get_scalars(%e0_2573) : !cute.int_tuple<"?">
      %1484 = cute.get_scalars(%e1_2574) : !cute.int_tuple<"?">
      %1485 = cute.get_scalars(%e2_2575) : !cute.int_tuple<"?">
      %1486 = cute.get_scalars(%e3_2576) : !cute.int_tuple<"?{div=8}">
      %lay_2577 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1487 = cute.get_shape(%lay_2577) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2578, %e1_2579, %e2_2580, %e3_2581 = cute.get_leaves(%1487) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2582 = cute.to_int_tuple(%e0_2578) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1488 = cute.get_scalars(%itup_2582) : !cute.int_tuple<"?">
      %itup_2583 = cute.to_int_tuple(%e1_2579) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1489 = cute.get_scalars(%itup_2583) : !cute.int_tuple<"?">
      %itup_2584 = cute.to_int_tuple(%e2_2580) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1490 = cute.get_scalars(%itup_2584) : !cute.int_tuple<"?">
      %itup_2585 = cute.to_int_tuple(%e3_2581) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1491 = cute.get_scalars(%itup_2585) : !cute.int_tuple<"?{div=8}">
      %coord_2586 = cute.make_coord(%e3_2576) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_2587 = cute.make_coord(%itup_2585) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1492 = cute.get_scalars(%coord_2586) : !cute.coord<"?{div=8}">
      %1493 = cute.get_scalars(%coord_2587) : !cute.coord<"?{div=8}">
      %true_2588 = arith.constant true
      %1494 = arith.cmpi slt, %1492, %1493 : i32
      %1495 = arith.andi %true_2588, %1494 : i1
      %1496 = arith.extui %1495 : i1 to i8
      %coord_2589 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_2546, %coord_2589, %1496) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_2590 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_2591 = cute.get_layout(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2592 = cute.crd2idx(%coord_2590, %lay_2591) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_2593 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2594 = cute.add_offset(%iter_2593, %idx_2592) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2595 = cute.make_view(%tup_2594) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2596 = cute.get_iter(%view_2595) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2597, %e1_2598, %e2_2599, %e3_2600 = cute.get_leaves(%iter_2596) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1497 = cute.get_scalars(%e0_2597) : !cute.int_tuple<"?">
      %1498 = cute.get_scalars(%e1_2598) : !cute.int_tuple<"?">
      %1499 = cute.get_scalars(%e2_2599) : !cute.int_tuple<"?">
      %1500 = cute.get_scalars(%e3_2600) : !cute.int_tuple<"?{div=8}">
      %iter_2601 = cute.get_iter(%view_2595) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2602, %e1_2603, %e2_2604, %e3_2605 = cute.get_leaves(%iter_2601) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1501 = cute.get_scalars(%e0_2602) : !cute.int_tuple<"?">
      %1502 = cute.get_scalars(%e1_2603) : !cute.int_tuple<"?">
      %1503 = cute.get_scalars(%e2_2604) : !cute.int_tuple<"?">
      %1504 = cute.get_scalars(%e3_2605) : !cute.int_tuple<"?{div=8}">
      %iter_2606 = cute.get_iter(%view_2595) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2607, %e1_2608, %e2_2609, %e3_2610 = cute.get_leaves(%iter_2606) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1505 = cute.get_scalars(%e0_2607) : !cute.int_tuple<"?">
      %1506 = cute.get_scalars(%e1_2608) : !cute.int_tuple<"?">
      %1507 = cute.get_scalars(%e2_2609) : !cute.int_tuple<"?">
      %1508 = cute.get_scalars(%e3_2610) : !cute.int_tuple<"?{div=8}">
      %lay_2611 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1509 = cute.get_shape(%lay_2611) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2612, %e1_2613, %e2_2614, %e3_2615 = cute.get_leaves(%1509) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2616 = cute.to_int_tuple(%e0_2612) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1510 = cute.get_scalars(%itup_2616) : !cute.int_tuple<"?">
      %itup_2617 = cute.to_int_tuple(%e1_2613) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1511 = cute.get_scalars(%itup_2617) : !cute.int_tuple<"?">
      %itup_2618 = cute.to_int_tuple(%e2_2614) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1512 = cute.get_scalars(%itup_2618) : !cute.int_tuple<"?">
      %itup_2619 = cute.to_int_tuple(%e3_2615) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1513 = cute.get_scalars(%itup_2619) : !cute.int_tuple<"?{div=8}">
      %coord_2620 = cute.make_coord(%e3_2610) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_2621 = cute.make_coord(%itup_2619) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1514 = cute.get_scalars(%coord_2620) : !cute.coord<"?{div=8}">
      %1515 = cute.get_scalars(%coord_2621) : !cute.coord<"?{div=8}">
      %true_2622 = arith.constant true
      %1516 = arith.cmpi slt, %1514, %1515 : i32
      %1517 = arith.andi %true_2622, %1516 : i1
      %1518 = arith.extui %1517 : i1 to i8
      %coord_2623 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_2546, %coord_2623, %1518) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_2624 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_2625 = cute.size(%int_tuple_2624) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_2626 = cute.get_leaves(%sz_2625) : !cute.int_tuple<"4">
      %coord_2627 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_2628 = cute.get_layout(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2629 = cute.crd2idx(%coord_2627, %lay_2628) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_2630 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2631 = cute.add_offset(%iter_2630, %idx_2629) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2632 = cute.make_view(%tup_2631) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2633 = cute.get_iter(%view_2632) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2634, %e1_2635, %e2_2636, %e3_2637 = cute.get_leaves(%iter_2633) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1519 = cute.get_scalars(%e0_2634) : !cute.int_tuple<"?">
      %1520 = cute.get_scalars(%e1_2635) : !cute.int_tuple<"?">
      %1521 = cute.get_scalars(%e2_2636) : !cute.int_tuple<"?">
      %1522 = cute.get_scalars(%e3_2637) : !cute.int_tuple<"?{div=8}">
      %iter_2638 = cute.get_iter(%view_2632) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2639, %e1_2640, %e2_2641, %e3_2642 = cute.get_leaves(%iter_2638) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1523 = cute.get_scalars(%e0_2639) : !cute.int_tuple<"?">
      %1524 = cute.get_scalars(%e1_2640) : !cute.int_tuple<"?">
      %1525 = cute.get_scalars(%e2_2641) : !cute.int_tuple<"?">
      %1526 = cute.get_scalars(%e3_2642) : !cute.int_tuple<"?{div=8}">
      %iter_2643 = cute.get_iter(%view_2632) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2644, %e1_2645, %e2_2646, %e3_2647 = cute.get_leaves(%iter_2643) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1527 = cute.get_scalars(%e0_2644) : !cute.int_tuple<"?">
      %1528 = cute.get_scalars(%e1_2645) : !cute.int_tuple<"?">
      %1529 = cute.get_scalars(%e2_2646) : !cute.int_tuple<"?">
      %1530 = cute.get_scalars(%e3_2647) : !cute.int_tuple<"?{div=8}">
      %lay_2648 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1531 = cute.get_shape(%lay_2648) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2649, %e1_2650, %e2_2651, %e3_2652 = cute.get_leaves(%1531) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2653 = cute.to_int_tuple(%e0_2649) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1532 = cute.get_scalars(%itup_2653) : !cute.int_tuple<"?">
      %itup_2654 = cute.to_int_tuple(%e1_2650) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1533 = cute.get_scalars(%itup_2654) : !cute.int_tuple<"?">
      %itup_2655 = cute.to_int_tuple(%e2_2651) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1534 = cute.get_scalars(%itup_2655) : !cute.int_tuple<"?">
      %itup_2656 = cute.to_int_tuple(%e3_2652) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1535 = cute.get_scalars(%itup_2656) : !cute.int_tuple<"?{div=8}">
      %coord_2657 = cute.make_coord(%e1_2645) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2658 = cute.make_coord(%itup_2654) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1536 = cute.get_scalars(%coord_2657) : !cute.coord<"?">
      %1537 = cute.get_scalars(%coord_2658) : !cute.coord<"?">
      %true_2659 = arith.constant true
      %1538 = arith.cmpi slt, %1536, %1537 : i32
      %1539 = arith.andi %true_2659, %1538 : i1
      scf.if %1539 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2760 = cute.get_layout(%rmem_2395) : !memref_rmem_bf16_32
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_2762 = cute.get_iter(%rmem_2395) : !memref_rmem_bf16_32
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_rmem_bf16_34
        %iter_2765 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %iter_2766 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2768 = cute.get_layout(%view_2391) : !memref_gmem_bf16_5
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2770 = cute.get_iter(%view_2391) : !memref_gmem_bf16_5
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_gmem_bf16_8
        %iter_2773 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %iter_2774 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2776 = cute.get_layout(%rmem_2546) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_2546) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_rmem_bf16_34
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_bf16_34
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %view_2802 = cute.make_view(%iter_2801) : !memref_rmem_bf16_35
        %iter_2803 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2804 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %lay_2805 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_gmem_bf16_8
        %iter_2810 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %lay_2811 = cute.get_layout(%view_2809) : !memref_gmem_bf16_8
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %view_2816 = cute.make_view(%iter_2815) : !memref_gmem_bf16_9
        %iter_2817 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %iter_2818 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2847 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2848 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %lay_2849 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_rmem_bf16_9
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_gmem_bf16_10
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_rmem_bf16_9
          %iter_2875 = cute.get_iter(%view_2869) : !memref_gmem_bf16_10
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.mlir.constant(0 : i8) : i8
          %1618 = llvm.icmp "ne" %1616, %1617 : i8
          scf.if %1618 {
            %1619 = builtin.unrealized_conversion_cast %iter_2874 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1620 = builtin.unrealized_conversion_cast %iter_2875 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1621 = llvm.load %1619 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1621, %1620 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2660 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_2661 = cute.get_layout(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2662 = cute.crd2idx(%coord_2660, %lay_2661) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_2663 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2664 = cute.add_offset(%iter_2663, %idx_2662) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2665 = cute.make_view(%tup_2664) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2666 = cute.get_iter(%view_2665) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2667, %e1_2668, %e2_2669, %e3_2670 = cute.get_leaves(%iter_2666) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1540 = cute.get_scalars(%e0_2667) : !cute.int_tuple<"?">
      %1541 = cute.get_scalars(%e1_2668) : !cute.int_tuple<"?">
      %1542 = cute.get_scalars(%e2_2669) : !cute.int_tuple<"?">
      %1543 = cute.get_scalars(%e3_2670) : !cute.int_tuple<"?{div=8}">
      %iter_2671 = cute.get_iter(%view_2665) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2672, %e1_2673, %e2_2674, %e3_2675 = cute.get_leaves(%iter_2671) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1544 = cute.get_scalars(%e0_2672) : !cute.int_tuple<"?">
      %1545 = cute.get_scalars(%e1_2673) : !cute.int_tuple<"?">
      %1546 = cute.get_scalars(%e2_2674) : !cute.int_tuple<"?">
      %1547 = cute.get_scalars(%e3_2675) : !cute.int_tuple<"?{div=8}">
      %iter_2676 = cute.get_iter(%view_2665) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2677, %e1_2678, %e2_2679, %e3_2680 = cute.get_leaves(%iter_2676) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1548 = cute.get_scalars(%e0_2677) : !cute.int_tuple<"?">
      %1549 = cute.get_scalars(%e1_2678) : !cute.int_tuple<"?">
      %1550 = cute.get_scalars(%e2_2679) : !cute.int_tuple<"?">
      %1551 = cute.get_scalars(%e3_2680) : !cute.int_tuple<"?{div=8}">
      %lay_2681 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1552 = cute.get_shape(%lay_2681) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2682, %e1_2683, %e2_2684, %e3_2685 = cute.get_leaves(%1552) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2686 = cute.to_int_tuple(%e0_2682) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1553 = cute.get_scalars(%itup_2686) : !cute.int_tuple<"?">
      %itup_2687 = cute.to_int_tuple(%e1_2683) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1554 = cute.get_scalars(%itup_2687) : !cute.int_tuple<"?">
      %itup_2688 = cute.to_int_tuple(%e2_2684) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1555 = cute.get_scalars(%itup_2688) : !cute.int_tuple<"?">
      %itup_2689 = cute.to_int_tuple(%e3_2685) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1556 = cute.get_scalars(%itup_2689) : !cute.int_tuple<"?{div=8}">
      %coord_2690 = cute.make_coord(%e1_2678) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2691 = cute.make_coord(%itup_2687) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1557 = cute.get_scalars(%coord_2690) : !cute.coord<"?">
      %1558 = cute.get_scalars(%coord_2691) : !cute.coord<"?">
      %true_2692 = arith.constant true
      %1559 = arith.cmpi slt, %1557, %1558 : i32
      %1560 = arith.andi %true_2692, %1559 : i1
      scf.if %1560 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2760 = cute.get_layout(%rmem_2395) : !memref_rmem_bf16_32
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_2762 = cute.get_iter(%rmem_2395) : !memref_rmem_bf16_32
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_rmem_bf16_34
        %iter_2765 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %iter_2766 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2768 = cute.get_layout(%view_2391) : !memref_gmem_bf16_5
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2770 = cute.get_iter(%view_2391) : !memref_gmem_bf16_5
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_gmem_bf16_8
        %iter_2773 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %iter_2774 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2776 = cute.get_layout(%rmem_2546) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_2546) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_rmem_bf16_34
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_bf16_34
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %view_2802 = cute.make_view(%iter_2801) : !memref_rmem_bf16_35
        %iter_2803 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2804 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %lay_2805 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_gmem_bf16_8
        %iter_2810 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %lay_2811 = cute.get_layout(%view_2809) : !memref_gmem_bf16_8
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %view_2816 = cute.make_view(%iter_2815) : !memref_gmem_bf16_9
        %iter_2817 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %iter_2818 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2847 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2848 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %lay_2849 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_rmem_bf16_9
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_gmem_bf16_10
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_rmem_bf16_9
          %iter_2875 = cute.get_iter(%view_2869) : !memref_gmem_bf16_10
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.mlir.constant(0 : i8) : i8
          %1618 = llvm.icmp "ne" %1616, %1617 : i8
          scf.if %1618 {
            %1619 = builtin.unrealized_conversion_cast %iter_2874 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1620 = builtin.unrealized_conversion_cast %iter_2875 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1621 = llvm.load %1619 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1621, %1620 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2693 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_2694 = cute.get_layout(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2695 = cute.crd2idx(%coord_2693, %lay_2694) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_2696 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2697 = cute.add_offset(%iter_2696, %idx_2695) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2698 = cute.make_view(%tup_2697) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2699 = cute.get_iter(%view_2698) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2700, %e1_2701, %e2_2702, %e3_2703 = cute.get_leaves(%iter_2699) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1561 = cute.get_scalars(%e0_2700) : !cute.int_tuple<"?">
      %1562 = cute.get_scalars(%e1_2701) : !cute.int_tuple<"?">
      %1563 = cute.get_scalars(%e2_2702) : !cute.int_tuple<"?">
      %1564 = cute.get_scalars(%e3_2703) : !cute.int_tuple<"?{div=8}">
      %iter_2704 = cute.get_iter(%view_2698) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2705, %e1_2706, %e2_2707, %e3_2708 = cute.get_leaves(%iter_2704) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1565 = cute.get_scalars(%e0_2705) : !cute.int_tuple<"?">
      %1566 = cute.get_scalars(%e1_2706) : !cute.int_tuple<"?">
      %1567 = cute.get_scalars(%e2_2707) : !cute.int_tuple<"?">
      %1568 = cute.get_scalars(%e3_2708) : !cute.int_tuple<"?{div=8}">
      %iter_2709 = cute.get_iter(%view_2698) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2710, %e1_2711, %e2_2712, %e3_2713 = cute.get_leaves(%iter_2709) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1569 = cute.get_scalars(%e0_2710) : !cute.int_tuple<"?">
      %1570 = cute.get_scalars(%e1_2711) : !cute.int_tuple<"?">
      %1571 = cute.get_scalars(%e2_2712) : !cute.int_tuple<"?">
      %1572 = cute.get_scalars(%e3_2713) : !cute.int_tuple<"?{div=8}">
      %lay_2714 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1573 = cute.get_shape(%lay_2714) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2715, %e1_2716, %e2_2717, %e3_2718 = cute.get_leaves(%1573) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2719 = cute.to_int_tuple(%e0_2715) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1574 = cute.get_scalars(%itup_2719) : !cute.int_tuple<"?">
      %itup_2720 = cute.to_int_tuple(%e1_2716) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1575 = cute.get_scalars(%itup_2720) : !cute.int_tuple<"?">
      %itup_2721 = cute.to_int_tuple(%e2_2717) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1576 = cute.get_scalars(%itup_2721) : !cute.int_tuple<"?">
      %itup_2722 = cute.to_int_tuple(%e3_2718) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1577 = cute.get_scalars(%itup_2722) : !cute.int_tuple<"?{div=8}">
      %coord_2723 = cute.make_coord(%e1_2711) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2724 = cute.make_coord(%itup_2720) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1578 = cute.get_scalars(%coord_2723) : !cute.coord<"?">
      %1579 = cute.get_scalars(%coord_2724) : !cute.coord<"?">
      %true_2725 = arith.constant true
      %1580 = arith.cmpi slt, %1578, %1579 : i32
      %1581 = arith.andi %true_2725, %1580 : i1
      scf.if %1581 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2760 = cute.get_layout(%rmem_2395) : !memref_rmem_bf16_32
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_2762 = cute.get_iter(%rmem_2395) : !memref_rmem_bf16_32
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_rmem_bf16_34
        %iter_2765 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %iter_2766 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2768 = cute.get_layout(%view_2391) : !memref_gmem_bf16_5
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2770 = cute.get_iter(%view_2391) : !memref_gmem_bf16_5
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_gmem_bf16_8
        %iter_2773 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %iter_2774 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2776 = cute.get_layout(%rmem_2546) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_2546) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_rmem_bf16_34
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_bf16_34
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %view_2802 = cute.make_view(%iter_2801) : !memref_rmem_bf16_35
        %iter_2803 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2804 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %lay_2805 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_gmem_bf16_8
        %iter_2810 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %lay_2811 = cute.get_layout(%view_2809) : !memref_gmem_bf16_8
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %view_2816 = cute.make_view(%iter_2815) : !memref_gmem_bf16_9
        %iter_2817 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %iter_2818 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2847 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2848 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %lay_2849 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_rmem_bf16_9
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_gmem_bf16_10
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_rmem_bf16_9
          %iter_2875 = cute.get_iter(%view_2869) : !memref_gmem_bf16_10
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.mlir.constant(0 : i8) : i8
          %1618 = llvm.icmp "ne" %1616, %1617 : i8
          scf.if %1618 {
            %1619 = builtin.unrealized_conversion_cast %iter_2874 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1620 = builtin.unrealized_conversion_cast %iter_2875 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1621 = llvm.load %1619 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1621, %1620 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2726 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_2727 = cute.get_layout(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2728 = cute.crd2idx(%coord_2726, %lay_2727) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_2729 = cute.get_iter(%view_2532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2730 = cute.add_offset(%iter_2729, %idx_2728) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2731 = cute.make_view(%tup_2730) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2732 = cute.get_iter(%view_2731) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2733, %e1_2734, %e2_2735, %e3_2736 = cute.get_leaves(%iter_2732) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1582 = cute.get_scalars(%e0_2733) : !cute.int_tuple<"?">
      %1583 = cute.get_scalars(%e1_2734) : !cute.int_tuple<"?">
      %1584 = cute.get_scalars(%e2_2735) : !cute.int_tuple<"?">
      %1585 = cute.get_scalars(%e3_2736) : !cute.int_tuple<"?{div=8}">
      %iter_2737 = cute.get_iter(%view_2731) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2738, %e1_2739, %e2_2740, %e3_2741 = cute.get_leaves(%iter_2737) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1586 = cute.get_scalars(%e0_2738) : !cute.int_tuple<"?">
      %1587 = cute.get_scalars(%e1_2739) : !cute.int_tuple<"?">
      %1588 = cute.get_scalars(%e2_2740) : !cute.int_tuple<"?">
      %1589 = cute.get_scalars(%e3_2741) : !cute.int_tuple<"?{div=8}">
      %iter_2742 = cute.get_iter(%view_2731) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2743, %e1_2744, %e2_2745, %e3_2746 = cute.get_leaves(%iter_2742) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1590 = cute.get_scalars(%e0_2743) : !cute.int_tuple<"?">
      %1591 = cute.get_scalars(%e1_2744) : !cute.int_tuple<"?">
      %1592 = cute.get_scalars(%e2_2745) : !cute.int_tuple<"?">
      %1593 = cute.get_scalars(%e3_2746) : !cute.int_tuple<"?{div=8}">
      %lay_2747 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1594 = cute.get_shape(%lay_2747) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2748, %e1_2749, %e2_2750, %e3_2751 = cute.get_leaves(%1594) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2752 = cute.to_int_tuple(%e0_2748) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1595 = cute.get_scalars(%itup_2752) : !cute.int_tuple<"?">
      %itup_2753 = cute.to_int_tuple(%e1_2749) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1596 = cute.get_scalars(%itup_2753) : !cute.int_tuple<"?">
      %itup_2754 = cute.to_int_tuple(%e2_2750) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1597 = cute.get_scalars(%itup_2754) : !cute.int_tuple<"?">
      %itup_2755 = cute.to_int_tuple(%e3_2751) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1598 = cute.get_scalars(%itup_2755) : !cute.int_tuple<"?{div=8}">
      %coord_2756 = cute.make_coord(%e1_2744) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2757 = cute.make_coord(%itup_2753) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1599 = cute.get_scalars(%coord_2756) : !cute.coord<"?">
      %1600 = cute.get_scalars(%coord_2757) : !cute.coord<"?">
      %true_2758 = arith.constant true
      %1601 = arith.cmpi slt, %1599, %1600 : i32
      %1602 = arith.andi %true_2758, %1601 : i1
      scf.if %1602 {
        %coord_2759 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2760 = cute.get_layout(%rmem_2395) : !memref_rmem_bf16_32
        %idx_2761 = cute.crd2idx(%coord_2759, %lay_2760) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_2762 = cute.get_iter(%rmem_2395) : !memref_rmem_bf16_32
        %ptr_2763 = cute.add_offset(%iter_2762, %idx_2761) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2764 = cute.make_view(%ptr_2763) : !memref_rmem_bf16_34
        %iter_2765 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %iter_2766 = cute.get_iter(%view_2764) : !memref_rmem_bf16_34
        %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2768 = cute.get_layout(%view_2391) : !memref_gmem_bf16_5
        %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2770 = cute.get_iter(%view_2391) : !memref_gmem_bf16_5
        %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2772 = cute.make_view(%ptr_2771) : !memref_gmem_bf16_8
        %iter_2773 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %iter_2774 = cute.get_iter(%view_2772) : !memref_gmem_bf16_8
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2776 = cute.get_layout(%rmem_2546) : !memref_rmem_i8_
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%rmem_2546) : !memref_rmem_i8_
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_i8_1
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_i8_1
        %lay_2783 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %1603 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1603) : !cute.shape<"((8,1),2)">
        %lay_2787 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %1604 = cute.get_shape(%lay_2787) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2788, %e1_2789, %e2_2790 = cute.get_leaves(%1604) : !cute.shape<"((8,1),2)">
        %lay_2791 = cute.get_layout(%view_2764) : !memref_rmem_bf16_34
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2766, %append_2794) : !memref_rmem_bf16_34
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_bf16_34
        %1605 = cute.get_shape(%lay_2797) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2798, %e1_2799, %e2_2800 = cute.get_leaves(%1605) : !cute.shape<"((8,1),2)">
        %iter_2801 = cute.get_iter(%view_2795) : !memref_rmem_bf16_34
        %view_2802 = cute.make_view(%iter_2801) : !memref_rmem_bf16_35
        %iter_2803 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2804 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %lay_2805 = cute.get_layout(%view_2772) : !memref_gmem_bf16_8
        %shape_2806 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2807 = cute.make_layout() : !cute.layout<"1:0">
        %append_2808 = cute.append_to_rank<2> (%lay_2805, %lay_2807) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2809 = cute.make_view(%iter_2774, %append_2808) : !memref_gmem_bf16_8
        %iter_2810 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %lay_2811 = cute.get_layout(%view_2809) : !memref_gmem_bf16_8
        %1606 = cute.get_shape(%lay_2811) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2812, %e1_2813, %e2_2814 = cute.get_leaves(%1606) : !cute.shape<"((8,1),2)">
        %iter_2815 = cute.get_iter(%view_2809) : !memref_gmem_bf16_8
        %view_2816 = cute.make_view(%iter_2815) : !memref_gmem_bf16_9
        %iter_2817 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %iter_2818 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2819 = cute.get_layout(%view_2780) : !memref_rmem_i8_1
        %shape_2820 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2821 = cute.make_layout() : !cute.layout<"1:0">
        %append_2822 = cute.append_to_rank<2> (%lay_2819, %lay_2821) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2823 = cute.make_view(%iter_2782, %append_2822) : !memref_rmem_i8_1
        %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %lay_2825 = cute.get_layout(%view_2823) : !memref_rmem_i8_1
        %1607 = cute.get_shape(%lay_2825) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2826, %e1_2827 = cute.get_leaves(%1607) : !cute.shape<"(1,2)">
        %iter_2828 = cute.get_iter(%view_2823) : !memref_rmem_i8_1
        %view_2829 = cute.make_view(%iter_2828) : !memref_rmem_i8_2
        %iter_2830 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %iter_2831 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2832 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %1608 = cute.get_shape(%lay_2832) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2833, %e1_2834, %e2_2835 = cute.get_leaves(%1608) : !cute.shape<"((8,1),(2))">
        %lay_2836 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %1609 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2837, %e1_2838, %e2_2839 = cute.get_leaves(%1609) : !cute.shape<"((8,1),(2))">
        %lay_2840 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %sz_2841 = cute.size(%lay_2840) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2842 = cute.get_leaves(%sz_2841) : !cute.int_tuple<"2">
        %lay_2843 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %sz_2844 = cute.size(%lay_2843) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2845 = cute.get_leaves(%sz_2844) : !cute.int_tuple<"2">
        %1610 = cute.static : !cute.layout<"1:0">
        %iter_2846 = cute.get_iter(%view_2802) : !memref_rmem_bf16_35
        %iter_2847 = cute.get_iter(%view_2816) : !memref_gmem_bf16_9
        %lay_2848 = cute.get_layout(%view_2802) : !memref_rmem_bf16_35
        %lay_2849 = cute.get_layout(%view_2816) : !memref_gmem_bf16_9
        %append_2850 = cute.append_to_rank<2> (%lay_2848, %1610) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1610) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2852 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2853 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2854 = cute.get_iter(%view_2829) : !memref_rmem_i8_2
        %lay_2855 = cute.get_layout(%view_2829) : !memref_rmem_i8_2
        %append_2856 = cute.append_to_rank<2> (%lay_2855, %1610) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2857 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2858 = cute.size(%lay_2852) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1611 = cute.get_scalars(%sz_2858) : !cute.int_tuple<"2">
        %c0_i32_2859 = arith.constant 0 : i32
        %c1_i32_2860 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2859 to %1611 step %c1_i32_2860  : i32 {
          %coord_2861 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1612 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2862 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2863 = cute.crd2idx(%coord_2861, %lay_2852) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2864 = cute.add_offset(%iter_2846, %idx_2863) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2865 = cute.make_view(%ptr_2864, %lay_2862) : !memref_rmem_bf16_9
          %1613 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2866 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2867 = cute.crd2idx(%coord_2861, %lay_2853) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2868 = cute.add_offset(%iter_2847, %idx_2867) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2869 = cute.make_view(%ptr_2868, %lay_2866) : !memref_gmem_bf16_10
          %1614 = cute.get_scalars(%coord_2861) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2870 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2871 = cute.crd2idx(%coord_2861, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2872 = cute.add_offset(%iter_2854, %idx_2871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2873 = cute.make_view(%ptr_2872, %lay_2870) : !memref_rmem_i8_3
          %iter_2874 = cute.get_iter(%view_2865) : !memref_rmem_bf16_9
          %iter_2875 = cute.get_iter(%view_2869) : !memref_gmem_bf16_10
          %iter_2876 = cute.get_iter(%view_2873) : !memref_rmem_i8_3
          %1615 = builtin.unrealized_conversion_cast %iter_2876 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1616 = llvm.load %1615 : !llvm.ptr -> i8
          %1617 = llvm.mlir.constant(0 : i8) : i8
          %1618 = llvm.icmp "ne" %1616, %1617 : i8
          scf.if %1618 {
            %1619 = builtin.unrealized_conversion_cast %iter_2874 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1620 = builtin.unrealized_conversion_cast %iter_2875 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1621 = llvm.load %1619 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1621, %1620 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__HSTUAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Ten(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_, %arg5: !cuda.stream) -> i32 attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
    %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
    %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
    %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
    %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
    %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
    %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
    %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
    %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
    %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
    %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
    %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
    %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
    %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
    %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
    %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
    %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %36 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%36) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %37 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
    %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %38 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
    %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %39 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
    %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %40 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
    %41 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%41) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %42 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
    %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %43 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
    %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %44 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
    %45 = cute.static : !cute.swizzle<"S<3,4,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %46 = cute.get_stride(%lay_83) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_84, %e1_85 = cute.get_leaves(%46) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_86 = cute.make_composed_layout(%45, %int_tuple, %lay_83) : !cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">
    %shape_87 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_88 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %47 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_89 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_90 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %48 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_91 = cute.make_shape() : () -> !cute.shape<"(64,64)">
    %int_tuple_92 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %49 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
    %cosz = cute.cosize(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_93 = cute.get_leaves(%cosz) : !cute.int_tuple<"8192">
    %cosz_94 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_95 = cute.get_leaves(%cosz_94) : !cute.int_tuple<"8192">
    %cosz_96 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_97 = cute.get_leaves(%cosz_96) : !cute.int_tuple<"8192">
    %cosz_98 = cute.cosize(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"4096">
    %e0_99 = cute.get_leaves(%cosz_98) : !cute.int_tuple<"4096">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>
    %atom_100 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %50 = cute.composed_get_outer(%lay_86) : (!cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %51 = cute.get_shape(%50) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_101, %e1_102 = cute.get_leaves(%51) : !cute.shape<"(8,64)">
    %shape_103 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_104 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_105 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_106 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_107 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %lay_108 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_109 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_110 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_111 = cute.get_leaves(%sz_110) : !cute.int_tuple<"8">
    %shape_112 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_113 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%lay_108) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_114 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %52 = cute.get_shape(%lay_108) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_115, %e1_116, %e2_117 = cute.get_leaves(%52) : !cute.shape<"(16,(8,8))">
    %int_tuple_118 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_119 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_120, %e1_121 = cute.get_leaves(%int_tuple_119) : !cute.int_tuple<"(16,64)">
    %int_tuple_122 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_123 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_124, %e1_125 = cute.get_leaves(%int_tuple_123) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %53 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %lay_126 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_127 = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_128 = cute.get_leaves(%sz_127) : !cute.int_tuple<"128">
    %sz_129 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_130 = cute.get_leaves(%sz_129) : !cute.int_tuple<"8">
    %shape_131 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_132 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_133 = cute.right_inverse(%lay_126) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_134 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %54 = cute.get_shape(%lay_126) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_135, %e1_136, %e2_137 = cute.get_leaves(%54) : !cute.shape<"(16,(8,8))">
    %int_tuple_138 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_139 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_140, %e1_141 = cute.get_leaves(%int_tuple_139) : !cute.int_tuple<"(16,64)">
    %int_tuple_142 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_143 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_144, %e1_145 = cute.get_leaves(%int_tuple_143) : !cute.int_tuple<"(16,64)">
    %tile_146 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %55 = cute.make_tiled_copy(%atom_100) : !copy_simt
    %shape_147 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_148 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_149 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_150 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %56 = cute.get_shape(%lay_150) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_151, %e1_152, %e2_153 = cute.get_leaves(%56) : !cute.shape<"(4,1,1)">
    %tile_154 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %57 = cute.make_tiled_mma(%atom_148) : !mma_bf16_bf16_f32_16x8x16_
    %lay_155 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %58 = cute.get_shape(%lay_155) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_156, %e1_157, %e2_158, %e3_159 = cute.get_leaves(%58) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_160 = cute.to_int_tuple(%e0_156) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %59 = cute.get_scalars(%itup_160) : !cute.int_tuple<"?">
    %itup_161 = cute.to_int_tuple(%e1_157) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_161) : !cute.int_tuple<"?">
    %itup_162 = cute.to_int_tuple(%e2_158) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_162) : !cute.int_tuple<"?">
    %itup_163 = cute.to_int_tuple(%e3_159) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %62 = cute.get_scalars(%itup_163) : !cute.int_tuple<"?{div=8}">
    %int_tuple_164 = cute.make_int_tuple(%itup_161) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_165 = cute.make_tile() : () -> !cute.tile<"64:1">
    %63 = cute.get_scalars(%int_tuple_164) <{only_dynamic}> : !cute.int_tuple<"?">
    %c64_i32 = arith.constant 64 : i32
    %64 = arith.ceildivsi %63, %c64_i32 : i32
    %int_tuple_166 = cute.make_int_tuple(%64) : (i32) -> !cute.int_tuple<"?">
    %e0_167 = cute.get_leaves(%int_tuple_166) : !cute.int_tuple<"?">
    %65 = cute.get_scalars(%e0_167) : !cute.int_tuple<"?">
    %lay_168 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %66 = cute.get_shape(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_169, %e1_170, %e2_171, %e3_172 = cute.get_leaves(%66) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_173 = cute.to_int_tuple(%e0_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %67 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e1_170) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %68 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?">
    %itup_175 = cute.to_int_tuple(%e2_171) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_175) : !cute.int_tuple<"?">
    %itup_176 = cute.to_int_tuple(%e3_172) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %70 = cute.get_scalars(%itup_176) : !cute.int_tuple<"?{div=8}">
    %71 = cute.get_stride(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_177, %e1_178, %e2_179, %e3_180 = cute.get_leaves(%71) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_181 = cute.to_int_tuple(%e0_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %72 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %itup_182 = cute.to_int_tuple(%e1_178) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %73 = cute.get_scalars(%itup_182) : !cute.int_tuple<"?{i64 div=8}">
    %itup_183 = cute.to_int_tuple(%e2_179) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_183) : !cute.int_tuple<"?{i64 div=8}">
    %lay_184 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %75 = cute.get_shape(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_185, %e1_186, %e2_187, %e3_188 = cute.get_leaves(%75) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_189 = cute.to_int_tuple(%e0_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %76 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e1_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %77 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
    %itup_191 = cute.to_int_tuple(%e2_187) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?">
    %itup_192 = cute.to_int_tuple(%e3_188) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %79 = cute.get_scalars(%itup_192) : !cute.int_tuple<"?{div=8}">
    %80 = cute.get_stride(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_193, %e1_194, %e2_195, %e3_196 = cute.get_leaves(%80) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_197 = cute.to_int_tuple(%e0_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %81 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %itup_198 = cute.to_int_tuple(%e1_194) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %82 = cute.get_scalars(%itup_198) : !cute.int_tuple<"?{i64 div=8}">
    %itup_199 = cute.to_int_tuple(%e2_195) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_199) : !cute.int_tuple<"?{i64 div=8}">
    %lay_200 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %84 = cute.get_shape(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_201, %e1_202, %e2_203, %e3_204 = cute.get_leaves(%84) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_205 = cute.to_int_tuple(%e0_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %85 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e1_202) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %86 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?">
    %itup_207 = cute.to_int_tuple(%e2_203) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_207) : !cute.int_tuple<"?">
    %itup_208 = cute.to_int_tuple(%e3_204) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %88 = cute.get_scalars(%itup_208) : !cute.int_tuple<"?{div=8}">
    %89 = cute.get_stride(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_209, %e1_210, %e2_211, %e3_212 = cute.get_leaves(%89) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_213 = cute.to_int_tuple(%e0_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %90 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %itup_214 = cute.to_int_tuple(%e1_210) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %91 = cute.get_scalars(%itup_214) : !cute.int_tuple<"?{i64 div=8}">
    %itup_215 = cute.to_int_tuple(%e2_211) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?{i64 div=8}">
    %lay_216 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %93 = cute.get_shape(%lay_216) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_217, %e1_218, %e2_219, %e3_220 = cute.get_leaves(%93) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_221 = cute.to_int_tuple(%e0_217) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %94 = cute.get_scalars(%itup_221) : !cute.int_tuple<"?">
    %itup_222 = cute.to_int_tuple(%e1_218) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %95 = cute.get_scalars(%itup_222) : !cute.int_tuple<"?">
    %itup_223 = cute.to_int_tuple(%e2_219) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %96 = cute.get_scalars(%itup_223) : !cute.int_tuple<"?">
    %itup_224 = cute.to_int_tuple(%e3_220) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %97 = cute.get_scalars(%itup_224) : !cute.int_tuple<"?{div=8}">
    %98 = cute.get_stride(%lay_216) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_225, %e1_226, %e2_227, %e3_228 = cute.get_leaves(%98) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_229 = cute.to_int_tuple(%e0_225) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %99 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?{i64 div=8}">
    %itup_230 = cute.to_int_tuple(%e1_226) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %100 = cute.get_scalars(%itup_230) : !cute.int_tuple<"?{i64 div=8}">
    %itup_231 = cute.to_int_tuple(%e2_227) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %101 = cute.get_scalars(%itup_231) : !cute.int_tuple<"?{i64 div=8}">
    %lay_232 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %102 = cute.get_shape(%lay_232) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_233, %e1_234, %e2_235, %e3_236 = cute.get_leaves(%102) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_237 = cute.to_int_tuple(%e0_233) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %103 = cute.get_scalars(%itup_237) : !cute.int_tuple<"?">
    %itup_238 = cute.to_int_tuple(%e1_234) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %104 = cute.get_scalars(%itup_238) : !cute.int_tuple<"?">
    %itup_239 = cute.to_int_tuple(%e2_235) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %105 = cute.get_scalars(%itup_239) : !cute.int_tuple<"?">
    %itup_240 = cute.to_int_tuple(%e3_236) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %106 = cute.get_scalars(%itup_240) : !cute.int_tuple<"?{div=8}">
    %107 = cute.get_stride(%lay_232) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_241, %e1_242, %e2_243, %e3_244 = cute.get_leaves(%107) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_245 = cute.to_int_tuple(%e0_241) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %108 = cute.get_scalars(%itup_245) : !cute.int_tuple<"?{i64 div=8}">
    %itup_246 = cute.to_int_tuple(%e1_242) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %109 = cute.get_scalars(%itup_246) : !cute.int_tuple<"?{i64 div=8}">
    %itup_247 = cute.to_int_tuple(%e2_243) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %110 = cute.get_scalars(%itup_247) : !cute.int_tuple<"?{i64 div=8}">
    %111 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %112 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_248 = cute.get_leaves(%112) : !cute.int_tuple<"0">
    %113 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %114 = cute.get_shape(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_249, %e1_250, %e2_251, %e3_252 = cute.get_leaves(%114) : !cute.shape<"((8,8),(64,2))">
    %115 = cute.get_stride(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_253, %e1_254, %e2_255, %e3_256 = cute.get_leaves(%115) : !cute.stride<"((64,512),(1,4096))">
    %116 = cute.composed_get_inner(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %117 = cute.composed_get_offset(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_257 = cute.get_leaves(%117) : !cute.int_tuple<"0">
    %118 = cute.composed_get_outer(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %119 = cute.get_shape(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_258, %e1_259, %e2_260, %e3_261 = cute.get_leaves(%119) : !cute.shape<"((8,8),(64,2))">
    %120 = cute.get_stride(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_262, %e1_263, %e2_264, %e3_265 = cute.get_leaves(%120) : !cute.stride<"((64,512),(1,4096))">
    %121 = cute.composed_get_inner(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
    %122 = cute.composed_get_offset(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
    %e0_266 = cute.get_leaves(%122) : !cute.int_tuple<"0">
    %123 = cute.composed_get_outer(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
    %124 = cute.get_shape(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
    %e0_267, %e1_268, %e2_269, %e3_270 = cute.get_leaves(%124) : !cute.shape<"((8,8),(64,1))">
    %125 = cute.get_stride(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
    %e0_271, %e1_272, %e2_273, %e3_274 = cute.get_leaves(%125) : !cute.stride<"((64,512),(1,0))">
    %126 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %127 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_275 = cute.get_leaves(%127) : !cute.int_tuple<"0">
    %128 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %129 = cute.get_shape(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_276, %e1_277, %e2_278, %e3_279 = cute.get_leaves(%129) : !cute.shape<"((8,8),(64,2))">
    %130 = cute.get_stride(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_280, %e1_281, %e2_282, %e3_283 = cute.get_leaves(%130) : !cute.stride<"((64,512),(1,4096))">
    %131 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_284, %e1_285 = cute.get_leaves(%131) : !cute.tile<"[16:1;64:1]">
    %132 = cute.get_shape(%e0_284) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_286 = cute.get_leaves(%132) : !cute.shape<"16">
    %133 = cute.get_stride(%e0_284) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_287 = cute.get_leaves(%133) : !cute.stride<"1">
    %134 = cute.get_shape(%e1_285) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_288 = cute.get_leaves(%134) : !cute.shape<"64">
    %135 = cute.get_stride(%e1_285) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_289 = cute.get_leaves(%135) : !cute.stride<"1">
    %136 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %137 = cute.get_shape(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_290, %e1_291, %e2_292 = cute.get_leaves(%137) : !cute.shape<"((8,16),8)">
    %138 = cute.get_stride(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_293, %e1_294, %e2_295 = cute.get_leaves(%138) : !cute.stride<"((128,1),16)">
    %139 = cute.static : !cute.layout<"1:0">
    %140 = cute.get_shape(%139) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_296 = cute.get_leaves(%140) : !cute.shape<"1">
    %141 = cute.get_stride(%139) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_297 = cute.get_leaves(%141) : !cute.stride<"0">
    %142 = cute.static : !cute.layout<"(1,8):(0,1)">
    %143 = cute.get_shape(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_298, %e1_299 = cute.get_leaves(%143) : !cute.shape<"(1,8)">
    %144 = cute.get_stride(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_300, %e1_301 = cute.get_leaves(%144) : !cute.stride<"(0,1)">
    %145 = cute.static : !cute.layout<"(1,8):(0,1)">
    %146 = cute.get_shape(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_302, %e1_303 = cute.get_leaves(%146) : !cute.shape<"(1,8)">
    %147 = cute.get_stride(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_304, %e1_305 = cute.get_leaves(%147) : !cute.stride<"(0,1)">
    %148 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_306, %e1_307 = cute.get_leaves(%148) : !cute.tile<"[16:1;64:1]">
    %149 = cute.get_shape(%e0_306) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_308 = cute.get_leaves(%149) : !cute.shape<"16">
    %150 = cute.get_stride(%e0_306) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_309 = cute.get_leaves(%150) : !cute.stride<"1">
    %151 = cute.get_shape(%e1_307) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_310 = cute.get_leaves(%151) : !cute.shape<"64">
    %152 = cute.get_stride(%e1_307) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_311 = cute.get_leaves(%152) : !cute.stride<"1">
    %153 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %154 = cute.get_shape(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_312, %e1_313, %e2_314 = cute.get_leaves(%154) : !cute.shape<"((8,16),8)">
    %155 = cute.get_stride(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_315, %e1_316, %e2_317 = cute.get_leaves(%155) : !cute.stride<"((128,1),16)">
    %156 = cute.static : !cute.layout<"1:0">
    %157 = cute.get_shape(%156) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_318 = cute.get_leaves(%157) : !cute.shape<"1">
    %158 = cute.get_stride(%156) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_319 = cute.get_leaves(%158) : !cute.stride<"0">
    %159 = cute.static : !cute.layout<"(1,8):(0,1)">
    %160 = cute.get_shape(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_320, %e1_321 = cute.get_leaves(%160) : !cute.shape<"(1,8)">
    %161 = cute.get_stride(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_322, %e1_323 = cute.get_leaves(%161) : !cute.stride<"(0,1)">
    %162 = cute.static : !cute.layout<"(1,8):(0,1)">
    %163 = cute.get_shape(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_324, %e1_325 = cute.get_leaves(%163) : !cute.shape<"(1,8)">
    %164 = cute.get_stride(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_326, %e1_327 = cute.get_leaves(%164) : !cute.stride<"(0,1)">
    %165 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %166 = cute.get_shape(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_328, %e1_329, %e2_330, %e3_331 = cute.get_leaves(%166) : !cute.shape<"(32,4,1,1)">
    %167 = cute.get_stride(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_332, %e1_333, %e2_334, %e3_335 = cute.get_leaves(%167) : !cute.stride<"(1,32,0,0)">
    %168 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_336, %e1_337, %e2_338 = cute.get_leaves(%168) : !cute.tile<"[64:1;16:1;16:1]">
    %169 = cute.get_shape(%e0_336) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_339 = cute.get_leaves(%169) : !cute.shape<"64">
    %170 = cute.get_stride(%e0_336) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_340 = cute.get_leaves(%170) : !cute.stride<"1">
    %171 = cute.get_shape(%e1_337) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_341 = cute.get_leaves(%171) : !cute.shape<"16">
    %172 = cute.get_stride(%e1_337) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_342 = cute.get_leaves(%172) : !cute.stride<"1">
    %173 = cute.get_shape(%e2_338) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_343 = cute.get_leaves(%173) : !cute.shape<"16">
    %174 = cute.get_stride(%e2_338) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_344 = cute.get_leaves(%174) : !cute.stride<"1">
    %175 = cute.static : !cute.layout<"32:1">
    %176 = cute.get_shape(%175) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_345 = cute.get_leaves(%176) : !cute.shape<"32">
    %177 = cute.get_stride(%175) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_346 = cute.get_leaves(%177) : !cute.stride<"1">
    %178 = cute.static : !cute.shape<"(16,8,16)">
    %e0_347, %e1_348, %e2_349 = cute.get_leaves(%178) : !cute.shape<"(16,8,16)">
    %179 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %180 = cute.get_shape(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_350, %e1_351, %e2_352, %e3_353, %e4 = cute.get_leaves(%180) : !cute.shape<"((4,8),(2,2,2))">
    %181 = cute.get_stride(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_354, %e1_355, %e2_356, %e3_357, %e4_358 = cute.get_leaves(%181) : !cute.stride<"((32,1),(16,8,128))">
    %182 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %183 = cute.get_shape(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_359, %e1_360, %e2_361, %e3_362 = cute.get_leaves(%183) : !cute.shape<"((4,8),(2,2))">
    %184 = cute.get_stride(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_363, %e1_364, %e2_365, %e3_366 = cute.get_leaves(%184) : !cute.stride<"((16,1),(8,64))">
    %185 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %186 = cute.get_shape(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_367, %e1_368, %e2_369, %e3_370 = cute.get_leaves(%186) : !cute.shape<"((4,8),(2,2))">
    %187 = cute.get_stride(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_371, %e1_372, %e2_373, %e3_374 = cute.get_leaves(%187) : !cute.stride<"((32,1),(16,8))">
    %c57344_i32 = arith.constant 57344 : i32
    %188 = arith.extsi %c57344_i32 : i32 to i64
    %c128_i32 = arith.constant 128 : i32
    %c1_i32 = arith.constant 1 : i32
    %c4_i32 = arith.constant 4 : i32
    %189 = cuda.launch_cfg.create<max_attrs = 2 : i32> (blockDim = (%c128_i32, %c1_i32, %c1_i32), dynamicSmemBytes = %188, gridDim = (%c4_i32, %c4_i32, %65), stream = %arg5) : i32, i32, i32, i64, i32, i32, i32, !cuda.stream -> !cuda.launch_cfg<max_attrs = 2>
    %190 = cuda.launch_ex @kernels::@kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gm_0<%189> (%arg0, %arg1, %arg2, %arg3, %arg4) : !cuda.launch_cfg<max_attrs = 2>, (!memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_) -> !cuda.result
    %191 = cuda.cast %190 : !cuda.result -> i32
    cuda.return_if_error %191 : i32
    %c0_i32 = arith.constant 0 : i32
    return %c0_i32 : i32
  }
}
