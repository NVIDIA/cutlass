!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_3 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(64,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "(64,64,?):(?{i64 div=8},1,64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_11 = !cute.memref<bf16, gmem, align<16>, "((8,1),1):((1,0),0)">
!memref_gmem_bf16_12 = !cute.memref<bf16, gmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_gmem_bf16_13 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),1,(4,2)):((1,0),0,(16,8))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<32>, "((8,1),1,4):((1,0),0,8)">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<32>, "((8,1),(1,4)):((1,0),(0,8))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<16>, "((8,1),1):((1,0),0)">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),4):(((1,32),0),4)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1),(4)):(((1,32),0),(4))">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<8>, "(((4,2),1)):(((1,32),0))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),1):((1,2,4),0)">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<8>, "((2,2),(2,4)):((1,2),(32,4))">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1,4):(((1,2),4),0,8)">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2),1):(((1,2),4),0)">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<16>, "(((2,2),2)):(((1,2),4))">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((1,8),1,8):((0,1),0,8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((1,8),(1,8)):((0,1),(0,8))">
!memref_rmem_bf16_31 = !cute.memref<bf16, rmem, align<16>, "((1,8)):((0,1))">
!memref_rmem_bf16_32 = !cute.memref<bf16, rmem, align<32>, "((8,1),4,2):((1,0),16,8)">
!memref_rmem_bf16_33 = !cute.memref<bf16, rmem, align<32>, "((8,1),(4,2)):((1,0),(16,8))">
!memref_rmem_bf16_34 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_35 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),1,16):((1,2),0,4)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "((2,2),1,8):((1,2),0,4)">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,4,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,1):((1,0),1024,0)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),1,((2,2),2)):((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),(2,4),((2,2),2)):((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,4,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),1):((1,0),0)">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(1)):((1,0),(0))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<1024>, S<3,4,3>, "((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">
!memref_smem_bf16_25 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">
!memref_smem_bf16_26 = !cute.memref<bf16, smem, align<4>, S<3,4,3>, "((1,(2,2,2))):((0,(1,512,8)))">
!memref_smem_bf16_27 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_28 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_29 = !cute.memref<bf16, smem, align<16>, S<3,4,3>, "((8,1)):((1,0))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    func.func public @kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_) attributes {cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %1 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
      %3 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %4 = cute.static : !copy_ldgsts
      %5 = cute.static : !copy_simt
      %6 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %7 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%7) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
      %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %10 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
      %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %11 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
      %12 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%12) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
      %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %15 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
      %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %16 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%16) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
      %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %19 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
      %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %20 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
      %21 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%21) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
      %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %24 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
      %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %25 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%25) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
      %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %28 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
      %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %29 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
      %30 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%30) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
      %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %33 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
      %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %34 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%34) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
      %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %37 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
      %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %38 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
      %39 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%39) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
      %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
      %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %43 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%43) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %44 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
      %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %45 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
      %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %46 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
      %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %47 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
      %48 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%48) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %49 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
      %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %50 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
      %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %51 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
      %52 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %53 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,8),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,4096))">
      %57 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %58 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_92 = cute.get_leaves(%58) : !cute.int_tuple<"0">
      %59 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %60 = cute.get_shape(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_93, %e1_94, %e2_95, %e3_96 = cute.get_leaves(%60) : !cute.shape<"((8,8),(64,2))">
      %61 = cute.get_stride(%59) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_97, %e1_98, %e2_99, %e3_100 = cute.get_leaves(%61) : !cute.stride<"((64,512),(1,4096))">
      %62 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
      %63 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
      %e0_101 = cute.get_leaves(%63) : !cute.int_tuple<"0">
      %64 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
      %65 = cute.get_shape(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
      %e0_102, %e1_103, %e2_104, %e3_105 = cute.get_leaves(%65) : !cute.shape<"((8,8),(64,1))">
      %66 = cute.get_stride(%64) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
      %e0_106, %e1_107, %e2_108, %e3_109 = cute.get_leaves(%66) : !cute.stride<"((64,512),(1,0))">
      %67 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %68 = cute.composed_get_offset(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_110 = cute.get_leaves(%68) : !cute.int_tuple<"0">
      %69 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %70 = cute.get_shape(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_111, %e1_112, %e2_113, %e3_114 = cute.get_leaves(%70) : !cute.shape<"((8,8),(64,2))">
      %71 = cute.get_stride(%69) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_115, %e1_116, %e2_117, %e3_118 = cute.get_leaves(%71) : !cute.stride<"((64,512),(1,4096))">
      %72 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_119, %e1_120 = cute.get_leaves(%72) : !cute.tile<"[16:1;64:1]">
      %73 = cute.get_shape(%e0_119) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_121 = cute.get_leaves(%73) : !cute.shape<"16">
      %74 = cute.get_stride(%e0_119) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_122 = cute.get_leaves(%74) : !cute.stride<"1">
      %75 = cute.get_shape(%e1_120) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_123 = cute.get_leaves(%75) : !cute.shape<"64">
      %76 = cute.get_stride(%e1_120) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_124 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %78 = cute.get_shape(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_125, %e1_126, %e2_127 = cute.get_leaves(%78) : !cute.shape<"((8,16),8)">
      %79 = cute.get_stride(%77) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_128, %e1_129, %e2_130 = cute.get_leaves(%79) : !cute.stride<"((128,1),16)">
      %80 = cute.static : !cute.layout<"1:0">
      %81 = cute.get_shape(%80) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_131 = cute.get_leaves(%81) : !cute.shape<"1">
      %82 = cute.get_stride(%80) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_132 = cute.get_leaves(%82) : !cute.stride<"0">
      %83 = cute.static : !cute.layout<"(1,8):(0,1)">
      %84 = cute.get_shape(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_133, %e1_134 = cute.get_leaves(%84) : !cute.shape<"(1,8)">
      %85 = cute.get_stride(%83) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_135, %e1_136 = cute.get_leaves(%85) : !cute.stride<"(0,1)">
      %86 = cute.static : !cute.layout<"(1,8):(0,1)">
      %87 = cute.get_shape(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_137, %e1_138 = cute.get_leaves(%87) : !cute.shape<"(1,8)">
      %88 = cute.get_stride(%86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_139, %e1_140 = cute.get_leaves(%88) : !cute.stride<"(0,1)">
      %89 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_141, %e1_142 = cute.get_leaves(%89) : !cute.tile<"[16:1;64:1]">
      %90 = cute.get_shape(%e0_141) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_143 = cute.get_leaves(%90) : !cute.shape<"16">
      %91 = cute.get_stride(%e0_141) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_144 = cute.get_leaves(%91) : !cute.stride<"1">
      %92 = cute.get_shape(%e1_142) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_145 = cute.get_leaves(%92) : !cute.shape<"64">
      %93 = cute.get_stride(%e1_142) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_146 = cute.get_leaves(%93) : !cute.stride<"1">
      %94 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %95 = cute.get_shape(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_147, %e1_148, %e2_149 = cute.get_leaves(%95) : !cute.shape<"((8,16),8)">
      %96 = cute.get_stride(%94) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_150, %e1_151, %e2_152 = cute.get_leaves(%96) : !cute.stride<"((128,1),16)">
      %97 = cute.static : !cute.layout<"1:0">
      %98 = cute.get_shape(%97) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_153 = cute.get_leaves(%98) : !cute.shape<"1">
      %99 = cute.get_stride(%97) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_154 = cute.get_leaves(%99) : !cute.stride<"0">
      %100 = cute.static : !cute.layout<"(1,8):(0,1)">
      %101 = cute.get_shape(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_155, %e1_156 = cute.get_leaves(%101) : !cute.shape<"(1,8)">
      %102 = cute.get_stride(%100) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_157, %e1_158 = cute.get_leaves(%102) : !cute.stride<"(0,1)">
      %103 = cute.static : !cute.layout<"(1,8):(0,1)">
      %104 = cute.get_shape(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_159, %e1_160 = cute.get_leaves(%104) : !cute.shape<"(1,8)">
      %105 = cute.get_stride(%103) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_161, %e1_162 = cute.get_leaves(%105) : !cute.stride<"(0,1)">
      %106 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %107 = cute.get_shape(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_163, %e1_164, %e2_165, %e3_166 = cute.get_leaves(%107) : !cute.shape<"(32,4,1,1)">
      %108 = cute.get_stride(%106) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%108) : !cute.stride<"(1,32,0,0)">
      %109 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_171, %e1_172, %e2_173 = cute.get_leaves(%109) : !cute.tile<"[64:1;16:1;16:1]">
      %110 = cute.get_shape(%e0_171) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_174 = cute.get_leaves(%110) : !cute.shape<"64">
      %111 = cute.get_stride(%e0_171) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_175 = cute.get_leaves(%111) : !cute.stride<"1">
      %112 = cute.get_shape(%e1_172) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_176 = cute.get_leaves(%112) : !cute.shape<"16">
      %113 = cute.get_stride(%e1_172) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_177 = cute.get_leaves(%113) : !cute.stride<"1">
      %114 = cute.get_shape(%e2_173) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_178 = cute.get_leaves(%114) : !cute.shape<"16">
      %115 = cute.get_stride(%e2_173) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_179 = cute.get_leaves(%115) : !cute.stride<"1">
      %116 = cute.static : !cute.layout<"32:1">
      %117 = cute.get_shape(%116) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_180 = cute.get_leaves(%117) : !cute.shape<"32">
      %118 = cute.get_stride(%116) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_181 = cute.get_leaves(%118) : !cute.stride<"1">
      %119 = cute.static : !cute.shape<"(16,8,16)">
      %e0_182, %e1_183, %e2_184 = cute.get_leaves(%119) : !cute.shape<"(16,8,16)">
      %120 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %121 = cute.get_shape(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_185, %e1_186, %e2_187, %e3_188, %e4 = cute.get_leaves(%121) : !cute.shape<"((4,8),(2,2,2))">
      %122 = cute.get_stride(%120) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_189, %e1_190, %e2_191, %e3_192, %e4_193 = cute.get_leaves(%122) : !cute.stride<"((32,1),(16,8,128))">
      %123 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %124 = cute.get_shape(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_194, %e1_195, %e2_196, %e3_197 = cute.get_leaves(%124) : !cute.shape<"((4,8),(2,2))">
      %125 = cute.get_stride(%123) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_198, %e1_199, %e2_200, %e3_201 = cute.get_leaves(%125) : !cute.stride<"((16,1),(8,64))">
      %126 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %127 = cute.get_shape(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_202, %e1_203, %e2_204, %e3_205 = cute.get_leaves(%127) : !cute.shape<"((4,8),(2,2))">
      %128 = cute.get_stride(%126) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_206, %e1_207, %e2_208, %e3_209 = cute.get_leaves(%128) : !cute.stride<"((32,1),(16,8))">
      %129 = nvvm.read.ptx.sreg.tid.x : i32
      %130 = nvvm.read.ptx.sreg.tid.y : i32
      %131 = nvvm.read.ptx.sreg.tid.z : i32
      %132 = nvvm.read.ptx.sreg.ctaid.x : i32
      %133 = nvvm.read.ptx.sreg.ctaid.y : i32
      %134 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_210 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %135 = cute.get_shape(%lay_210) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_211, %e1_212, %e2_213, %e3_214 = cute.get_leaves(%135) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_215 = cute.to_int_tuple(%e0_211) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %136 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?">
      %itup_216 = cute.to_int_tuple(%e1_212) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %137 = cute.get_scalars(%itup_216) : !cute.int_tuple<"?">
      %itup_217 = cute.to_int_tuple(%e2_213) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %138 = cute.get_scalars(%itup_217) : !cute.int_tuple<"?">
      %itup_218 = cute.to_int_tuple(%e3_214) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %139 = cute.get_scalars(%itup_218) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_216) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %140 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %141 = arith.ceildivsi %140, %c64_i32 : i32
      %int_tuple_219 = cute.make_int_tuple(%141) : (i32) -> !cute.int_tuple<"?">
      %e0_220 = cute.get_leaves(%int_tuple_219) : !cute.int_tuple<"?">
      %142 = cute.get_scalars(%e0_220) : !cute.int_tuple<"?">
      %int_tuple_221 = cute.make_int_tuple(%134) : (i32) -> !cute.int_tuple<"?">
      %sub = cute.tuple_sub(%e0_220, %int_tuple_221) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %143 = cute.get_scalars(%sub) : !cute.int_tuple<"?">
      %int_tuple_222 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_223 = cute.tuple_sub(%sub, %int_tuple_222) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %144 = cute.get_scalars(%sub_223) : !cute.int_tuple<"?">
      %lay_224 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %145 = cute.get_shape(%lay_224) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_225, %e1_226, %e2_227, %e3_228 = cute.get_leaves(%145) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_229 = cute.to_int_tuple(%e0_225) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %146 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?">
      %itup_230 = cute.to_int_tuple(%e1_226) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %147 = cute.get_scalars(%itup_230) : !cute.int_tuple<"?">
      %itup_231 = cute.to_int_tuple(%e2_227) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %148 = cute.get_scalars(%itup_231) : !cute.int_tuple<"?">
      %itup_232 = cute.to_int_tuple(%e3_228) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %149 = cute.get_scalars(%itup_232) : !cute.int_tuple<"?{div=8}">
      %int_tuple_233 = cute.make_int_tuple(%itup_230) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile_234 = cute.make_tile() : () -> !cute.tile<"64:1">
      %150 = cute.get_scalars(%int_tuple_233) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32_235 = arith.constant 64 : i32
      %151 = arith.ceildivsi %150, %c64_i32_235 : i32
      %int_tuple_236 = cute.make_int_tuple(%151) : (i32) -> !cute.int_tuple<"?">
      %e0_237 = cute.get_leaves(%int_tuple_236) : !cute.int_tuple<"?">
      %152 = cute.get_scalars(%e0_237) : !cute.int_tuple<"?">
      %int_tuple_238 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sub_239 = cute.tuple_sub(%e0_237, %int_tuple_238) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %153 = cute.get_scalars(%sub_239) : !cute.int_tuple<"?">
      %coord = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_240 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %154:7 = cute.get_scalars(%lay_240) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %155:2 = cute.get_scalars(%coord) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv = cute.assume(%154#3) : (i32) -> !cute.i32<divby 8>
      %shape = cute.make_shape(%154#1, %iv) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_241 = cute.assume(%154#5) : (i64) -> !cute.i64<divby 8>
      %stride = cute.make_stride(%iv_241) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_242 = cute.make_layout(%shape, %stride) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx = cute.crd2idx(%coord, %lay_240) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_243 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_243, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %lay_242) : !memref_gmem_bf16_1
      %iter_244 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_245 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_246 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %156 = cute.get_scalars(%coord_246) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_247 = cute.make_coord(%156) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_248 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %157:3 = cute.get_scalars(%lay_248) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_249 = arith.constant 64 : i32
      %158 = arith.ceildivsi %157#0, %c64_i32_249 : i32
      %c64_i64 = arith.constant 64 : i64
      %159 = arith.muli %157#2, %c64_i64 : i64
      %c128_i32 = arith.constant 128 : i32
      %160 = arith.ceildivsi %157#1, %c128_i32 : i32
      %shape_250 = cute.make_shape(%158, %160) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_251 = cute.assume(%157#2) : (i64) -> !cute.i64<divby 8>
      %iv_252 = cute.assume(%159) : (i64) -> !cute.i64<divby 512>
      %stride_253 = cute.make_stride(%iv_251, %iv_252) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_254 = cute.make_layout(%shape_250, %stride_253) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %161:4 = cute.get_scalars(%lay_254) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %162 = cute.get_scalars(%coord_247) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_255 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %iv_256 = cute.assume(%161#2) : (i64) -> !cute.i64<divby 8>
      %stride_257 = cute.make_stride(%iv_256) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_258 = cute.make_layout(%shape_255, %stride_257) : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %idx_259 = cute.crd2idx(%coord_247, %lay_254) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_260 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_261 = cute.add_offset(%iter_260, %idx_259) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_262 = cute.make_view(%ptr_261, %lay_258) : !memref_gmem_bf16_2
      %iter_263 = cute.get_iter(%view_262) : !memref_gmem_bf16_2
      %coord_264 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_265 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %163:7 = cute.get_scalars(%lay_265) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %164:2 = cute.get_scalars(%coord_264) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_266 = cute.assume(%163#3) : (i32) -> !cute.i32<divby 8>
      %shape_267 = cute.make_shape(%163#1, %iv_266) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_268 = cute.assume(%163#5) : (i64) -> !cute.i64<divby 8>
      %stride_269 = cute.make_stride(%iv_268) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_270 = cute.make_layout(%shape_267, %stride_269) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_271 = cute.crd2idx(%coord_264, %lay_265) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_272 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_273 = cute.add_offset(%iter_272, %idx_271) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_274 = cute.make_view(%ptr_273, %lay_270) : !memref_gmem_bf16_1
      %iter_275 = cute.get_iter(%view_274) : !memref_gmem_bf16_1
      %tile_276 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_277 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_278 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_279 = cute.get_layout(%view_274) : !memref_gmem_bf16_1
      %165:3 = cute.get_scalars(%lay_279) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_280 = arith.constant 64 : i32
      %166 = arith.ceildivsi %165#0, %c64_i32_280 : i32
      %c64_i64_281 = arith.constant 64 : i64
      %167 = arith.muli %165#2, %c64_i64_281 : i64
      %c128_i32_282 = arith.constant 128 : i32
      %168 = arith.ceildivsi %165#1, %c128_i32_282 : i32
      %shape_283 = cute.make_shape(%166, %168) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_284 = cute.assume(%165#2) : (i64) -> !cute.i64<divby 8>
      %iv_285 = cute.assume(%167) : (i64) -> !cute.i64<divby 512>
      %stride_286 = cute.make_stride(%iv_284, %iv_285) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_287 = cute.make_layout(%shape_283, %stride_286) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %169:4 = cute.get_scalars(%lay_287) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_288 = cute.make_shape(%169#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_289 = cute.assume(%169#2) : (i64) -> !cute.i64<divby 8>
      %iv_290 = cute.assume(%169#3) : (i64) -> !cute.i64<divby 512>
      %stride_291 = cute.make_stride(%iv_289, %iv_290) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_292 = cute.make_layout(%shape_288, %stride_291) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_293 = cute.crd2idx(%coord_278, %lay_287) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_294 = cute.get_iter(%view_274) : !memref_gmem_bf16_1
      %ptr_295 = cute.add_offset(%iter_294, %idx_293) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_296 = cute.make_view(%ptr_295, %lay_292) : !memref_gmem_bf16_3
      %iter_297 = cute.get_iter(%view_296) : !memref_gmem_bf16_3
      %coord_298 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_299 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %170:7 = cute.get_scalars(%lay_299) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %171:2 = cute.get_scalars(%coord_298) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_300 = cute.assume(%170#3) : (i32) -> !cute.i32<divby 8>
      %shape_301 = cute.make_shape(%170#1, %iv_300) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_302 = cute.assume(%170#5) : (i64) -> !cute.i64<divby 8>
      %stride_303 = cute.make_stride(%iv_302) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_304 = cute.make_layout(%shape_301, %stride_303) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_305 = cute.crd2idx(%coord_298, %lay_299) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_306 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_307 = cute.add_offset(%iter_306, %idx_305) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_308 = cute.make_view(%ptr_307, %lay_304) : !memref_gmem_bf16_1
      %iter_309 = cute.get_iter(%view_308) : !memref_gmem_bf16_1
      %tile_310 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_311 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_312 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_313 = cute.get_layout(%view_308) : !memref_gmem_bf16_1
      %172:3 = cute.get_scalars(%lay_313) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_314 = arith.constant 64 : i32
      %173 = arith.ceildivsi %172#0, %c64_i32_314 : i32
      %c64_i64_315 = arith.constant 64 : i64
      %174 = arith.muli %172#2, %c64_i64_315 : i64
      %c128_i32_316 = arith.constant 128 : i32
      %175 = arith.ceildivsi %172#1, %c128_i32_316 : i32
      %shape_317 = cute.make_shape(%173, %175) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_318 = cute.assume(%172#2) : (i64) -> !cute.i64<divby 8>
      %iv_319 = cute.assume(%174) : (i64) -> !cute.i64<divby 512>
      %stride_320 = cute.make_stride(%iv_318, %iv_319) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_321 = cute.make_layout(%shape_317, %stride_320) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %176:4 = cute.get_scalars(%lay_321) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_322 = cute.make_shape(%176#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_323 = cute.assume(%176#2) : (i64) -> !cute.i64<divby 8>
      %iv_324 = cute.assume(%176#3) : (i64) -> !cute.i64<divby 512>
      %stride_325 = cute.make_stride(%iv_323, %iv_324) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_326 = cute.make_layout(%shape_322, %stride_325) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_327 = cute.crd2idx(%coord_312, %lay_321) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_328 = cute.get_iter(%view_308) : !memref_gmem_bf16_1
      %ptr_329 = cute.add_offset(%iter_328, %idx_327) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_330 = cute.make_view(%ptr_329, %lay_326) : !memref_gmem_bf16_3
      %iter_331 = cute.get_iter(%view_330) : !memref_gmem_bf16_3
      %coord_332 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_333 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %177:7 = cute.get_scalars(%lay_333) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %178:2 = cute.get_scalars(%coord_332) <{only_dynamic}> : !cute.coord<"(?,?,_,_)">
      %iv_334 = cute.assume(%177#3) : (i32) -> !cute.i32<divby 8>
      %shape_335 = cute.make_shape(%177#2, %iv_334) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_336 = cute.assume(%177#6) : (i64) -> !cute.i64<divby 8>
      %stride_337 = cute.make_stride(%iv_336) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_338 = cute.make_layout(%shape_335, %stride_337) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_339 = cute.crd2idx(%coord_332, %lay_333) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_340 = cute.get_iter(%arg4) : !memref_gmem_bf16_
      %ptr_341 = cute.add_offset(%iter_340, %idx_339) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_342 = cute.make_view(%ptr_341, %lay_338) : !memref_gmem_bf16_1
      %iter_343 = cute.get_iter(%view_342) : !memref_gmem_bf16_1
      %tile_344 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_345 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %179 = cute.get_scalars(%coord_345) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_346 = cute.make_coord(%179) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_347 = cute.get_layout(%view_342) : !memref_gmem_bf16_1
      %180:3 = cute.get_scalars(%lay_347) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_348 = arith.constant 64 : i32
      %181 = arith.ceildivsi %180#0, %c64_i32_348 : i32
      %c64_i64_349 = arith.constant 64 : i64
      %182 = arith.muli %180#2, %c64_i64_349 : i64
      %c64_i32_350 = arith.constant 64 : i32
      %183 = arith.ceildivsi %180#1, %c64_i32_350 : i32
      %shape_351 = cute.make_shape(%181, %183) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %iv_352 = cute.assume(%180#2) : (i64) -> !cute.i64<divby 8>
      %iv_353 = cute.assume(%182) : (i64) -> !cute.i64<divby 512>
      %stride_354 = cute.make_stride(%iv_352, %iv_353) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},64))">
      %lay_355 = cute.make_layout(%shape_351, %stride_354) : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">
      %184:4 = cute.get_scalars(%lay_355) <{only_dynamic}> : !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">
      %185 = cute.get_scalars(%coord_346) <{only_dynamic}> : !cute.coord<"((_,_),(?,_))">
      %shape_356 = cute.make_shape(%184#1) : (i32) -> !cute.shape<"(64,64,?)">
      %iv_357 = cute.assume(%184#2) : (i64) -> !cute.i64<divby 8>
      %stride_358 = cute.make_stride(%iv_357) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1,64)">
      %lay_359 = cute.make_layout(%shape_356, %stride_358) : !cute.layout<"(64,64,?):(?{i64 div=8},1,64)">
      %idx_360 = cute.crd2idx(%coord_346, %lay_355) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((?{i64 div=8},1),(?{i64 div=512},64))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_361 = cute.get_iter(%view_342) : !memref_gmem_bf16_1
      %ptr_362 = cute.add_offset(%iter_361, %idx_360) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_363 = cute.make_view(%ptr_362, %lay_359) : !memref_gmem_bf16_4
      %iter_364 = cute.get_iter(%view_363) : !memref_gmem_bf16_4
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_365 = cute.make_int_tuple() : () -> !cute.int_tuple<"57344">
      %ptr_366 = cute.add_offset(%smem_ptr, %int_tuple_365) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"57344">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c57344_i32 = arith.constant 57344 : i32
      %186 = arith.cmpi sge, %smem_size, %c57344_i32 : i32
      %int_tuple_367 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_368 = cute.add_offset(%smem_ptr, %int_tuple_367) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_369 = cute.make_int_tuple() : () -> !cute.int_tuple<"16384">
      %ptr_370 = cute.add_offset(%smem_ptr, %int_tuple_369) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"16384">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_371 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_372 = cute.add_offset(%smem_ptr, %int_tuple_371) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_373 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_374 = cute.add_offset(%smem_ptr, %int_tuple_373) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_375 = cute.recast_iter(%ptr_368) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_376 = cute.make_view(%iter_375, %0) : !memref_smem_bf16_
      %iter_377 = cute.get_iter(%view_376) : !memref_smem_bf16_
      %iter_378 = cute.recast_iter(%ptr_370) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_379 = cute.make_view(%iter_378, %1) : !memref_smem_bf16_
      %iter_380 = cute.get_iter(%view_379) : !memref_smem_bf16_
      %iter_381 = cute.recast_iter(%ptr_372) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_382 = cute.make_view(%iter_381, %1) : !memref_smem_bf16_
      %iter_383 = cute.get_iter(%view_382) : !memref_smem_bf16_
      %iter_384 = cute.recast_iter(%ptr_374) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_385 = cute.make_view(%iter_384, %2) : !memref_smem_bf16_1
      %iter_386 = cute.get_iter(%view_385) : !memref_smem_bf16_1
      %shape_387 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_388 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_389 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_390 = cute.get_iter(%view_382) : !memref_smem_bf16_
      %view_391 = cute.make_view(%iter_390) : !memref_smem_bf16_2
      %iter_392 = cute.get_iter(%view_391) : !memref_smem_bf16_2
      %coord_393 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_394 = cute.get_iter(%view_262) : !memref_gmem_bf16_2
      %lay_395 = cute.get_layout(%view_262) : !memref_gmem_bf16_2
      %187 = cute.get_scalars(%lay_395) <{only_dynamic}> : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %188 = cute.get_scalars(%coord_393) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64 = arith.constant 16 : i64
      %189 = arith.muli %187, %c16_i64 : i64
      %c128_i64 = arith.constant 128 : i64
      %190 = arith.muli %187, %c128_i64 : i64
      %c16_i64_396 = arith.constant 16 : i64
      %191 = arith.muli %187, %c16_i64_396 : i64
      %c8_i32 = arith.constant 8 : i32
      %192 = arith.divsi %188, %c8_i32 : i32
      %c8_i32_397 = arith.constant 8 : i32
      %193 = arith.remsi %188, %c8_i32_397 : i32
      %c8_i32_398 = arith.constant 8 : i32
      %194 = arith.muli %193, %c8_i32_398 : i32
      %195 = arith.extsi %192 : i32 to i64
      %196 = arith.muli %195, %187 : i64
      %197 = arith.extsi %194 : i32 to i64
      %198 = arith.addi %197, %196 : i64
      %iv_399 = cute.assume(%198) : (i64) -> !cute.i64<divby 8>
      %int_tuple_400 = cute.make_int_tuple(%iv_399) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_401 = cute.add_offset(%iter_394, %int_tuple_400) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_402 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
      %iv_403 = cute.assume(%189) : (i64) -> !cute.i64<divby 128>
      %stride_404 = cute.make_stride(%iv_403) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_405 = cute.make_layout(%shape_402, %stride_404) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
      %view_406 = cute.make_view(%ptr_401, %lay_405) : !memref_gmem_bf16_5
      %iter_407 = cute.get_iter(%view_406) : !memref_gmem_bf16_5
      %coord_408 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_409 = cute.get_iter(%view_376) : !memref_smem_bf16_
      %199 = cute.get_scalars(%coord_408) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_410 = arith.constant 8 : i32
      %200 = arith.divsi %199, %c8_i32_410 : i32
      %c8_i32_411 = arith.constant 8 : i32
      %201 = arith.remsi %199, %c8_i32_411 : i32
      %c2_i32 = arith.constant 2 : i32
      %202 = arith.divsi %201, %c2_i32 : i32
      %c2_i32_412 = arith.constant 2 : i32
      %203 = arith.remsi %201, %c2_i32_412 : i32
      %c16_i32 = arith.constant 16 : i32
      %204 = arith.muli %202, %c16_i32 : i32
      %c64_i32_413 = arith.constant 64 : i32
      %205 = arith.muli %200, %c64_i32_413 : i32
      %206 = arith.addi %204, %205 : i32
      %c0_i32 = arith.constant 0 : i32
      %207 = arith.xori %206, %c0_i32 : i32
      %c8_i32_414 = arith.constant 8 : i32
      %208 = arith.divsi %199, %c8_i32_414 : i32
      %c8_i32_415 = arith.constant 8 : i32
      %209 = arith.remsi %199, %c8_i32_415 : i32
      %c2_i32_416 = arith.constant 2 : i32
      %210 = arith.divsi %209, %c2_i32_416 : i32
      %c2_i32_417 = arith.constant 2 : i32
      %211 = arith.remsi %209, %c2_i32_417 : i32
      %c8_i32_418 = arith.constant 8 : i32
      %212 = arith.muli %211, %c8_i32_418 : i32
      %c128_i32_419 = arith.constant 128 : i32
      %213 = arith.andi %207, %c128_i32_419 : i32
      %c0_i32_420 = arith.constant 0 : i32
      %214 = arith.cmpi eq, %213, %c0_i32_420 : i32
      %215 = scf.if %214 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32 = arith.constant 256 : i32
      %216 = arith.andi %207, %c256_i32 : i32
      %c0_i32_421 = arith.constant 0 : i32
      %217 = arith.cmpi eq, %216, %c0_i32_421 : i32
      %218 = scf.if %217 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32 = arith.constant 512 : i32
      %219 = arith.andi %207, %c512_i32 : i32
      %c0_i32_422 = arith.constant 0 : i32
      %220 = arith.cmpi eq, %219, %c0_i32_422 : i32
      %221 = scf.if %220 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_423 = arith.constant 16 : i32
      %222 = arith.andi %207, %c16_i32_423 : i32
      %c0_i32_424 = arith.constant 0 : i32
      %223 = arith.cmpi eq, %222, %c0_i32_424 : i32
      %224 = scf.if %223 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32 = arith.constant 32 : i32
      %225 = arith.andi %207, %c32_i32 : i32
      %c0_i32_425 = arith.constant 0 : i32
      %226 = arith.cmpi eq, %225, %c0_i32_425 : i32
      %227 = scf.if %226 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_426 = arith.constant 64 : i32
      %228 = arith.andi %207, %c64_i32_426 : i32
      %c0_i32_427 = arith.constant 0 : i32
      %229 = arith.cmpi eq, %228, %c0_i32_427 : i32
      %230 = scf.if %229 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32 = arith.constant 896 : i32
      %231 = arith.andi %207, %c896_i32 : i32
      %c3_i32 = arith.constant 3 : i32
      %232 = arith.shrsi %231, %c3_i32 : i32
      %233 = arith.xori %207, %232 : i32
      %234 = arith.addi %233, %212 : i32
      %c64_i32_428 = arith.constant 64 : i32
      %235 = arith.muli %215, %c64_i32_428 : i32
      %c32_i32_429 = arith.constant 32 : i32
      %236 = arith.muli %218, %c32_i32_429 : i32
      %c16_i32_430 = arith.constant 16 : i32
      %237 = arith.muli %221, %c16_i32_430 : i32
      %c8_i32_431 = arith.constant 8 : i32
      %238 = arith.muli %224, %c8_i32_431 : i32
      %c4_i32 = arith.constant 4 : i32
      %239 = arith.muli %227, %c4_i32 : i32
      %c2_i32_432 = arith.constant 2 : i32
      %240 = arith.muli %230, %c2_i32_432 : i32
      %c256_i32_433 = arith.constant 256 : i32
      %241 = arith.muli %215, %c256_i32_433 : i32
      %c128_i32_434 = arith.constant 128 : i32
      %242 = arith.muli %218, %c128_i32_434 : i32
      %c64_i32_435 = arith.constant 64 : i32
      %243 = arith.muli %221, %c64_i32_435 : i32
      %c32_i32_436 = arith.constant 32 : i32
      %244 = arith.muli %224, %c32_i32_436 : i32
      %c16_i32_437 = arith.constant 16 : i32
      %245 = arith.muli %227, %c16_i32_437 : i32
      %c8_i32_438 = arith.constant 8 : i32
      %246 = arith.muli %230, %c8_i32_438 : i32
      %iv_439 = cute.assume(%234) : (i32) -> !cute.i32<divby 8>
      %int_tuple_440 = cute.make_int_tuple(%iv_439) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_441 = cute.add_offset(%iter_409, %int_tuple_440) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_442 = cute.make_view(%ptr_441) : !memref_smem_bf16_3
      %iter_443 = cute.get_iter(%view_442) : !memref_smem_bf16_3
      %coord_444 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_445 = cute.get_iter(%view_296) : !memref_gmem_bf16_3
      %lay_446 = cute.get_layout(%view_296) : !memref_gmem_bf16_3
      %247:3 = cute.get_scalars(%lay_446) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %248 = cute.get_scalars(%coord_444) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_447 = arith.constant 16 : i64
      %249 = arith.muli %247#1, %c16_i64_447 : i64
      %c128_i64_448 = arith.constant 128 : i64
      %250 = arith.muli %247#1, %c128_i64_448 : i64
      %c16_i64_449 = arith.constant 16 : i64
      %251 = arith.muli %247#1, %c16_i64_449 : i64
      %c8_i32_450 = arith.constant 8 : i32
      %252 = arith.divsi %248, %c8_i32_450 : i32
      %c8_i32_451 = arith.constant 8 : i32
      %253 = arith.remsi %248, %c8_i32_451 : i32
      %c8_i32_452 = arith.constant 8 : i32
      %254 = arith.muli %253, %c8_i32_452 : i32
      %255 = arith.extsi %252 : i32 to i64
      %256 = arith.muli %255, %247#1 : i64
      %257 = arith.extsi %254 : i32 to i64
      %258 = arith.addi %257, %256 : i64
      %iv_453 = cute.assume(%258) : (i64) -> !cute.i64<divby 8>
      %int_tuple_454 = cute.make_int_tuple(%iv_453) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_455 = cute.add_offset(%iter_445, %int_tuple_454) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_456 = cute.make_shape(%247#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_457 = cute.assume(%249) : (i64) -> !cute.i64<divby 128>
      %iv_458 = cute.assume(%247#2) : (i64) -> !cute.i64<divby 512>
      %stride_459 = cute.make_stride(%iv_457, %iv_458) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_460 = cute.make_layout(%shape_456, %stride_459) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_461 = cute.make_view(%ptr_455, %lay_460) : !memref_gmem_bf16_6
      %iter_462 = cute.get_iter(%view_461) : !memref_gmem_bf16_6
      %coord_463 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_464 = cute.get_iter(%view_379) : !memref_smem_bf16_
      %259 = cute.get_scalars(%coord_463) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_465 = arith.constant 8 : i32
      %260 = arith.divsi %259, %c8_i32_465 : i32
      %c8_i32_466 = arith.constant 8 : i32
      %261 = arith.remsi %259, %c8_i32_466 : i32
      %c2_i32_467 = arith.constant 2 : i32
      %262 = arith.divsi %261, %c2_i32_467 : i32
      %c2_i32_468 = arith.constant 2 : i32
      %263 = arith.remsi %261, %c2_i32_468 : i32
      %c16_i32_469 = arith.constant 16 : i32
      %264 = arith.muli %262, %c16_i32_469 : i32
      %c64_i32_470 = arith.constant 64 : i32
      %265 = arith.muli %260, %c64_i32_470 : i32
      %266 = arith.addi %264, %265 : i32
      %c0_i32_471 = arith.constant 0 : i32
      %267 = arith.xori %266, %c0_i32_471 : i32
      %c8_i32_472 = arith.constant 8 : i32
      %268 = arith.divsi %259, %c8_i32_472 : i32
      %c8_i32_473 = arith.constant 8 : i32
      %269 = arith.remsi %259, %c8_i32_473 : i32
      %c2_i32_474 = arith.constant 2 : i32
      %270 = arith.divsi %269, %c2_i32_474 : i32
      %c2_i32_475 = arith.constant 2 : i32
      %271 = arith.remsi %269, %c2_i32_475 : i32
      %c8_i32_476 = arith.constant 8 : i32
      %272 = arith.muli %271, %c8_i32_476 : i32
      %c128_i32_477 = arith.constant 128 : i32
      %273 = arith.andi %267, %c128_i32_477 : i32
      %c0_i32_478 = arith.constant 0 : i32
      %274 = arith.cmpi eq, %273, %c0_i32_478 : i32
      %275 = scf.if %274 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_479 = arith.constant 256 : i32
      %276 = arith.andi %267, %c256_i32_479 : i32
      %c0_i32_480 = arith.constant 0 : i32
      %277 = arith.cmpi eq, %276, %c0_i32_480 : i32
      %278 = scf.if %277 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_481 = arith.constant 512 : i32
      %279 = arith.andi %267, %c512_i32_481 : i32
      %c0_i32_482 = arith.constant 0 : i32
      %280 = arith.cmpi eq, %279, %c0_i32_482 : i32
      %281 = scf.if %280 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_483 = arith.constant 16 : i32
      %282 = arith.andi %267, %c16_i32_483 : i32
      %c0_i32_484 = arith.constant 0 : i32
      %283 = arith.cmpi eq, %282, %c0_i32_484 : i32
      %284 = scf.if %283 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_485 = arith.constant 32 : i32
      %285 = arith.andi %267, %c32_i32_485 : i32
      %c0_i32_486 = arith.constant 0 : i32
      %286 = arith.cmpi eq, %285, %c0_i32_486 : i32
      %287 = scf.if %286 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_487 = arith.constant 64 : i32
      %288 = arith.andi %267, %c64_i32_487 : i32
      %c0_i32_488 = arith.constant 0 : i32
      %289 = arith.cmpi eq, %288, %c0_i32_488 : i32
      %290 = scf.if %289 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_489 = arith.constant 896 : i32
      %291 = arith.andi %267, %c896_i32_489 : i32
      %c3_i32_490 = arith.constant 3 : i32
      %292 = arith.shrsi %291, %c3_i32_490 : i32
      %293 = arith.xori %267, %292 : i32
      %294 = arith.addi %293, %272 : i32
      %c64_i32_491 = arith.constant 64 : i32
      %295 = arith.muli %275, %c64_i32_491 : i32
      %c32_i32_492 = arith.constant 32 : i32
      %296 = arith.muli %278, %c32_i32_492 : i32
      %c16_i32_493 = arith.constant 16 : i32
      %297 = arith.muli %281, %c16_i32_493 : i32
      %c8_i32_494 = arith.constant 8 : i32
      %298 = arith.muli %284, %c8_i32_494 : i32
      %c4_i32_495 = arith.constant 4 : i32
      %299 = arith.muli %287, %c4_i32_495 : i32
      %c2_i32_496 = arith.constant 2 : i32
      %300 = arith.muli %290, %c2_i32_496 : i32
      %c256_i32_497 = arith.constant 256 : i32
      %301 = arith.muli %275, %c256_i32_497 : i32
      %c128_i32_498 = arith.constant 128 : i32
      %302 = arith.muli %278, %c128_i32_498 : i32
      %c64_i32_499 = arith.constant 64 : i32
      %303 = arith.muli %281, %c64_i32_499 : i32
      %c32_i32_500 = arith.constant 32 : i32
      %304 = arith.muli %284, %c32_i32_500 : i32
      %c16_i32_501 = arith.constant 16 : i32
      %305 = arith.muli %287, %c16_i32_501 : i32
      %c8_i32_502 = arith.constant 8 : i32
      %306 = arith.muli %290, %c8_i32_502 : i32
      %iv_503 = cute.assume(%294) : (i32) -> !cute.i32<divby 8>
      %int_tuple_504 = cute.make_int_tuple(%iv_503) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_505 = cute.add_offset(%iter_464, %int_tuple_504) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_506 = cute.make_view(%ptr_505) : !memref_smem_bf16_3
      %iter_507 = cute.get_iter(%view_506) : !memref_smem_bf16_3
      %coord_508 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_509 = cute.get_iter(%view_330) : !memref_gmem_bf16_3
      %lay_510 = cute.get_layout(%view_330) : !memref_gmem_bf16_3
      %307:3 = cute.get_scalars(%lay_510) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %308 = cute.get_scalars(%coord_508) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_511 = arith.constant 16 : i64
      %309 = arith.muli %307#1, %c16_i64_511 : i64
      %c128_i64_512 = arith.constant 128 : i64
      %310 = arith.muli %307#1, %c128_i64_512 : i64
      %c16_i64_513 = arith.constant 16 : i64
      %311 = arith.muli %307#1, %c16_i64_513 : i64
      %c8_i32_514 = arith.constant 8 : i32
      %312 = arith.divsi %308, %c8_i32_514 : i32
      %c8_i32_515 = arith.constant 8 : i32
      %313 = arith.remsi %308, %c8_i32_515 : i32
      %c8_i32_516 = arith.constant 8 : i32
      %314 = arith.muli %313, %c8_i32_516 : i32
      %315 = arith.extsi %312 : i32 to i64
      %316 = arith.muli %315, %307#1 : i64
      %317 = arith.extsi %314 : i32 to i64
      %318 = arith.addi %317, %316 : i64
      %iv_517 = cute.assume(%318) : (i64) -> !cute.i64<divby 8>
      %int_tuple_518 = cute.make_int_tuple(%iv_517) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_519 = cute.add_offset(%iter_509, %int_tuple_518) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_520 = cute.make_shape(%307#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_521 = cute.assume(%309) : (i64) -> !cute.i64<divby 128>
      %iv_522 = cute.assume(%307#2) : (i64) -> !cute.i64<divby 512>
      %stride_523 = cute.make_stride(%iv_521, %iv_522) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_524 = cute.make_layout(%shape_520, %stride_523) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_525 = cute.make_view(%ptr_519, %lay_524) : !memref_gmem_bf16_6
      %iter_526 = cute.get_iter(%view_525) : !memref_gmem_bf16_6
      %coord_527 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_528 = cute.get_iter(%view_382) : !memref_smem_bf16_
      %319 = cute.get_scalars(%coord_527) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_529 = arith.constant 8 : i32
      %320 = arith.divsi %319, %c8_i32_529 : i32
      %c8_i32_530 = arith.constant 8 : i32
      %321 = arith.remsi %319, %c8_i32_530 : i32
      %c2_i32_531 = arith.constant 2 : i32
      %322 = arith.divsi %321, %c2_i32_531 : i32
      %c2_i32_532 = arith.constant 2 : i32
      %323 = arith.remsi %321, %c2_i32_532 : i32
      %c16_i32_533 = arith.constant 16 : i32
      %324 = arith.muli %322, %c16_i32_533 : i32
      %c64_i32_534 = arith.constant 64 : i32
      %325 = arith.muli %320, %c64_i32_534 : i32
      %326 = arith.addi %324, %325 : i32
      %c0_i32_535 = arith.constant 0 : i32
      %327 = arith.xori %326, %c0_i32_535 : i32
      %c8_i32_536 = arith.constant 8 : i32
      %328 = arith.divsi %319, %c8_i32_536 : i32
      %c8_i32_537 = arith.constant 8 : i32
      %329 = arith.remsi %319, %c8_i32_537 : i32
      %c2_i32_538 = arith.constant 2 : i32
      %330 = arith.divsi %329, %c2_i32_538 : i32
      %c2_i32_539 = arith.constant 2 : i32
      %331 = arith.remsi %329, %c2_i32_539 : i32
      %c8_i32_540 = arith.constant 8 : i32
      %332 = arith.muli %331, %c8_i32_540 : i32
      %c128_i32_541 = arith.constant 128 : i32
      %333 = arith.andi %327, %c128_i32_541 : i32
      %c0_i32_542 = arith.constant 0 : i32
      %334 = arith.cmpi eq, %333, %c0_i32_542 : i32
      %335 = scf.if %334 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_543 = arith.constant 256 : i32
      %336 = arith.andi %327, %c256_i32_543 : i32
      %c0_i32_544 = arith.constant 0 : i32
      %337 = arith.cmpi eq, %336, %c0_i32_544 : i32
      %338 = scf.if %337 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_545 = arith.constant 512 : i32
      %339 = arith.andi %327, %c512_i32_545 : i32
      %c0_i32_546 = arith.constant 0 : i32
      %340 = arith.cmpi eq, %339, %c0_i32_546 : i32
      %341 = scf.if %340 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_547 = arith.constant 16 : i32
      %342 = arith.andi %327, %c16_i32_547 : i32
      %c0_i32_548 = arith.constant 0 : i32
      %343 = arith.cmpi eq, %342, %c0_i32_548 : i32
      %344 = scf.if %343 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_549 = arith.constant 32 : i32
      %345 = arith.andi %327, %c32_i32_549 : i32
      %c0_i32_550 = arith.constant 0 : i32
      %346 = arith.cmpi eq, %345, %c0_i32_550 : i32
      %347 = scf.if %346 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_551 = arith.constant 64 : i32
      %348 = arith.andi %327, %c64_i32_551 : i32
      %c0_i32_552 = arith.constant 0 : i32
      %349 = arith.cmpi eq, %348, %c0_i32_552 : i32
      %350 = scf.if %349 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_553 = arith.constant 896 : i32
      %351 = arith.andi %327, %c896_i32_553 : i32
      %c3_i32_554 = arith.constant 3 : i32
      %352 = arith.shrsi %351, %c3_i32_554 : i32
      %353 = arith.xori %327, %352 : i32
      %354 = arith.addi %353, %332 : i32
      %c64_i32_555 = arith.constant 64 : i32
      %355 = arith.muli %335, %c64_i32_555 : i32
      %c32_i32_556 = arith.constant 32 : i32
      %356 = arith.muli %338, %c32_i32_556 : i32
      %c16_i32_557 = arith.constant 16 : i32
      %357 = arith.muli %341, %c16_i32_557 : i32
      %c8_i32_558 = arith.constant 8 : i32
      %358 = arith.muli %344, %c8_i32_558 : i32
      %c4_i32_559 = arith.constant 4 : i32
      %359 = arith.muli %347, %c4_i32_559 : i32
      %c2_i32_560 = arith.constant 2 : i32
      %360 = arith.muli %350, %c2_i32_560 : i32
      %c256_i32_561 = arith.constant 256 : i32
      %361 = arith.muli %335, %c256_i32_561 : i32
      %c128_i32_562 = arith.constant 128 : i32
      %362 = arith.muli %338, %c128_i32_562 : i32
      %c64_i32_563 = arith.constant 64 : i32
      %363 = arith.muli %341, %c64_i32_563 : i32
      %c32_i32_564 = arith.constant 32 : i32
      %364 = arith.muli %344, %c32_i32_564 : i32
      %c16_i32_565 = arith.constant 16 : i32
      %365 = arith.muli %347, %c16_i32_565 : i32
      %c8_i32_566 = arith.constant 8 : i32
      %366 = arith.muli %350, %c8_i32_566 : i32
      %iv_567 = cute.assume(%354) : (i32) -> !cute.i32<divby 8>
      %int_tuple_568 = cute.make_int_tuple(%iv_567) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_569 = cute.add_offset(%iter_528, %int_tuple_568) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_570 = cute.make_view(%ptr_569) : !memref_smem_bf16_3
      %iter_571 = cute.get_iter(%view_570) : !memref_smem_bf16_3
      %coord_572 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_573 = cute.get_iter(%view_363) : !memref_gmem_bf16_4
      %lay_574 = cute.get_layout(%view_363) : !memref_gmem_bf16_4
      %367:2 = cute.get_scalars(%lay_574) <{only_dynamic}> : !cute.layout<"(64,64,?):(?{i64 div=8},1,64)">
      %368 = cute.get_scalars(%coord_572) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_575 = arith.constant 16 : i64
      %369 = arith.muli %367#1, %c16_i64_575 : i64
      %c128_i64_576 = arith.constant 128 : i64
      %370 = arith.muli %367#1, %c128_i64_576 : i64
      %c16_i64_577 = arith.constant 16 : i64
      %371 = arith.muli %367#1, %c16_i64_577 : i64
      %c8_i32_578 = arith.constant 8 : i32
      %372 = arith.divsi %368, %c8_i32_578 : i32
      %c8_i32_579 = arith.constant 8 : i32
      %373 = arith.remsi %368, %c8_i32_579 : i32
      %c8_i32_580 = arith.constant 8 : i32
      %374 = arith.muli %373, %c8_i32_580 : i32
      %375 = arith.extsi %372 : i32 to i64
      %376 = arith.muli %375, %367#1 : i64
      %377 = arith.extsi %374 : i32 to i64
      %378 = arith.addi %377, %376 : i64
      %iv_581 = cute.assume(%378) : (i64) -> !cute.i64<divby 8>
      %int_tuple_582 = cute.make_int_tuple(%iv_581) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_583 = cute.add_offset(%iter_573, %int_tuple_582) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_584 = cute.make_shape(%367#0) : (i32) -> !cute.shape<"((8,1),4,1,?)">
      %iv_585 = cute.assume(%369) : (i64) -> !cute.i64<divby 128>
      %stride_586 = cute.make_stride(%iv_585) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},0,64)">
      %lay_587 = cute.make_layout(%shape_584, %stride_586) : !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">
      %view_588 = cute.make_view(%ptr_583, %lay_587) : !memref_gmem_bf16_7
      %iter_589 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
      %coord_590 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_591 = cute.get_iter(%view_385) : !memref_smem_bf16_1
      %379 = cute.get_scalars(%coord_590) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_592 = arith.constant 8 : i32
      %380 = arith.divsi %379, %c8_i32_592 : i32
      %c8_i32_593 = arith.constant 8 : i32
      %381 = arith.remsi %379, %c8_i32_593 : i32
      %c2_i32_594 = arith.constant 2 : i32
      %382 = arith.divsi %381, %c2_i32_594 : i32
      %c2_i32_595 = arith.constant 2 : i32
      %383 = arith.remsi %381, %c2_i32_595 : i32
      %c16_i32_596 = arith.constant 16 : i32
      %384 = arith.muli %382, %c16_i32_596 : i32
      %c64_i32_597 = arith.constant 64 : i32
      %385 = arith.muli %380, %c64_i32_597 : i32
      %386 = arith.addi %384, %385 : i32
      %c0_i32_598 = arith.constant 0 : i32
      %387 = arith.xori %386, %c0_i32_598 : i32
      %c8_i32_599 = arith.constant 8 : i32
      %388 = arith.divsi %379, %c8_i32_599 : i32
      %c8_i32_600 = arith.constant 8 : i32
      %389 = arith.remsi %379, %c8_i32_600 : i32
      %c2_i32_601 = arith.constant 2 : i32
      %390 = arith.divsi %389, %c2_i32_601 : i32
      %c2_i32_602 = arith.constant 2 : i32
      %391 = arith.remsi %389, %c2_i32_602 : i32
      %c8_i32_603 = arith.constant 8 : i32
      %392 = arith.muli %391, %c8_i32_603 : i32
      %c128_i32_604 = arith.constant 128 : i32
      %393 = arith.andi %387, %c128_i32_604 : i32
      %c0_i32_605 = arith.constant 0 : i32
      %394 = arith.cmpi eq, %393, %c0_i32_605 : i32
      %395 = scf.if %394 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_606 = arith.constant 256 : i32
      %396 = arith.andi %387, %c256_i32_606 : i32
      %c0_i32_607 = arith.constant 0 : i32
      %397 = arith.cmpi eq, %396, %c0_i32_607 : i32
      %398 = scf.if %397 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_608 = arith.constant 512 : i32
      %399 = arith.andi %387, %c512_i32_608 : i32
      %c0_i32_609 = arith.constant 0 : i32
      %400 = arith.cmpi eq, %399, %c0_i32_609 : i32
      %401 = scf.if %400 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_610 = arith.constant 16 : i32
      %402 = arith.andi %387, %c16_i32_610 : i32
      %c0_i32_611 = arith.constant 0 : i32
      %403 = arith.cmpi eq, %402, %c0_i32_611 : i32
      %404 = scf.if %403 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_612 = arith.constant 32 : i32
      %405 = arith.andi %387, %c32_i32_612 : i32
      %c0_i32_613 = arith.constant 0 : i32
      %406 = arith.cmpi eq, %405, %c0_i32_613 : i32
      %407 = scf.if %406 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_614 = arith.constant 64 : i32
      %408 = arith.andi %387, %c64_i32_614 : i32
      %c0_i32_615 = arith.constant 0 : i32
      %409 = arith.cmpi eq, %408, %c0_i32_615 : i32
      %410 = scf.if %409 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_616 = arith.constant 896 : i32
      %411 = arith.andi %387, %c896_i32_616 : i32
      %c3_i32_617 = arith.constant 3 : i32
      %412 = arith.shrsi %411, %c3_i32_617 : i32
      %413 = arith.xori %387, %412 : i32
      %414 = arith.addi %413, %392 : i32
      %c64_i32_618 = arith.constant 64 : i32
      %415 = arith.muli %395, %c64_i32_618 : i32
      %c32_i32_619 = arith.constant 32 : i32
      %416 = arith.muli %398, %c32_i32_619 : i32
      %c16_i32_620 = arith.constant 16 : i32
      %417 = arith.muli %401, %c16_i32_620 : i32
      %c8_i32_621 = arith.constant 8 : i32
      %418 = arith.muli %404, %c8_i32_621 : i32
      %c4_i32_622 = arith.constant 4 : i32
      %419 = arith.muli %407, %c4_i32_622 : i32
      %c2_i32_623 = arith.constant 2 : i32
      %420 = arith.muli %410, %c2_i32_623 : i32
      %iv_624 = cute.assume(%414) : (i32) -> !cute.i32<divby 8>
      %int_tuple_625 = cute.make_int_tuple(%iv_624) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_626 = cute.add_offset(%iter_591, %int_tuple_625) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_627 = cute.make_view(%ptr_626) : !memref_smem_bf16_4
      %iter_628 = cute.get_iter(%view_627) : !memref_smem_bf16_4
      %coord_629 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_630 = cute.get_iter(%view_376) : !memref_smem_bf16_
      %421 = cute.get_scalars(%coord_629) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_631 = arith.constant 32 : i32
      %422 = arith.remsi %421, %c32_i32_631 : i32
      %c32_i32_632 = arith.constant 32 : i32
      %423 = arith.divsi %421, %c32_i32_632 : i32
      %c4_i32_633 = arith.constant 4 : i32
      %424 = arith.remsi %423, %c4_i32_633 : i32
      %c32_i32_634 = arith.constant 32 : i32
      %425 = arith.remsi %422, %c32_i32_634 : i32
      %c4_i32_635 = arith.constant 4 : i32
      %426 = arith.remsi %424, %c4_i32_635 : i32
      %c4_i32_636 = arith.constant 4 : i32
      %427 = arith.divsi %425, %c4_i32_636 : i32
      %c4_i32_637 = arith.constant 4 : i32
      %428 = arith.remsi %425, %c4_i32_637 : i32
      %c64_i32_638 = arith.constant 64 : i32
      %429 = arith.muli %427, %c64_i32_638 : i32
      %c0_i32_639 = arith.constant 0 : i32
      %430 = arith.xori %429, %c0_i32_639 : i32
      %c4_i32_640 = arith.constant 4 : i32
      %431 = arith.divsi %425, %c4_i32_640 : i32
      %c4_i32_641 = arith.constant 4 : i32
      %432 = arith.remsi %425, %c4_i32_641 : i32
      %c2_i32_642 = arith.constant 2 : i32
      %433 = arith.muli %432, %c2_i32_642 : i32
      %c1024_i32 = arith.constant 1024 : i32
      %434 = arith.muli %426, %c1024_i32 : i32
      %435 = arith.addi %433, %434 : i32
      %c128_i32_643 = arith.constant 128 : i32
      %436 = arith.andi %430, %c128_i32_643 : i32
      %c0_i32_644 = arith.constant 0 : i32
      %437 = arith.cmpi eq, %436, %c0_i32_644 : i32
      %438 = scf.if %437 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_645 = arith.constant 256 : i32
      %439 = arith.andi %430, %c256_i32_645 : i32
      %c0_i32_646 = arith.constant 0 : i32
      %440 = arith.cmpi eq, %439, %c0_i32_646 : i32
      %441 = scf.if %440 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_647 = arith.constant 512 : i32
      %442 = arith.andi %430, %c512_i32_647 : i32
      %c0_i32_648 = arith.constant 0 : i32
      %443 = arith.cmpi eq, %442, %c0_i32_648 : i32
      %444 = scf.if %443 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_649 = arith.constant 16 : i32
      %445 = arith.andi %430, %c16_i32_649 : i32
      %c0_i32_650 = arith.constant 0 : i32
      %446 = arith.cmpi eq, %445, %c0_i32_650 : i32
      %447 = scf.if %446 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_651 = arith.constant 32 : i32
      %448 = arith.andi %430, %c32_i32_651 : i32
      %c0_i32_652 = arith.constant 0 : i32
      %449 = arith.cmpi eq, %448, %c0_i32_652 : i32
      %450 = scf.if %449 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_653 = arith.constant 64 : i32
      %451 = arith.andi %430, %c64_i32_653 : i32
      %c0_i32_654 = arith.constant 0 : i32
      %452 = arith.cmpi eq, %451, %c0_i32_654 : i32
      %453 = scf.if %452 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_655 = arith.constant 896 : i32
      %454 = arith.andi %430, %c896_i32_655 : i32
      %c3_i32_656 = arith.constant 3 : i32
      %455 = arith.shrsi %454, %c3_i32_656 : i32
      %456 = arith.xori %430, %455 : i32
      %457 = arith.addi %456, %435 : i32
      %c32_i32_657 = arith.constant 32 : i32
      %458 = arith.muli %438, %c32_i32_657 : i32
      %c16_i32_658 = arith.constant 16 : i32
      %459 = arith.muli %441, %c16_i32_658 : i32
      %c8_i32_659 = arith.constant 8 : i32
      %460 = arith.muli %444, %c8_i32_659 : i32
      %c4_i32_660 = arith.constant 4 : i32
      %461 = arith.muli %447, %c4_i32_660 : i32
      %c2_i32_661 = arith.constant 2 : i32
      %462 = arith.muli %450, %c2_i32_661 : i32
      %c256_i32_662 = arith.constant 256 : i32
      %463 = arith.muli %438, %c256_i32_662 : i32
      %c128_i32_663 = arith.constant 128 : i32
      %464 = arith.muli %441, %c128_i32_663 : i32
      %c64_i32_664 = arith.constant 64 : i32
      %465 = arith.muli %444, %c64_i32_664 : i32
      %c32_i32_665 = arith.constant 32 : i32
      %466 = arith.muli %447, %c32_i32_665 : i32
      %c16_i32_666 = arith.constant 16 : i32
      %467 = arith.muli %450, %c16_i32_666 : i32
      %c8_i32_667 = arith.constant 8 : i32
      %468 = arith.muli %453, %c8_i32_667 : i32
      %iv_668 = cute.assume(%457) : (i32) -> !cute.i32<divby 2>
      %int_tuple_669 = cute.make_int_tuple(%iv_668) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_670 = cute.add_offset(%iter_630, %int_tuple_669) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_671 = cute.make_shape() : () -> !cute.shape<"((2,2,2),1,((2,2),2))">
      %iv_672 = cute.assume(%453) : (i32) -> !cute.i32<divby 64>
      %iv_673 = cute.assume(%438) : (i32) -> !cute.i32<divby 16>
      %iv_674 = cute.assume(%441) : (i32) -> !cute.i32<divby 32>
      %stride_675 = cute.make_stride(%iv_672, %iv_673, %iv_674) : (!cute.i32<divby 64>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
      %lay_676 = cute.make_layout(%shape_671, %stride_675) : !cute.layout<"((2,2,2),1,((2,2),2)):((1,?{div=64},8),0,((?{div=16},?{div=32}),4096))">
      %view_677 = cute.make_view(%ptr_670, %lay_676) : !memref_smem_bf16_5
      %iter_678 = cute.get_iter(%view_677) : !memref_smem_bf16_5
      %rmem = cute.memref.alloca() : !memref_rmem_bf16_
      %iter_679 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %coord_680 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_681 = cute.get_iter(%view_379) : !memref_smem_bf16_
      %469 = cute.get_scalars(%coord_680) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_682 = arith.constant 32 : i32
      %470 = arith.remsi %469, %c32_i32_682 : i32
      %c32_i32_683 = arith.constant 32 : i32
      %471 = arith.divsi %469, %c32_i32_683 : i32
      %c4_i32_684 = arith.constant 4 : i32
      %472 = arith.remsi %471, %c4_i32_684 : i32
      %c32_i32_685 = arith.constant 32 : i32
      %473 = arith.remsi %470, %c32_i32_685 : i32
      %c4_i32_686 = arith.constant 4 : i32
      %474 = arith.remsi %472, %c4_i32_686 : i32
      %c4_i32_687 = arith.constant 4 : i32
      %475 = arith.divsi %473, %c4_i32_687 : i32
      %c4_i32_688 = arith.constant 4 : i32
      %476 = arith.remsi %473, %c4_i32_688 : i32
      %c64_i32_689 = arith.constant 64 : i32
      %477 = arith.muli %475, %c64_i32_689 : i32
      %c0_i32_690 = arith.constant 0 : i32
      %478 = arith.xori %477, %c0_i32_690 : i32
      %c4_i32_691 = arith.constant 4 : i32
      %479 = arith.divsi %473, %c4_i32_691 : i32
      %c4_i32_692 = arith.constant 4 : i32
      %480 = arith.remsi %473, %c4_i32_692 : i32
      %c2_i32_693 = arith.constant 2 : i32
      %481 = arith.muli %480, %c2_i32_693 : i32
      %c128_i32_694 = arith.constant 128 : i32
      %482 = arith.andi %478, %c128_i32_694 : i32
      %c0_i32_695 = arith.constant 0 : i32
      %483 = arith.cmpi eq, %482, %c0_i32_695 : i32
      %484 = scf.if %483 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_696 = arith.constant 256 : i32
      %485 = arith.andi %478, %c256_i32_696 : i32
      %c0_i32_697 = arith.constant 0 : i32
      %486 = arith.cmpi eq, %485, %c0_i32_697 : i32
      %487 = scf.if %486 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_698 = arith.constant 512 : i32
      %488 = arith.andi %478, %c512_i32_698 : i32
      %c0_i32_699 = arith.constant 0 : i32
      %489 = arith.cmpi eq, %488, %c0_i32_699 : i32
      %490 = scf.if %489 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_700 = arith.constant 16 : i32
      %491 = arith.andi %478, %c16_i32_700 : i32
      %c0_i32_701 = arith.constant 0 : i32
      %492 = arith.cmpi eq, %491, %c0_i32_701 : i32
      %493 = scf.if %492 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_702 = arith.constant 32 : i32
      %494 = arith.andi %478, %c32_i32_702 : i32
      %c0_i32_703 = arith.constant 0 : i32
      %495 = arith.cmpi eq, %494, %c0_i32_703 : i32
      %496 = scf.if %495 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_704 = arith.constant 64 : i32
      %497 = arith.andi %478, %c64_i32_704 : i32
      %c0_i32_705 = arith.constant 0 : i32
      %498 = arith.cmpi eq, %497, %c0_i32_705 : i32
      %499 = scf.if %498 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_706 = arith.constant 896 : i32
      %500 = arith.andi %478, %c896_i32_706 : i32
      %c3_i32_707 = arith.constant 3 : i32
      %501 = arith.shrsi %500, %c3_i32_707 : i32
      %502 = arith.xori %478, %501 : i32
      %503 = arith.addi %502, %481 : i32
      %c32_i32_708 = arith.constant 32 : i32
      %504 = arith.muli %484, %c32_i32_708 : i32
      %c16_i32_709 = arith.constant 16 : i32
      %505 = arith.muli %487, %c16_i32_709 : i32
      %c8_i32_710 = arith.constant 8 : i32
      %506 = arith.muli %490, %c8_i32_710 : i32
      %c4_i32_711 = arith.constant 4 : i32
      %507 = arith.muli %493, %c4_i32_711 : i32
      %c2_i32_712 = arith.constant 2 : i32
      %508 = arith.muli %496, %c2_i32_712 : i32
      %c256_i32_713 = arith.constant 256 : i32
      %509 = arith.muli %484, %c256_i32_713 : i32
      %c128_i32_714 = arith.constant 128 : i32
      %510 = arith.muli %487, %c128_i32_714 : i32
      %c64_i32_715 = arith.constant 64 : i32
      %511 = arith.muli %490, %c64_i32_715 : i32
      %c32_i32_716 = arith.constant 32 : i32
      %512 = arith.muli %493, %c32_i32_716 : i32
      %c16_i32_717 = arith.constant 16 : i32
      %513 = arith.muli %496, %c16_i32_717 : i32
      %c8_i32_718 = arith.constant 8 : i32
      %514 = arith.muli %499, %c8_i32_718 : i32
      %iv_719 = cute.assume(%503) : (i32) -> !cute.i32<divby 2>
      %int_tuple_720 = cute.make_int_tuple(%iv_719) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_721 = cute.add_offset(%iter_681, %int_tuple_720) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_722 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,4),((2,2),2))">
      %iv_723 = cute.assume(%499) : (i32) -> !cute.i32<divby 64>
      %iv_724 = cute.assume(%484) : (i32) -> !cute.i32<divby 16>
      %iv_725 = cute.assume(%487) : (i32) -> !cute.i32<divby 32>
      %stride_726 = cute.make_stride(%iv_723, %iv_724, %iv_725) : (!cute.i32<divby 64>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
      %lay_727 = cute.make_layout(%shape_722, %stride_726) : !cute.layout<"((2,2),(2,4),((2,2),2)):((1,8),(?{div=64},1024),((?{div=16},?{div=32}),4096))">
      %view_728 = cute.make_view(%ptr_721, %lay_727) : !memref_smem_bf16_6
      %iter_729 = cute.get_iter(%view_728) : !memref_smem_bf16_6
      %rmem_730 = cute.memref.alloca() : !memref_rmem_bf16_1
      %iter_731 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
      %coord_732 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_733 = cute.get_iter(%view_391) : !memref_smem_bf16_2
      %515 = cute.get_scalars(%coord_732) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_734 = arith.constant 32 : i32
      %516 = arith.remsi %515, %c32_i32_734 : i32
      %c32_i32_735 = arith.constant 32 : i32
      %517 = arith.divsi %515, %c32_i32_735 : i32
      %c4_i32_736 = arith.constant 4 : i32
      %518 = arith.remsi %517, %c4_i32_736 : i32
      %c32_i32_737 = arith.constant 32 : i32
      %519 = arith.remsi %516, %c32_i32_737 : i32
      %c4_i32_738 = arith.constant 4 : i32
      %520 = arith.remsi %518, %c4_i32_738 : i32
      %c4_i32_739 = arith.constant 4 : i32
      %521 = arith.divsi %519, %c4_i32_739 : i32
      %c4_i32_740 = arith.constant 4 : i32
      %522 = arith.remsi %519, %c4_i32_740 : i32
      %c128_i32_741 = arith.constant 128 : i32
      %523 = arith.muli %522, %c128_i32_741 : i32
      %c0_i32_742 = arith.constant 0 : i32
      %524 = arith.xori %523, %c0_i32_742 : i32
      %c4_i32_743 = arith.constant 4 : i32
      %525 = arith.divsi %519, %c4_i32_743 : i32
      %c4_i32_744 = arith.constant 4 : i32
      %526 = arith.remsi %519, %c4_i32_744 : i32
      %int_tuple_745 = cute.make_int_tuple(%525) : (i32) -> !cute.int_tuple<"?">
      %ptr_746 = cute.add_offset(%iter_733, %int_tuple_745) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?">) -> !cute.ptr<bf16, smem>
      %lay_747 = cute.make_layout() : !cute.layout<"((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %iv_748 = cute.assume(%524) : (i32) -> !cute.i32<divby 128>
      %int_tuple_749 = cute.make_int_tuple(%iv_748) : (!cute.i32<divby 128>) -> !cute.int_tuple<"?{div=128}">
      %527 = cute.static : !cute.swizzle<"S<3,4,3>">
      %lay_750 = cute.make_composed_layout(%527, %int_tuple_749, %lay_747) : !cute.composed_layout<"S<3,4,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %view_751 = cute.make_view(%ptr_746, %lay_750) : !memref_smem_bf16_7
      %iter_752 = cute.get_iter(%view_751) : !memref_smem_bf16_7
      %rmem_753 = cute.memref.alloca() : !memref_rmem_bf16_2
      %iter_754 = cute.get_iter(%rmem_753) : !memref_rmem_bf16_2
      %shape_755 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %shape_756 = cute.make_shape() : () -> !cute.shape<"((2,2),1,16)">
      %e0_757, %e1_758, %e2_759, %e3_760 = cute.get_leaves(%shape_756) : !cute.shape<"((2,2),1,16)">
      %shape_761 = cute.make_shape() : () -> !cute.shape<"((2,2),1,16)">
      %lay_762 = cute.make_layout() : !cute.layout<"((2,2),1,16):((1,2),0,4)">
      %rmem_763 = cute.memref.alloca(%lay_762) : !memref_rmem_f32_
      %iter_764 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
      %iter_765 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
      %lay_766 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
      %sz = cute.size(%lay_766) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"64">
      %e0_767 = cute.get_leaves(%sz) : !cute.int_tuple<"64">
      %lay_768 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
      %528 = cute.get_shape(%lay_768) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_769, %e1_770, %e2_771, %e3_772 = cute.get_leaves(%528) : !cute.shape<"((2,2),1,16)">
      %int_tuple_773 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %int_tuple_774 = cute.make_int_tuple() : () -> !cute.int_tuple<"64">
      %e0_775 = cute.get_leaves(%int_tuple_774) : !cute.int_tuple<"64">
      %cst = arith.constant 0.000000e+00 : f32
      %529 = vector.splat %cst : vector<64xf32>
      %int_tuple_776 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_777 = cute.size(%int_tuple_776) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_778 = cute.get_leaves(%sz_777) : !cute.int_tuple<"64">
      %int_tuple_779 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_780 = cute.size(%int_tuple_779) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_781 = cute.get_leaves(%sz_780) : !cute.int_tuple<"64">
      cute.memref.store_vec %529, %rmem_763, row_major : !memref_rmem_f32_
      %shape_782 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_783 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_784 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_785 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_786 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %shape_787 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_788 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %530 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %531 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_789, %e1_790, %e2_791 = cute.get_leaves(%531) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_792 = cute.size(%e0_789) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_793 = cute.get_leaves(%sz_792) : !cute.int_tuple<"64">
      %532 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_794, %e1_795, %e2_796 = cute.get_leaves(%532) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_797 = cute.size(%e2_796) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_798 = cute.get_leaves(%sz_797) : !cute.int_tuple<"16">
      %tile_799 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %533 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %534 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %535 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_800, %e1_801, %e2_802 = cute.get_leaves(%535) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_803 = cute.size(%e1_801) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_804 = cute.get_leaves(%sz_803) : !cute.int_tuple<"16">
      %536 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_805, %e1_806, %e2_807 = cute.get_leaves(%536) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_808 = cute.size(%e2_807) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_809 = cute.get_leaves(%sz_808) : !cute.int_tuple<"16">
      %tile_810 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %537 = cute.make_tiled_copy(%atom_784) : !copy_ldsm_4_1
      %538 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %539 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_811, %e1_812, %e2_813 = cute.get_leaves(%539) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_814 = cute.size(%e1_812) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_815 = cute.get_leaves(%sz_814) : !cute.int_tuple<"16">
      %540 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_816, %e1_817, %e2_818 = cute.get_leaves(%540) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_819 = cute.size(%e2_818) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_820 = cute.get_leaves(%sz_819) : !cute.int_tuple<"16">
      %tile_821 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %541 = cute.make_tiled_copy(%atom_786) : !copy_ldsm_4_2
      %542 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %543 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_822, %e1_823, %e2_824 = cute.get_leaves(%543) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_825 = cute.size(%e0_822) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_826 = cute.get_leaves(%sz_825) : !cute.int_tuple<"64">
      %544 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_827, %e1_828, %e2_829 = cute.get_leaves(%544) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_830 = cute.size(%e1_828) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_831 = cute.get_leaves(%sz_830) : !cute.int_tuple<"16">
      %tile_832 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %545 = cute.make_tiled_copy(%atom_788) : !copy_ldsm_4_3
      %coord_833 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_834 = cute.get_iter(%view_376) : !memref_smem_bf16_
      %546 = cute.get_scalars(%coord_833) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_835 = arith.constant 16 : i32
      %547 = arith.divsi %546, %c16_i32_835 : i32
      %c16_i32_836 = arith.constant 16 : i32
      %548 = arith.remsi %546, %c16_i32_836 : i32
      %c64_i32_837 = arith.constant 64 : i32
      %549 = arith.muli %548, %c64_i32_837 : i32
      %c2_i32_838 = arith.constant 2 : i32
      %550 = arith.divsi %547, %c2_i32_838 : i32
      %c2_i32_839 = arith.constant 2 : i32
      %551 = arith.remsi %547, %c2_i32_839 : i32
      %c0_i32_840 = arith.constant 0 : i32
      %552 = arith.xori %549, %c0_i32_840 : i32
      %c16_i32_841 = arith.constant 16 : i32
      %553 = arith.divsi %546, %c16_i32_841 : i32
      %c16_i32_842 = arith.constant 16 : i32
      %554 = arith.remsi %546, %c16_i32_842 : i32
      %c2_i32_843 = arith.constant 2 : i32
      %555 = arith.divsi %553, %c2_i32_843 : i32
      %c2_i32_844 = arith.constant 2 : i32
      %556 = arith.remsi %553, %c2_i32_844 : i32
      %c8_i32_845 = arith.constant 8 : i32
      %557 = arith.muli %556, %c8_i32_845 : i32
      %c1024_i32_846 = arith.constant 1024 : i32
      %558 = arith.muli %555, %c1024_i32_846 : i32
      %559 = arith.addi %557, %558 : i32
      %c128_i32_847 = arith.constant 128 : i32
      %560 = arith.andi %552, %c128_i32_847 : i32
      %c0_i32_848 = arith.constant 0 : i32
      %561 = arith.cmpi eq, %560, %c0_i32_848 : i32
      %562 = scf.if %561 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_849 = arith.constant 256 : i32
      %563 = arith.andi %552, %c256_i32_849 : i32
      %c0_i32_850 = arith.constant 0 : i32
      %564 = arith.cmpi eq, %563, %c0_i32_850 : i32
      %565 = scf.if %564 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_851 = arith.constant 512 : i32
      %566 = arith.andi %552, %c512_i32_851 : i32
      %c0_i32_852 = arith.constant 0 : i32
      %567 = arith.cmpi eq, %566, %c0_i32_852 : i32
      %568 = scf.if %567 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_853 = arith.constant 16 : i32
      %569 = arith.andi %552, %c16_i32_853 : i32
      %c0_i32_854 = arith.constant 0 : i32
      %570 = arith.cmpi eq, %569, %c0_i32_854 : i32
      %571 = scf.if %570 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_855 = arith.constant 32 : i32
      %572 = arith.andi %552, %c32_i32_855 : i32
      %c0_i32_856 = arith.constant 0 : i32
      %573 = arith.cmpi eq, %572, %c0_i32_856 : i32
      %574 = scf.if %573 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_857 = arith.constant 64 : i32
      %575 = arith.andi %552, %c64_i32_857 : i32
      %c0_i32_858 = arith.constant 0 : i32
      %576 = arith.cmpi eq, %575, %c0_i32_858 : i32
      %577 = scf.if %576 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_859 = arith.constant 896 : i32
      %578 = arith.andi %552, %c896_i32_859 : i32
      %c3_i32_860 = arith.constant 3 : i32
      %579 = arith.shrsi %578, %c3_i32_860 : i32
      %580 = arith.xori %552, %579 : i32
      %581 = arith.addi %580, %559 : i32
      %c256_i32_861 = arith.constant 256 : i32
      %582 = arith.muli %562, %c256_i32_861 : i32
      %c128_i32_862 = arith.constant 128 : i32
      %583 = arith.muli %565, %c128_i32_862 : i32
      %c64_i32_863 = arith.constant 64 : i32
      %584 = arith.muli %568, %c64_i32_863 : i32
      %c32_i32_864 = arith.constant 32 : i32
      %585 = arith.muli %571, %c32_i32_864 : i32
      %c16_i32_865 = arith.constant 16 : i32
      %586 = arith.muli %574, %c16_i32_865 : i32
      %c8_i32_866 = arith.constant 8 : i32
      %587 = arith.muli %577, %c8_i32_866 : i32
      %iv_867 = cute.assume(%581) : (i32) -> !cute.i32<divby 8>
      %int_tuple_868 = cute.make_int_tuple(%iv_867) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_869 = cute.add_offset(%iter_834, %int_tuple_868) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_870 = cute.make_shape() : () -> !cute.shape<"((8,1),1,((2,2),2))">
      %iv_871 = cute.assume(%562) : (i32) -> !cute.i32<divby 16>
      %iv_872 = cute.assume(%565) : (i32) -> !cute.i32<divby 32>
      %stride_873 = cute.make_stride(%iv_871, %iv_872) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),0,((?{div=16},?{div=32}),4096))">
      %lay_874 = cute.make_layout(%shape_870, %stride_873) : !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">
      %view_875 = cute.make_view(%ptr_869, %lay_874) : !memref_smem_bf16_8
      %iter_876 = cute.get_iter(%view_875) : !memref_smem_bf16_8
      %iter_877 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %view_878 = cute.make_view(%iter_877) : !memref_rmem_bf16_3
      %iter_879 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
      %coord_880 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_881 = cute.get_iter(%view_379) : !memref_smem_bf16_
      %588 = cute.get_scalars(%coord_880) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_882 = arith.constant 8 : i32
      %589 = arith.divsi %588, %c8_i32_882 : i32
      %c8_i32_883 = arith.constant 8 : i32
      %590 = arith.remsi %588, %c8_i32_883 : i32
      %c64_i32_884 = arith.constant 64 : i32
      %591 = arith.muli %590, %c64_i32_884 : i32
      %c2_i32_885 = arith.constant 2 : i32
      %592 = arith.divsi %589, %c2_i32_885 : i32
      %c2_i32_886 = arith.constant 2 : i32
      %593 = arith.remsi %589, %c2_i32_886 : i32
      %c2_i32_887 = arith.constant 2 : i32
      %594 = arith.divsi %592, %c2_i32_887 : i32
      %c2_i32_888 = arith.constant 2 : i32
      %595 = arith.remsi %592, %c2_i32_888 : i32
      %c512_i32_889 = arith.constant 512 : i32
      %596 = arith.muli %595, %c512_i32_889 : i32
      %597 = arith.addi %591, %596 : i32
      %c0_i32_890 = arith.constant 0 : i32
      %598 = arith.xori %597, %c0_i32_890 : i32
      %c8_i32_891 = arith.constant 8 : i32
      %599 = arith.divsi %588, %c8_i32_891 : i32
      %c8_i32_892 = arith.constant 8 : i32
      %600 = arith.remsi %588, %c8_i32_892 : i32
      %c2_i32_893 = arith.constant 2 : i32
      %601 = arith.divsi %599, %c2_i32_893 : i32
      %c2_i32_894 = arith.constant 2 : i32
      %602 = arith.remsi %599, %c2_i32_894 : i32
      %c8_i32_895 = arith.constant 8 : i32
      %603 = arith.muli %602, %c8_i32_895 : i32
      %c2_i32_896 = arith.constant 2 : i32
      %604 = arith.divsi %601, %c2_i32_896 : i32
      %c2_i32_897 = arith.constant 2 : i32
      %605 = arith.remsi %601, %c2_i32_897 : i32
      %c128_i32_898 = arith.constant 128 : i32
      %606 = arith.andi %598, %c128_i32_898 : i32
      %c0_i32_899 = arith.constant 0 : i32
      %607 = arith.cmpi eq, %606, %c0_i32_899 : i32
      %608 = scf.if %607 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_900 = arith.constant 256 : i32
      %609 = arith.andi %598, %c256_i32_900 : i32
      %c0_i32_901 = arith.constant 0 : i32
      %610 = arith.cmpi eq, %609, %c0_i32_901 : i32
      %611 = scf.if %610 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_902 = arith.constant 512 : i32
      %612 = arith.andi %598, %c512_i32_902 : i32
      %c0_i32_903 = arith.constant 0 : i32
      %613 = arith.cmpi eq, %612, %c0_i32_903 : i32
      %614 = scf.if %613 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_904 = arith.constant 16 : i32
      %615 = arith.andi %598, %c16_i32_904 : i32
      %c0_i32_905 = arith.constant 0 : i32
      %616 = arith.cmpi eq, %615, %c0_i32_905 : i32
      %617 = scf.if %616 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_906 = arith.constant 32 : i32
      %618 = arith.andi %598, %c32_i32_906 : i32
      %c0_i32_907 = arith.constant 0 : i32
      %619 = arith.cmpi eq, %618, %c0_i32_907 : i32
      %620 = scf.if %619 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_908 = arith.constant 64 : i32
      %621 = arith.andi %598, %c64_i32_908 : i32
      %c0_i32_909 = arith.constant 0 : i32
      %622 = arith.cmpi eq, %621, %c0_i32_909 : i32
      %623 = scf.if %622 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_910 = arith.constant 896 : i32
      %624 = arith.andi %598, %c896_i32_910 : i32
      %c3_i32_911 = arith.constant 3 : i32
      %625 = arith.shrsi %624, %c3_i32_911 : i32
      %626 = arith.xori %598, %625 : i32
      %627 = arith.addi %626, %603 : i32
      %c64_i32_912 = arith.constant 64 : i32
      %628 = arith.muli %608, %c64_i32_912 : i32
      %c32_i32_913 = arith.constant 32 : i32
      %629 = arith.muli %611, %c32_i32_913 : i32
      %c16_i32_914 = arith.constant 16 : i32
      %630 = arith.muli %614, %c16_i32_914 : i32
      %c8_i32_915 = arith.constant 8 : i32
      %631 = arith.muli %617, %c8_i32_915 : i32
      %c4_i32_916 = arith.constant 4 : i32
      %632 = arith.muli %620, %c4_i32_916 : i32
      %c2_i32_917 = arith.constant 2 : i32
      %633 = arith.muli %623, %c2_i32_917 : i32
      %c256_i32_918 = arith.constant 256 : i32
      %634 = arith.muli %608, %c256_i32_918 : i32
      %c128_i32_919 = arith.constant 128 : i32
      %635 = arith.muli %611, %c128_i32_919 : i32
      %c64_i32_920 = arith.constant 64 : i32
      %636 = arith.muli %614, %c64_i32_920 : i32
      %c32_i32_921 = arith.constant 32 : i32
      %637 = arith.muli %617, %c32_i32_921 : i32
      %c16_i32_922 = arith.constant 16 : i32
      %638 = arith.muli %620, %c16_i32_922 : i32
      %c8_i32_923 = arith.constant 8 : i32
      %639 = arith.muli %623, %c8_i32_923 : i32
      %iv_924 = cute.assume(%627) : (i32) -> !cute.i32<divby 8>
      %int_tuple_925 = cute.make_int_tuple(%iv_924) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_926 = cute.add_offset(%iter_881, %int_tuple_925) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_927 = cute.make_shape() : () -> !cute.shape<"((8,1),4,((2,2),2))">
      %iv_928 = cute.assume(%608) : (i32) -> !cute.i32<divby 16>
      %iv_929 = cute.assume(%611) : (i32) -> !cute.i32<divby 32>
      %stride_930 = cute.make_stride(%iv_928, %iv_929) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),1024,((?{div=16},?{div=32}),4096))">
      %lay_931 = cute.make_layout(%shape_927, %stride_930) : !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
      %view_932 = cute.make_view(%ptr_926, %lay_931) : !memref_smem_bf16_9
      %iter_933 = cute.get_iter(%view_932) : !memref_smem_bf16_9
      %iter_934 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
      %view_935 = cute.make_view(%iter_934) : !memref_rmem_bf16_4
      %iter_936 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
      %coord_937 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_938 = cute.get_iter(%view_391) : !memref_smem_bf16_2
      %640 = cute.get_scalars(%coord_937) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_939 = arith.constant 16 : i32
      %641 = arith.divsi %640, %c16_i32_939 : i32
      %c16_i32_940 = arith.constant 16 : i32
      %642 = arith.remsi %640, %c16_i32_940 : i32
      %c64_i32_941 = arith.constant 64 : i32
      %643 = arith.muli %642, %c64_i32_941 : i32
      %c2_i32_942 = arith.constant 2 : i32
      %644 = arith.divsi %641, %c2_i32_942 : i32
      %c2_i32_943 = arith.constant 2 : i32
      %645 = arith.remsi %641, %c2_i32_943 : i32
      %c0_i32_944 = arith.constant 0 : i32
      %646 = arith.xori %643, %c0_i32_944 : i32
      %c16_i32_945 = arith.constant 16 : i32
      %647 = arith.divsi %640, %c16_i32_945 : i32
      %c16_i32_946 = arith.constant 16 : i32
      %648 = arith.remsi %640, %c16_i32_946 : i32
      %c2_i32_947 = arith.constant 2 : i32
      %649 = arith.divsi %647, %c2_i32_947 : i32
      %c2_i32_948 = arith.constant 2 : i32
      %650 = arith.remsi %647, %c2_i32_948 : i32
      %c8_i32_949 = arith.constant 8 : i32
      %651 = arith.muli %650, %c8_i32_949 : i32
      %c128_i32_950 = arith.constant 128 : i32
      %652 = arith.andi %646, %c128_i32_950 : i32
      %c0_i32_951 = arith.constant 0 : i32
      %653 = arith.cmpi eq, %652, %c0_i32_951 : i32
      %654 = scf.if %653 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_952 = arith.constant 256 : i32
      %655 = arith.andi %646, %c256_i32_952 : i32
      %c0_i32_953 = arith.constant 0 : i32
      %656 = arith.cmpi eq, %655, %c0_i32_953 : i32
      %657 = scf.if %656 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_954 = arith.constant 512 : i32
      %658 = arith.andi %646, %c512_i32_954 : i32
      %c0_i32_955 = arith.constant 0 : i32
      %659 = arith.cmpi eq, %658, %c0_i32_955 : i32
      %660 = scf.if %659 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_956 = arith.constant 16 : i32
      %661 = arith.andi %646, %c16_i32_956 : i32
      %c0_i32_957 = arith.constant 0 : i32
      %662 = arith.cmpi eq, %661, %c0_i32_957 : i32
      %663 = scf.if %662 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_958 = arith.constant 32 : i32
      %664 = arith.andi %646, %c32_i32_958 : i32
      %c0_i32_959 = arith.constant 0 : i32
      %665 = arith.cmpi eq, %664, %c0_i32_959 : i32
      %666 = scf.if %665 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_960 = arith.constant 64 : i32
      %667 = arith.andi %646, %c64_i32_960 : i32
      %c0_i32_961 = arith.constant 0 : i32
      %668 = arith.cmpi eq, %667, %c0_i32_961 : i32
      %669 = scf.if %668 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_962 = arith.constant 896 : i32
      %670 = arith.andi %646, %c896_i32_962 : i32
      %c3_i32_963 = arith.constant 3 : i32
      %671 = arith.shrsi %670, %c3_i32_963 : i32
      %672 = arith.xori %646, %671 : i32
      %673 = arith.addi %672, %651 : i32
      %c256_i32_964 = arith.constant 256 : i32
      %674 = arith.muli %654, %c256_i32_964 : i32
      %c128_i32_965 = arith.constant 128 : i32
      %675 = arith.muli %657, %c128_i32_965 : i32
      %c64_i32_966 = arith.constant 64 : i32
      %676 = arith.muli %660, %c64_i32_966 : i32
      %c32_i32_967 = arith.constant 32 : i32
      %677 = arith.muli %663, %c32_i32_967 : i32
      %c16_i32_968 = arith.constant 16 : i32
      %678 = arith.muli %666, %c16_i32_968 : i32
      %c8_i32_969 = arith.constant 8 : i32
      %679 = arith.muli %669, %c8_i32_969 : i32
      %c64_i32_970 = arith.constant 64 : i32
      %680 = arith.muli %654, %c64_i32_970 : i32
      %c32_i32_971 = arith.constant 32 : i32
      %681 = arith.muli %657, %c32_i32_971 : i32
      %c16_i32_972 = arith.constant 16 : i32
      %682 = arith.muli %660, %c16_i32_972 : i32
      %c8_i32_973 = arith.constant 8 : i32
      %683 = arith.muli %663, %c8_i32_973 : i32
      %c4_i32_974 = arith.constant 4 : i32
      %684 = arith.muli %666, %c4_i32_974 : i32
      %c2_i32_975 = arith.constant 2 : i32
      %685 = arith.muli %669, %c2_i32_975 : i32
      %iv_976 = cute.assume(%673) : (i32) -> !cute.i32<divby 8>
      %int_tuple_977 = cute.make_int_tuple(%iv_976) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_978 = cute.add_offset(%iter_938, %int_tuple_977) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_979 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2),4)">
      %iv_980 = cute.assume(%654) : (i32) -> !cute.i32<divby 16>
      %iv_981 = cute.assume(%657) : (i32) -> !cute.i32<divby 32>
      %stride_982 = cute.make_stride(%iv_980, %iv_981) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096),1024)">
      %lay_983 = cute.make_layout(%shape_979, %stride_982) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %view_984 = cute.make_view(%ptr_978, %lay_983) : !memref_smem_bf16_10
      %iter_985 = cute.get_iter(%view_984) : !memref_smem_bf16_10
      %iter_986 = cute.get_iter(%rmem_753) : !memref_rmem_bf16_2
      %view_987 = cute.make_view(%iter_986) : !memref_rmem_bf16_5
      %iter_988 = cute.get_iter(%view_987) : !memref_rmem_bf16_5
      %coord_989 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_990 = cute.get_iter(%view_385) : !memref_smem_bf16_1
      %686 = cute.get_scalars(%coord_989) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_991 = arith.constant 16 : i32
      %687 = arith.divsi %686, %c16_i32_991 : i32
      %c16_i32_992 = arith.constant 16 : i32
      %688 = arith.remsi %686, %c16_i32_992 : i32
      %c64_i32_993 = arith.constant 64 : i32
      %689 = arith.muli %688, %c64_i32_993 : i32
      %c2_i32_994 = arith.constant 2 : i32
      %690 = arith.divsi %687, %c2_i32_994 : i32
      %c2_i32_995 = arith.constant 2 : i32
      %691 = arith.remsi %687, %c2_i32_995 : i32
      %c0_i32_996 = arith.constant 0 : i32
      %692 = arith.xori %689, %c0_i32_996 : i32
      %c16_i32_997 = arith.constant 16 : i32
      %693 = arith.divsi %686, %c16_i32_997 : i32
      %c16_i32_998 = arith.constant 16 : i32
      %694 = arith.remsi %686, %c16_i32_998 : i32
      %c2_i32_999 = arith.constant 2 : i32
      %695 = arith.divsi %693, %c2_i32_999 : i32
      %c2_i32_1000 = arith.constant 2 : i32
      %696 = arith.remsi %693, %c2_i32_1000 : i32
      %c8_i32_1001 = arith.constant 8 : i32
      %697 = arith.muli %696, %c8_i32_1001 : i32
      %c1024_i32_1002 = arith.constant 1024 : i32
      %698 = arith.muli %695, %c1024_i32_1002 : i32
      %699 = arith.addi %697, %698 : i32
      %c128_i32_1003 = arith.constant 128 : i32
      %700 = arith.andi %692, %c128_i32_1003 : i32
      %c0_i32_1004 = arith.constant 0 : i32
      %701 = arith.cmpi eq, %700, %c0_i32_1004 : i32
      %702 = scf.if %701 -> (i32) {
        %c16_i32_2734 = arith.constant 16 : i32
        scf.yield %c16_i32_2734 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_1005 = arith.constant 256 : i32
      %703 = arith.andi %692, %c256_i32_1005 : i32
      %c0_i32_1006 = arith.constant 0 : i32
      %704 = arith.cmpi eq, %703, %c0_i32_1006 : i32
      %705 = scf.if %704 -> (i32) {
        %c32_i32_2734 = arith.constant 32 : i32
        scf.yield %c32_i32_2734 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c512_i32_1007 = arith.constant 512 : i32
      %706 = arith.andi %692, %c512_i32_1007 : i32
      %c0_i32_1008 = arith.constant 0 : i32
      %707 = arith.cmpi eq, %706, %c0_i32_1008 : i32
      %708 = scf.if %707 -> (i32) {
        %c64_i32_2734 = arith.constant 64 : i32
        scf.yield %c64_i32_2734 : i32
      } else {
        %c-64_i32 = arith.constant -64 : i32
        scf.yield %c-64_i32 : i32
      }
      %c16_i32_1009 = arith.constant 16 : i32
      %709 = arith.andi %692, %c16_i32_1009 : i32
      %c0_i32_1010 = arith.constant 0 : i32
      %710 = arith.cmpi eq, %709, %c0_i32_1010 : i32
      %711 = scf.if %710 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_1011 = arith.constant 32 : i32
      %712 = arith.andi %692, %c32_i32_1011 : i32
      %c0_i32_1012 = arith.constant 0 : i32
      %713 = arith.cmpi eq, %712, %c0_i32_1012 : i32
      %714 = scf.if %713 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c64_i32_1013 = arith.constant 64 : i32
      %715 = arith.andi %692, %c64_i32_1013 : i32
      %c0_i32_1014 = arith.constant 0 : i32
      %716 = arith.cmpi eq, %715, %c0_i32_1014 : i32
      %717 = scf.if %716 -> (i32) {
        %c576_i32 = arith.constant 576 : i32
        scf.yield %c576_i32 : i32
      } else {
        %c448_i32 = arith.constant 448 : i32
        scf.yield %c448_i32 : i32
      }
      %c896_i32_1015 = arith.constant 896 : i32
      %718 = arith.andi %692, %c896_i32_1015 : i32
      %c3_i32_1016 = arith.constant 3 : i32
      %719 = arith.shrsi %718, %c3_i32_1016 : i32
      %720 = arith.xori %692, %719 : i32
      %721 = arith.addi %720, %699 : i32
      %iv_1017 = cute.assume(%721) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1018 = cute.make_int_tuple(%iv_1017) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_1019 = cute.add_offset(%iter_990, %int_tuple_1018) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_1020 = cute.make_shape() : () -> !cute.shape<"((8,1),1,(2,2))">
      %iv_1021 = cute.assume(%702) : (i32) -> !cute.i32<divby 16>
      %iv_1022 = cute.assume(%705) : (i32) -> !cute.i32<divby 32>
      %stride_1023 = cute.make_stride(%iv_1021, %iv_1022) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),0,(?{div=16},?{div=32}))">
      %lay_1024 = cute.make_layout(%shape_1020, %stride_1023) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
      %view_1025 = cute.make_view(%ptr_1019, %lay_1024) : !memref_smem_bf16_11
      %iter_1026 = cute.get_iter(%view_1025) : !memref_smem_bf16_11
      %lay_1027 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %722 = cute.get_shape(%lay_1027) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1028, %e1_1029, %e2_1030, %e3_1031 = cute.get_leaves(%722) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1032 = cute.to_int_tuple(%e0_1028) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %723 = cute.get_scalars(%itup_1032) : !cute.int_tuple<"?">
      %itup_1033 = cute.to_int_tuple(%e1_1029) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %724 = cute.get_scalars(%itup_1033) : !cute.int_tuple<"?">
      %itup_1034 = cute.to_int_tuple(%e2_1030) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %725 = cute.get_scalars(%itup_1034) : !cute.int_tuple<"?">
      %itup_1035 = cute.to_int_tuple(%e3_1031) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %726 = cute.get_scalars(%itup_1035) : !cute.int_tuple<"?{div=8}">
      %shape_1036 = cute.make_shape(%itup_1032, %itup_1033, %itup_1034, %itup_1035) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_1037 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_1038 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_1039 = cute.make_layout(%shape_1036, %stride_1038) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_1040 = cute.make_view(%int_tuple_1037, %lay_1039) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1041 = cute.get_iter(%view_1040) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1042, %e1_1043, %e2_1044, %e3_1045 = cute.get_leaves(%iter_1041) : !cute.int_tuple<"(0,0,0,0)">
      %lay_1046 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %727 = cute.get_shape(%lay_1046) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1047, %e1_1048, %e2_1049, %e3_1050 = cute.get_leaves(%727) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1051 = cute.to_int_tuple(%e0_1047) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %728 = cute.get_scalars(%itup_1051) : !cute.int_tuple<"?">
      %itup_1052 = cute.to_int_tuple(%e1_1048) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %729 = cute.get_scalars(%itup_1052) : !cute.int_tuple<"?">
      %itup_1053 = cute.to_int_tuple(%e2_1049) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %730 = cute.get_scalars(%itup_1053) : !cute.int_tuple<"?">
      %itup_1054 = cute.to_int_tuple(%e3_1050) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %731 = cute.get_scalars(%itup_1054) : !cute.int_tuple<"?{div=8}">
      %shape_1055 = cute.make_shape(%itup_1051, %itup_1052, %itup_1053, %itup_1054) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_1056 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_1057 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_1058 = cute.make_layout(%shape_1055, %stride_1057) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_1059 = cute.make_view(%int_tuple_1056, %lay_1058) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1060 = cute.get_iter(%view_1059) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1061, %e1_1062, %e2_1063, %e3_1064 = cute.get_leaves(%iter_1060) : !cute.int_tuple<"(0,0,0,0)">
      %lay_1065 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %732 = cute.get_shape(%lay_1065) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1066, %e1_1067, %e2_1068, %e3_1069 = cute.get_leaves(%732) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1070 = cute.to_int_tuple(%e0_1066) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %733 = cute.get_scalars(%itup_1070) : !cute.int_tuple<"?">
      %itup_1071 = cute.to_int_tuple(%e1_1067) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %734 = cute.get_scalars(%itup_1071) : !cute.int_tuple<"?">
      %itup_1072 = cute.to_int_tuple(%e2_1068) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %735 = cute.get_scalars(%itup_1072) : !cute.int_tuple<"?">
      %itup_1073 = cute.to_int_tuple(%e3_1069) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %736 = cute.get_scalars(%itup_1073) : !cute.int_tuple<"?{div=8}">
      %shape_1074 = cute.make_shape(%itup_1070, %itup_1071, %itup_1072, %itup_1073) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_1075 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_1076 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_1077 = cute.make_layout(%shape_1074, %stride_1076) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_1078 = cute.make_view(%int_tuple_1075, %lay_1077) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_1079 = cute.get_iter(%view_1078) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_1080, %e1_1081, %e2_1082, %e3_1083 = cute.get_leaves(%iter_1079) : !cute.int_tuple<"(0,0,0,0)">
      %coord_1084 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1085 = cute.get_layout(%view_1040) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %737:4 = cute.get_scalars(%lay_1085) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %738:2 = cute.get_scalars(%coord_1084) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_1086 = cute.assume(%737#3) : (i32) -> !cute.i32<divby 8>
      %shape_1087 = cute.make_shape(%737#1, %iv_1086) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_1088 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_1089 = cute.make_layout(%shape_1087, %stride_1088) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_1090 = cute.crd2idx(%coord_1084, %lay_1085) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_1091 = cute.get_iter(%view_1040) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_1091, %idx_1090) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_1092 = cute.make_view(%tup, %lay_1089) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_1093 = cute.get_iter(%view_1092) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1094, %e1_1095, %e2_1096, %e3_1097 = cute.get_leaves(%iter_1093) : !cute.int_tuple<"(?,0,?,0)">
      %739 = cute.get_scalars(%e0_1094) : !cute.int_tuple<"?">
      %740 = cute.get_scalars(%e2_1096) : !cute.int_tuple<"?">
      %tile_1098 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1099 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %741 = cute.get_scalars(%coord_1099) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1100 = cute.make_coord(%741) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1101 = cute.get_layout(%view_1092) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %742:2 = cute.get_scalars(%lay_1101) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_1102 = arith.constant 64 : i32
      %743 = arith.ceildivsi %742#0, %c64_i32_1102 : i32
      %c128_i32_1103 = arith.constant 128 : i32
      %744 = arith.ceildivsi %742#1, %c128_i32_1103 : i32
      %shape_1104 = cute.make_shape(%743, %744) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_1105 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_1106 = cute.make_layout(%shape_1104, %stride_1105) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_1107 = cute.crd2idx(%coord_1100, %lay_1106) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_1108 = cute.get_iter(%view_1092) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_1109 = cute.add_offset(%iter_1108, %idx_1107) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_1110 = cute.make_view(%tup_1109) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_1111 = cute.get_iter(%view_1110) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_1112, %e1_1113, %e2_1114, %e3_1115 = cute.get_leaves(%iter_1111) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %745 = cute.get_scalars(%e0_1112) : !cute.int_tuple<"?">
      %746 = cute.get_scalars(%e1_1113) : !cute.int_tuple<"?{div=64}">
      %747 = cute.get_scalars(%e2_1114) : !cute.int_tuple<"?">
      %coord_1116 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_1117 = cute.get_layout(%view_1059) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %748:4 = cute.get_scalars(%lay_1117) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %749:2 = cute.get_scalars(%coord_1116) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_1118 = cute.assume(%748#3) : (i32) -> !cute.i32<divby 8>
      %shape_1119 = cute.make_shape(%748#1, %iv_1118) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_1120 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_1121 = cute.make_layout(%shape_1119, %stride_1120) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_1122 = cute.crd2idx(%coord_1116, %lay_1117) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_1123 = cute.get_iter(%view_1059) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_1124 = cute.add_offset(%iter_1123, %idx_1122) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_1125 = cute.make_view(%tup_1124, %lay_1121) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_1126 = cute.get_iter(%view_1125) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_1127, %e1_1128, %e2_1129, %e3_1130 = cute.get_leaves(%iter_1126) : !cute.int_tuple<"(?,0,?,0)">
      %750 = cute.get_scalars(%e0_1127) : !cute.int_tuple<"?">
      %751 = cute.get_scalars(%e2_1129) : !cute.int_tuple<"?">
      %tile_1131 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_1132 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %752 = cute.get_scalars(%coord_1132) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_1133 = cute.make_coord(%752) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_1134 = cute.get_layout(%view_1125) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %753:2 = cute.get_scalars(%lay_1134) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_1135 = arith.constant 64 : i32
      %754 = arith.ceildivsi %753#0, %c64_i32_1135 : i32
      %c128_i32_1136 = arith.constant 128 : i32
      %755 = arith.ceildivsi %753#1, %c128_i32_1136 : i32
      %shape_1137 = cute.make_shape(%754, %755) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_1138 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_1139 = cute.make_layout(%shape_1137, %stride_1138) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_1140 = cute.crd2idx(%coord_1133, %lay_1139) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_1141 = cute.get_iter(%view_1125) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_1142 = cute.add_offset(%iter_1141, %idx_1140) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_1143 = cute.make_view(%tup_1142) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_1144 = cute.get_iter(%view_1143) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_1145, %e1_1146, %e2_1147, %e3_1148 = cute.get_leaves(%iter_1144) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %756 = cute.get_scalars(%e0_1145) : !cute.int_tuple<"?">
      %757 = cute.get_scalars(%e1_1146) : !cute.int_tuple<"?{div=64}">
      %758 = cute.get_scalars(%e2_1147) : !cute.int_tuple<"?">
      %coord_1149 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,?,_,_)">
      %lay_1150 = cute.get_layout(%view_1078) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %759:4 = cute.get_scalars(%lay_1150) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %760:2 = cute.get_scalars(%coord_1149) <{only_dynamic}> : !cute.coord<"(?,?,_,_)">
      %iv_1151 = cute.assume(%759#3) : (i32) -> !cute.i32<divby 8>
      %shape_1152 = cute.make_shape(%759#2, %iv_1151) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_1153 = cute.make_stride() : () -> !cute.stride<"(1@2,1@3)">
      %lay_1154 = cute.make_layout(%shape_1152, %stride_1153) : !cute.layout<"(?,?{div=8}):(1@2,1@3)">
      %idx_1155 = cute.crd2idx(%coord_1149, %lay_1150) : (!cute.coord<"(?,?,_,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,?,0,0)">
      %iter_1156 = cute.get_iter(%view_1078) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_1157 = cute.add_offset(%iter_1156, %idx_1155) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,?,0,0)">) -> !cute.int_tuple<"(?,?,0,0)">
      %view_1158 = cute.make_view(%tup_1157, %lay_1154) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %iter_1159 = cute.get_iter(%view_1158) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %e0_1160, %e1_1161, %e2_1162, %e3_1163 = cute.get_leaves(%iter_1159) : !cute.int_tuple<"(?,?,0,0)">
      %761 = cute.get_scalars(%e0_1160) : !cute.int_tuple<"?">
      %762 = cute.get_scalars(%e1_1161) : !cute.int_tuple<"?">
      %tile_1164 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
      %coord_1165 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,_)">
      %763 = cute.get_scalars(%coord_1165) <{only_dynamic}> : !cute.coord<"(?,_)">
      %coord_1166 = cute.make_coord(%763) : (i32) -> !cute.coord<"((_,_),(?,_))">
      %lay_1167 = cute.get_layout(%view_1158) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %764:2 = cute.get_scalars(%lay_1167) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@2,1@3)">
      %c64_i32_1168 = arith.constant 64 : i32
      %765 = arith.ceildivsi %764#0, %c64_i32_1168 : i32
      %c64_i32_1169 = arith.constant 64 : i32
      %766 = arith.ceildivsi %764#1, %c64_i32_1169 : i32
      %shape_1170 = cute.make_shape(%765, %766) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
      %stride_1171 = cute.make_stride() : () -> !cute.stride<"((1@2,1@3),(64@2,64@3))">
      %lay_1172 = cute.make_layout(%shape_1170, %stride_1171) : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">
      %767:2 = cute.get_scalars(%lay_1172) <{only_dynamic}> : !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">
      %768 = cute.get_scalars(%coord_1166) <{only_dynamic}> : !cute.coord<"((_,_),(?,_))">
      %shape_1173 = cute.make_shape(%767#1) : (i32) -> !cute.shape<"(64,64,?)">
      %stride_1174 = cute.make_stride() : () -> !cute.stride<"(1@2,1@3,64@3)">
      %lay_1175 = cute.make_layout(%shape_1173, %stride_1174) : !cute.layout<"(64,64,?):(1@2,1@3,64@3)">
      %idx_1176 = cute.crd2idx(%coord_1166, %lay_1172) : (!cute.coord<"((_,_),(?,_))">, !cute.layout<"((64,64),(?,?)):((1@2,1@3),(64@2,64@3))">) -> !cute.int_tuple<"(0,0,?{div=64},0)">
      %iter_1177 = cute.get_iter(%view_1158) : !cute.coord_tensor<"(?,?,0,0)", "(?,?{div=8}):(1@2,1@3)">
      %tup_1178 = cute.add_offset(%iter_1177, %idx_1176) : (!cute.int_tuple<"(?,?,0,0)">, !cute.int_tuple<"(0,0,?{div=64},0)">) -> !cute.int_tuple<"(?,?,?{div=64},0)">
      %view_1179 = cute.make_view(%tup_1178, %lay_1175) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %iter_1180 = cute.get_iter(%view_1179) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %e0_1181, %e1_1182, %e2_1183, %e3_1184 = cute.get_leaves(%iter_1180) : !cute.int_tuple<"(?,?,?{div=64},0)">
      %769 = cute.get_scalars(%e0_1181) : !cute.int_tuple<"?">
      %770 = cute.get_scalars(%e1_1182) : !cute.int_tuple<"?">
      %771 = cute.get_scalars(%e2_1183) : !cute.int_tuple<"?{div=64}">
      %coord_1185 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_1186 = cute.get_iter(%view_1110) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %772 = cute.get_scalars(%coord_1185) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_1187 = arith.constant 8 : i32
      %773 = arith.divsi %772, %c8_i32_1187 : i32
      %c8_i32_1188 = arith.constant 8 : i32
      %774 = arith.remsi %772, %c8_i32_1188 : i32
      %c8_i32_1189 = arith.constant 8 : i32
      %775 = arith.muli %774, %c8_i32_1189 : i32
      %iv_1190 = cute.assume(%775) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1191 = cute.make_int_tuple(%773, %iv_1190) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_1192 = cute.add_offset(%iter_1186, %int_tuple_1191) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1193 = cute.make_view(%tup_1192) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1194 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1195, %e1_1196, %e2_1197, %e3_1198 = cute.get_leaves(%iter_1194) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %776 = cute.get_scalars(%e0_1195) : !cute.int_tuple<"?">
      %777 = cute.get_scalars(%e1_1196) : !cute.int_tuple<"?">
      %778 = cute.get_scalars(%e2_1197) : !cute.int_tuple<"?">
      %779 = cute.get_scalars(%e3_1198) : !cute.int_tuple<"?{div=8}">
      %coord_1199 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_1200 = cute.get_iter(%view_1143) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %780 = cute.get_scalars(%coord_1199) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_1201 = arith.constant 8 : i32
      %781 = arith.divsi %780, %c8_i32_1201 : i32
      %c8_i32_1202 = arith.constant 8 : i32
      %782 = arith.remsi %780, %c8_i32_1202 : i32
      %c8_i32_1203 = arith.constant 8 : i32
      %783 = arith.muli %782, %c8_i32_1203 : i32
      %iv_1204 = cute.assume(%783) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1205 = cute.make_int_tuple(%781, %iv_1204) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_1206 = cute.add_offset(%iter_1200, %int_tuple_1205) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1207 = cute.make_view(%tup_1206) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1208 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1209, %e1_1210, %e2_1211, %e3_1212 = cute.get_leaves(%iter_1208) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %784 = cute.get_scalars(%e0_1209) : !cute.int_tuple<"?">
      %785 = cute.get_scalars(%e1_1210) : !cute.int_tuple<"?">
      %786 = cute.get_scalars(%e2_1211) : !cute.int_tuple<"?">
      %787 = cute.get_scalars(%e3_1212) : !cute.int_tuple<"?{div=8}">
      %coord_1213 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_1214 = cute.get_iter(%view_1179) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %lay_1215 = cute.get_layout(%view_1179) : !cute.coord_tensor<"(?,?,?{div=64},0)", "(64,64,?):(1@2,1@3,64@3)">
      %788 = cute.get_scalars(%lay_1215) <{only_dynamic}> : !cute.layout<"(64,64,?):(1@2,1@3,64@3)">
      %789 = cute.get_scalars(%coord_1213) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_1216 = arith.constant 8 : i32
      %790 = arith.divsi %789, %c8_i32_1216 : i32
      %c8_i32_1217 = arith.constant 8 : i32
      %791 = arith.remsi %789, %c8_i32_1217 : i32
      %c8_i32_1218 = arith.constant 8 : i32
      %792 = arith.muli %791, %c8_i32_1218 : i32
      %iv_1219 = cute.assume(%792) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1220 = cute.make_int_tuple(%790, %iv_1219) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,0,?,?{div=8})">
      %tup_1221 = cute.add_offset(%iter_1214, %int_tuple_1220) : (!cute.int_tuple<"(?,?,?{div=64},0)">, !cute.int_tuple<"(0,0,?,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %shape_1222 = cute.make_shape(%788) : (i32) -> !cute.shape<"((8,1),4,1,?)">
      %stride_1223 = cute.make_stride() : () -> !cute.stride<"((1@3,0),16@2,0,64@3)">
      %lay_1224 = cute.make_layout(%shape_1222, %stride_1223) : !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %view_1225 = cute.make_view(%tup_1221, %lay_1224) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %iter_1226 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %e0_1227, %e1_1228, %e2_1229, %e3_1230 = cute.get_leaves(%iter_1226) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %793 = cute.get_scalars(%e0_1227) : !cute.int_tuple<"?">
      %794 = cute.get_scalars(%e1_1228) : !cute.int_tuple<"?">
      %795 = cute.get_scalars(%e2_1229) : !cute.int_tuple<"?">
      %796 = cute.get_scalars(%e3_1230) : !cute.int_tuple<"?{div=8}">
      %lay_1231 = cute.get_layout(%view_442) : !memref_smem_bf16_3
      %797 = cute.get_shape(%lay_1231) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1232, %e1_1233, %e2_1234, %e3_1235 = cute.get_leaves(%797) : !cute.shape<"((8,1),4,2)">
      %lay_1236 = cute.get_layout(%view_442) : !memref_smem_bf16_3
      %sz_1237 = cute.size(%lay_1236) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_1238 = cute.get_leaves(%sz_1237) : !cute.int_tuple<"4">
      %lay_1239 = cute.get_layout(%view_442) : !memref_smem_bf16_3
      %sz_1240 = cute.size(%lay_1239) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1241 = cute.get_leaves(%sz_1240) : !cute.int_tuple<"2">
      %lay_1242 = cute.get_layout(%view_442) : !memref_smem_bf16_3
      %sz_1243 = cute.size(%lay_1242) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1244 = cute.get_leaves(%sz_1243) : !cute.int_tuple<"2">
      %shape_1245 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1246 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1247 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1248 = cute.memref.alloca(%lay_1247) : !memref_rmem_i8_
      %iter_1249 = cute.get_iter(%rmem_1248) : !memref_rmem_i8_
      %iter_1250 = cute.get_iter(%rmem_1248) : !memref_rmem_i8_
      %lay_1251 = cute.get_layout(%view_506) : !memref_smem_bf16_3
      %798 = cute.get_shape(%lay_1251) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1252, %e1_1253, %e2_1254, %e3_1255 = cute.get_leaves(%798) : !cute.shape<"((8,1),4,2)">
      %lay_1256 = cute.get_layout(%view_506) : !memref_smem_bf16_3
      %sz_1257 = cute.size(%lay_1256) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_1258 = cute.get_leaves(%sz_1257) : !cute.int_tuple<"4">
      %lay_1259 = cute.get_layout(%view_506) : !memref_smem_bf16_3
      %sz_1260 = cute.size(%lay_1259) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1261 = cute.get_leaves(%sz_1260) : !cute.int_tuple<"2">
      %lay_1262 = cute.get_layout(%view_506) : !memref_smem_bf16_3
      %sz_1263 = cute.size(%lay_1262) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1264 = cute.get_leaves(%sz_1263) : !cute.int_tuple<"2">
      %shape_1265 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1266 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1267 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1268 = cute.memref.alloca(%lay_1267) : !memref_rmem_i8_
      %iter_1269 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
      %iter_1270 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
      %lay_1271 = cute.get_layout(%rmem_1248) : !memref_rmem_i8_
      %799 = cute.get_shape(%lay_1271) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1272, %e1_1273, %e2_1274 = cute.get_leaves(%799) : !cute.shape<"(1,4,2)">
      %coord_1275 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1276 = cute.get_layout(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1277 = cute.crd2idx(%coord_1275, %lay_1276) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1278 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1279 = cute.add_offset(%iter_1278, %idx_1277) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1280 = cute.make_view(%tup_1279) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1281 = cute.get_iter(%view_1280) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1282, %e1_1283, %e2_1284, %e3_1285 = cute.get_leaves(%iter_1281) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %800 = cute.get_scalars(%e0_1282) : !cute.int_tuple<"?">
      %801 = cute.get_scalars(%e1_1283) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e2_1284) : !cute.int_tuple<"?">
      %803 = cute.get_scalars(%e3_1285) : !cute.int_tuple<"?{div=8}">
      %iter_1286 = cute.get_iter(%view_1280) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1287, %e1_1288, %e2_1289, %e3_1290 = cute.get_leaves(%iter_1286) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %804 = cute.get_scalars(%e0_1287) : !cute.int_tuple<"?">
      %805 = cute.get_scalars(%e1_1288) : !cute.int_tuple<"?">
      %806 = cute.get_scalars(%e2_1289) : !cute.int_tuple<"?">
      %807 = cute.get_scalars(%e3_1290) : !cute.int_tuple<"?{div=8}">
      %iter_1291 = cute.get_iter(%view_1280) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1292, %e1_1293, %e2_1294, %e3_1295 = cute.get_leaves(%iter_1291) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %808 = cute.get_scalars(%e0_1292) : !cute.int_tuple<"?">
      %809 = cute.get_scalars(%e1_1293) : !cute.int_tuple<"?">
      %810 = cute.get_scalars(%e2_1294) : !cute.int_tuple<"?">
      %811 = cute.get_scalars(%e3_1295) : !cute.int_tuple<"?{div=8}">
      %lay_1296 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %812 = cute.get_shape(%lay_1296) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1297, %e1_1298, %e2_1299, %e3_1300 = cute.get_leaves(%812) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1301 = cute.to_int_tuple(%e0_1297) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %813 = cute.get_scalars(%itup_1301) : !cute.int_tuple<"?">
      %itup_1302 = cute.to_int_tuple(%e1_1298) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %814 = cute.get_scalars(%itup_1302) : !cute.int_tuple<"?">
      %itup_1303 = cute.to_int_tuple(%e2_1299) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %815 = cute.get_scalars(%itup_1303) : !cute.int_tuple<"?">
      %itup_1304 = cute.to_int_tuple(%e3_1300) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %816 = cute.get_scalars(%itup_1304) : !cute.int_tuple<"?{div=8}">
      %coord_1305 = cute.make_coord(%e3_1295) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1306 = cute.make_coord(%itup_1304) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %817 = cute.get_scalars(%coord_1305) : !cute.coord<"?{div=8}">
      %818 = cute.get_scalars(%coord_1306) : !cute.coord<"?{div=8}">
      %true = arith.constant true
      %819 = arith.cmpi slt, %817, %818 : i32
      %820 = arith.andi %true, %819 : i1
      %821 = arith.extui %820 : i1 to i8
      %coord_1307 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1248, %coord_1307, %821) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1308 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1309 = cute.get_layout(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1310 = cute.crd2idx(%coord_1308, %lay_1309) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1311 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1312 = cute.add_offset(%iter_1311, %idx_1310) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1313 = cute.make_view(%tup_1312) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1314 = cute.get_iter(%view_1313) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1315, %e1_1316, %e2_1317, %e3_1318 = cute.get_leaves(%iter_1314) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %822 = cute.get_scalars(%e0_1315) : !cute.int_tuple<"?">
      %823 = cute.get_scalars(%e1_1316) : !cute.int_tuple<"?">
      %824 = cute.get_scalars(%e2_1317) : !cute.int_tuple<"?">
      %825 = cute.get_scalars(%e3_1318) : !cute.int_tuple<"?{div=8}">
      %iter_1319 = cute.get_iter(%view_1313) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1320, %e1_1321, %e2_1322, %e3_1323 = cute.get_leaves(%iter_1319) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %826 = cute.get_scalars(%e0_1320) : !cute.int_tuple<"?">
      %827 = cute.get_scalars(%e1_1321) : !cute.int_tuple<"?">
      %828 = cute.get_scalars(%e2_1322) : !cute.int_tuple<"?">
      %829 = cute.get_scalars(%e3_1323) : !cute.int_tuple<"?{div=8}">
      %iter_1324 = cute.get_iter(%view_1313) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1325, %e1_1326, %e2_1327, %e3_1328 = cute.get_leaves(%iter_1324) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %830 = cute.get_scalars(%e0_1325) : !cute.int_tuple<"?">
      %831 = cute.get_scalars(%e1_1326) : !cute.int_tuple<"?">
      %832 = cute.get_scalars(%e2_1327) : !cute.int_tuple<"?">
      %833 = cute.get_scalars(%e3_1328) : !cute.int_tuple<"?{div=8}">
      %lay_1329 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %834 = cute.get_shape(%lay_1329) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1330, %e1_1331, %e2_1332, %e3_1333 = cute.get_leaves(%834) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1334 = cute.to_int_tuple(%e0_1330) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %835 = cute.get_scalars(%itup_1334) : !cute.int_tuple<"?">
      %itup_1335 = cute.to_int_tuple(%e1_1331) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %836 = cute.get_scalars(%itup_1335) : !cute.int_tuple<"?">
      %itup_1336 = cute.to_int_tuple(%e2_1332) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %837 = cute.get_scalars(%itup_1336) : !cute.int_tuple<"?">
      %itup_1337 = cute.to_int_tuple(%e3_1333) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %838 = cute.get_scalars(%itup_1337) : !cute.int_tuple<"?{div=8}">
      %coord_1338 = cute.make_coord(%e3_1328) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1339 = cute.make_coord(%itup_1337) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %839 = cute.get_scalars(%coord_1338) : !cute.coord<"?{div=8}">
      %840 = cute.get_scalars(%coord_1339) : !cute.coord<"?{div=8}">
      %true_1340 = arith.constant true
      %841 = arith.cmpi slt, %839, %840 : i32
      %842 = arith.andi %true_1340, %841 : i1
      %843 = arith.extui %842 : i1 to i8
      %coord_1341 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1248, %coord_1341, %843) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_1342 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
      %844 = cute.get_shape(%lay_1342) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1343, %e1_1344, %e2_1345 = cute.get_leaves(%844) : !cute.shape<"(1,4,2)">
      %coord_1346 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1347 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1348 = cute.crd2idx(%coord_1346, %lay_1347) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1349 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1350 = cute.add_offset(%iter_1349, %idx_1348) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1351 = cute.make_view(%tup_1350) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1352 = cute.get_iter(%view_1351) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1353, %e1_1354, %e2_1355, %e3_1356 = cute.get_leaves(%iter_1352) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %845 = cute.get_scalars(%e0_1353) : !cute.int_tuple<"?">
      %846 = cute.get_scalars(%e1_1354) : !cute.int_tuple<"?">
      %847 = cute.get_scalars(%e2_1355) : !cute.int_tuple<"?">
      %848 = cute.get_scalars(%e3_1356) : !cute.int_tuple<"?{div=8}">
      %iter_1357 = cute.get_iter(%view_1351) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1358, %e1_1359, %e2_1360, %e3_1361 = cute.get_leaves(%iter_1357) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %849 = cute.get_scalars(%e0_1358) : !cute.int_tuple<"?">
      %850 = cute.get_scalars(%e1_1359) : !cute.int_tuple<"?">
      %851 = cute.get_scalars(%e2_1360) : !cute.int_tuple<"?">
      %852 = cute.get_scalars(%e3_1361) : !cute.int_tuple<"?{div=8}">
      %iter_1362 = cute.get_iter(%view_1351) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1363, %e1_1364, %e2_1365, %e3_1366 = cute.get_leaves(%iter_1362) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %853 = cute.get_scalars(%e0_1363) : !cute.int_tuple<"?">
      %854 = cute.get_scalars(%e1_1364) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e2_1365) : !cute.int_tuple<"?">
      %856 = cute.get_scalars(%e3_1366) : !cute.int_tuple<"?{div=8}">
      %lay_1367 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %857 = cute.get_shape(%lay_1367) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1368, %e1_1369, %e2_1370, %e3_1371 = cute.get_leaves(%857) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1372 = cute.to_int_tuple(%e0_1368) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %858 = cute.get_scalars(%itup_1372) : !cute.int_tuple<"?">
      %itup_1373 = cute.to_int_tuple(%e1_1369) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %859 = cute.get_scalars(%itup_1373) : !cute.int_tuple<"?">
      %itup_1374 = cute.to_int_tuple(%e2_1370) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %860 = cute.get_scalars(%itup_1374) : !cute.int_tuple<"?">
      %itup_1375 = cute.to_int_tuple(%e3_1371) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %861 = cute.get_scalars(%itup_1375) : !cute.int_tuple<"?{div=8}">
      %coord_1376 = cute.make_coord(%e3_1366) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1377 = cute.make_coord(%itup_1375) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %862 = cute.get_scalars(%coord_1376) : !cute.coord<"?{div=8}">
      %863 = cute.get_scalars(%coord_1377) : !cute.coord<"?{div=8}">
      %true_1378 = arith.constant true
      %864 = arith.cmpi slt, %862, %863 : i32
      %865 = arith.andi %true_1378, %864 : i1
      %866 = arith.extui %865 : i1 to i8
      %coord_1379 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1268, %coord_1379, %866) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1380 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1381 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1382 = cute.crd2idx(%coord_1380, %lay_1381) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1383 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1384 = cute.add_offset(%iter_1383, %idx_1382) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1385 = cute.make_view(%tup_1384) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1386 = cute.get_iter(%view_1385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1387, %e1_1388, %e2_1389, %e3_1390 = cute.get_leaves(%iter_1386) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %867 = cute.get_scalars(%e0_1387) : !cute.int_tuple<"?">
      %868 = cute.get_scalars(%e1_1388) : !cute.int_tuple<"?">
      %869 = cute.get_scalars(%e2_1389) : !cute.int_tuple<"?">
      %870 = cute.get_scalars(%e3_1390) : !cute.int_tuple<"?{div=8}">
      %iter_1391 = cute.get_iter(%view_1385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1392, %e1_1393, %e2_1394, %e3_1395 = cute.get_leaves(%iter_1391) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %871 = cute.get_scalars(%e0_1392) : !cute.int_tuple<"?">
      %872 = cute.get_scalars(%e1_1393) : !cute.int_tuple<"?">
      %873 = cute.get_scalars(%e2_1394) : !cute.int_tuple<"?">
      %874 = cute.get_scalars(%e3_1395) : !cute.int_tuple<"?{div=8}">
      %iter_1396 = cute.get_iter(%view_1385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1397, %e1_1398, %e2_1399, %e3_1400 = cute.get_leaves(%iter_1396) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %875 = cute.get_scalars(%e0_1397) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e1_1398) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e2_1399) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e3_1400) : !cute.int_tuple<"?{div=8}">
      %lay_1401 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %879 = cute.get_shape(%lay_1401) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1402, %e1_1403, %e2_1404, %e3_1405 = cute.get_leaves(%879) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1406 = cute.to_int_tuple(%e0_1402) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %880 = cute.get_scalars(%itup_1406) : !cute.int_tuple<"?">
      %itup_1407 = cute.to_int_tuple(%e1_1403) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %881 = cute.get_scalars(%itup_1407) : !cute.int_tuple<"?">
      %itup_1408 = cute.to_int_tuple(%e2_1404) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %882 = cute.get_scalars(%itup_1408) : !cute.int_tuple<"?">
      %itup_1409 = cute.to_int_tuple(%e3_1405) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %883 = cute.get_scalars(%itup_1409) : !cute.int_tuple<"?{div=8}">
      %coord_1410 = cute.make_coord(%e3_1400) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1411 = cute.make_coord(%itup_1409) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %884 = cute.get_scalars(%coord_1410) : !cute.coord<"?{div=8}">
      %885 = cute.get_scalars(%coord_1411) : !cute.coord<"?{div=8}">
      %true_1412 = arith.constant true
      %886 = arith.cmpi slt, %884, %885 : i32
      %887 = arith.andi %true_1412, %886 : i1
      %888 = arith.extui %887 : i1 to i8
      %coord_1413 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1268, %coord_1413, %888) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_1414 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1415 = cute.size(%int_tuple_1414) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1416 = cute.get_leaves(%sz_1415) : !cute.int_tuple<"4">
      %coord_1417 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1418 = cute.get_layout(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1419 = cute.crd2idx(%coord_1417, %lay_1418) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1420 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1421 = cute.add_offset(%iter_1420, %idx_1419) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1422 = cute.make_view(%tup_1421) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1423 = cute.get_iter(%view_1422) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1424, %e1_1425, %e2_1426, %e3_1427 = cute.get_leaves(%iter_1423) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %889 = cute.get_scalars(%e0_1424) : !cute.int_tuple<"?">
      %890 = cute.get_scalars(%e1_1425) : !cute.int_tuple<"?">
      %891 = cute.get_scalars(%e2_1426) : !cute.int_tuple<"?">
      %892 = cute.get_scalars(%e3_1427) : !cute.int_tuple<"?{div=8}">
      %iter_1428 = cute.get_iter(%view_1422) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1429, %e1_1430, %e2_1431, %e3_1432 = cute.get_leaves(%iter_1428) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %893 = cute.get_scalars(%e0_1429) : !cute.int_tuple<"?">
      %894 = cute.get_scalars(%e1_1430) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e2_1431) : !cute.int_tuple<"?">
      %896 = cute.get_scalars(%e3_1432) : !cute.int_tuple<"?{div=8}">
      %iter_1433 = cute.get_iter(%view_1422) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1434, %e1_1435, %e2_1436, %e3_1437 = cute.get_leaves(%iter_1433) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %897 = cute.get_scalars(%e0_1434) : !cute.int_tuple<"?">
      %898 = cute.get_scalars(%e1_1435) : !cute.int_tuple<"?">
      %899 = cute.get_scalars(%e2_1436) : !cute.int_tuple<"?">
      %900 = cute.get_scalars(%e3_1437) : !cute.int_tuple<"?{div=8}">
      %lay_1438 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %901 = cute.get_shape(%lay_1438) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1439, %e1_1440, %e2_1441, %e3_1442 = cute.get_leaves(%901) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1443 = cute.to_int_tuple(%e0_1439) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %902 = cute.get_scalars(%itup_1443) : !cute.int_tuple<"?">
      %itup_1444 = cute.to_int_tuple(%e1_1440) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %903 = cute.get_scalars(%itup_1444) : !cute.int_tuple<"?">
      %itup_1445 = cute.to_int_tuple(%e2_1441) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %904 = cute.get_scalars(%itup_1445) : !cute.int_tuple<"?">
      %itup_1446 = cute.to_int_tuple(%e3_1442) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %905 = cute.get_scalars(%itup_1446) : !cute.int_tuple<"?{div=8}">
      %coord_1447 = cute.make_coord(%e1_1435) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1448 = cute.make_coord(%itup_1444) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %906 = cute.get_scalars(%coord_1447) : !cute.coord<"?">
      %907 = cute.get_scalars(%coord_1448) : !cute.coord<"?">
      %true_1449 = arith.constant true
      %908 = arith.cmpi slt, %906, %907 : i32
      %909 = arith.andi %true_1449, %908 : i1
      scf.if %909 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2735 = cute.get_layout(%view_406) : !memref_gmem_bf16_5
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2737 = cute.get_iter(%view_406) : !memref_gmem_bf16_5
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2742 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2744 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2749 = cute.get_layout(%rmem_1248) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1248) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2735 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2737 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %coord_1450 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1451 = cute.get_layout(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1452 = cute.crd2idx(%coord_1450, %lay_1451) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1453 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1454 = cute.add_offset(%iter_1453, %idx_1452) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1455 = cute.make_view(%tup_1454) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1456 = cute.get_iter(%view_1455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1457, %e1_1458, %e2_1459, %e3_1460 = cute.get_leaves(%iter_1456) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %910 = cute.get_scalars(%e0_1457) : !cute.int_tuple<"?">
      %911 = cute.get_scalars(%e1_1458) : !cute.int_tuple<"?">
      %912 = cute.get_scalars(%e2_1459) : !cute.int_tuple<"?">
      %913 = cute.get_scalars(%e3_1460) : !cute.int_tuple<"?{div=8}">
      %iter_1461 = cute.get_iter(%view_1455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1462, %e1_1463, %e2_1464, %e3_1465 = cute.get_leaves(%iter_1461) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %914 = cute.get_scalars(%e0_1462) : !cute.int_tuple<"?">
      %915 = cute.get_scalars(%e1_1463) : !cute.int_tuple<"?">
      %916 = cute.get_scalars(%e2_1464) : !cute.int_tuple<"?">
      %917 = cute.get_scalars(%e3_1465) : !cute.int_tuple<"?{div=8}">
      %iter_1466 = cute.get_iter(%view_1455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1467, %e1_1468, %e2_1469, %e3_1470 = cute.get_leaves(%iter_1466) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %918 = cute.get_scalars(%e0_1467) : !cute.int_tuple<"?">
      %919 = cute.get_scalars(%e1_1468) : !cute.int_tuple<"?">
      %920 = cute.get_scalars(%e2_1469) : !cute.int_tuple<"?">
      %921 = cute.get_scalars(%e3_1470) : !cute.int_tuple<"?{div=8}">
      %lay_1471 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %922 = cute.get_shape(%lay_1471) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1472, %e1_1473, %e2_1474, %e3_1475 = cute.get_leaves(%922) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1476 = cute.to_int_tuple(%e0_1472) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %923 = cute.get_scalars(%itup_1476) : !cute.int_tuple<"?">
      %itup_1477 = cute.to_int_tuple(%e1_1473) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %924 = cute.get_scalars(%itup_1477) : !cute.int_tuple<"?">
      %itup_1478 = cute.to_int_tuple(%e2_1474) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %925 = cute.get_scalars(%itup_1478) : !cute.int_tuple<"?">
      %itup_1479 = cute.to_int_tuple(%e3_1475) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %926 = cute.get_scalars(%itup_1479) : !cute.int_tuple<"?{div=8}">
      %coord_1480 = cute.make_coord(%e1_1468) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1481 = cute.make_coord(%itup_1477) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %927 = cute.get_scalars(%coord_1480) : !cute.coord<"?">
      %928 = cute.get_scalars(%coord_1481) : !cute.coord<"?">
      %true_1482 = arith.constant true
      %929 = arith.cmpi slt, %927, %928 : i32
      %930 = arith.andi %true_1482, %929 : i1
      scf.if %930 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2735 = cute.get_layout(%view_406) : !memref_gmem_bf16_5
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2737 = cute.get_iter(%view_406) : !memref_gmem_bf16_5
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2742 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2744 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2749 = cute.get_layout(%rmem_1248) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1248) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2735 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2737 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %coord_1483 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1484 = cute.get_layout(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1485 = cute.crd2idx(%coord_1483, %lay_1484) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1486 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1487 = cute.add_offset(%iter_1486, %idx_1485) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1488 = cute.make_view(%tup_1487) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1489 = cute.get_iter(%view_1488) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1490, %e1_1491, %e2_1492, %e3_1493 = cute.get_leaves(%iter_1489) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %931 = cute.get_scalars(%e0_1490) : !cute.int_tuple<"?">
      %932 = cute.get_scalars(%e1_1491) : !cute.int_tuple<"?">
      %933 = cute.get_scalars(%e2_1492) : !cute.int_tuple<"?">
      %934 = cute.get_scalars(%e3_1493) : !cute.int_tuple<"?{div=8}">
      %iter_1494 = cute.get_iter(%view_1488) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1495, %e1_1496, %e2_1497, %e3_1498 = cute.get_leaves(%iter_1494) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %935 = cute.get_scalars(%e0_1495) : !cute.int_tuple<"?">
      %936 = cute.get_scalars(%e1_1496) : !cute.int_tuple<"?">
      %937 = cute.get_scalars(%e2_1497) : !cute.int_tuple<"?">
      %938 = cute.get_scalars(%e3_1498) : !cute.int_tuple<"?{div=8}">
      %iter_1499 = cute.get_iter(%view_1488) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1500, %e1_1501, %e2_1502, %e3_1503 = cute.get_leaves(%iter_1499) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %939 = cute.get_scalars(%e0_1500) : !cute.int_tuple<"?">
      %940 = cute.get_scalars(%e1_1501) : !cute.int_tuple<"?">
      %941 = cute.get_scalars(%e2_1502) : !cute.int_tuple<"?">
      %942 = cute.get_scalars(%e3_1503) : !cute.int_tuple<"?{div=8}">
      %lay_1504 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %943 = cute.get_shape(%lay_1504) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1505, %e1_1506, %e2_1507, %e3_1508 = cute.get_leaves(%943) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1509 = cute.to_int_tuple(%e0_1505) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %944 = cute.get_scalars(%itup_1509) : !cute.int_tuple<"?">
      %itup_1510 = cute.to_int_tuple(%e1_1506) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %945 = cute.get_scalars(%itup_1510) : !cute.int_tuple<"?">
      %itup_1511 = cute.to_int_tuple(%e2_1507) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %946 = cute.get_scalars(%itup_1511) : !cute.int_tuple<"?">
      %itup_1512 = cute.to_int_tuple(%e3_1508) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %947 = cute.get_scalars(%itup_1512) : !cute.int_tuple<"?{div=8}">
      %coord_1513 = cute.make_coord(%e1_1501) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1514 = cute.make_coord(%itup_1510) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %948 = cute.get_scalars(%coord_1513) : !cute.coord<"?">
      %949 = cute.get_scalars(%coord_1514) : !cute.coord<"?">
      %true_1515 = arith.constant true
      %950 = arith.cmpi slt, %948, %949 : i32
      %951 = arith.andi %true_1515, %950 : i1
      scf.if %951 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2735 = cute.get_layout(%view_406) : !memref_gmem_bf16_5
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2737 = cute.get_iter(%view_406) : !memref_gmem_bf16_5
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2742 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2744 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2749 = cute.get_layout(%rmem_1248) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1248) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2735 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2737 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %coord_1516 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1517 = cute.get_layout(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1518 = cute.crd2idx(%coord_1516, %lay_1517) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1519 = cute.get_iter(%view_1193) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1520 = cute.add_offset(%iter_1519, %idx_1518) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1521 = cute.make_view(%tup_1520) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1522 = cute.get_iter(%view_1521) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1523, %e1_1524, %e2_1525, %e3_1526 = cute.get_leaves(%iter_1522) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %952 = cute.get_scalars(%e0_1523) : !cute.int_tuple<"?">
      %953 = cute.get_scalars(%e1_1524) : !cute.int_tuple<"?">
      %954 = cute.get_scalars(%e2_1525) : !cute.int_tuple<"?">
      %955 = cute.get_scalars(%e3_1526) : !cute.int_tuple<"?{div=8}">
      %iter_1527 = cute.get_iter(%view_1521) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1528, %e1_1529, %e2_1530, %e3_1531 = cute.get_leaves(%iter_1527) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %956 = cute.get_scalars(%e0_1528) : !cute.int_tuple<"?">
      %957 = cute.get_scalars(%e1_1529) : !cute.int_tuple<"?">
      %958 = cute.get_scalars(%e2_1530) : !cute.int_tuple<"?">
      %959 = cute.get_scalars(%e3_1531) : !cute.int_tuple<"?{div=8}">
      %iter_1532 = cute.get_iter(%view_1521) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1533, %e1_1534, %e2_1535, %e3_1536 = cute.get_leaves(%iter_1532) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %960 = cute.get_scalars(%e0_1533) : !cute.int_tuple<"?">
      %961 = cute.get_scalars(%e1_1534) : !cute.int_tuple<"?">
      %962 = cute.get_scalars(%e2_1535) : !cute.int_tuple<"?">
      %963 = cute.get_scalars(%e3_1536) : !cute.int_tuple<"?{div=8}">
      %lay_1537 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %964 = cute.get_shape(%lay_1537) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1538, %e1_1539, %e2_1540, %e3_1541 = cute.get_leaves(%964) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1542 = cute.to_int_tuple(%e0_1538) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %965 = cute.get_scalars(%itup_1542) : !cute.int_tuple<"?">
      %itup_1543 = cute.to_int_tuple(%e1_1539) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %966 = cute.get_scalars(%itup_1543) : !cute.int_tuple<"?">
      %itup_1544 = cute.to_int_tuple(%e2_1540) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %967 = cute.get_scalars(%itup_1544) : !cute.int_tuple<"?">
      %itup_1545 = cute.to_int_tuple(%e3_1541) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %968 = cute.get_scalars(%itup_1545) : !cute.int_tuple<"?{div=8}">
      %coord_1546 = cute.make_coord(%e1_1534) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1547 = cute.make_coord(%itup_1543) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %969 = cute.get_scalars(%coord_1546) : !cute.coord<"?">
      %970 = cute.get_scalars(%coord_1547) : !cute.coord<"?">
      %true_1548 = arith.constant true
      %971 = arith.cmpi slt, %969, %970 : i32
      %972 = arith.andi %true_1548, %971 : i1
      scf.if %972 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2735 = cute.get_layout(%view_406) : !memref_gmem_bf16_5
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2737 = cute.get_iter(%view_406) : !memref_gmem_bf16_5
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2742 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2744 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2749 = cute.get_layout(%rmem_1248) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1248) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2735 = cute.get_layout(%view_442) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2737 = cute.get_iter(%view_442) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %int_tuple_1549 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1550 = cute.size(%int_tuple_1549) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1551 = cute.get_leaves(%sz_1550) : !cute.int_tuple<"4">
      %coord_1552 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1553 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1554 = cute.crd2idx(%coord_1552, %lay_1553) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1555 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1556 = cute.add_offset(%iter_1555, %idx_1554) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1557 = cute.make_view(%tup_1556) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1558 = cute.get_iter(%view_1557) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1559, %e1_1560, %e2_1561, %e3_1562 = cute.get_leaves(%iter_1558) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %973 = cute.get_scalars(%e0_1559) : !cute.int_tuple<"?">
      %974 = cute.get_scalars(%e1_1560) : !cute.int_tuple<"?">
      %975 = cute.get_scalars(%e2_1561) : !cute.int_tuple<"?">
      %976 = cute.get_scalars(%e3_1562) : !cute.int_tuple<"?{div=8}">
      %iter_1563 = cute.get_iter(%view_1557) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1564, %e1_1565, %e2_1566, %e3_1567 = cute.get_leaves(%iter_1563) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %977 = cute.get_scalars(%e0_1564) : !cute.int_tuple<"?">
      %978 = cute.get_scalars(%e1_1565) : !cute.int_tuple<"?">
      %979 = cute.get_scalars(%e2_1566) : !cute.int_tuple<"?">
      %980 = cute.get_scalars(%e3_1567) : !cute.int_tuple<"?{div=8}">
      %iter_1568 = cute.get_iter(%view_1557) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1569, %e1_1570, %e2_1571, %e3_1572 = cute.get_leaves(%iter_1568) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %981 = cute.get_scalars(%e0_1569) : !cute.int_tuple<"?">
      %982 = cute.get_scalars(%e1_1570) : !cute.int_tuple<"?">
      %983 = cute.get_scalars(%e2_1571) : !cute.int_tuple<"?">
      %984 = cute.get_scalars(%e3_1572) : !cute.int_tuple<"?{div=8}">
      %lay_1573 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %985 = cute.get_shape(%lay_1573) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1574, %e1_1575, %e2_1576, %e3_1577 = cute.get_leaves(%985) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1578 = cute.to_int_tuple(%e0_1574) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %986 = cute.get_scalars(%itup_1578) : !cute.int_tuple<"?">
      %itup_1579 = cute.to_int_tuple(%e1_1575) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %987 = cute.get_scalars(%itup_1579) : !cute.int_tuple<"?">
      %itup_1580 = cute.to_int_tuple(%e2_1576) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %988 = cute.get_scalars(%itup_1580) : !cute.int_tuple<"?">
      %itup_1581 = cute.to_int_tuple(%e3_1577) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %989 = cute.get_scalars(%itup_1581) : !cute.int_tuple<"?{div=8}">
      %coord_1582 = cute.make_coord(%e1_1570) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1583 = cute.make_coord(%itup_1579) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %990 = cute.get_scalars(%coord_1582) : !cute.coord<"?">
      %991 = cute.get_scalars(%coord_1583) : !cute.coord<"?">
      %true_1584 = arith.constant true
      %992 = arith.cmpi slt, %990, %991 : i32
      %993 = arith.andi %true_1584, %992 : i1
      scf.if %993 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
        %lay_2735 = cute.get_layout(%view_461) : !memref_gmem_bf16_6
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_2737 = cute.get_iter(%view_461) : !memref_gmem_bf16_6
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2742 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2744 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2749 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2735 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_2737 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %coord_1585 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1586 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1587 = cute.crd2idx(%coord_1585, %lay_1586) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1588 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1589 = cute.add_offset(%iter_1588, %idx_1587) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1590 = cute.make_view(%tup_1589) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1591 = cute.get_iter(%view_1590) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1592, %e1_1593, %e2_1594, %e3_1595 = cute.get_leaves(%iter_1591) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %994 = cute.get_scalars(%e0_1592) : !cute.int_tuple<"?">
      %995 = cute.get_scalars(%e1_1593) : !cute.int_tuple<"?">
      %996 = cute.get_scalars(%e2_1594) : !cute.int_tuple<"?">
      %997 = cute.get_scalars(%e3_1595) : !cute.int_tuple<"?{div=8}">
      %iter_1596 = cute.get_iter(%view_1590) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1597, %e1_1598, %e2_1599, %e3_1600 = cute.get_leaves(%iter_1596) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %998 = cute.get_scalars(%e0_1597) : !cute.int_tuple<"?">
      %999 = cute.get_scalars(%e1_1598) : !cute.int_tuple<"?">
      %1000 = cute.get_scalars(%e2_1599) : !cute.int_tuple<"?">
      %1001 = cute.get_scalars(%e3_1600) : !cute.int_tuple<"?{div=8}">
      %iter_1601 = cute.get_iter(%view_1590) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1602, %e1_1603, %e2_1604, %e3_1605 = cute.get_leaves(%iter_1601) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1002 = cute.get_scalars(%e0_1602) : !cute.int_tuple<"?">
      %1003 = cute.get_scalars(%e1_1603) : !cute.int_tuple<"?">
      %1004 = cute.get_scalars(%e2_1604) : !cute.int_tuple<"?">
      %1005 = cute.get_scalars(%e3_1605) : !cute.int_tuple<"?{div=8}">
      %lay_1606 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1006 = cute.get_shape(%lay_1606) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1607, %e1_1608, %e2_1609, %e3_1610 = cute.get_leaves(%1006) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1611 = cute.to_int_tuple(%e0_1607) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%itup_1611) : !cute.int_tuple<"?">
      %itup_1612 = cute.to_int_tuple(%e1_1608) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1008 = cute.get_scalars(%itup_1612) : !cute.int_tuple<"?">
      %itup_1613 = cute.to_int_tuple(%e2_1609) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1009 = cute.get_scalars(%itup_1613) : !cute.int_tuple<"?">
      %itup_1614 = cute.to_int_tuple(%e3_1610) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1010 = cute.get_scalars(%itup_1614) : !cute.int_tuple<"?{div=8}">
      %coord_1615 = cute.make_coord(%e1_1603) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1616 = cute.make_coord(%itup_1612) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1011 = cute.get_scalars(%coord_1615) : !cute.coord<"?">
      %1012 = cute.get_scalars(%coord_1616) : !cute.coord<"?">
      %true_1617 = arith.constant true
      %1013 = arith.cmpi slt, %1011, %1012 : i32
      %1014 = arith.andi %true_1617, %1013 : i1
      scf.if %1014 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
        %lay_2735 = cute.get_layout(%view_461) : !memref_gmem_bf16_6
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2737 = cute.get_iter(%view_461) : !memref_gmem_bf16_6
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2742 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2744 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2749 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2735 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_2737 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %coord_1618 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1619 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1620 = cute.crd2idx(%coord_1618, %lay_1619) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1621 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1622 = cute.add_offset(%iter_1621, %idx_1620) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1623 = cute.make_view(%tup_1622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1624 = cute.get_iter(%view_1623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1625, %e1_1626, %e2_1627, %e3_1628 = cute.get_leaves(%iter_1624) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1015 = cute.get_scalars(%e0_1625) : !cute.int_tuple<"?">
      %1016 = cute.get_scalars(%e1_1626) : !cute.int_tuple<"?">
      %1017 = cute.get_scalars(%e2_1627) : !cute.int_tuple<"?">
      %1018 = cute.get_scalars(%e3_1628) : !cute.int_tuple<"?{div=8}">
      %iter_1629 = cute.get_iter(%view_1623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1630, %e1_1631, %e2_1632, %e3_1633 = cute.get_leaves(%iter_1629) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1019 = cute.get_scalars(%e0_1630) : !cute.int_tuple<"?">
      %1020 = cute.get_scalars(%e1_1631) : !cute.int_tuple<"?">
      %1021 = cute.get_scalars(%e2_1632) : !cute.int_tuple<"?">
      %1022 = cute.get_scalars(%e3_1633) : !cute.int_tuple<"?{div=8}">
      %iter_1634 = cute.get_iter(%view_1623) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1635, %e1_1636, %e2_1637, %e3_1638 = cute.get_leaves(%iter_1634) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1023 = cute.get_scalars(%e0_1635) : !cute.int_tuple<"?">
      %1024 = cute.get_scalars(%e1_1636) : !cute.int_tuple<"?">
      %1025 = cute.get_scalars(%e2_1637) : !cute.int_tuple<"?">
      %1026 = cute.get_scalars(%e3_1638) : !cute.int_tuple<"?{div=8}">
      %lay_1639 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1027 = cute.get_shape(%lay_1639) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1640, %e1_1641, %e2_1642, %e3_1643 = cute.get_leaves(%1027) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1644 = cute.to_int_tuple(%e0_1640) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1028 = cute.get_scalars(%itup_1644) : !cute.int_tuple<"?">
      %itup_1645 = cute.to_int_tuple(%e1_1641) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1029 = cute.get_scalars(%itup_1645) : !cute.int_tuple<"?">
      %itup_1646 = cute.to_int_tuple(%e2_1642) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1030 = cute.get_scalars(%itup_1646) : !cute.int_tuple<"?">
      %itup_1647 = cute.to_int_tuple(%e3_1643) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1031 = cute.get_scalars(%itup_1647) : !cute.int_tuple<"?{div=8}">
      %coord_1648 = cute.make_coord(%e1_1636) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1649 = cute.make_coord(%itup_1645) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1032 = cute.get_scalars(%coord_1648) : !cute.coord<"?">
      %1033 = cute.get_scalars(%coord_1649) : !cute.coord<"?">
      %true_1650 = arith.constant true
      %1034 = arith.cmpi slt, %1032, %1033 : i32
      %1035 = arith.andi %true_1650, %1034 : i1
      scf.if %1035 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
        %lay_2735 = cute.get_layout(%view_461) : !memref_gmem_bf16_6
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2737 = cute.get_iter(%view_461) : !memref_gmem_bf16_6
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2742 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2744 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2749 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2735 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_2737 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %coord_1651 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1652 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1653 = cute.crd2idx(%coord_1651, %lay_1652) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1654 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1655 = cute.add_offset(%iter_1654, %idx_1653) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1656 = cute.make_view(%tup_1655) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1657 = cute.get_iter(%view_1656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1658, %e1_1659, %e2_1660, %e3_1661 = cute.get_leaves(%iter_1657) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1036 = cute.get_scalars(%e0_1658) : !cute.int_tuple<"?">
      %1037 = cute.get_scalars(%e1_1659) : !cute.int_tuple<"?">
      %1038 = cute.get_scalars(%e2_1660) : !cute.int_tuple<"?">
      %1039 = cute.get_scalars(%e3_1661) : !cute.int_tuple<"?{div=8}">
      %iter_1662 = cute.get_iter(%view_1656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1663, %e1_1664, %e2_1665, %e3_1666 = cute.get_leaves(%iter_1662) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1040 = cute.get_scalars(%e0_1663) : !cute.int_tuple<"?">
      %1041 = cute.get_scalars(%e1_1664) : !cute.int_tuple<"?">
      %1042 = cute.get_scalars(%e2_1665) : !cute.int_tuple<"?">
      %1043 = cute.get_scalars(%e3_1666) : !cute.int_tuple<"?{div=8}">
      %iter_1667 = cute.get_iter(%view_1656) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1668, %e1_1669, %e2_1670, %e3_1671 = cute.get_leaves(%iter_1667) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1044 = cute.get_scalars(%e0_1668) : !cute.int_tuple<"?">
      %1045 = cute.get_scalars(%e1_1669) : !cute.int_tuple<"?">
      %1046 = cute.get_scalars(%e2_1670) : !cute.int_tuple<"?">
      %1047 = cute.get_scalars(%e3_1671) : !cute.int_tuple<"?{div=8}">
      %lay_1672 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1048 = cute.get_shape(%lay_1672) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1673, %e1_1674, %e2_1675, %e3_1676 = cute.get_leaves(%1048) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1677 = cute.to_int_tuple(%e0_1673) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1049 = cute.get_scalars(%itup_1677) : !cute.int_tuple<"?">
      %itup_1678 = cute.to_int_tuple(%e1_1674) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1050 = cute.get_scalars(%itup_1678) : !cute.int_tuple<"?">
      %itup_1679 = cute.to_int_tuple(%e2_1675) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1051 = cute.get_scalars(%itup_1679) : !cute.int_tuple<"?">
      %itup_1680 = cute.to_int_tuple(%e3_1676) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1052 = cute.get_scalars(%itup_1680) : !cute.int_tuple<"?{div=8}">
      %coord_1681 = cute.make_coord(%e1_1669) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1682 = cute.make_coord(%itup_1678) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1053 = cute.get_scalars(%coord_1681) : !cute.coord<"?">
      %1054 = cute.get_scalars(%coord_1682) : !cute.coord<"?">
      %true_1683 = arith.constant true
      %1055 = arith.cmpi slt, %1053, %1054 : i32
      %1056 = arith.andi %true_1683, %1055 : i1
      scf.if %1056 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
        %lay_2735 = cute.get_layout(%view_461) : !memref_gmem_bf16_6
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2737 = cute.get_iter(%view_461) : !memref_gmem_bf16_6
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_8
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_8
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2742 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2744 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_12
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_12
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2749 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_gmem_bf16_8
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_gmem_bf16_8
        %iter_2768 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %lay_2769 = cute.get_layout(%view_2767) : !memref_gmem_bf16_8
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_gmem_bf16_8
        %view_2774 = cute.make_view(%iter_2773) : !memref_gmem_bf16_9
        %iter_2775 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2776 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %lay_2777 = cute.get_layout(%view_2746) : !memref_smem_bf16_12
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_smem_bf16_12
        %iter_2782 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %lay_2783 = cute.get_layout(%view_2781) : !memref_smem_bf16_12
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_smem_bf16_12
        %view_2788 = cute.make_view(%iter_2787) : !memref_smem_bf16_13
        %iter_2789 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %iter_2790 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_gmem_bf16_9
        %iter_2819 = cute.get_iter(%view_2788) : !memref_smem_bf16_13
        %lay_2820 = cute.get_layout(%view_2774) : !memref_gmem_bf16_9
        %lay_2821 = cute.get_layout(%view_2788) : !memref_smem_bf16_13
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_gmem_bf16_10
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_smem_bf16_14
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_gmem_bf16_10
          %iter_2847 = cute.get_iter(%view_2841) : !memref_smem_bf16_14
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.trunc %1608 : i8 to i1
          %iter_2849 = cute.recast_iter(%iter_2846) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2850 = cute.recast_iter(%iter_2847) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2850 : !cute.ptr<i128, smem>, %iter_2849 : !cute.ptr<i128, gmem>, %1609 : i1) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2735 = cute.get_layout(%view_506) : !memref_smem_bf16_3
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_2737 = cute.get_iter(%view_506) : !memref_smem_bf16_3
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_12
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_12
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"16">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_12
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_2745, %e1_2746, %e2_2747 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_2749 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_2750 = cute.get_leaves(%int_tuple_2749) : !cute.int_tuple<"16">
        %cst_2751 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2751 : vector<16xbf16>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2753 = cute.size(%int_tuple_2752) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2754 = cute.get_leaves(%sz_2753) : !cute.int_tuple<"16">
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_2756 = cute.size(%int_tuple_2755) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"16">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_12
      }
      %lay_1684 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %1057 = cute.get_shape(%lay_1684) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
      %e0_1685, %e1_1686, %e2_1687, %e3_1688, %e4_1689 = cute.get_leaves(%1057) : !cute.shape<"((8,1),4,1,?)">
      %itup_1690 = cute.to_int_tuple(%e4_1689) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1058 = cute.get_scalars(%itup_1690) : !cute.int_tuple<"?">
      %int_tuple_1691 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1692 = cute.size(%int_tuple_1691) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1693 = cute.get_leaves(%sz_1692) : !cute.int_tuple<"4">
      %int_tuple_1694 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1695 = cute.size(%int_tuple_1694) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1696 = cute.get_leaves(%sz_1695) : !cute.int_tuple<"1">
      %coord_1697 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1698 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1699 = cute.crd2idx(%coord_1697, %lay_1698) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1700 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1701 = cute.add_offset(%iter_1700, %idx_1699) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1702 = cute.make_view(%tup_1701) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1703 = cute.get_iter(%view_1702) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1704, %e1_1705, %e2_1706, %e3_1707 = cute.get_leaves(%iter_1703) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1059 = cute.get_scalars(%e0_1704) : !cute.int_tuple<"?">
      %1060 = cute.get_scalars(%e1_1705) : !cute.int_tuple<"?">
      %1061 = cute.get_scalars(%e2_1706) : !cute.int_tuple<"?">
      %1062 = cute.get_scalars(%e3_1707) : !cute.int_tuple<"?{div=8}">
      %iter_1708 = cute.get_iter(%view_1702) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1709, %e1_1710, %e2_1711, %e3_1712 = cute.get_leaves(%iter_1708) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1063 = cute.get_scalars(%e0_1709) : !cute.int_tuple<"?">
      %1064 = cute.get_scalars(%e1_1710) : !cute.int_tuple<"?">
      %1065 = cute.get_scalars(%e2_1711) : !cute.int_tuple<"?">
      %1066 = cute.get_scalars(%e3_1712) : !cute.int_tuple<"?{div=8}">
      %iter_1713 = cute.get_iter(%view_1702) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1714, %e1_1715, %e2_1716, %e3_1717 = cute.get_leaves(%iter_1713) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1067 = cute.get_scalars(%e0_1714) : !cute.int_tuple<"?">
      %1068 = cute.get_scalars(%e1_1715) : !cute.int_tuple<"?">
      %1069 = cute.get_scalars(%e2_1716) : !cute.int_tuple<"?">
      %1070 = cute.get_scalars(%e3_1717) : !cute.int_tuple<"?{div=8}">
      %lay_1718 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1071 = cute.get_shape(%lay_1718) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1719, %e1_1720, %e2_1721, %e3_1722 = cute.get_leaves(%1071) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1723 = cute.to_int_tuple(%e0_1719) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1072 = cute.get_scalars(%itup_1723) : !cute.int_tuple<"?">
      %itup_1724 = cute.to_int_tuple(%e1_1720) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1073 = cute.get_scalars(%itup_1724) : !cute.int_tuple<"?">
      %itup_1725 = cute.to_int_tuple(%e2_1721) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1074 = cute.get_scalars(%itup_1725) : !cute.int_tuple<"?">
      %itup_1726 = cute.to_int_tuple(%e3_1722) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1075 = cute.get_scalars(%itup_1726) : !cute.int_tuple<"?{div=8}">
      %coord_1727 = cute.make_coord(%e1_1715) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1728 = cute.make_coord(%itup_1725) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1076 = cute.get_scalars(%coord_1727) : !cute.coord<"?">
      %1077 = cute.get_scalars(%coord_1728) : !cute.coord<"?">
      %true_1729 = arith.constant true
      %1078 = arith.cmpi slt, %1076, %1077 : i32
      %1079 = arith.andi %true_1729, %1078 : i1
      %coord_1730 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1731 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1732 = cute.crd2idx(%coord_1730, %lay_1731) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1733 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1734 = cute.add_offset(%iter_1733, %idx_1732) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1735 = cute.make_view(%tup_1734) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1736 = cute.get_iter(%view_1735) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1737, %e1_1738, %e2_1739, %e3_1740 = cute.get_leaves(%iter_1736) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1080 = cute.get_scalars(%e0_1737) : !cute.int_tuple<"?">
      %1081 = cute.get_scalars(%e1_1738) : !cute.int_tuple<"?">
      %1082 = cute.get_scalars(%e2_1739) : !cute.int_tuple<"?">
      %1083 = cute.get_scalars(%e3_1740) : !cute.int_tuple<"?{div=8}">
      %iter_1741 = cute.get_iter(%view_1735) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1742, %e1_1743, %e2_1744, %e3_1745 = cute.get_leaves(%iter_1741) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1084 = cute.get_scalars(%e0_1742) : !cute.int_tuple<"?">
      %1085 = cute.get_scalars(%e1_1743) : !cute.int_tuple<"?">
      %1086 = cute.get_scalars(%e2_1744) : !cute.int_tuple<"?">
      %1087 = cute.get_scalars(%e3_1745) : !cute.int_tuple<"?{div=8}">
      %iter_1746 = cute.get_iter(%view_1735) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1747, %e1_1748, %e2_1749, %e3_1750 = cute.get_leaves(%iter_1746) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1088 = cute.get_scalars(%e0_1747) : !cute.int_tuple<"?">
      %1089 = cute.get_scalars(%e1_1748) : !cute.int_tuple<"?">
      %1090 = cute.get_scalars(%e2_1749) : !cute.int_tuple<"?">
      %1091 = cute.get_scalars(%e3_1750) : !cute.int_tuple<"?{div=8}">
      %lay_1751 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1092 = cute.get_shape(%lay_1751) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1752, %e1_1753, %e2_1754, %e3_1755 = cute.get_leaves(%1092) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1756 = cute.to_int_tuple(%e0_1752) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1093 = cute.get_scalars(%itup_1756) : !cute.int_tuple<"?">
      %itup_1757 = cute.to_int_tuple(%e1_1753) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1094 = cute.get_scalars(%itup_1757) : !cute.int_tuple<"?">
      %itup_1758 = cute.to_int_tuple(%e2_1754) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1095 = cute.get_scalars(%itup_1758) : !cute.int_tuple<"?">
      %itup_1759 = cute.to_int_tuple(%e3_1755) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1096 = cute.get_scalars(%itup_1759) : !cute.int_tuple<"?{div=8}">
      %coord_1760 = cute.make_coord(%e1_1748) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1761 = cute.make_coord(%itup_1758) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1097 = cute.get_scalars(%coord_1760) : !cute.coord<"?">
      %1098 = cute.get_scalars(%coord_1761) : !cute.coord<"?">
      %true_1762 = arith.constant true
      %1099 = arith.cmpi slt, %1097, %1098 : i32
      %1100 = arith.andi %true_1762, %1099 : i1
      %coord_1763 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
      %lay_1764 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1765 = cute.crd2idx(%coord_1763, %lay_1764) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
      %iter_1766 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1767 = cute.add_offset(%iter_1766, %idx_1765) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1768 = cute.make_view(%tup_1767) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1769 = cute.get_iter(%view_1768) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1770, %e1_1771, %e2_1772, %e3_1773 = cute.get_leaves(%iter_1769) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1101 = cute.get_scalars(%e0_1770) : !cute.int_tuple<"?">
      %1102 = cute.get_scalars(%e1_1771) : !cute.int_tuple<"?">
      %1103 = cute.get_scalars(%e2_1772) : !cute.int_tuple<"?">
      %1104 = cute.get_scalars(%e3_1773) : !cute.int_tuple<"?{div=8}">
      %iter_1774 = cute.get_iter(%view_1768) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1775, %e1_1776, %e2_1777, %e3_1778 = cute.get_leaves(%iter_1774) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1105 = cute.get_scalars(%e0_1775) : !cute.int_tuple<"?">
      %1106 = cute.get_scalars(%e1_1776) : !cute.int_tuple<"?">
      %1107 = cute.get_scalars(%e2_1777) : !cute.int_tuple<"?">
      %1108 = cute.get_scalars(%e3_1778) : !cute.int_tuple<"?{div=8}">
      %iter_1779 = cute.get_iter(%view_1768) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1780, %e1_1781, %e2_1782, %e3_1783 = cute.get_leaves(%iter_1779) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1109 = cute.get_scalars(%e0_1780) : !cute.int_tuple<"?">
      %1110 = cute.get_scalars(%e1_1781) : !cute.int_tuple<"?">
      %1111 = cute.get_scalars(%e2_1782) : !cute.int_tuple<"?">
      %1112 = cute.get_scalars(%e3_1783) : !cute.int_tuple<"?{div=8}">
      %lay_1784 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1113 = cute.get_shape(%lay_1784) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1785, %e1_1786, %e2_1787, %e3_1788 = cute.get_leaves(%1113) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1789 = cute.to_int_tuple(%e0_1785) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1114 = cute.get_scalars(%itup_1789) : !cute.int_tuple<"?">
      %itup_1790 = cute.to_int_tuple(%e1_1786) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1115 = cute.get_scalars(%itup_1790) : !cute.int_tuple<"?">
      %itup_1791 = cute.to_int_tuple(%e2_1787) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1116 = cute.get_scalars(%itup_1791) : !cute.int_tuple<"?">
      %itup_1792 = cute.to_int_tuple(%e3_1788) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1117 = cute.get_scalars(%itup_1792) : !cute.int_tuple<"?{div=8}">
      %coord_1793 = cute.make_coord(%e2_1782) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1794 = cute.make_coord(%itup_1792) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1118 = cute.get_scalars(%coord_1793) : !cute.coord<"?">
      %1119 = cute.get_scalars(%coord_1794) : !cute.coord<"?{div=8}">
      %true_1795 = arith.constant true
      %1120 = arith.cmpi slt, %1118, %1119 : i32
      %1121 = arith.andi %true_1795, %1120 : i1
      %1122 = arith.extui %1100 : i1 to i32
      %c0_i32_1796 = arith.constant 0 : i32
      %1123 = arith.cmpi ne, %1122, %c0_i32_1796 : i32
      %1124 = arith.extui %1100 : i1 to i32
      %1125 = arith.extui %1121 : i1 to i32
      %1126 = arith.select %1123, %1125, %1124 : i32
      %c0_i32_1797 = arith.constant 0 : i32
      %1127 = arith.cmpi ne, %1126, %c0_i32_1797 : i32
      scf.if %1127 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,0,?)">
        %lay_2735 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
        %iter_2737 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_10
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_10
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2742 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2744 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_14
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_14
        %lay_2748 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %1595 = cute.get_shape(%lay_2748) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2749, %e1_2750 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %lay_2751 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %1596 = cute.get_shape(%lay_2751) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2752, %e1_2753 = cute.get_leaves(%1596) : !cute.shape<"((8,1))">
        %lay_2754 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %shape_2755 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2756 = cute.make_layout() : !cute.layout<"1:0">
        %append_2757 = cute.append_to_rank<2> (%lay_2754, %lay_2756) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2758 = cute.make_view(%iter_2740, %append_2757) : !memref_gmem_bf16_11
        %iter_2759 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %lay_2760 = cute.get_layout(%view_2758) : !memref_gmem_bf16_11
        %1597 = cute.get_shape(%lay_2760) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2761, %e1_2762, %e2_2763 = cute.get_leaves(%1597) : !cute.shape<"((8,1),1)">
        %iter_2764 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %view_2765 = cute.make_view(%iter_2764) : !memref_gmem_bf16_12
        %iter_2766 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2767 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %lay_2768 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %shape_2769 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2770 = cute.make_layout() : !cute.layout<"1:0">
        %append_2771 = cute.append_to_rank<2> (%lay_2768, %lay_2770) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2772 = cute.make_view(%iter_2747, %append_2771) : !memref_smem_bf16_15
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %lay_2774 = cute.get_layout(%view_2772) : !memref_smem_bf16_15
        %1598 = cute.get_shape(%lay_2774) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2775, %e1_2776, %e2_2777 = cute.get_leaves(%1598) : !cute.shape<"((8,1),1)">
        %iter_2778 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %view_2779 = cute.make_view(%iter_2778) : !memref_smem_bf16_16
        %iter_2780 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %iter_2781 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2782 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %1599 = cute.get_shape(%lay_2782) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2783, %e1_2784, %e2_2785 = cute.get_leaves(%1599) : !cute.shape<"((8,1),(1))">
        %lay_2786 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %1600 = cute.get_shape(%lay_2786) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2787, %e1_2788, %e2_2789 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(1))">
        %lay_2790 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %sz_2791 = cute.size(%lay_2790) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2792 = cute.get_leaves(%sz_2791) : !cute.int_tuple<"1">
        %lay_2793 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %sz_2794 = cute.size(%lay_2793) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2795 = cute.get_leaves(%sz_2794) : !cute.int_tuple<"1">
        %1601 = cute.static : !cute.layout<"1:0">
        %iter_2796 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2797 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2798 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %lay_2799 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %append_2800 = cute.append_to_rank<2> (%lay_2798, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2801 = cute.append_to_rank<2> (%lay_2799, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2802 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2803 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2804 = cute.size(%lay_2802) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1602 = cute.get_scalars(%sz_2804) : !cute.int_tuple<"1">
        %c0_i32_2805 = arith.constant 0 : i32
        %c1_i32_2806 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2805 to %1602 step %c1_i32_2806  : i32 {
          %coord_2807 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1603 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2808 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2809 = cute.crd2idx(%coord_2807, %lay_2802) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2810 = cute.add_offset(%iter_2796, %idx_2809) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2811 = cute.make_view(%ptr_2810, %lay_2808) : !memref_gmem_bf16_10
          %1604 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2812 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2813 = cute.crd2idx(%coord_2807, %lay_2803) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2814 = cute.add_offset(%iter_2797, %idx_2813) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2815 = cute.make_view(%ptr_2814, %lay_2812) : !memref_smem_bf16_14
          %iter_2816 = cute.get_iter(%view_2811) : !memref_gmem_bf16_10
          %iter_2817 = cute.get_iter(%view_2815) : !memref_smem_bf16_14
          %iter_2818 = cute.recast_iter(%iter_2816) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2819 = cute.recast_iter(%iter_2817) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2819 : !cute.ptr<i128, smem>, %iter_2818 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,0,0)">
        %lay_2735 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
        %iter_2737 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_14
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_14
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"8">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2745, %e1_2746 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %int_tuple_2747 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2749 = cute.get_leaves(%int_tuple_2748) : !cute.int_tuple<"8">
        %cst_2750 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2750 : vector<8xbf16>
        %int_tuple_2751 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2752 = cute.size(%int_tuple_2751) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2753 = cute.get_leaves(%sz_2752) : !cute.int_tuple<"8">
        %int_tuple_2754 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2755 = cute.size(%int_tuple_2754) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2756 = cute.get_leaves(%sz_2755) : !cute.int_tuple<"8">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_14
      }
      %int_tuple_1798 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1799 = cute.size(%int_tuple_1798) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1800 = cute.get_leaves(%sz_1799) : !cute.int_tuple<"1">
      %coord_1801 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1802 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1803 = cute.crd2idx(%coord_1801, %lay_1802) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1804 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1805 = cute.add_offset(%iter_1804, %idx_1803) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1806 = cute.make_view(%tup_1805) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1807 = cute.get_iter(%view_1806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1808, %e1_1809, %e2_1810, %e3_1811 = cute.get_leaves(%iter_1807) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1128 = cute.get_scalars(%e0_1808) : !cute.int_tuple<"?">
      %1129 = cute.get_scalars(%e1_1809) : !cute.int_tuple<"?">
      %1130 = cute.get_scalars(%e2_1810) : !cute.int_tuple<"?">
      %1131 = cute.get_scalars(%e3_1811) : !cute.int_tuple<"?{div=8}">
      %iter_1812 = cute.get_iter(%view_1806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1813, %e1_1814, %e2_1815, %e3_1816 = cute.get_leaves(%iter_1812) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1132 = cute.get_scalars(%e0_1813) : !cute.int_tuple<"?">
      %1133 = cute.get_scalars(%e1_1814) : !cute.int_tuple<"?">
      %1134 = cute.get_scalars(%e2_1815) : !cute.int_tuple<"?">
      %1135 = cute.get_scalars(%e3_1816) : !cute.int_tuple<"?{div=8}">
      %iter_1817 = cute.get_iter(%view_1806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1818, %e1_1819, %e2_1820, %e3_1821 = cute.get_leaves(%iter_1817) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1136 = cute.get_scalars(%e0_1818) : !cute.int_tuple<"?">
      %1137 = cute.get_scalars(%e1_1819) : !cute.int_tuple<"?">
      %1138 = cute.get_scalars(%e2_1820) : !cute.int_tuple<"?">
      %1139 = cute.get_scalars(%e3_1821) : !cute.int_tuple<"?{div=8}">
      %lay_1822 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1140 = cute.get_shape(%lay_1822) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1823, %e1_1824, %e2_1825, %e3_1826 = cute.get_leaves(%1140) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1827 = cute.to_int_tuple(%e0_1823) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1141 = cute.get_scalars(%itup_1827) : !cute.int_tuple<"?">
      %itup_1828 = cute.to_int_tuple(%e1_1824) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1142 = cute.get_scalars(%itup_1828) : !cute.int_tuple<"?">
      %itup_1829 = cute.to_int_tuple(%e2_1825) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1143 = cute.get_scalars(%itup_1829) : !cute.int_tuple<"?">
      %itup_1830 = cute.to_int_tuple(%e3_1826) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1144 = cute.get_scalars(%itup_1830) : !cute.int_tuple<"?{div=8}">
      %coord_1831 = cute.make_coord(%e1_1819) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1832 = cute.make_coord(%itup_1829) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1145 = cute.get_scalars(%coord_1831) : !cute.coord<"?">
      %1146 = cute.get_scalars(%coord_1832) : !cute.coord<"?">
      %true_1833 = arith.constant true
      %1147 = arith.cmpi slt, %1145, %1146 : i32
      %1148 = arith.andi %true_1833, %1147 : i1
      %coord_1834 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1835 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1836 = cute.crd2idx(%coord_1834, %lay_1835) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1837 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1838 = cute.add_offset(%iter_1837, %idx_1836) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1839 = cute.make_view(%tup_1838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1840 = cute.get_iter(%view_1839) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1841, %e1_1842, %e2_1843, %e3_1844 = cute.get_leaves(%iter_1840) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1149 = cute.get_scalars(%e0_1841) : !cute.int_tuple<"?">
      %1150 = cute.get_scalars(%e1_1842) : !cute.int_tuple<"?">
      %1151 = cute.get_scalars(%e2_1843) : !cute.int_tuple<"?">
      %1152 = cute.get_scalars(%e3_1844) : !cute.int_tuple<"?{div=8}">
      %iter_1845 = cute.get_iter(%view_1839) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1846, %e1_1847, %e2_1848, %e3_1849 = cute.get_leaves(%iter_1845) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1153 = cute.get_scalars(%e0_1846) : !cute.int_tuple<"?">
      %1154 = cute.get_scalars(%e1_1847) : !cute.int_tuple<"?">
      %1155 = cute.get_scalars(%e2_1848) : !cute.int_tuple<"?">
      %1156 = cute.get_scalars(%e3_1849) : !cute.int_tuple<"?{div=8}">
      %iter_1850 = cute.get_iter(%view_1839) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1851, %e1_1852, %e2_1853, %e3_1854 = cute.get_leaves(%iter_1850) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1157 = cute.get_scalars(%e0_1851) : !cute.int_tuple<"?">
      %1158 = cute.get_scalars(%e1_1852) : !cute.int_tuple<"?">
      %1159 = cute.get_scalars(%e2_1853) : !cute.int_tuple<"?">
      %1160 = cute.get_scalars(%e3_1854) : !cute.int_tuple<"?{div=8}">
      %lay_1855 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1161 = cute.get_shape(%lay_1855) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1856, %e1_1857, %e2_1858, %e3_1859 = cute.get_leaves(%1161) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1860 = cute.to_int_tuple(%e0_1856) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1162 = cute.get_scalars(%itup_1860) : !cute.int_tuple<"?">
      %itup_1861 = cute.to_int_tuple(%e1_1857) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1163 = cute.get_scalars(%itup_1861) : !cute.int_tuple<"?">
      %itup_1862 = cute.to_int_tuple(%e2_1858) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1164 = cute.get_scalars(%itup_1862) : !cute.int_tuple<"?">
      %itup_1863 = cute.to_int_tuple(%e3_1859) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1165 = cute.get_scalars(%itup_1863) : !cute.int_tuple<"?{div=8}">
      %coord_1864 = cute.make_coord(%e1_1852) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1865 = cute.make_coord(%itup_1862) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1166 = cute.get_scalars(%coord_1864) : !cute.coord<"?">
      %1167 = cute.get_scalars(%coord_1865) : !cute.coord<"?">
      %true_1866 = arith.constant true
      %1168 = arith.cmpi slt, %1166, %1167 : i32
      %1169 = arith.andi %true_1866, %1168 : i1
      %coord_1867 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
      %lay_1868 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1869 = cute.crd2idx(%coord_1867, %lay_1868) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
      %iter_1870 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1871 = cute.add_offset(%iter_1870, %idx_1869) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1872 = cute.make_view(%tup_1871) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1873 = cute.get_iter(%view_1872) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1874, %e1_1875, %e2_1876, %e3_1877 = cute.get_leaves(%iter_1873) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1170 = cute.get_scalars(%e0_1874) : !cute.int_tuple<"?">
      %1171 = cute.get_scalars(%e1_1875) : !cute.int_tuple<"?">
      %1172 = cute.get_scalars(%e2_1876) : !cute.int_tuple<"?">
      %1173 = cute.get_scalars(%e3_1877) : !cute.int_tuple<"?{div=8}">
      %iter_1878 = cute.get_iter(%view_1872) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1879, %e1_1880, %e2_1881, %e3_1882 = cute.get_leaves(%iter_1878) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1174 = cute.get_scalars(%e0_1879) : !cute.int_tuple<"?">
      %1175 = cute.get_scalars(%e1_1880) : !cute.int_tuple<"?">
      %1176 = cute.get_scalars(%e2_1881) : !cute.int_tuple<"?">
      %1177 = cute.get_scalars(%e3_1882) : !cute.int_tuple<"?{div=8}">
      %iter_1883 = cute.get_iter(%view_1872) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1884, %e1_1885, %e2_1886, %e3_1887 = cute.get_leaves(%iter_1883) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1178 = cute.get_scalars(%e0_1884) : !cute.int_tuple<"?">
      %1179 = cute.get_scalars(%e1_1885) : !cute.int_tuple<"?">
      %1180 = cute.get_scalars(%e2_1886) : !cute.int_tuple<"?">
      %1181 = cute.get_scalars(%e3_1887) : !cute.int_tuple<"?{div=8}">
      %lay_1888 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1182 = cute.get_shape(%lay_1888) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1889, %e1_1890, %e2_1891, %e3_1892 = cute.get_leaves(%1182) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1893 = cute.to_int_tuple(%e0_1889) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1183 = cute.get_scalars(%itup_1893) : !cute.int_tuple<"?">
      %itup_1894 = cute.to_int_tuple(%e1_1890) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1184 = cute.get_scalars(%itup_1894) : !cute.int_tuple<"?">
      %itup_1895 = cute.to_int_tuple(%e2_1891) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1185 = cute.get_scalars(%itup_1895) : !cute.int_tuple<"?">
      %itup_1896 = cute.to_int_tuple(%e3_1892) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1186 = cute.get_scalars(%itup_1896) : !cute.int_tuple<"?{div=8}">
      %coord_1897 = cute.make_coord(%e2_1886) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1898 = cute.make_coord(%itup_1896) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1187 = cute.get_scalars(%coord_1897) : !cute.coord<"?">
      %1188 = cute.get_scalars(%coord_1898) : !cute.coord<"?{div=8}">
      %true_1899 = arith.constant true
      %1189 = arith.cmpi slt, %1187, %1188 : i32
      %1190 = arith.andi %true_1899, %1189 : i1
      %1191 = arith.extui %1169 : i1 to i32
      %1192 = arith.cmpi ne, %1191, %c0_i32_1796 : i32
      %1193 = arith.extui %1169 : i1 to i32
      %1194 = arith.extui %1190 : i1 to i32
      %1195 = arith.select %1192, %1194, %1193 : i32
      %1196 = arith.cmpi ne, %1195, %c0_i32_1797 : i32
      scf.if %1196 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,0,?)">
        %lay_2735 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2737 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_10
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_10
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2742 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2744 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_14
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_14
        %lay_2748 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %1595 = cute.get_shape(%lay_2748) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2749, %e1_2750 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %lay_2751 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %1596 = cute.get_shape(%lay_2751) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2752, %e1_2753 = cute.get_leaves(%1596) : !cute.shape<"((8,1))">
        %lay_2754 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %shape_2755 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2756 = cute.make_layout() : !cute.layout<"1:0">
        %append_2757 = cute.append_to_rank<2> (%lay_2754, %lay_2756) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2758 = cute.make_view(%iter_2740, %append_2757) : !memref_gmem_bf16_11
        %iter_2759 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %lay_2760 = cute.get_layout(%view_2758) : !memref_gmem_bf16_11
        %1597 = cute.get_shape(%lay_2760) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2761, %e1_2762, %e2_2763 = cute.get_leaves(%1597) : !cute.shape<"((8,1),1)">
        %iter_2764 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %view_2765 = cute.make_view(%iter_2764) : !memref_gmem_bf16_12
        %iter_2766 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2767 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %lay_2768 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %shape_2769 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2770 = cute.make_layout() : !cute.layout<"1:0">
        %append_2771 = cute.append_to_rank<2> (%lay_2768, %lay_2770) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2772 = cute.make_view(%iter_2747, %append_2771) : !memref_smem_bf16_15
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %lay_2774 = cute.get_layout(%view_2772) : !memref_smem_bf16_15
        %1598 = cute.get_shape(%lay_2774) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2775, %e1_2776, %e2_2777 = cute.get_leaves(%1598) : !cute.shape<"((8,1),1)">
        %iter_2778 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %view_2779 = cute.make_view(%iter_2778) : !memref_smem_bf16_16
        %iter_2780 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %iter_2781 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2782 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %1599 = cute.get_shape(%lay_2782) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2783, %e1_2784, %e2_2785 = cute.get_leaves(%1599) : !cute.shape<"((8,1),(1))">
        %lay_2786 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %1600 = cute.get_shape(%lay_2786) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2787, %e1_2788, %e2_2789 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(1))">
        %lay_2790 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %sz_2791 = cute.size(%lay_2790) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2792 = cute.get_leaves(%sz_2791) : !cute.int_tuple<"1">
        %lay_2793 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %sz_2794 = cute.size(%lay_2793) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2795 = cute.get_leaves(%sz_2794) : !cute.int_tuple<"1">
        %1601 = cute.static : !cute.layout<"1:0">
        %iter_2796 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2797 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2798 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %lay_2799 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %append_2800 = cute.append_to_rank<2> (%lay_2798, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2801 = cute.append_to_rank<2> (%lay_2799, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2802 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2803 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2804 = cute.size(%lay_2802) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1602 = cute.get_scalars(%sz_2804) : !cute.int_tuple<"1">
        %c0_i32_2805 = arith.constant 0 : i32
        %c1_i32_2806 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2805 to %1602 step %c1_i32_2806  : i32 {
          %coord_2807 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1603 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2808 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2809 = cute.crd2idx(%coord_2807, %lay_2802) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2810 = cute.add_offset(%iter_2796, %idx_2809) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2811 = cute.make_view(%ptr_2810, %lay_2808) : !memref_gmem_bf16_10
          %1604 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2812 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2813 = cute.crd2idx(%coord_2807, %lay_2803) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2814 = cute.add_offset(%iter_2797, %idx_2813) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2815 = cute.make_view(%ptr_2814, %lay_2812) : !memref_smem_bf16_14
          %iter_2816 = cute.get_iter(%view_2811) : !memref_gmem_bf16_10
          %iter_2817 = cute.get_iter(%view_2815) : !memref_smem_bf16_14
          %iter_2818 = cute.recast_iter(%iter_2816) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2819 = cute.recast_iter(%iter_2817) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2819 : !cute.ptr<i128, smem>, %iter_2818 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,1,0)">
        %lay_2735 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
        %iter_2737 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_14
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_14
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"8">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2745, %e1_2746 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %int_tuple_2747 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2749 = cute.get_leaves(%int_tuple_2748) : !cute.int_tuple<"8">
        %cst_2750 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2750 : vector<8xbf16>
        %int_tuple_2751 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2752 = cute.size(%int_tuple_2751) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2753 = cute.get_leaves(%sz_2752) : !cute.int_tuple<"8">
        %int_tuple_2754 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2755 = cute.size(%int_tuple_2754) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2756 = cute.get_leaves(%sz_2755) : !cute.int_tuple<"8">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_14
      }
      %int_tuple_1900 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_1901 = cute.size(%int_tuple_1900) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_1902 = cute.get_leaves(%sz_1901) : !cute.int_tuple<"1">
      %coord_1903 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1904 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1905 = cute.crd2idx(%coord_1903, %lay_1904) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1906 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1907 = cute.add_offset(%iter_1906, %idx_1905) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1908 = cute.make_view(%tup_1907) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1909 = cute.get_iter(%view_1908) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1910, %e1_1911, %e2_1912, %e3_1913 = cute.get_leaves(%iter_1909) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1197 = cute.get_scalars(%e0_1910) : !cute.int_tuple<"?">
      %1198 = cute.get_scalars(%e1_1911) : !cute.int_tuple<"?">
      %1199 = cute.get_scalars(%e2_1912) : !cute.int_tuple<"?">
      %1200 = cute.get_scalars(%e3_1913) : !cute.int_tuple<"?{div=8}">
      %iter_1914 = cute.get_iter(%view_1908) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1915, %e1_1916, %e2_1917, %e3_1918 = cute.get_leaves(%iter_1914) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1201 = cute.get_scalars(%e0_1915) : !cute.int_tuple<"?">
      %1202 = cute.get_scalars(%e1_1916) : !cute.int_tuple<"?">
      %1203 = cute.get_scalars(%e2_1917) : !cute.int_tuple<"?">
      %1204 = cute.get_scalars(%e3_1918) : !cute.int_tuple<"?{div=8}">
      %iter_1919 = cute.get_iter(%view_1908) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1920, %e1_1921, %e2_1922, %e3_1923 = cute.get_leaves(%iter_1919) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1205 = cute.get_scalars(%e0_1920) : !cute.int_tuple<"?">
      %1206 = cute.get_scalars(%e1_1921) : !cute.int_tuple<"?">
      %1207 = cute.get_scalars(%e2_1922) : !cute.int_tuple<"?">
      %1208 = cute.get_scalars(%e3_1923) : !cute.int_tuple<"?{div=8}">
      %lay_1924 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1209 = cute.get_shape(%lay_1924) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1925, %e1_1926, %e2_1927, %e3_1928 = cute.get_leaves(%1209) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1929 = cute.to_int_tuple(%e0_1925) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1210 = cute.get_scalars(%itup_1929) : !cute.int_tuple<"?">
      %itup_1930 = cute.to_int_tuple(%e1_1926) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1211 = cute.get_scalars(%itup_1930) : !cute.int_tuple<"?">
      %itup_1931 = cute.to_int_tuple(%e2_1927) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1212 = cute.get_scalars(%itup_1931) : !cute.int_tuple<"?">
      %itup_1932 = cute.to_int_tuple(%e3_1928) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1213 = cute.get_scalars(%itup_1932) : !cute.int_tuple<"?{div=8}">
      %coord_1933 = cute.make_coord(%e1_1921) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1934 = cute.make_coord(%itup_1931) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1214 = cute.get_scalars(%coord_1933) : !cute.coord<"?">
      %1215 = cute.get_scalars(%coord_1934) : !cute.coord<"?">
      %true_1935 = arith.constant true
      %1216 = arith.cmpi slt, %1214, %1215 : i32
      %1217 = arith.andi %true_1935, %1216 : i1
      %coord_1936 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1937 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1938 = cute.crd2idx(%coord_1936, %lay_1937) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1939 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1940 = cute.add_offset(%iter_1939, %idx_1938) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1941 = cute.make_view(%tup_1940) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1942 = cute.get_iter(%view_1941) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1943, %e1_1944, %e2_1945, %e3_1946 = cute.get_leaves(%iter_1942) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1218 = cute.get_scalars(%e0_1943) : !cute.int_tuple<"?">
      %1219 = cute.get_scalars(%e1_1944) : !cute.int_tuple<"?">
      %1220 = cute.get_scalars(%e2_1945) : !cute.int_tuple<"?">
      %1221 = cute.get_scalars(%e3_1946) : !cute.int_tuple<"?{div=8}">
      %iter_1947 = cute.get_iter(%view_1941) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1948, %e1_1949, %e2_1950, %e3_1951 = cute.get_leaves(%iter_1947) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1222 = cute.get_scalars(%e0_1948) : !cute.int_tuple<"?">
      %1223 = cute.get_scalars(%e1_1949) : !cute.int_tuple<"?">
      %1224 = cute.get_scalars(%e2_1950) : !cute.int_tuple<"?">
      %1225 = cute.get_scalars(%e3_1951) : !cute.int_tuple<"?{div=8}">
      %iter_1952 = cute.get_iter(%view_1941) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1953, %e1_1954, %e2_1955, %e3_1956 = cute.get_leaves(%iter_1952) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1226 = cute.get_scalars(%e0_1953) : !cute.int_tuple<"?">
      %1227 = cute.get_scalars(%e1_1954) : !cute.int_tuple<"?">
      %1228 = cute.get_scalars(%e2_1955) : !cute.int_tuple<"?">
      %1229 = cute.get_scalars(%e3_1956) : !cute.int_tuple<"?{div=8}">
      %lay_1957 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1230 = cute.get_shape(%lay_1957) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1958, %e1_1959, %e2_1960, %e3_1961 = cute.get_leaves(%1230) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1962 = cute.to_int_tuple(%e0_1958) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1231 = cute.get_scalars(%itup_1962) : !cute.int_tuple<"?">
      %itup_1963 = cute.to_int_tuple(%e1_1959) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1232 = cute.get_scalars(%itup_1963) : !cute.int_tuple<"?">
      %itup_1964 = cute.to_int_tuple(%e2_1960) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1233 = cute.get_scalars(%itup_1964) : !cute.int_tuple<"?">
      %itup_1965 = cute.to_int_tuple(%e3_1961) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1234 = cute.get_scalars(%itup_1965) : !cute.int_tuple<"?{div=8}">
      %coord_1966 = cute.make_coord(%e1_1954) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1967 = cute.make_coord(%itup_1964) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1235 = cute.get_scalars(%coord_1966) : !cute.coord<"?">
      %1236 = cute.get_scalars(%coord_1967) : !cute.coord<"?">
      %true_1968 = arith.constant true
      %1237 = arith.cmpi slt, %1235, %1236 : i32
      %1238 = arith.andi %true_1968, %1237 : i1
      %coord_1969 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
      %lay_1970 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_1971 = cute.crd2idx(%coord_1969, %lay_1970) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
      %iter_1972 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_1973 = cute.add_offset(%iter_1972, %idx_1971) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1974 = cute.make_view(%tup_1973) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1975 = cute.get_iter(%view_1974) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1976, %e1_1977, %e2_1978, %e3_1979 = cute.get_leaves(%iter_1975) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1239 = cute.get_scalars(%e0_1976) : !cute.int_tuple<"?">
      %1240 = cute.get_scalars(%e1_1977) : !cute.int_tuple<"?">
      %1241 = cute.get_scalars(%e2_1978) : !cute.int_tuple<"?">
      %1242 = cute.get_scalars(%e3_1979) : !cute.int_tuple<"?{div=8}">
      %iter_1980 = cute.get_iter(%view_1974) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1981, %e1_1982, %e2_1983, %e3_1984 = cute.get_leaves(%iter_1980) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1243 = cute.get_scalars(%e0_1981) : !cute.int_tuple<"?">
      %1244 = cute.get_scalars(%e1_1982) : !cute.int_tuple<"?">
      %1245 = cute.get_scalars(%e2_1983) : !cute.int_tuple<"?">
      %1246 = cute.get_scalars(%e3_1984) : !cute.int_tuple<"?{div=8}">
      %iter_1985 = cute.get_iter(%view_1974) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1986, %e1_1987, %e2_1988, %e3_1989 = cute.get_leaves(%iter_1985) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1247 = cute.get_scalars(%e0_1986) : !cute.int_tuple<"?">
      %1248 = cute.get_scalars(%e1_1987) : !cute.int_tuple<"?">
      %1249 = cute.get_scalars(%e2_1988) : !cute.int_tuple<"?">
      %1250 = cute.get_scalars(%e3_1989) : !cute.int_tuple<"?{div=8}">
      %lay_1990 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1251 = cute.get_shape(%lay_1990) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1991, %e1_1992, %e2_1993, %e3_1994 = cute.get_leaves(%1251) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1995 = cute.to_int_tuple(%e0_1991) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1252 = cute.get_scalars(%itup_1995) : !cute.int_tuple<"?">
      %itup_1996 = cute.to_int_tuple(%e1_1992) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1253 = cute.get_scalars(%itup_1996) : !cute.int_tuple<"?">
      %itup_1997 = cute.to_int_tuple(%e2_1993) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1254 = cute.get_scalars(%itup_1997) : !cute.int_tuple<"?">
      %itup_1998 = cute.to_int_tuple(%e3_1994) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1255 = cute.get_scalars(%itup_1998) : !cute.int_tuple<"?{div=8}">
      %coord_1999 = cute.make_coord(%e2_1988) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2000 = cute.make_coord(%itup_1998) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1256 = cute.get_scalars(%coord_1999) : !cute.coord<"?">
      %1257 = cute.get_scalars(%coord_2000) : !cute.coord<"?{div=8}">
      %true_2001 = arith.constant true
      %1258 = arith.cmpi slt, %1256, %1257 : i32
      %1259 = arith.andi %true_2001, %1258 : i1
      %1260 = arith.extui %1238 : i1 to i32
      %1261 = arith.cmpi ne, %1260, %c0_i32_1796 : i32
      %1262 = arith.extui %1238 : i1 to i32
      %1263 = arith.extui %1259 : i1 to i32
      %1264 = arith.select %1261, %1263, %1262 : i32
      %1265 = arith.cmpi ne, %1264, %c0_i32_1797 : i32
      scf.if %1265 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,0,?)">
        %lay_2735 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2737 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_10
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_10
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2742 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2744 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_14
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_14
        %lay_2748 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %1595 = cute.get_shape(%lay_2748) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2749, %e1_2750 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %lay_2751 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %1596 = cute.get_shape(%lay_2751) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2752, %e1_2753 = cute.get_leaves(%1596) : !cute.shape<"((8,1))">
        %lay_2754 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %shape_2755 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2756 = cute.make_layout() : !cute.layout<"1:0">
        %append_2757 = cute.append_to_rank<2> (%lay_2754, %lay_2756) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2758 = cute.make_view(%iter_2740, %append_2757) : !memref_gmem_bf16_11
        %iter_2759 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %lay_2760 = cute.get_layout(%view_2758) : !memref_gmem_bf16_11
        %1597 = cute.get_shape(%lay_2760) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2761, %e1_2762, %e2_2763 = cute.get_leaves(%1597) : !cute.shape<"((8,1),1)">
        %iter_2764 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %view_2765 = cute.make_view(%iter_2764) : !memref_gmem_bf16_12
        %iter_2766 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2767 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %lay_2768 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %shape_2769 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2770 = cute.make_layout() : !cute.layout<"1:0">
        %append_2771 = cute.append_to_rank<2> (%lay_2768, %lay_2770) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2772 = cute.make_view(%iter_2747, %append_2771) : !memref_smem_bf16_15
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %lay_2774 = cute.get_layout(%view_2772) : !memref_smem_bf16_15
        %1598 = cute.get_shape(%lay_2774) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2775, %e1_2776, %e2_2777 = cute.get_leaves(%1598) : !cute.shape<"((8,1),1)">
        %iter_2778 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %view_2779 = cute.make_view(%iter_2778) : !memref_smem_bf16_16
        %iter_2780 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %iter_2781 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2782 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %1599 = cute.get_shape(%lay_2782) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2783, %e1_2784, %e2_2785 = cute.get_leaves(%1599) : !cute.shape<"((8,1),(1))">
        %lay_2786 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %1600 = cute.get_shape(%lay_2786) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2787, %e1_2788, %e2_2789 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(1))">
        %lay_2790 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %sz_2791 = cute.size(%lay_2790) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2792 = cute.get_leaves(%sz_2791) : !cute.int_tuple<"1">
        %lay_2793 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %sz_2794 = cute.size(%lay_2793) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2795 = cute.get_leaves(%sz_2794) : !cute.int_tuple<"1">
        %1601 = cute.static : !cute.layout<"1:0">
        %iter_2796 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2797 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2798 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %lay_2799 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %append_2800 = cute.append_to_rank<2> (%lay_2798, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2801 = cute.append_to_rank<2> (%lay_2799, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2802 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2803 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2804 = cute.size(%lay_2802) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1602 = cute.get_scalars(%sz_2804) : !cute.int_tuple<"1">
        %c0_i32_2805 = arith.constant 0 : i32
        %c1_i32_2806 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2805 to %1602 step %c1_i32_2806  : i32 {
          %coord_2807 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1603 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2808 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2809 = cute.crd2idx(%coord_2807, %lay_2802) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2810 = cute.add_offset(%iter_2796, %idx_2809) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2811 = cute.make_view(%ptr_2810, %lay_2808) : !memref_gmem_bf16_10
          %1604 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2812 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2813 = cute.crd2idx(%coord_2807, %lay_2803) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2814 = cute.add_offset(%iter_2797, %idx_2813) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2815 = cute.make_view(%ptr_2814, %lay_2812) : !memref_smem_bf16_14
          %iter_2816 = cute.get_iter(%view_2811) : !memref_gmem_bf16_10
          %iter_2817 = cute.get_iter(%view_2815) : !memref_smem_bf16_14
          %iter_2818 = cute.recast_iter(%iter_2816) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2819 = cute.recast_iter(%iter_2817) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2819 : !cute.ptr<i128, smem>, %iter_2818 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,2,0)">
        %lay_2735 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
        %iter_2737 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_14
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_14
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"8">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2745, %e1_2746 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %int_tuple_2747 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2749 = cute.get_leaves(%int_tuple_2748) : !cute.int_tuple<"8">
        %cst_2750 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2750 : vector<8xbf16>
        %int_tuple_2751 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2752 = cute.size(%int_tuple_2751) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2753 = cute.get_leaves(%sz_2752) : !cute.int_tuple<"8">
        %int_tuple_2754 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2755 = cute.size(%int_tuple_2754) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2756 = cute.get_leaves(%sz_2755) : !cute.int_tuple<"8">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_14
      }
      %int_tuple_2002 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %sz_2003 = cute.size(%int_tuple_2002) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
      %e0_2004 = cute.get_leaves(%sz_2003) : !cute.int_tuple<"1">
      %coord_2005 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_2006 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_2007 = cute.crd2idx(%coord_2005, %lay_2006) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_2008 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_2009 = cute.add_offset(%iter_2008, %idx_2007) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2010 = cute.make_view(%tup_2009) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2011 = cute.get_iter(%view_2010) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2012, %e1_2013, %e2_2014, %e3_2015 = cute.get_leaves(%iter_2011) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1266 = cute.get_scalars(%e0_2012) : !cute.int_tuple<"?">
      %1267 = cute.get_scalars(%e1_2013) : !cute.int_tuple<"?">
      %1268 = cute.get_scalars(%e2_2014) : !cute.int_tuple<"?">
      %1269 = cute.get_scalars(%e3_2015) : !cute.int_tuple<"?{div=8}">
      %iter_2016 = cute.get_iter(%view_2010) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2017, %e1_2018, %e2_2019, %e3_2020 = cute.get_leaves(%iter_2016) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1270 = cute.get_scalars(%e0_2017) : !cute.int_tuple<"?">
      %1271 = cute.get_scalars(%e1_2018) : !cute.int_tuple<"?">
      %1272 = cute.get_scalars(%e2_2019) : !cute.int_tuple<"?">
      %1273 = cute.get_scalars(%e3_2020) : !cute.int_tuple<"?{div=8}">
      %iter_2021 = cute.get_iter(%view_2010) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2022, %e1_2023, %e2_2024, %e3_2025 = cute.get_leaves(%iter_2021) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1274 = cute.get_scalars(%e0_2022) : !cute.int_tuple<"?">
      %1275 = cute.get_scalars(%e1_2023) : !cute.int_tuple<"?">
      %1276 = cute.get_scalars(%e2_2024) : !cute.int_tuple<"?">
      %1277 = cute.get_scalars(%e3_2025) : !cute.int_tuple<"?{div=8}">
      %lay_2026 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1278 = cute.get_shape(%lay_2026) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2027, %e1_2028, %e2_2029, %e3_2030 = cute.get_leaves(%1278) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2031 = cute.to_int_tuple(%e0_2027) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1279 = cute.get_scalars(%itup_2031) : !cute.int_tuple<"?">
      %itup_2032 = cute.to_int_tuple(%e1_2028) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1280 = cute.get_scalars(%itup_2032) : !cute.int_tuple<"?">
      %itup_2033 = cute.to_int_tuple(%e2_2029) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1281 = cute.get_scalars(%itup_2033) : !cute.int_tuple<"?">
      %itup_2034 = cute.to_int_tuple(%e3_2030) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1282 = cute.get_scalars(%itup_2034) : !cute.int_tuple<"?{div=8}">
      %coord_2035 = cute.make_coord(%e1_2023) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2036 = cute.make_coord(%itup_2033) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1283 = cute.get_scalars(%coord_2035) : !cute.coord<"?">
      %1284 = cute.get_scalars(%coord_2036) : !cute.coord<"?">
      %true_2037 = arith.constant true
      %1285 = arith.cmpi slt, %1283, %1284 : i32
      %1286 = arith.andi %true_2037, %1285 : i1
      %coord_2038 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_2039 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_2040 = cute.crd2idx(%coord_2038, %lay_2039) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_2041 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_2042 = cute.add_offset(%iter_2041, %idx_2040) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2043 = cute.make_view(%tup_2042) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2044 = cute.get_iter(%view_2043) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2045, %e1_2046, %e2_2047, %e3_2048 = cute.get_leaves(%iter_2044) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1287 = cute.get_scalars(%e0_2045) : !cute.int_tuple<"?">
      %1288 = cute.get_scalars(%e1_2046) : !cute.int_tuple<"?">
      %1289 = cute.get_scalars(%e2_2047) : !cute.int_tuple<"?">
      %1290 = cute.get_scalars(%e3_2048) : !cute.int_tuple<"?{div=8}">
      %iter_2049 = cute.get_iter(%view_2043) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2050, %e1_2051, %e2_2052, %e3_2053 = cute.get_leaves(%iter_2049) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1291 = cute.get_scalars(%e0_2050) : !cute.int_tuple<"?">
      %1292 = cute.get_scalars(%e1_2051) : !cute.int_tuple<"?">
      %1293 = cute.get_scalars(%e2_2052) : !cute.int_tuple<"?">
      %1294 = cute.get_scalars(%e3_2053) : !cute.int_tuple<"?{div=8}">
      %iter_2054 = cute.get_iter(%view_2043) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2055, %e1_2056, %e2_2057, %e3_2058 = cute.get_leaves(%iter_2054) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1295 = cute.get_scalars(%e0_2055) : !cute.int_tuple<"?">
      %1296 = cute.get_scalars(%e1_2056) : !cute.int_tuple<"?">
      %1297 = cute.get_scalars(%e2_2057) : !cute.int_tuple<"?">
      %1298 = cute.get_scalars(%e3_2058) : !cute.int_tuple<"?{div=8}">
      %lay_2059 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1299 = cute.get_shape(%lay_2059) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2060, %e1_2061, %e2_2062, %e3_2063 = cute.get_leaves(%1299) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2064 = cute.to_int_tuple(%e0_2060) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1300 = cute.get_scalars(%itup_2064) : !cute.int_tuple<"?">
      %itup_2065 = cute.to_int_tuple(%e1_2061) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1301 = cute.get_scalars(%itup_2065) : !cute.int_tuple<"?">
      %itup_2066 = cute.to_int_tuple(%e2_2062) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1302 = cute.get_scalars(%itup_2066) : !cute.int_tuple<"?">
      %itup_2067 = cute.to_int_tuple(%e3_2063) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1303 = cute.get_scalars(%itup_2067) : !cute.int_tuple<"?{div=8}">
      %coord_2068 = cute.make_coord(%e1_2056) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2069 = cute.make_coord(%itup_2066) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1304 = cute.get_scalars(%coord_2068) : !cute.coord<"?">
      %1305 = cute.get_scalars(%coord_2069) : !cute.coord<"?">
      %true_2070 = arith.constant true
      %1306 = arith.cmpi slt, %1304, %1305 : i32
      %1307 = arith.andi %true_2070, %1306 : i1
      %coord_2071 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
      %lay_2072 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %idx_2073 = cute.crd2idx(%coord_2071, %lay_2072) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
      %iter_2074 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
      %tup_2075 = cute.add_offset(%iter_2074, %idx_2073) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2076 = cute.make_view(%tup_2075) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2077 = cute.get_iter(%view_2076) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2078, %e1_2079, %e2_2080, %e3_2081 = cute.get_leaves(%iter_2077) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1308 = cute.get_scalars(%e0_2078) : !cute.int_tuple<"?">
      %1309 = cute.get_scalars(%e1_2079) : !cute.int_tuple<"?">
      %1310 = cute.get_scalars(%e2_2080) : !cute.int_tuple<"?">
      %1311 = cute.get_scalars(%e3_2081) : !cute.int_tuple<"?{div=8}">
      %iter_2082 = cute.get_iter(%view_2076) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2083, %e1_2084, %e2_2085, %e3_2086 = cute.get_leaves(%iter_2082) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1312 = cute.get_scalars(%e0_2083) : !cute.int_tuple<"?">
      %1313 = cute.get_scalars(%e1_2084) : !cute.int_tuple<"?">
      %1314 = cute.get_scalars(%e2_2085) : !cute.int_tuple<"?">
      %1315 = cute.get_scalars(%e3_2086) : !cute.int_tuple<"?{div=8}">
      %iter_2087 = cute.get_iter(%view_2076) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2088, %e1_2089, %e2_2090, %e3_2091 = cute.get_leaves(%iter_2087) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1316 = cute.get_scalars(%e0_2088) : !cute.int_tuple<"?">
      %1317 = cute.get_scalars(%e1_2089) : !cute.int_tuple<"?">
      %1318 = cute.get_scalars(%e2_2090) : !cute.int_tuple<"?">
      %1319 = cute.get_scalars(%e3_2091) : !cute.int_tuple<"?{div=8}">
      %lay_2092 = cute.get_layout(%arg4) : !memref_gmem_bf16_
      %1320 = cute.get_shape(%lay_2092) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2093, %e1_2094, %e2_2095, %e3_2096 = cute.get_leaves(%1320) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2097 = cute.to_int_tuple(%e0_2093) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1321 = cute.get_scalars(%itup_2097) : !cute.int_tuple<"?">
      %itup_2098 = cute.to_int_tuple(%e1_2094) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1322 = cute.get_scalars(%itup_2098) : !cute.int_tuple<"?">
      %itup_2099 = cute.to_int_tuple(%e2_2095) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1323 = cute.get_scalars(%itup_2099) : !cute.int_tuple<"?">
      %itup_2100 = cute.to_int_tuple(%e3_2096) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1324 = cute.get_scalars(%itup_2100) : !cute.int_tuple<"?{div=8}">
      %coord_2101 = cute.make_coord(%e2_2090) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2102 = cute.make_coord(%itup_2100) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1325 = cute.get_scalars(%coord_2101) : !cute.coord<"?">
      %1326 = cute.get_scalars(%coord_2102) : !cute.coord<"?{div=8}">
      %true_2103 = arith.constant true
      %1327 = arith.cmpi slt, %1325, %1326 : i32
      %1328 = arith.andi %true_2103, %1327 : i1
      %1329 = arith.extui %1307 : i1 to i32
      %1330 = arith.cmpi ne, %1329, %c0_i32_1796 : i32
      %1331 = arith.extui %1307 : i1 to i32
      %1332 = arith.extui %1328 : i1 to i32
      %1333 = arith.select %1330, %1332, %1331 : i32
      %1334 = arith.cmpi ne, %1333, %c0_i32_1797 : i32
      scf.if %1334 {
        %coord_2734 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,0,?)">
        %lay_2735 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
        %iter_2737 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_gmem_bf16_10
        %iter_2740 = cute.get_iter(%view_2739) : !memref_gmem_bf16_10
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2742 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2744 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_smem_bf16_14
        %iter_2747 = cute.get_iter(%view_2746) : !memref_smem_bf16_14
        %lay_2748 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %1595 = cute.get_shape(%lay_2748) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2749, %e1_2750 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %lay_2751 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %1596 = cute.get_shape(%lay_2751) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2752, %e1_2753 = cute.get_leaves(%1596) : !cute.shape<"((8,1))">
        %lay_2754 = cute.get_layout(%view_2739) : !memref_gmem_bf16_10
        %shape_2755 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2756 = cute.make_layout() : !cute.layout<"1:0">
        %append_2757 = cute.append_to_rank<2> (%lay_2754, %lay_2756) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2758 = cute.make_view(%iter_2740, %append_2757) : !memref_gmem_bf16_11
        %iter_2759 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %lay_2760 = cute.get_layout(%view_2758) : !memref_gmem_bf16_11
        %1597 = cute.get_shape(%lay_2760) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2761, %e1_2762, %e2_2763 = cute.get_leaves(%1597) : !cute.shape<"((8,1),1)">
        %iter_2764 = cute.get_iter(%view_2758) : !memref_gmem_bf16_11
        %view_2765 = cute.make_view(%iter_2764) : !memref_gmem_bf16_12
        %iter_2766 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2767 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %lay_2768 = cute.get_layout(%view_2746) : !memref_smem_bf16_14
        %shape_2769 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2770 = cute.make_layout() : !cute.layout<"1:0">
        %append_2771 = cute.append_to_rank<2> (%lay_2768, %lay_2770) : !cute.layout<"((8,1)):((1,0))">, !cute.layout<"1:0">
        %view_2772 = cute.make_view(%iter_2747, %append_2771) : !memref_smem_bf16_15
        %iter_2773 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %lay_2774 = cute.get_layout(%view_2772) : !memref_smem_bf16_15
        %1598 = cute.get_shape(%lay_2774) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2775, %e1_2776, %e2_2777 = cute.get_leaves(%1598) : !cute.shape<"((8,1),1)">
        %iter_2778 = cute.get_iter(%view_2772) : !memref_smem_bf16_15
        %view_2779 = cute.make_view(%iter_2778) : !memref_smem_bf16_16
        %iter_2780 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %iter_2781 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2782 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %1599 = cute.get_shape(%lay_2782) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2783, %e1_2784, %e2_2785 = cute.get_leaves(%1599) : !cute.shape<"((8,1),(1))">
        %lay_2786 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %1600 = cute.get_shape(%lay_2786) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2787, %e1_2788, %e2_2789 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(1))">
        %lay_2790 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %sz_2791 = cute.size(%lay_2790) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2792 = cute.get_leaves(%sz_2791) : !cute.int_tuple<"1">
        %lay_2793 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %sz_2794 = cute.size(%lay_2793) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2795 = cute.get_leaves(%sz_2794) : !cute.int_tuple<"1">
        %1601 = cute.static : !cute.layout<"1:0">
        %iter_2796 = cute.get_iter(%view_2765) : !memref_gmem_bf16_12
        %iter_2797 = cute.get_iter(%view_2779) : !memref_smem_bf16_16
        %lay_2798 = cute.get_layout(%view_2765) : !memref_gmem_bf16_12
        %lay_2799 = cute.get_layout(%view_2779) : !memref_smem_bf16_16
        %append_2800 = cute.append_to_rank<2> (%lay_2798, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2801 = cute.append_to_rank<2> (%lay_2799, %1601) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2802 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2803 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2804 = cute.size(%lay_2802) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1602 = cute.get_scalars(%sz_2804) : !cute.int_tuple<"1">
        %c0_i32_2805 = arith.constant 0 : i32
        %c1_i32_2806 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2805 to %1602 step %c1_i32_2806  : i32 {
          %coord_2807 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1603 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2808 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2809 = cute.crd2idx(%coord_2807, %lay_2802) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2810 = cute.add_offset(%iter_2796, %idx_2809) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2811 = cute.make_view(%ptr_2810, %lay_2808) : !memref_gmem_bf16_10
          %1604 = cute.get_scalars(%coord_2807) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2812 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2813 = cute.crd2idx(%coord_2807, %lay_2803) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_2814 = cute.add_offset(%iter_2797, %idx_2813) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_2815 = cute.make_view(%ptr_2814, %lay_2812) : !memref_smem_bf16_14
          %iter_2816 = cute.get_iter(%view_2811) : !memref_gmem_bf16_10
          %iter_2817 = cute.get_iter(%view_2815) : !memref_smem_bf16_14
          %iter_2818 = cute.recast_iter(%iter_2816) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_2819 = cute.recast_iter(%iter_2817) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_2819 : !cute.ptr<i128, smem>, %iter_2818 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,3,0)">
        %lay_2735 = cute.get_layout(%view_627) : !memref_smem_bf16_4
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,0)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
        %iter_2737 = cute.get_iter(%view_627) : !memref_smem_bf16_4
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_smem_bf16_14
        %iter_2740 = cute.get_iter(%view_2739) : !memref_smem_bf16_14
        %lay_2741 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %sz_2742 = cute.size(%lay_2741) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.int_tuple<"8">
        %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"8">
        %lay_2744 = cute.get_layout(%view_2739) : !memref_smem_bf16_14
        %1595 = cute.get_shape(%lay_2744) : (!cute.layout<"((8,1)):((1,0))">) -> !cute.shape<"((8,1))">
        %e0_2745, %e1_2746 = cute.get_leaves(%1595) : !cute.shape<"((8,1))">
        %int_tuple_2747 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %int_tuple_2748 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %e0_2749 = cute.get_leaves(%int_tuple_2748) : !cute.int_tuple<"8">
        %cst_2750 = arith.constant 0.000000e+00 : bf16
        %1596 = vector.splat %cst_2750 : vector<8xbf16>
        %int_tuple_2751 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2752 = cute.size(%int_tuple_2751) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2753 = cute.get_leaves(%sz_2752) : !cute.int_tuple<"8">
        %int_tuple_2754 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1))">
        %sz_2755 = cute.size(%int_tuple_2754) : (!cute.int_tuple<"((8,1))">) -> !cute.int_tuple<"8">
        %e0_2756 = cute.get_leaves(%sz_2755) : !cute.int_tuple<"8">
        cute.memref.store_vec %1596, %view_2739, row_major : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %int_tuple_2104 = cute.make_int_tuple() : () -> !cute.int_tuple<"-1">
      %tup_2105 = cute.add_offset(%sub_239, %int_tuple_2104) : (!cute.int_tuple<"?">, !cute.int_tuple<"-1">) -> !cute.int_tuple<"?">
      %1335 = cute.get_scalars(%tup_2105) : !cute.int_tuple<"?">
      %1336 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %1337 = cute.get_shape(%1336) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_2106, %e1_2107, %e2_2108, %e3_2109 = cute.get_leaves(%1337) : !cute.shape<"(32,4,1,1)">
      %1338 = cute.get_stride(%1336) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_2110, %e1_2111, %e2_2112, %e3_2113 = cute.get_leaves(%1338) : !cute.stride<"(1,32,0,0)">
      %1339 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_2114, %e1_2115, %e2_2116 = cute.get_leaves(%1339) : !cute.tile<"[64:1;16:1;16:1]">
      %1340 = cute.get_shape(%e0_2114) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_2117 = cute.get_leaves(%1340) : !cute.shape<"64">
      %1341 = cute.get_stride(%e0_2114) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_2118 = cute.get_leaves(%1341) : !cute.stride<"1">
      %1342 = cute.get_shape(%e1_2115) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_2119 = cute.get_leaves(%1342) : !cute.shape<"16">
      %1343 = cute.get_stride(%e1_2115) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_2120 = cute.get_leaves(%1343) : !cute.stride<"1">
      %1344 = cute.get_shape(%e2_2116) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_2121 = cute.get_leaves(%1344) : !cute.shape<"16">
      %1345 = cute.get_stride(%e2_2116) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_2122 = cute.get_leaves(%1345) : !cute.stride<"1">
      %1346 = cute.static : !cute.layout<"32:1">
      %1347 = cute.get_shape(%1346) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_2123 = cute.get_leaves(%1347) : !cute.shape<"32">
      %1348 = cute.get_stride(%1346) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_2124 = cute.get_leaves(%1348) : !cute.stride<"1">
      %1349 = cute.static : !cute.shape<"(16,8,16)">
      %e0_2125, %e1_2126, %e2_2127 = cute.get_leaves(%1349) : !cute.shape<"(16,8,16)">
      %1350 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %1351 = cute.get_shape(%1350) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_2128, %e1_2129, %e2_2130, %e3_2131, %e4_2132 = cute.get_leaves(%1351) : !cute.shape<"((4,8),(2,2,2))">
      %1352 = cute.get_stride(%1350) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_2133, %e1_2134, %e2_2135, %e3_2136, %e4_2137 = cute.get_leaves(%1352) : !cute.stride<"((32,1),(16,8,128))">
      %1353 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %1354 = cute.get_shape(%1353) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_2138, %e1_2139, %e2_2140, %e3_2141 = cute.get_leaves(%1354) : !cute.shape<"((4,8),(2,2))">
      %1355 = cute.get_stride(%1353) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_2142, %e1_2143, %e2_2144, %e3_2145 = cute.get_leaves(%1355) : !cute.stride<"((16,1),(8,64))">
      %1356 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %1357 = cute.get_shape(%1356) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_2146, %e1_2147, %e2_2148, %e3_2149 = cute.get_leaves(%1357) : !cute.shape<"((4,8),(2,2))">
      %1358 = cute.get_stride(%1356) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_2150, %e1_2151, %e2_2152, %e3_2153 = cute.get_leaves(%1358) : !cute.stride<"((32,1),(16,8))">
      %1359 = cute.static : !cute.tile<"[64:1;16:1]">
      %e0_2154, %e1_2155 = cute.get_leaves(%1359) : !cute.tile<"[64:1;16:1]">
      %1360 = cute.get_shape(%e0_2154) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_2156 = cute.get_leaves(%1360) : !cute.shape<"64">
      %1361 = cute.get_stride(%e0_2154) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_2157 = cute.get_leaves(%1361) : !cute.stride<"1">
      %1362 = cute.get_shape(%e1_2155) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_2158 = cute.get_leaves(%1362) : !cute.shape<"16">
      %1363 = cute.get_stride(%e1_2155) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_2159 = cute.get_leaves(%1363) : !cute.stride<"1">
      %1364 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %1365 = cute.get_shape(%1364) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %e0_2160, %e1_2161, %e2_2162, %e3_2163, %e4_2164, %e5, %e6 = cute.get_leaves(%1365) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
      %1366 = cute.get_stride(%1364) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %e0_2165, %e1_2166, %e2_2167, %e3_2168, %e4_2169, %e5_2170, %e6_2171 = cute.get_leaves(%1366) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
      %1367 = cute.static : !cute.layout<"32:1">
      %1368 = cute.get_shape(%1367) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_2172 = cute.get_leaves(%1368) : !cute.shape<"32">
      %1369 = cute.get_stride(%1367) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_2173 = cute.get_leaves(%1369) : !cute.stride<"1">
      %1370 = cute.static : !cute.layout<"(32,8):(8,1)">
      %1371 = cute.get_shape(%1370) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
      %e0_2174, %e1_2175 = cute.get_leaves(%1371) : !cute.shape<"(32,8)">
      %1372 = cute.get_stride(%1370) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
      %e0_2176, %e1_2177 = cute.get_leaves(%1372) : !cute.stride<"(8,1)">
      %1373 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
      %1374 = cute.get_shape(%1373) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
      %e0_2178, %e1_2179, %e2_2180 = cute.get_leaves(%1374) : !cute.shape<"(32,(2,4))">
      %1375 = cute.get_stride(%1373) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
      %e0_2181, %e1_2182, %e2_2183 = cute.get_leaves(%1375) : !cute.stride<"(2,(1,64))">
      %c-1_i32 = arith.constant -1 : i32
      %c1_i32 = arith.constant 1 : i32
      %1376:2 = scf.for %arg5 = %c-1_i32 to %153 step %c1_i32 iter_args(%arg6 = %6, %arg7 = %545) -> (!mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3)  : i32 {
        %int_tuple_2734 = cute.make_int_tuple(%arg5) : (i32) -> !cute.int_tuple<"?">
        %sub_2735 = cute.tuple_sub(%tup_2105, %int_tuple_2734) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.int_tuple<"?">
        %1595 = cute.get_scalars(%sub_2735) : !cute.int_tuple<"?">
        nvvm.cp.async.wait.group 0
        %c1_i32_2736 = arith.constant 1 : i32
        %c128_i32_2737 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_2736 number_of_threads = %c128_i32_2737
        %1596 = arith.cmpi eq, %1595, %153 : i32
        scf.if %1596 {
          %lay_3954 = cute.get_layout(%view_570) : !memref_smem_bf16_3
          %1817 = cute.get_shape(%lay_3954) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3955, %e1_3956, %e2_3957, %e3_3958 = cute.get_leaves(%1817) : !cute.shape<"((8,1),4,2)">
          %int_tuple_3959 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_3960 = cute.size(%int_tuple_3959) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_3961 = cute.get_leaves(%sz_3960) : !cute.int_tuple<"4">
          %coord_3962 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3963 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3964 = cute.crd2idx(%coord_3962, %lay_3963) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_3965 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3966 = cute.add_offset(%iter_3965, %idx_3964) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_3967 = cute.make_view(%tup_3966) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_3968 = cute.get_iter(%view_3967) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3969, %e1_3970, %e2_3971, %e3_3972 = cute.get_leaves(%iter_3968) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1818 = cute.get_scalars(%e0_3969) : !cute.int_tuple<"?">
          %1819 = cute.get_scalars(%e1_3970) : !cute.int_tuple<"?">
          %1820 = cute.get_scalars(%e2_3971) : !cute.int_tuple<"?">
          %1821 = cute.get_scalars(%e3_3972) : !cute.int_tuple<"?{div=8}">
          %iter_3973 = cute.get_iter(%view_3967) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977 = cute.get_leaves(%iter_3973) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1822 = cute.get_scalars(%e0_3974) : !cute.int_tuple<"?">
          %1823 = cute.get_scalars(%e1_3975) : !cute.int_tuple<"?">
          %1824 = cute.get_scalars(%e2_3976) : !cute.int_tuple<"?">
          %1825 = cute.get_scalars(%e3_3977) : !cute.int_tuple<"?{div=8}">
          %iter_3978 = cute.get_iter(%view_3967) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_3979, %e1_3980, %e2_3981, %e3_3982 = cute.get_leaves(%iter_3978) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1826 = cute.get_scalars(%e0_3979) : !cute.int_tuple<"?">
          %1827 = cute.get_scalars(%e1_3980) : !cute.int_tuple<"?">
          %1828 = cute.get_scalars(%e2_3981) : !cute.int_tuple<"?">
          %1829 = cute.get_scalars(%e3_3982) : !cute.int_tuple<"?{div=8}">
          %lay_3983 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1830 = cute.get_shape(%lay_3983) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_3984, %e1_3985, %e2_3986, %e3_3987 = cute.get_leaves(%1830) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_3988 = cute.to_int_tuple(%e0_3984) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1831 = cute.get_scalars(%itup_3988) : !cute.int_tuple<"?">
          %itup_3989 = cute.to_int_tuple(%e1_3985) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1832 = cute.get_scalars(%itup_3989) : !cute.int_tuple<"?">
          %itup_3990 = cute.to_int_tuple(%e2_3986) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1833 = cute.get_scalars(%itup_3990) : !cute.int_tuple<"?">
          %itup_3991 = cute.to_int_tuple(%e3_3987) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1834 = cute.get_scalars(%itup_3991) : !cute.int_tuple<"?{div=8}">
          %coord_3992 = cute.make_coord(%e1_3980) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_3993 = cute.make_coord(%itup_3989) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1835 = cute.get_scalars(%coord_3992) : !cute.coord<"?">
          %1836 = cute.get_scalars(%coord_3993) : !cute.coord<"?">
          %true_3994 = arith.constant true
          %1837 = arith.cmpi slt, %1835, %1836 : i32
          %1838 = arith.andi %true_3994, %1837 : i1
          scf.if %1838 {
            %coord_4094 = cute.make_coord(%sub_2735) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_4095 = cute.get_layout(%view_525) : !memref_gmem_bf16_6
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_4097 = cute.get_iter(%view_525) : !memref_gmem_bf16_6
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_gmem_bf16_8
            %iter_4100 = cute.get_iter(%view_4099) : !memref_gmem_bf16_8
            %coord_4101 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4102 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4103 = cute.crd2idx(%coord_4101, %lay_4102) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_4104 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4105 = cute.add_offset(%iter_4104, %idx_4103) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4106 = cute.make_view(%ptr_4105) : !memref_smem_bf16_12
            %iter_4107 = cute.get_iter(%view_4106) : !memref_smem_bf16_12
            %coord_4108 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4109 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
            %idx_4110 = cute.crd2idx(%coord_4108, %lay_4109) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4111 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
            %ptr_4112 = cute.add_offset(%iter_4111, %idx_4110) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4113 = cute.make_view(%ptr_4112) : !memref_rmem_i8_1
            %iter_4114 = cute.get_iter(%view_4113) : !memref_rmem_i8_1
            %lay_4115 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %1902 = cute.get_shape(%lay_4115) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4116, %e1_4117, %e2_4118 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %lay_4119 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %1903 = cute.get_shape(%lay_4119) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4120, %e1_4121, %e2_4122 = cute.get_leaves(%1903) : !cute.shape<"((8,1),2)">
            %lay_4123 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %shape_4124 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4125 = cute.make_layout() : !cute.layout<"1:0">
            %append_4126 = cute.append_to_rank<2> (%lay_4123, %lay_4125) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4127 = cute.make_view(%iter_4100, %append_4126) : !memref_gmem_bf16_8
            %iter_4128 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %lay_4129 = cute.get_layout(%view_4127) : !memref_gmem_bf16_8
            %1904 = cute.get_shape(%lay_4129) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4130, %e1_4131, %e2_4132 = cute.get_leaves(%1904) : !cute.shape<"((8,1),2)">
            %iter_4133 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %view_4134 = cute.make_view(%iter_4133) : !memref_gmem_bf16_9
            %iter_4135 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4136 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %lay_4137 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %shape_4138 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4139 = cute.make_layout() : !cute.layout<"1:0">
            %append_4140 = cute.append_to_rank<2> (%lay_4137, %lay_4139) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4141 = cute.make_view(%iter_4107, %append_4140) : !memref_smem_bf16_12
            %iter_4142 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %lay_4143 = cute.get_layout(%view_4141) : !memref_smem_bf16_12
            %1905 = cute.get_shape(%lay_4143) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4144, %e1_4145, %e2_4146 = cute.get_leaves(%1905) : !cute.shape<"((8,1),2)">
            %iter_4147 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %view_4148 = cute.make_view(%iter_4147) : !memref_smem_bf16_13
            %iter_4149 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %iter_4150 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4151 = cute.get_layout(%view_4113) : !memref_rmem_i8_1
            %shape_4152 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4153 = cute.make_layout() : !cute.layout<"1:0">
            %append_4154 = cute.append_to_rank<2> (%lay_4151, %lay_4153) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4155 = cute.make_view(%iter_4114, %append_4154) : !memref_rmem_i8_1
            %iter_4156 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %lay_4157 = cute.get_layout(%view_4155) : !memref_rmem_i8_1
            %1906 = cute.get_shape(%lay_4157) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4158, %e1_4159 = cute.get_leaves(%1906) : !cute.shape<"(1,2)">
            %iter_4160 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %view_4161 = cute.make_view(%iter_4160) : !memref_rmem_i8_2
            %iter_4162 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %iter_4163 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4164 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %1907 = cute.get_shape(%lay_4164) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4165, %e1_4166, %e2_4167 = cute.get_leaves(%1907) : !cute.shape<"((8,1),(2))">
            %lay_4168 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %1908 = cute.get_shape(%lay_4168) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4169, %e1_4170, %e2_4171 = cute.get_leaves(%1908) : !cute.shape<"((8,1),(2))">
            %lay_4172 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %sz_4173 = cute.size(%lay_4172) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4174 = cute.get_leaves(%sz_4173) : !cute.int_tuple<"2">
            %lay_4175 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %sz_4176 = cute.size(%lay_4175) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4177 = cute.get_leaves(%sz_4176) : !cute.int_tuple<"2">
            %1909 = cute.static : !cute.layout<"1:0">
            %iter_4178 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4179 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4180 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %lay_4181 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %append_4182 = cute.append_to_rank<2> (%lay_4180, %1909) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4183 = cute.append_to_rank<2> (%lay_4181, %1909) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4184 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4185 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4186 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4187 = cute.get_layout(%view_4161) : !memref_rmem_i8_2
            %append_4188 = cute.append_to_rank<2> (%lay_4187, %1909) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4189 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4190 = cute.size(%lay_4184) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1910 = cute.get_scalars(%sz_4190) : !cute.int_tuple<"2">
            %c0_i32_4191 = arith.constant 0 : i32
            %c1_i32_4192 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4191 to %1910 step %c1_i32_4192  : i32 {
              %coord_4193 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1911 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4194 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4195 = cute.crd2idx(%coord_4193, %lay_4184) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4196 = cute.add_offset(%iter_4178, %idx_4195) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4197 = cute.make_view(%ptr_4196, %lay_4194) : !memref_gmem_bf16_10
              %1912 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4198 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4199 = cute.crd2idx(%coord_4193, %lay_4185) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4200 = cute.add_offset(%iter_4179, %idx_4199) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4201 = cute.make_view(%ptr_4200, %lay_4198) : !memref_smem_bf16_14
              %1913 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4202 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4203 = cute.crd2idx(%coord_4193, %lay_4189) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4204 = cute.add_offset(%iter_4186, %idx_4203) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4205 = cute.make_view(%ptr_4204, %lay_4202) : !memref_rmem_i8_3
              %iter_4206 = cute.get_iter(%view_4197) : !memref_gmem_bf16_10
              %iter_4207 = cute.get_iter(%view_4201) : !memref_smem_bf16_14
              %iter_4208 = cute.get_iter(%view_4205) : !memref_rmem_i8_3
              %1914 = builtin.unrealized_conversion_cast %iter_4208 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1915 = llvm.load %1914 : !llvm.ptr -> i8
              %1916 = llvm.trunc %1915 : i8 to i1
              %iter_4209 = cute.recast_iter(%iter_4206) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4210 = cute.recast_iter(%iter_4207) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4210 : !cute.ptr<i128, smem>, %iter_4209 : !cute.ptr<i128, gmem>, %1916 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4094 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4095 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_4097 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_smem_bf16_12
            %iter_4100 = cute.get_iter(%view_4099) : !memref_smem_bf16_12
            %lay_4101 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %sz_4102 = cute.size(%lay_4101) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4103 = cute.get_leaves(%sz_4102) : !cute.int_tuple<"16">
            %lay_4104 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %1902 = cute.get_shape(%lay_4104) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4105, %e1_4106, %e2_4107 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %int_tuple_4108 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4109 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4110 = cute.get_leaves(%int_tuple_4109) : !cute.int_tuple<"16">
            %cst_4111 = arith.constant 0.000000e+00 : bf16
            %1903 = vector.splat %cst_4111 : vector<16xbf16>
            %int_tuple_4112 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4113 = cute.size(%int_tuple_4112) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4114 = cute.get_leaves(%sz_4113) : !cute.int_tuple<"16">
            %int_tuple_4115 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4116 = cute.size(%int_tuple_4115) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4117 = cute.get_leaves(%sz_4116) : !cute.int_tuple<"16">
            cute.memref.store_vec %1903, %view_4099, row_major : !memref_smem_bf16_12
          }
          %coord_3995 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_3996 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_3997 = cute.crd2idx(%coord_3995, %lay_3996) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_3998 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_3999 = cute.add_offset(%iter_3998, %idx_3997) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4000 = cute.make_view(%tup_3999) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4001 = cute.get_iter(%view_4000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4002, %e1_4003, %e2_4004, %e3_4005 = cute.get_leaves(%iter_4001) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1839 = cute.get_scalars(%e0_4002) : !cute.int_tuple<"?">
          %1840 = cute.get_scalars(%e1_4003) : !cute.int_tuple<"?">
          %1841 = cute.get_scalars(%e2_4004) : !cute.int_tuple<"?">
          %1842 = cute.get_scalars(%e3_4005) : !cute.int_tuple<"?{div=8}">
          %iter_4006 = cute.get_iter(%view_4000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4007, %e1_4008, %e2_4009, %e3_4010 = cute.get_leaves(%iter_4006) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1843 = cute.get_scalars(%e0_4007) : !cute.int_tuple<"?">
          %1844 = cute.get_scalars(%e1_4008) : !cute.int_tuple<"?">
          %1845 = cute.get_scalars(%e2_4009) : !cute.int_tuple<"?">
          %1846 = cute.get_scalars(%e3_4010) : !cute.int_tuple<"?{div=8}">
          %iter_4011 = cute.get_iter(%view_4000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4012, %e1_4013, %e2_4014, %e3_4015 = cute.get_leaves(%iter_4011) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1847 = cute.get_scalars(%e0_4012) : !cute.int_tuple<"?">
          %1848 = cute.get_scalars(%e1_4013) : !cute.int_tuple<"?">
          %1849 = cute.get_scalars(%e2_4014) : !cute.int_tuple<"?">
          %1850 = cute.get_scalars(%e3_4015) : !cute.int_tuple<"?{div=8}">
          %lay_4016 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1851 = cute.get_shape(%lay_4016) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4017, %e1_4018, %e2_4019, %e3_4020 = cute.get_leaves(%1851) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4021 = cute.to_int_tuple(%e0_4017) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1852 = cute.get_scalars(%itup_4021) : !cute.int_tuple<"?">
          %itup_4022 = cute.to_int_tuple(%e1_4018) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1853 = cute.get_scalars(%itup_4022) : !cute.int_tuple<"?">
          %itup_4023 = cute.to_int_tuple(%e2_4019) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1854 = cute.get_scalars(%itup_4023) : !cute.int_tuple<"?">
          %itup_4024 = cute.to_int_tuple(%e3_4020) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1855 = cute.get_scalars(%itup_4024) : !cute.int_tuple<"?{div=8}">
          %coord_4025 = cute.make_coord(%e1_4013) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4026 = cute.make_coord(%itup_4022) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1856 = cute.get_scalars(%coord_4025) : !cute.coord<"?">
          %1857 = cute.get_scalars(%coord_4026) : !cute.coord<"?">
          %true_4027 = arith.constant true
          %1858 = arith.cmpi slt, %1856, %1857 : i32
          %1859 = arith.andi %true_4027, %1858 : i1
          scf.if %1859 {
            %coord_4094 = cute.make_coord(%sub_2735) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_4095 = cute.get_layout(%view_525) : !memref_gmem_bf16_6
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_4097 = cute.get_iter(%view_525) : !memref_gmem_bf16_6
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_gmem_bf16_8
            %iter_4100 = cute.get_iter(%view_4099) : !memref_gmem_bf16_8
            %coord_4101 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4102 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4103 = cute.crd2idx(%coord_4101, %lay_4102) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_4104 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4105 = cute.add_offset(%iter_4104, %idx_4103) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4106 = cute.make_view(%ptr_4105) : !memref_smem_bf16_12
            %iter_4107 = cute.get_iter(%view_4106) : !memref_smem_bf16_12
            %coord_4108 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4109 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
            %idx_4110 = cute.crd2idx(%coord_4108, %lay_4109) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4111 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
            %ptr_4112 = cute.add_offset(%iter_4111, %idx_4110) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4113 = cute.make_view(%ptr_4112) : !memref_rmem_i8_1
            %iter_4114 = cute.get_iter(%view_4113) : !memref_rmem_i8_1
            %lay_4115 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %1902 = cute.get_shape(%lay_4115) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4116, %e1_4117, %e2_4118 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %lay_4119 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %1903 = cute.get_shape(%lay_4119) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4120, %e1_4121, %e2_4122 = cute.get_leaves(%1903) : !cute.shape<"((8,1),2)">
            %lay_4123 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %shape_4124 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4125 = cute.make_layout() : !cute.layout<"1:0">
            %append_4126 = cute.append_to_rank<2> (%lay_4123, %lay_4125) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4127 = cute.make_view(%iter_4100, %append_4126) : !memref_gmem_bf16_8
            %iter_4128 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %lay_4129 = cute.get_layout(%view_4127) : !memref_gmem_bf16_8
            %1904 = cute.get_shape(%lay_4129) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4130, %e1_4131, %e2_4132 = cute.get_leaves(%1904) : !cute.shape<"((8,1),2)">
            %iter_4133 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %view_4134 = cute.make_view(%iter_4133) : !memref_gmem_bf16_9
            %iter_4135 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4136 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %lay_4137 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %shape_4138 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4139 = cute.make_layout() : !cute.layout<"1:0">
            %append_4140 = cute.append_to_rank<2> (%lay_4137, %lay_4139) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4141 = cute.make_view(%iter_4107, %append_4140) : !memref_smem_bf16_12
            %iter_4142 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %lay_4143 = cute.get_layout(%view_4141) : !memref_smem_bf16_12
            %1905 = cute.get_shape(%lay_4143) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4144, %e1_4145, %e2_4146 = cute.get_leaves(%1905) : !cute.shape<"((8,1),2)">
            %iter_4147 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %view_4148 = cute.make_view(%iter_4147) : !memref_smem_bf16_13
            %iter_4149 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %iter_4150 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4151 = cute.get_layout(%view_4113) : !memref_rmem_i8_1
            %shape_4152 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4153 = cute.make_layout() : !cute.layout<"1:0">
            %append_4154 = cute.append_to_rank<2> (%lay_4151, %lay_4153) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4155 = cute.make_view(%iter_4114, %append_4154) : !memref_rmem_i8_1
            %iter_4156 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %lay_4157 = cute.get_layout(%view_4155) : !memref_rmem_i8_1
            %1906 = cute.get_shape(%lay_4157) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4158, %e1_4159 = cute.get_leaves(%1906) : !cute.shape<"(1,2)">
            %iter_4160 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %view_4161 = cute.make_view(%iter_4160) : !memref_rmem_i8_2
            %iter_4162 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %iter_4163 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4164 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %1907 = cute.get_shape(%lay_4164) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4165, %e1_4166, %e2_4167 = cute.get_leaves(%1907) : !cute.shape<"((8,1),(2))">
            %lay_4168 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %1908 = cute.get_shape(%lay_4168) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4169, %e1_4170, %e2_4171 = cute.get_leaves(%1908) : !cute.shape<"((8,1),(2))">
            %lay_4172 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %sz_4173 = cute.size(%lay_4172) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4174 = cute.get_leaves(%sz_4173) : !cute.int_tuple<"2">
            %lay_4175 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %sz_4176 = cute.size(%lay_4175) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4177 = cute.get_leaves(%sz_4176) : !cute.int_tuple<"2">
            %1909 = cute.static : !cute.layout<"1:0">
            %iter_4178 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4179 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4180 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %lay_4181 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %append_4182 = cute.append_to_rank<2> (%lay_4180, %1909) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4183 = cute.append_to_rank<2> (%lay_4181, %1909) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4184 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4185 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4186 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4187 = cute.get_layout(%view_4161) : !memref_rmem_i8_2
            %append_4188 = cute.append_to_rank<2> (%lay_4187, %1909) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4189 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4190 = cute.size(%lay_4184) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1910 = cute.get_scalars(%sz_4190) : !cute.int_tuple<"2">
            %c0_i32_4191 = arith.constant 0 : i32
            %c1_i32_4192 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4191 to %1910 step %c1_i32_4192  : i32 {
              %coord_4193 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1911 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4194 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4195 = cute.crd2idx(%coord_4193, %lay_4184) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4196 = cute.add_offset(%iter_4178, %idx_4195) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4197 = cute.make_view(%ptr_4196, %lay_4194) : !memref_gmem_bf16_10
              %1912 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4198 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4199 = cute.crd2idx(%coord_4193, %lay_4185) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4200 = cute.add_offset(%iter_4179, %idx_4199) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4201 = cute.make_view(%ptr_4200, %lay_4198) : !memref_smem_bf16_14
              %1913 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4202 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4203 = cute.crd2idx(%coord_4193, %lay_4189) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4204 = cute.add_offset(%iter_4186, %idx_4203) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4205 = cute.make_view(%ptr_4204, %lay_4202) : !memref_rmem_i8_3
              %iter_4206 = cute.get_iter(%view_4197) : !memref_gmem_bf16_10
              %iter_4207 = cute.get_iter(%view_4201) : !memref_smem_bf16_14
              %iter_4208 = cute.get_iter(%view_4205) : !memref_rmem_i8_3
              %1914 = builtin.unrealized_conversion_cast %iter_4208 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1915 = llvm.load %1914 : !llvm.ptr -> i8
              %1916 = llvm.trunc %1915 : i8 to i1
              %iter_4209 = cute.recast_iter(%iter_4206) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4210 = cute.recast_iter(%iter_4207) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4210 : !cute.ptr<i128, smem>, %iter_4209 : !cute.ptr<i128, gmem>, %1916 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4094 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4095 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_4097 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_smem_bf16_12
            %iter_4100 = cute.get_iter(%view_4099) : !memref_smem_bf16_12
            %lay_4101 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %sz_4102 = cute.size(%lay_4101) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4103 = cute.get_leaves(%sz_4102) : !cute.int_tuple<"16">
            %lay_4104 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %1902 = cute.get_shape(%lay_4104) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4105, %e1_4106, %e2_4107 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %int_tuple_4108 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4109 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4110 = cute.get_leaves(%int_tuple_4109) : !cute.int_tuple<"16">
            %cst_4111 = arith.constant 0.000000e+00 : bf16
            %1903 = vector.splat %cst_4111 : vector<16xbf16>
            %int_tuple_4112 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4113 = cute.size(%int_tuple_4112) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4114 = cute.get_leaves(%sz_4113) : !cute.int_tuple<"16">
            %int_tuple_4115 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4116 = cute.size(%int_tuple_4115) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4117 = cute.get_leaves(%sz_4116) : !cute.int_tuple<"16">
            cute.memref.store_vec %1903, %view_4099, row_major : !memref_smem_bf16_12
          }
          %coord_4028 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_4029 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_4030 = cute.crd2idx(%coord_4028, %lay_4029) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_4031 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_4032 = cute.add_offset(%iter_4031, %idx_4030) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4033 = cute.make_view(%tup_4032) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4034 = cute.get_iter(%view_4033) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4035, %e1_4036, %e2_4037, %e3_4038 = cute.get_leaves(%iter_4034) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1860 = cute.get_scalars(%e0_4035) : !cute.int_tuple<"?">
          %1861 = cute.get_scalars(%e1_4036) : !cute.int_tuple<"?">
          %1862 = cute.get_scalars(%e2_4037) : !cute.int_tuple<"?">
          %1863 = cute.get_scalars(%e3_4038) : !cute.int_tuple<"?{div=8}">
          %iter_4039 = cute.get_iter(%view_4033) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4040, %e1_4041, %e2_4042, %e3_4043 = cute.get_leaves(%iter_4039) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1864 = cute.get_scalars(%e0_4040) : !cute.int_tuple<"?">
          %1865 = cute.get_scalars(%e1_4041) : !cute.int_tuple<"?">
          %1866 = cute.get_scalars(%e2_4042) : !cute.int_tuple<"?">
          %1867 = cute.get_scalars(%e3_4043) : !cute.int_tuple<"?{div=8}">
          %iter_4044 = cute.get_iter(%view_4033) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4045, %e1_4046, %e2_4047, %e3_4048 = cute.get_leaves(%iter_4044) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1868 = cute.get_scalars(%e0_4045) : !cute.int_tuple<"?">
          %1869 = cute.get_scalars(%e1_4046) : !cute.int_tuple<"?">
          %1870 = cute.get_scalars(%e2_4047) : !cute.int_tuple<"?">
          %1871 = cute.get_scalars(%e3_4048) : !cute.int_tuple<"?{div=8}">
          %lay_4049 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1872 = cute.get_shape(%lay_4049) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4050, %e1_4051, %e2_4052, %e3_4053 = cute.get_leaves(%1872) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4054 = cute.to_int_tuple(%e0_4050) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1873 = cute.get_scalars(%itup_4054) : !cute.int_tuple<"?">
          %itup_4055 = cute.to_int_tuple(%e1_4051) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1874 = cute.get_scalars(%itup_4055) : !cute.int_tuple<"?">
          %itup_4056 = cute.to_int_tuple(%e2_4052) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1875 = cute.get_scalars(%itup_4056) : !cute.int_tuple<"?">
          %itup_4057 = cute.to_int_tuple(%e3_4053) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1876 = cute.get_scalars(%itup_4057) : !cute.int_tuple<"?{div=8}">
          %coord_4058 = cute.make_coord(%e1_4046) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4059 = cute.make_coord(%itup_4055) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1877 = cute.get_scalars(%coord_4058) : !cute.coord<"?">
          %1878 = cute.get_scalars(%coord_4059) : !cute.coord<"?">
          %true_4060 = arith.constant true
          %1879 = arith.cmpi slt, %1877, %1878 : i32
          %1880 = arith.andi %true_4060, %1879 : i1
          scf.if %1880 {
            %coord_4094 = cute.make_coord(%sub_2735) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_4095 = cute.get_layout(%view_525) : !memref_gmem_bf16_6
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_4097 = cute.get_iter(%view_525) : !memref_gmem_bf16_6
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_gmem_bf16_8
            %iter_4100 = cute.get_iter(%view_4099) : !memref_gmem_bf16_8
            %coord_4101 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4102 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4103 = cute.crd2idx(%coord_4101, %lay_4102) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_4104 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4105 = cute.add_offset(%iter_4104, %idx_4103) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4106 = cute.make_view(%ptr_4105) : !memref_smem_bf16_12
            %iter_4107 = cute.get_iter(%view_4106) : !memref_smem_bf16_12
            %coord_4108 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4109 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
            %idx_4110 = cute.crd2idx(%coord_4108, %lay_4109) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4111 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
            %ptr_4112 = cute.add_offset(%iter_4111, %idx_4110) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4113 = cute.make_view(%ptr_4112) : !memref_rmem_i8_1
            %iter_4114 = cute.get_iter(%view_4113) : !memref_rmem_i8_1
            %lay_4115 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %1902 = cute.get_shape(%lay_4115) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4116, %e1_4117, %e2_4118 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %lay_4119 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %1903 = cute.get_shape(%lay_4119) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4120, %e1_4121, %e2_4122 = cute.get_leaves(%1903) : !cute.shape<"((8,1),2)">
            %lay_4123 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %shape_4124 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4125 = cute.make_layout() : !cute.layout<"1:0">
            %append_4126 = cute.append_to_rank<2> (%lay_4123, %lay_4125) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4127 = cute.make_view(%iter_4100, %append_4126) : !memref_gmem_bf16_8
            %iter_4128 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %lay_4129 = cute.get_layout(%view_4127) : !memref_gmem_bf16_8
            %1904 = cute.get_shape(%lay_4129) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4130, %e1_4131, %e2_4132 = cute.get_leaves(%1904) : !cute.shape<"((8,1),2)">
            %iter_4133 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %view_4134 = cute.make_view(%iter_4133) : !memref_gmem_bf16_9
            %iter_4135 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4136 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %lay_4137 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %shape_4138 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4139 = cute.make_layout() : !cute.layout<"1:0">
            %append_4140 = cute.append_to_rank<2> (%lay_4137, %lay_4139) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4141 = cute.make_view(%iter_4107, %append_4140) : !memref_smem_bf16_12
            %iter_4142 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %lay_4143 = cute.get_layout(%view_4141) : !memref_smem_bf16_12
            %1905 = cute.get_shape(%lay_4143) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4144, %e1_4145, %e2_4146 = cute.get_leaves(%1905) : !cute.shape<"((8,1),2)">
            %iter_4147 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %view_4148 = cute.make_view(%iter_4147) : !memref_smem_bf16_13
            %iter_4149 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %iter_4150 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4151 = cute.get_layout(%view_4113) : !memref_rmem_i8_1
            %shape_4152 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4153 = cute.make_layout() : !cute.layout<"1:0">
            %append_4154 = cute.append_to_rank<2> (%lay_4151, %lay_4153) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4155 = cute.make_view(%iter_4114, %append_4154) : !memref_rmem_i8_1
            %iter_4156 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %lay_4157 = cute.get_layout(%view_4155) : !memref_rmem_i8_1
            %1906 = cute.get_shape(%lay_4157) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4158, %e1_4159 = cute.get_leaves(%1906) : !cute.shape<"(1,2)">
            %iter_4160 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %view_4161 = cute.make_view(%iter_4160) : !memref_rmem_i8_2
            %iter_4162 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %iter_4163 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4164 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %1907 = cute.get_shape(%lay_4164) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4165, %e1_4166, %e2_4167 = cute.get_leaves(%1907) : !cute.shape<"((8,1),(2))">
            %lay_4168 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %1908 = cute.get_shape(%lay_4168) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4169, %e1_4170, %e2_4171 = cute.get_leaves(%1908) : !cute.shape<"((8,1),(2))">
            %lay_4172 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %sz_4173 = cute.size(%lay_4172) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4174 = cute.get_leaves(%sz_4173) : !cute.int_tuple<"2">
            %lay_4175 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %sz_4176 = cute.size(%lay_4175) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4177 = cute.get_leaves(%sz_4176) : !cute.int_tuple<"2">
            %1909 = cute.static : !cute.layout<"1:0">
            %iter_4178 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4179 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4180 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %lay_4181 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %append_4182 = cute.append_to_rank<2> (%lay_4180, %1909) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4183 = cute.append_to_rank<2> (%lay_4181, %1909) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4184 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4185 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4186 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4187 = cute.get_layout(%view_4161) : !memref_rmem_i8_2
            %append_4188 = cute.append_to_rank<2> (%lay_4187, %1909) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4189 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4190 = cute.size(%lay_4184) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1910 = cute.get_scalars(%sz_4190) : !cute.int_tuple<"2">
            %c0_i32_4191 = arith.constant 0 : i32
            %c1_i32_4192 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4191 to %1910 step %c1_i32_4192  : i32 {
              %coord_4193 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1911 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4194 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4195 = cute.crd2idx(%coord_4193, %lay_4184) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4196 = cute.add_offset(%iter_4178, %idx_4195) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4197 = cute.make_view(%ptr_4196, %lay_4194) : !memref_gmem_bf16_10
              %1912 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4198 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4199 = cute.crd2idx(%coord_4193, %lay_4185) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4200 = cute.add_offset(%iter_4179, %idx_4199) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4201 = cute.make_view(%ptr_4200, %lay_4198) : !memref_smem_bf16_14
              %1913 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4202 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4203 = cute.crd2idx(%coord_4193, %lay_4189) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4204 = cute.add_offset(%iter_4186, %idx_4203) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4205 = cute.make_view(%ptr_4204, %lay_4202) : !memref_rmem_i8_3
              %iter_4206 = cute.get_iter(%view_4197) : !memref_gmem_bf16_10
              %iter_4207 = cute.get_iter(%view_4201) : !memref_smem_bf16_14
              %iter_4208 = cute.get_iter(%view_4205) : !memref_rmem_i8_3
              %1914 = builtin.unrealized_conversion_cast %iter_4208 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1915 = llvm.load %1914 : !llvm.ptr -> i8
              %1916 = llvm.trunc %1915 : i8 to i1
              %iter_4209 = cute.recast_iter(%iter_4206) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4210 = cute.recast_iter(%iter_4207) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4210 : !cute.ptr<i128, smem>, %iter_4209 : !cute.ptr<i128, gmem>, %1916 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4094 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4095 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_4097 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_smem_bf16_12
            %iter_4100 = cute.get_iter(%view_4099) : !memref_smem_bf16_12
            %lay_4101 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %sz_4102 = cute.size(%lay_4101) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4103 = cute.get_leaves(%sz_4102) : !cute.int_tuple<"16">
            %lay_4104 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %1902 = cute.get_shape(%lay_4104) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4105, %e1_4106, %e2_4107 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %int_tuple_4108 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4109 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4110 = cute.get_leaves(%int_tuple_4109) : !cute.int_tuple<"16">
            %cst_4111 = arith.constant 0.000000e+00 : bf16
            %1903 = vector.splat %cst_4111 : vector<16xbf16>
            %int_tuple_4112 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4113 = cute.size(%int_tuple_4112) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4114 = cute.get_leaves(%sz_4113) : !cute.int_tuple<"16">
            %int_tuple_4115 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4116 = cute.size(%int_tuple_4115) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4117 = cute.get_leaves(%sz_4116) : !cute.int_tuple<"16">
            cute.memref.store_vec %1903, %view_4099, row_major : !memref_smem_bf16_12
          }
          %coord_4061 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_4062 = cute.get_layout(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_4063 = cute.crd2idx(%coord_4061, %lay_4062) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_4064 = cute.get_iter(%view_1207) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_4065 = cute.add_offset(%iter_4064, %idx_4063) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4066 = cute.make_view(%tup_4065) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4067 = cute.get_iter(%view_4066) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4068, %e1_4069, %e2_4070, %e3_4071 = cute.get_leaves(%iter_4067) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1881 = cute.get_scalars(%e0_4068) : !cute.int_tuple<"?">
          %1882 = cute.get_scalars(%e1_4069) : !cute.int_tuple<"?">
          %1883 = cute.get_scalars(%e2_4070) : !cute.int_tuple<"?">
          %1884 = cute.get_scalars(%e3_4071) : !cute.int_tuple<"?{div=8}">
          %iter_4072 = cute.get_iter(%view_4066) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%iter_4072) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1885 = cute.get_scalars(%e0_4073) : !cute.int_tuple<"?">
          %1886 = cute.get_scalars(%e1_4074) : !cute.int_tuple<"?">
          %1887 = cute.get_scalars(%e2_4075) : !cute.int_tuple<"?">
          %1888 = cute.get_scalars(%e3_4076) : !cute.int_tuple<"?{div=8}">
          %iter_4077 = cute.get_iter(%view_4066) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4078, %e1_4079, %e2_4080, %e3_4081 = cute.get_leaves(%iter_4077) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1889 = cute.get_scalars(%e0_4078) : !cute.int_tuple<"?">
          %1890 = cute.get_scalars(%e1_4079) : !cute.int_tuple<"?">
          %1891 = cute.get_scalars(%e2_4080) : !cute.int_tuple<"?">
          %1892 = cute.get_scalars(%e3_4081) : !cute.int_tuple<"?{div=8}">
          %lay_4082 = cute.get_layout(%arg2) : !memref_gmem_bf16_
          %1893 = cute.get_shape(%lay_4082) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4083, %e1_4084, %e2_4085, %e3_4086 = cute.get_leaves(%1893) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4087 = cute.to_int_tuple(%e0_4083) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1894 = cute.get_scalars(%itup_4087) : !cute.int_tuple<"?">
          %itup_4088 = cute.to_int_tuple(%e1_4084) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1895 = cute.get_scalars(%itup_4088) : !cute.int_tuple<"?">
          %itup_4089 = cute.to_int_tuple(%e2_4085) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1896 = cute.get_scalars(%itup_4089) : !cute.int_tuple<"?">
          %itup_4090 = cute.to_int_tuple(%e3_4086) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1897 = cute.get_scalars(%itup_4090) : !cute.int_tuple<"?{div=8}">
          %coord_4091 = cute.make_coord(%e1_4079) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4092 = cute.make_coord(%itup_4088) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1898 = cute.get_scalars(%coord_4091) : !cute.coord<"?">
          %1899 = cute.get_scalars(%coord_4092) : !cute.coord<"?">
          %true_4093 = arith.constant true
          %1900 = arith.cmpi slt, %1898, %1899 : i32
          %1901 = arith.andi %true_4093, %1900 : i1
          scf.if %1901 {
            %coord_4094 = cute.make_coord(%sub_2735) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_4095 = cute.get_layout(%view_525) : !memref_gmem_bf16_6
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_4097 = cute.get_iter(%view_525) : !memref_gmem_bf16_6
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_gmem_bf16_8
            %iter_4100 = cute.get_iter(%view_4099) : !memref_gmem_bf16_8
            %coord_4101 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4102 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4103 = cute.crd2idx(%coord_4101, %lay_4102) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_4104 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4105 = cute.add_offset(%iter_4104, %idx_4103) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4106 = cute.make_view(%ptr_4105) : !memref_smem_bf16_12
            %iter_4107 = cute.get_iter(%view_4106) : !memref_smem_bf16_12
            %coord_4108 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4109 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
            %idx_4110 = cute.crd2idx(%coord_4108, %lay_4109) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_4111 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
            %ptr_4112 = cute.add_offset(%iter_4111, %idx_4110) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_4113 = cute.make_view(%ptr_4112) : !memref_rmem_i8_1
            %iter_4114 = cute.get_iter(%view_4113) : !memref_rmem_i8_1
            %lay_4115 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %1902 = cute.get_shape(%lay_4115) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4116, %e1_4117, %e2_4118 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %lay_4119 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %1903 = cute.get_shape(%lay_4119) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4120, %e1_4121, %e2_4122 = cute.get_leaves(%1903) : !cute.shape<"((8,1),2)">
            %lay_4123 = cute.get_layout(%view_4099) : !memref_gmem_bf16_8
            %shape_4124 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4125 = cute.make_layout() : !cute.layout<"1:0">
            %append_4126 = cute.append_to_rank<2> (%lay_4123, %lay_4125) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_4127 = cute.make_view(%iter_4100, %append_4126) : !memref_gmem_bf16_8
            %iter_4128 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %lay_4129 = cute.get_layout(%view_4127) : !memref_gmem_bf16_8
            %1904 = cute.get_shape(%lay_4129) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_4130, %e1_4131, %e2_4132 = cute.get_leaves(%1904) : !cute.shape<"((8,1),2)">
            %iter_4133 = cute.get_iter(%view_4127) : !memref_gmem_bf16_8
            %view_4134 = cute.make_view(%iter_4133) : !memref_gmem_bf16_9
            %iter_4135 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4136 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %lay_4137 = cute.get_layout(%view_4106) : !memref_smem_bf16_12
            %shape_4138 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4139 = cute.make_layout() : !cute.layout<"1:0">
            %append_4140 = cute.append_to_rank<2> (%lay_4137, %lay_4139) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_4141 = cute.make_view(%iter_4107, %append_4140) : !memref_smem_bf16_12
            %iter_4142 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %lay_4143 = cute.get_layout(%view_4141) : !memref_smem_bf16_12
            %1905 = cute.get_shape(%lay_4143) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4144, %e1_4145, %e2_4146 = cute.get_leaves(%1905) : !cute.shape<"((8,1),2)">
            %iter_4147 = cute.get_iter(%view_4141) : !memref_smem_bf16_12
            %view_4148 = cute.make_view(%iter_4147) : !memref_smem_bf16_13
            %iter_4149 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %iter_4150 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4151 = cute.get_layout(%view_4113) : !memref_rmem_i8_1
            %shape_4152 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4153 = cute.make_layout() : !cute.layout<"1:0">
            %append_4154 = cute.append_to_rank<2> (%lay_4151, %lay_4153) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_4155 = cute.make_view(%iter_4114, %append_4154) : !memref_rmem_i8_1
            %iter_4156 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %lay_4157 = cute.get_layout(%view_4155) : !memref_rmem_i8_1
            %1906 = cute.get_shape(%lay_4157) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_4158, %e1_4159 = cute.get_leaves(%1906) : !cute.shape<"(1,2)">
            %iter_4160 = cute.get_iter(%view_4155) : !memref_rmem_i8_1
            %view_4161 = cute.make_view(%iter_4160) : !memref_rmem_i8_2
            %iter_4162 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %iter_4163 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4164 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %1907 = cute.get_shape(%lay_4164) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_4165, %e1_4166, %e2_4167 = cute.get_leaves(%1907) : !cute.shape<"((8,1),(2))">
            %lay_4168 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %1908 = cute.get_shape(%lay_4168) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_4169, %e1_4170, %e2_4171 = cute.get_leaves(%1908) : !cute.shape<"((8,1),(2))">
            %lay_4172 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %sz_4173 = cute.size(%lay_4172) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_4174 = cute.get_leaves(%sz_4173) : !cute.int_tuple<"2">
            %lay_4175 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %sz_4176 = cute.size(%lay_4175) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_4177 = cute.get_leaves(%sz_4176) : !cute.int_tuple<"2">
            %1909 = cute.static : !cute.layout<"1:0">
            %iter_4178 = cute.get_iter(%view_4134) : !memref_gmem_bf16_9
            %iter_4179 = cute.get_iter(%view_4148) : !memref_smem_bf16_13
            %lay_4180 = cute.get_layout(%view_4134) : !memref_gmem_bf16_9
            %lay_4181 = cute.get_layout(%view_4148) : !memref_smem_bf16_13
            %append_4182 = cute.append_to_rank<2> (%lay_4180, %1909) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_4183 = cute.append_to_rank<2> (%lay_4181, %1909) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_4184 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_4185 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_4186 = cute.get_iter(%view_4161) : !memref_rmem_i8_2
            %lay_4187 = cute.get_layout(%view_4161) : !memref_rmem_i8_2
            %append_4188 = cute.append_to_rank<2> (%lay_4187, %1909) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_4189 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_4190 = cute.size(%lay_4184) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %1910 = cute.get_scalars(%sz_4190) : !cute.int_tuple<"2">
            %c0_i32_4191 = arith.constant 0 : i32
            %c1_i32_4192 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4191 to %1910 step %c1_i32_4192  : i32 {
              %coord_4193 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1911 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4194 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4195 = cute.crd2idx(%coord_4193, %lay_4184) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_4196 = cute.add_offset(%iter_4178, %idx_4195) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4197 = cute.make_view(%ptr_4196, %lay_4194) : !memref_gmem_bf16_10
              %1912 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4198 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4199 = cute.crd2idx(%coord_4193, %lay_4185) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_4200 = cute.add_offset(%iter_4179, %idx_4199) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4201 = cute.make_view(%ptr_4200, %lay_4198) : !memref_smem_bf16_14
              %1913 = cute.get_scalars(%coord_4193) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4202 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_4203 = cute.crd2idx(%coord_4193, %lay_4189) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_4204 = cute.add_offset(%iter_4186, %idx_4203) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_4205 = cute.make_view(%ptr_4204, %lay_4202) : !memref_rmem_i8_3
              %iter_4206 = cute.get_iter(%view_4197) : !memref_gmem_bf16_10
              %iter_4207 = cute.get_iter(%view_4201) : !memref_smem_bf16_14
              %iter_4208 = cute.get_iter(%view_4205) : !memref_rmem_i8_3
              %1914 = builtin.unrealized_conversion_cast %iter_4208 : !cute.ptr<i8, rmem> to !llvm.ptr
              %1915 = llvm.load %1914 : !llvm.ptr -> i8
              %1916 = llvm.trunc %1915 : i8 to i1
              %iter_4209 = cute.recast_iter(%iter_4206) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4210 = cute.recast_iter(%iter_4207) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4210 : !cute.ptr<i128, smem>, %iter_4209 : !cute.ptr<i128, gmem>, %1916 : i1) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4094 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4095 = cute.get_layout(%view_570) : !memref_smem_bf16_3
            %idx_4096 = cute.crd2idx(%coord_4094, %lay_4095) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_4097 = cute.get_iter(%view_570) : !memref_smem_bf16_3
            %ptr_4098 = cute.add_offset(%iter_4097, %idx_4096) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4099 = cute.make_view(%ptr_4098) : !memref_smem_bf16_12
            %iter_4100 = cute.get_iter(%view_4099) : !memref_smem_bf16_12
            %lay_4101 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %sz_4102 = cute.size(%lay_4101) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_4103 = cute.get_leaves(%sz_4102) : !cute.int_tuple<"16">
            %lay_4104 = cute.get_layout(%view_4099) : !memref_smem_bf16_12
            %1902 = cute.get_shape(%lay_4104) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_4105, %e1_4106, %e2_4107 = cute.get_leaves(%1902) : !cute.shape<"((8,1),2)">
            %int_tuple_4108 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_4109 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_4110 = cute.get_leaves(%int_tuple_4109) : !cute.int_tuple<"16">
            %cst_4111 = arith.constant 0.000000e+00 : bf16
            %1903 = vector.splat %cst_4111 : vector<16xbf16>
            %int_tuple_4112 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4113 = cute.size(%int_tuple_4112) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4114 = cute.get_leaves(%sz_4113) : !cute.int_tuple<"16">
            %int_tuple_4115 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_4116 = cute.size(%int_tuple_4115) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_4117 = cute.get_leaves(%sz_4116) : !cute.int_tuple<"16">
            cute.memref.store_vec %1903, %view_4099, row_major : !memref_smem_bf16_12
          }
        } else {
          %coord_3954 = cute.make_coord(%sub_2735) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_3955 = cute.get_layout(%view_525) : !memref_gmem_bf16_6
          %1817:3 = cute.get_scalars(%lay_3955) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %1818 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_3956 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_3957 = cute.assume(%1817#1) : (i64) -> !cute.i64<divby 128>
          %stride_3958 = cute.make_stride(%iv_3957) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_3959 = cute.make_layout(%shape_3956, %stride_3958) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_3960 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_3961 = cute.get_iter(%view_525) : !memref_gmem_bf16_6
          %ptr_3962 = cute.add_offset(%iter_3961, %idx_3960) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_3963 = cute.make_view(%ptr_3962, %lay_3959) : !memref_gmem_bf16_5
          %iter_3964 = cute.get_iter(%view_3963) : !memref_gmem_bf16_5
          %coord_3965 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3966 = cute.get_layout(%view_570) : !memref_smem_bf16_3
          %idx_3967 = cute.crd2idx(%coord_3965, %lay_3966) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_3968 = cute.get_iter(%view_570) : !memref_smem_bf16_3
          %ptr_3969 = cute.add_offset(%iter_3968, %idx_3967) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3970 = cute.make_view(%ptr_3969) : !memref_smem_bf16_3
          %iter_3971 = cute.get_iter(%view_3970) : !memref_smem_bf16_3
          %coord_3972 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3973 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
          %idx_3974 = cute.crd2idx(%coord_3972, %lay_3973) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_3975 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
          %ptr_3976 = cute.add_offset(%iter_3975, %idx_3974) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_3977 = cute.make_view(%ptr_3976) : !memref_rmem_i8_
          %iter_3978 = cute.get_iter(%view_3977) : !memref_rmem_i8_
          %lay_3979 = cute.get_layout(%view_3963) : !memref_gmem_bf16_5
          %1819 = cute.get_shape(%lay_3979) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%1819) : !cute.shape<"((8,1),4,2)">
          %lay_3984 = cute.get_layout(%view_3970) : !memref_smem_bf16_3
          %1820 = cute.get_shape(%lay_3984) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3985, %e1_3986, %e2_3987, %e3_3988 = cute.get_leaves(%1820) : !cute.shape<"((8,1),4,2)">
          %lay_3989 = cute.get_layout(%view_3963) : !memref_gmem_bf16_5
          %shape_3990 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3991 = cute.make_layout() : !cute.layout<"1:0">
          %append_3992 = cute.append_to_rank<2> (%lay_3989, %lay_3991) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_3993 = cute.make_view(%iter_3964, %append_3992) : !memref_gmem_bf16_5
          %iter_3994 = cute.get_iter(%view_3993) : !memref_gmem_bf16_5
          %lay_3995 = cute.get_layout(%view_3993) : !memref_gmem_bf16_5
          %1821 = cute.get_shape(%lay_3995) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3996, %e1_3997, %e2_3998, %e3_3999 = cute.get_leaves(%1821) : !cute.shape<"((8,1),4,2)">
          %iter_4000 = cute.get_iter(%view_3993) : !memref_gmem_bf16_5
          %lay_4001 = cute.get_layout(%view_3993) : !memref_gmem_bf16_5
          %1822 = cute.get_scalars(%lay_4001) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_4002 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_4003 = cute.assume(%1822) : (i64) -> !cute.i64<divby 128>
          %stride_4004 = cute.make_stride(%iv_4003) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_4005 = cute.make_layout(%shape_4002, %stride_4004) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_4006 = cute.make_view(%iter_4000, %lay_4005) : !memref_gmem_bf16_13
          %iter_4007 = cute.get_iter(%view_4006) : !memref_gmem_bf16_13
          %iter_4008 = cute.get_iter(%view_4006) : !memref_gmem_bf16_13
          %lay_4009 = cute.get_layout(%view_3970) : !memref_smem_bf16_3
          %shape_4010 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4011 = cute.make_layout() : !cute.layout<"1:0">
          %append_4012 = cute.append_to_rank<2> (%lay_4009, %lay_4011) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_4013 = cute.make_view(%iter_3971, %append_4012) : !memref_smem_bf16_3
          %iter_4014 = cute.get_iter(%view_4013) : !memref_smem_bf16_3
          %lay_4015 = cute.get_layout(%view_4013) : !memref_smem_bf16_3
          %1823 = cute.get_shape(%lay_4015) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4016, %e1_4017, %e2_4018, %e3_4019 = cute.get_leaves(%1823) : !cute.shape<"((8,1),4,2)">
          %iter_4020 = cute.get_iter(%view_4013) : !memref_smem_bf16_3
          %view_4021 = cute.make_view(%iter_4020) : !memref_smem_bf16_17
          %iter_4022 = cute.get_iter(%view_4021) : !memref_smem_bf16_17
          %iter_4023 = cute.get_iter(%view_4021) : !memref_smem_bf16_17
          %lay_4024 = cute.get_layout(%view_3977) : !memref_rmem_i8_
          %shape_4025 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4026 = cute.make_layout() : !cute.layout<"1:0">
          %append_4027 = cute.append_to_rank<2> (%lay_4024, %lay_4026) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_4028 = cute.make_view(%iter_3978, %append_4027) : !memref_rmem_i8_
          %iter_4029 = cute.get_iter(%view_4028) : !memref_rmem_i8_
          %lay_4030 = cute.get_layout(%view_4028) : !memref_rmem_i8_
          %1824 = cute.get_shape(%lay_4030) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_4031, %e1_4032, %e2_4033 = cute.get_leaves(%1824) : !cute.shape<"(1,4,2)">
          %iter_4034 = cute.get_iter(%view_4028) : !memref_rmem_i8_
          %view_4035 = cute.make_view(%iter_4034) : !memref_rmem_i8_4
          %iter_4036 = cute.get_iter(%view_4035) : !memref_rmem_i8_4
          %iter_4037 = cute.get_iter(%view_4035) : !memref_rmem_i8_4
          %lay_4038 = cute.get_layout(%view_4006) : !memref_gmem_bf16_13
          %1825 = cute.get_shape(%lay_4038) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4039, %e1_4040, %e2_4041, %e3_4042 = cute.get_leaves(%1825) : !cute.shape<"((8,1),(4,2))">
          %lay_4043 = cute.get_layout(%view_4021) : !memref_smem_bf16_17
          %1826 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4044, %e1_4045, %e2_4046, %e3_4047 = cute.get_leaves(%1826) : !cute.shape<"((8,1),(4,2))">
          %lay_4048 = cute.get_layout(%view_4006) : !memref_gmem_bf16_13
          %sz_4049 = cute.size(%lay_4048) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_4050 = cute.get_leaves(%sz_4049) : !cute.int_tuple<"8">
          %lay_4051 = cute.get_layout(%view_4021) : !memref_smem_bf16_17
          %sz_4052 = cute.size(%lay_4051) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_4053 = cute.get_leaves(%sz_4052) : !cute.int_tuple<"8">
          %1827 = cute.static : !cute.layout<"1:0">
          %iter_4054 = cute.get_iter(%view_4006) : !memref_gmem_bf16_13
          %iter_4055 = cute.get_iter(%view_4021) : !memref_smem_bf16_17
          %lay_4056 = cute.get_layout(%view_4006) : !memref_gmem_bf16_13
          %lay_4057 = cute.get_layout(%view_4021) : !memref_smem_bf16_17
          %append_4058 = cute.append_to_rank<2> (%lay_4056, %1827) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_4059 = cute.append_to_rank<2> (%lay_4057, %1827) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1828 = cute.get_scalars(%append_4058) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_4060 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_4061 = cute.assume(%1828) : (i64) -> !cute.i64<divby 128>
          %stride_4062 = cute.make_stride(%iv_4061) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_4063 = cute.make_layout(%shape_4060, %stride_4062) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_4064 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_4065 = cute.get_iter(%view_4035) : !memref_rmem_i8_4
          %lay_4066 = cute.get_layout(%view_4035) : !memref_rmem_i8_4
          %append_4067 = cute.append_to_rank<2> (%lay_4066, %1827) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_4068 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_4069 = cute.size(%lay_4063) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1829 = cute.get_scalars(%sz_4069) : !cute.int_tuple<"8">
          %c0_i32_4070 = arith.constant 0 : i32
          %c1_i32_4071 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4070 to %1829 step %c1_i32_4071  : i32 {
            %coord_4072 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1830 = cute.get_scalars(%lay_4063) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %1831 = cute.get_scalars(%coord_4072) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4073 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4074 = cute.crd2idx(%coord_4072, %lay_4063) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_4075 = cute.add_offset(%iter_4054, %idx_4074) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4076 = cute.make_view(%ptr_4075, %lay_4073) : !memref_gmem_bf16_10
            %1832 = cute.get_scalars(%coord_4072) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4077 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4078 = cute.crd2idx(%coord_4072, %lay_4064) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4079 = cute.add_offset(%iter_4055, %idx_4078) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4080 = cute.make_view(%ptr_4079, %lay_4077) : !memref_smem_bf16_14
            %1833 = cute.get_scalars(%coord_4072) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4081 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_4082 = cute.crd2idx(%coord_4072, %lay_4068) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_4083 = cute.add_offset(%iter_4065, %idx_4082) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_4084 = cute.make_view(%ptr_4083, %lay_4081) : !memref_rmem_i8_3
            %iter_4085 = cute.get_iter(%view_4076) : !memref_gmem_bf16_10
            %iter_4086 = cute.get_iter(%view_4080) : !memref_smem_bf16_14
            %iter_4087 = cute.get_iter(%view_4084) : !memref_rmem_i8_3
            %1834 = builtin.unrealized_conversion_cast %iter_4087 : !cute.ptr<i8, rmem> to !llvm.ptr
            %1835 = llvm.load %1834 : !llvm.ptr -> i8
            %1836 = llvm.trunc %1835 : i8 to i1
            %iter_4088 = cute.recast_iter(%iter_4085) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_4089 = cute.recast_iter(%iter_4086) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_4089 : !cute.ptr<i128, smem>, %iter_4088 : !cute.ptr<i128, gmem>, %1836 : i1) {cache_mode = <always>}
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %shape_2738 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %shape_2739 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %e0_2740, %e1_2741, %e2_2742, %e3_2743 = cute.get_leaves(%shape_2739) : !cute.shape<"((2,2),1,8)">
        %shape_2744 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2745 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2746 = cute.memref.alloca(%lay_2745) : !memref_rmem_f32_1
        %iter_2747 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_2748 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %shape_2749 = cute.make_shape() : () -> !cute.shape<"(64,64)">
        %shape_2750 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %e0_2751, %e1_2752, %e2_2753, %e3_2754 = cute.get_leaves(%shape_2750) : !cute.shape<"((2,2),1,8)">
        %shape_2755 = cute.make_shape() : () -> !cute.shape<"((2,2),1,8)">
        %lay_2756 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_2757 = cute.memref.alloca(%lay_2756) : !memref_rmem_bf16_6
        %iter_2758 = cute.get_iter(%rmem_2757) : !memref_rmem_bf16_6
        %iter_2759 = cute.get_iter(%rmem_2757) : !memref_rmem_bf16_6
        %iter_2760 = cute.get_iter(%rmem_2757) : !memref_rmem_bf16_6
        %view_2761 = cute.make_view(%iter_2760) : !memref_rmem_bf16_7
        %iter_2762 = cute.get_iter(%view_2761) : !memref_rmem_bf16_7
        %coord_2763 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2764 = cute.get_layout(%view_1025) : !memref_smem_bf16_11
        %1597:2 = cute.get_scalars(%lay_2764) <{only_dynamic}> : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %shape_2765 = cute.make_shape() : () -> !cute.shape<"((8,1),1,(2,2))">
        %iv_2766 = cute.assume(%1597#0) : (i32) -> !cute.i32<divby 16>
        %iv_2767 = cute.assume(%1597#1) : (i32) -> !cute.i32<divby 32>
        %stride_2768 = cute.make_stride(%iv_2766, %iv_2767) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),0,(?{div=16},?{div=32}))">
        %lay_2769 = cute.make_layout(%shape_2765, %stride_2768) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %idx_2770 = cute.crd2idx(%coord_2763, %lay_2764) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.int_tuple<"0">
        %iter_2771 = cute.get_iter(%view_1025) : !memref_smem_bf16_11
        %ptr_2772 = cute.add_offset(%iter_2771, %idx_2770) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2773 = cute.make_view(%ptr_2772, %lay_2769) : !memref_smem_bf16_11
        %iter_2774 = cute.get_iter(%view_2773) : !memref_smem_bf16_11
        %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
        %lay_2776 = cute.get_layout(%view_2761) : !memref_rmem_bf16_7
        %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.int_tuple<"0">
        %iter_2778 = cute.get_iter(%view_2761) : !memref_rmem_bf16_7
        %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_bf16_7
        %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_bf16_7
        %lay_2782 = cute.get_layout(%view_2773) : !memref_smem_bf16_11
        %1598 = cute.get_shape(%lay_2782) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2783, %e1_2784, %e2_2785, %e3_2786, %e4_2787 = cute.get_leaves(%1598) : !cute.shape<"((8,1),1,(2,2))">
        %lay_2788 = cute.get_layout(%view_2780) : !memref_rmem_bf16_7
        %1599 = cute.get_shape(%lay_2788) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2789, %e1_2790, %e2_2791, %e3_2792 = cute.get_leaves(%1599) : !cute.shape<"((8,1),1,4)">
        %lay_2793 = cute.get_layout(%view_2773) : !memref_smem_bf16_11
        %shape_2794 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2795 = cute.make_layout() : !cute.layout<"1:0">
        %append_2796 = cute.append_to_rank<2> (%lay_2793, %lay_2795) : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">, !cute.layout<"1:0">
        %view_2797 = cute.make_view(%iter_2774, %append_2796) : !memref_smem_bf16_11
        %iter_2798 = cute.get_iter(%view_2797) : !memref_smem_bf16_11
        %lay_2799 = cute.get_layout(%view_2797) : !memref_smem_bf16_11
        %1600 = cute.get_shape(%lay_2799) : (!cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">) -> !cute.shape<"((8,1),1,(2,2))">
        %e0_2800, %e1_2801, %e2_2802, %e3_2803, %e4_2804 = cute.get_leaves(%1600) : !cute.shape<"((8,1),1,(2,2))">
        %iter_2805 = cute.get_iter(%view_2797) : !memref_smem_bf16_11
        %lay_2806 = cute.get_layout(%view_2797) : !memref_smem_bf16_11
        %1601:2 = cute.get_scalars(%lay_2806) <{only_dynamic}> : !cute.layout<"((8,1),1,(2,2)):((1,0),0,(?{div=16},?{div=32}))">
        %shape_2807 = cute.make_shape() : () -> !cute.shape<"((8,1),(1,(2,2)))">
        %iv_2808 = cute.assume(%1601#0) : (i32) -> !cute.i32<divby 16>
        %iv_2809 = cute.assume(%1601#1) : (i32) -> !cute.i32<divby 32>
        %stride_2810 = cute.make_stride(%iv_2808, %iv_2809) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(0,(?{div=16},?{div=32})))">
        %lay_2811 = cute.make_layout(%shape_2807, %stride_2810) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %view_2812 = cute.make_view(%iter_2805, %lay_2811) : !memref_smem_bf16_18
        %iter_2813 = cute.get_iter(%view_2812) : !memref_smem_bf16_18
        %iter_2814 = cute.get_iter(%view_2812) : !memref_smem_bf16_18
        %lay_2815 = cute.get_layout(%view_2780) : !memref_rmem_bf16_7
        %shape_2816 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2817 = cute.make_layout() : !cute.layout<"1:0">
        %append_2818 = cute.append_to_rank<2> (%lay_2815, %lay_2817) : !cute.layout<"((8,1),1,4):((1,0),0,8)">, !cute.layout<"1:0">
        %view_2819 = cute.make_view(%iter_2781, %append_2818) : !memref_rmem_bf16_7
        %iter_2820 = cute.get_iter(%view_2819) : !memref_rmem_bf16_7
        %lay_2821 = cute.get_layout(%view_2819) : !memref_rmem_bf16_7
        %1602 = cute.get_shape(%lay_2821) : (!cute.layout<"((8,1),1,4):((1,0),0,8)">) -> !cute.shape<"((8,1),1,4)">
        %e0_2822, %e1_2823, %e2_2824, %e3_2825 = cute.get_leaves(%1602) : !cute.shape<"((8,1),1,4)">
        %iter_2826 = cute.get_iter(%view_2819) : !memref_rmem_bf16_7
        %view_2827 = cute.make_view(%iter_2826) : !memref_rmem_bf16_8
        %iter_2828 = cute.get_iter(%view_2827) : !memref_rmem_bf16_8
        %iter_2829 = cute.get_iter(%view_2827) : !memref_rmem_bf16_8
        %lay_2830 = cute.get_layout(%view_2812) : !memref_smem_bf16_18
        %1603 = cute.get_shape(%lay_2830) : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.shape<"((8,1),(1,(2,2)))">
        %e0_2831, %e1_2832, %e2_2833, %e3_2834, %e4_2835 = cute.get_leaves(%1603) : !cute.shape<"((8,1),(1,(2,2)))">
        %lay_2836 = cute.get_layout(%view_2827) : !memref_rmem_bf16_8
        %1604 = cute.get_shape(%lay_2836) : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.shape<"((8,1),(1,4))">
        %e0_2837, %e1_2838, %e2_2839, %e3_2840 = cute.get_leaves(%1604) : !cute.shape<"((8,1),(1,4))">
        %lay_2841 = cute.get_layout(%view_2812) : !memref_smem_bf16_18
        %sz_2842 = cute.size(%lay_2841) <{mode = [1]}> : (!cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">) -> !cute.int_tuple<"4">
        %e0_2843 = cute.get_leaves(%sz_2842) : !cute.int_tuple<"4">
        %lay_2844 = cute.get_layout(%view_2827) : !memref_rmem_bf16_8
        %sz_2845 = cute.size(%lay_2844) <{mode = [1]}> : (!cute.layout<"((8,1),(1,4)):((1,0),(0,8))">) -> !cute.int_tuple<"4">
        %e0_2846 = cute.get_leaves(%sz_2845) : !cute.int_tuple<"4">
        %1605 = cute.static : !cute.layout<"1:0">
        %iter_2847 = cute.get_iter(%view_2812) : !memref_smem_bf16_18
        %iter_2848 = cute.get_iter(%view_2827) : !memref_rmem_bf16_8
        %lay_2849 = cute.get_layout(%view_2812) : !memref_smem_bf16_18
        %lay_2850 = cute.get_layout(%view_2827) : !memref_rmem_bf16_8
        %append_2851 = cute.append_to_rank<2> (%lay_2849, %1605) : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">, !cute.layout<"1:0">
        %append_2852 = cute.append_to_rank<2> (%lay_2850, %1605) : !cute.layout<"((8,1),(1,4)):((1,0),(0,8))">, !cute.layout<"1:0">
        %1606:2 = cute.get_scalars(%append_2851) <{only_dynamic}> : !cute.layout<"((8,1),(1,(2,2))):((1,0),(0,(?{div=16},?{div=32})))">
        %shape_2853 = cute.make_shape() : () -> !cute.shape<"((8,1),((1,(2,2))))">
        %iv_2854 = cute.assume(%1606#0) : (i32) -> !cute.i32<divby 16>
        %iv_2855 = cute.assume(%1606#1) : (i32) -> !cute.i32<divby 32>
        %stride_2856 = cute.make_stride(%iv_2854, %iv_2855) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2857 = cute.make_layout(%shape_2853, %stride_2856) : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">
        %lay_2858 = cute.make_layout() : !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">
        %sz_2859 = cute.size(%lay_2857) <{mode = [1]}> : (!cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"4">
        %1607 = cute.get_scalars(%sz_2859) : !cute.int_tuple<"4">
        %c0_i32_2860 = arith.constant 0 : i32
        %c1_i32_2861 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2860 to %1607 step %c1_i32_2861  : i32 {
          %coord_3954 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1817:2 = cute.get_scalars(%lay_2857) <{only_dynamic}> : !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">
          %1818 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3955 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_2857) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,(2,2)))):((1,0),((0,(?{div=16},?{div=32}))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_3957 = cute.add_offset(%iter_2847, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3958 = cute.make_view(%ptr_3957, %lay_3955) : !memref_smem_bf16_14
          %1819 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3959 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3960 = cute.crd2idx(%coord_3954, %lay_2858) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1,4))):((1,0),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_3961 = cute.add_offset(%iter_2848, %idx_3960) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3962 = cute.make_view(%ptr_3961, %lay_3959) : !memref_rmem_bf16_9
          %iter_3963 = cute.get_iter(%view_3958) : !memref_smem_bf16_14
          %iter_3964 = cute.get_iter(%view_3962) : !memref_rmem_bf16_9
          %swizzled = cute.apply_swizzle(%iter_3963) : !cute.ptr<bf16, smem, align<16>>
          %1820 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %1821 = llvm.mlir.constant(0 : i32) : i32
          %1822 = vector.extractelement %1820[%1821 : i32] : vector<4xi32>
          %1823 = builtin.unrealized_conversion_cast %iter_3964 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %1822, %1823 : i32, !llvm.ptr
          %1824 = llvm.mlir.constant(1 : i32) : i32
          %1825 = vector.extractelement %1820[%1824 : i32] : vector<4xi32>
          %int_tuple_3965 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_3966 = cute.add_offset(%iter_3964, %int_tuple_3965) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1826 = builtin.unrealized_conversion_cast %ptr_3966 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1825, %1826 : i32, !llvm.ptr
          %1827 = llvm.mlir.constant(2 : i32) : i32
          %1828 = vector.extractelement %1820[%1827 : i32] : vector<4xi32>
          %int_tuple_3967 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_3968 = cute.add_offset(%iter_3964, %int_tuple_3967) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %1829 = builtin.unrealized_conversion_cast %ptr_3968 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1828, %1829 : i32, !llvm.ptr
          %1830 = llvm.mlir.constant(3 : i32) : i32
          %1831 = vector.extractelement %1820[%1830 : i32] : vector<4xi32>
          %int_tuple_3969 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_3970 = cute.add_offset(%iter_3964, %int_tuple_3969) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %1832 = builtin.unrealized_conversion_cast %ptr_3970 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1831, %1832 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_2862 = cute.get_layout(%rmem_2757) : !memref_rmem_bf16_6
        %1608 = cute.get_shape(%lay_2862) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2863, %e1_2864, %e2_2865, %e3_2866 = cute.get_leaves(%1608) : !cute.shape<"((2,2),1,8)">
        %1609 = cute.memref.load_vec %rmem_2757, row_major : !memref_rmem_bf16_6
        %1610 = arith.extf %1609 : vector<32xbf16> to vector<32xf32>
        %lay_2867 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1611 = cute.get_shape(%lay_2867) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_2868, %e1_2869, %e2_2870, %e3_2871 = cute.get_leaves(%1611) : !cute.shape<"((2,2),1,8)">
        %int_tuple_2872 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2873 = cute.size(%int_tuple_2872) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2874 = cute.get_leaves(%sz_2873) : !cute.int_tuple<"32">
        %int_tuple_2875 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_2876 = cute.size(%int_tuple_2875) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_2877 = cute.get_leaves(%sz_2876) : !cute.int_tuple<"32">
        cute.memref.store_vec %1610, %rmem_2746, row_major : !memref_rmem_f32_1
        %coord_2878 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2879 = cute.get_layout(%view_875) : !memref_smem_bf16_8
        %idx_2880 = cute.crd2idx(%coord_2878, %lay_2879) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2881 = cute.get_iter(%view_875) : !memref_smem_bf16_8
        %ptr_2882 = cute.add_offset(%iter_2881, %idx_2880) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2883 = cute.make_view(%ptr_2882) : !memref_smem_bf16_15
        %iter_2884 = cute.get_iter(%view_2883) : !memref_smem_bf16_15
        %coord_2885 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2886 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
        %idx_2887 = cute.crd2idx(%coord_2885, %lay_2886) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"0">
        %iter_2888 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
        %ptr_2889 = cute.add_offset(%iter_2888, %idx_2887) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2890 = cute.make_view(%ptr_2889) : !memref_rmem_bf16_10
        %iter_2891 = cute.get_iter(%view_2890) : !memref_rmem_bf16_10
        %lay_2892 = cute.get_layout(%view_2883) : !memref_smem_bf16_15
        %1612 = cute.get_shape(%lay_2892) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2893, %e1_2894, %e2_2895 = cute.get_leaves(%1612) : !cute.shape<"((8,1),1)">
        %lay_2896 = cute.get_layout(%view_2890) : !memref_rmem_bf16_10
        %1613 = cute.get_shape(%lay_2896) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2897, %e1_2898, %e2_2899 = cute.get_leaves(%1613) : !cute.shape<"((8,1),1)">
        %lay_2900 = cute.get_layout(%view_2883) : !memref_smem_bf16_15
        %shape_2901 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2902 = cute.make_layout() : !cute.layout<"1:0">
        %append_2903 = cute.append_to_rank<2> (%lay_2900, %lay_2902) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2904 = cute.make_view(%iter_2884, %append_2903) : !memref_smem_bf16_15
        %iter_2905 = cute.get_iter(%view_2904) : !memref_smem_bf16_15
        %lay_2906 = cute.get_layout(%view_2904) : !memref_smem_bf16_15
        %1614 = cute.get_shape(%lay_2906) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2907, %e1_2908, %e2_2909 = cute.get_leaves(%1614) : !cute.shape<"((8,1),1)">
        %iter_2910 = cute.get_iter(%view_2904) : !memref_smem_bf16_15
        %view_2911 = cute.make_view(%iter_2910) : !memref_smem_bf16_16
        %iter_2912 = cute.get_iter(%view_2911) : !memref_smem_bf16_16
        %iter_2913 = cute.get_iter(%view_2911) : !memref_smem_bf16_16
        %lay_2914 = cute.get_layout(%view_2890) : !memref_rmem_bf16_10
        %shape_2915 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2916 = cute.make_layout() : !cute.layout<"1:0">
        %append_2917 = cute.append_to_rank<2> (%lay_2914, %lay_2916) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
        %view_2918 = cute.make_view(%iter_2891, %append_2917) : !memref_rmem_bf16_10
        %iter_2919 = cute.get_iter(%view_2918) : !memref_rmem_bf16_10
        %lay_2920 = cute.get_layout(%view_2918) : !memref_rmem_bf16_10
        %1615 = cute.get_shape(%lay_2920) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
        %e0_2921, %e1_2922, %e2_2923 = cute.get_leaves(%1615) : !cute.shape<"((8,1),1)">
        %iter_2924 = cute.get_iter(%view_2918) : !memref_rmem_bf16_10
        %view_2925 = cute.make_view(%iter_2924) : !memref_rmem_bf16_11
        %iter_2926 = cute.get_iter(%view_2925) : !memref_rmem_bf16_11
        %iter_2927 = cute.get_iter(%view_2925) : !memref_rmem_bf16_11
        %lay_2928 = cute.get_layout(%view_2911) : !memref_smem_bf16_16
        %1616 = cute.get_shape(%lay_2928) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2929, %e1_2930, %e2_2931 = cute.get_leaves(%1616) : !cute.shape<"((8,1),(1))">
        %lay_2932 = cute.get_layout(%view_2925) : !memref_rmem_bf16_11
        %1617 = cute.get_shape(%lay_2932) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
        %e0_2933, %e1_2934, %e2_2935 = cute.get_leaves(%1617) : !cute.shape<"((8,1),(1))">
        %lay_2936 = cute.get_layout(%view_2911) : !memref_smem_bf16_16
        %sz_2937 = cute.size(%lay_2936) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2938 = cute.get_leaves(%sz_2937) : !cute.int_tuple<"1">
        %lay_2939 = cute.get_layout(%view_2925) : !memref_rmem_bf16_11
        %sz_2940 = cute.size(%lay_2939) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
        %e0_2941 = cute.get_leaves(%sz_2940) : !cute.int_tuple<"1">
        %1618 = cute.static : !cute.layout<"1:0">
        %iter_2942 = cute.get_iter(%view_2911) : !memref_smem_bf16_16
        %iter_2943 = cute.get_iter(%view_2925) : !memref_rmem_bf16_11
        %lay_2944 = cute.get_layout(%view_2911) : !memref_smem_bf16_16
        %lay_2945 = cute.get_layout(%view_2925) : !memref_rmem_bf16_11
        %append_2946 = cute.append_to_rank<2> (%lay_2944, %1618) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %append_2947 = cute.append_to_rank<2> (%lay_2945, %1618) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
        %lay_2948 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %lay_2949 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
        %sz_2950 = cute.size(%lay_2948) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
        %1619 = cute.get_scalars(%sz_2950) : !cute.int_tuple<"1">
        %c0_i32_2951 = arith.constant 0 : i32
        %c1_i32_2952 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_2951 to %1619 step %c1_i32_2952  : i32 {
          %coord_3954 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1817 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3955 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_2948) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_3957 = cute.add_offset(%iter_2942, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3958 = cute.make_view(%ptr_3957, %lay_3955) : !memref_smem_bf16_14
          %1818 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3959 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3960 = cute.crd2idx(%coord_3954, %lay_2949) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
          %ptr_3961 = cute.add_offset(%iter_2943, %idx_3960) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3962 = cute.make_view(%ptr_3961, %lay_3959) : !memref_rmem_bf16_9
          %iter_3963 = cute.get_iter(%view_3958) : !memref_smem_bf16_14
          %iter_3964 = cute.get_iter(%view_3962) : !memref_rmem_bf16_9
          %swizzled = cute.apply_swizzle(%iter_3963) : !cute.ptr<bf16, smem, align<16>>
          %1819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %1820 = llvm.mlir.constant(0 : i32) : i32
          %1821 = vector.extractelement %1819[%1820 : i32] : vector<4xi32>
          %1822 = builtin.unrealized_conversion_cast %iter_3964 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %1821, %1822 : i32, !llvm.ptr
          %1823 = llvm.mlir.constant(1 : i32) : i32
          %1824 = vector.extractelement %1819[%1823 : i32] : vector<4xi32>
          %int_tuple_3965 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_3966 = cute.add_offset(%iter_3964, %int_tuple_3965) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1825 = builtin.unrealized_conversion_cast %ptr_3966 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1824, %1825 : i32, !llvm.ptr
          %1826 = llvm.mlir.constant(2 : i32) : i32
          %1827 = vector.extractelement %1819[%1826 : i32] : vector<4xi32>
          %int_tuple_3967 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_3968 = cute.add_offset(%iter_3964, %int_tuple_3967) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %1828 = builtin.unrealized_conversion_cast %ptr_3968 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1827, %1828 : i32, !llvm.ptr
          %1829 = llvm.mlir.constant(3 : i32) : i32
          %1830 = vector.extractelement %1819[%1829 : i32] : vector<4xi32>
          %int_tuple_3969 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_3970 = cute.add_offset(%iter_3964, %int_tuple_3969) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %1831 = builtin.unrealized_conversion_cast %ptr_3970 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1830, %1831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_2953 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2954 = cute.get_layout(%view_932) : !memref_smem_bf16_9
        %idx_2955 = cute.crd2idx(%coord_2953, %lay_2954) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_2956 = cute.get_iter(%view_932) : !memref_smem_bf16_9
        %ptr_2957 = cute.add_offset(%iter_2956, %idx_2955) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_2958 = cute.make_view(%ptr_2957) : !memref_smem_bf16_19
        %iter_2959 = cute.get_iter(%view_2958) : !memref_smem_bf16_19
        %coord_2960 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_2961 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
        %idx_2962 = cute.crd2idx(%coord_2960, %lay_2961) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"0">
        %iter_2963 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
        %ptr_2964 = cute.add_offset(%iter_2963, %idx_2962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_2965 = cute.make_view(%ptr_2964) : !memref_rmem_bf16_12
        %iter_2966 = cute.get_iter(%view_2965) : !memref_rmem_bf16_12
        %lay_2967 = cute.get_layout(%view_2958) : !memref_smem_bf16_19
        %1620 = cute.get_shape(%lay_2967) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2968, %e1_2969, %e2_2970 = cute.get_leaves(%1620) : !cute.shape<"((8,1),4)">
        %lay_2971 = cute.get_layout(%view_2965) : !memref_rmem_bf16_12
        %1621 = cute.get_shape(%lay_2971) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_2972, %e1_2973, %e2_2974, %e3_2975 = cute.get_leaves(%1621) : !cute.shape<"(((4,2),1),4)">
        %lay_2976 = cute.get_layout(%view_2958) : !memref_smem_bf16_19
        %shape_2977 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2978 = cute.make_layout() : !cute.layout<"1:0">
        %append_2979 = cute.append_to_rank<2> (%lay_2976, %lay_2978) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_2980 = cute.make_view(%iter_2959, %append_2979) : !memref_smem_bf16_19
        %iter_2981 = cute.get_iter(%view_2980) : !memref_smem_bf16_19
        %lay_2982 = cute.get_layout(%view_2980) : !memref_smem_bf16_19
        %1622 = cute.get_shape(%lay_2982) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_2983, %e1_2984, %e2_2985 = cute.get_leaves(%1622) : !cute.shape<"((8,1),4)">
        %iter_2986 = cute.get_iter(%view_2980) : !memref_smem_bf16_19
        %view_2987 = cute.make_view(%iter_2986) : !memref_smem_bf16_20
        %iter_2988 = cute.get_iter(%view_2987) : !memref_smem_bf16_20
        %iter_2989 = cute.get_iter(%view_2987) : !memref_smem_bf16_20
        %lay_2990 = cute.get_layout(%view_2965) : !memref_rmem_bf16_12
        %shape_2991 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2992 = cute.make_layout() : !cute.layout<"1:0">
        %append_2993 = cute.append_to_rank<2> (%lay_2990, %lay_2992) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
        %view_2994 = cute.make_view(%iter_2966, %append_2993) : !memref_rmem_bf16_12
        %iter_2995 = cute.get_iter(%view_2994) : !memref_rmem_bf16_12
        %lay_2996 = cute.get_layout(%view_2994) : !memref_rmem_bf16_12
        %1623 = cute.get_shape(%lay_2996) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
        %e0_2997, %e1_2998, %e2_2999, %e3_3000 = cute.get_leaves(%1623) : !cute.shape<"(((4,2),1),4)">
        %iter_3001 = cute.get_iter(%view_2994) : !memref_rmem_bf16_12
        %view_3002 = cute.make_view(%iter_3001) : !memref_rmem_bf16_13
        %iter_3003 = cute.get_iter(%view_3002) : !memref_rmem_bf16_13
        %iter_3004 = cute.get_iter(%view_3002) : !memref_rmem_bf16_13
        %lay_3005 = cute.get_layout(%view_2987) : !memref_smem_bf16_20
        %1624 = cute.get_shape(%lay_3005) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_3006, %e1_3007, %e2_3008 = cute.get_leaves(%1624) : !cute.shape<"((8,1),(4))">
        %lay_3009 = cute.get_layout(%view_3002) : !memref_rmem_bf16_13
        %1625 = cute.get_shape(%lay_3009) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
        %e0_3010, %e1_3011, %e2_3012, %e3_3013 = cute.get_leaves(%1625) : !cute.shape<"(((4,2),1),(4))">
        %lay_3014 = cute.get_layout(%view_2987) : !memref_smem_bf16_20
        %sz_3015 = cute.size(%lay_3014) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_3016 = cute.get_leaves(%sz_3015) : !cute.int_tuple<"4">
        %lay_3017 = cute.get_layout(%view_3002) : !memref_rmem_bf16_13
        %sz_3018 = cute.size(%lay_3017) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
        %e0_3019 = cute.get_leaves(%sz_3018) : !cute.int_tuple<"4">
        %1626 = cute.static : !cute.layout<"1:0">
        %iter_3020 = cute.get_iter(%view_2987) : !memref_smem_bf16_20
        %iter_3021 = cute.get_iter(%view_3002) : !memref_rmem_bf16_13
        %lay_3022 = cute.get_layout(%view_2987) : !memref_smem_bf16_20
        %lay_3023 = cute.get_layout(%view_3002) : !memref_rmem_bf16_13
        %append_3024 = cute.append_to_rank<2> (%lay_3022, %1626) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_3025 = cute.append_to_rank<2> (%lay_3023, %1626) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
        %lay_3026 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_3027 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
        %sz_3028 = cute.size(%lay_3026) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %1627 = cute.get_scalars(%sz_3028) : !cute.int_tuple<"4">
        %c0_i32_3029 = arith.constant 0 : i32
        %c1_i32_3030 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3029 to %1627 step %c1_i32_3030  : i32 {
          %coord_3954 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1817 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3955 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3026) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_3957 = cute.add_offset(%iter_3020, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3958 = cute.make_view(%ptr_3957, %lay_3955) : !memref_smem_bf16_14
          %1818 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3959 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
          %idx_3960 = cute.crd2idx(%coord_3954, %lay_3027) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
          %ptr_3961 = cute.add_offset(%iter_3021, %idx_3960) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3962 = cute.make_view(%ptr_3961, %lay_3959) : !memref_rmem_bf16_14
          %iter_3963 = cute.get_iter(%view_3958) : !memref_smem_bf16_14
          %iter_3964 = cute.get_iter(%view_3962) : !memref_rmem_bf16_14
          %swizzled = cute.apply_swizzle(%iter_3963) : !cute.ptr<bf16, smem, align<16>>
          %1819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %1820 = llvm.mlir.constant(0 : i32) : i32
          %1821 = vector.extractelement %1819[%1820 : i32] : vector<4xi32>
          %1822 = builtin.unrealized_conversion_cast %iter_3964 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1821, %1822 : i32, !llvm.ptr
          %1823 = llvm.mlir.constant(1 : i32) : i32
          %1824 = vector.extractelement %1819[%1823 : i32] : vector<4xi32>
          %int_tuple_3965 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_3966 = cute.add_offset(%iter_3964, %int_tuple_3965) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1825 = builtin.unrealized_conversion_cast %ptr_3966 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1824, %1825 : i32, !llvm.ptr
          %1826 = llvm.mlir.constant(2 : i32) : i32
          %1827 = vector.extractelement %1819[%1826 : i32] : vector<4xi32>
          %int_tuple_3967 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
          %ptr_3968 = cute.add_offset(%iter_3964, %int_tuple_3967) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %1828 = builtin.unrealized_conversion_cast %ptr_3968 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1827, %1828 : i32, !llvm.ptr
          %1829 = llvm.mlir.constant(3 : i32) : i32
          %1830 = vector.extractelement %1819[%1829 : i32] : vector<4xi32>
          %int_tuple_3969 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
          %ptr_3970 = cute.add_offset(%iter_3964, %int_tuple_3969) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
          %1831 = builtin.unrealized_conversion_cast %ptr_3970 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1830, %1831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_3031 = cute.get_layout(%view_875) : !memref_smem_bf16_8
        %1628 = cute.get_shape(%lay_3031) : (!cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),1,((2,2),2))">
        %e0_3032, %e1_3033, %e2_3034, %e3_3035, %e4_3036, %e5_3037 = cute.get_leaves(%1628) : !cute.shape<"((8,1),1,((2,2),2))">
        %int_tuple_3038 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3039 = cute.size(%int_tuple_3038) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3040 = cute.get_leaves(%sz_3039) : !cute.int_tuple<"8">
        %int_tuple_3041 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3042 = cute.size(%int_tuple_3041) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3043 = cute.get_leaves(%sz_3042) : !cute.int_tuple<"8">
        %true_3044 = arith.constant true
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"64">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3045 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3046 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3047 = cute.crd2idx(%coord_3045, %lay_3046) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"0">
        %iter_3048 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3049 = cute.add_offset(%iter_3048, %idx_3047) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3050 = cute.make_view(%ptr_3049) : !memref_rmem_bf16_15
        %iter_3051 = cute.get_iter(%view_3050) : !memref_rmem_bf16_15
        %coord_3052 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3053 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3054 = cute.crd2idx(%coord_3052, %lay_3053) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"0">
        %iter_3055 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3056 = cute.add_offset(%iter_3055, %idx_3054) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3057 = cute.make_view(%ptr_3056) : !memref_rmem_bf16_16
        %iter_3058 = cute.get_iter(%view_3057) : !memref_rmem_bf16_16
        %lay_3059 = cute.get_layout(%view_3050) : !memref_rmem_bf16_15
        %1629 = cute.get_shape(%lay_3059) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3060, %e1_3061, %e2_3062, %e3_3063 = cute.get_leaves(%1629) : !cute.shape<"((2,2,2),1)">
        %lay_3064 = cute.get_layout(%view_3057) : !memref_rmem_bf16_16
        %1630 = cute.get_shape(%lay_3064) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3065, %e1_3066, %e2_3067, %e3_3068 = cute.get_leaves(%1630) : !cute.shape<"((2,2),(2,4))">
        %iter_3069 = cute.get_iter(%view_3050) : !memref_rmem_bf16_15
        %iter_3070 = cute.get_iter(%view_3057) : !memref_rmem_bf16_16
        %iter_3071 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3072 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3073 = cute.get_layout(%view_3050) : !memref_rmem_bf16_15
        %lay_3074 = cute.get_layout(%view_3057) : !memref_rmem_bf16_16
        %lay_3075 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3076 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1631 = cute.static : !cute.layout<"1:0">
        %append_3077 = cute.append_to_rank<3> (%lay_3073, %1631) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3078 = cute.append_to_rank<3> (%lay_3074, %1631) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3079 = cute.size(%append_3077) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3080 = cute.size(%append_3077) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3081 = cute.size(%append_3078) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1632 = cute.get_scalars(%sz_3079) : !cute.int_tuple<"1">
        %1633 = cute.get_scalars(%sz_3080) : !cute.int_tuple<"1">
        %1634 = cute.get_scalars(%sz_3081) : !cute.int_tuple<"8">
        %c0_i32_3082 = arith.constant 0 : i32
        %c1_i32_3083 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3082 to %1632 step %c1_i32_3083  : i32 {
          scf.for %arg9 = %c0_i32_3082 to %1633 step %c1_i32_3083  : i32 {
            scf.for %arg10 = %c0_i32_3082 to %1634 step %c1_i32_3083  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3077) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3069, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3078) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3070, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3075) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3071, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3076) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3072, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3084 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3085 = cute.size(%int_tuple_3084) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3086 = cute.get_leaves(%sz_3085) : !cute.int_tuple<"8">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"32">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"128">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3087 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3088 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3089 = cute.crd2idx(%coord_3087, %lay_3088) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"16">
        %iter_3090 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3091 = cute.add_offset(%iter_3090, %idx_3089) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3092 = cute.make_view(%ptr_3091) : !memref_rmem_bf16_15
        %iter_3093 = cute.get_iter(%view_3092) : !memref_rmem_bf16_15
        %coord_3094 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3095 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3096 = cute.crd2idx(%coord_3094, %lay_3095) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"64">
        %iter_3097 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3098 = cute.add_offset(%iter_3097, %idx_3096) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3099 = cute.make_view(%ptr_3098) : !memref_rmem_bf16_16
        %iter_3100 = cute.get_iter(%view_3099) : !memref_rmem_bf16_16
        %lay_3101 = cute.get_layout(%view_3092) : !memref_rmem_bf16_15
        %1635 = cute.get_shape(%lay_3101) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3102, %e1_3103, %e2_3104, %e3_3105 = cute.get_leaves(%1635) : !cute.shape<"((2,2,2),1)">
        %lay_3106 = cute.get_layout(%view_3099) : !memref_rmem_bf16_16
        %1636 = cute.get_shape(%lay_3106) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3107, %e1_3108, %e2_3109, %e3_3110 = cute.get_leaves(%1636) : !cute.shape<"((2,2),(2,4))">
        %iter_3111 = cute.get_iter(%view_3092) : !memref_rmem_bf16_15
        %iter_3112 = cute.get_iter(%view_3099) : !memref_rmem_bf16_16
        %iter_3113 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3114 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3115 = cute.get_layout(%view_3092) : !memref_rmem_bf16_15
        %lay_3116 = cute.get_layout(%view_3099) : !memref_rmem_bf16_16
        %lay_3117 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3118 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1637 = cute.static : !cute.layout<"1:0">
        %append_3119 = cute.append_to_rank<3> (%lay_3115, %1637) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3120 = cute.append_to_rank<3> (%lay_3116, %1637) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3121 = cute.size(%append_3119) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3122 = cute.size(%append_3119) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3123 = cute.size(%append_3120) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1638 = cute.get_scalars(%sz_3121) : !cute.int_tuple<"1">
        %1639 = cute.get_scalars(%sz_3122) : !cute.int_tuple<"1">
        %1640 = cute.get_scalars(%sz_3123) : !cute.int_tuple<"8">
        %c0_i32_3124 = arith.constant 0 : i32
        %c1_i32_3125 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3124 to %1638 step %c1_i32_3125  : i32 {
          scf.for %arg9 = %c0_i32_3124 to %1639 step %c1_i32_3125  : i32 {
            scf.for %arg10 = %c0_i32_3124 to %1640 step %c1_i32_3125  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3119) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3111, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3120) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3112, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3117) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3113, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3118) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3114, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3126 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3127 = cute.size(%int_tuple_3126) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3128 = cute.get_leaves(%sz_3127) : !cute.int_tuple<"8">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"48">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"192">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3129 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3130 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3131 = cute.crd2idx(%coord_3129, %lay_3130) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"32">
        %iter_3132 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3133 = cute.add_offset(%iter_3132, %idx_3131) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3134 = cute.make_view(%ptr_3133) : !memref_rmem_bf16_15
        %iter_3135 = cute.get_iter(%view_3134) : !memref_rmem_bf16_15
        %coord_3136 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3137 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3138 = cute.crd2idx(%coord_3136, %lay_3137) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"128">
        %iter_3139 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3140 = cute.add_offset(%iter_3139, %idx_3138) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3141 = cute.make_view(%ptr_3140) : !memref_rmem_bf16_16
        %iter_3142 = cute.get_iter(%view_3141) : !memref_rmem_bf16_16
        %lay_3143 = cute.get_layout(%view_3134) : !memref_rmem_bf16_15
        %1641 = cute.get_shape(%lay_3143) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3144, %e1_3145, %e2_3146, %e3_3147 = cute.get_leaves(%1641) : !cute.shape<"((2,2,2),1)">
        %lay_3148 = cute.get_layout(%view_3141) : !memref_rmem_bf16_16
        %1642 = cute.get_shape(%lay_3148) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3149, %e1_3150, %e2_3151, %e3_3152 = cute.get_leaves(%1642) : !cute.shape<"((2,2),(2,4))">
        %iter_3153 = cute.get_iter(%view_3134) : !memref_rmem_bf16_15
        %iter_3154 = cute.get_iter(%view_3141) : !memref_rmem_bf16_16
        %iter_3155 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3156 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3157 = cute.get_layout(%view_3134) : !memref_rmem_bf16_15
        %lay_3158 = cute.get_layout(%view_3141) : !memref_rmem_bf16_16
        %lay_3159 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3160 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1643 = cute.static : !cute.layout<"1:0">
        %append_3161 = cute.append_to_rank<3> (%lay_3157, %1643) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3162 = cute.append_to_rank<3> (%lay_3158, %1643) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3163 = cute.size(%append_3161) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3164 = cute.size(%append_3161) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3165 = cute.size(%append_3162) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1644 = cute.get_scalars(%sz_3163) : !cute.int_tuple<"1">
        %1645 = cute.get_scalars(%sz_3164) : !cute.int_tuple<"1">
        %1646 = cute.get_scalars(%sz_3165) : !cute.int_tuple<"8">
        %c0_i32_3166 = arith.constant 0 : i32
        %c1_i32_3167 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3166 to %1644 step %c1_i32_3167  : i32 {
          scf.for %arg9 = %c0_i32_3166 to %1645 step %c1_i32_3167  : i32 {
            scf.for %arg10 = %c0_i32_3166 to %1646 step %c1_i32_3167  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3161) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3153, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3162) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3154, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3159) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3155, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3160) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3156, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3168 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3169 = cute.size(%int_tuple_3168) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3170 = cute.get_leaves(%sz_3169) : !cute.int_tuple<"8">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"8">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,4)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"16">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3171 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3172 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3173 = cute.crd2idx(%coord_3171, %lay_3172) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"48">
        %iter_3174 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3175 = cute.add_offset(%iter_3174, %idx_3173) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3176 = cute.make_view(%ptr_3175) : !memref_rmem_bf16_15
        %iter_3177 = cute.get_iter(%view_3176) : !memref_rmem_bf16_15
        %coord_3178 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3179 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3180 = cute.crd2idx(%coord_3178, %lay_3179) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"192">
        %iter_3181 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3182 = cute.add_offset(%iter_3181, %idx_3180) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3183 = cute.make_view(%ptr_3182) : !memref_rmem_bf16_16
        %iter_3184 = cute.get_iter(%view_3183) : !memref_rmem_bf16_16
        %lay_3185 = cute.get_layout(%view_3176) : !memref_rmem_bf16_15
        %1647 = cute.get_shape(%lay_3185) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3186, %e1_3187, %e2_3188, %e3_3189 = cute.get_leaves(%1647) : !cute.shape<"((2,2,2),1)">
        %lay_3190 = cute.get_layout(%view_3183) : !memref_rmem_bf16_16
        %1648 = cute.get_shape(%lay_3190) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3191, %e1_3192, %e2_3193, %e3_3194 = cute.get_leaves(%1648) : !cute.shape<"((2,2),(2,4))">
        %iter_3195 = cute.get_iter(%view_3176) : !memref_rmem_bf16_15
        %iter_3196 = cute.get_iter(%view_3183) : !memref_rmem_bf16_16
        %iter_3197 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3198 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3199 = cute.get_layout(%view_3176) : !memref_rmem_bf16_15
        %lay_3200 = cute.get_layout(%view_3183) : !memref_rmem_bf16_16
        %lay_3201 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3202 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1649 = cute.static : !cute.layout<"1:0">
        %append_3203 = cute.append_to_rank<3> (%lay_3199, %1649) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3204 = cute.append_to_rank<3> (%lay_3200, %1649) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3205 = cute.size(%append_3203) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3206 = cute.size(%append_3203) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3207 = cute.size(%append_3204) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1650 = cute.get_scalars(%sz_3205) : !cute.int_tuple<"1">
        %1651 = cute.get_scalars(%sz_3206) : !cute.int_tuple<"1">
        %1652 = cute.get_scalars(%sz_3207) : !cute.int_tuple<"8">
        %c0_i32_3208 = arith.constant 0 : i32
        %c1_i32_3209 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3208 to %1650 step %c1_i32_3209  : i32 {
          scf.for %arg9 = %c0_i32_3208 to %1651 step %c1_i32_3209  : i32 {
            scf.for %arg10 = %c0_i32_3208 to %1652 step %c1_i32_3209  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3203) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3195, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3204) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3196, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3201) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3197, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3202) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3198, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3210 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3211 = cute.size(%int_tuple_3210) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3212 = cute.get_leaves(%sz_3211) : !cute.int_tuple<"8">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"24">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,5)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"80">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3213 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_3214 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3215 = cute.crd2idx(%coord_3213, %lay_3214) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"8">
        %iter_3216 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3217 = cute.add_offset(%iter_3216, %idx_3215) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3218 = cute.make_view(%ptr_3217) : !memref_rmem_bf16_15
        %iter_3219 = cute.get_iter(%view_3218) : !memref_rmem_bf16_15
        %coord_3220 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_3221 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3222 = cute.crd2idx(%coord_3220, %lay_3221) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"16">
        %iter_3223 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3224 = cute.add_offset(%iter_3223, %idx_3222) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3225 = cute.make_view(%ptr_3224) : !memref_rmem_bf16_16
        %iter_3226 = cute.get_iter(%view_3225) : !memref_rmem_bf16_16
        %lay_3227 = cute.get_layout(%view_3218) : !memref_rmem_bf16_15
        %1653 = cute.get_shape(%lay_3227) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3228, %e1_3229, %e2_3230, %e3_3231 = cute.get_leaves(%1653) : !cute.shape<"((2,2,2),1)">
        %lay_3232 = cute.get_layout(%view_3225) : !memref_rmem_bf16_16
        %1654 = cute.get_shape(%lay_3232) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3233, %e1_3234, %e2_3235, %e3_3236 = cute.get_leaves(%1654) : !cute.shape<"((2,2),(2,4))">
        %iter_3237 = cute.get_iter(%view_3218) : !memref_rmem_bf16_15
        %iter_3238 = cute.get_iter(%view_3225) : !memref_rmem_bf16_16
        %iter_3239 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3240 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3241 = cute.get_layout(%view_3218) : !memref_rmem_bf16_15
        %lay_3242 = cute.get_layout(%view_3225) : !memref_rmem_bf16_16
        %lay_3243 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3244 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1655 = cute.static : !cute.layout<"1:0">
        %append_3245 = cute.append_to_rank<3> (%lay_3241, %1655) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3246 = cute.append_to_rank<3> (%lay_3242, %1655) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3247 = cute.size(%append_3245) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3248 = cute.size(%append_3245) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3249 = cute.size(%append_3246) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1656 = cute.get_scalars(%sz_3247) : !cute.int_tuple<"1">
        %1657 = cute.get_scalars(%sz_3248) : !cute.int_tuple<"1">
        %1658 = cute.get_scalars(%sz_3249) : !cute.int_tuple<"8">
        %c0_i32_3250 = arith.constant 0 : i32
        %c1_i32_3251 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3250 to %1656 step %c1_i32_3251  : i32 {
          scf.for %arg9 = %c0_i32_3250 to %1657 step %c1_i32_3251  : i32 {
            scf.for %arg10 = %c0_i32_3250 to %1658 step %c1_i32_3251  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3245) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3237, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3246) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3238, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3243) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3239, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3244) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3240, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3253 = cute.size(%int_tuple_3252) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3254 = cute.get_leaves(%sz_3253) : !cute.int_tuple<"8">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"40">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,6)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"144">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3255 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_3256 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3257 = cute.crd2idx(%coord_3255, %lay_3256) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"24">
        %iter_3258 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3259 = cute.add_offset(%iter_3258, %idx_3257) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3260 = cute.make_view(%ptr_3259) : !memref_rmem_bf16_15
        %iter_3261 = cute.get_iter(%view_3260) : !memref_rmem_bf16_15
        %coord_3262 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_3263 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3264 = cute.crd2idx(%coord_3262, %lay_3263) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"80">
        %iter_3265 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3266 = cute.add_offset(%iter_3265, %idx_3264) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3267 = cute.make_view(%ptr_3266) : !memref_rmem_bf16_16
        %iter_3268 = cute.get_iter(%view_3267) : !memref_rmem_bf16_16
        %lay_3269 = cute.get_layout(%view_3260) : !memref_rmem_bf16_15
        %1659 = cute.get_shape(%lay_3269) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3270, %e1_3271, %e2_3272, %e3_3273 = cute.get_leaves(%1659) : !cute.shape<"((2,2,2),1)">
        %lay_3274 = cute.get_layout(%view_3267) : !memref_rmem_bf16_16
        %1660 = cute.get_shape(%lay_3274) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3275, %e1_3276, %e2_3277, %e3_3278 = cute.get_leaves(%1660) : !cute.shape<"((2,2),(2,4))">
        %iter_3279 = cute.get_iter(%view_3260) : !memref_rmem_bf16_15
        %iter_3280 = cute.get_iter(%view_3267) : !memref_rmem_bf16_16
        %iter_3281 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3282 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3283 = cute.get_layout(%view_3260) : !memref_rmem_bf16_15
        %lay_3284 = cute.get_layout(%view_3267) : !memref_rmem_bf16_16
        %lay_3285 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3286 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1661 = cute.static : !cute.layout<"1:0">
        %append_3287 = cute.append_to_rank<3> (%lay_3283, %1661) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3288 = cute.append_to_rank<3> (%lay_3284, %1661) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3289 = cute.size(%append_3287) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3290 = cute.size(%append_3287) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3291 = cute.size(%append_3288) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1662 = cute.get_scalars(%sz_3289) : !cute.int_tuple<"1">
        %1663 = cute.get_scalars(%sz_3290) : !cute.int_tuple<"1">
        %1664 = cute.get_scalars(%sz_3291) : !cute.int_tuple<"8">
        %c0_i32_3292 = arith.constant 0 : i32
        %c1_i32_3293 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3292 to %1662 step %c1_i32_3293  : i32 {
          scf.for %arg9 = %c0_i32_3292 to %1663 step %c1_i32_3293  : i32 {
            scf.for %arg10 = %c0_i32_3292 to %1664 step %c1_i32_3293  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3287) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3279, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3288) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3280, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3285) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3281, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3286) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3282, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3294 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3295 = cute.size(%int_tuple_3294) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3296 = cute.get_leaves(%sz_3295) : !cute.int_tuple<"8">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"56">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,7)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"208">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3297 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_3298 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3299 = cute.crd2idx(%coord_3297, %lay_3298) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"40">
        %iter_3300 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3301 = cute.add_offset(%iter_3300, %idx_3299) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"40">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3302 = cute.make_view(%ptr_3301) : !memref_rmem_bf16_15
        %iter_3303 = cute.get_iter(%view_3302) : !memref_rmem_bf16_15
        %coord_3304 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_3305 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3306 = cute.crd2idx(%coord_3304, %lay_3305) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"144">
        %iter_3307 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3308 = cute.add_offset(%iter_3307, %idx_3306) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"144">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3309 = cute.make_view(%ptr_3308) : !memref_rmem_bf16_16
        %iter_3310 = cute.get_iter(%view_3309) : !memref_rmem_bf16_16
        %lay_3311 = cute.get_layout(%view_3302) : !memref_rmem_bf16_15
        %1665 = cute.get_shape(%lay_3311) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3312, %e1_3313, %e2_3314, %e3_3315 = cute.get_leaves(%1665) : !cute.shape<"((2,2,2),1)">
        %lay_3316 = cute.get_layout(%view_3309) : !memref_rmem_bf16_16
        %1666 = cute.get_shape(%lay_3316) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3317, %e1_3318, %e2_3319, %e3_3320 = cute.get_leaves(%1666) : !cute.shape<"((2,2),(2,4))">
        %iter_3321 = cute.get_iter(%view_3302) : !memref_rmem_bf16_15
        %iter_3322 = cute.get_iter(%view_3309) : !memref_rmem_bf16_16
        %iter_3323 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3324 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3325 = cute.get_layout(%view_3302) : !memref_rmem_bf16_15
        %lay_3326 = cute.get_layout(%view_3309) : !memref_rmem_bf16_16
        %lay_3327 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3328 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1667 = cute.static : !cute.layout<"1:0">
        %append_3329 = cute.append_to_rank<3> (%lay_3325, %1667) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3330 = cute.append_to_rank<3> (%lay_3326, %1667) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3331 = cute.size(%append_3329) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3332 = cute.size(%append_3329) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3333 = cute.size(%append_3330) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1668 = cute.get_scalars(%sz_3331) : !cute.int_tuple<"1">
        %1669 = cute.get_scalars(%sz_3332) : !cute.int_tuple<"1">
        %1670 = cute.get_scalars(%sz_3333) : !cute.int_tuple<"8">
        %c0_i32_3334 = arith.constant 0 : i32
        %c1_i32_3335 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3334 to %1668 step %c1_i32_3335  : i32 {
          scf.for %arg9 = %c0_i32_3334 to %1669 step %c1_i32_3335  : i32 {
            scf.for %arg10 = %c0_i32_3334 to %1670 step %c1_i32_3335  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3329) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3321, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3330) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3322, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3327) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3323, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3328) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3324, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3336 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_3337 = cute.size(%int_tuple_3336) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_3338 = cute.get_leaves(%sz_3337) : !cute.int_tuple<"8">
        %false = arith.constant false
        scf.if %false {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3955 = cute.get_layout(%view_875) : !memref_smem_bf16_8
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,((2,2),2)):((1,0),0,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_3957 = cute.get_iter(%view_875) : !memref_smem_bf16_8
          %ptr_3958 = cute.add_offset(%iter_3957, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3959 = cute.make_view(%ptr_3958) : !memref_smem_bf16_15
          %iter_3960 = cute.get_iter(%view_3959) : !memref_smem_bf16_15
          %coord_3961 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_3962 = cute.get_layout(%view_878) : !memref_rmem_bf16_3
          %idx_3963 = cute.crd2idx(%coord_3961, %lay_3962) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),1,(4,2)):((1,0),0,(16,8))">) -> !cute.int_tuple<"16">
          %iter_3964 = cute.get_iter(%view_878) : !memref_rmem_bf16_3
          %ptr_3965 = cute.add_offset(%iter_3964, %idx_3963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_3966 = cute.make_view(%ptr_3965) : !memref_rmem_bf16_10
          %iter_3967 = cute.get_iter(%view_3966) : !memref_rmem_bf16_10
          %lay_3968 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %1817 = cute.get_shape(%lay_3968) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3969, %e1_3970, %e2_3971 = cute.get_leaves(%1817) : !cute.shape<"((8,1),1)">
          %lay_3972 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %1818 = cute.get_shape(%lay_3972) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3973, %e1_3974, %e2_3975 = cute.get_leaves(%1818) : !cute.shape<"((8,1),1)">
          %lay_3976 = cute.get_layout(%view_3959) : !memref_smem_bf16_15
          %shape_3977 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3978 = cute.make_layout() : !cute.layout<"1:0">
          %append_3979 = cute.append_to_rank<2> (%lay_3976, %lay_3978) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3980 = cute.make_view(%iter_3960, %append_3979) : !memref_smem_bf16_15
          %iter_3981 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %lay_3982 = cute.get_layout(%view_3980) : !memref_smem_bf16_15
          %1819 = cute.get_shape(%lay_3982) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1819) : !cute.shape<"((8,1),1)">
          %iter_3986 = cute.get_iter(%view_3980) : !memref_smem_bf16_15
          %view_3987 = cute.make_view(%iter_3986) : !memref_smem_bf16_16
          %iter_3988 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_3989 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %lay_3990 = cute.get_layout(%view_3966) : !memref_rmem_bf16_10
          %shape_3991 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3992 = cute.make_layout() : !cute.layout<"1:0">
          %append_3993 = cute.append_to_rank<2> (%lay_3990, %lay_3992) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
          %view_3994 = cute.make_view(%iter_3967, %append_3993) : !memref_rmem_bf16_10
          %iter_3995 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %lay_3996 = cute.get_layout(%view_3994) : !memref_rmem_bf16_10
          %1820 = cute.get_shape(%lay_3996) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
          %e0_3997, %e1_3998, %e2_3999 = cute.get_leaves(%1820) : !cute.shape<"((8,1),1)">
          %iter_4000 = cute.get_iter(%view_3994) : !memref_rmem_bf16_10
          %view_4001 = cute.make_view(%iter_4000) : !memref_rmem_bf16_11
          %iter_4002 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %iter_4003 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4004 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %1821 = cute.get_shape(%lay_4004) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4005, %e1_4006, %e2_4007 = cute.get_leaves(%1821) : !cute.shape<"((8,1),(1))">
          %lay_4008 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %1822 = cute.get_shape(%lay_4008) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
          %e0_4009, %e1_4010, %e2_4011 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(1))">
          %lay_4012 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %sz_4013 = cute.size(%lay_4012) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4014 = cute.get_leaves(%sz_4013) : !cute.int_tuple<"1">
          %lay_4015 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %sz_4016 = cute.size(%lay_4015) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
          %e0_4017 = cute.get_leaves(%sz_4016) : !cute.int_tuple<"1">
          %1823 = cute.static : !cute.layout<"1:0">
          %iter_4018 = cute.get_iter(%view_3987) : !memref_smem_bf16_16
          %iter_4019 = cute.get_iter(%view_4001) : !memref_rmem_bf16_11
          %lay_4020 = cute.get_layout(%view_3987) : !memref_smem_bf16_16
          %lay_4021 = cute.get_layout(%view_4001) : !memref_rmem_bf16_11
          %append_4022 = cute.append_to_rank<2> (%lay_4020, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %append_4023 = cute.append_to_rank<2> (%lay_4021, %1823) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
          %lay_4024 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %lay_4025 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
          %sz_4026 = cute.size(%lay_4024) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
          %1824 = cute.get_scalars(%sz_4026) : !cute.int_tuple<"1">
          %c0_i32_4027 = arith.constant 0 : i32
          %c1_i32_4028 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4027 to %1824 step %c1_i32_4028  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4110 = cute.add_offset(%iter_4018, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
            %ptr_4114 = cute.add_offset(%iter_4019, %idx_4113) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_9
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_9
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_4030 = cute.get_layout(%view_932) : !memref_smem_bf16_9
          %idx_4031 = cute.crd2idx(%coord_4029, %lay_4030) : (!cute.coord<"(_,_,8)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"8192">
          %iter_4032 = cute.get_iter(%view_932) : !memref_smem_bf16_9
          %ptr_4033 = cute.add_offset(%iter_4032, %idx_4031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
          %view_4034 = cute.make_view(%ptr_4033) : !memref_smem_bf16_19
          %iter_4035 = cute.get_iter(%view_4034) : !memref_smem_bf16_19
          %coord_4036 = cute.make_coord() : () -> !cute.coord<"(_,_,8)">
          %lay_4037 = cute.get_layout(%view_935) : !memref_rmem_bf16_4
          %idx_4038 = cute.crd2idx(%coord_4036, %lay_4037) : (!cute.coord<"(_,_,8)">, !cute.layout<"(((4,2),1),4,(4,2)):(((1,32),0),4,(64,16))">) -> !cute.int_tuple<"32">
          %iter_4039 = cute.get_iter(%view_935) : !memref_rmem_bf16_4
          %ptr_4040 = cute.add_offset(%iter_4039, %idx_4038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_4041 = cute.make_view(%ptr_4040) : !memref_rmem_bf16_12
          %iter_4042 = cute.get_iter(%view_4041) : !memref_rmem_bf16_12
          %lay_4043 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %1825 = cute.get_shape(%lay_4043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4044, %e1_4045, %e2_4046 = cute.get_leaves(%1825) : !cute.shape<"((8,1),4)">
          %lay_4047 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %1826 = cute.get_shape(%lay_4047) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1826) : !cute.shape<"(((4,2),1),4)">
          %lay_4052 = cute.get_layout(%view_4034) : !memref_smem_bf16_19
          %shape_4053 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4054 = cute.make_layout() : !cute.layout<"1:0">
          %append_4055 = cute.append_to_rank<2> (%lay_4052, %lay_4054) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
          %view_4056 = cute.make_view(%iter_4035, %append_4055) : !memref_smem_bf16_19
          %iter_4057 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %lay_4058 = cute.get_layout(%view_4056) : !memref_smem_bf16_19
          %1827 = cute.get_shape(%lay_4058) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
          %e0_4059, %e1_4060, %e2_4061 = cute.get_leaves(%1827) : !cute.shape<"((8,1),4)">
          %iter_4062 = cute.get_iter(%view_4056) : !memref_smem_bf16_19
          %view_4063 = cute.make_view(%iter_4062) : !memref_smem_bf16_20
          %iter_4064 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4065 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %lay_4066 = cute.get_layout(%view_4041) : !memref_rmem_bf16_12
          %shape_4067 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4068 = cute.make_layout() : !cute.layout<"1:0">
          %append_4069 = cute.append_to_rank<2> (%lay_4066, %lay_4068) : !cute.layout<"(((4,2),1),4):(((1,32),0),4)">, !cute.layout<"1:0">
          %view_4070 = cute.make_view(%iter_4042, %append_4069) : !memref_rmem_bf16_12
          %iter_4071 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %lay_4072 = cute.get_layout(%view_4070) : !memref_rmem_bf16_12
          %1828 = cute.get_shape(%lay_4072) : (!cute.layout<"(((4,2),1),4):(((1,32),0),4)">) -> !cute.shape<"(((4,2),1),4)">
          %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%1828) : !cute.shape<"(((4,2),1),4)">
          %iter_4077 = cute.get_iter(%view_4070) : !memref_rmem_bf16_12
          %view_4078 = cute.make_view(%iter_4077) : !memref_rmem_bf16_13
          %iter_4079 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %iter_4080 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4081 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %1829 = cute.get_shape(%lay_4081) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
          %e0_4082, %e1_4083, %e2_4084 = cute.get_leaves(%1829) : !cute.shape<"((8,1),(4))">
          %lay_4085 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %1830 = cute.get_shape(%lay_4085) : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.shape<"(((4,2),1),(4))">
          %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1830) : !cute.shape<"(((4,2),1),(4))">
          %lay_4090 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %sz_4091 = cute.size(%lay_4090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
          %e0_4092 = cute.get_leaves(%sz_4091) : !cute.int_tuple<"4">
          %lay_4093 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %sz_4094 = cute.size(%lay_4093) <{mode = [1]}> : (!cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">) -> !cute.int_tuple<"4">
          %e0_4095 = cute.get_leaves(%sz_4094) : !cute.int_tuple<"4">
          %1831 = cute.static : !cute.layout<"1:0">
          %iter_4096 = cute.get_iter(%view_4063) : !memref_smem_bf16_20
          %iter_4097 = cute.get_iter(%view_4078) : !memref_rmem_bf16_13
          %lay_4098 = cute.get_layout(%view_4063) : !memref_smem_bf16_20
          %lay_4099 = cute.get_layout(%view_4078) : !memref_rmem_bf16_13
          %append_4100 = cute.append_to_rank<2> (%lay_4098, %1831) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
          %append_4101 = cute.append_to_rank<2> (%lay_4099, %1831) : !cute.layout<"(((4,2),1),(4)):(((1,32),0),(4))">, !cute.layout<"1:0">
          %lay_4102 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
          %lay_4103 = cute.make_layout() : !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">
          %sz_4104 = cute.size(%lay_4102) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
          %1832 = cute.get_scalars(%sz_4104) : !cute.int_tuple<"4">
          %c0_i32_4105 = arith.constant 0 : i32
          %c1_i32_4106 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4105 to %1832 step %c1_i32_4106  : i32 {
            %coord_4107 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1833 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4108 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4109 = cute.crd2idx(%coord_4107, %lay_4102) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4110 = cute.add_offset(%iter_4096, %idx_4109) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4111 = cute.make_view(%ptr_4110, %lay_4108) : !memref_smem_bf16_14
            %1834 = cute.get_scalars(%coord_4107) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4112 = cute.make_layout() : !cute.layout<"(((4,2),1)):(((1,32),0))">
            %idx_4113 = cute.crd2idx(%coord_4107, %lay_4103) : (!cute.coord<"(_,?)">, !cute.layout<"(((4,2),1),((4))):(((1,32),0),((4)))">) -> !cute.int_tuple<"?{div=4}">
            %ptr_4114 = cute.add_offset(%iter_4097, %idx_4113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4115 = cute.make_view(%ptr_4114, %lay_4112) : !memref_rmem_bf16_14
            %iter_4116 = cute.get_iter(%view_4111) : !memref_smem_bf16_14
            %iter_4117 = cute.get_iter(%view_4115) : !memref_rmem_bf16_14
            %swizzled = cute.apply_swizzle(%iter_4116) : !cute.ptr<bf16, smem, align<16>>
            %1835 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
            %1836 = llvm.mlir.constant(0 : i32) : i32
            %1837 = vector.extractelement %1835[%1836 : i32] : vector<4xi32>
            %1838 = builtin.unrealized_conversion_cast %iter_4117 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1837, %1838 : i32, !llvm.ptr
            %1839 = llvm.mlir.constant(1 : i32) : i32
            %1840 = vector.extractelement %1835[%1839 : i32] : vector<4xi32>
            %int_tuple_4118 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4119 = cute.add_offset(%iter_4117, %int_tuple_4118) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1841 = builtin.unrealized_conversion_cast %ptr_4119 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1840, %1841 : i32, !llvm.ptr
            %1842 = llvm.mlir.constant(2 : i32) : i32
            %1843 = vector.extractelement %1835[%1842 : i32] : vector<4xi32>
            %int_tuple_4120 = cute.make_int_tuple() : () -> !cute.int_tuple<"32">
            %ptr_4121 = cute.add_offset(%iter_4117, %int_tuple_4120) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
            %1844 = builtin.unrealized_conversion_cast %ptr_4121 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1843, %1844 : i32, !llvm.ptr
            %1845 = llvm.mlir.constant(3 : i32) : i32
            %1846 = vector.extractelement %1835[%1845 : i32] : vector<4xi32>
            %int_tuple_4122 = cute.make_int_tuple() : () -> !cute.int_tuple<"34">
            %ptr_4123 = cute.add_offset(%iter_4117, %int_tuple_4122) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"34">) -> !cute.ptr<bf16, rmem, align<4>>
            %1847 = builtin.unrealized_conversion_cast %ptr_4123 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1846, %1847 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3339 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_3340 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_3341 = cute.crd2idx(%coord_3339, %lay_3340) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),1,((2,2),2)):((1,2,4),0,((16,32),8))">) -> !cute.int_tuple<"56">
        %iter_3342 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_3343 = cute.add_offset(%iter_3342, %idx_3341) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"56">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3344 = cute.make_view(%ptr_3343) : !memref_rmem_bf16_15
        %iter_3345 = cute.get_iter(%view_3344) : !memref_rmem_bf16_15
        %coord_3346 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_3347 = cute.get_layout(%rmem_730) : !memref_rmem_bf16_1
        %idx_3348 = cute.crd2idx(%coord_3346, %lay_3347) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),(2,4),((2,2),2)):((1,2),(32,4),((64,128),16))">) -> !cute.int_tuple<"208">
        %iter_3349 = cute.get_iter(%rmem_730) : !memref_rmem_bf16_1
        %ptr_3350 = cute.add_offset(%iter_3349, %idx_3348) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"208">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3351 = cute.make_view(%ptr_3350) : !memref_rmem_bf16_16
        %iter_3352 = cute.get_iter(%view_3351) : !memref_rmem_bf16_16
        %lay_3353 = cute.get_layout(%view_3344) : !memref_rmem_bf16_15
        %1671 = cute.get_shape(%lay_3353) : (!cute.layout<"((2,2,2),1):((1,2,4),0)">) -> !cute.shape<"((2,2,2),1)">
        %e0_3354, %e1_3355, %e2_3356, %e3_3357 = cute.get_leaves(%1671) : !cute.shape<"((2,2,2),1)">
        %lay_3358 = cute.get_layout(%view_3351) : !memref_rmem_bf16_16
        %1672 = cute.get_shape(%lay_3358) : (!cute.layout<"((2,2),(2,4)):((1,2),(32,4))">) -> !cute.shape<"((2,2),(2,4))">
        %e0_3359, %e1_3360, %e2_3361, %e3_3362 = cute.get_leaves(%1672) : !cute.shape<"((2,2),(2,4))">
        %iter_3363 = cute.get_iter(%view_3344) : !memref_rmem_bf16_15
        %iter_3364 = cute.get_iter(%view_3351) : !memref_rmem_bf16_16
        %iter_3365 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %iter_3366 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
        %lay_3367 = cute.get_layout(%view_3344) : !memref_rmem_bf16_15
        %lay_3368 = cute.get_layout(%view_3351) : !memref_rmem_bf16_16
        %lay_3369 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %lay_3370 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1673 = cute.static : !cute.layout<"1:0">
        %append_3371 = cute.append_to_rank<3> (%lay_3367, %1673) : !cute.layout<"((2,2,2),1):((1,2,4),0)">, !cute.layout<"1:0">
        %append_3372 = cute.append_to_rank<3> (%lay_3368, %1673) : !cute.layout<"((2,2),(2,4)):((1,2),(32,4))">, !cute.layout<"1:0">
        %sz_3373 = cute.size(%append_3371) <{mode = [2]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3374 = cute.size(%append_3371) <{mode = [1]}> : (!cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3375 = cute.size(%append_3372) <{mode = [1]}> : (!cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"8">
        %1674 = cute.get_scalars(%sz_3373) : !cute.int_tuple<"1">
        %1675 = cute.get_scalars(%sz_3374) : !cute.int_tuple<"1">
        %1676 = cute.get_scalars(%sz_3375) : !cute.int_tuple<"8">
        %c0_i32_3376 = arith.constant 0 : i32
        %c1_i32_3377 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3376 to %1674 step %c1_i32_3377  : i32 {
          scf.for %arg9 = %c0_i32_3376 to %1675 step %c1_i32_3377  : i32 {
            scf.for %arg10 = %c0_i32_3376 to %1676 step %c1_i32_3377  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3371) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),1,1):((1,2,4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3363, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_17
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3372) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(2,4),1):((1,2),(32,4),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3364, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3369) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3365, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3370) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3366, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_17
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_3378 = arith.constant 1 : i32
        %c128_i32_3379 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_3378 number_of_threads = %c128_i32_3379
        %c0_i32_3380 = arith.constant 0 : i32
        %1677 = arith.cmpi sgt, %1595, %c0_i32_3380 : i32
        scf.if %1677 {
          %int_tuple_3954 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sub_3955 = cute.tuple_sub(%sub_2735, %int_tuple_3954) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
          %1817 = cute.get_scalars(%sub_3955) : !cute.int_tuple<"?">
          %coord_3956 = cute.make_coord(%sub_3955) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,_,_,?)">
          %lay_3957 = cute.get_layout(%view_461) : !memref_gmem_bf16_6
          %1818:3 = cute.get_scalars(%lay_3957) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %1819 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_3958 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_3959 = cute.assume(%1818#1) : (i64) -> !cute.i64<divby 128>
          %stride_3960 = cute.make_stride(%iv_3959) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_3961 = cute.make_layout(%shape_3958, %stride_3960) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_3962 = cute.crd2idx(%coord_3956, %lay_3957) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_3963 = cute.get_iter(%view_461) : !memref_gmem_bf16_6
          %ptr_3964 = cute.add_offset(%iter_3963, %idx_3962) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_3965 = cute.make_view(%ptr_3964, %lay_3961) : !memref_gmem_bf16_5
          %iter_3966 = cute.get_iter(%view_3965) : !memref_gmem_bf16_5
          %coord_3967 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3968 = cute.get_layout(%view_506) : !memref_smem_bf16_3
          %idx_3969 = cute.crd2idx(%coord_3967, %lay_3968) : (!cute.coord<"(_,_,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_3970 = cute.get_iter(%view_506) : !memref_smem_bf16_3
          %ptr_3971 = cute.add_offset(%iter_3970, %idx_3969) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3972 = cute.make_view(%ptr_3971) : !memref_smem_bf16_3
          %iter_3973 = cute.get_iter(%view_3972) : !memref_smem_bf16_3
          %coord_3974 = cute.make_coord() : () -> !cute.coord<"(_,_,_)">
          %lay_3975 = cute.get_layout(%rmem_1268) : !memref_rmem_i8_
          %idx_3976 = cute.crd2idx(%coord_3974, %lay_3975) : (!cute.coord<"(_,_,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_3977 = cute.get_iter(%rmem_1268) : !memref_rmem_i8_
          %ptr_3978 = cute.add_offset(%iter_3977, %idx_3976) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_3979 = cute.make_view(%ptr_3978) : !memref_rmem_i8_
          %iter_3980 = cute.get_iter(%view_3979) : !memref_rmem_i8_
          %lay_3981 = cute.get_layout(%view_3965) : !memref_gmem_bf16_5
          %1820 = cute.get_shape(%lay_3981) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3982, %e1_3983, %e2_3984, %e3_3985 = cute.get_leaves(%1820) : !cute.shape<"((8,1),4,2)">
          %lay_3986 = cute.get_layout(%view_3972) : !memref_smem_bf16_3
          %1821 = cute.get_shape(%lay_3986) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3987, %e1_3988, %e2_3989, %e3_3990 = cute.get_leaves(%1821) : !cute.shape<"((8,1),4,2)">
          %lay_3991 = cute.get_layout(%view_3965) : !memref_gmem_bf16_5
          %shape_3992 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3993 = cute.make_layout() : !cute.layout<"1:0">
          %append_3994 = cute.append_to_rank<2> (%lay_3991, %lay_3993) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_3995 = cute.make_view(%iter_3966, %append_3994) : !memref_gmem_bf16_5
          %iter_3996 = cute.get_iter(%view_3995) : !memref_gmem_bf16_5
          %lay_3997 = cute.get_layout(%view_3995) : !memref_gmem_bf16_5
          %1822 = cute.get_shape(%lay_3997) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_3998, %e1_3999, %e2_4000, %e3_4001 = cute.get_leaves(%1822) : !cute.shape<"((8,1),4,2)">
          %iter_4002 = cute.get_iter(%view_3995) : !memref_gmem_bf16_5
          %lay_4003 = cute.get_layout(%view_3995) : !memref_gmem_bf16_5
          %1823 = cute.get_scalars(%lay_4003) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_4004 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_4005 = cute.assume(%1823) : (i64) -> !cute.i64<divby 128>
          %stride_4006 = cute.make_stride(%iv_4005) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_4007 = cute.make_layout(%shape_4004, %stride_4006) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_4008 = cute.make_view(%iter_4002, %lay_4007) : !memref_gmem_bf16_13
          %iter_4009 = cute.get_iter(%view_4008) : !memref_gmem_bf16_13
          %iter_4010 = cute.get_iter(%view_4008) : !memref_gmem_bf16_13
          %lay_4011 = cute.get_layout(%view_3972) : !memref_smem_bf16_3
          %shape_4012 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4013 = cute.make_layout() : !cute.layout<"1:0">
          %append_4014 = cute.append_to_rank<2> (%lay_4011, %lay_4013) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_4015 = cute.make_view(%iter_3973, %append_4014) : !memref_smem_bf16_3
          %iter_4016 = cute.get_iter(%view_4015) : !memref_smem_bf16_3
          %lay_4017 = cute.get_layout(%view_4015) : !memref_smem_bf16_3
          %1824 = cute.get_shape(%lay_4017) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_4018, %e1_4019, %e2_4020, %e3_4021 = cute.get_leaves(%1824) : !cute.shape<"((8,1),4,2)">
          %iter_4022 = cute.get_iter(%view_4015) : !memref_smem_bf16_3
          %view_4023 = cute.make_view(%iter_4022) : !memref_smem_bf16_17
          %iter_4024 = cute.get_iter(%view_4023) : !memref_smem_bf16_17
          %iter_4025 = cute.get_iter(%view_4023) : !memref_smem_bf16_17
          %lay_4026 = cute.get_layout(%view_3979) : !memref_rmem_i8_
          %shape_4027 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4028 = cute.make_layout() : !cute.layout<"1:0">
          %append_4029 = cute.append_to_rank<2> (%lay_4026, %lay_4028) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_4030 = cute.make_view(%iter_3980, %append_4029) : !memref_rmem_i8_
          %iter_4031 = cute.get_iter(%view_4030) : !memref_rmem_i8_
          %lay_4032 = cute.get_layout(%view_4030) : !memref_rmem_i8_
          %1825 = cute.get_shape(%lay_4032) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_4033, %e1_4034, %e2_4035 = cute.get_leaves(%1825) : !cute.shape<"(1,4,2)">
          %iter_4036 = cute.get_iter(%view_4030) : !memref_rmem_i8_
          %view_4037 = cute.make_view(%iter_4036) : !memref_rmem_i8_4
          %iter_4038 = cute.get_iter(%view_4037) : !memref_rmem_i8_4
          %iter_4039 = cute.get_iter(%view_4037) : !memref_rmem_i8_4
          %lay_4040 = cute.get_layout(%view_4008) : !memref_gmem_bf16_13
          %1826 = cute.get_shape(%lay_4040) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4041, %e1_4042, %e2_4043, %e3_4044 = cute.get_leaves(%1826) : !cute.shape<"((8,1),(4,2))">
          %lay_4045 = cute.get_layout(%view_4023) : !memref_smem_bf16_17
          %1827 = cute.get_shape(%lay_4045) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4046, %e1_4047, %e2_4048, %e3_4049 = cute.get_leaves(%1827) : !cute.shape<"((8,1),(4,2))">
          %lay_4050 = cute.get_layout(%view_4008) : !memref_gmem_bf16_13
          %sz_4051 = cute.size(%lay_4050) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_4052 = cute.get_leaves(%sz_4051) : !cute.int_tuple<"8">
          %lay_4053 = cute.get_layout(%view_4023) : !memref_smem_bf16_17
          %sz_4054 = cute.size(%lay_4053) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_4055 = cute.get_leaves(%sz_4054) : !cute.int_tuple<"8">
          %1828 = cute.static : !cute.layout<"1:0">
          %iter_4056 = cute.get_iter(%view_4008) : !memref_gmem_bf16_13
          %iter_4057 = cute.get_iter(%view_4023) : !memref_smem_bf16_17
          %lay_4058 = cute.get_layout(%view_4008) : !memref_gmem_bf16_13
          %lay_4059 = cute.get_layout(%view_4023) : !memref_smem_bf16_17
          %append_4060 = cute.append_to_rank<2> (%lay_4058, %1828) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_4061 = cute.append_to_rank<2> (%lay_4059, %1828) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %1829 = cute.get_scalars(%append_4060) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_4062 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_4063 = cute.assume(%1829) : (i64) -> !cute.i64<divby 128>
          %stride_4064 = cute.make_stride(%iv_4063) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_4065 = cute.make_layout(%shape_4062, %stride_4064) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_4066 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_4067 = cute.get_iter(%view_4037) : !memref_rmem_i8_4
          %lay_4068 = cute.get_layout(%view_4037) : !memref_rmem_i8_4
          %append_4069 = cute.append_to_rank<2> (%lay_4068, %1828) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_4070 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_4071 = cute.size(%lay_4065) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %1830 = cute.get_scalars(%sz_4071) : !cute.int_tuple<"8">
          %c0_i32_4072 = arith.constant 0 : i32
          %c1_i32_4073 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4072 to %1830 step %c1_i32_4073  : i32 {
            %coord_4216 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1917 = cute.get_scalars(%lay_4065) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %1918 = cute.get_scalars(%coord_4216) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4217 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4218 = cute.crd2idx(%coord_4216, %lay_4065) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_4219 = cute.add_offset(%iter_4056, %idx_4218) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4220 = cute.make_view(%ptr_4219, %lay_4217) : !memref_gmem_bf16_10
            %1919 = cute.get_scalars(%coord_4216) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4221 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4222 = cute.crd2idx(%coord_4216, %lay_4066) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_4223 = cute.add_offset(%iter_4057, %idx_4222) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4224 = cute.make_view(%ptr_4223, %lay_4221) : !memref_smem_bf16_14
            %1920 = cute.get_scalars(%coord_4216) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4225 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_4226 = cute.crd2idx(%coord_4216, %lay_4070) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_4227 = cute.add_offset(%iter_4067, %idx_4226) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_4228 = cute.make_view(%ptr_4227, %lay_4225) : !memref_rmem_i8_3
            %iter_4229 = cute.get_iter(%view_4220) : !memref_gmem_bf16_10
            %iter_4230 = cute.get_iter(%view_4224) : !memref_smem_bf16_14
            %iter_4231 = cute.get_iter(%view_4228) : !memref_rmem_i8_3
            %1921 = builtin.unrealized_conversion_cast %iter_4231 : !cute.ptr<i8, rmem> to !llvm.ptr
            %1922 = llvm.load %1921 : !llvm.ptr -> i8
            %1923 = llvm.trunc %1922 : i8 to i1
            %iter_4232 = cute.recast_iter(%iter_4229) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_4233 = cute.recast_iter(%iter_4230) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_4233 : !cute.ptr<i128, smem>, %iter_4232 : !cute.ptr<i128, gmem>, %1923 : i1) {cache_mode = <always>}
          } {llvm.loop_annotation = #loop_annotation}
          %lay_4074 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %1831 = cute.get_shape(%lay_4074) : (!cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.shape<"((8,1),4,1,?)">
          %e0_4075, %e1_4076, %e2_4077, %e3_4078, %e4_4079 = cute.get_leaves(%1831) : !cute.shape<"((8,1),4,1,?)">
          %itup_4080 = cute.to_int_tuple(%e4_4079) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1832 = cute.get_scalars(%itup_4080) : !cute.int_tuple<"?">
          %int_tuple_4081 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_4082 = cute.size(%int_tuple_4081) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_4083 = cute.get_leaves(%sz_4082) : !cute.int_tuple<"4">
          %coord_4084 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,0,0,?)">
          %lay_4085 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4086 = cute.crd2idx(%coord_4084, %lay_4085) : (!cute.coord<"(0,0,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,0,?{div=64})">
          %iter_4087 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4088 = cute.add_offset(%iter_4087, %idx_4086) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4089 = cute.make_view(%tup_4088) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4090 = cute.get_iter(%view_4089) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4091, %e1_4092, %e2_4093, %e3_4094 = cute.get_leaves(%iter_4090) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1833 = cute.get_scalars(%e0_4091) : !cute.int_tuple<"?">
          %1834 = cute.get_scalars(%e1_4092) : !cute.int_tuple<"?">
          %1835 = cute.get_scalars(%e2_4093) : !cute.int_tuple<"?">
          %1836 = cute.get_scalars(%e3_4094) : !cute.int_tuple<"?{div=8}">
          %iter_4095 = cute.get_iter(%view_4089) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4096, %e1_4097, %e2_4098, %e3_4099 = cute.get_leaves(%iter_4095) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1837 = cute.get_scalars(%e0_4096) : !cute.int_tuple<"?">
          %1838 = cute.get_scalars(%e1_4097) : !cute.int_tuple<"?">
          %1839 = cute.get_scalars(%e2_4098) : !cute.int_tuple<"?">
          %1840 = cute.get_scalars(%e3_4099) : !cute.int_tuple<"?{div=8}">
          %iter_4100 = cute.get_iter(%view_4089) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4101, %e1_4102, %e2_4103, %e3_4104 = cute.get_leaves(%iter_4100) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1841 = cute.get_scalars(%e0_4101) : !cute.int_tuple<"?">
          %1842 = cute.get_scalars(%e1_4102) : !cute.int_tuple<"?">
          %1843 = cute.get_scalars(%e2_4103) : !cute.int_tuple<"?">
          %1844 = cute.get_scalars(%e3_4104) : !cute.int_tuple<"?{div=8}">
          %lay_4105 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1845 = cute.get_shape(%lay_4105) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4106, %e1_4107, %e2_4108, %e3_4109 = cute.get_leaves(%1845) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4110 = cute.to_int_tuple(%e0_4106) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1846 = cute.get_scalars(%itup_4110) : !cute.int_tuple<"?">
          %itup_4111 = cute.to_int_tuple(%e1_4107) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1847 = cute.get_scalars(%itup_4111) : !cute.int_tuple<"?">
          %itup_4112 = cute.to_int_tuple(%e2_4108) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1848 = cute.get_scalars(%itup_4112) : !cute.int_tuple<"?">
          %itup_4113 = cute.to_int_tuple(%e3_4109) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1849 = cute.get_scalars(%itup_4113) : !cute.int_tuple<"?{div=8}">
          %coord_4114 = cute.make_coord(%e1_4102) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4115 = cute.make_coord(%itup_4112) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1850 = cute.get_scalars(%coord_4114) : !cute.coord<"?">
          %1851 = cute.get_scalars(%coord_4115) : !cute.coord<"?">
          %true_4116 = arith.constant true
          %1852 = arith.cmpi slt, %1850, %1851 : i32
          %1853 = arith.andi %true_4116, %1852 : i1
          scf.if %1853 {
            %int_tuple_4216 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4217 = cute.tuple_sub(%sub_2735, %int_tuple_4216) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1917 = cute.get_scalars(%sub_4217) : !cute.int_tuple<"?">
            %coord_4218 = cute.make_coord(%sub_4217) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,0,_,?)">
            %lay_4219 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
            %idx_4220 = cute.crd2idx(%coord_4218, %lay_4219) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{div=64}">
            %iter_4221 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
            %ptr_4222 = cute.add_offset(%iter_4221, %idx_4220) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4223 = cute.make_view(%ptr_4222) : !memref_gmem_bf16_11
            %iter_4224 = cute.get_iter(%view_4223) : !memref_gmem_bf16_11
            %coord_4225 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4226 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4227 = cute.crd2idx(%coord_4225, %lay_4226) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_4228 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4229 = cute.add_offset(%iter_4228, %idx_4227) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4230 = cute.make_view(%ptr_4229) : !memref_smem_bf16_15
            %iter_4231 = cute.get_iter(%view_4230) : !memref_smem_bf16_15
            %lay_4232 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %1918 = cute.get_shape(%lay_4232) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4233, %e1_4234, %e2_4235 = cute.get_leaves(%1918) : !cute.shape<"((8,1),1)">
            %lay_4236 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %1919 = cute.get_shape(%lay_4236) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4237, %e1_4238, %e2_4239 = cute.get_leaves(%1919) : !cute.shape<"((8,1),1)">
            %lay_4240 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %shape_4241 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4242 = cute.make_layout() : !cute.layout<"1:0">
            %append_4243 = cute.append_to_rank<2> (%lay_4240, %lay_4242) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4244 = cute.make_view(%iter_4224, %append_4243) : !memref_gmem_bf16_11
            %iter_4245 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %lay_4246 = cute.get_layout(%view_4244) : !memref_gmem_bf16_11
            %1920 = cute.get_shape(%lay_4246) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4247, %e1_4248, %e2_4249 = cute.get_leaves(%1920) : !cute.shape<"((8,1),1)">
            %iter_4250 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %view_4251 = cute.make_view(%iter_4250) : !memref_gmem_bf16_12
            %iter_4252 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4253 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %lay_4254 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %shape_4255 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4256 = cute.make_layout() : !cute.layout<"1:0">
            %append_4257 = cute.append_to_rank<2> (%lay_4254, %lay_4256) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4258 = cute.make_view(%iter_4231, %append_4257) : !memref_smem_bf16_15
            %iter_4259 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %lay_4260 = cute.get_layout(%view_4258) : !memref_smem_bf16_15
            %1921 = cute.get_shape(%lay_4260) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4261, %e1_4262, %e2_4263 = cute.get_leaves(%1921) : !cute.shape<"((8,1),1)">
            %iter_4264 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %view_4265 = cute.make_view(%iter_4264) : !memref_smem_bf16_16
            %iter_4266 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %iter_4267 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4268 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %1922 = cute.get_shape(%lay_4268) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4269, %e1_4270, %e2_4271 = cute.get_leaves(%1922) : !cute.shape<"((8,1),(1))">
            %lay_4272 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %1923 = cute.get_shape(%lay_4272) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4273, %e1_4274, %e2_4275 = cute.get_leaves(%1923) : !cute.shape<"((8,1),(1))">
            %lay_4276 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %sz_4277 = cute.size(%lay_4276) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4278 = cute.get_leaves(%sz_4277) : !cute.int_tuple<"1">
            %lay_4279 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %sz_4280 = cute.size(%lay_4279) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4281 = cute.get_leaves(%sz_4280) : !cute.int_tuple<"1">
            %1924 = cute.static : !cute.layout<"1:0">
            %iter_4282 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4283 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4284 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %lay_4285 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %append_4286 = cute.append_to_rank<2> (%lay_4284, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4287 = cute.append_to_rank<2> (%lay_4285, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4288 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4289 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4290 = cute.size(%lay_4288) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1925 = cute.get_scalars(%sz_4290) : !cute.int_tuple<"1">
            %c0_i32_4291 = arith.constant 0 : i32
            %c1_i32_4292 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4291 to %1925 step %c1_i32_4292  : i32 {
              %coord_4293 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1926 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4294 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4295 = cute.crd2idx(%coord_4293, %lay_4288) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4296 = cute.add_offset(%iter_4282, %idx_4295) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4297 = cute.make_view(%ptr_4296, %lay_4294) : !memref_gmem_bf16_10
              %1927 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4298 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4299 = cute.crd2idx(%coord_4293, %lay_4289) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4300 = cute.add_offset(%iter_4283, %idx_4299) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4301 = cute.make_view(%ptr_4300, %lay_4298) : !memref_smem_bf16_14
              %iter_4302 = cute.get_iter(%view_4297) : !memref_gmem_bf16_10
              %iter_4303 = cute.get_iter(%view_4301) : !memref_smem_bf16_14
              %iter_4304 = cute.recast_iter(%iter_4302) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4305 = cute.recast_iter(%iter_4303) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4305 : !cute.ptr<i128, smem>, %iter_4304 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4216 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_4217 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4218 = cute.crd2idx(%coord_4216, %lay_4217) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"0">
            %iter_4219 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4220 = cute.add_offset(%iter_4219, %idx_4218) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4221 = cute.make_view(%ptr_4220) : !memref_smem_bf16_15
            %iter_4222 = cute.get_iter(%view_4221) : !memref_smem_bf16_15
            %lay_4223 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %sz_4224 = cute.size(%lay_4223) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4225 = cute.get_leaves(%sz_4224) : !cute.int_tuple<"8">
            %lay_4226 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %1917 = cute.get_shape(%lay_4226) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4227, %e1_4228, %e2_4229 = cute.get_leaves(%1917) : !cute.shape<"((8,1),1)">
            %int_tuple_4230 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4231 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4232 = cute.get_leaves(%int_tuple_4231) : !cute.int_tuple<"8">
            %cst_4233 = arith.constant 0.000000e+00 : bf16
            %1918 = vector.splat %cst_4233 : vector<8xbf16>
            %int_tuple_4234 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4235 = cute.size(%int_tuple_4234) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4236 = cute.get_leaves(%sz_4235) : !cute.int_tuple<"8">
            %int_tuple_4237 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4238 = cute.size(%int_tuple_4237) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4239 = cute.get_leaves(%sz_4238) : !cute.int_tuple<"8">
            cute.memref.store_vec %1918, %view_4221, row_major : !memref_smem_bf16_15
          }
          %coord_4117 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,1,0,?)">
          %lay_4118 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4119 = cute.crd2idx(%coord_4117, %lay_4118) : (!cute.coord<"(0,1,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,16,?{div=64})">
          %iter_4120 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4121 = cute.add_offset(%iter_4120, %idx_4119) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,16,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4122 = cute.make_view(%tup_4121) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4123 = cute.get_iter(%view_4122) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4124, %e1_4125, %e2_4126, %e3_4127 = cute.get_leaves(%iter_4123) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1854 = cute.get_scalars(%e0_4124) : !cute.int_tuple<"?">
          %1855 = cute.get_scalars(%e1_4125) : !cute.int_tuple<"?">
          %1856 = cute.get_scalars(%e2_4126) : !cute.int_tuple<"?">
          %1857 = cute.get_scalars(%e3_4127) : !cute.int_tuple<"?{div=8}">
          %iter_4128 = cute.get_iter(%view_4122) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4129, %e1_4130, %e2_4131, %e3_4132 = cute.get_leaves(%iter_4128) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1858 = cute.get_scalars(%e0_4129) : !cute.int_tuple<"?">
          %1859 = cute.get_scalars(%e1_4130) : !cute.int_tuple<"?">
          %1860 = cute.get_scalars(%e2_4131) : !cute.int_tuple<"?">
          %1861 = cute.get_scalars(%e3_4132) : !cute.int_tuple<"?{div=8}">
          %iter_4133 = cute.get_iter(%view_4122) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4134, %e1_4135, %e2_4136, %e3_4137 = cute.get_leaves(%iter_4133) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1862 = cute.get_scalars(%e0_4134) : !cute.int_tuple<"?">
          %1863 = cute.get_scalars(%e1_4135) : !cute.int_tuple<"?">
          %1864 = cute.get_scalars(%e2_4136) : !cute.int_tuple<"?">
          %1865 = cute.get_scalars(%e3_4137) : !cute.int_tuple<"?{div=8}">
          %lay_4138 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1866 = cute.get_shape(%lay_4138) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4139, %e1_4140, %e2_4141, %e3_4142 = cute.get_leaves(%1866) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4143 = cute.to_int_tuple(%e0_4139) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1867 = cute.get_scalars(%itup_4143) : !cute.int_tuple<"?">
          %itup_4144 = cute.to_int_tuple(%e1_4140) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1868 = cute.get_scalars(%itup_4144) : !cute.int_tuple<"?">
          %itup_4145 = cute.to_int_tuple(%e2_4141) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1869 = cute.get_scalars(%itup_4145) : !cute.int_tuple<"?">
          %itup_4146 = cute.to_int_tuple(%e3_4142) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1870 = cute.get_scalars(%itup_4146) : !cute.int_tuple<"?{div=8}">
          %coord_4147 = cute.make_coord(%e1_4135) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4148 = cute.make_coord(%itup_4145) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1871 = cute.get_scalars(%coord_4147) : !cute.coord<"?">
          %1872 = cute.get_scalars(%coord_4148) : !cute.coord<"?">
          %true_4149 = arith.constant true
          %1873 = arith.cmpi slt, %1871, %1872 : i32
          %1874 = arith.andi %true_4149, %1873 : i1
          scf.if %1874 {
            %int_tuple_4216 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4217 = cute.tuple_sub(%sub_2735, %int_tuple_4216) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1917 = cute.get_scalars(%sub_4217) : !cute.int_tuple<"?">
            %coord_4218 = cute.make_coord(%sub_4217) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,1,_,?)">
            %lay_4219 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
            %idx_4220 = cute.crd2idx(%coord_4218, %lay_4219) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_4221 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
            %ptr_4222 = cute.add_offset(%iter_4221, %idx_4220) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4223 = cute.make_view(%ptr_4222) : !memref_gmem_bf16_11
            %iter_4224 = cute.get_iter(%view_4223) : !memref_gmem_bf16_11
            %coord_4225 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4226 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4227 = cute.crd2idx(%coord_4225, %lay_4226) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_4228 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4229 = cute.add_offset(%iter_4228, %idx_4227) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4230 = cute.make_view(%ptr_4229) : !memref_smem_bf16_15
            %iter_4231 = cute.get_iter(%view_4230) : !memref_smem_bf16_15
            %lay_4232 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %1918 = cute.get_shape(%lay_4232) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4233, %e1_4234, %e2_4235 = cute.get_leaves(%1918) : !cute.shape<"((8,1),1)">
            %lay_4236 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %1919 = cute.get_shape(%lay_4236) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4237, %e1_4238, %e2_4239 = cute.get_leaves(%1919) : !cute.shape<"((8,1),1)">
            %lay_4240 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %shape_4241 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4242 = cute.make_layout() : !cute.layout<"1:0">
            %append_4243 = cute.append_to_rank<2> (%lay_4240, %lay_4242) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4244 = cute.make_view(%iter_4224, %append_4243) : !memref_gmem_bf16_11
            %iter_4245 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %lay_4246 = cute.get_layout(%view_4244) : !memref_gmem_bf16_11
            %1920 = cute.get_shape(%lay_4246) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4247, %e1_4248, %e2_4249 = cute.get_leaves(%1920) : !cute.shape<"((8,1),1)">
            %iter_4250 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %view_4251 = cute.make_view(%iter_4250) : !memref_gmem_bf16_12
            %iter_4252 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4253 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %lay_4254 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %shape_4255 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4256 = cute.make_layout() : !cute.layout<"1:0">
            %append_4257 = cute.append_to_rank<2> (%lay_4254, %lay_4256) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4258 = cute.make_view(%iter_4231, %append_4257) : !memref_smem_bf16_15
            %iter_4259 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %lay_4260 = cute.get_layout(%view_4258) : !memref_smem_bf16_15
            %1921 = cute.get_shape(%lay_4260) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4261, %e1_4262, %e2_4263 = cute.get_leaves(%1921) : !cute.shape<"((8,1),1)">
            %iter_4264 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %view_4265 = cute.make_view(%iter_4264) : !memref_smem_bf16_16
            %iter_4266 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %iter_4267 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4268 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %1922 = cute.get_shape(%lay_4268) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4269, %e1_4270, %e2_4271 = cute.get_leaves(%1922) : !cute.shape<"((8,1),(1))">
            %lay_4272 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %1923 = cute.get_shape(%lay_4272) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4273, %e1_4274, %e2_4275 = cute.get_leaves(%1923) : !cute.shape<"((8,1),(1))">
            %lay_4276 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %sz_4277 = cute.size(%lay_4276) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4278 = cute.get_leaves(%sz_4277) : !cute.int_tuple<"1">
            %lay_4279 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %sz_4280 = cute.size(%lay_4279) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4281 = cute.get_leaves(%sz_4280) : !cute.int_tuple<"1">
            %1924 = cute.static : !cute.layout<"1:0">
            %iter_4282 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4283 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4284 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %lay_4285 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %append_4286 = cute.append_to_rank<2> (%lay_4284, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4287 = cute.append_to_rank<2> (%lay_4285, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4288 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4289 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4290 = cute.size(%lay_4288) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1925 = cute.get_scalars(%sz_4290) : !cute.int_tuple<"1">
            %c0_i32_4291 = arith.constant 0 : i32
            %c1_i32_4292 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4291 to %1925 step %c1_i32_4292  : i32 {
              %coord_4293 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1926 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4294 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4295 = cute.crd2idx(%coord_4293, %lay_4288) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4296 = cute.add_offset(%iter_4282, %idx_4295) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4297 = cute.make_view(%ptr_4296, %lay_4294) : !memref_gmem_bf16_10
              %1927 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4298 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4299 = cute.crd2idx(%coord_4293, %lay_4289) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4300 = cute.add_offset(%iter_4283, %idx_4299) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4301 = cute.make_view(%ptr_4300, %lay_4298) : !memref_smem_bf16_14
              %iter_4302 = cute.get_iter(%view_4297) : !memref_gmem_bf16_10
              %iter_4303 = cute.get_iter(%view_4301) : !memref_smem_bf16_14
              %iter_4304 = cute.recast_iter(%iter_4302) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4305 = cute.recast_iter(%iter_4303) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4305 : !cute.ptr<i128, smem>, %iter_4304 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4216 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_4217 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4218 = cute.crd2idx(%coord_4216, %lay_4217) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"1024">
            %iter_4219 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4220 = cute.add_offset(%iter_4219, %idx_4218) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4221 = cute.make_view(%ptr_4220) : !memref_smem_bf16_15
            %iter_4222 = cute.get_iter(%view_4221) : !memref_smem_bf16_15
            %lay_4223 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %sz_4224 = cute.size(%lay_4223) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4225 = cute.get_leaves(%sz_4224) : !cute.int_tuple<"8">
            %lay_4226 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %1917 = cute.get_shape(%lay_4226) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4227, %e1_4228, %e2_4229 = cute.get_leaves(%1917) : !cute.shape<"((8,1),1)">
            %int_tuple_4230 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4231 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4232 = cute.get_leaves(%int_tuple_4231) : !cute.int_tuple<"8">
            %cst_4233 = arith.constant 0.000000e+00 : bf16
            %1918 = vector.splat %cst_4233 : vector<8xbf16>
            %int_tuple_4234 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4235 = cute.size(%int_tuple_4234) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4236 = cute.get_leaves(%sz_4235) : !cute.int_tuple<"8">
            %int_tuple_4237 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4238 = cute.size(%int_tuple_4237) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4239 = cute.get_leaves(%sz_4238) : !cute.int_tuple<"8">
            cute.memref.store_vec %1918, %view_4221, row_major : !memref_smem_bf16_15
          }
          %coord_4150 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,2,0,?)">
          %lay_4151 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4152 = cute.crd2idx(%coord_4150, %lay_4151) : (!cute.coord<"(0,2,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,32,?{div=64})">
          %iter_4153 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4154 = cute.add_offset(%iter_4153, %idx_4152) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,32,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4155 = cute.make_view(%tup_4154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4156 = cute.get_iter(%view_4155) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4157, %e1_4158, %e2_4159, %e3_4160 = cute.get_leaves(%iter_4156) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1875 = cute.get_scalars(%e0_4157) : !cute.int_tuple<"?">
          %1876 = cute.get_scalars(%e1_4158) : !cute.int_tuple<"?">
          %1877 = cute.get_scalars(%e2_4159) : !cute.int_tuple<"?">
          %1878 = cute.get_scalars(%e3_4160) : !cute.int_tuple<"?{div=8}">
          %iter_4161 = cute.get_iter(%view_4155) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4162, %e1_4163, %e2_4164, %e3_4165 = cute.get_leaves(%iter_4161) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1879 = cute.get_scalars(%e0_4162) : !cute.int_tuple<"?">
          %1880 = cute.get_scalars(%e1_4163) : !cute.int_tuple<"?">
          %1881 = cute.get_scalars(%e2_4164) : !cute.int_tuple<"?">
          %1882 = cute.get_scalars(%e3_4165) : !cute.int_tuple<"?{div=8}">
          %iter_4166 = cute.get_iter(%view_4155) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4167, %e1_4168, %e2_4169, %e3_4170 = cute.get_leaves(%iter_4166) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1883 = cute.get_scalars(%e0_4167) : !cute.int_tuple<"?">
          %1884 = cute.get_scalars(%e1_4168) : !cute.int_tuple<"?">
          %1885 = cute.get_scalars(%e2_4169) : !cute.int_tuple<"?">
          %1886 = cute.get_scalars(%e3_4170) : !cute.int_tuple<"?{div=8}">
          %lay_4171 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1887 = cute.get_shape(%lay_4171) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4172, %e1_4173, %e2_4174, %e3_4175 = cute.get_leaves(%1887) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4176 = cute.to_int_tuple(%e0_4172) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1888 = cute.get_scalars(%itup_4176) : !cute.int_tuple<"?">
          %itup_4177 = cute.to_int_tuple(%e1_4173) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1889 = cute.get_scalars(%itup_4177) : !cute.int_tuple<"?">
          %itup_4178 = cute.to_int_tuple(%e2_4174) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1890 = cute.get_scalars(%itup_4178) : !cute.int_tuple<"?">
          %itup_4179 = cute.to_int_tuple(%e3_4175) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1891 = cute.get_scalars(%itup_4179) : !cute.int_tuple<"?{div=8}">
          %coord_4180 = cute.make_coord(%e1_4168) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4181 = cute.make_coord(%itup_4178) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1892 = cute.get_scalars(%coord_4180) : !cute.coord<"?">
          %1893 = cute.get_scalars(%coord_4181) : !cute.coord<"?">
          %true_4182 = arith.constant true
          %1894 = arith.cmpi slt, %1892, %1893 : i32
          %1895 = arith.andi %true_4182, %1894 : i1
          scf.if %1895 {
            %int_tuple_4216 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4217 = cute.tuple_sub(%sub_2735, %int_tuple_4216) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1917 = cute.get_scalars(%sub_4217) : !cute.int_tuple<"?">
            %coord_4218 = cute.make_coord(%sub_4217) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,2,_,?)">
            %lay_4219 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
            %idx_4220 = cute.crd2idx(%coord_4218, %lay_4219) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_4221 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
            %ptr_4222 = cute.add_offset(%iter_4221, %idx_4220) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4223 = cute.make_view(%ptr_4222) : !memref_gmem_bf16_11
            %iter_4224 = cute.get_iter(%view_4223) : !memref_gmem_bf16_11
            %coord_4225 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4226 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4227 = cute.crd2idx(%coord_4225, %lay_4226) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_4228 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4229 = cute.add_offset(%iter_4228, %idx_4227) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4230 = cute.make_view(%ptr_4229) : !memref_smem_bf16_15
            %iter_4231 = cute.get_iter(%view_4230) : !memref_smem_bf16_15
            %lay_4232 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %1918 = cute.get_shape(%lay_4232) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4233, %e1_4234, %e2_4235 = cute.get_leaves(%1918) : !cute.shape<"((8,1),1)">
            %lay_4236 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %1919 = cute.get_shape(%lay_4236) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4237, %e1_4238, %e2_4239 = cute.get_leaves(%1919) : !cute.shape<"((8,1),1)">
            %lay_4240 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %shape_4241 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4242 = cute.make_layout() : !cute.layout<"1:0">
            %append_4243 = cute.append_to_rank<2> (%lay_4240, %lay_4242) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4244 = cute.make_view(%iter_4224, %append_4243) : !memref_gmem_bf16_11
            %iter_4245 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %lay_4246 = cute.get_layout(%view_4244) : !memref_gmem_bf16_11
            %1920 = cute.get_shape(%lay_4246) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4247, %e1_4248, %e2_4249 = cute.get_leaves(%1920) : !cute.shape<"((8,1),1)">
            %iter_4250 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %view_4251 = cute.make_view(%iter_4250) : !memref_gmem_bf16_12
            %iter_4252 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4253 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %lay_4254 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %shape_4255 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4256 = cute.make_layout() : !cute.layout<"1:0">
            %append_4257 = cute.append_to_rank<2> (%lay_4254, %lay_4256) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4258 = cute.make_view(%iter_4231, %append_4257) : !memref_smem_bf16_15
            %iter_4259 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %lay_4260 = cute.get_layout(%view_4258) : !memref_smem_bf16_15
            %1921 = cute.get_shape(%lay_4260) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4261, %e1_4262, %e2_4263 = cute.get_leaves(%1921) : !cute.shape<"((8,1),1)">
            %iter_4264 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %view_4265 = cute.make_view(%iter_4264) : !memref_smem_bf16_16
            %iter_4266 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %iter_4267 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4268 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %1922 = cute.get_shape(%lay_4268) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4269, %e1_4270, %e2_4271 = cute.get_leaves(%1922) : !cute.shape<"((8,1),(1))">
            %lay_4272 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %1923 = cute.get_shape(%lay_4272) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4273, %e1_4274, %e2_4275 = cute.get_leaves(%1923) : !cute.shape<"((8,1),(1))">
            %lay_4276 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %sz_4277 = cute.size(%lay_4276) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4278 = cute.get_leaves(%sz_4277) : !cute.int_tuple<"1">
            %lay_4279 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %sz_4280 = cute.size(%lay_4279) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4281 = cute.get_leaves(%sz_4280) : !cute.int_tuple<"1">
            %1924 = cute.static : !cute.layout<"1:0">
            %iter_4282 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4283 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4284 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %lay_4285 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %append_4286 = cute.append_to_rank<2> (%lay_4284, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4287 = cute.append_to_rank<2> (%lay_4285, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4288 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4289 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4290 = cute.size(%lay_4288) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1925 = cute.get_scalars(%sz_4290) : !cute.int_tuple<"1">
            %c0_i32_4291 = arith.constant 0 : i32
            %c1_i32_4292 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4291 to %1925 step %c1_i32_4292  : i32 {
              %coord_4293 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1926 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4294 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4295 = cute.crd2idx(%coord_4293, %lay_4288) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4296 = cute.add_offset(%iter_4282, %idx_4295) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4297 = cute.make_view(%ptr_4296, %lay_4294) : !memref_gmem_bf16_10
              %1927 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4298 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4299 = cute.crd2idx(%coord_4293, %lay_4289) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4300 = cute.add_offset(%iter_4283, %idx_4299) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4301 = cute.make_view(%ptr_4300, %lay_4298) : !memref_smem_bf16_14
              %iter_4302 = cute.get_iter(%view_4297) : !memref_gmem_bf16_10
              %iter_4303 = cute.get_iter(%view_4301) : !memref_smem_bf16_14
              %iter_4304 = cute.recast_iter(%iter_4302) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4305 = cute.recast_iter(%iter_4303) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4305 : !cute.ptr<i128, smem>, %iter_4304 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4216 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_4217 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4218 = cute.crd2idx(%coord_4216, %lay_4217) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"2048">
            %iter_4219 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4220 = cute.add_offset(%iter_4219, %idx_4218) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4221 = cute.make_view(%ptr_4220) : !memref_smem_bf16_15
            %iter_4222 = cute.get_iter(%view_4221) : !memref_smem_bf16_15
            %lay_4223 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %sz_4224 = cute.size(%lay_4223) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4225 = cute.get_leaves(%sz_4224) : !cute.int_tuple<"8">
            %lay_4226 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %1917 = cute.get_shape(%lay_4226) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4227, %e1_4228, %e2_4229 = cute.get_leaves(%1917) : !cute.shape<"((8,1),1)">
            %int_tuple_4230 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4231 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4232 = cute.get_leaves(%int_tuple_4231) : !cute.int_tuple<"8">
            %cst_4233 = arith.constant 0.000000e+00 : bf16
            %1918 = vector.splat %cst_4233 : vector<8xbf16>
            %int_tuple_4234 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4235 = cute.size(%int_tuple_4234) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4236 = cute.get_leaves(%sz_4235) : !cute.int_tuple<"8">
            %int_tuple_4237 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4238 = cute.size(%int_tuple_4237) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4239 = cute.get_leaves(%sz_4238) : !cute.int_tuple<"8">
            cute.memref.store_vec %1918, %view_4221, row_major : !memref_smem_bf16_15
          }
          %coord_4183 = cute.make_coord(%sub_239) : (!cute.int_tuple<"?">) -> !cute.coord<"(0,3,0,?)">
          %lay_4184 = cute.get_layout(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %idx_4185 = cute.crd2idx(%coord_4183, %lay_4184) : (!cute.coord<"(0,3,0,?)">, !cute.layout<"((8,1),4,1,?):((1@3,0),16@2,0,64@3)">) -> !cute.int_tuple<"(0,0,48,?{div=64})">
          %iter_4186 = cute.get_iter(%view_1225) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,1,?):((1@3,0),16@2,0,64@3)">
          %tup_4187 = cute.add_offset(%iter_4186, %idx_4185) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,48,?{div=64})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_4188 = cute.make_view(%tup_4187) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_4189 = cute.get_iter(%view_4188) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4190, %e1_4191, %e2_4192, %e3_4193 = cute.get_leaves(%iter_4189) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1896 = cute.get_scalars(%e0_4190) : !cute.int_tuple<"?">
          %1897 = cute.get_scalars(%e1_4191) : !cute.int_tuple<"?">
          %1898 = cute.get_scalars(%e2_4192) : !cute.int_tuple<"?">
          %1899 = cute.get_scalars(%e3_4193) : !cute.int_tuple<"?{div=8}">
          %iter_4194 = cute.get_iter(%view_4188) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4195, %e1_4196, %e2_4197, %e3_4198 = cute.get_leaves(%iter_4194) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1900 = cute.get_scalars(%e0_4195) : !cute.int_tuple<"?">
          %1901 = cute.get_scalars(%e1_4196) : !cute.int_tuple<"?">
          %1902 = cute.get_scalars(%e2_4197) : !cute.int_tuple<"?">
          %1903 = cute.get_scalars(%e3_4198) : !cute.int_tuple<"?{div=8}">
          %iter_4199 = cute.get_iter(%view_4188) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_4200, %e1_4201, %e2_4202, %e3_4203 = cute.get_leaves(%iter_4199) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %1904 = cute.get_scalars(%e0_4200) : !cute.int_tuple<"?">
          %1905 = cute.get_scalars(%e1_4201) : !cute.int_tuple<"?">
          %1906 = cute.get_scalars(%e2_4202) : !cute.int_tuple<"?">
          %1907 = cute.get_scalars(%e3_4203) : !cute.int_tuple<"?{div=8}">
          %lay_4204 = cute.get_layout(%arg4) : !memref_gmem_bf16_
          %1908 = cute.get_shape(%lay_4204) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_4205, %e1_4206, %e2_4207, %e3_4208 = cute.get_leaves(%1908) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_4209 = cute.to_int_tuple(%e0_4205) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1909 = cute.get_scalars(%itup_4209) : !cute.int_tuple<"?">
          %itup_4210 = cute.to_int_tuple(%e1_4206) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1910 = cute.get_scalars(%itup_4210) : !cute.int_tuple<"?">
          %itup_4211 = cute.to_int_tuple(%e2_4207) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %1911 = cute.get_scalars(%itup_4211) : !cute.int_tuple<"?">
          %itup_4212 = cute.to_int_tuple(%e3_4208) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %1912 = cute.get_scalars(%itup_4212) : !cute.int_tuple<"?{div=8}">
          %coord_4213 = cute.make_coord(%e1_4201) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4214 = cute.make_coord(%itup_4211) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %1913 = cute.get_scalars(%coord_4213) : !cute.coord<"?">
          %1914 = cute.get_scalars(%coord_4214) : !cute.coord<"?">
          %true_4215 = arith.constant true
          %1915 = arith.cmpi slt, %1913, %1914 : i32
          %1916 = arith.andi %true_4215, %1915 : i1
          scf.if %1916 {
            %int_tuple_4216 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
            %sub_4217 = cute.tuple_sub(%sub_2735, %int_tuple_4216) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
            %1917 = cute.get_scalars(%sub_4217) : !cute.int_tuple<"?">
            %coord_4218 = cute.make_coord(%sub_4217) : (!cute.int_tuple<"?">) -> !cute.coord<"(_,3,_,?)">
            %lay_4219 = cute.get_layout(%view_588) : !memref_gmem_bf16_7
            %idx_4220 = cute.crd2idx(%coord_4218, %lay_4219) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,1,?):((1,0),?{i64 div=128},0,64)">) -> !cute.int_tuple<"?{i64 div=64}">
            %iter_4221 = cute.get_iter(%view_588) : !memref_gmem_bf16_7
            %ptr_4222 = cute.add_offset(%iter_4221, %idx_4220) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_4223 = cute.make_view(%ptr_4222) : !memref_gmem_bf16_11
            %iter_4224 = cute.get_iter(%view_4223) : !memref_gmem_bf16_11
            %coord_4225 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4226 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4227 = cute.crd2idx(%coord_4225, %lay_4226) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_4228 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4229 = cute.add_offset(%iter_4228, %idx_4227) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4230 = cute.make_view(%ptr_4229) : !memref_smem_bf16_15
            %iter_4231 = cute.get_iter(%view_4230) : !memref_smem_bf16_15
            %lay_4232 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %1918 = cute.get_shape(%lay_4232) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4233, %e1_4234, %e2_4235 = cute.get_leaves(%1918) : !cute.shape<"((8,1),1)">
            %lay_4236 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %1919 = cute.get_shape(%lay_4236) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4237, %e1_4238, %e2_4239 = cute.get_leaves(%1919) : !cute.shape<"((8,1),1)">
            %lay_4240 = cute.get_layout(%view_4223) : !memref_gmem_bf16_11
            %shape_4241 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4242 = cute.make_layout() : !cute.layout<"1:0">
            %append_4243 = cute.append_to_rank<2> (%lay_4240, %lay_4242) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4244 = cute.make_view(%iter_4224, %append_4243) : !memref_gmem_bf16_11
            %iter_4245 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %lay_4246 = cute.get_layout(%view_4244) : !memref_gmem_bf16_11
            %1920 = cute.get_shape(%lay_4246) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4247, %e1_4248, %e2_4249 = cute.get_leaves(%1920) : !cute.shape<"((8,1),1)">
            %iter_4250 = cute.get_iter(%view_4244) : !memref_gmem_bf16_11
            %view_4251 = cute.make_view(%iter_4250) : !memref_gmem_bf16_12
            %iter_4252 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4253 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %lay_4254 = cute.get_layout(%view_4230) : !memref_smem_bf16_15
            %shape_4255 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_4256 = cute.make_layout() : !cute.layout<"1:0">
            %append_4257 = cute.append_to_rank<2> (%lay_4254, %lay_4256) : !cute.layout<"((8,1),1):((1,0),0)">, !cute.layout<"1:0">
            %view_4258 = cute.make_view(%iter_4231, %append_4257) : !memref_smem_bf16_15
            %iter_4259 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %lay_4260 = cute.get_layout(%view_4258) : !memref_smem_bf16_15
            %1921 = cute.get_shape(%lay_4260) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4261, %e1_4262, %e2_4263 = cute.get_leaves(%1921) : !cute.shape<"((8,1),1)">
            %iter_4264 = cute.get_iter(%view_4258) : !memref_smem_bf16_15
            %view_4265 = cute.make_view(%iter_4264) : !memref_smem_bf16_16
            %iter_4266 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %iter_4267 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4268 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %1922 = cute.get_shape(%lay_4268) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4269, %e1_4270, %e2_4271 = cute.get_leaves(%1922) : !cute.shape<"((8,1),(1))">
            %lay_4272 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %1923 = cute.get_shape(%lay_4272) : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.shape<"((8,1),(1))">
            %e0_4273, %e1_4274, %e2_4275 = cute.get_leaves(%1923) : !cute.shape<"((8,1),(1))">
            %lay_4276 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %sz_4277 = cute.size(%lay_4276) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4278 = cute.get_leaves(%sz_4277) : !cute.int_tuple<"1">
            %lay_4279 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %sz_4280 = cute.size(%lay_4279) <{mode = [1]}> : (!cute.layout<"((8,1),(1)):((1,0),(0))">) -> !cute.int_tuple<"1">
            %e0_4281 = cute.get_leaves(%sz_4280) : !cute.int_tuple<"1">
            %1924 = cute.static : !cute.layout<"1:0">
            %iter_4282 = cute.get_iter(%view_4251) : !memref_gmem_bf16_12
            %iter_4283 = cute.get_iter(%view_4265) : !memref_smem_bf16_16
            %lay_4284 = cute.get_layout(%view_4251) : !memref_gmem_bf16_12
            %lay_4285 = cute.get_layout(%view_4265) : !memref_smem_bf16_16
            %append_4286 = cute.append_to_rank<2> (%lay_4284, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %append_4287 = cute.append_to_rank<2> (%lay_4285, %1924) : !cute.layout<"((8,1),(1)):((1,0),(0))">, !cute.layout<"1:0">
            %lay_4288 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %lay_4289 = cute.make_layout() : !cute.layout<"((8,1),((1))):((1,0),((0)))">
            %sz_4290 = cute.size(%lay_4288) <{mode = [1]}> : (!cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"1">
            %1925 = cute.get_scalars(%sz_4290) : !cute.int_tuple<"1">
            %c0_i32_4291 = arith.constant 0 : i32
            %c1_i32_4292 = arith.constant 1 : i32
            scf.for %arg8 = %c0_i32_4291 to %1925 step %c1_i32_4292  : i32 {
              %coord_4293 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
              %1926 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4294 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4295 = cute.crd2idx(%coord_4293, %lay_4288) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4296 = cute.add_offset(%iter_4282, %idx_4295) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_4297 = cute.make_view(%ptr_4296, %lay_4294) : !memref_gmem_bf16_10
              %1927 = cute.get_scalars(%coord_4293) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_4298 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_4299 = cute.crd2idx(%coord_4293, %lay_4289) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((1))):((1,0),((0)))">) -> !cute.int_tuple<"0">
              %ptr_4300 = cute.add_offset(%iter_4283, %idx_4299) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
              %view_4301 = cute.make_view(%ptr_4300, %lay_4298) : !memref_smem_bf16_14
              %iter_4302 = cute.get_iter(%view_4297) : !memref_gmem_bf16_10
              %iter_4303 = cute.get_iter(%view_4301) : !memref_smem_bf16_14
              %iter_4304 = cute.recast_iter(%iter_4302) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_4305 = cute.recast_iter(%iter_4303) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_4305 : !cute.ptr<i128, smem>, %iter_4304 : !cute.ptr<i128, gmem>) {cache_mode = <always>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_4216 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_4217 = cute.get_layout(%view_627) : !memref_smem_bf16_4
            %idx_4218 = cute.crd2idx(%coord_4216, %lay_4217) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,1):((1,0),1024,0)">) -> !cute.int_tuple<"3072">
            %iter_4219 = cute.get_iter(%view_627) : !memref_smem_bf16_4
            %ptr_4220 = cute.add_offset(%iter_4219, %idx_4218) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4221 = cute.make_view(%ptr_4220) : !memref_smem_bf16_15
            %iter_4222 = cute.get_iter(%view_4221) : !memref_smem_bf16_15
            %lay_4223 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %sz_4224 = cute.size(%lay_4223) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.int_tuple<"8">
            %e0_4225 = cute.get_leaves(%sz_4224) : !cute.int_tuple<"8">
            %lay_4226 = cute.get_layout(%view_4221) : !memref_smem_bf16_15
            %1917 = cute.get_shape(%lay_4226) : (!cute.layout<"((8,1),1):((1,0),0)">) -> !cute.shape<"((8,1),1)">
            %e0_4227, %e1_4228, %e2_4229 = cute.get_leaves(%1917) : !cute.shape<"((8,1),1)">
            %int_tuple_4230 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %int_tuple_4231 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
            %e0_4232 = cute.get_leaves(%int_tuple_4231) : !cute.int_tuple<"8">
            %cst_4233 = arith.constant 0.000000e+00 : bf16
            %1918 = vector.splat %cst_4233 : vector<8xbf16>
            %int_tuple_4234 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4235 = cute.size(%int_tuple_4234) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4236 = cute.get_leaves(%sz_4235) : !cute.int_tuple<"8">
            %int_tuple_4237 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),1)">
            %sz_4238 = cute.size(%int_tuple_4237) : (!cute.int_tuple<"((8,1),1)">) -> !cute.int_tuple<"8">
            %e0_4239 = cute.get_leaves(%sz_4238) : !cute.int_tuple<"8">
            cute.memref.store_vec %1918, %view_4221, row_major : !memref_smem_bf16_15
          }
          nvvm.cp.async.commit.group
        }
        %lay_3381 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
        %1678 = cute.get_shape(%lay_3381) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3382, %e1_3383, %e2_3384, %e3_3385 = cute.get_leaves(%1678) : !cute.shape<"((2,2),1,8)">
        %1679 = cute.get_stride(%lay_3381) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3386, %e1_3387, %e2_3388, %e3_3389 = cute.get_leaves(%1679) : !cute.stride<"((1,2),0,4)">
        %1680 = scf.if %true_3044 -> (!memref_rmem_f32_1) {
          %iter_3954 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
          %lay_3955 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
          %1817 = cute.get_shape(%lay_3955) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3956, %e1_3957, %e2_3958, %e3_3959 = cute.get_leaves(%1817) : !cute.shape<"((2,2),1,8)">
          %1818 = cute.memref.load_vec %rmem_2746, row_major : !memref_rmem_f32_1
          %cst_3960 = arith.constant 5.000000e-01 : f32
          %1819 = vector.broadcast %cst_3960 : f32 to vector<32xf32>
          %1820 = arith.mulf %1818, %1819 : vector<32xf32>
          %int_tuple_3961 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3962 = cute.size(%int_tuple_3961) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3963 = cute.get_leaves(%sz_3962) : !cute.int_tuple<"32">
          %int_tuple_3964 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3965 = cute.size(%int_tuple_3964) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3966 = cute.get_leaves(%sz_3965) : !cute.int_tuple<"32">
          cute.memref.store_vec %1820, %rmem_2746, row_major : !memref_rmem_f32_1
          %int_tuple_3967 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_3968 = cute.size(%int_tuple_3967) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_3969 = cute.get_leaves(%sz_3968) : !cute.int_tuple<"4">
          %int_tuple_3970 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3971 = cute.size(%int_tuple_3970) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3972 = cute.get_leaves(%sz_3971) : !cute.int_tuple<"1">
          %int_tuple_3973 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3974 = cute.size(%int_tuple_3973) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3975 = cute.get_leaves(%sz_3974) : !cute.int_tuple<"8">
          %coord_3976 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %1821 = cute.memref.load(%rmem_2746, %coord_3976) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">) -> f32
          %1822 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1821 : (f32) -> f32
          %coord_3977 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          cute.memref.store(%rmem_2746, %coord_3977, %1822) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
          %coord_3978 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %1823 = cute.memref.load(%rmem_2746, %coord_3978) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">) -> f32
          %1824 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1823 : (f32) -> f32
          %coord_3979 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          cute.memref.store(%rmem_2746, %coord_3979, %1824) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
          %coord_3980 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %1825 = cute.memref.load(%rmem_2746, %coord_3980) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">) -> f32
          %1826 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1825 : (f32) -> f32
          %coord_3981 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          cute.memref.store(%rmem_2746, %coord_3981, %1826) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
          %coord_3982 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %1827 = cute.memref.load(%rmem_2746, %coord_3982) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">) -> f32
          %1828 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1827 : (f32) -> f32
          %coord_3983 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          cute.memref.store(%rmem_2746, %coord_3983, %1828) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
          %coord_3984 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %1829 = cute.memref.load(%rmem_2746, %coord_3984) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">) -> f32
          %1830 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1829 : (f32) -> f32
          %coord_3985 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          cute.memref.store(%rmem_2746, %coord_3985, %1830) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
          %coord_3986 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %1831 = cute.memref.load(%rmem_2746, %coord_3986) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">) -> f32
          %1832 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1831 : (f32) -> f32
          %coord_3987 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          cute.memref.store(%rmem_2746, %coord_3987, %1832) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
          %coord_3988 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %1833 = cute.memref.load(%rmem_2746, %coord_3988) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">) -> f32
          %1834 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1833 : (f32) -> f32
          %coord_3989 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          cute.memref.store(%rmem_2746, %coord_3989, %1834) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
          %coord_3990 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %1835 = cute.memref.load(%rmem_2746, %coord_3990) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">) -> f32
          %1836 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1835 : (f32) -> f32
          %coord_3991 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          cute.memref.store(%rmem_2746, %coord_3991, %1836) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
          %int_tuple_3992 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3993 = cute.size(%int_tuple_3992) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3994 = cute.get_leaves(%sz_3993) : !cute.int_tuple<"1">
          %int_tuple_3995 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3996 = cute.size(%int_tuple_3995) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3997 = cute.get_leaves(%sz_3996) : !cute.int_tuple<"8">
          %coord_3998 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %1837 = cute.memref.load(%rmem_2746, %coord_3998) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">) -> f32
          %1838 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1837 : (f32) -> f32
          %coord_3999 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          cute.memref.store(%rmem_2746, %coord_3999, %1838) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
          %coord_4000 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %1839 = cute.memref.load(%rmem_2746, %coord_4000) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">) -> f32
          %1840 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1839 : (f32) -> f32
          %coord_4001 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          cute.memref.store(%rmem_2746, %coord_4001, %1840) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
          %coord_4002 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %1841 = cute.memref.load(%rmem_2746, %coord_4002) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">) -> f32
          %1842 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1841 : (f32) -> f32
          %coord_4003 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          cute.memref.store(%rmem_2746, %coord_4003, %1842) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
          %coord_4004 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %1843 = cute.memref.load(%rmem_2746, %coord_4004) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">) -> f32
          %1844 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1843 : (f32) -> f32
          %coord_4005 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          cute.memref.store(%rmem_2746, %coord_4005, %1844) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
          %coord_4006 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %1845 = cute.memref.load(%rmem_2746, %coord_4006) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">) -> f32
          %1846 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1845 : (f32) -> f32
          %coord_4007 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          cute.memref.store(%rmem_2746, %coord_4007, %1846) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
          %coord_4008 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %1847 = cute.memref.load(%rmem_2746, %coord_4008) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">) -> f32
          %1848 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1847 : (f32) -> f32
          %coord_4009 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          cute.memref.store(%rmem_2746, %coord_4009, %1848) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
          %coord_4010 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %1849 = cute.memref.load(%rmem_2746, %coord_4010) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">) -> f32
          %1850 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1849 : (f32) -> f32
          %coord_4011 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          cute.memref.store(%rmem_2746, %coord_4011, %1850) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
          %coord_4012 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %1851 = cute.memref.load(%rmem_2746, %coord_4012) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">) -> f32
          %1852 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1851 : (f32) -> f32
          %coord_4013 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          cute.memref.store(%rmem_2746, %coord_4013, %1852) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
          %int_tuple_4014 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4015 = cute.size(%int_tuple_4014) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4016 = cute.get_leaves(%sz_4015) : !cute.int_tuple<"1">
          %int_tuple_4017 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4018 = cute.size(%int_tuple_4017) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4019 = cute.get_leaves(%sz_4018) : !cute.int_tuple<"8">
          %coord_4020 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %1853 = cute.memref.load(%rmem_2746, %coord_4020) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">) -> f32
          %1854 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1853 : (f32) -> f32
          %coord_4021 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          cute.memref.store(%rmem_2746, %coord_4021, %1854) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
          %coord_4022 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %1855 = cute.memref.load(%rmem_2746, %coord_4022) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">) -> f32
          %1856 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1855 : (f32) -> f32
          %coord_4023 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          cute.memref.store(%rmem_2746, %coord_4023, %1856) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
          %coord_4024 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %1857 = cute.memref.load(%rmem_2746, %coord_4024) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">) -> f32
          %1858 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1857 : (f32) -> f32
          %coord_4025 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          cute.memref.store(%rmem_2746, %coord_4025, %1858) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
          %coord_4026 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %1859 = cute.memref.load(%rmem_2746, %coord_4026) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">) -> f32
          %1860 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1859 : (f32) -> f32
          %coord_4027 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          cute.memref.store(%rmem_2746, %coord_4027, %1860) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
          %coord_4028 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %1861 = cute.memref.load(%rmem_2746, %coord_4028) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">) -> f32
          %1862 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1861 : (f32) -> f32
          %coord_4029 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          cute.memref.store(%rmem_2746, %coord_4029, %1862) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
          %coord_4030 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %1863 = cute.memref.load(%rmem_2746, %coord_4030) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">) -> f32
          %1864 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1863 : (f32) -> f32
          %coord_4031 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          cute.memref.store(%rmem_2746, %coord_4031, %1864) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
          %coord_4032 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %1865 = cute.memref.load(%rmem_2746, %coord_4032) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">) -> f32
          %1866 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1865 : (f32) -> f32
          %coord_4033 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          cute.memref.store(%rmem_2746, %coord_4033, %1866) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
          %coord_4034 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %1867 = cute.memref.load(%rmem_2746, %coord_4034) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">) -> f32
          %1868 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1867 : (f32) -> f32
          %coord_4035 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          cute.memref.store(%rmem_2746, %coord_4035, %1868) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
          %int_tuple_4036 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4037 = cute.size(%int_tuple_4036) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4038 = cute.get_leaves(%sz_4037) : !cute.int_tuple<"1">
          %int_tuple_4039 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4040 = cute.size(%int_tuple_4039) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4041 = cute.get_leaves(%sz_4040) : !cute.int_tuple<"8">
          %coord_4042 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %1869 = cute.memref.load(%rmem_2746, %coord_4042) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">) -> f32
          %1870 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1869 : (f32) -> f32
          %coord_4043 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          cute.memref.store(%rmem_2746, %coord_4043, %1870) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
          %coord_4044 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %1871 = cute.memref.load(%rmem_2746, %coord_4044) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">) -> f32
          %1872 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1871 : (f32) -> f32
          %coord_4045 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          cute.memref.store(%rmem_2746, %coord_4045, %1872) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
          %coord_4046 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %1873 = cute.memref.load(%rmem_2746, %coord_4046) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">) -> f32
          %1874 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1873 : (f32) -> f32
          %coord_4047 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          cute.memref.store(%rmem_2746, %coord_4047, %1874) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
          %coord_4048 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %1875 = cute.memref.load(%rmem_2746, %coord_4048) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">) -> f32
          %1876 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1875 : (f32) -> f32
          %coord_4049 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          cute.memref.store(%rmem_2746, %coord_4049, %1876) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
          %coord_4050 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %1877 = cute.memref.load(%rmem_2746, %coord_4050) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">) -> f32
          %1878 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1877 : (f32) -> f32
          %coord_4051 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          cute.memref.store(%rmem_2746, %coord_4051, %1878) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
          %coord_4052 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %1879 = cute.memref.load(%rmem_2746, %coord_4052) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">) -> f32
          %1880 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1879 : (f32) -> f32
          %coord_4053 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          cute.memref.store(%rmem_2746, %coord_4053, %1880) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
          %coord_4054 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %1881 = cute.memref.load(%rmem_2746, %coord_4054) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">) -> f32
          %1882 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1881 : (f32) -> f32
          %coord_4055 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          cute.memref.store(%rmem_2746, %coord_4055, %1882) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
          %coord_4056 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %1883 = cute.memref.load(%rmem_2746, %coord_4056) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">) -> f32
          %1884 = llvm.inline_asm asm_dialect = att "tanh.approx.f32 $0, $1;", "=f,f" %1883 : (f32) -> f32
          %coord_4057 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          cute.memref.store(%rmem_2746, %coord_4057, %1884) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
          %1885 = cute.memref.load_vec %rmem_2746, row_major : !memref_rmem_f32_1
          %1886 = arith.mulf %1820, %1885 : vector<32xf32>
          %1887 = arith.addf %1886, %1820 : vector<32xf32>
          %int_tuple_4058 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4059 = cute.size(%int_tuple_4058) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4060 = cute.get_leaves(%sz_4059) : !cute.int_tuple<"32">
          %int_tuple_4061 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_4062 = cute.size(%int_tuple_4061) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_4063 = cute.get_leaves(%sz_4062) : !cute.int_tuple<"32">
          cute.memref.store_vec %1887, %rmem_2746, row_major : !memref_rmem_f32_1
          %lay_4064 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
          %1888 = cute.get_shape(%lay_4064) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4065, %e1_4066, %e2_4067, %e3_4068 = cute.get_leaves(%1888) : !cute.shape<"((2,2),1,8)">
          %1889 = cute.get_stride(%lay_4064) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4069, %e1_4070, %e2_4071, %e3_4072 = cute.get_leaves(%1889) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2746 : !memref_rmem_f32_1
        } else {
          %iter_3954 = cute.get_iter(%rmem_2746) : !memref_rmem_f32_1
          %lay_3955 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
          %1817 = cute.get_shape(%lay_3955) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3956, %e1_3957, %e2_3958, %e3_3959 = cute.get_leaves(%1817) : !cute.shape<"((2,2),1,8)">
          %1818 = cute.memref.load_vec %rmem_2746, row_major : !memref_rmem_f32_1
          %cst_3960 = arith.constant -1.44269502 : f32
          %1819 = vector.broadcast %cst_3960 : f32 to vector<32xf32>
          %1820 = arith.mulf %1818, %1819 : vector<32xf32>
          %1821 = math.exp2 %1820 fastmath<fast> : vector<32xf32>
          %cst_3961 = arith.constant 1.000000e+00 : f32
          %1822 = vector.broadcast %cst_3961 : f32 to vector<32xf32>
          %1823 = arith.addf %1821, %1822 : vector<32xf32>
          %1824 = arith.divf %1818, %1823 : vector<32xf32>
          %int_tuple_3962 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3963 = cute.size(%int_tuple_3962) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3964 = cute.get_leaves(%sz_3963) : !cute.int_tuple<"32">
          %int_tuple_3965 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
          %sz_3966 = cute.size(%int_tuple_3965) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
          %e0_3967 = cute.get_leaves(%sz_3966) : !cute.int_tuple<"32">
          cute.memref.store_vec %1824, %rmem_2746, row_major : !memref_rmem_f32_1
          %lay_3968 = cute.get_layout(%rmem_2746) : !memref_rmem_f32_1
          %1825 = cute.get_shape(%lay_3968) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3969, %e1_3970, %e2_3971, %e3_3972 = cute.get_leaves(%1825) : !cute.shape<"((2,2),1,8)">
          %1826 = cute.get_stride(%lay_3968) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3973, %e1_3974, %e2_3975, %e3_3976 = cute.get_leaves(%1826) : !cute.stride<"((1,2),0,4)">
          scf.yield %rmem_2746 : !memref_rmem_f32_1
        }
        %iter_3390 = cute.get_iter(%1680) : !memref_rmem_f32_1
        %lay_3391 = cute.get_layout(%1680) : !memref_rmem_f32_1
        %1681 = cute.get_shape(%lay_3391) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3392, %e1_3393, %e2_3394, %e3_3395 = cute.get_leaves(%1681) : !cute.shape<"((2,2),1,8)">
        %1682 = cute.get_stride(%lay_3391) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3396, %e1_3397, %e2_3398, %e3_3399 = cute.get_leaves(%1682) : !cute.stride<"((1,2),0,4)">
        %iter_3400 = cute.get_iter(%1680) : !memref_rmem_f32_1
        %iter_3401 = cute.get_iter(%1680) : !memref_rmem_f32_1
        %lay_3402 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1683 = cute.get_shape(%lay_3402) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_3403, %e1_3404, %e2_3405, %e3_3406 = cute.get_leaves(%1683) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_3407 = cute.to_int_tuple(%e0_3403) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1684 = cute.get_scalars(%itup_3407) : !cute.int_tuple<"?">
        %itup_3408 = cute.to_int_tuple(%e1_3404) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1685 = cute.get_scalars(%itup_3408) : !cute.int_tuple<"?">
        %itup_3409 = cute.to_int_tuple(%e2_3405) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1686 = cute.get_scalars(%itup_3409) : !cute.int_tuple<"?">
        %itup_3410 = cute.to_int_tuple(%e3_3406) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1687 = cute.get_scalars(%itup_3410) : !cute.int_tuple<"?{div=8}">
        %lay_3411 = cute.get_layout(%arg4) : !memref_gmem_bf16_
        %1688 = cute.get_shape(%lay_3411) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_3412, %e1_3413, %e2_3414, %e3_3415 = cute.get_leaves(%1688) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_3416 = cute.to_int_tuple(%e0_3412) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1689 = cute.get_scalars(%itup_3416) : !cute.int_tuple<"?">
        %itup_3417 = cute.to_int_tuple(%e1_3413) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1690 = cute.get_scalars(%itup_3417) : !cute.int_tuple<"?">
        %itup_3418 = cute.to_int_tuple(%e2_3414) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %1691 = cute.get_scalars(%itup_3418) : !cute.int_tuple<"?">
        %itup_3419 = cute.to_int_tuple(%e3_3415) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %1692 = cute.get_scalars(%itup_3419) : !cute.int_tuple<"?{div=8}">
        %shape_3420 = cute.make_shape(%itup_3409, %itup_3419) : (!cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?{div=8})">
        %int_tuple_3421 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0)">
        %stride_3422 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1)">
        %lay_3423 = cute.make_layout(%shape_3420, %stride_3422) : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %view_3424 = cute.make_view(%int_tuple_3421, %lay_3423) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_3425 = cute.get_iter(%view_3424) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_3426, %e1_3427 = cute.get_leaves(%iter_3425) : !cute.int_tuple<"(0,0)">
        %coord_3428 = cute.make_coord() : () -> !cute.coord<"(_,_)">
        %lay_3429 = cute.get_layout(%view_3424) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %1693:2 = cute.get_scalars(%lay_3429) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %iv_3430 = cute.assume(%1693#1) : (i32) -> !cute.i32<divby 8>
        %shape_3431 = cute.make_shape(%1693#0, %iv_3430) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
        %stride_3432 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1)">
        %lay_3433 = cute.make_layout(%shape_3431, %stride_3432) : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %int_tuple_3434 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0)">
        %view_3435 = cute.make_view(%int_tuple_3434, %lay_3433) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %iter_3436 = cute.get_iter(%view_3435) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %e0_3437, %e1_3438 = cute.get_leaves(%iter_3436) : !cute.int_tuple<"(0,0)">
        %tile_3439 = cute.make_tile() : () -> !cute.tile<"[64:1;64:1]">
        %coord_3440 = cute.make_coord(%sub_223, %sub_2735) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.coord<"(?,?)">
        %1694:2 = cute.get_scalars(%coord_3440) <{only_dynamic}> : !cute.coord<"(?,?)">
        %coord_3441 = cute.make_coord(%1694#0, %1694#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
        %lay_3442 = cute.get_layout(%view_3435) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %1695:2 = cute.get_scalars(%lay_3442) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@0,1@1)">
        %c64_i32_3443 = arith.constant 64 : i32
        %1696 = arith.ceildivsi %1695#0, %c64_i32_3443 : i32
        %c64_i32_3444 = arith.constant 64 : i32
        %1697 = arith.ceildivsi %1695#1, %c64_i32_3444 : i32
        %shape_3445 = cute.make_shape(%1696, %1697) : (i32, i32) -> !cute.shape<"((64,64),(?,?))">
        %stride_3446 = cute.make_stride() : () -> !cute.stride<"((1@0,1@1),(64@0,64@1))">
        %lay_3447 = cute.make_layout(%shape_3445, %stride_3446) : !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">
        %idx_3448 = cute.crd2idx(%coord_3441, %lay_3447) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((64,64),(?,?)):((1@0,1@1),(64@0,64@1))">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %iter_3449 = cute.get_iter(%view_3435) : !cute.coord_tensor<"(0,0)", "(?,?{div=8}):(1@0,1@1)">
        %tup_3450 = cute.add_offset(%iter_3449, %idx_3448) : (!cute.int_tuple<"(0,0)">, !cute.int_tuple<"(?{div=64},?{div=64})">) -> !cute.int_tuple<"(?{div=64},?{div=64})">
        %view_3451 = cute.make_view(%tup_3450) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %iter_3452 = cute.get_iter(%view_3451) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
        %e0_3453, %e1_3454 = cute.get_leaves(%iter_3452) : !cute.int_tuple<"(?{div=64},?{div=64})">
        %1698 = cute.get_scalars(%e0_3453) : !cute.int_tuple<"?{div=64}">
        %1699 = cute.get_scalars(%e1_3454) : !cute.int_tuple<"?{div=64}">
        %lay_3455 = cute.get_layout(%1680) : !memref_rmem_f32_1
        %1700 = cute.get_shape(%lay_3455) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3456, %e1_3457, %e2_3458, %e3_3459 = cute.get_leaves(%1700) : !cute.shape<"((2,2),1,8)">
        %1701 = cute.get_stride(%lay_3455) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3460, %e1_3461, %e2_3462, %e3_3463 = cute.get_leaves(%1701) : !cute.stride<"((1,2),0,4)">
        %1702 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1703 = cute.get_shape(%1702) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_3464, %e1_3465, %e2_3466, %e3_3467 = cute.get_leaves(%1703) : !cute.shape<"(32,4,1,1)">
        %1704 = cute.get_stride(%1702) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_3468, %e1_3469, %e2_3470, %e3_3471 = cute.get_leaves(%1704) : !cute.stride<"(1,32,0,0)">
        %1705 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_3472, %e1_3473, %e2_3474 = cute.get_leaves(%1705) : !cute.tile<"[64:1;16:1;16:1]">
        %1706 = cute.get_shape(%e0_3472) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3475 = cute.get_leaves(%1706) : !cute.shape<"64">
        %1707 = cute.get_stride(%e0_3472) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3476 = cute.get_leaves(%1707) : !cute.stride<"1">
        %1708 = cute.get_shape(%e1_3473) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3477 = cute.get_leaves(%1708) : !cute.shape<"16">
        %1709 = cute.get_stride(%e1_3473) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3478 = cute.get_leaves(%1709) : !cute.stride<"1">
        %1710 = cute.get_shape(%e2_3474) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3479 = cute.get_leaves(%1710) : !cute.shape<"16">
        %1711 = cute.get_stride(%e2_3474) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3480 = cute.get_leaves(%1711) : !cute.stride<"1">
        %1712 = cute.static : !cute.layout<"32:1">
        %1713 = cute.get_shape(%1712) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3481 = cute.get_leaves(%1713) : !cute.shape<"32">
        %1714 = cute.get_stride(%1712) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3482 = cute.get_leaves(%1714) : !cute.stride<"1">
        %1715 = cute.static : !cute.shape<"(16,8,16)">
        %e0_3483, %e1_3484, %e2_3485 = cute.get_leaves(%1715) : !cute.shape<"(16,8,16)">
        %1716 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1717 = cute.get_shape(%1716) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_3486, %e1_3487, %e2_3488, %e3_3489, %e4_3490 = cute.get_leaves(%1717) : !cute.shape<"((4,8),(2,2,2))">
        %1718 = cute.get_stride(%1716) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_3491, %e1_3492, %e2_3493, %e3_3494, %e4_3495 = cute.get_leaves(%1718) : !cute.stride<"((32,1),(16,8,128))">
        %1719 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1720 = cute.get_shape(%1719) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3496, %e1_3497, %e2_3498, %e3_3499 = cute.get_leaves(%1720) : !cute.shape<"((4,8),(2,2))">
        %1721 = cute.get_stride(%1719) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_3500, %e1_3501, %e2_3502, %e3_3503 = cute.get_leaves(%1721) : !cute.stride<"((16,1),(8,64))">
        %1722 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1723 = cute.get_shape(%1722) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3504, %e1_3505, %e2_3506, %e3_3507 = cute.get_leaves(%1723) : !cute.shape<"((4,8),(2,2))">
        %1724 = cute.get_stride(%1722) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_3508, %e1_3509, %e2_3510, %e3_3511 = cute.get_leaves(%1724) : !cute.stride<"((32,1),(16,8))">
        %1725:2 = scf.if %false -> (!memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_) {
          %iter_3954 = cute.get_iter(%1680) : !memref_rmem_f32_1
          %coord_3955 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
          %iter_3956 = cute.get_iter(%view_3451) : !cute.coord_tensor<"(?{div=64},?{div=64})", "(64,64):(1@0,1@1)">
          %1817 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"?">
          %c32_i32_3957 = arith.constant 32 : i32
          %1818 = arith.remsi %1817, %c32_i32_3957 : i32
          %c32_i32_3958 = arith.constant 32 : i32
          %1819 = arith.divsi %1817, %c32_i32_3958 : i32
          %c4_i32_3959 = arith.constant 4 : i32
          %1820 = arith.remsi %1819, %c4_i32_3959 : i32
          %c32_i32_3960 = arith.constant 32 : i32
          %1821 = arith.remsi %1818, %c32_i32_3960 : i32
          %c4_i32_3961 = arith.constant 4 : i32
          %1822 = arith.remsi %1820, %c4_i32_3961 : i32
          %c4_i32_3962 = arith.constant 4 : i32
          %1823 = arith.divsi %1821, %c4_i32_3962 : i32
          %c4_i32_3963 = arith.constant 4 : i32
          %1824 = arith.remsi %1821, %c4_i32_3963 : i32
          %c2_i32_3964 = arith.constant 2 : i32
          %1825 = arith.muli %1824, %c2_i32_3964 : i32
          %c16_i32_3965 = arith.constant 16 : i32
          %1826 = arith.muli %1822, %c16_i32_3965 : i32
          %1827 = arith.addi %1823, %1826 : i32
          %iv_3966 = cute.assume(%1825) : (i32) -> !cute.i32<divby 2>
          %int_tuple_3967 = cute.make_int_tuple(%1827, %iv_3966) : (i32, !cute.i32<divby 2>) -> !cute.int_tuple<"(?,?{div=2})">
          %tup_3968 = cute.add_offset(%iter_3956, %int_tuple_3967) : (!cute.int_tuple<"(?{div=64},?{div=64})">, !cute.int_tuple<"(?,?{div=2})">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3969 = cute.make_view(%tup_3968) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %iter_3970 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %e0_3971, %e1_3972 = cute.get_leaves(%iter_3970) : !cute.int_tuple<"(?,?{div=2})">
          %1828 = cute.get_scalars(%e0_3971) : !cute.int_tuple<"?">
          %1829 = cute.get_scalars(%e1_3972) : !cute.int_tuple<"?{div=2}">
          %lay_3973 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %1830 = cute.get_shape(%lay_3973) : (!cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977 = cute.get_leaves(%1830) : !cute.shape<"((2,2),1,8)">
          %int_tuple_3978 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,2)">
          %sz_3979 = cute.size(%int_tuple_3978) : (!cute.int_tuple<"(2,2)">) -> !cute.int_tuple<"4">
          %e0_3980 = cute.get_leaves(%sz_3979) : !cute.int_tuple<"4">
          %int_tuple_3981 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_3982 = cute.size(%int_tuple_3981) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_3983 = cute.get_leaves(%sz_3982) : !cute.int_tuple<"1">
          %int_tuple_3984 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_3985 = cute.size(%int_tuple_3984) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_3986 = cute.get_leaves(%sz_3985) : !cute.int_tuple<"8">
          %coord_3987 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_3988 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_3989 = cute.crd2idx(%coord_3987, %lay_3988) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_3990 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_3991 = cute.add_offset(%iter_3990, %idx_3989) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_3992 = cute.make_view(%tup_3991) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_3993 = cute.get_iter(%view_3992) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3994, %e1_3995 = cute.get_leaves(%iter_3993) : !cute.int_tuple<"(?,?{div=2})">
          %1831 = cute.get_scalars(%e0_3994) : !cute.int_tuple<"?">
          %1832 = cute.get_scalars(%e1_3995) : !cute.int_tuple<"?{div=2}">
          %iter_3996 = cute.get_iter(%view_3992) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_3997, %e1_3998 = cute.get_leaves(%iter_3996) : !cute.int_tuple<"(?,?{div=2})">
          %1833 = cute.get_scalars(%e0_3997) : !cute.int_tuple<"?">
          %1834 = cute.get_scalars(%e1_3998) : !cute.int_tuple<"?{div=2}">
          %iter_3999 = cute.get_iter(%view_3992) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4000, %e1_4001 = cute.get_leaves(%iter_3999) : !cute.int_tuple<"(?,?{div=2})">
          %1835 = cute.get_scalars(%e0_4000) : !cute.int_tuple<"?">
          %1836 = cute.get_scalars(%e1_4001) : !cute.int_tuple<"?{div=2}">
          %coord_4002 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_4003 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4004 = cute.crd2idx(%coord_4002, %lay_4003) : (!cute.coord<"(0,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,0)">
          %iter_4005 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4006 = cute.add_offset(%iter_4005, %idx_4004) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4007 = cute.make_view(%tup_4006) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4008 = cute.get_iter(%view_4007) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4009, %e1_4010 = cute.get_leaves(%iter_4008) : !cute.int_tuple<"(?,?{div=2})">
          %1837 = cute.get_scalars(%e0_4009) : !cute.int_tuple<"?">
          %1838 = cute.get_scalars(%e1_4010) : !cute.int_tuple<"?{div=2}">
          %iter_4011 = cute.get_iter(%view_4007) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4012, %e1_4013 = cute.get_leaves(%iter_4011) : !cute.int_tuple<"(?,?{div=2})">
          %1839 = cute.get_scalars(%e0_4012) : !cute.int_tuple<"?">
          %1840 = cute.get_scalars(%e1_4013) : !cute.int_tuple<"?{div=2}">
          %iter_4014 = cute.get_iter(%view_4007) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4015, %e1_4016 = cute.get_leaves(%iter_4014) : !cute.int_tuple<"(?,?{div=2})">
          %1841 = cute.get_scalars(%e0_4015) : !cute.int_tuple<"?">
          %1842 = cute.get_scalars(%e1_4016) : !cute.int_tuple<"?{div=2}">
          %coord_4017 = cute.make_coord(%e0_4000) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4018 = cute.make_coord(%e1_4016) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1843 = cute.get_scalars(%coord_4017) : !cute.coord<"?">
          %1844 = cute.get_scalars(%coord_4018) : !cute.coord<"?{div=2}">
          %true_4019 = arith.constant true
          %1845 = arith.cmpi slt, %1843, %1844 : i32
          %1846 = arith.andi %true_4019, %1845 : i1
          %lay_4020 = cute.get_layout(%1680) : !memref_rmem_f32_1
          %1847 = cute.get_shape(%lay_4020) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4021, %e1_4022, %e2_4023, %e3_4024 = cute.get_leaves(%1847) : !cute.shape<"((2,2),1,8)">
          %1848 = cute.get_stride(%lay_4020) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4025, %e1_4026, %e2_4027, %e3_4028 = cute.get_leaves(%1848) : !cute.stride<"((1,2),0,4)">
          %1849 = scf.if %1846 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1680) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
            cute.memref.store(%1680, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,0)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1680) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1680 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1680) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1680) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1680 : !memref_rmem_f32_1
          }
          %iter_4029 = cute.get_iter(%1849) : !memref_rmem_f32_1
          %lay_4030 = cute.get_layout(%1849) : !memref_rmem_f32_1
          %1850 = cute.get_shape(%lay_4030) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4031, %e1_4032, %e2_4033, %e3_4034 = cute.get_leaves(%1850) : !cute.shape<"((2,2),1,8)">
          %1851 = cute.get_stride(%lay_4030) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4035, %e1_4036, %e2_4037, %e3_4038 = cute.get_leaves(%1851) : !cute.stride<"((1,2),0,4)">
          %iter_4039 = cute.get_iter(%1849) : !memref_rmem_f32_1
          %iter_4040 = cute.get_iter(%1849) : !memref_rmem_f32_1
          %coord_4041 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_4042 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4043 = cute.crd2idx(%coord_4041, %lay_4042) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_4044 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4045 = cute.add_offset(%iter_4044, %idx_4043) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4046 = cute.make_view(%tup_4045) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4047 = cute.get_iter(%view_4046) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4048, %e1_4049 = cute.get_leaves(%iter_4047) : !cute.int_tuple<"(?,?{div=2})">
          %1852 = cute.get_scalars(%e0_4048) : !cute.int_tuple<"?">
          %1853 = cute.get_scalars(%e1_4049) : !cute.int_tuple<"?{div=2}">
          %iter_4050 = cute.get_iter(%view_4046) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4051, %e1_4052 = cute.get_leaves(%iter_4050) : !cute.int_tuple<"(?,?{div=2})">
          %1854 = cute.get_scalars(%e0_4051) : !cute.int_tuple<"?">
          %1855 = cute.get_scalars(%e1_4052) : !cute.int_tuple<"?{div=2}">
          %iter_4053 = cute.get_iter(%view_4046) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4054, %e1_4055 = cute.get_leaves(%iter_4053) : !cute.int_tuple<"(?,?{div=2})">
          %1856 = cute.get_scalars(%e0_4054) : !cute.int_tuple<"?">
          %1857 = cute.get_scalars(%e1_4055) : !cute.int_tuple<"?{div=2}">
          %coord_4056 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
          %lay_4057 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4058 = cute.crd2idx(%coord_4056, %lay_4057) : (!cute.coord<"(0,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,8)">
          %iter_4059 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4060 = cute.add_offset(%iter_4059, %idx_4058) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4061 = cute.make_view(%tup_4060) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4062 = cute.get_iter(%view_4061) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4063, %e1_4064 = cute.get_leaves(%iter_4062) : !cute.int_tuple<"(?,?{div=2})">
          %1858 = cute.get_scalars(%e0_4063) : !cute.int_tuple<"?">
          %1859 = cute.get_scalars(%e1_4064) : !cute.int_tuple<"?{div=2}">
          %iter_4065 = cute.get_iter(%view_4061) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4066, %e1_4067 = cute.get_leaves(%iter_4065) : !cute.int_tuple<"(?,?{div=2})">
          %1860 = cute.get_scalars(%e0_4066) : !cute.int_tuple<"?">
          %1861 = cute.get_scalars(%e1_4067) : !cute.int_tuple<"?{div=2}">
          %iter_4068 = cute.get_iter(%view_4061) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4069, %e1_4070 = cute.get_leaves(%iter_4068) : !cute.int_tuple<"(?,?{div=2})">
          %1862 = cute.get_scalars(%e0_4069) : !cute.int_tuple<"?">
          %1863 = cute.get_scalars(%e1_4070) : !cute.int_tuple<"?{div=2}">
          %coord_4071 = cute.make_coord(%e0_4054) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4072 = cute.make_coord(%e1_4070) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1864 = cute.get_scalars(%coord_4071) : !cute.coord<"?">
          %1865 = cute.get_scalars(%coord_4072) : !cute.coord<"?{div=2}">
          %true_4073 = arith.constant true
          %1866 = arith.cmpi slt, %1864, %1865 : i32
          %1867 = arith.andi %true_4073, %1866 : i1
          %lay_4074 = cute.get_layout(%1849) : !memref_rmem_f32_1
          %1868 = cute.get_shape(%lay_4074) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4075, %e1_4076, %e2_4077, %e3_4078 = cute.get_leaves(%1868) : !cute.shape<"((2,2),1,8)">
          %1869 = cute.get_stride(%lay_4074) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4079, %e1_4080, %e2_4081, %e3_4082 = cute.get_leaves(%1869) : !cute.stride<"((1,2),0,4)">
          %1870 = scf.if %1867 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1849) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
            cute.memref.store(%1849, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,1)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1849) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1849 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1849) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1849) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1849 : !memref_rmem_f32_1
          }
          %iter_4083 = cute.get_iter(%1870) : !memref_rmem_f32_1
          %lay_4084 = cute.get_layout(%1870) : !memref_rmem_f32_1
          %1871 = cute.get_shape(%lay_4084) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4085, %e1_4086, %e2_4087, %e3_4088 = cute.get_leaves(%1871) : !cute.shape<"((2,2),1,8)">
          %1872 = cute.get_stride(%lay_4084) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4089, %e1_4090, %e2_4091, %e3_4092 = cute.get_leaves(%1872) : !cute.stride<"((1,2),0,4)">
          %iter_4093 = cute.get_iter(%1870) : !memref_rmem_f32_1
          %iter_4094 = cute.get_iter(%1870) : !memref_rmem_f32_1
          %coord_4095 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_4096 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4097 = cute.crd2idx(%coord_4095, %lay_4096) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_4098 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4099 = cute.add_offset(%iter_4098, %idx_4097) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4100 = cute.make_view(%tup_4099) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4101 = cute.get_iter(%view_4100) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4102, %e1_4103 = cute.get_leaves(%iter_4101) : !cute.int_tuple<"(?,?{div=2})">
          %1873 = cute.get_scalars(%e0_4102) : !cute.int_tuple<"?">
          %1874 = cute.get_scalars(%e1_4103) : !cute.int_tuple<"?{div=2}">
          %iter_4104 = cute.get_iter(%view_4100) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4105, %e1_4106 = cute.get_leaves(%iter_4104) : !cute.int_tuple<"(?,?{div=2})">
          %1875 = cute.get_scalars(%e0_4105) : !cute.int_tuple<"?">
          %1876 = cute.get_scalars(%e1_4106) : !cute.int_tuple<"?{div=2}">
          %iter_4107 = cute.get_iter(%view_4100) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4108, %e1_4109 = cute.get_leaves(%iter_4107) : !cute.int_tuple<"(?,?{div=2})">
          %1877 = cute.get_scalars(%e0_4108) : !cute.int_tuple<"?">
          %1878 = cute.get_scalars(%e1_4109) : !cute.int_tuple<"?{div=2}">
          %coord_4110 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
          %lay_4111 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4112 = cute.crd2idx(%coord_4110, %lay_4111) : (!cute.coord<"(0,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,16)">
          %iter_4113 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4114 = cute.add_offset(%iter_4113, %idx_4112) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4115 = cute.make_view(%tup_4114) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4116 = cute.get_iter(%view_4115) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4117, %e1_4118 = cute.get_leaves(%iter_4116) : !cute.int_tuple<"(?,?{div=2})">
          %1879 = cute.get_scalars(%e0_4117) : !cute.int_tuple<"?">
          %1880 = cute.get_scalars(%e1_4118) : !cute.int_tuple<"?{div=2}">
          %iter_4119 = cute.get_iter(%view_4115) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4120, %e1_4121 = cute.get_leaves(%iter_4119) : !cute.int_tuple<"(?,?{div=2})">
          %1881 = cute.get_scalars(%e0_4120) : !cute.int_tuple<"?">
          %1882 = cute.get_scalars(%e1_4121) : !cute.int_tuple<"?{div=2}">
          %iter_4122 = cute.get_iter(%view_4115) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4123, %e1_4124 = cute.get_leaves(%iter_4122) : !cute.int_tuple<"(?,?{div=2})">
          %1883 = cute.get_scalars(%e0_4123) : !cute.int_tuple<"?">
          %1884 = cute.get_scalars(%e1_4124) : !cute.int_tuple<"?{div=2}">
          %coord_4125 = cute.make_coord(%e0_4108) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4126 = cute.make_coord(%e1_4124) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1885 = cute.get_scalars(%coord_4125) : !cute.coord<"?">
          %1886 = cute.get_scalars(%coord_4126) : !cute.coord<"?{div=2}">
          %true_4127 = arith.constant true
          %1887 = arith.cmpi slt, %1885, %1886 : i32
          %1888 = arith.andi %true_4127, %1887 : i1
          %lay_4128 = cute.get_layout(%1870) : !memref_rmem_f32_1
          %1889 = cute.get_shape(%lay_4128) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4129, %e1_4130, %e2_4131, %e3_4132 = cute.get_leaves(%1889) : !cute.shape<"((2,2),1,8)">
          %1890 = cute.get_stride(%lay_4128) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4133, %e1_4134, %e2_4135, %e3_4136 = cute.get_leaves(%1890) : !cute.stride<"((1,2),0,4)">
          %1891 = scf.if %1888 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1870) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,2)">
            cute.memref.store(%1870, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,2)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1870) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1870 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1870) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1870) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1870 : !memref_rmem_f32_1
          }
          %iter_4137 = cute.get_iter(%1891) : !memref_rmem_f32_1
          %lay_4138 = cute.get_layout(%1891) : !memref_rmem_f32_1
          %1892 = cute.get_shape(%lay_4138) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4139, %e1_4140, %e2_4141, %e3_4142 = cute.get_leaves(%1892) : !cute.shape<"((2,2),1,8)">
          %1893 = cute.get_stride(%lay_4138) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4143, %e1_4144, %e2_4145, %e3_4146 = cute.get_leaves(%1893) : !cute.stride<"((1,2),0,4)">
          %iter_4147 = cute.get_iter(%1891) : !memref_rmem_f32_1
          %iter_4148 = cute.get_iter(%1891) : !memref_rmem_f32_1
          %coord_4149 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_4150 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4151 = cute.crd2idx(%coord_4149, %lay_4150) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_4152 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4153 = cute.add_offset(%iter_4152, %idx_4151) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4154 = cute.make_view(%tup_4153) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4155 = cute.get_iter(%view_4154) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4156, %e1_4157 = cute.get_leaves(%iter_4155) : !cute.int_tuple<"(?,?{div=2})">
          %1894 = cute.get_scalars(%e0_4156) : !cute.int_tuple<"?">
          %1895 = cute.get_scalars(%e1_4157) : !cute.int_tuple<"?{div=2}">
          %iter_4158 = cute.get_iter(%view_4154) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4159, %e1_4160 = cute.get_leaves(%iter_4158) : !cute.int_tuple<"(?,?{div=2})">
          %1896 = cute.get_scalars(%e0_4159) : !cute.int_tuple<"?">
          %1897 = cute.get_scalars(%e1_4160) : !cute.int_tuple<"?{div=2}">
          %iter_4161 = cute.get_iter(%view_4154) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4162, %e1_4163 = cute.get_leaves(%iter_4161) : !cute.int_tuple<"(?,?{div=2})">
          %1898 = cute.get_scalars(%e0_4162) : !cute.int_tuple<"?">
          %1899 = cute.get_scalars(%e1_4163) : !cute.int_tuple<"?{div=2}">
          %coord_4164 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
          %lay_4165 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4166 = cute.crd2idx(%coord_4164, %lay_4165) : (!cute.coord<"(0,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,24)">
          %iter_4167 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4168 = cute.add_offset(%iter_4167, %idx_4166) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4169 = cute.make_view(%tup_4168) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4170 = cute.get_iter(%view_4169) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4171, %e1_4172 = cute.get_leaves(%iter_4170) : !cute.int_tuple<"(?,?{div=2})">
          %1900 = cute.get_scalars(%e0_4171) : !cute.int_tuple<"?">
          %1901 = cute.get_scalars(%e1_4172) : !cute.int_tuple<"?{div=2}">
          %iter_4173 = cute.get_iter(%view_4169) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4174, %e1_4175 = cute.get_leaves(%iter_4173) : !cute.int_tuple<"(?,?{div=2})">
          %1902 = cute.get_scalars(%e0_4174) : !cute.int_tuple<"?">
          %1903 = cute.get_scalars(%e1_4175) : !cute.int_tuple<"?{div=2}">
          %iter_4176 = cute.get_iter(%view_4169) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4177, %e1_4178 = cute.get_leaves(%iter_4176) : !cute.int_tuple<"(?,?{div=2})">
          %1904 = cute.get_scalars(%e0_4177) : !cute.int_tuple<"?">
          %1905 = cute.get_scalars(%e1_4178) : !cute.int_tuple<"?{div=2}">
          %coord_4179 = cute.make_coord(%e0_4162) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4180 = cute.make_coord(%e1_4178) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1906 = cute.get_scalars(%coord_4179) : !cute.coord<"?">
          %1907 = cute.get_scalars(%coord_4180) : !cute.coord<"?{div=2}">
          %true_4181 = arith.constant true
          %1908 = arith.cmpi slt, %1906, %1907 : i32
          %1909 = arith.andi %true_4181, %1908 : i1
          %lay_4182 = cute.get_layout(%1891) : !memref_rmem_f32_1
          %1910 = cute.get_shape(%lay_4182) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4183, %e1_4184, %e2_4185, %e3_4186 = cute.get_leaves(%1910) : !cute.shape<"((2,2),1,8)">
          %1911 = cute.get_stride(%lay_4182) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4187, %e1_4188, %e2_4189, %e3_4190 = cute.get_leaves(%1911) : !cute.stride<"((1,2),0,4)">
          %1912 = scf.if %1909 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1891) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,3)">
            cute.memref.store(%1891, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,3)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1891) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1891 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1891) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1891) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1891 : !memref_rmem_f32_1
          }
          %iter_4191 = cute.get_iter(%1912) : !memref_rmem_f32_1
          %lay_4192 = cute.get_layout(%1912) : !memref_rmem_f32_1
          %1913 = cute.get_shape(%lay_4192) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4193, %e1_4194, %e2_4195, %e3_4196 = cute.get_leaves(%1913) : !cute.shape<"((2,2),1,8)">
          %1914 = cute.get_stride(%lay_4192) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4197, %e1_4198, %e2_4199, %e3_4200 = cute.get_leaves(%1914) : !cute.stride<"((1,2),0,4)">
          %iter_4201 = cute.get_iter(%1912) : !memref_rmem_f32_1
          %iter_4202 = cute.get_iter(%1912) : !memref_rmem_f32_1
          %coord_4203 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_4204 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4205 = cute.crd2idx(%coord_4203, %lay_4204) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_4206 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4207 = cute.add_offset(%iter_4206, %idx_4205) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4208 = cute.make_view(%tup_4207) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4209 = cute.get_iter(%view_4208) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4210, %e1_4211 = cute.get_leaves(%iter_4209) : !cute.int_tuple<"(?,?{div=2})">
          %1915 = cute.get_scalars(%e0_4210) : !cute.int_tuple<"?">
          %1916 = cute.get_scalars(%e1_4211) : !cute.int_tuple<"?{div=2}">
          %iter_4212 = cute.get_iter(%view_4208) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4213, %e1_4214 = cute.get_leaves(%iter_4212) : !cute.int_tuple<"(?,?{div=2})">
          %1917 = cute.get_scalars(%e0_4213) : !cute.int_tuple<"?">
          %1918 = cute.get_scalars(%e1_4214) : !cute.int_tuple<"?{div=2}">
          %iter_4215 = cute.get_iter(%view_4208) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4216, %e1_4217 = cute.get_leaves(%iter_4215) : !cute.int_tuple<"(?,?{div=2})">
          %1919 = cute.get_scalars(%e0_4216) : !cute.int_tuple<"?">
          %1920 = cute.get_scalars(%e1_4217) : !cute.int_tuple<"?{div=2}">
          %coord_4218 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
          %lay_4219 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4220 = cute.crd2idx(%coord_4218, %lay_4219) : (!cute.coord<"(0,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,32)">
          %iter_4221 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4222 = cute.add_offset(%iter_4221, %idx_4220) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4223 = cute.make_view(%tup_4222) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4224 = cute.get_iter(%view_4223) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4225, %e1_4226 = cute.get_leaves(%iter_4224) : !cute.int_tuple<"(?,?{div=2})">
          %1921 = cute.get_scalars(%e0_4225) : !cute.int_tuple<"?">
          %1922 = cute.get_scalars(%e1_4226) : !cute.int_tuple<"?{div=2}">
          %iter_4227 = cute.get_iter(%view_4223) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4228, %e1_4229 = cute.get_leaves(%iter_4227) : !cute.int_tuple<"(?,?{div=2})">
          %1923 = cute.get_scalars(%e0_4228) : !cute.int_tuple<"?">
          %1924 = cute.get_scalars(%e1_4229) : !cute.int_tuple<"?{div=2}">
          %iter_4230 = cute.get_iter(%view_4223) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4231, %e1_4232 = cute.get_leaves(%iter_4230) : !cute.int_tuple<"(?,?{div=2})">
          %1925 = cute.get_scalars(%e0_4231) : !cute.int_tuple<"?">
          %1926 = cute.get_scalars(%e1_4232) : !cute.int_tuple<"?{div=2}">
          %coord_4233 = cute.make_coord(%e0_4216) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4234 = cute.make_coord(%e1_4232) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1927 = cute.get_scalars(%coord_4233) : !cute.coord<"?">
          %1928 = cute.get_scalars(%coord_4234) : !cute.coord<"?{div=2}">
          %true_4235 = arith.constant true
          %1929 = arith.cmpi slt, %1927, %1928 : i32
          %1930 = arith.andi %true_4235, %1929 : i1
          %lay_4236 = cute.get_layout(%1912) : !memref_rmem_f32_1
          %1931 = cute.get_shape(%lay_4236) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4237, %e1_4238, %e2_4239, %e3_4240 = cute.get_leaves(%1931) : !cute.shape<"((2,2),1,8)">
          %1932 = cute.get_stride(%lay_4236) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4241, %e1_4242, %e2_4243, %e3_4244 = cute.get_leaves(%1932) : !cute.stride<"((1,2),0,4)">
          %1933 = scf.if %1930 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1912) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,4)">
            cute.memref.store(%1912, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,4)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1912) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1912 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1912) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1912) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1912 : !memref_rmem_f32_1
          }
          %iter_4245 = cute.get_iter(%1933) : !memref_rmem_f32_1
          %lay_4246 = cute.get_layout(%1933) : !memref_rmem_f32_1
          %1934 = cute.get_shape(%lay_4246) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4247, %e1_4248, %e2_4249, %e3_4250 = cute.get_leaves(%1934) : !cute.shape<"((2,2),1,8)">
          %1935 = cute.get_stride(%lay_4246) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4251, %e1_4252, %e2_4253, %e3_4254 = cute.get_leaves(%1935) : !cute.stride<"((1,2),0,4)">
          %iter_4255 = cute.get_iter(%1933) : !memref_rmem_f32_1
          %iter_4256 = cute.get_iter(%1933) : !memref_rmem_f32_1
          %coord_4257 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_4258 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4259 = cute.crd2idx(%coord_4257, %lay_4258) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_4260 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4261 = cute.add_offset(%iter_4260, %idx_4259) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4262 = cute.make_view(%tup_4261) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4263 = cute.get_iter(%view_4262) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4264, %e1_4265 = cute.get_leaves(%iter_4263) : !cute.int_tuple<"(?,?{div=2})">
          %1936 = cute.get_scalars(%e0_4264) : !cute.int_tuple<"?">
          %1937 = cute.get_scalars(%e1_4265) : !cute.int_tuple<"?{div=2}">
          %iter_4266 = cute.get_iter(%view_4262) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4267, %e1_4268 = cute.get_leaves(%iter_4266) : !cute.int_tuple<"(?,?{div=2})">
          %1938 = cute.get_scalars(%e0_4267) : !cute.int_tuple<"?">
          %1939 = cute.get_scalars(%e1_4268) : !cute.int_tuple<"?{div=2}">
          %iter_4269 = cute.get_iter(%view_4262) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4270, %e1_4271 = cute.get_leaves(%iter_4269) : !cute.int_tuple<"(?,?{div=2})">
          %1940 = cute.get_scalars(%e0_4270) : !cute.int_tuple<"?">
          %1941 = cute.get_scalars(%e1_4271) : !cute.int_tuple<"?{div=2}">
          %coord_4272 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
          %lay_4273 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4274 = cute.crd2idx(%coord_4272, %lay_4273) : (!cute.coord<"(0,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,40)">
          %iter_4275 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4276 = cute.add_offset(%iter_4275, %idx_4274) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4277 = cute.make_view(%tup_4276) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4278 = cute.get_iter(%view_4277) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4279, %e1_4280 = cute.get_leaves(%iter_4278) : !cute.int_tuple<"(?,?{div=2})">
          %1942 = cute.get_scalars(%e0_4279) : !cute.int_tuple<"?">
          %1943 = cute.get_scalars(%e1_4280) : !cute.int_tuple<"?{div=2}">
          %iter_4281 = cute.get_iter(%view_4277) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4282, %e1_4283 = cute.get_leaves(%iter_4281) : !cute.int_tuple<"(?,?{div=2})">
          %1944 = cute.get_scalars(%e0_4282) : !cute.int_tuple<"?">
          %1945 = cute.get_scalars(%e1_4283) : !cute.int_tuple<"?{div=2}">
          %iter_4284 = cute.get_iter(%view_4277) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4285, %e1_4286 = cute.get_leaves(%iter_4284) : !cute.int_tuple<"(?,?{div=2})">
          %1946 = cute.get_scalars(%e0_4285) : !cute.int_tuple<"?">
          %1947 = cute.get_scalars(%e1_4286) : !cute.int_tuple<"?{div=2}">
          %coord_4287 = cute.make_coord(%e0_4270) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4288 = cute.make_coord(%e1_4286) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1948 = cute.get_scalars(%coord_4287) : !cute.coord<"?">
          %1949 = cute.get_scalars(%coord_4288) : !cute.coord<"?{div=2}">
          %true_4289 = arith.constant true
          %1950 = arith.cmpi slt, %1948, %1949 : i32
          %1951 = arith.andi %true_4289, %1950 : i1
          %lay_4290 = cute.get_layout(%1933) : !memref_rmem_f32_1
          %1952 = cute.get_shape(%lay_4290) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4291, %e1_4292, %e2_4293, %e3_4294 = cute.get_leaves(%1952) : !cute.shape<"((2,2),1,8)">
          %1953 = cute.get_stride(%lay_4290) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4295, %e1_4296, %e2_4297, %e3_4298 = cute.get_leaves(%1953) : !cute.stride<"((1,2),0,4)">
          %1954 = scf.if %1951 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1933) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,5)">
            cute.memref.store(%1933, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,5)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1933) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1933 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1933) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1933) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1933 : !memref_rmem_f32_1
          }
          %iter_4299 = cute.get_iter(%1954) : !memref_rmem_f32_1
          %lay_4300 = cute.get_layout(%1954) : !memref_rmem_f32_1
          %1955 = cute.get_shape(%lay_4300) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4301, %e1_4302, %e2_4303, %e3_4304 = cute.get_leaves(%1955) : !cute.shape<"((2,2),1,8)">
          %1956 = cute.get_stride(%lay_4300) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4305, %e1_4306, %e2_4307, %e3_4308 = cute.get_leaves(%1956) : !cute.stride<"((1,2),0,4)">
          %iter_4309 = cute.get_iter(%1954) : !memref_rmem_f32_1
          %iter_4310 = cute.get_iter(%1954) : !memref_rmem_f32_1
          %coord_4311 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_4312 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4313 = cute.crd2idx(%coord_4311, %lay_4312) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_4314 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4315 = cute.add_offset(%iter_4314, %idx_4313) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4316 = cute.make_view(%tup_4315) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4317 = cute.get_iter(%view_4316) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4318, %e1_4319 = cute.get_leaves(%iter_4317) : !cute.int_tuple<"(?,?{div=2})">
          %1957 = cute.get_scalars(%e0_4318) : !cute.int_tuple<"?">
          %1958 = cute.get_scalars(%e1_4319) : !cute.int_tuple<"?{div=2}">
          %iter_4320 = cute.get_iter(%view_4316) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4321, %e1_4322 = cute.get_leaves(%iter_4320) : !cute.int_tuple<"(?,?{div=2})">
          %1959 = cute.get_scalars(%e0_4321) : !cute.int_tuple<"?">
          %1960 = cute.get_scalars(%e1_4322) : !cute.int_tuple<"?{div=2}">
          %iter_4323 = cute.get_iter(%view_4316) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4324, %e1_4325 = cute.get_leaves(%iter_4323) : !cute.int_tuple<"(?,?{div=2})">
          %1961 = cute.get_scalars(%e0_4324) : !cute.int_tuple<"?">
          %1962 = cute.get_scalars(%e1_4325) : !cute.int_tuple<"?{div=2}">
          %coord_4326 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
          %lay_4327 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4328 = cute.crd2idx(%coord_4326, %lay_4327) : (!cute.coord<"(0,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,48)">
          %iter_4329 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4330 = cute.add_offset(%iter_4329, %idx_4328) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4331 = cute.make_view(%tup_4330) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4332 = cute.get_iter(%view_4331) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4333, %e1_4334 = cute.get_leaves(%iter_4332) : !cute.int_tuple<"(?,?{div=2})">
          %1963 = cute.get_scalars(%e0_4333) : !cute.int_tuple<"?">
          %1964 = cute.get_scalars(%e1_4334) : !cute.int_tuple<"?{div=2}">
          %iter_4335 = cute.get_iter(%view_4331) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4336, %e1_4337 = cute.get_leaves(%iter_4335) : !cute.int_tuple<"(?,?{div=2})">
          %1965 = cute.get_scalars(%e0_4336) : !cute.int_tuple<"?">
          %1966 = cute.get_scalars(%e1_4337) : !cute.int_tuple<"?{div=2}">
          %iter_4338 = cute.get_iter(%view_4331) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4339, %e1_4340 = cute.get_leaves(%iter_4338) : !cute.int_tuple<"(?,?{div=2})">
          %1967 = cute.get_scalars(%e0_4339) : !cute.int_tuple<"?">
          %1968 = cute.get_scalars(%e1_4340) : !cute.int_tuple<"?{div=2}">
          %coord_4341 = cute.make_coord(%e0_4324) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4342 = cute.make_coord(%e1_4340) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1969 = cute.get_scalars(%coord_4341) : !cute.coord<"?">
          %1970 = cute.get_scalars(%coord_4342) : !cute.coord<"?{div=2}">
          %true_4343 = arith.constant true
          %1971 = arith.cmpi slt, %1969, %1970 : i32
          %1972 = arith.andi %true_4343, %1971 : i1
          %lay_4344 = cute.get_layout(%1954) : !memref_rmem_f32_1
          %1973 = cute.get_shape(%lay_4344) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4345, %e1_4346, %e2_4347, %e3_4348 = cute.get_leaves(%1973) : !cute.shape<"((2,2),1,8)">
          %1974 = cute.get_stride(%lay_4344) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4349, %e1_4350, %e2_4351, %e3_4352 = cute.get_leaves(%1974) : !cute.stride<"((1,2),0,4)">
          %1975 = scf.if %1972 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1954) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,6)">
            cute.memref.store(%1954, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,6)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1954) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1954 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1954) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1954) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1954 : !memref_rmem_f32_1
          }
          %iter_4353 = cute.get_iter(%1975) : !memref_rmem_f32_1
          %lay_4354 = cute.get_layout(%1975) : !memref_rmem_f32_1
          %1976 = cute.get_shape(%lay_4354) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4355, %e1_4356, %e2_4357, %e3_4358 = cute.get_leaves(%1976) : !cute.shape<"((2,2),1,8)">
          %1977 = cute.get_stride(%lay_4354) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4359, %e1_4360, %e2_4361, %e3_4362 = cute.get_leaves(%1977) : !cute.stride<"((1,2),0,4)">
          %iter_4363 = cute.get_iter(%1975) : !memref_rmem_f32_1
          %iter_4364 = cute.get_iter(%1975) : !memref_rmem_f32_1
          %coord_4365 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_4366 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4367 = cute.crd2idx(%coord_4365, %lay_4366) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_4368 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4369 = cute.add_offset(%iter_4368, %idx_4367) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4370 = cute.make_view(%tup_4369) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4371 = cute.get_iter(%view_4370) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4372, %e1_4373 = cute.get_leaves(%iter_4371) : !cute.int_tuple<"(?,?{div=2})">
          %1978 = cute.get_scalars(%e0_4372) : !cute.int_tuple<"?">
          %1979 = cute.get_scalars(%e1_4373) : !cute.int_tuple<"?{div=2}">
          %iter_4374 = cute.get_iter(%view_4370) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4375, %e1_4376 = cute.get_leaves(%iter_4374) : !cute.int_tuple<"(?,?{div=2})">
          %1980 = cute.get_scalars(%e0_4375) : !cute.int_tuple<"?">
          %1981 = cute.get_scalars(%e1_4376) : !cute.int_tuple<"?{div=2}">
          %iter_4377 = cute.get_iter(%view_4370) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4378, %e1_4379 = cute.get_leaves(%iter_4377) : !cute.int_tuple<"(?,?{div=2})">
          %1982 = cute.get_scalars(%e0_4378) : !cute.int_tuple<"?">
          %1983 = cute.get_scalars(%e1_4379) : !cute.int_tuple<"?{div=2}">
          %coord_4380 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
          %lay_4381 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4382 = cute.crd2idx(%coord_4380, %lay_4381) : (!cute.coord<"(0,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,56)">
          %iter_4383 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4384 = cute.add_offset(%iter_4383, %idx_4382) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4385 = cute.make_view(%tup_4384) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4386 = cute.get_iter(%view_4385) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4387, %e1_4388 = cute.get_leaves(%iter_4386) : !cute.int_tuple<"(?,?{div=2})">
          %1984 = cute.get_scalars(%e0_4387) : !cute.int_tuple<"?">
          %1985 = cute.get_scalars(%e1_4388) : !cute.int_tuple<"?{div=2}">
          %iter_4389 = cute.get_iter(%view_4385) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4390, %e1_4391 = cute.get_leaves(%iter_4389) : !cute.int_tuple<"(?,?{div=2})">
          %1986 = cute.get_scalars(%e0_4390) : !cute.int_tuple<"?">
          %1987 = cute.get_scalars(%e1_4391) : !cute.int_tuple<"?{div=2}">
          %iter_4392 = cute.get_iter(%view_4385) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4393, %e1_4394 = cute.get_leaves(%iter_4392) : !cute.int_tuple<"(?,?{div=2})">
          %1988 = cute.get_scalars(%e0_4393) : !cute.int_tuple<"?">
          %1989 = cute.get_scalars(%e1_4394) : !cute.int_tuple<"?{div=2}">
          %coord_4395 = cute.make_coord(%e0_4378) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4396 = cute.make_coord(%e1_4394) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %1990 = cute.get_scalars(%coord_4395) : !cute.coord<"?">
          %1991 = cute.get_scalars(%coord_4396) : !cute.coord<"?{div=2}">
          %true_4397 = arith.constant true
          %1992 = arith.cmpi slt, %1990, %1991 : i32
          %1993 = arith.andi %true_4397, %1992 : i1
          %lay_4398 = cute.get_layout(%1975) : !memref_rmem_f32_1
          %1994 = cute.get_shape(%lay_4398) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4399, %e1_4400, %e2_4401, %e3_4402 = cute.get_leaves(%1994) : !cute.shape<"((2,2),1,8)">
          %1995 = cute.get_stride(%lay_4398) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4403, %e1_4404, %e2_4405, %e3_4406 = cute.get_leaves(%1995) : !cute.stride<"((1,2),0,4)">
          %1996 = scf.if %1993 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1975) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,0,7)">
            cute.memref.store(%1975, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(0,0,7)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1975) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1975 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1975) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1975) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1975 : !memref_rmem_f32_1
          }
          %iter_4407 = cute.get_iter(%1996) : !memref_rmem_f32_1
          %lay_4408 = cute.get_layout(%1996) : !memref_rmem_f32_1
          %1997 = cute.get_shape(%lay_4408) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4409, %e1_4410, %e2_4411, %e3_4412 = cute.get_leaves(%1997) : !cute.shape<"((2,2),1,8)">
          %1998 = cute.get_stride(%lay_4408) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4413, %e1_4414, %e2_4415, %e3_4416 = cute.get_leaves(%1998) : !cute.stride<"((1,2),0,4)">
          %iter_4417 = cute.get_iter(%1996) : !memref_rmem_f32_1
          %iter_4418 = cute.get_iter(%1996) : !memref_rmem_f32_1
          %int_tuple_4419 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4420 = cute.size(%int_tuple_4419) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4421 = cute.get_leaves(%sz_4420) : !cute.int_tuple<"1">
          %int_tuple_4422 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4423 = cute.size(%int_tuple_4422) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4424 = cute.get_leaves(%sz_4423) : !cute.int_tuple<"8">
          %coord_4425 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_4426 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4427 = cute.crd2idx(%coord_4425, %lay_4426) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_4428 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4429 = cute.add_offset(%iter_4428, %idx_4427) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4430 = cute.make_view(%tup_4429) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4431 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4432, %e1_4433 = cute.get_leaves(%iter_4431) : !cute.int_tuple<"(?,?)">
          %1999 = cute.get_scalars(%e0_4432) : !cute.int_tuple<"?">
          %2000 = cute.get_scalars(%e1_4433) : !cute.int_tuple<"?">
          %iter_4434 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4435, %e1_4436 = cute.get_leaves(%iter_4434) : !cute.int_tuple<"(?,?)">
          %2001 = cute.get_scalars(%e0_4435) : !cute.int_tuple<"?">
          %2002 = cute.get_scalars(%e1_4436) : !cute.int_tuple<"?">
          %iter_4437 = cute.get_iter(%view_4430) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4438, %e1_4439 = cute.get_leaves(%iter_4437) : !cute.int_tuple<"(?,?)">
          %2003 = cute.get_scalars(%e0_4438) : !cute.int_tuple<"?">
          %2004 = cute.get_scalars(%e1_4439) : !cute.int_tuple<"?">
          %coord_4440 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
          %lay_4441 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4442 = cute.crd2idx(%coord_4440, %lay_4441) : (!cute.coord<"(1,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,1)">
          %iter_4443 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4444 = cute.add_offset(%iter_4443, %idx_4442) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,1)">) -> !cute.int_tuple<"(?,?)">
          %view_4445 = cute.make_view(%tup_4444) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4446 = cute.get_iter(%view_4445) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4447, %e1_4448 = cute.get_leaves(%iter_4446) : !cute.int_tuple<"(?,?)">
          %2005 = cute.get_scalars(%e0_4447) : !cute.int_tuple<"?">
          %2006 = cute.get_scalars(%e1_4448) : !cute.int_tuple<"?">
          %iter_4449 = cute.get_iter(%view_4445) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4450, %e1_4451 = cute.get_leaves(%iter_4449) : !cute.int_tuple<"(?,?)">
          %2007 = cute.get_scalars(%e0_4450) : !cute.int_tuple<"?">
          %2008 = cute.get_scalars(%e1_4451) : !cute.int_tuple<"?">
          %iter_4452 = cute.get_iter(%view_4445) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4453, %e1_4454 = cute.get_leaves(%iter_4452) : !cute.int_tuple<"(?,?)">
          %2009 = cute.get_scalars(%e0_4453) : !cute.int_tuple<"?">
          %2010 = cute.get_scalars(%e1_4454) : !cute.int_tuple<"?">
          %coord_4455 = cute.make_coord(%e0_4438) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4456 = cute.make_coord(%e1_4454) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2011 = cute.get_scalars(%coord_4455) : !cute.coord<"?">
          %2012 = cute.get_scalars(%coord_4456) : !cute.coord<"?">
          %true_4457 = arith.constant true
          %2013 = arith.cmpi slt, %2011, %2012 : i32
          %2014 = arith.andi %true_4457, %2013 : i1
          %lay_4458 = cute.get_layout(%1996) : !memref_rmem_f32_1
          %2015 = cute.get_shape(%lay_4458) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4459, %e1_4460, %e2_4461, %e3_4462 = cute.get_leaves(%2015) : !cute.shape<"((2,2),1,8)">
          %2016 = cute.get_stride(%lay_4458) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4463, %e1_4464, %e2_4465, %e3_4466 = cute.get_leaves(%2016) : !cute.stride<"((1,2),0,4)">
          %2017 = scf.if %2014 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%1996) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,0)">
            cute.memref.store(%1996, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,0)">, f32) -> ()
            %lay_5793 = cute.get_layout(%1996) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1996 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%1996) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%1996) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %1996 : !memref_rmem_f32_1
          }
          %iter_4467 = cute.get_iter(%2017) : !memref_rmem_f32_1
          %lay_4468 = cute.get_layout(%2017) : !memref_rmem_f32_1
          %2018 = cute.get_shape(%lay_4468) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4469, %e1_4470, %e2_4471, %e3_4472 = cute.get_leaves(%2018) : !cute.shape<"((2,2),1,8)">
          %2019 = cute.get_stride(%lay_4468) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4473, %e1_4474, %e2_4475, %e3_4476 = cute.get_leaves(%2019) : !cute.stride<"((1,2),0,4)">
          %iter_4477 = cute.get_iter(%2017) : !memref_rmem_f32_1
          %iter_4478 = cute.get_iter(%2017) : !memref_rmem_f32_1
          %coord_4479 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_4480 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4481 = cute.crd2idx(%coord_4479, %lay_4480) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_4482 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4483 = cute.add_offset(%iter_4482, %idx_4481) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4484 = cute.make_view(%tup_4483) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4485 = cute.get_iter(%view_4484) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4486, %e1_4487 = cute.get_leaves(%iter_4485) : !cute.int_tuple<"(?,?)">
          %2020 = cute.get_scalars(%e0_4486) : !cute.int_tuple<"?">
          %2021 = cute.get_scalars(%e1_4487) : !cute.int_tuple<"?">
          %iter_4488 = cute.get_iter(%view_4484) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4489, %e1_4490 = cute.get_leaves(%iter_4488) : !cute.int_tuple<"(?,?)">
          %2022 = cute.get_scalars(%e0_4489) : !cute.int_tuple<"?">
          %2023 = cute.get_scalars(%e1_4490) : !cute.int_tuple<"?">
          %iter_4491 = cute.get_iter(%view_4484) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4492, %e1_4493 = cute.get_leaves(%iter_4491) : !cute.int_tuple<"(?,?)">
          %2024 = cute.get_scalars(%e0_4492) : !cute.int_tuple<"?">
          %2025 = cute.get_scalars(%e1_4493) : !cute.int_tuple<"?">
          %coord_4494 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
          %lay_4495 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4496 = cute.crd2idx(%coord_4494, %lay_4495) : (!cute.coord<"(1,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,9)">
          %iter_4497 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4498 = cute.add_offset(%iter_4497, %idx_4496) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,9)">) -> !cute.int_tuple<"(?,?)">
          %view_4499 = cute.make_view(%tup_4498) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4500 = cute.get_iter(%view_4499) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4501, %e1_4502 = cute.get_leaves(%iter_4500) : !cute.int_tuple<"(?,?)">
          %2026 = cute.get_scalars(%e0_4501) : !cute.int_tuple<"?">
          %2027 = cute.get_scalars(%e1_4502) : !cute.int_tuple<"?">
          %iter_4503 = cute.get_iter(%view_4499) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4504, %e1_4505 = cute.get_leaves(%iter_4503) : !cute.int_tuple<"(?,?)">
          %2028 = cute.get_scalars(%e0_4504) : !cute.int_tuple<"?">
          %2029 = cute.get_scalars(%e1_4505) : !cute.int_tuple<"?">
          %iter_4506 = cute.get_iter(%view_4499) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4507, %e1_4508 = cute.get_leaves(%iter_4506) : !cute.int_tuple<"(?,?)">
          %2030 = cute.get_scalars(%e0_4507) : !cute.int_tuple<"?">
          %2031 = cute.get_scalars(%e1_4508) : !cute.int_tuple<"?">
          %coord_4509 = cute.make_coord(%e0_4492) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4510 = cute.make_coord(%e1_4508) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2032 = cute.get_scalars(%coord_4509) : !cute.coord<"?">
          %2033 = cute.get_scalars(%coord_4510) : !cute.coord<"?">
          %true_4511 = arith.constant true
          %2034 = arith.cmpi slt, %2032, %2033 : i32
          %2035 = arith.andi %true_4511, %2034 : i1
          %lay_4512 = cute.get_layout(%2017) : !memref_rmem_f32_1
          %2036 = cute.get_shape(%lay_4512) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4513, %e1_4514, %e2_4515, %e3_4516 = cute.get_leaves(%2036) : !cute.shape<"((2,2),1,8)">
          %2037 = cute.get_stride(%lay_4512) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4517, %e1_4518, %e2_4519, %e3_4520 = cute.get_leaves(%2037) : !cute.stride<"((1,2),0,4)">
          %2038 = scf.if %2035 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2017) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,1)">
            cute.memref.store(%2017, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,1)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2017) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2017 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2017) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2017) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2017 : !memref_rmem_f32_1
          }
          %iter_4521 = cute.get_iter(%2038) : !memref_rmem_f32_1
          %lay_4522 = cute.get_layout(%2038) : !memref_rmem_f32_1
          %2039 = cute.get_shape(%lay_4522) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4523, %e1_4524, %e2_4525, %e3_4526 = cute.get_leaves(%2039) : !cute.shape<"((2,2),1,8)">
          %2040 = cute.get_stride(%lay_4522) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4527, %e1_4528, %e2_4529, %e3_4530 = cute.get_leaves(%2040) : !cute.stride<"((1,2),0,4)">
          %iter_4531 = cute.get_iter(%2038) : !memref_rmem_f32_1
          %iter_4532 = cute.get_iter(%2038) : !memref_rmem_f32_1
          %coord_4533 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_4534 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4535 = cute.crd2idx(%coord_4533, %lay_4534) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_4536 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4537 = cute.add_offset(%iter_4536, %idx_4535) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4538 = cute.make_view(%tup_4537) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4539 = cute.get_iter(%view_4538) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4540, %e1_4541 = cute.get_leaves(%iter_4539) : !cute.int_tuple<"(?,?)">
          %2041 = cute.get_scalars(%e0_4540) : !cute.int_tuple<"?">
          %2042 = cute.get_scalars(%e1_4541) : !cute.int_tuple<"?">
          %iter_4542 = cute.get_iter(%view_4538) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4543, %e1_4544 = cute.get_leaves(%iter_4542) : !cute.int_tuple<"(?,?)">
          %2043 = cute.get_scalars(%e0_4543) : !cute.int_tuple<"?">
          %2044 = cute.get_scalars(%e1_4544) : !cute.int_tuple<"?">
          %iter_4545 = cute.get_iter(%view_4538) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4546, %e1_4547 = cute.get_leaves(%iter_4545) : !cute.int_tuple<"(?,?)">
          %2045 = cute.get_scalars(%e0_4546) : !cute.int_tuple<"?">
          %2046 = cute.get_scalars(%e1_4547) : !cute.int_tuple<"?">
          %coord_4548 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
          %lay_4549 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4550 = cute.crd2idx(%coord_4548, %lay_4549) : (!cute.coord<"(1,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,17)">
          %iter_4551 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4552 = cute.add_offset(%iter_4551, %idx_4550) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,17)">) -> !cute.int_tuple<"(?,?)">
          %view_4553 = cute.make_view(%tup_4552) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4554 = cute.get_iter(%view_4553) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4555, %e1_4556 = cute.get_leaves(%iter_4554) : !cute.int_tuple<"(?,?)">
          %2047 = cute.get_scalars(%e0_4555) : !cute.int_tuple<"?">
          %2048 = cute.get_scalars(%e1_4556) : !cute.int_tuple<"?">
          %iter_4557 = cute.get_iter(%view_4553) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4558, %e1_4559 = cute.get_leaves(%iter_4557) : !cute.int_tuple<"(?,?)">
          %2049 = cute.get_scalars(%e0_4558) : !cute.int_tuple<"?">
          %2050 = cute.get_scalars(%e1_4559) : !cute.int_tuple<"?">
          %iter_4560 = cute.get_iter(%view_4553) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4561, %e1_4562 = cute.get_leaves(%iter_4560) : !cute.int_tuple<"(?,?)">
          %2051 = cute.get_scalars(%e0_4561) : !cute.int_tuple<"?">
          %2052 = cute.get_scalars(%e1_4562) : !cute.int_tuple<"?">
          %coord_4563 = cute.make_coord(%e0_4546) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4564 = cute.make_coord(%e1_4562) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2053 = cute.get_scalars(%coord_4563) : !cute.coord<"?">
          %2054 = cute.get_scalars(%coord_4564) : !cute.coord<"?">
          %true_4565 = arith.constant true
          %2055 = arith.cmpi slt, %2053, %2054 : i32
          %2056 = arith.andi %true_4565, %2055 : i1
          %lay_4566 = cute.get_layout(%2038) : !memref_rmem_f32_1
          %2057 = cute.get_shape(%lay_4566) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4567, %e1_4568, %e2_4569, %e3_4570 = cute.get_leaves(%2057) : !cute.shape<"((2,2),1,8)">
          %2058 = cute.get_stride(%lay_4566) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4571, %e1_4572, %e2_4573, %e3_4574 = cute.get_leaves(%2058) : !cute.stride<"((1,2),0,4)">
          %2059 = scf.if %2056 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2038) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,2)">
            cute.memref.store(%2038, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,2)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2038) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2038 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2038) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2038) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2038 : !memref_rmem_f32_1
          }
          %iter_4575 = cute.get_iter(%2059) : !memref_rmem_f32_1
          %lay_4576 = cute.get_layout(%2059) : !memref_rmem_f32_1
          %2060 = cute.get_shape(%lay_4576) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4577, %e1_4578, %e2_4579, %e3_4580 = cute.get_leaves(%2060) : !cute.shape<"((2,2),1,8)">
          %2061 = cute.get_stride(%lay_4576) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4581, %e1_4582, %e2_4583, %e3_4584 = cute.get_leaves(%2061) : !cute.stride<"((1,2),0,4)">
          %iter_4585 = cute.get_iter(%2059) : !memref_rmem_f32_1
          %iter_4586 = cute.get_iter(%2059) : !memref_rmem_f32_1
          %coord_4587 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_4588 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4589 = cute.crd2idx(%coord_4587, %lay_4588) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_4590 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4591 = cute.add_offset(%iter_4590, %idx_4589) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4592 = cute.make_view(%tup_4591) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4593 = cute.get_iter(%view_4592) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4594, %e1_4595 = cute.get_leaves(%iter_4593) : !cute.int_tuple<"(?,?)">
          %2062 = cute.get_scalars(%e0_4594) : !cute.int_tuple<"?">
          %2063 = cute.get_scalars(%e1_4595) : !cute.int_tuple<"?">
          %iter_4596 = cute.get_iter(%view_4592) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4597, %e1_4598 = cute.get_leaves(%iter_4596) : !cute.int_tuple<"(?,?)">
          %2064 = cute.get_scalars(%e0_4597) : !cute.int_tuple<"?">
          %2065 = cute.get_scalars(%e1_4598) : !cute.int_tuple<"?">
          %iter_4599 = cute.get_iter(%view_4592) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4600, %e1_4601 = cute.get_leaves(%iter_4599) : !cute.int_tuple<"(?,?)">
          %2066 = cute.get_scalars(%e0_4600) : !cute.int_tuple<"?">
          %2067 = cute.get_scalars(%e1_4601) : !cute.int_tuple<"?">
          %coord_4602 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
          %lay_4603 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4604 = cute.crd2idx(%coord_4602, %lay_4603) : (!cute.coord<"(1,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,25)">
          %iter_4605 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4606 = cute.add_offset(%iter_4605, %idx_4604) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,25)">) -> !cute.int_tuple<"(?,?)">
          %view_4607 = cute.make_view(%tup_4606) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4608 = cute.get_iter(%view_4607) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4609, %e1_4610 = cute.get_leaves(%iter_4608) : !cute.int_tuple<"(?,?)">
          %2068 = cute.get_scalars(%e0_4609) : !cute.int_tuple<"?">
          %2069 = cute.get_scalars(%e1_4610) : !cute.int_tuple<"?">
          %iter_4611 = cute.get_iter(%view_4607) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4612, %e1_4613 = cute.get_leaves(%iter_4611) : !cute.int_tuple<"(?,?)">
          %2070 = cute.get_scalars(%e0_4612) : !cute.int_tuple<"?">
          %2071 = cute.get_scalars(%e1_4613) : !cute.int_tuple<"?">
          %iter_4614 = cute.get_iter(%view_4607) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4615, %e1_4616 = cute.get_leaves(%iter_4614) : !cute.int_tuple<"(?,?)">
          %2072 = cute.get_scalars(%e0_4615) : !cute.int_tuple<"?">
          %2073 = cute.get_scalars(%e1_4616) : !cute.int_tuple<"?">
          %coord_4617 = cute.make_coord(%e0_4600) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4618 = cute.make_coord(%e1_4616) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2074 = cute.get_scalars(%coord_4617) : !cute.coord<"?">
          %2075 = cute.get_scalars(%coord_4618) : !cute.coord<"?">
          %true_4619 = arith.constant true
          %2076 = arith.cmpi slt, %2074, %2075 : i32
          %2077 = arith.andi %true_4619, %2076 : i1
          %lay_4620 = cute.get_layout(%2059) : !memref_rmem_f32_1
          %2078 = cute.get_shape(%lay_4620) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4621, %e1_4622, %e2_4623, %e3_4624 = cute.get_leaves(%2078) : !cute.shape<"((2,2),1,8)">
          %2079 = cute.get_stride(%lay_4620) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4625, %e1_4626, %e2_4627, %e3_4628 = cute.get_leaves(%2079) : !cute.stride<"((1,2),0,4)">
          %2080 = scf.if %2077 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2059) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,3)">
            cute.memref.store(%2059, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,3)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2059) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2059 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2059) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2059) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2059 : !memref_rmem_f32_1
          }
          %iter_4629 = cute.get_iter(%2080) : !memref_rmem_f32_1
          %lay_4630 = cute.get_layout(%2080) : !memref_rmem_f32_1
          %2081 = cute.get_shape(%lay_4630) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4631, %e1_4632, %e2_4633, %e3_4634 = cute.get_leaves(%2081) : !cute.shape<"((2,2),1,8)">
          %2082 = cute.get_stride(%lay_4630) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4635, %e1_4636, %e2_4637, %e3_4638 = cute.get_leaves(%2082) : !cute.stride<"((1,2),0,4)">
          %iter_4639 = cute.get_iter(%2080) : !memref_rmem_f32_1
          %iter_4640 = cute.get_iter(%2080) : !memref_rmem_f32_1
          %coord_4641 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_4642 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4643 = cute.crd2idx(%coord_4641, %lay_4642) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_4644 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4645 = cute.add_offset(%iter_4644, %idx_4643) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4646 = cute.make_view(%tup_4645) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4647 = cute.get_iter(%view_4646) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4648, %e1_4649 = cute.get_leaves(%iter_4647) : !cute.int_tuple<"(?,?)">
          %2083 = cute.get_scalars(%e0_4648) : !cute.int_tuple<"?">
          %2084 = cute.get_scalars(%e1_4649) : !cute.int_tuple<"?">
          %iter_4650 = cute.get_iter(%view_4646) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4651, %e1_4652 = cute.get_leaves(%iter_4650) : !cute.int_tuple<"(?,?)">
          %2085 = cute.get_scalars(%e0_4651) : !cute.int_tuple<"?">
          %2086 = cute.get_scalars(%e1_4652) : !cute.int_tuple<"?">
          %iter_4653 = cute.get_iter(%view_4646) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4654, %e1_4655 = cute.get_leaves(%iter_4653) : !cute.int_tuple<"(?,?)">
          %2087 = cute.get_scalars(%e0_4654) : !cute.int_tuple<"?">
          %2088 = cute.get_scalars(%e1_4655) : !cute.int_tuple<"?">
          %coord_4656 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
          %lay_4657 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4658 = cute.crd2idx(%coord_4656, %lay_4657) : (!cute.coord<"(1,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,33)">
          %iter_4659 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4660 = cute.add_offset(%iter_4659, %idx_4658) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,33)">) -> !cute.int_tuple<"(?,?)">
          %view_4661 = cute.make_view(%tup_4660) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4662 = cute.get_iter(%view_4661) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4663, %e1_4664 = cute.get_leaves(%iter_4662) : !cute.int_tuple<"(?,?)">
          %2089 = cute.get_scalars(%e0_4663) : !cute.int_tuple<"?">
          %2090 = cute.get_scalars(%e1_4664) : !cute.int_tuple<"?">
          %iter_4665 = cute.get_iter(%view_4661) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4666, %e1_4667 = cute.get_leaves(%iter_4665) : !cute.int_tuple<"(?,?)">
          %2091 = cute.get_scalars(%e0_4666) : !cute.int_tuple<"?">
          %2092 = cute.get_scalars(%e1_4667) : !cute.int_tuple<"?">
          %iter_4668 = cute.get_iter(%view_4661) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4669, %e1_4670 = cute.get_leaves(%iter_4668) : !cute.int_tuple<"(?,?)">
          %2093 = cute.get_scalars(%e0_4669) : !cute.int_tuple<"?">
          %2094 = cute.get_scalars(%e1_4670) : !cute.int_tuple<"?">
          %coord_4671 = cute.make_coord(%e0_4654) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4672 = cute.make_coord(%e1_4670) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2095 = cute.get_scalars(%coord_4671) : !cute.coord<"?">
          %2096 = cute.get_scalars(%coord_4672) : !cute.coord<"?">
          %true_4673 = arith.constant true
          %2097 = arith.cmpi slt, %2095, %2096 : i32
          %2098 = arith.andi %true_4673, %2097 : i1
          %lay_4674 = cute.get_layout(%2080) : !memref_rmem_f32_1
          %2099 = cute.get_shape(%lay_4674) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4675, %e1_4676, %e2_4677, %e3_4678 = cute.get_leaves(%2099) : !cute.shape<"((2,2),1,8)">
          %2100 = cute.get_stride(%lay_4674) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4679, %e1_4680, %e2_4681, %e3_4682 = cute.get_leaves(%2100) : !cute.stride<"((1,2),0,4)">
          %2101 = scf.if %2098 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2080) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,4)">
            cute.memref.store(%2080, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,4)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2080) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2080 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2080) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2080) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2080 : !memref_rmem_f32_1
          }
          %iter_4683 = cute.get_iter(%2101) : !memref_rmem_f32_1
          %lay_4684 = cute.get_layout(%2101) : !memref_rmem_f32_1
          %2102 = cute.get_shape(%lay_4684) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4685, %e1_4686, %e2_4687, %e3_4688 = cute.get_leaves(%2102) : !cute.shape<"((2,2),1,8)">
          %2103 = cute.get_stride(%lay_4684) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4689, %e1_4690, %e2_4691, %e3_4692 = cute.get_leaves(%2103) : !cute.stride<"((1,2),0,4)">
          %iter_4693 = cute.get_iter(%2101) : !memref_rmem_f32_1
          %iter_4694 = cute.get_iter(%2101) : !memref_rmem_f32_1
          %coord_4695 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_4696 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4697 = cute.crd2idx(%coord_4695, %lay_4696) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_4698 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4699 = cute.add_offset(%iter_4698, %idx_4697) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4700 = cute.make_view(%tup_4699) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4701 = cute.get_iter(%view_4700) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4702, %e1_4703 = cute.get_leaves(%iter_4701) : !cute.int_tuple<"(?,?)">
          %2104 = cute.get_scalars(%e0_4702) : !cute.int_tuple<"?">
          %2105 = cute.get_scalars(%e1_4703) : !cute.int_tuple<"?">
          %iter_4704 = cute.get_iter(%view_4700) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4705, %e1_4706 = cute.get_leaves(%iter_4704) : !cute.int_tuple<"(?,?)">
          %2106 = cute.get_scalars(%e0_4705) : !cute.int_tuple<"?">
          %2107 = cute.get_scalars(%e1_4706) : !cute.int_tuple<"?">
          %iter_4707 = cute.get_iter(%view_4700) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4708, %e1_4709 = cute.get_leaves(%iter_4707) : !cute.int_tuple<"(?,?)">
          %2108 = cute.get_scalars(%e0_4708) : !cute.int_tuple<"?">
          %2109 = cute.get_scalars(%e1_4709) : !cute.int_tuple<"?">
          %coord_4710 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
          %lay_4711 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4712 = cute.crd2idx(%coord_4710, %lay_4711) : (!cute.coord<"(1,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,41)">
          %iter_4713 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4714 = cute.add_offset(%iter_4713, %idx_4712) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,41)">) -> !cute.int_tuple<"(?,?)">
          %view_4715 = cute.make_view(%tup_4714) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4716 = cute.get_iter(%view_4715) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4717, %e1_4718 = cute.get_leaves(%iter_4716) : !cute.int_tuple<"(?,?)">
          %2110 = cute.get_scalars(%e0_4717) : !cute.int_tuple<"?">
          %2111 = cute.get_scalars(%e1_4718) : !cute.int_tuple<"?">
          %iter_4719 = cute.get_iter(%view_4715) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4720, %e1_4721 = cute.get_leaves(%iter_4719) : !cute.int_tuple<"(?,?)">
          %2112 = cute.get_scalars(%e0_4720) : !cute.int_tuple<"?">
          %2113 = cute.get_scalars(%e1_4721) : !cute.int_tuple<"?">
          %iter_4722 = cute.get_iter(%view_4715) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4723, %e1_4724 = cute.get_leaves(%iter_4722) : !cute.int_tuple<"(?,?)">
          %2114 = cute.get_scalars(%e0_4723) : !cute.int_tuple<"?">
          %2115 = cute.get_scalars(%e1_4724) : !cute.int_tuple<"?">
          %coord_4725 = cute.make_coord(%e0_4708) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4726 = cute.make_coord(%e1_4724) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2116 = cute.get_scalars(%coord_4725) : !cute.coord<"?">
          %2117 = cute.get_scalars(%coord_4726) : !cute.coord<"?">
          %true_4727 = arith.constant true
          %2118 = arith.cmpi slt, %2116, %2117 : i32
          %2119 = arith.andi %true_4727, %2118 : i1
          %lay_4728 = cute.get_layout(%2101) : !memref_rmem_f32_1
          %2120 = cute.get_shape(%lay_4728) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4729, %e1_4730, %e2_4731, %e3_4732 = cute.get_leaves(%2120) : !cute.shape<"((2,2),1,8)">
          %2121 = cute.get_stride(%lay_4728) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4733, %e1_4734, %e2_4735, %e3_4736 = cute.get_leaves(%2121) : !cute.stride<"((1,2),0,4)">
          %2122 = scf.if %2119 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2101) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,5)">
            cute.memref.store(%2101, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,5)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2101) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2101 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2101) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2101) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2101 : !memref_rmem_f32_1
          }
          %iter_4737 = cute.get_iter(%2122) : !memref_rmem_f32_1
          %lay_4738 = cute.get_layout(%2122) : !memref_rmem_f32_1
          %2123 = cute.get_shape(%lay_4738) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4739, %e1_4740, %e2_4741, %e3_4742 = cute.get_leaves(%2123) : !cute.shape<"((2,2),1,8)">
          %2124 = cute.get_stride(%lay_4738) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4743, %e1_4744, %e2_4745, %e3_4746 = cute.get_leaves(%2124) : !cute.stride<"((1,2),0,4)">
          %iter_4747 = cute.get_iter(%2122) : !memref_rmem_f32_1
          %iter_4748 = cute.get_iter(%2122) : !memref_rmem_f32_1
          %coord_4749 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4750 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4751 = cute.crd2idx(%coord_4749, %lay_4750) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4752 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4753 = cute.add_offset(%iter_4752, %idx_4751) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4754 = cute.make_view(%tup_4753) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4755 = cute.get_iter(%view_4754) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4756, %e1_4757 = cute.get_leaves(%iter_4755) : !cute.int_tuple<"(?,?)">
          %2125 = cute.get_scalars(%e0_4756) : !cute.int_tuple<"?">
          %2126 = cute.get_scalars(%e1_4757) : !cute.int_tuple<"?">
          %iter_4758 = cute.get_iter(%view_4754) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4759, %e1_4760 = cute.get_leaves(%iter_4758) : !cute.int_tuple<"(?,?)">
          %2127 = cute.get_scalars(%e0_4759) : !cute.int_tuple<"?">
          %2128 = cute.get_scalars(%e1_4760) : !cute.int_tuple<"?">
          %iter_4761 = cute.get_iter(%view_4754) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4762, %e1_4763 = cute.get_leaves(%iter_4761) : !cute.int_tuple<"(?,?)">
          %2129 = cute.get_scalars(%e0_4762) : !cute.int_tuple<"?">
          %2130 = cute.get_scalars(%e1_4763) : !cute.int_tuple<"?">
          %coord_4764 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
          %lay_4765 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4766 = cute.crd2idx(%coord_4764, %lay_4765) : (!cute.coord<"(1,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,49)">
          %iter_4767 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4768 = cute.add_offset(%iter_4767, %idx_4766) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,49)">) -> !cute.int_tuple<"(?,?)">
          %view_4769 = cute.make_view(%tup_4768) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4770 = cute.get_iter(%view_4769) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4771, %e1_4772 = cute.get_leaves(%iter_4770) : !cute.int_tuple<"(?,?)">
          %2131 = cute.get_scalars(%e0_4771) : !cute.int_tuple<"?">
          %2132 = cute.get_scalars(%e1_4772) : !cute.int_tuple<"?">
          %iter_4773 = cute.get_iter(%view_4769) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4774, %e1_4775 = cute.get_leaves(%iter_4773) : !cute.int_tuple<"(?,?)">
          %2133 = cute.get_scalars(%e0_4774) : !cute.int_tuple<"?">
          %2134 = cute.get_scalars(%e1_4775) : !cute.int_tuple<"?">
          %iter_4776 = cute.get_iter(%view_4769) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4777, %e1_4778 = cute.get_leaves(%iter_4776) : !cute.int_tuple<"(?,?)">
          %2135 = cute.get_scalars(%e0_4777) : !cute.int_tuple<"?">
          %2136 = cute.get_scalars(%e1_4778) : !cute.int_tuple<"?">
          %coord_4779 = cute.make_coord(%e0_4762) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4780 = cute.make_coord(%e1_4778) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2137 = cute.get_scalars(%coord_4779) : !cute.coord<"?">
          %2138 = cute.get_scalars(%coord_4780) : !cute.coord<"?">
          %true_4781 = arith.constant true
          %2139 = arith.cmpi slt, %2137, %2138 : i32
          %2140 = arith.andi %true_4781, %2139 : i1
          %lay_4782 = cute.get_layout(%2122) : !memref_rmem_f32_1
          %2141 = cute.get_shape(%lay_4782) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4783, %e1_4784, %e2_4785, %e3_4786 = cute.get_leaves(%2141) : !cute.shape<"((2,2),1,8)">
          %2142 = cute.get_stride(%lay_4782) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4787, %e1_4788, %e2_4789, %e3_4790 = cute.get_leaves(%2142) : !cute.stride<"((1,2),0,4)">
          %2143 = scf.if %2140 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2122) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,6)">
            cute.memref.store(%2122, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,6)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2122) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2122 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2122) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2122) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2122 : !memref_rmem_f32_1
          }
          %iter_4791 = cute.get_iter(%2143) : !memref_rmem_f32_1
          %lay_4792 = cute.get_layout(%2143) : !memref_rmem_f32_1
          %2144 = cute.get_shape(%lay_4792) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4793, %e1_4794, %e2_4795, %e3_4796 = cute.get_leaves(%2144) : !cute.shape<"((2,2),1,8)">
          %2145 = cute.get_stride(%lay_4792) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4797, %e1_4798, %e2_4799, %e3_4800 = cute.get_leaves(%2145) : !cute.stride<"((1,2),0,4)">
          %iter_4801 = cute.get_iter(%2143) : !memref_rmem_f32_1
          %iter_4802 = cute.get_iter(%2143) : !memref_rmem_f32_1
          %coord_4803 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4804 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4805 = cute.crd2idx(%coord_4803, %lay_4804) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4806 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4807 = cute.add_offset(%iter_4806, %idx_4805) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4808 = cute.make_view(%tup_4807) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4809 = cute.get_iter(%view_4808) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4810, %e1_4811 = cute.get_leaves(%iter_4809) : !cute.int_tuple<"(?,?)">
          %2146 = cute.get_scalars(%e0_4810) : !cute.int_tuple<"?">
          %2147 = cute.get_scalars(%e1_4811) : !cute.int_tuple<"?">
          %iter_4812 = cute.get_iter(%view_4808) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4813, %e1_4814 = cute.get_leaves(%iter_4812) : !cute.int_tuple<"(?,?)">
          %2148 = cute.get_scalars(%e0_4813) : !cute.int_tuple<"?">
          %2149 = cute.get_scalars(%e1_4814) : !cute.int_tuple<"?">
          %iter_4815 = cute.get_iter(%view_4808) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4816, %e1_4817 = cute.get_leaves(%iter_4815) : !cute.int_tuple<"(?,?)">
          %2150 = cute.get_scalars(%e0_4816) : !cute.int_tuple<"?">
          %2151 = cute.get_scalars(%e1_4817) : !cute.int_tuple<"?">
          %coord_4818 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
          %lay_4819 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4820 = cute.crd2idx(%coord_4818, %lay_4819) : (!cute.coord<"(1,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(0,57)">
          %iter_4821 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4822 = cute.add_offset(%iter_4821, %idx_4820) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(0,57)">) -> !cute.int_tuple<"(?,?)">
          %view_4823 = cute.make_view(%tup_4822) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_4824 = cute.get_iter(%view_4823) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4825, %e1_4826 = cute.get_leaves(%iter_4824) : !cute.int_tuple<"(?,?)">
          %2152 = cute.get_scalars(%e0_4825) : !cute.int_tuple<"?">
          %2153 = cute.get_scalars(%e1_4826) : !cute.int_tuple<"?">
          %iter_4827 = cute.get_iter(%view_4823) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4828, %e1_4829 = cute.get_leaves(%iter_4827) : !cute.int_tuple<"(?,?)">
          %2154 = cute.get_scalars(%e0_4828) : !cute.int_tuple<"?">
          %2155 = cute.get_scalars(%e1_4829) : !cute.int_tuple<"?">
          %iter_4830 = cute.get_iter(%view_4823) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_4831, %e1_4832 = cute.get_leaves(%iter_4830) : !cute.int_tuple<"(?,?)">
          %2156 = cute.get_scalars(%e0_4831) : !cute.int_tuple<"?">
          %2157 = cute.get_scalars(%e1_4832) : !cute.int_tuple<"?">
          %coord_4833 = cute.make_coord(%e0_4816) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4834 = cute.make_coord(%e1_4832) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2158 = cute.get_scalars(%coord_4833) : !cute.coord<"?">
          %2159 = cute.get_scalars(%coord_4834) : !cute.coord<"?">
          %true_4835 = arith.constant true
          %2160 = arith.cmpi slt, %2158, %2159 : i32
          %2161 = arith.andi %true_4835, %2160 : i1
          %lay_4836 = cute.get_layout(%2143) : !memref_rmem_f32_1
          %2162 = cute.get_shape(%lay_4836) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4837, %e1_4838, %e2_4839, %e3_4840 = cute.get_leaves(%2162) : !cute.shape<"((2,2),1,8)">
          %2163 = cute.get_stride(%lay_4836) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4841, %e1_4842, %e2_4843, %e3_4844 = cute.get_leaves(%2163) : !cute.stride<"((1,2),0,4)">
          %2164 = scf.if %2161 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2143) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(1,0,7)">
            cute.memref.store(%2143, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(1,0,7)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2143) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2143 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2143) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2143) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2143 : !memref_rmem_f32_1
          }
          %iter_4845 = cute.get_iter(%2164) : !memref_rmem_f32_1
          %lay_4846 = cute.get_layout(%2164) : !memref_rmem_f32_1
          %2165 = cute.get_shape(%lay_4846) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4847, %e1_4848, %e2_4849, %e3_4850 = cute.get_leaves(%2165) : !cute.shape<"((2,2),1,8)">
          %2166 = cute.get_stride(%lay_4846) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4851, %e1_4852, %e2_4853, %e3_4854 = cute.get_leaves(%2166) : !cute.stride<"((1,2),0,4)">
          %iter_4855 = cute.get_iter(%2164) : !memref_rmem_f32_1
          %iter_4856 = cute.get_iter(%2164) : !memref_rmem_f32_1
          %int_tuple_4857 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_4858 = cute.size(%int_tuple_4857) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_4859 = cute.get_leaves(%sz_4858) : !cute.int_tuple<"1">
          %int_tuple_4860 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_4861 = cute.size(%int_tuple_4860) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_4862 = cute.get_leaves(%sz_4861) : !cute.int_tuple<"8">
          %coord_4863 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4864 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4865 = cute.crd2idx(%coord_4863, %lay_4864) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4866 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4867 = cute.add_offset(%iter_4866, %idx_4865) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4868 = cute.make_view(%tup_4867) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4869 = cute.get_iter(%view_4868) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4870, %e1_4871 = cute.get_leaves(%iter_4869) : !cute.int_tuple<"(?,?{div=2})">
          %2167 = cute.get_scalars(%e0_4870) : !cute.int_tuple<"?">
          %2168 = cute.get_scalars(%e1_4871) : !cute.int_tuple<"?{div=2}">
          %iter_4872 = cute.get_iter(%view_4868) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4873, %e1_4874 = cute.get_leaves(%iter_4872) : !cute.int_tuple<"(?,?{div=2})">
          %2169 = cute.get_scalars(%e0_4873) : !cute.int_tuple<"?">
          %2170 = cute.get_scalars(%e1_4874) : !cute.int_tuple<"?{div=2}">
          %iter_4875 = cute.get_iter(%view_4868) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4876, %e1_4877 = cute.get_leaves(%iter_4875) : !cute.int_tuple<"(?,?{div=2})">
          %2171 = cute.get_scalars(%e0_4876) : !cute.int_tuple<"?">
          %2172 = cute.get_scalars(%e1_4877) : !cute.int_tuple<"?{div=2}">
          %coord_4878 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
          %lay_4879 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4880 = cute.crd2idx(%coord_4878, %lay_4879) : (!cute.coord<"(2,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,0)">
          %iter_4881 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4882 = cute.add_offset(%iter_4881, %idx_4880) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,0)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4883 = cute.make_view(%tup_4882) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4884 = cute.get_iter(%view_4883) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4885, %e1_4886 = cute.get_leaves(%iter_4884) : !cute.int_tuple<"(?,?{div=2})">
          %2173 = cute.get_scalars(%e0_4885) : !cute.int_tuple<"?">
          %2174 = cute.get_scalars(%e1_4886) : !cute.int_tuple<"?{div=2}">
          %iter_4887 = cute.get_iter(%view_4883) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4888, %e1_4889 = cute.get_leaves(%iter_4887) : !cute.int_tuple<"(?,?{div=2})">
          %2175 = cute.get_scalars(%e0_4888) : !cute.int_tuple<"?">
          %2176 = cute.get_scalars(%e1_4889) : !cute.int_tuple<"?{div=2}">
          %iter_4890 = cute.get_iter(%view_4883) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4891, %e1_4892 = cute.get_leaves(%iter_4890) : !cute.int_tuple<"(?,?{div=2})">
          %2177 = cute.get_scalars(%e0_4891) : !cute.int_tuple<"?">
          %2178 = cute.get_scalars(%e1_4892) : !cute.int_tuple<"?{div=2}">
          %coord_4893 = cute.make_coord(%e0_4876) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4894 = cute.make_coord(%e1_4892) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2179 = cute.get_scalars(%coord_4893) : !cute.coord<"?">
          %2180 = cute.get_scalars(%coord_4894) : !cute.coord<"?{div=2}">
          %true_4895 = arith.constant true
          %2181 = arith.cmpi slt, %2179, %2180 : i32
          %2182 = arith.andi %true_4895, %2181 : i1
          %lay_4896 = cute.get_layout(%2164) : !memref_rmem_f32_1
          %2183 = cute.get_shape(%lay_4896) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4897, %e1_4898, %e2_4899, %e3_4900 = cute.get_leaves(%2183) : !cute.shape<"((2,2),1,8)">
          %2184 = cute.get_stride(%lay_4896) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4901, %e1_4902, %e2_4903, %e3_4904 = cute.get_leaves(%2184) : !cute.stride<"((1,2),0,4)">
          %2185 = scf.if %2182 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2164) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,0)">
            cute.memref.store(%2164, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,0)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2164) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2164 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2164) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2164) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2164 : !memref_rmem_f32_1
          }
          %iter_4905 = cute.get_iter(%2185) : !memref_rmem_f32_1
          %lay_4906 = cute.get_layout(%2185) : !memref_rmem_f32_1
          %2186 = cute.get_shape(%lay_4906) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4907, %e1_4908, %e2_4909, %e3_4910 = cute.get_leaves(%2186) : !cute.shape<"((2,2),1,8)">
          %2187 = cute.get_stride(%lay_4906) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4911, %e1_4912, %e2_4913, %e3_4914 = cute.get_leaves(%2187) : !cute.stride<"((1,2),0,4)">
          %iter_4915 = cute.get_iter(%2185) : !memref_rmem_f32_1
          %iter_4916 = cute.get_iter(%2185) : !memref_rmem_f32_1
          %coord_4917 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4918 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4919 = cute.crd2idx(%coord_4917, %lay_4918) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4920 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4921 = cute.add_offset(%iter_4920, %idx_4919) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4922 = cute.make_view(%tup_4921) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4923 = cute.get_iter(%view_4922) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4924, %e1_4925 = cute.get_leaves(%iter_4923) : !cute.int_tuple<"(?,?{div=2})">
          %2188 = cute.get_scalars(%e0_4924) : !cute.int_tuple<"?">
          %2189 = cute.get_scalars(%e1_4925) : !cute.int_tuple<"?{div=2}">
          %iter_4926 = cute.get_iter(%view_4922) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4927, %e1_4928 = cute.get_leaves(%iter_4926) : !cute.int_tuple<"(?,?{div=2})">
          %2190 = cute.get_scalars(%e0_4927) : !cute.int_tuple<"?">
          %2191 = cute.get_scalars(%e1_4928) : !cute.int_tuple<"?{div=2}">
          %iter_4929 = cute.get_iter(%view_4922) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4930, %e1_4931 = cute.get_leaves(%iter_4929) : !cute.int_tuple<"(?,?{div=2})">
          %2192 = cute.get_scalars(%e0_4930) : !cute.int_tuple<"?">
          %2193 = cute.get_scalars(%e1_4931) : !cute.int_tuple<"?{div=2}">
          %coord_4932 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
          %lay_4933 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4934 = cute.crd2idx(%coord_4932, %lay_4933) : (!cute.coord<"(2,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,8)">
          %iter_4935 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4936 = cute.add_offset(%iter_4935, %idx_4934) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,8)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4937 = cute.make_view(%tup_4936) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4938 = cute.get_iter(%view_4937) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4939, %e1_4940 = cute.get_leaves(%iter_4938) : !cute.int_tuple<"(?,?{div=2})">
          %2194 = cute.get_scalars(%e0_4939) : !cute.int_tuple<"?">
          %2195 = cute.get_scalars(%e1_4940) : !cute.int_tuple<"?{div=2}">
          %iter_4941 = cute.get_iter(%view_4937) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4942, %e1_4943 = cute.get_leaves(%iter_4941) : !cute.int_tuple<"(?,?{div=2})">
          %2196 = cute.get_scalars(%e0_4942) : !cute.int_tuple<"?">
          %2197 = cute.get_scalars(%e1_4943) : !cute.int_tuple<"?{div=2}">
          %iter_4944 = cute.get_iter(%view_4937) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4945, %e1_4946 = cute.get_leaves(%iter_4944) : !cute.int_tuple<"(?,?{div=2})">
          %2198 = cute.get_scalars(%e0_4945) : !cute.int_tuple<"?">
          %2199 = cute.get_scalars(%e1_4946) : !cute.int_tuple<"?{div=2}">
          %coord_4947 = cute.make_coord(%e0_4930) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_4948 = cute.make_coord(%e1_4946) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2200 = cute.get_scalars(%coord_4947) : !cute.coord<"?">
          %2201 = cute.get_scalars(%coord_4948) : !cute.coord<"?{div=2}">
          %true_4949 = arith.constant true
          %2202 = arith.cmpi slt, %2200, %2201 : i32
          %2203 = arith.andi %true_4949, %2202 : i1
          %lay_4950 = cute.get_layout(%2185) : !memref_rmem_f32_1
          %2204 = cute.get_shape(%lay_4950) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4951, %e1_4952, %e2_4953, %e3_4954 = cute.get_leaves(%2204) : !cute.shape<"((2,2),1,8)">
          %2205 = cute.get_stride(%lay_4950) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4955, %e1_4956, %e2_4957, %e3_4958 = cute.get_leaves(%2205) : !cute.stride<"((1,2),0,4)">
          %2206 = scf.if %2203 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2185) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,1)">
            cute.memref.store(%2185, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,1)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2185) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2185 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2185) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2185) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2185 : !memref_rmem_f32_1
          }
          %iter_4959 = cute.get_iter(%2206) : !memref_rmem_f32_1
          %lay_4960 = cute.get_layout(%2206) : !memref_rmem_f32_1
          %2207 = cute.get_shape(%lay_4960) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_4961, %e1_4962, %e2_4963, %e3_4964 = cute.get_leaves(%2207) : !cute.shape<"((2,2),1,8)">
          %2208 = cute.get_stride(%lay_4960) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_4965, %e1_4966, %e2_4967, %e3_4968 = cute.get_leaves(%2208) : !cute.stride<"((1,2),0,4)">
          %iter_4969 = cute.get_iter(%2206) : !memref_rmem_f32_1
          %iter_4970 = cute.get_iter(%2206) : !memref_rmem_f32_1
          %coord_4971 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_4972 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4973 = cute.crd2idx(%coord_4971, %lay_4972) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_4974 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4975 = cute.add_offset(%iter_4974, %idx_4973) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4976 = cute.make_view(%tup_4975) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4977 = cute.get_iter(%view_4976) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4978, %e1_4979 = cute.get_leaves(%iter_4977) : !cute.int_tuple<"(?,?{div=2})">
          %2209 = cute.get_scalars(%e0_4978) : !cute.int_tuple<"?">
          %2210 = cute.get_scalars(%e1_4979) : !cute.int_tuple<"?{div=2}">
          %iter_4980 = cute.get_iter(%view_4976) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4981, %e1_4982 = cute.get_leaves(%iter_4980) : !cute.int_tuple<"(?,?{div=2})">
          %2211 = cute.get_scalars(%e0_4981) : !cute.int_tuple<"?">
          %2212 = cute.get_scalars(%e1_4982) : !cute.int_tuple<"?{div=2}">
          %iter_4983 = cute.get_iter(%view_4976) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4984, %e1_4985 = cute.get_leaves(%iter_4983) : !cute.int_tuple<"(?,?{div=2})">
          %2213 = cute.get_scalars(%e0_4984) : !cute.int_tuple<"?">
          %2214 = cute.get_scalars(%e1_4985) : !cute.int_tuple<"?{div=2}">
          %coord_4986 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
          %lay_4987 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_4988 = cute.crd2idx(%coord_4986, %lay_4987) : (!cute.coord<"(2,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,16)">
          %iter_4989 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_4990 = cute.add_offset(%iter_4989, %idx_4988) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,16)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_4991 = cute.make_view(%tup_4990) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_4992 = cute.get_iter(%view_4991) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4993, %e1_4994 = cute.get_leaves(%iter_4992) : !cute.int_tuple<"(?,?{div=2})">
          %2215 = cute.get_scalars(%e0_4993) : !cute.int_tuple<"?">
          %2216 = cute.get_scalars(%e1_4994) : !cute.int_tuple<"?{div=2}">
          %iter_4995 = cute.get_iter(%view_4991) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4996, %e1_4997 = cute.get_leaves(%iter_4995) : !cute.int_tuple<"(?,?{div=2})">
          %2217 = cute.get_scalars(%e0_4996) : !cute.int_tuple<"?">
          %2218 = cute.get_scalars(%e1_4997) : !cute.int_tuple<"?{div=2}">
          %iter_4998 = cute.get_iter(%view_4991) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_4999, %e1_5000 = cute.get_leaves(%iter_4998) : !cute.int_tuple<"(?,?{div=2})">
          %2219 = cute.get_scalars(%e0_4999) : !cute.int_tuple<"?">
          %2220 = cute.get_scalars(%e1_5000) : !cute.int_tuple<"?{div=2}">
          %coord_5001 = cute.make_coord(%e0_4984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5002 = cute.make_coord(%e1_5000) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2221 = cute.get_scalars(%coord_5001) : !cute.coord<"?">
          %2222 = cute.get_scalars(%coord_5002) : !cute.coord<"?{div=2}">
          %true_5003 = arith.constant true
          %2223 = arith.cmpi slt, %2221, %2222 : i32
          %2224 = arith.andi %true_5003, %2223 : i1
          %lay_5004 = cute.get_layout(%2206) : !memref_rmem_f32_1
          %2225 = cute.get_shape(%lay_5004) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5005, %e1_5006, %e2_5007, %e3_5008 = cute.get_leaves(%2225) : !cute.shape<"((2,2),1,8)">
          %2226 = cute.get_stride(%lay_5004) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5009, %e1_5010, %e2_5011, %e3_5012 = cute.get_leaves(%2226) : !cute.stride<"((1,2),0,4)">
          %2227 = scf.if %2224 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2206) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,2)">
            cute.memref.store(%2206, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,2)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2206) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2206 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2206) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2206) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2206 : !memref_rmem_f32_1
          }
          %iter_5013 = cute.get_iter(%2227) : !memref_rmem_f32_1
          %lay_5014 = cute.get_layout(%2227) : !memref_rmem_f32_1
          %2228 = cute.get_shape(%lay_5014) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5015, %e1_5016, %e2_5017, %e3_5018 = cute.get_leaves(%2228) : !cute.shape<"((2,2),1,8)">
          %2229 = cute.get_stride(%lay_5014) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5019, %e1_5020, %e2_5021, %e3_5022 = cute.get_leaves(%2229) : !cute.stride<"((1,2),0,4)">
          %iter_5023 = cute.get_iter(%2227) : !memref_rmem_f32_1
          %iter_5024 = cute.get_iter(%2227) : !memref_rmem_f32_1
          %coord_5025 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_5026 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5027 = cute.crd2idx(%coord_5025, %lay_5026) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_5028 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5029 = cute.add_offset(%iter_5028, %idx_5027) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5030 = cute.make_view(%tup_5029) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5031 = cute.get_iter(%view_5030) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5032, %e1_5033 = cute.get_leaves(%iter_5031) : !cute.int_tuple<"(?,?{div=2})">
          %2230 = cute.get_scalars(%e0_5032) : !cute.int_tuple<"?">
          %2231 = cute.get_scalars(%e1_5033) : !cute.int_tuple<"?{div=2}">
          %iter_5034 = cute.get_iter(%view_5030) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5035, %e1_5036 = cute.get_leaves(%iter_5034) : !cute.int_tuple<"(?,?{div=2})">
          %2232 = cute.get_scalars(%e0_5035) : !cute.int_tuple<"?">
          %2233 = cute.get_scalars(%e1_5036) : !cute.int_tuple<"?{div=2}">
          %iter_5037 = cute.get_iter(%view_5030) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5038, %e1_5039 = cute.get_leaves(%iter_5037) : !cute.int_tuple<"(?,?{div=2})">
          %2234 = cute.get_scalars(%e0_5038) : !cute.int_tuple<"?">
          %2235 = cute.get_scalars(%e1_5039) : !cute.int_tuple<"?{div=2}">
          %coord_5040 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
          %lay_5041 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5042 = cute.crd2idx(%coord_5040, %lay_5041) : (!cute.coord<"(2,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,24)">
          %iter_5043 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5044 = cute.add_offset(%iter_5043, %idx_5042) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,24)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5045 = cute.make_view(%tup_5044) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5046 = cute.get_iter(%view_5045) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5047, %e1_5048 = cute.get_leaves(%iter_5046) : !cute.int_tuple<"(?,?{div=2})">
          %2236 = cute.get_scalars(%e0_5047) : !cute.int_tuple<"?">
          %2237 = cute.get_scalars(%e1_5048) : !cute.int_tuple<"?{div=2}">
          %iter_5049 = cute.get_iter(%view_5045) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5050, %e1_5051 = cute.get_leaves(%iter_5049) : !cute.int_tuple<"(?,?{div=2})">
          %2238 = cute.get_scalars(%e0_5050) : !cute.int_tuple<"?">
          %2239 = cute.get_scalars(%e1_5051) : !cute.int_tuple<"?{div=2}">
          %iter_5052 = cute.get_iter(%view_5045) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5053, %e1_5054 = cute.get_leaves(%iter_5052) : !cute.int_tuple<"(?,?{div=2})">
          %2240 = cute.get_scalars(%e0_5053) : !cute.int_tuple<"?">
          %2241 = cute.get_scalars(%e1_5054) : !cute.int_tuple<"?{div=2}">
          %coord_5055 = cute.make_coord(%e0_5038) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5056 = cute.make_coord(%e1_5054) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2242 = cute.get_scalars(%coord_5055) : !cute.coord<"?">
          %2243 = cute.get_scalars(%coord_5056) : !cute.coord<"?{div=2}">
          %true_5057 = arith.constant true
          %2244 = arith.cmpi slt, %2242, %2243 : i32
          %2245 = arith.andi %true_5057, %2244 : i1
          %lay_5058 = cute.get_layout(%2227) : !memref_rmem_f32_1
          %2246 = cute.get_shape(%lay_5058) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5059, %e1_5060, %e2_5061, %e3_5062 = cute.get_leaves(%2246) : !cute.shape<"((2,2),1,8)">
          %2247 = cute.get_stride(%lay_5058) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5063, %e1_5064, %e2_5065, %e3_5066 = cute.get_leaves(%2247) : !cute.stride<"((1,2),0,4)">
          %2248 = scf.if %2245 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2227) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,3)">
            cute.memref.store(%2227, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,3)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2227) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2227 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2227) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2227) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2227 : !memref_rmem_f32_1
          }
          %iter_5067 = cute.get_iter(%2248) : !memref_rmem_f32_1
          %lay_5068 = cute.get_layout(%2248) : !memref_rmem_f32_1
          %2249 = cute.get_shape(%lay_5068) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5069, %e1_5070, %e2_5071, %e3_5072 = cute.get_leaves(%2249) : !cute.shape<"((2,2),1,8)">
          %2250 = cute.get_stride(%lay_5068) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5073, %e1_5074, %e2_5075, %e3_5076 = cute.get_leaves(%2250) : !cute.stride<"((1,2),0,4)">
          %iter_5077 = cute.get_iter(%2248) : !memref_rmem_f32_1
          %iter_5078 = cute.get_iter(%2248) : !memref_rmem_f32_1
          %coord_5079 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_5080 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5081 = cute.crd2idx(%coord_5079, %lay_5080) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_5082 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5083 = cute.add_offset(%iter_5082, %idx_5081) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5084 = cute.make_view(%tup_5083) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5085 = cute.get_iter(%view_5084) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5086, %e1_5087 = cute.get_leaves(%iter_5085) : !cute.int_tuple<"(?,?{div=2})">
          %2251 = cute.get_scalars(%e0_5086) : !cute.int_tuple<"?">
          %2252 = cute.get_scalars(%e1_5087) : !cute.int_tuple<"?{div=2}">
          %iter_5088 = cute.get_iter(%view_5084) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5089, %e1_5090 = cute.get_leaves(%iter_5088) : !cute.int_tuple<"(?,?{div=2})">
          %2253 = cute.get_scalars(%e0_5089) : !cute.int_tuple<"?">
          %2254 = cute.get_scalars(%e1_5090) : !cute.int_tuple<"?{div=2}">
          %iter_5091 = cute.get_iter(%view_5084) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5092, %e1_5093 = cute.get_leaves(%iter_5091) : !cute.int_tuple<"(?,?{div=2})">
          %2255 = cute.get_scalars(%e0_5092) : !cute.int_tuple<"?">
          %2256 = cute.get_scalars(%e1_5093) : !cute.int_tuple<"?{div=2}">
          %coord_5094 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
          %lay_5095 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5096 = cute.crd2idx(%coord_5094, %lay_5095) : (!cute.coord<"(2,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,32)">
          %iter_5097 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5098 = cute.add_offset(%iter_5097, %idx_5096) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,32)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5099 = cute.make_view(%tup_5098) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5100 = cute.get_iter(%view_5099) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5101, %e1_5102 = cute.get_leaves(%iter_5100) : !cute.int_tuple<"(?,?{div=2})">
          %2257 = cute.get_scalars(%e0_5101) : !cute.int_tuple<"?">
          %2258 = cute.get_scalars(%e1_5102) : !cute.int_tuple<"?{div=2}">
          %iter_5103 = cute.get_iter(%view_5099) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5104, %e1_5105 = cute.get_leaves(%iter_5103) : !cute.int_tuple<"(?,?{div=2})">
          %2259 = cute.get_scalars(%e0_5104) : !cute.int_tuple<"?">
          %2260 = cute.get_scalars(%e1_5105) : !cute.int_tuple<"?{div=2}">
          %iter_5106 = cute.get_iter(%view_5099) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5107, %e1_5108 = cute.get_leaves(%iter_5106) : !cute.int_tuple<"(?,?{div=2})">
          %2261 = cute.get_scalars(%e0_5107) : !cute.int_tuple<"?">
          %2262 = cute.get_scalars(%e1_5108) : !cute.int_tuple<"?{div=2}">
          %coord_5109 = cute.make_coord(%e0_5092) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5110 = cute.make_coord(%e1_5108) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2263 = cute.get_scalars(%coord_5109) : !cute.coord<"?">
          %2264 = cute.get_scalars(%coord_5110) : !cute.coord<"?{div=2}">
          %true_5111 = arith.constant true
          %2265 = arith.cmpi slt, %2263, %2264 : i32
          %2266 = arith.andi %true_5111, %2265 : i1
          %lay_5112 = cute.get_layout(%2248) : !memref_rmem_f32_1
          %2267 = cute.get_shape(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5113, %e1_5114, %e2_5115, %e3_5116 = cute.get_leaves(%2267) : !cute.shape<"((2,2),1,8)">
          %2268 = cute.get_stride(%lay_5112) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5117, %e1_5118, %e2_5119, %e3_5120 = cute.get_leaves(%2268) : !cute.stride<"((1,2),0,4)">
          %2269 = scf.if %2266 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2248) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,4)">
            cute.memref.store(%2248, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,4)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2248) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2248 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2248) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2248) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2248 : !memref_rmem_f32_1
          }
          %iter_5121 = cute.get_iter(%2269) : !memref_rmem_f32_1
          %lay_5122 = cute.get_layout(%2269) : !memref_rmem_f32_1
          %2270 = cute.get_shape(%lay_5122) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5123, %e1_5124, %e2_5125, %e3_5126 = cute.get_leaves(%2270) : !cute.shape<"((2,2),1,8)">
          %2271 = cute.get_stride(%lay_5122) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5127, %e1_5128, %e2_5129, %e3_5130 = cute.get_leaves(%2271) : !cute.stride<"((1,2),0,4)">
          %iter_5131 = cute.get_iter(%2269) : !memref_rmem_f32_1
          %iter_5132 = cute.get_iter(%2269) : !memref_rmem_f32_1
          %coord_5133 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_5134 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5135 = cute.crd2idx(%coord_5133, %lay_5134) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_5136 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5137 = cute.add_offset(%iter_5136, %idx_5135) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5138 = cute.make_view(%tup_5137) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5139 = cute.get_iter(%view_5138) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5140, %e1_5141 = cute.get_leaves(%iter_5139) : !cute.int_tuple<"(?,?{div=2})">
          %2272 = cute.get_scalars(%e0_5140) : !cute.int_tuple<"?">
          %2273 = cute.get_scalars(%e1_5141) : !cute.int_tuple<"?{div=2}">
          %iter_5142 = cute.get_iter(%view_5138) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5143, %e1_5144 = cute.get_leaves(%iter_5142) : !cute.int_tuple<"(?,?{div=2})">
          %2274 = cute.get_scalars(%e0_5143) : !cute.int_tuple<"?">
          %2275 = cute.get_scalars(%e1_5144) : !cute.int_tuple<"?{div=2}">
          %iter_5145 = cute.get_iter(%view_5138) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5146, %e1_5147 = cute.get_leaves(%iter_5145) : !cute.int_tuple<"(?,?{div=2})">
          %2276 = cute.get_scalars(%e0_5146) : !cute.int_tuple<"?">
          %2277 = cute.get_scalars(%e1_5147) : !cute.int_tuple<"?{div=2}">
          %coord_5148 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
          %lay_5149 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5150 = cute.crd2idx(%coord_5148, %lay_5149) : (!cute.coord<"(2,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,40)">
          %iter_5151 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5152 = cute.add_offset(%iter_5151, %idx_5150) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,40)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5153 = cute.make_view(%tup_5152) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5154 = cute.get_iter(%view_5153) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5155, %e1_5156 = cute.get_leaves(%iter_5154) : !cute.int_tuple<"(?,?{div=2})">
          %2278 = cute.get_scalars(%e0_5155) : !cute.int_tuple<"?">
          %2279 = cute.get_scalars(%e1_5156) : !cute.int_tuple<"?{div=2}">
          %iter_5157 = cute.get_iter(%view_5153) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5158, %e1_5159 = cute.get_leaves(%iter_5157) : !cute.int_tuple<"(?,?{div=2})">
          %2280 = cute.get_scalars(%e0_5158) : !cute.int_tuple<"?">
          %2281 = cute.get_scalars(%e1_5159) : !cute.int_tuple<"?{div=2}">
          %iter_5160 = cute.get_iter(%view_5153) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5161, %e1_5162 = cute.get_leaves(%iter_5160) : !cute.int_tuple<"(?,?{div=2})">
          %2282 = cute.get_scalars(%e0_5161) : !cute.int_tuple<"?">
          %2283 = cute.get_scalars(%e1_5162) : !cute.int_tuple<"?{div=2}">
          %coord_5163 = cute.make_coord(%e0_5146) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5164 = cute.make_coord(%e1_5162) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2284 = cute.get_scalars(%coord_5163) : !cute.coord<"?">
          %2285 = cute.get_scalars(%coord_5164) : !cute.coord<"?{div=2}">
          %true_5165 = arith.constant true
          %2286 = arith.cmpi slt, %2284, %2285 : i32
          %2287 = arith.andi %true_5165, %2286 : i1
          %lay_5166 = cute.get_layout(%2269) : !memref_rmem_f32_1
          %2288 = cute.get_shape(%lay_5166) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5167, %e1_5168, %e2_5169, %e3_5170 = cute.get_leaves(%2288) : !cute.shape<"((2,2),1,8)">
          %2289 = cute.get_stride(%lay_5166) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5171, %e1_5172, %e2_5173, %e3_5174 = cute.get_leaves(%2289) : !cute.stride<"((1,2),0,4)">
          %2290 = scf.if %2287 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2269) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,5)">
            cute.memref.store(%2269, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,5)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2269) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2269 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2269) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2269) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2269 : !memref_rmem_f32_1
          }
          %iter_5175 = cute.get_iter(%2290) : !memref_rmem_f32_1
          %lay_5176 = cute.get_layout(%2290) : !memref_rmem_f32_1
          %2291 = cute.get_shape(%lay_5176) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5177, %e1_5178, %e2_5179, %e3_5180 = cute.get_leaves(%2291) : !cute.shape<"((2,2),1,8)">
          %2292 = cute.get_stride(%lay_5176) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5181, %e1_5182, %e2_5183, %e3_5184 = cute.get_leaves(%2292) : !cute.stride<"((1,2),0,4)">
          %iter_5185 = cute.get_iter(%2290) : !memref_rmem_f32_1
          %iter_5186 = cute.get_iter(%2290) : !memref_rmem_f32_1
          %coord_5187 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_5188 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5189 = cute.crd2idx(%coord_5187, %lay_5188) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_5190 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5191 = cute.add_offset(%iter_5190, %idx_5189) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5192 = cute.make_view(%tup_5191) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5193 = cute.get_iter(%view_5192) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5194, %e1_5195 = cute.get_leaves(%iter_5193) : !cute.int_tuple<"(?,?{div=2})">
          %2293 = cute.get_scalars(%e0_5194) : !cute.int_tuple<"?">
          %2294 = cute.get_scalars(%e1_5195) : !cute.int_tuple<"?{div=2}">
          %iter_5196 = cute.get_iter(%view_5192) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5197, %e1_5198 = cute.get_leaves(%iter_5196) : !cute.int_tuple<"(?,?{div=2})">
          %2295 = cute.get_scalars(%e0_5197) : !cute.int_tuple<"?">
          %2296 = cute.get_scalars(%e1_5198) : !cute.int_tuple<"?{div=2}">
          %iter_5199 = cute.get_iter(%view_5192) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5200, %e1_5201 = cute.get_leaves(%iter_5199) : !cute.int_tuple<"(?,?{div=2})">
          %2297 = cute.get_scalars(%e0_5200) : !cute.int_tuple<"?">
          %2298 = cute.get_scalars(%e1_5201) : !cute.int_tuple<"?{div=2}">
          %coord_5202 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
          %lay_5203 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5204 = cute.crd2idx(%coord_5202, %lay_5203) : (!cute.coord<"(2,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,48)">
          %iter_5205 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5206 = cute.add_offset(%iter_5205, %idx_5204) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,48)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5207 = cute.make_view(%tup_5206) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5208 = cute.get_iter(%view_5207) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5209, %e1_5210 = cute.get_leaves(%iter_5208) : !cute.int_tuple<"(?,?{div=2})">
          %2299 = cute.get_scalars(%e0_5209) : !cute.int_tuple<"?">
          %2300 = cute.get_scalars(%e1_5210) : !cute.int_tuple<"?{div=2}">
          %iter_5211 = cute.get_iter(%view_5207) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5212, %e1_5213 = cute.get_leaves(%iter_5211) : !cute.int_tuple<"(?,?{div=2})">
          %2301 = cute.get_scalars(%e0_5212) : !cute.int_tuple<"?">
          %2302 = cute.get_scalars(%e1_5213) : !cute.int_tuple<"?{div=2}">
          %iter_5214 = cute.get_iter(%view_5207) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5215, %e1_5216 = cute.get_leaves(%iter_5214) : !cute.int_tuple<"(?,?{div=2})">
          %2303 = cute.get_scalars(%e0_5215) : !cute.int_tuple<"?">
          %2304 = cute.get_scalars(%e1_5216) : !cute.int_tuple<"?{div=2}">
          %coord_5217 = cute.make_coord(%e0_5200) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5218 = cute.make_coord(%e1_5216) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2305 = cute.get_scalars(%coord_5217) : !cute.coord<"?">
          %2306 = cute.get_scalars(%coord_5218) : !cute.coord<"?{div=2}">
          %true_5219 = arith.constant true
          %2307 = arith.cmpi slt, %2305, %2306 : i32
          %2308 = arith.andi %true_5219, %2307 : i1
          %lay_5220 = cute.get_layout(%2290) : !memref_rmem_f32_1
          %2309 = cute.get_shape(%lay_5220) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5221, %e1_5222, %e2_5223, %e3_5224 = cute.get_leaves(%2309) : !cute.shape<"((2,2),1,8)">
          %2310 = cute.get_stride(%lay_5220) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5225, %e1_5226, %e2_5227, %e3_5228 = cute.get_leaves(%2310) : !cute.stride<"((1,2),0,4)">
          %2311 = scf.if %2308 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2290) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,6)">
            cute.memref.store(%2290, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,6)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2290) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2290 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2290) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2290) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2290 : !memref_rmem_f32_1
          }
          %iter_5229 = cute.get_iter(%2311) : !memref_rmem_f32_1
          %lay_5230 = cute.get_layout(%2311) : !memref_rmem_f32_1
          %2312 = cute.get_shape(%lay_5230) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5231, %e1_5232, %e2_5233, %e3_5234 = cute.get_leaves(%2312) : !cute.shape<"((2,2),1,8)">
          %2313 = cute.get_stride(%lay_5230) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5235, %e1_5236, %e2_5237, %e3_5238 = cute.get_leaves(%2313) : !cute.stride<"((1,2),0,4)">
          %iter_5239 = cute.get_iter(%2311) : !memref_rmem_f32_1
          %iter_5240 = cute.get_iter(%2311) : !memref_rmem_f32_1
          %coord_5241 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_5242 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5243 = cute.crd2idx(%coord_5241, %lay_5242) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_5244 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5245 = cute.add_offset(%iter_5244, %idx_5243) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5246 = cute.make_view(%tup_5245) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5247 = cute.get_iter(%view_5246) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5248, %e1_5249 = cute.get_leaves(%iter_5247) : !cute.int_tuple<"(?,?{div=2})">
          %2314 = cute.get_scalars(%e0_5248) : !cute.int_tuple<"?">
          %2315 = cute.get_scalars(%e1_5249) : !cute.int_tuple<"?{div=2}">
          %iter_5250 = cute.get_iter(%view_5246) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5251, %e1_5252 = cute.get_leaves(%iter_5250) : !cute.int_tuple<"(?,?{div=2})">
          %2316 = cute.get_scalars(%e0_5251) : !cute.int_tuple<"?">
          %2317 = cute.get_scalars(%e1_5252) : !cute.int_tuple<"?{div=2}">
          %iter_5253 = cute.get_iter(%view_5246) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5254, %e1_5255 = cute.get_leaves(%iter_5253) : !cute.int_tuple<"(?,?{div=2})">
          %2318 = cute.get_scalars(%e0_5254) : !cute.int_tuple<"?">
          %2319 = cute.get_scalars(%e1_5255) : !cute.int_tuple<"?{div=2}">
          %coord_5256 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
          %lay_5257 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5258 = cute.crd2idx(%coord_5256, %lay_5257) : (!cute.coord<"(2,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,56)">
          %iter_5259 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5260 = cute.add_offset(%iter_5259, %idx_5258) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,56)">) -> !cute.int_tuple<"(?,?{div=2})">
          %view_5261 = cute.make_view(%tup_5260) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %iter_5262 = cute.get_iter(%view_5261) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5263, %e1_5264 = cute.get_leaves(%iter_5262) : !cute.int_tuple<"(?,?{div=2})">
          %2320 = cute.get_scalars(%e0_5263) : !cute.int_tuple<"?">
          %2321 = cute.get_scalars(%e1_5264) : !cute.int_tuple<"?{div=2}">
          %iter_5265 = cute.get_iter(%view_5261) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5266, %e1_5267 = cute.get_leaves(%iter_5265) : !cute.int_tuple<"(?,?{div=2})">
          %2322 = cute.get_scalars(%e0_5266) : !cute.int_tuple<"?">
          %2323 = cute.get_scalars(%e1_5267) : !cute.int_tuple<"?{div=2}">
          %iter_5268 = cute.get_iter(%view_5261) : !cute.coord_tensor<"(?,?{div=2})", "():()">
          %e0_5269, %e1_5270 = cute.get_leaves(%iter_5268) : !cute.int_tuple<"(?,?{div=2})">
          %2324 = cute.get_scalars(%e0_5269) : !cute.int_tuple<"?">
          %2325 = cute.get_scalars(%e1_5270) : !cute.int_tuple<"?{div=2}">
          %coord_5271 = cute.make_coord(%e0_5254) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5272 = cute.make_coord(%e1_5270) : (!cute.int_tuple<"?{div=2}">) -> !cute.coord<"?{div=2}">
          %2326 = cute.get_scalars(%coord_5271) : !cute.coord<"?">
          %2327 = cute.get_scalars(%coord_5272) : !cute.coord<"?{div=2}">
          %true_5273 = arith.constant true
          %2328 = arith.cmpi slt, %2326, %2327 : i32
          %2329 = arith.andi %true_5273, %2328 : i1
          %lay_5274 = cute.get_layout(%2311) : !memref_rmem_f32_1
          %2330 = cute.get_shape(%lay_5274) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5275, %e1_5276, %e2_5277, %e3_5278 = cute.get_leaves(%2330) : !cute.shape<"((2,2),1,8)">
          %2331 = cute.get_stride(%lay_5274) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5279, %e1_5280, %e2_5281, %e3_5282 = cute.get_leaves(%2331) : !cute.stride<"((1,2),0,4)">
          %2332 = scf.if %2329 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2311) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(2,0,7)">
            cute.memref.store(%2311, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(2,0,7)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2311) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2311 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2311) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2311) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2311 : !memref_rmem_f32_1
          }
          %iter_5283 = cute.get_iter(%2332) : !memref_rmem_f32_1
          %lay_5284 = cute.get_layout(%2332) : !memref_rmem_f32_1
          %2333 = cute.get_shape(%lay_5284) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5285, %e1_5286, %e2_5287, %e3_5288 = cute.get_leaves(%2333) : !cute.shape<"((2,2),1,8)">
          %2334 = cute.get_stride(%lay_5284) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5289, %e1_5290, %e2_5291, %e3_5292 = cute.get_leaves(%2334) : !cute.stride<"((1,2),0,4)">
          %iter_5293 = cute.get_iter(%2332) : !memref_rmem_f32_1
          %iter_5294 = cute.get_iter(%2332) : !memref_rmem_f32_1
          %int_tuple_5295 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %sz_5296 = cute.size(%int_tuple_5295) : (!cute.int_tuple<"1">) -> !cute.int_tuple<"1">
          %e0_5297 = cute.get_leaves(%sz_5296) : !cute.int_tuple<"1">
          %int_tuple_5298 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
          %sz_5299 = cute.size(%int_tuple_5298) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
          %e0_5300 = cute.get_leaves(%sz_5299) : !cute.int_tuple<"8">
          %coord_5301 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_5302 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5303 = cute.crd2idx(%coord_5301, %lay_5302) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_5304 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5305 = cute.add_offset(%iter_5304, %idx_5303) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_5306 = cute.make_view(%tup_5305) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5307 = cute.get_iter(%view_5306) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5308, %e1_5309 = cute.get_leaves(%iter_5307) : !cute.int_tuple<"(?,?)">
          %2335 = cute.get_scalars(%e0_5308) : !cute.int_tuple<"?">
          %2336 = cute.get_scalars(%e1_5309) : !cute.int_tuple<"?">
          %iter_5310 = cute.get_iter(%view_5306) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5311, %e1_5312 = cute.get_leaves(%iter_5310) : !cute.int_tuple<"(?,?)">
          %2337 = cute.get_scalars(%e0_5311) : !cute.int_tuple<"?">
          %2338 = cute.get_scalars(%e1_5312) : !cute.int_tuple<"?">
          %iter_5313 = cute.get_iter(%view_5306) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5314, %e1_5315 = cute.get_leaves(%iter_5313) : !cute.int_tuple<"(?,?)">
          %2339 = cute.get_scalars(%e0_5314) : !cute.int_tuple<"?">
          %2340 = cute.get_scalars(%e1_5315) : !cute.int_tuple<"?">
          %coord_5316 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
          %lay_5317 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5318 = cute.crd2idx(%coord_5316, %lay_5317) : (!cute.coord<"(3,0,0)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,1)">
          %iter_5319 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5320 = cute.add_offset(%iter_5319, %idx_5318) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,1)">) -> !cute.int_tuple<"(?,?)">
          %view_5321 = cute.make_view(%tup_5320) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5322 = cute.get_iter(%view_5321) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5323, %e1_5324 = cute.get_leaves(%iter_5322) : !cute.int_tuple<"(?,?)">
          %2341 = cute.get_scalars(%e0_5323) : !cute.int_tuple<"?">
          %2342 = cute.get_scalars(%e1_5324) : !cute.int_tuple<"?">
          %iter_5325 = cute.get_iter(%view_5321) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5326, %e1_5327 = cute.get_leaves(%iter_5325) : !cute.int_tuple<"(?,?)">
          %2343 = cute.get_scalars(%e0_5326) : !cute.int_tuple<"?">
          %2344 = cute.get_scalars(%e1_5327) : !cute.int_tuple<"?">
          %iter_5328 = cute.get_iter(%view_5321) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5329, %e1_5330 = cute.get_leaves(%iter_5328) : !cute.int_tuple<"(?,?)">
          %2345 = cute.get_scalars(%e0_5329) : !cute.int_tuple<"?">
          %2346 = cute.get_scalars(%e1_5330) : !cute.int_tuple<"?">
          %coord_5331 = cute.make_coord(%e0_5314) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5332 = cute.make_coord(%e1_5330) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2347 = cute.get_scalars(%coord_5331) : !cute.coord<"?">
          %2348 = cute.get_scalars(%coord_5332) : !cute.coord<"?">
          %true_5333 = arith.constant true
          %2349 = arith.cmpi slt, %2347, %2348 : i32
          %2350 = arith.andi %true_5333, %2349 : i1
          %lay_5334 = cute.get_layout(%2332) : !memref_rmem_f32_1
          %2351 = cute.get_shape(%lay_5334) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5335, %e1_5336, %e2_5337, %e3_5338 = cute.get_leaves(%2351) : !cute.shape<"((2,2),1,8)">
          %2352 = cute.get_stride(%lay_5334) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5339, %e1_5340, %e2_5341, %e3_5342 = cute.get_leaves(%2352) : !cute.stride<"((1,2),0,4)">
          %2353 = scf.if %2350 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2332) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,0)">
            cute.memref.store(%2332, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,0)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2332) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2332 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2332) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2332) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2332 : !memref_rmem_f32_1
          }
          %iter_5343 = cute.get_iter(%2353) : !memref_rmem_f32_1
          %lay_5344 = cute.get_layout(%2353) : !memref_rmem_f32_1
          %2354 = cute.get_shape(%lay_5344) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5345, %e1_5346, %e2_5347, %e3_5348 = cute.get_leaves(%2354) : !cute.shape<"((2,2),1,8)">
          %2355 = cute.get_stride(%lay_5344) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5349, %e1_5350, %e2_5351, %e3_5352 = cute.get_leaves(%2355) : !cute.stride<"((1,2),0,4)">
          %iter_5353 = cute.get_iter(%2353) : !memref_rmem_f32_1
          %iter_5354 = cute.get_iter(%2353) : !memref_rmem_f32_1
          %coord_5355 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_5356 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5357 = cute.crd2idx(%coord_5355, %lay_5356) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_5358 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5359 = cute.add_offset(%iter_5358, %idx_5357) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_5360 = cute.make_view(%tup_5359) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5361 = cute.get_iter(%view_5360) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5362, %e1_5363 = cute.get_leaves(%iter_5361) : !cute.int_tuple<"(?,?)">
          %2356 = cute.get_scalars(%e0_5362) : !cute.int_tuple<"?">
          %2357 = cute.get_scalars(%e1_5363) : !cute.int_tuple<"?">
          %iter_5364 = cute.get_iter(%view_5360) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5365, %e1_5366 = cute.get_leaves(%iter_5364) : !cute.int_tuple<"(?,?)">
          %2358 = cute.get_scalars(%e0_5365) : !cute.int_tuple<"?">
          %2359 = cute.get_scalars(%e1_5366) : !cute.int_tuple<"?">
          %iter_5367 = cute.get_iter(%view_5360) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5368, %e1_5369 = cute.get_leaves(%iter_5367) : !cute.int_tuple<"(?,?)">
          %2360 = cute.get_scalars(%e0_5368) : !cute.int_tuple<"?">
          %2361 = cute.get_scalars(%e1_5369) : !cute.int_tuple<"?">
          %coord_5370 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
          %lay_5371 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5372 = cute.crd2idx(%coord_5370, %lay_5371) : (!cute.coord<"(3,0,1)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,9)">
          %iter_5373 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5374 = cute.add_offset(%iter_5373, %idx_5372) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,9)">) -> !cute.int_tuple<"(?,?)">
          %view_5375 = cute.make_view(%tup_5374) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5376 = cute.get_iter(%view_5375) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5377, %e1_5378 = cute.get_leaves(%iter_5376) : !cute.int_tuple<"(?,?)">
          %2362 = cute.get_scalars(%e0_5377) : !cute.int_tuple<"?">
          %2363 = cute.get_scalars(%e1_5378) : !cute.int_tuple<"?">
          %iter_5379 = cute.get_iter(%view_5375) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5380, %e1_5381 = cute.get_leaves(%iter_5379) : !cute.int_tuple<"(?,?)">
          %2364 = cute.get_scalars(%e0_5380) : !cute.int_tuple<"?">
          %2365 = cute.get_scalars(%e1_5381) : !cute.int_tuple<"?">
          %iter_5382 = cute.get_iter(%view_5375) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5383, %e1_5384 = cute.get_leaves(%iter_5382) : !cute.int_tuple<"(?,?)">
          %2366 = cute.get_scalars(%e0_5383) : !cute.int_tuple<"?">
          %2367 = cute.get_scalars(%e1_5384) : !cute.int_tuple<"?">
          %coord_5385 = cute.make_coord(%e0_5368) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5386 = cute.make_coord(%e1_5384) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2368 = cute.get_scalars(%coord_5385) : !cute.coord<"?">
          %2369 = cute.get_scalars(%coord_5386) : !cute.coord<"?">
          %true_5387 = arith.constant true
          %2370 = arith.cmpi slt, %2368, %2369 : i32
          %2371 = arith.andi %true_5387, %2370 : i1
          %lay_5388 = cute.get_layout(%2353) : !memref_rmem_f32_1
          %2372 = cute.get_shape(%lay_5388) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5389, %e1_5390, %e2_5391, %e3_5392 = cute.get_leaves(%2372) : !cute.shape<"((2,2),1,8)">
          %2373 = cute.get_stride(%lay_5388) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5393, %e1_5394, %e2_5395, %e3_5396 = cute.get_leaves(%2373) : !cute.stride<"((1,2),0,4)">
          %2374 = scf.if %2371 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2353) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,1)">
            cute.memref.store(%2353, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,1)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2353) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2353 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2353) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2353) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2353 : !memref_rmem_f32_1
          }
          %iter_5397 = cute.get_iter(%2374) : !memref_rmem_f32_1
          %lay_5398 = cute.get_layout(%2374) : !memref_rmem_f32_1
          %2375 = cute.get_shape(%lay_5398) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5399, %e1_5400, %e2_5401, %e3_5402 = cute.get_leaves(%2375) : !cute.shape<"((2,2),1,8)">
          %2376 = cute.get_stride(%lay_5398) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5403, %e1_5404, %e2_5405, %e3_5406 = cute.get_leaves(%2376) : !cute.stride<"((1,2),0,4)">
          %iter_5407 = cute.get_iter(%2374) : !memref_rmem_f32_1
          %iter_5408 = cute.get_iter(%2374) : !memref_rmem_f32_1
          %coord_5409 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_5410 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5411 = cute.crd2idx(%coord_5409, %lay_5410) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_5412 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5413 = cute.add_offset(%iter_5412, %idx_5411) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_5414 = cute.make_view(%tup_5413) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5415 = cute.get_iter(%view_5414) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5416, %e1_5417 = cute.get_leaves(%iter_5415) : !cute.int_tuple<"(?,?)">
          %2377 = cute.get_scalars(%e0_5416) : !cute.int_tuple<"?">
          %2378 = cute.get_scalars(%e1_5417) : !cute.int_tuple<"?">
          %iter_5418 = cute.get_iter(%view_5414) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5419, %e1_5420 = cute.get_leaves(%iter_5418) : !cute.int_tuple<"(?,?)">
          %2379 = cute.get_scalars(%e0_5419) : !cute.int_tuple<"?">
          %2380 = cute.get_scalars(%e1_5420) : !cute.int_tuple<"?">
          %iter_5421 = cute.get_iter(%view_5414) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5422, %e1_5423 = cute.get_leaves(%iter_5421) : !cute.int_tuple<"(?,?)">
          %2381 = cute.get_scalars(%e0_5422) : !cute.int_tuple<"?">
          %2382 = cute.get_scalars(%e1_5423) : !cute.int_tuple<"?">
          %coord_5424 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
          %lay_5425 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5426 = cute.crd2idx(%coord_5424, %lay_5425) : (!cute.coord<"(3,0,2)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,17)">
          %iter_5427 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5428 = cute.add_offset(%iter_5427, %idx_5426) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,17)">) -> !cute.int_tuple<"(?,?)">
          %view_5429 = cute.make_view(%tup_5428) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5430 = cute.get_iter(%view_5429) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5431, %e1_5432 = cute.get_leaves(%iter_5430) : !cute.int_tuple<"(?,?)">
          %2383 = cute.get_scalars(%e0_5431) : !cute.int_tuple<"?">
          %2384 = cute.get_scalars(%e1_5432) : !cute.int_tuple<"?">
          %iter_5433 = cute.get_iter(%view_5429) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5434, %e1_5435 = cute.get_leaves(%iter_5433) : !cute.int_tuple<"(?,?)">
          %2385 = cute.get_scalars(%e0_5434) : !cute.int_tuple<"?">
          %2386 = cute.get_scalars(%e1_5435) : !cute.int_tuple<"?">
          %iter_5436 = cute.get_iter(%view_5429) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5437, %e1_5438 = cute.get_leaves(%iter_5436) : !cute.int_tuple<"(?,?)">
          %2387 = cute.get_scalars(%e0_5437) : !cute.int_tuple<"?">
          %2388 = cute.get_scalars(%e1_5438) : !cute.int_tuple<"?">
          %coord_5439 = cute.make_coord(%e0_5422) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5440 = cute.make_coord(%e1_5438) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2389 = cute.get_scalars(%coord_5439) : !cute.coord<"?">
          %2390 = cute.get_scalars(%coord_5440) : !cute.coord<"?">
          %true_5441 = arith.constant true
          %2391 = arith.cmpi slt, %2389, %2390 : i32
          %2392 = arith.andi %true_5441, %2391 : i1
          %lay_5442 = cute.get_layout(%2374) : !memref_rmem_f32_1
          %2393 = cute.get_shape(%lay_5442) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5443, %e1_5444, %e2_5445, %e3_5446 = cute.get_leaves(%2393) : !cute.shape<"((2,2),1,8)">
          %2394 = cute.get_stride(%lay_5442) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5447, %e1_5448, %e2_5449, %e3_5450 = cute.get_leaves(%2394) : !cute.stride<"((1,2),0,4)">
          %2395 = scf.if %2392 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2374) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,2)">
            cute.memref.store(%2374, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,2)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2374) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2374 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2374) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2374) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2374 : !memref_rmem_f32_1
          }
          %iter_5451 = cute.get_iter(%2395) : !memref_rmem_f32_1
          %lay_5452 = cute.get_layout(%2395) : !memref_rmem_f32_1
          %2396 = cute.get_shape(%lay_5452) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5453, %e1_5454, %e2_5455, %e3_5456 = cute.get_leaves(%2396) : !cute.shape<"((2,2),1,8)">
          %2397 = cute.get_stride(%lay_5452) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5457, %e1_5458, %e2_5459, %e3_5460 = cute.get_leaves(%2397) : !cute.stride<"((1,2),0,4)">
          %iter_5461 = cute.get_iter(%2395) : !memref_rmem_f32_1
          %iter_5462 = cute.get_iter(%2395) : !memref_rmem_f32_1
          %coord_5463 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_5464 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5465 = cute.crd2idx(%coord_5463, %lay_5464) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_5466 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5467 = cute.add_offset(%iter_5466, %idx_5465) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_5468 = cute.make_view(%tup_5467) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5469 = cute.get_iter(%view_5468) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5470, %e1_5471 = cute.get_leaves(%iter_5469) : !cute.int_tuple<"(?,?)">
          %2398 = cute.get_scalars(%e0_5470) : !cute.int_tuple<"?">
          %2399 = cute.get_scalars(%e1_5471) : !cute.int_tuple<"?">
          %iter_5472 = cute.get_iter(%view_5468) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5473, %e1_5474 = cute.get_leaves(%iter_5472) : !cute.int_tuple<"(?,?)">
          %2400 = cute.get_scalars(%e0_5473) : !cute.int_tuple<"?">
          %2401 = cute.get_scalars(%e1_5474) : !cute.int_tuple<"?">
          %iter_5475 = cute.get_iter(%view_5468) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5476, %e1_5477 = cute.get_leaves(%iter_5475) : !cute.int_tuple<"(?,?)">
          %2402 = cute.get_scalars(%e0_5476) : !cute.int_tuple<"?">
          %2403 = cute.get_scalars(%e1_5477) : !cute.int_tuple<"?">
          %coord_5478 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
          %lay_5479 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5480 = cute.crd2idx(%coord_5478, %lay_5479) : (!cute.coord<"(3,0,3)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,25)">
          %iter_5481 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5482 = cute.add_offset(%iter_5481, %idx_5480) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,25)">) -> !cute.int_tuple<"(?,?)">
          %view_5483 = cute.make_view(%tup_5482) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5484 = cute.get_iter(%view_5483) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5485, %e1_5486 = cute.get_leaves(%iter_5484) : !cute.int_tuple<"(?,?)">
          %2404 = cute.get_scalars(%e0_5485) : !cute.int_tuple<"?">
          %2405 = cute.get_scalars(%e1_5486) : !cute.int_tuple<"?">
          %iter_5487 = cute.get_iter(%view_5483) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5488, %e1_5489 = cute.get_leaves(%iter_5487) : !cute.int_tuple<"(?,?)">
          %2406 = cute.get_scalars(%e0_5488) : !cute.int_tuple<"?">
          %2407 = cute.get_scalars(%e1_5489) : !cute.int_tuple<"?">
          %iter_5490 = cute.get_iter(%view_5483) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5491, %e1_5492 = cute.get_leaves(%iter_5490) : !cute.int_tuple<"(?,?)">
          %2408 = cute.get_scalars(%e0_5491) : !cute.int_tuple<"?">
          %2409 = cute.get_scalars(%e1_5492) : !cute.int_tuple<"?">
          %coord_5493 = cute.make_coord(%e0_5476) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5494 = cute.make_coord(%e1_5492) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2410 = cute.get_scalars(%coord_5493) : !cute.coord<"?">
          %2411 = cute.get_scalars(%coord_5494) : !cute.coord<"?">
          %true_5495 = arith.constant true
          %2412 = arith.cmpi slt, %2410, %2411 : i32
          %2413 = arith.andi %true_5495, %2412 : i1
          %lay_5496 = cute.get_layout(%2395) : !memref_rmem_f32_1
          %2414 = cute.get_shape(%lay_5496) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5497, %e1_5498, %e2_5499, %e3_5500 = cute.get_leaves(%2414) : !cute.shape<"((2,2),1,8)">
          %2415 = cute.get_stride(%lay_5496) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5501, %e1_5502, %e2_5503, %e3_5504 = cute.get_leaves(%2415) : !cute.stride<"((1,2),0,4)">
          %2416 = scf.if %2413 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2395) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,3)">
            cute.memref.store(%2395, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,3)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2395) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2395 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2395) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2395) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2395 : !memref_rmem_f32_1
          }
          %iter_5505 = cute.get_iter(%2416) : !memref_rmem_f32_1
          %lay_5506 = cute.get_layout(%2416) : !memref_rmem_f32_1
          %2417 = cute.get_shape(%lay_5506) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5507, %e1_5508, %e2_5509, %e3_5510 = cute.get_leaves(%2417) : !cute.shape<"((2,2),1,8)">
          %2418 = cute.get_stride(%lay_5506) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5511, %e1_5512, %e2_5513, %e3_5514 = cute.get_leaves(%2418) : !cute.stride<"((1,2),0,4)">
          %iter_5515 = cute.get_iter(%2416) : !memref_rmem_f32_1
          %iter_5516 = cute.get_iter(%2416) : !memref_rmem_f32_1
          %coord_5517 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_5518 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5519 = cute.crd2idx(%coord_5517, %lay_5518) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_5520 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5521 = cute.add_offset(%iter_5520, %idx_5519) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_5522 = cute.make_view(%tup_5521) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5523 = cute.get_iter(%view_5522) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5524, %e1_5525 = cute.get_leaves(%iter_5523) : !cute.int_tuple<"(?,?)">
          %2419 = cute.get_scalars(%e0_5524) : !cute.int_tuple<"?">
          %2420 = cute.get_scalars(%e1_5525) : !cute.int_tuple<"?">
          %iter_5526 = cute.get_iter(%view_5522) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5527, %e1_5528 = cute.get_leaves(%iter_5526) : !cute.int_tuple<"(?,?)">
          %2421 = cute.get_scalars(%e0_5527) : !cute.int_tuple<"?">
          %2422 = cute.get_scalars(%e1_5528) : !cute.int_tuple<"?">
          %iter_5529 = cute.get_iter(%view_5522) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5530, %e1_5531 = cute.get_leaves(%iter_5529) : !cute.int_tuple<"(?,?)">
          %2423 = cute.get_scalars(%e0_5530) : !cute.int_tuple<"?">
          %2424 = cute.get_scalars(%e1_5531) : !cute.int_tuple<"?">
          %coord_5532 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
          %lay_5533 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5534 = cute.crd2idx(%coord_5532, %lay_5533) : (!cute.coord<"(3,0,4)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,33)">
          %iter_5535 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5536 = cute.add_offset(%iter_5535, %idx_5534) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,33)">) -> !cute.int_tuple<"(?,?)">
          %view_5537 = cute.make_view(%tup_5536) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5538 = cute.get_iter(%view_5537) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5539, %e1_5540 = cute.get_leaves(%iter_5538) : !cute.int_tuple<"(?,?)">
          %2425 = cute.get_scalars(%e0_5539) : !cute.int_tuple<"?">
          %2426 = cute.get_scalars(%e1_5540) : !cute.int_tuple<"?">
          %iter_5541 = cute.get_iter(%view_5537) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5542, %e1_5543 = cute.get_leaves(%iter_5541) : !cute.int_tuple<"(?,?)">
          %2427 = cute.get_scalars(%e0_5542) : !cute.int_tuple<"?">
          %2428 = cute.get_scalars(%e1_5543) : !cute.int_tuple<"?">
          %iter_5544 = cute.get_iter(%view_5537) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5545, %e1_5546 = cute.get_leaves(%iter_5544) : !cute.int_tuple<"(?,?)">
          %2429 = cute.get_scalars(%e0_5545) : !cute.int_tuple<"?">
          %2430 = cute.get_scalars(%e1_5546) : !cute.int_tuple<"?">
          %coord_5547 = cute.make_coord(%e0_5530) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5548 = cute.make_coord(%e1_5546) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2431 = cute.get_scalars(%coord_5547) : !cute.coord<"?">
          %2432 = cute.get_scalars(%coord_5548) : !cute.coord<"?">
          %true_5549 = arith.constant true
          %2433 = arith.cmpi slt, %2431, %2432 : i32
          %2434 = arith.andi %true_5549, %2433 : i1
          %lay_5550 = cute.get_layout(%2416) : !memref_rmem_f32_1
          %2435 = cute.get_shape(%lay_5550) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5551, %e1_5552, %e2_5553, %e3_5554 = cute.get_leaves(%2435) : !cute.shape<"((2,2),1,8)">
          %2436 = cute.get_stride(%lay_5550) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5555, %e1_5556, %e2_5557, %e3_5558 = cute.get_leaves(%2436) : !cute.stride<"((1,2),0,4)">
          %2437 = scf.if %2434 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2416) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,4)">
            cute.memref.store(%2416, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,4)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2416) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2416 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2416) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2416) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2416 : !memref_rmem_f32_1
          }
          %iter_5559 = cute.get_iter(%2437) : !memref_rmem_f32_1
          %lay_5560 = cute.get_layout(%2437) : !memref_rmem_f32_1
          %2438 = cute.get_shape(%lay_5560) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5561, %e1_5562, %e2_5563, %e3_5564 = cute.get_leaves(%2438) : !cute.shape<"((2,2),1,8)">
          %2439 = cute.get_stride(%lay_5560) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5565, %e1_5566, %e2_5567, %e3_5568 = cute.get_leaves(%2439) : !cute.stride<"((1,2),0,4)">
          %iter_5569 = cute.get_iter(%2437) : !memref_rmem_f32_1
          %iter_5570 = cute.get_iter(%2437) : !memref_rmem_f32_1
          %coord_5571 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_5572 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5573 = cute.crd2idx(%coord_5571, %lay_5572) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_5574 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5575 = cute.add_offset(%iter_5574, %idx_5573) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_5576 = cute.make_view(%tup_5575) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5577 = cute.get_iter(%view_5576) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5578, %e1_5579 = cute.get_leaves(%iter_5577) : !cute.int_tuple<"(?,?)">
          %2440 = cute.get_scalars(%e0_5578) : !cute.int_tuple<"?">
          %2441 = cute.get_scalars(%e1_5579) : !cute.int_tuple<"?">
          %iter_5580 = cute.get_iter(%view_5576) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5581, %e1_5582 = cute.get_leaves(%iter_5580) : !cute.int_tuple<"(?,?)">
          %2442 = cute.get_scalars(%e0_5581) : !cute.int_tuple<"?">
          %2443 = cute.get_scalars(%e1_5582) : !cute.int_tuple<"?">
          %iter_5583 = cute.get_iter(%view_5576) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5584, %e1_5585 = cute.get_leaves(%iter_5583) : !cute.int_tuple<"(?,?)">
          %2444 = cute.get_scalars(%e0_5584) : !cute.int_tuple<"?">
          %2445 = cute.get_scalars(%e1_5585) : !cute.int_tuple<"?">
          %coord_5586 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
          %lay_5587 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5588 = cute.crd2idx(%coord_5586, %lay_5587) : (!cute.coord<"(3,0,5)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,41)">
          %iter_5589 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5590 = cute.add_offset(%iter_5589, %idx_5588) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,41)">) -> !cute.int_tuple<"(?,?)">
          %view_5591 = cute.make_view(%tup_5590) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5592 = cute.get_iter(%view_5591) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5593, %e1_5594 = cute.get_leaves(%iter_5592) : !cute.int_tuple<"(?,?)">
          %2446 = cute.get_scalars(%e0_5593) : !cute.int_tuple<"?">
          %2447 = cute.get_scalars(%e1_5594) : !cute.int_tuple<"?">
          %iter_5595 = cute.get_iter(%view_5591) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5596, %e1_5597 = cute.get_leaves(%iter_5595) : !cute.int_tuple<"(?,?)">
          %2448 = cute.get_scalars(%e0_5596) : !cute.int_tuple<"?">
          %2449 = cute.get_scalars(%e1_5597) : !cute.int_tuple<"?">
          %iter_5598 = cute.get_iter(%view_5591) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5599, %e1_5600 = cute.get_leaves(%iter_5598) : !cute.int_tuple<"(?,?)">
          %2450 = cute.get_scalars(%e0_5599) : !cute.int_tuple<"?">
          %2451 = cute.get_scalars(%e1_5600) : !cute.int_tuple<"?">
          %coord_5601 = cute.make_coord(%e0_5584) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5602 = cute.make_coord(%e1_5600) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2452 = cute.get_scalars(%coord_5601) : !cute.coord<"?">
          %2453 = cute.get_scalars(%coord_5602) : !cute.coord<"?">
          %true_5603 = arith.constant true
          %2454 = arith.cmpi slt, %2452, %2453 : i32
          %2455 = arith.andi %true_5603, %2454 : i1
          %lay_5604 = cute.get_layout(%2437) : !memref_rmem_f32_1
          %2456 = cute.get_shape(%lay_5604) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5605, %e1_5606, %e2_5607, %e3_5608 = cute.get_leaves(%2456) : !cute.shape<"((2,2),1,8)">
          %2457 = cute.get_stride(%lay_5604) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5609, %e1_5610, %e2_5611, %e3_5612 = cute.get_leaves(%2457) : !cute.stride<"((1,2),0,4)">
          %2458 = scf.if %2455 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2437) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,5)">
            cute.memref.store(%2437, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,5)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2437) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2437 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2437) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2437) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2437 : !memref_rmem_f32_1
          }
          %iter_5613 = cute.get_iter(%2458) : !memref_rmem_f32_1
          %lay_5614 = cute.get_layout(%2458) : !memref_rmem_f32_1
          %2459 = cute.get_shape(%lay_5614) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5615, %e1_5616, %e2_5617, %e3_5618 = cute.get_leaves(%2459) : !cute.shape<"((2,2),1,8)">
          %2460 = cute.get_stride(%lay_5614) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5619, %e1_5620, %e2_5621, %e3_5622 = cute.get_leaves(%2460) : !cute.stride<"((1,2),0,4)">
          %iter_5623 = cute.get_iter(%2458) : !memref_rmem_f32_1
          %iter_5624 = cute.get_iter(%2458) : !memref_rmem_f32_1
          %coord_5625 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_5626 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5627 = cute.crd2idx(%coord_5625, %lay_5626) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_5628 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5629 = cute.add_offset(%iter_5628, %idx_5627) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_5630 = cute.make_view(%tup_5629) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5631 = cute.get_iter(%view_5630) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5632, %e1_5633 = cute.get_leaves(%iter_5631) : !cute.int_tuple<"(?,?)">
          %2461 = cute.get_scalars(%e0_5632) : !cute.int_tuple<"?">
          %2462 = cute.get_scalars(%e1_5633) : !cute.int_tuple<"?">
          %iter_5634 = cute.get_iter(%view_5630) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5635, %e1_5636 = cute.get_leaves(%iter_5634) : !cute.int_tuple<"(?,?)">
          %2463 = cute.get_scalars(%e0_5635) : !cute.int_tuple<"?">
          %2464 = cute.get_scalars(%e1_5636) : !cute.int_tuple<"?">
          %iter_5637 = cute.get_iter(%view_5630) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5638, %e1_5639 = cute.get_leaves(%iter_5637) : !cute.int_tuple<"(?,?)">
          %2465 = cute.get_scalars(%e0_5638) : !cute.int_tuple<"?">
          %2466 = cute.get_scalars(%e1_5639) : !cute.int_tuple<"?">
          %coord_5640 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
          %lay_5641 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5642 = cute.crd2idx(%coord_5640, %lay_5641) : (!cute.coord<"(3,0,6)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,49)">
          %iter_5643 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5644 = cute.add_offset(%iter_5643, %idx_5642) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,49)">) -> !cute.int_tuple<"(?,?)">
          %view_5645 = cute.make_view(%tup_5644) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5646 = cute.get_iter(%view_5645) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5647, %e1_5648 = cute.get_leaves(%iter_5646) : !cute.int_tuple<"(?,?)">
          %2467 = cute.get_scalars(%e0_5647) : !cute.int_tuple<"?">
          %2468 = cute.get_scalars(%e1_5648) : !cute.int_tuple<"?">
          %iter_5649 = cute.get_iter(%view_5645) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5650, %e1_5651 = cute.get_leaves(%iter_5649) : !cute.int_tuple<"(?,?)">
          %2469 = cute.get_scalars(%e0_5650) : !cute.int_tuple<"?">
          %2470 = cute.get_scalars(%e1_5651) : !cute.int_tuple<"?">
          %iter_5652 = cute.get_iter(%view_5645) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5653, %e1_5654 = cute.get_leaves(%iter_5652) : !cute.int_tuple<"(?,?)">
          %2471 = cute.get_scalars(%e0_5653) : !cute.int_tuple<"?">
          %2472 = cute.get_scalars(%e1_5654) : !cute.int_tuple<"?">
          %coord_5655 = cute.make_coord(%e0_5638) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5656 = cute.make_coord(%e1_5654) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2473 = cute.get_scalars(%coord_5655) : !cute.coord<"?">
          %2474 = cute.get_scalars(%coord_5656) : !cute.coord<"?">
          %true_5657 = arith.constant true
          %2475 = arith.cmpi slt, %2473, %2474 : i32
          %2476 = arith.andi %true_5657, %2475 : i1
          %lay_5658 = cute.get_layout(%2458) : !memref_rmem_f32_1
          %2477 = cute.get_shape(%lay_5658) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5659, %e1_5660, %e2_5661, %e3_5662 = cute.get_leaves(%2477) : !cute.shape<"((2,2),1,8)">
          %2478 = cute.get_stride(%lay_5658) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5663, %e1_5664, %e2_5665, %e3_5666 = cute.get_leaves(%2478) : !cute.stride<"((1,2),0,4)">
          %2479 = scf.if %2476 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2458) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,6)">
            cute.memref.store(%2458, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,6)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2458) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2458 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2458) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2458) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2458 : !memref_rmem_f32_1
          }
          %iter_5667 = cute.get_iter(%2479) : !memref_rmem_f32_1
          %lay_5668 = cute.get_layout(%2479) : !memref_rmem_f32_1
          %2480 = cute.get_shape(%lay_5668) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5669, %e1_5670, %e2_5671, %e3_5672 = cute.get_leaves(%2480) : !cute.shape<"((2,2),1,8)">
          %2481 = cute.get_stride(%lay_5668) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5673, %e1_5674, %e2_5675, %e3_5676 = cute.get_leaves(%2481) : !cute.stride<"((1,2),0,4)">
          %iter_5677 = cute.get_iter(%2479) : !memref_rmem_f32_1
          %iter_5678 = cute.get_iter(%2479) : !memref_rmem_f32_1
          %coord_5679 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_5680 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5681 = cute.crd2idx(%coord_5679, %lay_5680) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_5682 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5683 = cute.add_offset(%iter_5682, %idx_5681) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_5684 = cute.make_view(%tup_5683) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5685 = cute.get_iter(%view_5684) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5686, %e1_5687 = cute.get_leaves(%iter_5685) : !cute.int_tuple<"(?,?)">
          %2482 = cute.get_scalars(%e0_5686) : !cute.int_tuple<"?">
          %2483 = cute.get_scalars(%e1_5687) : !cute.int_tuple<"?">
          %iter_5688 = cute.get_iter(%view_5684) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5689, %e1_5690 = cute.get_leaves(%iter_5688) : !cute.int_tuple<"(?,?)">
          %2484 = cute.get_scalars(%e0_5689) : !cute.int_tuple<"?">
          %2485 = cute.get_scalars(%e1_5690) : !cute.int_tuple<"?">
          %iter_5691 = cute.get_iter(%view_5684) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5692, %e1_5693 = cute.get_leaves(%iter_5691) : !cute.int_tuple<"(?,?)">
          %2486 = cute.get_scalars(%e0_5692) : !cute.int_tuple<"?">
          %2487 = cute.get_scalars(%e1_5693) : !cute.int_tuple<"?">
          %coord_5694 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
          %lay_5695 = cute.get_layout(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %idx_5696 = cute.crd2idx(%coord_5694, %lay_5695) : (!cute.coord<"(3,0,7)">, !cute.layout<"((2,2),1,8):((1@1,8@0),0,8@1)">) -> !cute.int_tuple<"(8,57)">
          %iter_5697 = cute.get_iter(%view_3969) : !cute.coord_tensor<"(?,?{div=2})", "((2,2),1,8):((1@1,8@0),0,8@1)">
          %tup_5698 = cute.add_offset(%iter_5697, %idx_5696) : (!cute.int_tuple<"(?,?{div=2})">, !cute.int_tuple<"(8,57)">) -> !cute.int_tuple<"(?,?)">
          %view_5699 = cute.make_view(%tup_5698) : !cute.coord_tensor<"(?,?)", "():()">
          %iter_5700 = cute.get_iter(%view_5699) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5701, %e1_5702 = cute.get_leaves(%iter_5700) : !cute.int_tuple<"(?,?)">
          %2488 = cute.get_scalars(%e0_5701) : !cute.int_tuple<"?">
          %2489 = cute.get_scalars(%e1_5702) : !cute.int_tuple<"?">
          %iter_5703 = cute.get_iter(%view_5699) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5704, %e1_5705 = cute.get_leaves(%iter_5703) : !cute.int_tuple<"(?,?)">
          %2490 = cute.get_scalars(%e0_5704) : !cute.int_tuple<"?">
          %2491 = cute.get_scalars(%e1_5705) : !cute.int_tuple<"?">
          %iter_5706 = cute.get_iter(%view_5699) : !cute.coord_tensor<"(?,?)", "():()">
          %e0_5707, %e1_5708 = cute.get_leaves(%iter_5706) : !cute.int_tuple<"(?,?)">
          %2492 = cute.get_scalars(%e0_5707) : !cute.int_tuple<"?">
          %2493 = cute.get_scalars(%e1_5708) : !cute.int_tuple<"?">
          %coord_5709 = cute.make_coord(%e0_5692) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_5710 = cute.make_coord(%e1_5708) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2494 = cute.get_scalars(%coord_5709) : !cute.coord<"?">
          %2495 = cute.get_scalars(%coord_5710) : !cute.coord<"?">
          %true_5711 = arith.constant true
          %2496 = arith.cmpi slt, %2494, %2495 : i32
          %2497 = arith.andi %true_5711, %2496 : i1
          %lay_5712 = cute.get_layout(%2479) : !memref_rmem_f32_1
          %2498 = cute.get_shape(%lay_5712) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5713, %e1_5714, %e2_5715, %e3_5716 = cute.get_leaves(%2498) : !cute.shape<"((2,2),1,8)">
          %2499 = cute.get_stride(%lay_5712) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5717, %e1_5718, %e2_5719, %e3_5720 = cute.get_leaves(%2499) : !cute.stride<"((1,2),0,4)">
          %2500 = scf.if %2497 -> (!memref_rmem_f32_1) {
            %iter_5790 = cute.get_iter(%2479) : !memref_rmem_f32_1
            %cst_5791 = arith.constant 0.000000e+00 : f32
            %coord_5792 = cute.make_coord() : () -> !cute.coord<"(3,0,7)">
            cute.memref.store(%2479, %coord_5792, %cst_5791) : (!memref_rmem_f32_1, !cute.coord<"(3,0,7)">, f32) -> ()
            %lay_5793 = cute.get_layout(%2479) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5793) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2479 : !memref_rmem_f32_1
          } else {
            %iter_5790 = cute.get_iter(%2479) : !memref_rmem_f32_1
            %lay_5791 = cute.get_layout(%2479) : !memref_rmem_f32_1
            %2528 = cute.get_shape(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
            %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%2528) : !cute.shape<"((2,2),1,8)">
            %2529 = cute.get_stride(%lay_5791) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
            %e0_5796, %e1_5797, %e2_5798, %e3_5799 = cute.get_leaves(%2529) : !cute.stride<"((1,2),0,4)">
            scf.yield %2479 : !memref_rmem_f32_1
          }
          %iter_5721 = cute.get_iter(%2500) : !memref_rmem_f32_1
          %lay_5722 = cute.get_layout(%2500) : !memref_rmem_f32_1
          %2501 = cute.get_shape(%lay_5722) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5723, %e1_5724, %e2_5725, %e3_5726 = cute.get_leaves(%2501) : !cute.shape<"((2,2),1,8)">
          %2502 = cute.get_stride(%lay_5722) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5727, %e1_5728, %e2_5729, %e3_5730 = cute.get_leaves(%2502) : !cute.stride<"((1,2),0,4)">
          %iter_5731 = cute.get_iter(%2500) : !memref_rmem_f32_1
          %iter_5732 = cute.get_iter(%2500) : !memref_rmem_f32_1
          %lay_5733 = cute.get_layout(%2500) : !memref_rmem_f32_1
          %2503 = cute.get_shape(%lay_5733) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_5734, %e1_5735, %e2_5736, %e3_5737 = cute.get_leaves(%2503) : !cute.shape<"((2,2),1,8)">
          %2504 = cute.get_stride(%lay_5733) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_5738, %e1_5739, %e2_5740, %e3_5741 = cute.get_leaves(%2504) : !cute.stride<"((1,2),0,4)">
          %2505 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %2506 = cute.get_shape(%2505) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_5742, %e1_5743, %e2_5744, %e3_5745 = cute.get_leaves(%2506) : !cute.shape<"(32,4,1,1)">
          %2507 = cute.get_stride(%2505) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_5746, %e1_5747, %e2_5748, %e3_5749 = cute.get_leaves(%2507) : !cute.stride<"(1,32,0,0)">
          %2508 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_5750, %e1_5751, %e2_5752 = cute.get_leaves(%2508) : !cute.tile<"[64:1;16:1;16:1]">
          %2509 = cute.get_shape(%e0_5750) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_5753 = cute.get_leaves(%2509) : !cute.shape<"64">
          %2510 = cute.get_stride(%e0_5750) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_5754 = cute.get_leaves(%2510) : !cute.stride<"1">
          %2511 = cute.get_shape(%e1_5751) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5755 = cute.get_leaves(%2511) : !cute.shape<"16">
          %2512 = cute.get_stride(%e1_5751) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5756 = cute.get_leaves(%2512) : !cute.stride<"1">
          %2513 = cute.get_shape(%e2_5752) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_5757 = cute.get_leaves(%2513) : !cute.shape<"16">
          %2514 = cute.get_stride(%e2_5752) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_5758 = cute.get_leaves(%2514) : !cute.stride<"1">
          %2515 = cute.static : !cute.layout<"32:1">
          %2516 = cute.get_shape(%2515) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_5759 = cute.get_leaves(%2516) : !cute.shape<"32">
          %2517 = cute.get_stride(%2515) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_5760 = cute.get_leaves(%2517) : !cute.stride<"1">
          %2518 = cute.static : !cute.shape<"(16,8,16)">
          %e0_5761, %e1_5762, %e2_5763 = cute.get_leaves(%2518) : !cute.shape<"(16,8,16)">
          %2519 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %2520 = cute.get_shape(%2519) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_5764, %e1_5765, %e2_5766, %e3_5767, %e4_5768 = cute.get_leaves(%2520) : !cute.shape<"((4,8),(2,2,2))">
          %2521 = cute.get_stride(%2519) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_5769, %e1_5770, %e2_5771, %e3_5772, %e4_5773 = cute.get_leaves(%2521) : !cute.stride<"((32,1),(16,8,128))">
          %2522 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %2523 = cute.get_shape(%2522) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5774, %e1_5775, %e2_5776, %e3_5777 = cute.get_leaves(%2523) : !cute.shape<"((4,8),(2,2))">
          %2524 = cute.get_stride(%2522) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_5778, %e1_5779, %e2_5780, %e3_5781 = cute.get_leaves(%2524) : !cute.stride<"((16,1),(8,64))">
          %2525 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %2526 = cute.get_shape(%2525) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_5782, %e1_5783, %e2_5784, %e3_5785 = cute.get_leaves(%2526) : !cute.shape<"((4,8),(2,2))">
          %2527 = cute.get_stride(%2525) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_5786, %e1_5787, %e2_5788, %e3_5789 = cute.get_leaves(%2527) : !cute.stride<"((32,1),(16,8))">
          scf.yield %2500, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        } else {
          %iter_3954 = cute.get_iter(%1680) : !memref_rmem_f32_1
          %lay_3955 = cute.get_layout(%1680) : !memref_rmem_f32_1
          %1817 = cute.get_shape(%lay_3955) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
          %e0_3956, %e1_3957, %e2_3958, %e3_3959 = cute.get_leaves(%1817) : !cute.shape<"((2,2),1,8)">
          %1818 = cute.get_stride(%lay_3955) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
          %e0_3960, %e1_3961, %e2_3962, %e3_3963 = cute.get_leaves(%1818) : !cute.stride<"((1,2),0,4)">
          %1819 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
          %1820 = cute.get_shape(%1819) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
          %e0_3964, %e1_3965, %e2_3966, %e3_3967 = cute.get_leaves(%1820) : !cute.shape<"(32,4,1,1)">
          %1821 = cute.get_stride(%1819) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
          %e0_3968, %e1_3969, %e2_3970, %e3_3971 = cute.get_leaves(%1821) : !cute.stride<"(1,32,0,0)">
          %1822 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
          %e0_3972, %e1_3973, %e2_3974 = cute.get_leaves(%1822) : !cute.tile<"[64:1;16:1;16:1]">
          %1823 = cute.get_shape(%e0_3972) : (!cute.layout<"64:1">) -> !cute.shape<"64">
          %e0_3975 = cute.get_leaves(%1823) : !cute.shape<"64">
          %1824 = cute.get_stride(%e0_3972) : (!cute.layout<"64:1">) -> !cute.stride<"1">
          %e0_3976 = cute.get_leaves(%1824) : !cute.stride<"1">
          %1825 = cute.get_shape(%e1_3973) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_3977 = cute.get_leaves(%1825) : !cute.shape<"16">
          %1826 = cute.get_stride(%e1_3973) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_3978 = cute.get_leaves(%1826) : !cute.stride<"1">
          %1827 = cute.get_shape(%e2_3974) : (!cute.layout<"16:1">) -> !cute.shape<"16">
          %e0_3979 = cute.get_leaves(%1827) : !cute.shape<"16">
          %1828 = cute.get_stride(%e2_3974) : (!cute.layout<"16:1">) -> !cute.stride<"1">
          %e0_3980 = cute.get_leaves(%1828) : !cute.stride<"1">
          %1829 = cute.static : !cute.layout<"32:1">
          %1830 = cute.get_shape(%1829) : (!cute.layout<"32:1">) -> !cute.shape<"32">
          %e0_3981 = cute.get_leaves(%1830) : !cute.shape<"32">
          %1831 = cute.get_stride(%1829) : (!cute.layout<"32:1">) -> !cute.stride<"1">
          %e0_3982 = cute.get_leaves(%1831) : !cute.stride<"1">
          %1832 = cute.static : !cute.shape<"(16,8,16)">
          %e0_3983, %e1_3984, %e2_3985 = cute.get_leaves(%1832) : !cute.shape<"(16,8,16)">
          %1833 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
          %1834 = cute.get_shape(%1833) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
          %e0_3986, %e1_3987, %e2_3988, %e3_3989, %e4_3990 = cute.get_leaves(%1834) : !cute.shape<"((4,8),(2,2,2))">
          %1835 = cute.get_stride(%1833) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
          %e0_3991, %e1_3992, %e2_3993, %e3_3994, %e4_3995 = cute.get_leaves(%1835) : !cute.stride<"((32,1),(16,8,128))">
          %1836 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
          %1837 = cute.get_shape(%1836) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_3996, %e1_3997, %e2_3998, %e3_3999 = cute.get_leaves(%1837) : !cute.shape<"((4,8),(2,2))">
          %1838 = cute.get_stride(%1836) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
          %e0_4000, %e1_4001, %e2_4002, %e3_4003 = cute.get_leaves(%1838) : !cute.stride<"((16,1),(8,64))">
          %1839 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
          %1840 = cute.get_shape(%1839) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
          %e0_4004, %e1_4005, %e2_4006, %e3_4007 = cute.get_leaves(%1840) : !cute.shape<"((4,8),(2,2))">
          %1841 = cute.get_stride(%1839) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
          %e0_4008, %e1_4009, %e2_4010, %e3_4011 = cute.get_leaves(%1841) : !cute.stride<"((32,1),(16,8))">
          scf.yield %1680, %arg6 : !memref_rmem_f32_1, !mma_bf16_bf16_f32_16x8x16_
        }
        %iter_3512 = cute.get_iter(%1725#0) : !memref_rmem_f32_1
        %lay_3513 = cute.get_layout(%1725#0) : !memref_rmem_f32_1
        %1726 = cute.get_shape(%lay_3513) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3514, %e1_3515, %e2_3516, %e3_3517 = cute.get_leaves(%1726) : !cute.shape<"((2,2),1,8)">
        %1727 = cute.get_stride(%lay_3513) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.stride<"((1,2),0,4)">
        %e0_3518, %e1_3519, %e2_3520, %e3_3521 = cute.get_leaves(%1727) : !cute.stride<"((1,2),0,4)">
        %iter_3522 = cute.get_iter(%1725#0) : !memref_rmem_f32_1
        %iter_3523 = cute.get_iter(%1725#0) : !memref_rmem_f32_1
        %lay_3524 = cute.get_layout(%1725#0) : !memref_rmem_f32_1
        %lay_3525 = cute.make_layout() : !cute.layout<"((2,2),1,8):((1,2),0,4)">
        %rmem_3526 = cute.memref.alloca(%lay_3525) : !memref_rmem_bf16_6
        %iter_3527 = cute.get_iter(%rmem_3526) : !memref_rmem_bf16_6
        %iter_3528 = cute.get_iter(%rmem_3526) : !memref_rmem_bf16_6
        %lay_3529 = cute.get_layout(%1725#0) : !memref_rmem_f32_1
        %1728 = cute.get_shape(%lay_3529) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3530, %e1_3531, %e2_3532, %e3_3533 = cute.get_leaves(%1728) : !cute.shape<"((2,2),1,8)">
        %1729 = cute.memref.load_vec %1725#0, row_major : !memref_rmem_f32_1
        %1730 = arith.truncf %1729 : vector<32xf32> to vector<32xbf16>
        %lay_3534 = cute.get_layout(%rmem_3526) : !memref_rmem_bf16_6
        %1731 = cute.get_shape(%lay_3534) : (!cute.layout<"((2,2),1,8):((1,2),0,4)">) -> !cute.shape<"((2,2),1,8)">
        %e0_3535, %e1_3536, %e2_3537, %e3_3538 = cute.get_leaves(%1731) : !cute.shape<"((2,2),1,8)">
        %int_tuple_3539 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_3540 = cute.size(%int_tuple_3539) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_3541 = cute.get_leaves(%sz_3540) : !cute.int_tuple<"32">
        %int_tuple_3542 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,8)">
        %sz_3543 = cute.size(%int_tuple_3542) : (!cute.int_tuple<"((2,2),1,8)">) -> !cute.int_tuple<"32">
        %e0_3544 = cute.get_leaves(%sz_3543) : !cute.int_tuple<"32">
        cute.memref.store_vec %1730, %rmem_3526, row_major : !memref_rmem_bf16_6
        %lay_3545 = cute.get_layout(%rmem_3526) : !memref_rmem_bf16_6
        %tile_3546 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_3547 = cute.make_layout() : !cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">
        %1732 = cute.get_shape(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3548, %e1_3549, %e2_3550, %e3_3551, %e4_3552 = cute.get_leaves(%1732) : !cute.shape<"((2,2),1,(2,4))">
        %1733 = cute.get_shape(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3553, %e1_3554, %e2_3555, %e3_3556, %e4_3557 = cute.get_leaves(%1733) : !cute.shape<"((2,2),1,(2,4))">
        %1734 = cute.get_shape(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3558, %e1_3559, %e2_3560, %e3_3561, %e4_3562 = cute.get_leaves(%1734) : !cute.shape<"((2,2),1,(2,4))">
        %1735 = cute.get_shape(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.shape<"((2,2),1,(2,4))">
        %e0_3563, %e1_3564, %e2_3565, %e3_3566, %e4_3567 = cute.get_leaves(%1735) : !cute.shape<"((2,2),1,(2,4))">
        %1736 = cute.get_stride(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3568, %e1_3569, %e2_3570, %e3_3571, %e4_3572 = cute.get_leaves(%1736) : !cute.stride<"((1,2),0,(4,8))">
        %1737 = cute.get_stride(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3573, %e1_3574, %e2_3575, %e3_3576, %e4_3577 = cute.get_leaves(%1737) : !cute.stride<"((1,2),0,(4,8))">
        %1738 = cute.get_stride(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3578, %e1_3579, %e2_3580, %e3_3581, %e4_3582 = cute.get_leaves(%1738) : !cute.stride<"((1,2),0,(4,8))">
        %1739 = cute.get_stride(%lay_3547) : (!cute.layout<"((2,2),1,(2,4)):((1,2),0,(4,8))">) -> !cute.stride<"((1,2),0,(4,8))">
        %e0_3583, %e1_3584, %e2_3585, %e3_3586, %e4_3587 = cute.get_leaves(%1739) : !cute.stride<"((1,2),0,(4,8))">
        %shape_3588 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),1,4)">
        %stride_3589 = cute.make_stride() : () -> !cute.stride<"(((1,2),4),0,8)">
        %lay_3590 = cute.make_layout() : !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">
        %view_3591 = cute.make_view(%iter_3528, %lay_3590) : !memref_rmem_bf16_19
        %iter_3592 = cute.get_iter(%view_3591) : !memref_rmem_bf16_19
        %coord_3593 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3594 = cute.get_layout(%view_984) : !memref_smem_bf16_10
        %1740:2 = cute.get_scalars(%lay_3594) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_3595 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_3596 = cute.assume(%1740#0) : (i32) -> !cute.i32<divby 16>
        %iv_3597 = cute.assume(%1740#1) : (i32) -> !cute.i32<divby 32>
        %stride_3598 = cute.make_stride(%iv_3596, %iv_3597) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_3599 = cute.make_layout(%shape_3595, %stride_3598) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_3600 = cute.crd2idx(%coord_3593, %lay_3594) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_3601 = cute.get_iter(%view_984) : !memref_smem_bf16_10
        %ptr_3602 = cute.add_offset(%iter_3601, %idx_3600) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_3603 = cute.make_view(%ptr_3602, %lay_3599) : !memref_smem_bf16_21
        %iter_3604 = cute.get_iter(%view_3603) : !memref_smem_bf16_21
        %coord_3605 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3606 = cute.get_layout(%view_987) : !memref_rmem_bf16_5
        %idx_3607 = cute.crd2idx(%coord_3605, %lay_3606) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_3608 = cute.get_iter(%view_987) : !memref_rmem_bf16_5
        %ptr_3609 = cute.add_offset(%iter_3608, %idx_3607) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3610 = cute.make_view(%ptr_3609) : !memref_rmem_bf16_20
        %iter_3611 = cute.get_iter(%view_3610) : !memref_rmem_bf16_20
        %lay_3612 = cute.get_layout(%view_3603) : !memref_smem_bf16_21
        %1741 = cute.get_shape(%lay_3612) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_3613, %e1_3614, %e2_3615, %e3_3616, %e4_3617 = cute.get_leaves(%1741) : !cute.shape<"((8,1),((2,2),2))">
        %lay_3618 = cute.get_layout(%view_3610) : !memref_rmem_bf16_20
        %1742 = cute.get_shape(%lay_3618) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_3619, %e1_3620, %e2_3621, %e3_3622 = cute.get_leaves(%1742) : !cute.shape<"((8,1),(4,2))">
        %lay_3623 = cute.get_layout(%view_3603) : !memref_smem_bf16_21
        %shape_3624 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3625 = cute.make_layout() : !cute.layout<"1:0">
        %append_3626 = cute.append_to_rank<2> (%lay_3623, %lay_3625) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_3627 = cute.make_view(%iter_3604, %append_3626) : !memref_smem_bf16_21
        %iter_3628 = cute.get_iter(%view_3627) : !memref_smem_bf16_21
        %lay_3629 = cute.get_layout(%view_3627) : !memref_smem_bf16_21
        %1743 = cute.get_shape(%lay_3629) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_3630, %e1_3631, %e2_3632, %e3_3633, %e4_3634 = cute.get_leaves(%1743) : !cute.shape<"((8,1),((2,2),2))">
        %iter_3635 = cute.get_iter(%view_3627) : !memref_smem_bf16_21
        %lay_3636 = cute.get_layout(%view_3627) : !memref_smem_bf16_21
        %1744:2 = cute.get_scalars(%lay_3636) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_3637 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_3638 = cute.assume(%1744#0) : (i32) -> !cute.i32<divby 16>
        %iv_3639 = cute.assume(%1744#1) : (i32) -> !cute.i32<divby 32>
        %stride_3640 = cute.make_stride(%iv_3638, %iv_3639) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_3641 = cute.make_layout(%shape_3637, %stride_3640) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_3642 = cute.make_view(%iter_3635, %lay_3641) : !memref_smem_bf16_22
        %iter_3643 = cute.get_iter(%view_3642) : !memref_smem_bf16_22
        %iter_3644 = cute.get_iter(%view_3642) : !memref_smem_bf16_22
        %lay_3645 = cute.get_layout(%view_3610) : !memref_rmem_bf16_20
        %shape_3646 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_3647 = cute.make_layout() : !cute.layout<"1:0">
        %append_3648 = cute.append_to_rank<2> (%lay_3645, %lay_3647) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_3649 = cute.make_view(%iter_3611, %append_3648) : !memref_rmem_bf16_20
        %iter_3650 = cute.get_iter(%view_3649) : !memref_rmem_bf16_20
        %lay_3651 = cute.get_layout(%view_3649) : !memref_rmem_bf16_20
        %1745 = cute.get_shape(%lay_3651) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_3652, %e1_3653, %e2_3654, %e3_3655 = cute.get_leaves(%1745) : !cute.shape<"((8,1),(4,2))">
        %iter_3656 = cute.get_iter(%view_3649) : !memref_rmem_bf16_20
        %view_3657 = cute.make_view(%iter_3656) : !memref_rmem_bf16_21
        %iter_3658 = cute.get_iter(%view_3657) : !memref_rmem_bf16_21
        %iter_3659 = cute.get_iter(%view_3657) : !memref_rmem_bf16_21
        %lay_3660 = cute.get_layout(%view_3642) : !memref_smem_bf16_22
        %1746 = cute.get_shape(%lay_3660) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_3661, %e1_3662, %e2_3663, %e3_3664, %e4_3665 = cute.get_leaves(%1746) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_3666 = cute.get_layout(%view_3657) : !memref_rmem_bf16_21
        %1747 = cute.get_shape(%lay_3666) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_3667, %e1_3668, %e2_3669, %e3_3670 = cute.get_leaves(%1747) : !cute.shape<"((8,1),((4,2)))">
        %lay_3671 = cute.get_layout(%view_3642) : !memref_smem_bf16_22
        %sz_3672 = cute.size(%lay_3671) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_3673 = cute.get_leaves(%sz_3672) : !cute.int_tuple<"8">
        %lay_3674 = cute.get_layout(%view_3657) : !memref_rmem_bf16_21
        %sz_3675 = cute.size(%lay_3674) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_3676 = cute.get_leaves(%sz_3675) : !cute.int_tuple<"8">
        %1748 = cute.static : !cute.layout<"1:0">
        %iter_3677 = cute.get_iter(%view_3642) : !memref_smem_bf16_22
        %iter_3678 = cute.get_iter(%view_3657) : !memref_rmem_bf16_21
        %lay_3679 = cute.get_layout(%view_3642) : !memref_smem_bf16_22
        %lay_3680 = cute.get_layout(%view_3657) : !memref_rmem_bf16_21
        %append_3681 = cute.append_to_rank<2> (%lay_3679, %1748) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_3682 = cute.append_to_rank<2> (%lay_3680, %1748) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %1749:2 = cute.get_scalars(%append_3681) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_3683 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_3684 = cute.assume(%1749#0) : (i32) -> !cute.i32<divby 16>
        %iv_3685 = cute.assume(%1749#1) : (i32) -> !cute.i32<divby 32>
        %stride_3686 = cute.make_stride(%iv_3684, %iv_3685) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_3687 = cute.make_layout(%shape_3683, %stride_3686) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_3688 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_3689 = cute.size(%lay_3687) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %1750 = cute.get_scalars(%sz_3689) : !cute.int_tuple<"8">
        %c0_i32_3690 = arith.constant 0 : i32
        %c1_i32_3691 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3690 to %1750 step %c1_i32_3691  : i32 {
          %coord_3954 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
          %1817:2 = cute.get_scalars(%lay_3687) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %1818 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3955 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3956 = cute.crd2idx(%coord_3954, %lay_3687) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_3957 = cute.add_offset(%iter_3677, %idx_3956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3958 = cute.make_view(%ptr_3957, %lay_3955) : !memref_smem_bf16_14
          %1819 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_3959 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_3960 = cute.crd2idx(%coord_3954, %lay_3688) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_3961 = cute.add_offset(%iter_3678, %idx_3960) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3962 = cute.make_view(%ptr_3961, %lay_3959) : !memref_rmem_bf16_22
          %iter_3963 = cute.get_iter(%view_3958) : !memref_smem_bf16_14
          %iter_3964 = cute.get_iter(%view_3962) : !memref_rmem_bf16_22
          %swizzled = cute.apply_swizzle(%iter_3963) : !cute.ptr<bf16, smem, align<16>>
          %1820 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %1821 = llvm.mlir.constant(0 : i32) : i32
          %1822 = vector.extractelement %1820[%1821 : i32] : vector<4xi32>
          %1823 = builtin.unrealized_conversion_cast %iter_3964 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1822, %1823 : i32, !llvm.ptr
          %1824 = llvm.mlir.constant(1 : i32) : i32
          %1825 = vector.extractelement %1820[%1824 : i32] : vector<4xi32>
          %int_tuple_3965 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_3966 = cute.add_offset(%iter_3964, %int_tuple_3965) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %1826 = builtin.unrealized_conversion_cast %ptr_3966 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1825, %1826 : i32, !llvm.ptr
          %1827 = llvm.mlir.constant(2 : i32) : i32
          %1828 = vector.extractelement %1820[%1827 : i32] : vector<4xi32>
          %int_tuple_3967 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_3968 = cute.add_offset(%iter_3964, %int_tuple_3967) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %1829 = builtin.unrealized_conversion_cast %ptr_3968 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %1828, %1829 : i32, !llvm.ptr
          %1830 = llvm.mlir.constant(3 : i32) : i32
          %1831 = vector.extractelement %1820[%1830 : i32] : vector<4xi32>
          %int_tuple_3969 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_3970 = cute.add_offset(%iter_3964, %int_tuple_3969) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %1832 = builtin.unrealized_conversion_cast %ptr_3970 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %1831, %1832 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_3692 = cute.get_layout(%view_3591) : !memref_rmem_bf16_19
        %1751 = cute.get_shape(%lay_3692) : (!cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.shape<"(((2,2),2),1,4)">
        %e0_3693, %e1_3694, %e2_3695, %e3_3696, %e4_3697 = cute.get_leaves(%1751) : !cute.shape<"(((2,2),2),1,4)">
        %int_tuple_3698 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3699 = cute.size(%int_tuple_3698) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3700 = cute.get_leaves(%sz_3699) : !cute.int_tuple<"4">
        %int_tuple_3701 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3702 = cute.size(%int_tuple_3701) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3703 = cute.get_leaves(%sz_3702) : !cute.int_tuple<"4">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3955 = cute.get_layout(%view_984) : !memref_smem_bf16_10
          %1817:2 = cute.get_scalars(%lay_3955) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_3956 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_3957 = cute.assume(%1817#0) : (i32) -> !cute.i32<divby 16>
          %iv_3958 = cute.assume(%1817#1) : (i32) -> !cute.i32<divby 32>
          %stride_3959 = cute.make_stride(%iv_3957, %iv_3958) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_3960 = cute.make_layout(%shape_3956, %stride_3959) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_3961 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
          %iter_3962 = cute.get_iter(%view_984) : !memref_smem_bf16_10
          %ptr_3963 = cute.add_offset(%iter_3962, %idx_3961) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3964 = cute.make_view(%ptr_3963, %lay_3960) : !memref_smem_bf16_21
          %iter_3965 = cute.get_iter(%view_3964) : !memref_smem_bf16_21
          %coord_3966 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
          %lay_3967 = cute.get_layout(%view_987) : !memref_rmem_bf16_5
          %idx_3968 = cute.crd2idx(%coord_3966, %lay_3967) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
          %iter_3969 = cute.get_iter(%view_987) : !memref_rmem_bf16_5
          %ptr_3970 = cute.add_offset(%iter_3969, %idx_3968) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3971 = cute.make_view(%ptr_3970) : !memref_rmem_bf16_20
          %iter_3972 = cute.get_iter(%view_3971) : !memref_rmem_bf16_20
          %lay_3973 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %1818 = cute.get_shape(%lay_3973) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977, %e4_3978 = cute.get_leaves(%1818) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3979 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %1819 = cute.get_shape(%lay_3979) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%1819) : !cute.shape<"((8,1),(4,2))">
          %lay_3984 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %shape_3985 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3986 = cute.make_layout() : !cute.layout<"1:0">
          %append_3987 = cute.append_to_rank<2> (%lay_3984, %lay_3986) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3988 = cute.make_view(%iter_3965, %append_3987) : !memref_smem_bf16_21
          %iter_3989 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3990 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1820 = cute.get_shape(%lay_3990) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3991, %e1_3992, %e2_3993, %e3_3994, %e4_3995 = cute.get_leaves(%1820) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3996 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3997 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1821:2 = cute.get_scalars(%lay_3997) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3998 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3999 = cute.assume(%1821#0) : (i32) -> !cute.i32<divby 16>
          %iv_4000 = cute.assume(%1821#1) : (i32) -> !cute.i32<divby 32>
          %stride_4001 = cute.make_stride(%iv_3999, %iv_4000) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4002 = cute.make_layout(%shape_3998, %stride_4001) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4003 = cute.make_view(%iter_3996, %lay_4002) : !memref_smem_bf16_22
          %iter_4004 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4005 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %lay_4006 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %shape_4007 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4008 = cute.make_layout() : !cute.layout<"1:0">
          %append_4009 = cute.append_to_rank<2> (%lay_4006, %lay_4008) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4010 = cute.make_view(%iter_3972, %append_4009) : !memref_rmem_bf16_20
          %iter_4011 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %lay_4012 = cute.get_layout(%view_4010) : !memref_rmem_bf16_20
          %1822 = cute.get_shape(%lay_4012) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4013, %e1_4014, %e2_4015, %e3_4016 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(4,2))">
          %iter_4017 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %view_4018 = cute.make_view(%iter_4017) : !memref_rmem_bf16_21
          %iter_4019 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %iter_4020 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4021 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %1823 = cute.get_shape(%lay_4021) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4022, %e1_4023, %e2_4024, %e3_4025, %e4_4026 = cute.get_leaves(%1823) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4027 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %1824 = cute.get_shape(%lay_4027) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4028, %e1_4029, %e2_4030, %e3_4031 = cute.get_leaves(%1824) : !cute.shape<"((8,1),((4,2)))">
          %lay_4032 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %sz_4033 = cute.size(%lay_4032) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4034 = cute.get_leaves(%sz_4033) : !cute.int_tuple<"8">
          %lay_4035 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %sz_4036 = cute.size(%lay_4035) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4037 = cute.get_leaves(%sz_4036) : !cute.int_tuple<"8">
          %1825 = cute.static : !cute.layout<"1:0">
          %iter_4038 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4039 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4040 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %lay_4041 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %append_4042 = cute.append_to_rank<2> (%lay_4040, %1825) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4043 = cute.append_to_rank<2> (%lay_4041, %1825) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1826:2 = cute.get_scalars(%append_4042) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4044 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4045 = cute.assume(%1826#0) : (i32) -> !cute.i32<divby 16>
          %iv_4046 = cute.assume(%1826#1) : (i32) -> !cute.i32<divby 32>
          %stride_4047 = cute.make_stride(%iv_4045, %iv_4046) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4048 = cute.make_layout(%shape_4044, %stride_4047) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4049 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4050 = cute.size(%lay_4048) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1827 = cute.get_scalars(%sz_4050) : !cute.int_tuple<"8">
          %c0_i32_4051 = arith.constant 0 : i32
          %c1_i32_4052 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4051 to %1827 step %c1_i32_4052  : i32 {
            %coord_4053 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1828:2 = cute.get_scalars(%lay_4048) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1829 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4054 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4055 = cute.crd2idx(%coord_4053, %lay_4048) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4056 = cute.add_offset(%iter_4038, %idx_4055) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4057 = cute.make_view(%ptr_4056, %lay_4054) : !memref_smem_bf16_14
            %1830 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4058 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4059 = cute.crd2idx(%coord_4053, %lay_4049) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4060 = cute.add_offset(%iter_4039, %idx_4059) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4061 = cute.make_view(%ptr_4060, %lay_4058) : !memref_rmem_bf16_22
            %iter_4062 = cute.get_iter(%view_4057) : !memref_smem_bf16_14
            %iter_4063 = cute.get_iter(%view_4061) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4062) : !cute.ptr<bf16, smem, align<16>>
            %1831 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1832 = llvm.mlir.constant(0 : i32) : i32
            %1833 = vector.extractelement %1831[%1832 : i32] : vector<4xi32>
            %1834 = builtin.unrealized_conversion_cast %iter_4063 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1833, %1834 : i32, !llvm.ptr
            %1835 = llvm.mlir.constant(1 : i32) : i32
            %1836 = vector.extractelement %1831[%1835 : i32] : vector<4xi32>
            %int_tuple_4064 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4065 = cute.add_offset(%iter_4063, %int_tuple_4064) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1837 = builtin.unrealized_conversion_cast %ptr_4065 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1836, %1837 : i32, !llvm.ptr
            %1838 = llvm.mlir.constant(2 : i32) : i32
            %1839 = vector.extractelement %1831[%1838 : i32] : vector<4xi32>
            %int_tuple_4066 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4067 = cute.add_offset(%iter_4063, %int_tuple_4066) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1840 = builtin.unrealized_conversion_cast %ptr_4067 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1839, %1840 : i32, !llvm.ptr
            %1841 = llvm.mlir.constant(3 : i32) : i32
            %1842 = vector.extractelement %1831[%1841 : i32] : vector<4xi32>
            %int_tuple_4068 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4069 = cute.add_offset(%iter_4063, %int_tuple_4068) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1843 = builtin.unrealized_conversion_cast %ptr_4069 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1842, %1843 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3704 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3705 = cute.get_layout(%view_3591) : !memref_rmem_bf16_19
        %idx_3706 = cute.crd2idx(%coord_3704, %lay_3705) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"0">
        %iter_3707 = cute.get_iter(%view_3591) : !memref_rmem_bf16_19
        %ptr_3708 = cute.add_offset(%iter_3707, %idx_3706) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3709 = cute.make_view(%ptr_3708) : !memref_rmem_bf16_23
        %iter_3710 = cute.get_iter(%view_3709) : !memref_rmem_bf16_23
        %coord_3711 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_3712 = cute.get_layout(%rmem_753) : !memref_rmem_bf16_2
        %idx_3713 = cute.crd2idx(%coord_3711, %lay_3712) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_3714 = cute.get_iter(%rmem_753) : !memref_rmem_bf16_2
        %ptr_3715 = cute.add_offset(%iter_3714, %idx_3713) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3716 = cute.make_view(%ptr_3715) : !memref_rmem_bf16_24
        %iter_3717 = cute.get_iter(%view_3716) : !memref_rmem_bf16_24
        %lay_3718 = cute.get_layout(%view_3709) : !memref_rmem_bf16_23
        %1752 = cute.get_shape(%lay_3718) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3719, %e1_3720, %e2_3721, %e3_3722 = cute.get_leaves(%1752) : !cute.shape<"(((2,2),2),1)">
        %lay_3723 = cute.get_layout(%view_3716) : !memref_rmem_bf16_24
        %1753 = cute.get_shape(%lay_3723) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3724, %e1_3725, %e2_3726, %e3_3727 = cute.get_leaves(%1753) : !cute.shape<"((2,2),(8,2))">
        %lay_3728 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %1754 = cute.get_shape(%lay_3728) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
        %e0_3729, %e1_3730, %e2_3731, %e3_3732 = cute.get_leaves(%1754) : !cute.shape<"((2,2),1,16)">
        %iter_3733 = cute.get_iter(%view_3709) : !memref_rmem_bf16_23
        %iter_3734 = cute.get_iter(%view_3716) : !memref_rmem_bf16_24
        %iter_3735 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %iter_3736 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %lay_3737 = cute.get_layout(%view_3709) : !memref_rmem_bf16_23
        %lay_3738 = cute.get_layout(%view_3716) : !memref_rmem_bf16_24
        %lay_3739 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %lay_3740 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %1755 = cute.static : !cute.layout<"1:0">
        %append_3741 = cute.append_to_rank<3> (%lay_3737, %1755) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3742 = cute.append_to_rank<3> (%lay_3738, %1755) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3743 = cute.size(%append_3741) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3744 = cute.size(%append_3741) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3745 = cute.size(%append_3742) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1756 = cute.get_scalars(%sz_3743) : !cute.int_tuple<"1">
        %1757 = cute.get_scalars(%sz_3744) : !cute.int_tuple<"1">
        %1758 = cute.get_scalars(%sz_3745) : !cute.int_tuple<"16">
        %c0_i32_3746 = arith.constant 0 : i32
        %c1_i32_3747 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3746 to %1756 step %c1_i32_3747  : i32 {
          scf.for %arg9 = %c0_i32_3746 to %1757 step %c1_i32_3747  : i32 {
            scf.for %arg10 = %c0_i32_3746 to %1758 step %c1_i32_3747  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3741) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3733, %idx_3958) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_25
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3742) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3734, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3739) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3735, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3740) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3736, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_25
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<32>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3748 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3749 = cute.size(%int_tuple_3748) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3750 = cute.get_leaves(%sz_3749) : !cute.int_tuple<"4">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3955 = cute.get_layout(%view_984) : !memref_smem_bf16_10
          %1817:2 = cute.get_scalars(%lay_3955) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_3956 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_3957 = cute.assume(%1817#0) : (i32) -> !cute.i32<divby 16>
          %iv_3958 = cute.assume(%1817#1) : (i32) -> !cute.i32<divby 32>
          %stride_3959 = cute.make_stride(%iv_3957, %iv_3958) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_3960 = cute.make_layout(%shape_3956, %stride_3959) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_3961 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
          %iter_3962 = cute.get_iter(%view_984) : !memref_smem_bf16_10
          %ptr_3963 = cute.add_offset(%iter_3962, %idx_3961) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3964 = cute.make_view(%ptr_3963, %lay_3960) : !memref_smem_bf16_21
          %iter_3965 = cute.get_iter(%view_3964) : !memref_smem_bf16_21
          %coord_3966 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
          %lay_3967 = cute.get_layout(%view_987) : !memref_rmem_bf16_5
          %idx_3968 = cute.crd2idx(%coord_3966, %lay_3967) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
          %iter_3969 = cute.get_iter(%view_987) : !memref_rmem_bf16_5
          %ptr_3970 = cute.add_offset(%iter_3969, %idx_3968) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3971 = cute.make_view(%ptr_3970) : !memref_rmem_bf16_20
          %iter_3972 = cute.get_iter(%view_3971) : !memref_rmem_bf16_20
          %lay_3973 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %1818 = cute.get_shape(%lay_3973) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977, %e4_3978 = cute.get_leaves(%1818) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3979 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %1819 = cute.get_shape(%lay_3979) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%1819) : !cute.shape<"((8,1),(4,2))">
          %lay_3984 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %shape_3985 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3986 = cute.make_layout() : !cute.layout<"1:0">
          %append_3987 = cute.append_to_rank<2> (%lay_3984, %lay_3986) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3988 = cute.make_view(%iter_3965, %append_3987) : !memref_smem_bf16_21
          %iter_3989 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3990 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1820 = cute.get_shape(%lay_3990) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3991, %e1_3992, %e2_3993, %e3_3994, %e4_3995 = cute.get_leaves(%1820) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3996 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3997 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1821:2 = cute.get_scalars(%lay_3997) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3998 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3999 = cute.assume(%1821#0) : (i32) -> !cute.i32<divby 16>
          %iv_4000 = cute.assume(%1821#1) : (i32) -> !cute.i32<divby 32>
          %stride_4001 = cute.make_stride(%iv_3999, %iv_4000) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4002 = cute.make_layout(%shape_3998, %stride_4001) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4003 = cute.make_view(%iter_3996, %lay_4002) : !memref_smem_bf16_22
          %iter_4004 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4005 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %lay_4006 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %shape_4007 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4008 = cute.make_layout() : !cute.layout<"1:0">
          %append_4009 = cute.append_to_rank<2> (%lay_4006, %lay_4008) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4010 = cute.make_view(%iter_3972, %append_4009) : !memref_rmem_bf16_20
          %iter_4011 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %lay_4012 = cute.get_layout(%view_4010) : !memref_rmem_bf16_20
          %1822 = cute.get_shape(%lay_4012) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4013, %e1_4014, %e2_4015, %e3_4016 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(4,2))">
          %iter_4017 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %view_4018 = cute.make_view(%iter_4017) : !memref_rmem_bf16_21
          %iter_4019 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %iter_4020 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4021 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %1823 = cute.get_shape(%lay_4021) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4022, %e1_4023, %e2_4024, %e3_4025, %e4_4026 = cute.get_leaves(%1823) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4027 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %1824 = cute.get_shape(%lay_4027) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4028, %e1_4029, %e2_4030, %e3_4031 = cute.get_leaves(%1824) : !cute.shape<"((8,1),((4,2)))">
          %lay_4032 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %sz_4033 = cute.size(%lay_4032) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4034 = cute.get_leaves(%sz_4033) : !cute.int_tuple<"8">
          %lay_4035 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %sz_4036 = cute.size(%lay_4035) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4037 = cute.get_leaves(%sz_4036) : !cute.int_tuple<"8">
          %1825 = cute.static : !cute.layout<"1:0">
          %iter_4038 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4039 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4040 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %lay_4041 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %append_4042 = cute.append_to_rank<2> (%lay_4040, %1825) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4043 = cute.append_to_rank<2> (%lay_4041, %1825) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1826:2 = cute.get_scalars(%append_4042) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4044 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4045 = cute.assume(%1826#0) : (i32) -> !cute.i32<divby 16>
          %iv_4046 = cute.assume(%1826#1) : (i32) -> !cute.i32<divby 32>
          %stride_4047 = cute.make_stride(%iv_4045, %iv_4046) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4048 = cute.make_layout(%shape_4044, %stride_4047) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4049 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4050 = cute.size(%lay_4048) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1827 = cute.get_scalars(%sz_4050) : !cute.int_tuple<"8">
          %c0_i32_4051 = arith.constant 0 : i32
          %c1_i32_4052 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4051 to %1827 step %c1_i32_4052  : i32 {
            %coord_4053 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1828:2 = cute.get_scalars(%lay_4048) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1829 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4054 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4055 = cute.crd2idx(%coord_4053, %lay_4048) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4056 = cute.add_offset(%iter_4038, %idx_4055) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4057 = cute.make_view(%ptr_4056, %lay_4054) : !memref_smem_bf16_14
            %1830 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4058 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4059 = cute.crd2idx(%coord_4053, %lay_4049) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4060 = cute.add_offset(%iter_4039, %idx_4059) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4061 = cute.make_view(%ptr_4060, %lay_4058) : !memref_rmem_bf16_22
            %iter_4062 = cute.get_iter(%view_4057) : !memref_smem_bf16_14
            %iter_4063 = cute.get_iter(%view_4061) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4062) : !cute.ptr<bf16, smem, align<16>>
            %1831 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1832 = llvm.mlir.constant(0 : i32) : i32
            %1833 = vector.extractelement %1831[%1832 : i32] : vector<4xi32>
            %1834 = builtin.unrealized_conversion_cast %iter_4063 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1833, %1834 : i32, !llvm.ptr
            %1835 = llvm.mlir.constant(1 : i32) : i32
            %1836 = vector.extractelement %1831[%1835 : i32] : vector<4xi32>
            %int_tuple_4064 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4065 = cute.add_offset(%iter_4063, %int_tuple_4064) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1837 = builtin.unrealized_conversion_cast %ptr_4065 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1836, %1837 : i32, !llvm.ptr
            %1838 = llvm.mlir.constant(2 : i32) : i32
            %1839 = vector.extractelement %1831[%1838 : i32] : vector<4xi32>
            %int_tuple_4066 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4067 = cute.add_offset(%iter_4063, %int_tuple_4066) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1840 = builtin.unrealized_conversion_cast %ptr_4067 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1839, %1840 : i32, !llvm.ptr
            %1841 = llvm.mlir.constant(3 : i32) : i32
            %1842 = vector.extractelement %1831[%1841 : i32] : vector<4xi32>
            %int_tuple_4068 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4069 = cute.add_offset(%iter_4063, %int_tuple_4068) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1843 = builtin.unrealized_conversion_cast %ptr_4069 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1842, %1843 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3751 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3752 = cute.get_layout(%view_3591) : !memref_rmem_bf16_19
        %idx_3753 = cute.crd2idx(%coord_3751, %lay_3752) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"8">
        %iter_3754 = cute.get_iter(%view_3591) : !memref_rmem_bf16_19
        %ptr_3755 = cute.add_offset(%iter_3754, %idx_3753) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3756 = cute.make_view(%ptr_3755) : !memref_rmem_bf16_26
        %iter_3757 = cute.get_iter(%view_3756) : !memref_rmem_bf16_26
        %coord_3758 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_3759 = cute.get_layout(%rmem_753) : !memref_rmem_bf16_2
        %idx_3760 = cute.crd2idx(%coord_3758, %lay_3759) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_3761 = cute.get_iter(%rmem_753) : !memref_rmem_bf16_2
        %ptr_3762 = cute.add_offset(%iter_3761, %idx_3760) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3763 = cute.make_view(%ptr_3762) : !memref_rmem_bf16_24
        %iter_3764 = cute.get_iter(%view_3763) : !memref_rmem_bf16_24
        %lay_3765 = cute.get_layout(%view_3756) : !memref_rmem_bf16_26
        %1759 = cute.get_shape(%lay_3765) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3766, %e1_3767, %e2_3768, %e3_3769 = cute.get_leaves(%1759) : !cute.shape<"(((2,2),2),1)">
        %lay_3770 = cute.get_layout(%view_3763) : !memref_rmem_bf16_24
        %1760 = cute.get_shape(%lay_3770) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3771, %e1_3772, %e2_3773, %e3_3774 = cute.get_leaves(%1760) : !cute.shape<"((2,2),(8,2))">
        %iter_3775 = cute.get_iter(%view_3756) : !memref_rmem_bf16_26
        %iter_3776 = cute.get_iter(%view_3763) : !memref_rmem_bf16_24
        %iter_3777 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %iter_3778 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %lay_3779 = cute.get_layout(%view_3756) : !memref_rmem_bf16_26
        %lay_3780 = cute.get_layout(%view_3763) : !memref_rmem_bf16_24
        %lay_3781 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %lay_3782 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %1761 = cute.static : !cute.layout<"1:0">
        %append_3783 = cute.append_to_rank<3> (%lay_3779, %1761) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3784 = cute.append_to_rank<3> (%lay_3780, %1761) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3785 = cute.size(%append_3783) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3786 = cute.size(%append_3783) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3787 = cute.size(%append_3784) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1762 = cute.get_scalars(%sz_3785) : !cute.int_tuple<"1">
        %1763 = cute.get_scalars(%sz_3786) : !cute.int_tuple<"1">
        %1764 = cute.get_scalars(%sz_3787) : !cute.int_tuple<"16">
        %c0_i32_3788 = arith.constant 0 : i32
        %c1_i32_3789 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3788 to %1762 step %c1_i32_3789  : i32 {
          scf.for %arg9 = %c0_i32_3788 to %1763 step %c1_i32_3789  : i32 {
            scf.for %arg10 = %c0_i32_3788 to %1764 step %c1_i32_3789  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3783) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3775, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_27
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3784) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3776, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3781) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3777, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3782) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3778, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_27
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3790 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3791 = cute.size(%int_tuple_3790) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3792 = cute.get_leaves(%sz_3791) : !cute.int_tuple<"4">
        scf.if %true_3044 {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3955 = cute.get_layout(%view_984) : !memref_smem_bf16_10
          %1817:2 = cute.get_scalars(%lay_3955) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_3956 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_3957 = cute.assume(%1817#0) : (i32) -> !cute.i32<divby 16>
          %iv_3958 = cute.assume(%1817#1) : (i32) -> !cute.i32<divby 32>
          %stride_3959 = cute.make_stride(%iv_3957, %iv_3958) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_3960 = cute.make_layout(%shape_3956, %stride_3959) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_3961 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
          %iter_3962 = cute.get_iter(%view_984) : !memref_smem_bf16_10
          %ptr_3963 = cute.add_offset(%iter_3962, %idx_3961) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3964 = cute.make_view(%ptr_3963, %lay_3960) : !memref_smem_bf16_21
          %iter_3965 = cute.get_iter(%view_3964) : !memref_smem_bf16_21
          %coord_3966 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
          %lay_3967 = cute.get_layout(%view_987) : !memref_rmem_bf16_5
          %idx_3968 = cute.crd2idx(%coord_3966, %lay_3967) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
          %iter_3969 = cute.get_iter(%view_987) : !memref_rmem_bf16_5
          %ptr_3970 = cute.add_offset(%iter_3969, %idx_3968) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3971 = cute.make_view(%ptr_3970) : !memref_rmem_bf16_20
          %iter_3972 = cute.get_iter(%view_3971) : !memref_rmem_bf16_20
          %lay_3973 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %1818 = cute.get_shape(%lay_3973) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977, %e4_3978 = cute.get_leaves(%1818) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3979 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %1819 = cute.get_shape(%lay_3979) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%1819) : !cute.shape<"((8,1),(4,2))">
          %lay_3984 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %shape_3985 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3986 = cute.make_layout() : !cute.layout<"1:0">
          %append_3987 = cute.append_to_rank<2> (%lay_3984, %lay_3986) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3988 = cute.make_view(%iter_3965, %append_3987) : !memref_smem_bf16_21
          %iter_3989 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3990 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1820 = cute.get_shape(%lay_3990) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3991, %e1_3992, %e2_3993, %e3_3994, %e4_3995 = cute.get_leaves(%1820) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3996 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3997 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1821:2 = cute.get_scalars(%lay_3997) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3998 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3999 = cute.assume(%1821#0) : (i32) -> !cute.i32<divby 16>
          %iv_4000 = cute.assume(%1821#1) : (i32) -> !cute.i32<divby 32>
          %stride_4001 = cute.make_stride(%iv_3999, %iv_4000) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4002 = cute.make_layout(%shape_3998, %stride_4001) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4003 = cute.make_view(%iter_3996, %lay_4002) : !memref_smem_bf16_22
          %iter_4004 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4005 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %lay_4006 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %shape_4007 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4008 = cute.make_layout() : !cute.layout<"1:0">
          %append_4009 = cute.append_to_rank<2> (%lay_4006, %lay_4008) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4010 = cute.make_view(%iter_3972, %append_4009) : !memref_rmem_bf16_20
          %iter_4011 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %lay_4012 = cute.get_layout(%view_4010) : !memref_rmem_bf16_20
          %1822 = cute.get_shape(%lay_4012) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4013, %e1_4014, %e2_4015, %e3_4016 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(4,2))">
          %iter_4017 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %view_4018 = cute.make_view(%iter_4017) : !memref_rmem_bf16_21
          %iter_4019 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %iter_4020 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4021 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %1823 = cute.get_shape(%lay_4021) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4022, %e1_4023, %e2_4024, %e3_4025, %e4_4026 = cute.get_leaves(%1823) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4027 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %1824 = cute.get_shape(%lay_4027) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4028, %e1_4029, %e2_4030, %e3_4031 = cute.get_leaves(%1824) : !cute.shape<"((8,1),((4,2)))">
          %lay_4032 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %sz_4033 = cute.size(%lay_4032) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4034 = cute.get_leaves(%sz_4033) : !cute.int_tuple<"8">
          %lay_4035 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %sz_4036 = cute.size(%lay_4035) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4037 = cute.get_leaves(%sz_4036) : !cute.int_tuple<"8">
          %1825 = cute.static : !cute.layout<"1:0">
          %iter_4038 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4039 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4040 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %lay_4041 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %append_4042 = cute.append_to_rank<2> (%lay_4040, %1825) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4043 = cute.append_to_rank<2> (%lay_4041, %1825) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1826:2 = cute.get_scalars(%append_4042) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4044 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4045 = cute.assume(%1826#0) : (i32) -> !cute.i32<divby 16>
          %iv_4046 = cute.assume(%1826#1) : (i32) -> !cute.i32<divby 32>
          %stride_4047 = cute.make_stride(%iv_4045, %iv_4046) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4048 = cute.make_layout(%shape_4044, %stride_4047) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4049 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4050 = cute.size(%lay_4048) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1827 = cute.get_scalars(%sz_4050) : !cute.int_tuple<"8">
          %c0_i32_4051 = arith.constant 0 : i32
          %c1_i32_4052 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4051 to %1827 step %c1_i32_4052  : i32 {
            %coord_4053 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1828:2 = cute.get_scalars(%lay_4048) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1829 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4054 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4055 = cute.crd2idx(%coord_4053, %lay_4048) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4056 = cute.add_offset(%iter_4038, %idx_4055) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4057 = cute.make_view(%ptr_4056, %lay_4054) : !memref_smem_bf16_14
            %1830 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4058 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4059 = cute.crd2idx(%coord_4053, %lay_4049) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4060 = cute.add_offset(%iter_4039, %idx_4059) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4061 = cute.make_view(%ptr_4060, %lay_4058) : !memref_rmem_bf16_22
            %iter_4062 = cute.get_iter(%view_4057) : !memref_smem_bf16_14
            %iter_4063 = cute.get_iter(%view_4061) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4062) : !cute.ptr<bf16, smem, align<16>>
            %1831 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1832 = llvm.mlir.constant(0 : i32) : i32
            %1833 = vector.extractelement %1831[%1832 : i32] : vector<4xi32>
            %1834 = builtin.unrealized_conversion_cast %iter_4063 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1833, %1834 : i32, !llvm.ptr
            %1835 = llvm.mlir.constant(1 : i32) : i32
            %1836 = vector.extractelement %1831[%1835 : i32] : vector<4xi32>
            %int_tuple_4064 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4065 = cute.add_offset(%iter_4063, %int_tuple_4064) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1837 = builtin.unrealized_conversion_cast %ptr_4065 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1836, %1837 : i32, !llvm.ptr
            %1838 = llvm.mlir.constant(2 : i32) : i32
            %1839 = vector.extractelement %1831[%1838 : i32] : vector<4xi32>
            %int_tuple_4066 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4067 = cute.add_offset(%iter_4063, %int_tuple_4066) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1840 = builtin.unrealized_conversion_cast %ptr_4067 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1839, %1840 : i32, !llvm.ptr
            %1841 = llvm.mlir.constant(3 : i32) : i32
            %1842 = vector.extractelement %1831[%1841 : i32] : vector<4xi32>
            %int_tuple_4068 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4069 = cute.add_offset(%iter_4063, %int_tuple_4068) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1843 = builtin.unrealized_conversion_cast %ptr_4069 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1842, %1843 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3793 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3794 = cute.get_layout(%view_3591) : !memref_rmem_bf16_19
        %idx_3795 = cute.crd2idx(%coord_3793, %lay_3794) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"16">
        %iter_3796 = cute.get_iter(%view_3591) : !memref_rmem_bf16_19
        %ptr_3797 = cute.add_offset(%iter_3796, %idx_3795) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_3798 = cute.make_view(%ptr_3797) : !memref_rmem_bf16_23
        %iter_3799 = cute.get_iter(%view_3798) : !memref_rmem_bf16_23
        %coord_3800 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_3801 = cute.get_layout(%rmem_753) : !memref_rmem_bf16_2
        %idx_3802 = cute.crd2idx(%coord_3800, %lay_3801) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_3803 = cute.get_iter(%rmem_753) : !memref_rmem_bf16_2
        %ptr_3804 = cute.add_offset(%iter_3803, %idx_3802) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3805 = cute.make_view(%ptr_3804) : !memref_rmem_bf16_24
        %iter_3806 = cute.get_iter(%view_3805) : !memref_rmem_bf16_24
        %lay_3807 = cute.get_layout(%view_3798) : !memref_rmem_bf16_23
        %1765 = cute.get_shape(%lay_3807) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3808, %e1_3809, %e2_3810, %e3_3811 = cute.get_leaves(%1765) : !cute.shape<"(((2,2),2),1)">
        %lay_3812 = cute.get_layout(%view_3805) : !memref_rmem_bf16_24
        %1766 = cute.get_shape(%lay_3812) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3813, %e1_3814, %e2_3815, %e3_3816 = cute.get_leaves(%1766) : !cute.shape<"((2,2),(8,2))">
        %iter_3817 = cute.get_iter(%view_3798) : !memref_rmem_bf16_23
        %iter_3818 = cute.get_iter(%view_3805) : !memref_rmem_bf16_24
        %iter_3819 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %iter_3820 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %lay_3821 = cute.get_layout(%view_3798) : !memref_rmem_bf16_23
        %lay_3822 = cute.get_layout(%view_3805) : !memref_rmem_bf16_24
        %lay_3823 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %lay_3824 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %1767 = cute.static : !cute.layout<"1:0">
        %append_3825 = cute.append_to_rank<3> (%lay_3821, %1767) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3826 = cute.append_to_rank<3> (%lay_3822, %1767) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3827 = cute.size(%append_3825) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3828 = cute.size(%append_3825) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3829 = cute.size(%append_3826) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1768 = cute.get_scalars(%sz_3827) : !cute.int_tuple<"1">
        %1769 = cute.get_scalars(%sz_3828) : !cute.int_tuple<"1">
        %1770 = cute.get_scalars(%sz_3829) : !cute.int_tuple<"16">
        %c0_i32_3830 = arith.constant 0 : i32
        %c1_i32_3831 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3830 to %1768 step %c1_i32_3831  : i32 {
          scf.for %arg9 = %c0_i32_3830 to %1769 step %c1_i32_3831  : i32 {
            scf.for %arg10 = %c0_i32_3830 to %1770 step %c1_i32_3831  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3825) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3817, %idx_3958) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_25
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3826) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3818, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3823) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3819, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3824) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3820, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_25
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<32>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_3832 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_3833 = cute.size(%int_tuple_3832) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_3834 = cute.get_leaves(%sz_3833) : !cute.int_tuple<"4">
        scf.if %false {
          %coord_3954 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3955 = cute.get_layout(%view_984) : !memref_smem_bf16_10
          %1817:2 = cute.get_scalars(%lay_3955) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
          %shape_3956 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
          %iv_3957 = cute.assume(%1817#0) : (i32) -> !cute.i32<divby 16>
          %iv_3958 = cute.assume(%1817#1) : (i32) -> !cute.i32<divby 32>
          %stride_3959 = cute.make_stride(%iv_3957, %iv_3958) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
          %lay_3960 = cute.make_layout(%shape_3956, %stride_3959) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %idx_3961 = cute.crd2idx(%coord_3954, %lay_3955) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"4096">
          %iter_3962 = cute.get_iter(%view_984) : !memref_smem_bf16_10
          %ptr_3963 = cute.add_offset(%iter_3962, %idx_3961) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
          %view_3964 = cute.make_view(%ptr_3963, %lay_3960) : !memref_smem_bf16_21
          %iter_3965 = cute.get_iter(%view_3964) : !memref_smem_bf16_21
          %coord_3966 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
          %lay_3967 = cute.get_layout(%view_987) : !memref_rmem_bf16_5
          %idx_3968 = cute.crd2idx(%coord_3966, %lay_3967) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"128">
          %iter_3969 = cute.get_iter(%view_987) : !memref_rmem_bf16_5
          %ptr_3970 = cute.add_offset(%iter_3969, %idx_3968) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_3971 = cute.make_view(%ptr_3970) : !memref_rmem_bf16_20
          %iter_3972 = cute.get_iter(%view_3971) : !memref_rmem_bf16_20
          %lay_3973 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %1818 = cute.get_shape(%lay_3973) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3974, %e1_3975, %e2_3976, %e3_3977, %e4_3978 = cute.get_leaves(%1818) : !cute.shape<"((8,1),((2,2),2))">
          %lay_3979 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %1819 = cute.get_shape(%lay_3979) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%1819) : !cute.shape<"((8,1),(4,2))">
          %lay_3984 = cute.get_layout(%view_3964) : !memref_smem_bf16_21
          %shape_3985 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_3986 = cute.make_layout() : !cute.layout<"1:0">
          %append_3987 = cute.append_to_rank<2> (%lay_3984, %lay_3986) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
          %view_3988 = cute.make_view(%iter_3965, %append_3987) : !memref_smem_bf16_21
          %iter_3989 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3990 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1820 = cute.get_shape(%lay_3990) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
          %e0_3991, %e1_3992, %e2_3993, %e3_3994, %e4_3995 = cute.get_leaves(%1820) : !cute.shape<"((8,1),((2,2),2))">
          %iter_3996 = cute.get_iter(%view_3988) : !memref_smem_bf16_21
          %lay_3997 = cute.get_layout(%view_3988) : !memref_smem_bf16_21
          %1821:2 = cute.get_scalars(%lay_3997) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
          %shape_3998 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
          %iv_3999 = cute.assume(%1821#0) : (i32) -> !cute.i32<divby 16>
          %iv_4000 = cute.assume(%1821#1) : (i32) -> !cute.i32<divby 32>
          %stride_4001 = cute.make_stride(%iv_3999, %iv_4000) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
          %lay_4002 = cute.make_layout(%shape_3998, %stride_4001) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %view_4003 = cute.make_view(%iter_3996, %lay_4002) : !memref_smem_bf16_22
          %iter_4004 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4005 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %lay_4006 = cute.get_layout(%view_3971) : !memref_rmem_bf16_20
          %shape_4007 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_4008 = cute.make_layout() : !cute.layout<"1:0">
          %append_4009 = cute.append_to_rank<2> (%lay_4006, %lay_4008) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
          %view_4010 = cute.make_view(%iter_3972, %append_4009) : !memref_rmem_bf16_20
          %iter_4011 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %lay_4012 = cute.get_layout(%view_4010) : !memref_rmem_bf16_20
          %1822 = cute.get_shape(%lay_4012) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_4013, %e1_4014, %e2_4015, %e3_4016 = cute.get_leaves(%1822) : !cute.shape<"((8,1),(4,2))">
          %iter_4017 = cute.get_iter(%view_4010) : !memref_rmem_bf16_20
          %view_4018 = cute.make_view(%iter_4017) : !memref_rmem_bf16_21
          %iter_4019 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %iter_4020 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4021 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %1823 = cute.get_shape(%lay_4021) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
          %e0_4022, %e1_4023, %e2_4024, %e3_4025, %e4_4026 = cute.get_leaves(%1823) : !cute.shape<"((8,1),(((2,2),2)))">
          %lay_4027 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %1824 = cute.get_shape(%lay_4027) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
          %e0_4028, %e1_4029, %e2_4030, %e3_4031 = cute.get_leaves(%1824) : !cute.shape<"((8,1),((4,2)))">
          %lay_4032 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %sz_4033 = cute.size(%lay_4032) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
          %e0_4034 = cute.get_leaves(%sz_4033) : !cute.int_tuple<"8">
          %lay_4035 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %sz_4036 = cute.size(%lay_4035) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
          %e0_4037 = cute.get_leaves(%sz_4036) : !cute.int_tuple<"8">
          %1825 = cute.static : !cute.layout<"1:0">
          %iter_4038 = cute.get_iter(%view_4003) : !memref_smem_bf16_22
          %iter_4039 = cute.get_iter(%view_4018) : !memref_rmem_bf16_21
          %lay_4040 = cute.get_layout(%view_4003) : !memref_smem_bf16_22
          %lay_4041 = cute.get_layout(%view_4018) : !memref_rmem_bf16_21
          %append_4042 = cute.append_to_rank<2> (%lay_4040, %1825) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
          %append_4043 = cute.append_to_rank<2> (%lay_4041, %1825) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
          %1826:2 = cute.get_scalars(%append_4042) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
          %shape_4044 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
          %iv_4045 = cute.assume(%1826#0) : (i32) -> !cute.i32<divby 16>
          %iv_4046 = cute.assume(%1826#1) : (i32) -> !cute.i32<divby 32>
          %stride_4047 = cute.make_stride(%iv_4045, %iv_4046) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4048 = cute.make_layout(%shape_4044, %stride_4047) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %lay_4049 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
          %sz_4050 = cute.size(%lay_4048) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
          %1827 = cute.get_scalars(%sz_4050) : !cute.int_tuple<"8">
          %c0_i32_4051 = arith.constant 0 : i32
          %c1_i32_4052 = arith.constant 1 : i32
          scf.for %arg8 = %c0_i32_4051 to %1827 step %c1_i32_4052  : i32 {
            %coord_4053 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"(_,?)">
            %1828:2 = cute.get_scalars(%lay_4048) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
            %1829 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4054 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4055 = cute.crd2idx(%coord_4053, %lay_4048) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
            %ptr_4056 = cute.add_offset(%iter_4038, %idx_4055) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_4057 = cute.make_view(%ptr_4056, %lay_4054) : !memref_smem_bf16_14
            %1830 = cute.get_scalars(%coord_4053) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_4058 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_4059 = cute.crd2idx(%coord_4053, %lay_4049) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
            %ptr_4060 = cute.add_offset(%iter_4039, %idx_4059) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_4061 = cute.make_view(%ptr_4060, %lay_4058) : !memref_rmem_bf16_22
            %iter_4062 = cute.get_iter(%view_4057) : !memref_smem_bf16_14
            %iter_4063 = cute.get_iter(%view_4061) : !memref_rmem_bf16_22
            %swizzled = cute.apply_swizzle(%iter_4062) : !cute.ptr<bf16, smem, align<16>>
            %1831 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
            %1832 = llvm.mlir.constant(0 : i32) : i32
            %1833 = vector.extractelement %1831[%1832 : i32] : vector<4xi32>
            %1834 = builtin.unrealized_conversion_cast %iter_4063 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1833, %1834 : i32, !llvm.ptr
            %1835 = llvm.mlir.constant(1 : i32) : i32
            %1836 = vector.extractelement %1831[%1835 : i32] : vector<4xi32>
            %int_tuple_4064 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
            %ptr_4065 = cute.add_offset(%iter_4063, %int_tuple_4064) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
            %1837 = builtin.unrealized_conversion_cast %ptr_4065 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1836, %1837 : i32, !llvm.ptr
            %1838 = llvm.mlir.constant(2 : i32) : i32
            %1839 = vector.extractelement %1831[%1838 : i32] : vector<4xi32>
            %int_tuple_4066 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
            %ptr_4067 = cute.add_offset(%iter_4063, %int_tuple_4066) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
            %1840 = builtin.unrealized_conversion_cast %ptr_4067 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            llvm.store %1839, %1840 : i32, !llvm.ptr
            %1841 = llvm.mlir.constant(3 : i32) : i32
            %1842 = vector.extractelement %1831[%1841 : i32] : vector<4xi32>
            %int_tuple_4068 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
            %ptr_4069 = cute.add_offset(%iter_4063, %int_tuple_4068) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
            %1843 = builtin.unrealized_conversion_cast %ptr_4069 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
            llvm.store %1842, %1843 : i32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        }
        %coord_3835 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3836 = cute.get_layout(%view_3591) : !memref_rmem_bf16_19
        %idx_3837 = cute.crd2idx(%coord_3835, %lay_3836) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),1,4):(((1,2),4),0,8)">) -> !cute.int_tuple<"24">
        %iter_3838 = cute.get_iter(%view_3591) : !memref_rmem_bf16_19
        %ptr_3839 = cute.add_offset(%iter_3838, %idx_3837) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"24">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_3840 = cute.make_view(%ptr_3839) : !memref_rmem_bf16_26
        %iter_3841 = cute.get_iter(%view_3840) : !memref_rmem_bf16_26
        %coord_3842 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_3843 = cute.get_layout(%rmem_753) : !memref_rmem_bf16_2
        %idx_3844 = cute.crd2idx(%coord_3842, %lay_3843) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_3845 = cute.get_iter(%rmem_753) : !memref_rmem_bf16_2
        %ptr_3846 = cute.add_offset(%iter_3845, %idx_3844) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_3847 = cute.make_view(%ptr_3846) : !memref_rmem_bf16_24
        %iter_3848 = cute.get_iter(%view_3847) : !memref_rmem_bf16_24
        %lay_3849 = cute.get_layout(%view_3840) : !memref_rmem_bf16_26
        %1771 = cute.get_shape(%lay_3849) : (!cute.layout<"(((2,2),2),1):(((1,2),4),0)">) -> !cute.shape<"(((2,2),2),1)">
        %e0_3850, %e1_3851, %e2_3852, %e3_3853 = cute.get_leaves(%1771) : !cute.shape<"(((2,2),2),1)">
        %lay_3854 = cute.get_layout(%view_3847) : !memref_rmem_bf16_24
        %1772 = cute.get_shape(%lay_3854) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_3855, %e1_3856, %e2_3857, %e3_3858 = cute.get_leaves(%1772) : !cute.shape<"((2,2),(8,2))">
        %iter_3859 = cute.get_iter(%view_3840) : !memref_rmem_bf16_26
        %iter_3860 = cute.get_iter(%view_3847) : !memref_rmem_bf16_24
        %iter_3861 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %iter_3862 = cute.get_iter(%rmem_763) : !memref_rmem_f32_
        %lay_3863 = cute.get_layout(%view_3840) : !memref_rmem_bf16_26
        %lay_3864 = cute.get_layout(%view_3847) : !memref_rmem_bf16_24
        %lay_3865 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %lay_3866 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
        %1773 = cute.static : !cute.layout<"1:0">
        %append_3867 = cute.append_to_rank<3> (%lay_3863, %1773) : !cute.layout<"(((2,2),2),1):(((1,2),4),0)">, !cute.layout<"1:0">
        %append_3868 = cute.append_to_rank<3> (%lay_3864, %1773) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_3869 = cute.size(%append_3867) <{mode = [2]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3870 = cute.size(%append_3867) <{mode = [1]}> : (!cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"1">
        %sz_3871 = cute.size(%append_3868) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %1774 = cute.get_scalars(%sz_3869) : !cute.int_tuple<"1">
        %1775 = cute.get_scalars(%sz_3870) : !cute.int_tuple<"1">
        %1776 = cute.get_scalars(%sz_3871) : !cute.int_tuple<"16">
        %c0_i32_3872 = arith.constant 0 : i32
        %c1_i32_3873 = arith.constant 1 : i32
        scf.for %arg8 = %c0_i32_3872 to %1774 step %c1_i32_3873  : i32 {
          scf.for %arg9 = %c0_i32_3872 to %1775 step %c1_i32_3873  : i32 {
            scf.for %arg10 = %c0_i32_3872 to %1776 step %c1_i32_3873  : i32 {
              %coord_3954 = cute.make_coord(%arg9, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3955 = cute.make_coord(%arg10, %arg8) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_3956 = cute.make_coord(%arg9, %arg10) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %1817:2 = cute.get_scalars(%coord_3954) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3957 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),4))">
              %idx_3958 = cute.crd2idx(%coord_3954, %append_3867) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),1,1):(((1,2),4),0,0)">) -> !cute.int_tuple<"0">
              %ptr_3959 = cute.add_offset(%iter_3859, %idx_3958) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_3960 = cute.make_view(%ptr_3959, %lay_3957) : !memref_rmem_bf16_27
              %1818:2 = cute.get_scalars(%coord_3955) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3961 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3962 = cute.crd2idx(%coord_3955, %append_3868) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3963 = cute.add_offset(%iter_3860, %idx_3962) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_3964 = cute.make_view(%ptr_3963, %lay_3961) : !memref_rmem_bf16_18
              %1819:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3965 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3966 = cute.crd2idx(%coord_3956, %lay_3865) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3967 = cute.add_offset(%iter_3861, %idx_3966) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3968 = cute.make_view(%ptr_3967, %lay_3965) : !memref_rmem_f32_2
              %1820:2 = cute.get_scalars(%coord_3956) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_3969 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_3970 = cute.crd2idx(%coord_3956, %lay_3866) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_3971 = cute.add_offset(%iter_3862, %idx_3970) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_3972 = cute.make_view(%ptr_3971, %lay_3969) : !memref_rmem_f32_2
              %iter_3973 = cute.get_iter(%view_3960) : !memref_rmem_bf16_27
              %iter_3974 = cute.get_iter(%view_3964) : !memref_rmem_bf16_18
              %iter_3975 = cute.get_iter(%view_3968) : !memref_rmem_f32_2
              %iter_3976 = cute.get_iter(%view_3972) : !memref_rmem_f32_2
              %1821 = builtin.unrealized_conversion_cast %iter_3973 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %1822 = llvm.load %1821 : !llvm.ptr -> i32
              %1823 = llvm.getelementptr %1821[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1824 = llvm.load %1823 : !llvm.ptr -> i32
              %1825 = llvm.getelementptr %1821[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %1826 = llvm.load %1825 : !llvm.ptr -> i32
              %1827 = llvm.getelementptr %1821[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %1828 = llvm.load %1827 : !llvm.ptr -> i32
              %1829 = builtin.unrealized_conversion_cast %iter_3974 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %1830 = llvm.load %1829 : !llvm.ptr -> i32
              %1831 = llvm.getelementptr %1829[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %1832 = llvm.load %1831 : !llvm.ptr -> i32
              %1833 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %1834 = llvm.load %1833 : !llvm.ptr -> f32
              %1835 = llvm.getelementptr %1833[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %1836 = llvm.load %1835 : !llvm.ptr -> f32
              %1837 = llvm.getelementptr %1833[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %1838 = llvm.load %1837 : !llvm.ptr -> f32
              %1839 = llvm.getelementptr %1833[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %1840 = llvm.load %1839 : !llvm.ptr -> f32
              %1841:4 = cute_nvgpu.arch.mma.SM80 A[%1822, %1824, %1826, %1828]  B[%1830, %1832]  C[%1834, %1836, %1838, %1840] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %1842 = builtin.unrealized_conversion_cast %iter_3975 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %1841#0, %1842 : f32, !llvm.ptr
              %1843 = llvm.getelementptr %1842[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#1, %1843 : f32, !llvm.ptr
              %1844 = llvm.getelementptr %1842[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#2, %1844 : f32, !llvm.ptr
              %1845 = llvm.getelementptr %1842[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %1841#3, %1845 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %1777 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
        %1778 = cute.get_shape(%1777) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
        %e0_3874, %e1_3875, %e2_3876, %e3_3877 = cute.get_leaves(%1778) : !cute.shape<"(32,4,1,1)">
        %1779 = cute.get_stride(%1777) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
        %e0_3878, %e1_3879, %e2_3880, %e3_3881 = cute.get_leaves(%1779) : !cute.stride<"(1,32,0,0)">
        %1780 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
        %e0_3882, %e1_3883, %e2_3884 = cute.get_leaves(%1780) : !cute.tile<"[64:1;16:1;16:1]">
        %1781 = cute.get_shape(%e0_3882) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3885 = cute.get_leaves(%1781) : !cute.shape<"64">
        %1782 = cute.get_stride(%e0_3882) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3886 = cute.get_leaves(%1782) : !cute.stride<"1">
        %1783 = cute.get_shape(%e1_3883) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3887 = cute.get_leaves(%1783) : !cute.shape<"16">
        %1784 = cute.get_stride(%e1_3883) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3888 = cute.get_leaves(%1784) : !cute.stride<"1">
        %1785 = cute.get_shape(%e2_3884) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3889 = cute.get_leaves(%1785) : !cute.shape<"16">
        %1786 = cute.get_stride(%e2_3884) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3890 = cute.get_leaves(%1786) : !cute.stride<"1">
        %1787 = cute.static : !cute.layout<"32:1">
        %1788 = cute.get_shape(%1787) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3891 = cute.get_leaves(%1788) : !cute.shape<"32">
        %1789 = cute.get_stride(%1787) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3892 = cute.get_leaves(%1789) : !cute.stride<"1">
        %1790 = cute.static : !cute.shape<"(16,8,16)">
        %e0_3893, %e1_3894, %e2_3895 = cute.get_leaves(%1790) : !cute.shape<"(16,8,16)">
        %1791 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
        %1792 = cute.get_shape(%1791) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
        %e0_3896, %e1_3897, %e2_3898, %e3_3899, %e4_3900 = cute.get_leaves(%1792) : !cute.shape<"((4,8),(2,2,2))">
        %1793 = cute.get_stride(%1791) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
        %e0_3901, %e1_3902, %e2_3903, %e3_3904, %e4_3905 = cute.get_leaves(%1793) : !cute.stride<"((32,1),(16,8,128))">
        %1794 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
        %1795 = cute.get_shape(%1794) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3906, %e1_3907, %e2_3908, %e3_3909 = cute.get_leaves(%1795) : !cute.shape<"((4,8),(2,2))">
        %1796 = cute.get_stride(%1794) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
        %e0_3910, %e1_3911, %e2_3912, %e3_3913 = cute.get_leaves(%1796) : !cute.stride<"((16,1),(8,64))">
        %1797 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
        %1798 = cute.get_shape(%1797) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
        %e0_3914, %e1_3915, %e2_3916, %e3_3917 = cute.get_leaves(%1798) : !cute.shape<"((4,8),(2,2))">
        %1799 = cute.get_stride(%1797) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
        %e0_3918, %e1_3919, %e2_3920, %e3_3921 = cute.get_leaves(%1799) : !cute.stride<"((32,1),(16,8))">
        %1800 = cute.static : !cute.tile<"[64:1;16:1]">
        %e0_3922, %e1_3923 = cute.get_leaves(%1800) : !cute.tile<"[64:1;16:1]">
        %1801 = cute.get_shape(%e0_3922) : (!cute.layout<"64:1">) -> !cute.shape<"64">
        %e0_3924 = cute.get_leaves(%1801) : !cute.shape<"64">
        %1802 = cute.get_stride(%e0_3922) : (!cute.layout<"64:1">) -> !cute.stride<"1">
        %e0_3925 = cute.get_leaves(%1802) : !cute.stride<"1">
        %1803 = cute.get_shape(%e1_3923) : (!cute.layout<"16:1">) -> !cute.shape<"16">
        %e0_3926 = cute.get_leaves(%1803) : !cute.shape<"16">
        %1804 = cute.get_stride(%e1_3923) : (!cute.layout<"16:1">) -> !cute.stride<"1">
        %e0_3927 = cute.get_leaves(%1804) : !cute.stride<"1">
        %1805 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
        %1806 = cute.get_shape(%1805) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %e0_3928, %e1_3929, %e2_3930, %e3_3931, %e4_3932, %e5_3933, %e6_3934 = cute.get_leaves(%1806) : !cute.shape<"((4,8,4),((2,2),(1,2)))">
        %1807 = cute.get_stride(%1805) : (!cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">) -> !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %e0_3935, %e1_3936, %e2_3937, %e3_3938, %e4_3939, %e5_3940, %e6_3941 = cute.get_leaves(%1807) : !cute.stride<"((128,1,16),((64,8),(0,512)))">
        %1808 = cute.static : !cute.layout<"32:1">
        %1809 = cute.get_shape(%1808) : (!cute.layout<"32:1">) -> !cute.shape<"32">
        %e0_3942 = cute.get_leaves(%1809) : !cute.shape<"32">
        %1810 = cute.get_stride(%1808) : (!cute.layout<"32:1">) -> !cute.stride<"1">
        %e0_3943 = cute.get_leaves(%1810) : !cute.stride<"1">
        %1811 = cute.static : !cute.layout<"(32,8):(8,1)">
        %1812 = cute.get_shape(%1811) : (!cute.layout<"(32,8):(8,1)">) -> !cute.shape<"(32,8)">
        %e0_3944, %e1_3945 = cute.get_leaves(%1812) : !cute.shape<"(32,8)">
        %1813 = cute.get_stride(%1811) : (!cute.layout<"(32,8):(8,1)">) -> !cute.stride<"(8,1)">
        %e0_3946, %e1_3947 = cute.get_leaves(%1813) : !cute.stride<"(8,1)">
        %1814 = cute.static : !cute.layout<"(32,(2,4)):(2,(1,64))">
        %1815 = cute.get_shape(%1814) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.shape<"(32,(2,4))">
        %e0_3948, %e1_3949, %e2_3950 = cute.get_leaves(%1815) : !cute.shape<"(32,(2,4))">
        %1816 = cute.get_stride(%1814) : (!cute.layout<"(32,(2,4)):(2,(1,64))">) -> !cute.stride<"(2,(1,64))">
        %e0_3951, %e1_3952, %e2_3953 = cute.get_leaves(%1816) : !cute.stride<"(2,(1,64))">
        scf.yield %1725#1, %arg7 : !mma_bf16_bf16_f32_16x8x16_, !copy_ldsm_4_3
      }
      %lay_2184 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
      %rmem_2185 = cute.memref.alloca(%lay_2184) : !memref_rmem_bf16_28
      %iter_2186 = cute.get_iter(%rmem_2185) : !memref_rmem_bf16_28
      %iter_2187 = cute.get_iter(%rmem_2185) : !memref_rmem_bf16_28
      %lay_2188 = cute.get_layout(%rmem_763) : !memref_rmem_f32_
      %1377 = cute.get_shape(%lay_2188) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_2189, %e1_2190, %e2_2191, %e3_2192 = cute.get_leaves(%1377) : !cute.shape<"((2,2),1,16)">
      %1378 = cute.memref.load_vec %rmem_763, row_major : !memref_rmem_f32_
      %1379 = arith.truncf %1378 : vector<64xf32> to vector<64xbf16>
      %lay_2193 = cute.get_layout(%rmem_2185) : !memref_rmem_bf16_28
      %1380 = cute.get_shape(%lay_2193) : (!cute.layout<"((2,2),1,16):((1,2),0,4)">) -> !cute.shape<"((2,2),1,16)">
      %e0_2194, %e1_2195, %e2_2196, %e3_2197 = cute.get_leaves(%1380) : !cute.shape<"((2,2),1,16)">
      %int_tuple_2198 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_2199 = cute.size(%int_tuple_2198) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_2200 = cute.get_leaves(%sz_2199) : !cute.int_tuple<"64">
      %int_tuple_2201 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),1,16)">
      %sz_2202 = cute.size(%int_tuple_2201) : (!cute.int_tuple<"((2,2),1,16)">) -> !cute.int_tuple<"64">
      %e0_2203 = cute.get_leaves(%sz_2202) : !cute.int_tuple<"64">
      cute.memref.store_vec %1379, %rmem_2185, row_major : !memref_rmem_bf16_28
      %1381 = cute.composed_get_inner(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
      %iter_2204 = cute.recast_iter(%iter_377) : !cute.ptr<bf16, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>, S<3,4,3>>
      %1382 = cute.composed_get_outer(%3) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %view_2205 = cute.make_view(%iter_2204, %1382) : !memref_smem_bf16_23
      %iter_2206 = cute.get_iter(%view_2205) : !memref_smem_bf16_23
      %atom_2207 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %1383 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %1384 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_2208, %e1_2209, %e2_2210 = cute.get_leaves(%1384) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_2211 = cute.size(%e0_2208) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_2212 = cute.get_leaves(%sz_2211) : !cute.int_tuple<"64">
      %1385 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_2213, %e1_2214, %e2_2215 = cute.get_leaves(%1385) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_2216 = cute.size(%e1_2214) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_2217 = cute.get_leaves(%sz_2216) : !cute.int_tuple<"16">
      %tile_2218 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %1386 = cute.make_tiled_copy(%atom_2207) : !copy_simt1
      %iter_2219 = cute.get_iter(%rmem_2185) : !memref_rmem_bf16_28
      %view_2220 = cute.make_view(%iter_2219) : !memref_rmem_bf16_29
      %iter_2221 = cute.get_iter(%view_2220) : !memref_rmem_bf16_29
      %coord_2222 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2223 = cute.get_iter(%view_2205) : !memref_smem_bf16_23
      %1387 = cute.get_scalars(%coord_2222) <{only_dynamic}> : !cute.coord<"?">
      %c4_i32_2224 = arith.constant 4 : i32
      %1388 = arith.divsi %1387, %c4_i32_2224 : i32
      %c4_i32_2225 = arith.constant 4 : i32
      %1389 = arith.remsi %1387, %c4_i32_2225 : i32
      %c2_i32_2226 = arith.constant 2 : i32
      %1390 = arith.muli %1389, %c2_i32_2226 : i32
      %c8_i32_2227 = arith.constant 8 : i32
      %1391 = arith.divsi %1388, %c8_i32_2227 : i32
      %c8_i32_2228 = arith.constant 8 : i32
      %1392 = arith.remsi %1388, %c8_i32_2228 : i32
      %c64_i32_2229 = arith.constant 64 : i32
      %1393 = arith.muli %1392, %c64_i32_2229 : i32
      %1394 = arith.addi %1390, %1393 : i32
      %c1024_i32_2230 = arith.constant 1024 : i32
      %1395 = arith.muli %1391, %c1024_i32_2230 : i32
      %1396 = arith.addi %1394, %1395 : i32
      %iv_2231 = cute.assume(%1396) : (i32) -> !cute.i32<divby 2>
      %int_tuple_2232 = cute.make_int_tuple(%iv_2231) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_2233 = cute.add_offset(%iter_2223, %int_tuple_2232) : (!cute.ptr<bf16, smem, align<1024>, S<3,4,3>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
      %view_2234 = cute.make_view(%ptr_2233) : !memref_smem_bf16_24
      %iter_2235 = cute.get_iter(%view_2234) : !memref_smem_bf16_24
      %lay_2236 = cute.get_layout(%view_2220) : !memref_rmem_bf16_29
      %1397 = cute.get_shape(%lay_2236) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_2237, %e1_2238, %e2_2239, %e3_2240 = cute.get_leaves(%1397) : !cute.shape<"((1,8),1,8)">
      %lay_2241 = cute.get_layout(%view_2234) : !memref_smem_bf16_24
      %1398 = cute.get_shape(%lay_2241) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_2242, %e1_2243, %e2_2244, %e3_2245, %e4_2246, %e5_2247, %e6_2248 = cute.get_leaves(%1398) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %lay_2249 = cute.get_layout(%view_2220) : !memref_rmem_bf16_29
      %shape_2250 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2251 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_2249, %lay_2251) : !cute.layout<"((1,8),1,8):((0,1),0,8)">, !cute.layout<"1:0">
      %view_2252 = cute.make_view(%iter_2221, %append) : !memref_rmem_bf16_29
      %iter_2253 = cute.get_iter(%view_2252) : !memref_rmem_bf16_29
      %lay_2254 = cute.get_layout(%view_2252) : !memref_rmem_bf16_29
      %1399 = cute.get_shape(%lay_2254) : (!cute.layout<"((1,8),1,8):((0,1),0,8)">) -> !cute.shape<"((1,8),1,8)">
      %e0_2255, %e1_2256, %e2_2257, %e3_2258 = cute.get_leaves(%1399) : !cute.shape<"((1,8),1,8)">
      %iter_2259 = cute.get_iter(%view_2252) : !memref_rmem_bf16_29
      %view_2260 = cute.make_view(%iter_2259) : !memref_rmem_bf16_30
      %iter_2261 = cute.get_iter(%view_2260) : !memref_rmem_bf16_30
      %iter_2262 = cute.get_iter(%view_2260) : !memref_rmem_bf16_30
      %lay_2263 = cute.get_layout(%view_2234) : !memref_smem_bf16_24
      %shape_2264 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2265 = cute.make_layout() : !cute.layout<"1:0">
      %append_2266 = cute.append_to_rank<2> (%lay_2263, %lay_2265) : !cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">, !cute.layout<"1:0">
      %view_2267 = cute.make_view(%iter_2235, %append_2266) : !memref_smem_bf16_24
      %iter_2268 = cute.get_iter(%view_2267) : !memref_smem_bf16_24
      %lay_2269 = cute.get_layout(%view_2267) : !memref_smem_bf16_24
      %1400 = cute.get_shape(%lay_2269) : (!cute.layout<"((1,(2,2,2)),1,(4,2)):((0,(1,512,8)),0,(16,4096))">) -> !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %e0_2270, %e1_2271, %e2_2272, %e3_2273, %e4_2274, %e5_2275, %e6_2276 = cute.get_leaves(%1400) : !cute.shape<"((1,(2,2,2)),1,(4,2))">
      %iter_2277 = cute.get_iter(%view_2267) : !memref_smem_bf16_24
      %view_2278 = cute.make_view(%iter_2277) : !memref_smem_bf16_25
      %iter_2279 = cute.get_iter(%view_2278) : !memref_smem_bf16_25
      %iter_2280 = cute.get_iter(%view_2278) : !memref_smem_bf16_25
      %lay_2281 = cute.get_layout(%view_2260) : !memref_rmem_bf16_30
      %1401 = cute.get_shape(%lay_2281) : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.shape<"((1,8),(1,8))">
      %e0_2282, %e1_2283, %e2_2284, %e3_2285 = cute.get_leaves(%1401) : !cute.shape<"((1,8),(1,8))">
      %lay_2286 = cute.get_layout(%view_2278) : !memref_smem_bf16_25
      %1402 = cute.get_shape(%lay_2286) : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %e0_2287, %e1_2288, %e2_2289, %e3_2290, %e4_2291, %e5_2292, %e6_2293 = cute.get_leaves(%1402) : !cute.shape<"((1,(2,2,2)),(1,(4,2)))">
      %lay_2294 = cute.get_layout(%view_2260) : !memref_rmem_bf16_30
      %sz_2295 = cute.size(%lay_2294) <{mode = [1]}> : (!cute.layout<"((1,8),(1,8)):((0,1),(0,8))">) -> !cute.int_tuple<"8">
      %e0_2296 = cute.get_leaves(%sz_2295) : !cute.int_tuple<"8">
      %lay_2297 = cute.get_layout(%view_2278) : !memref_smem_bf16_25
      %sz_2298 = cute.size(%lay_2297) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">) -> !cute.int_tuple<"8">
      %e0_2299 = cute.get_leaves(%sz_2298) : !cute.int_tuple<"8">
      %1403 = cute.static : !cute.layout<"1:0">
      %iter_2300 = cute.get_iter(%view_2260) : !memref_rmem_bf16_30
      %iter_2301 = cute.get_iter(%view_2278) : !memref_smem_bf16_25
      %lay_2302 = cute.get_layout(%view_2260) : !memref_rmem_bf16_30
      %lay_2303 = cute.get_layout(%view_2278) : !memref_smem_bf16_25
      %append_2304 = cute.append_to_rank<2> (%lay_2302, %1403) : !cute.layout<"((1,8),(1,8)):((0,1),(0,8))">, !cute.layout<"1:0">
      %append_2305 = cute.append_to_rank<2> (%lay_2303, %1403) : !cute.layout<"((1,(2,2,2)),(1,(4,2))):((0,(1,512,8)),(0,(16,4096)))">, !cute.layout<"1:0">
      %lay_2306 = cute.make_layout() : !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">
      %lay_2307 = cute.make_layout() : !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">
      %sz_2308 = cute.size(%lay_2306) <{mode = [1]}> : (!cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"8">
      %1404 = cute.get_scalars(%sz_2308) : !cute.int_tuple<"8">
      %c0_i32_2309 = arith.constant 0 : i32
      %c1_i32_2310 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2309 to %1404 step %c1_i32_2310  : i32 {
        %coord_2734 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %1595 = cute.get_scalars(%coord_2734) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2735 = cute.make_layout() : !cute.layout<"((1,8)):((0,1))">
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2306) : (!cute.coord<"(_,?)">, !cute.layout<"((1,8),((1,8))):((0,1),((0,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2737 = cute.add_offset(%iter_2300, %idx_2736) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2738 = cute.make_view(%ptr_2737, %lay_2735) : !memref_rmem_bf16_31
        %1596 = cute.get_scalars(%coord_2734) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2739 = cute.make_layout() : !cute.layout<"((1,(2,2,2))):((0,(1,512,8)))">
        %idx_2740 = cute.crd2idx(%coord_2734, %lay_2307) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((1,(4,2)))):((0,(1,512,8)),((0,(16,4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_2741 = cute.add_offset(%iter_2301, %idx_2740) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %view_2742 = cute.make_view(%ptr_2741, %lay_2739) : !memref_smem_bf16_26
        %iter_2743 = cute.get_iter(%view_2738) : !memref_rmem_bf16_31
        %iter_2744 = cute.get_iter(%view_2742) : !memref_smem_bf16_26
        %swizzled = cute.apply_swizzle(%iter_2744) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1597 = builtin.unrealized_conversion_cast %iter_2743 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        %1598 = builtin.unrealized_conversion_cast %swizzled : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1599 = llvm.load %1597 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1599, %1598 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_2745 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_2746 = cute.add_offset(%iter_2743, %int_tuple_2745) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %int_tuple_2747 = cute.make_int_tuple() : () -> !cute.int_tuple<"512">
        %ptr_2748 = cute.add_offset(%iter_2744, %int_tuple_2747) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"512">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %swizzled_2749 = cute.apply_swizzle(%ptr_2748) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1600 = builtin.unrealized_conversion_cast %ptr_2746 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %1601 = builtin.unrealized_conversion_cast %swizzled_2749 : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1602 = llvm.load %1600 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1602, %1601 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_2750 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_2751 = cute.add_offset(%iter_2743, %int_tuple_2750) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %int_tuple_2752 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %ptr_2753 = cute.add_offset(%iter_2744, %int_tuple_2752) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %swizzled_2754 = cute.apply_swizzle(%ptr_2753) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1603 = builtin.unrealized_conversion_cast %ptr_2751 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        %1604 = builtin.unrealized_conversion_cast %swizzled_2754 : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1605 = llvm.load %1603 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1605, %1604 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_2755 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_2756 = cute.add_offset(%iter_2743, %int_tuple_2755) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %int_tuple_2757 = cute.make_int_tuple() : () -> !cute.int_tuple<"520">
        %ptr_2758 = cute.add_offset(%iter_2744, %int_tuple_2757) : (!cute.ptr<bf16, smem, align<4>, S<3,4,3>>, !cute.int_tuple<"520">) -> !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %swizzled_2759 = cute.apply_swizzle(%ptr_2758) : !cute.ptr<bf16, smem, align<4>, S<3,4,3>>
        %1606 = builtin.unrealized_conversion_cast %ptr_2756 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %1607 = builtin.unrealized_conversion_cast %swizzled_2759 : !cute.ptr<bf16, smem, align<4>, S<3,4,3>> to !llvm.ptr<3>
        %1608 = llvm.load %1606 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %1608, %1607 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2311 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_2312 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1405:7 = cute.get_scalars(%lay_2312) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %1406:2 = cute.get_scalars(%coord_2311) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_2313 = cute.assume(%1405#3) : (i32) -> !cute.i32<divby 8>
      %shape_2314 = cute.make_shape(%1405#1, %iv_2313) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_2315 = cute.assume(%1405#5) : (i64) -> !cute.i64<divby 8>
      %stride_2316 = cute.make_stride(%iv_2315) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_2317 = cute.make_layout(%shape_2314, %stride_2316) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_2318 = cute.crd2idx(%coord_2311, %lay_2312) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_2319 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_2320 = cute.add_offset(%iter_2319, %idx_2318) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_2321 = cute.make_view(%ptr_2320, %lay_2317) : !memref_gmem_bf16_1
      %iter_2322 = cute.get_iter(%view_2321) : !memref_gmem_bf16_1
      %tile_2323 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_2324 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %1407 = cute.get_scalars(%coord_2324) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_2325 = cute.make_coord(%1407) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_2326 = cute.get_layout(%view_2321) : !memref_gmem_bf16_1
      %1408:3 = cute.get_scalars(%lay_2326) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_2327 = arith.constant 64 : i32
      %1409 = arith.ceildivsi %1408#0, %c64_i32_2327 : i32
      %c64_i64_2328 = arith.constant 64 : i64
      %1410 = arith.muli %1408#2, %c64_i64_2328 : i64
      %c128_i32_2329 = arith.constant 128 : i32
      %1411 = arith.ceildivsi %1408#1, %c128_i32_2329 : i32
      %shape_2330 = cute.make_shape(%1409, %1411) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_2331 = cute.assume(%1408#2) : (i64) -> !cute.i64<divby 8>
      %iv_2332 = cute.assume(%1410) : (i64) -> !cute.i64<divby 512>
      %stride_2333 = cute.make_stride(%iv_2331, %iv_2332) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_2334 = cute.make_layout(%shape_2330, %stride_2333) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %1412:4 = cute.get_scalars(%lay_2334) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %1413 = cute.get_scalars(%coord_2325) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_2335 = cute.make_shape() : () -> !cute.shape<"(64,128)">
      %iv_2336 = cute.assume(%1412#2) : (i64) -> !cute.i64<divby 8>
      %stride_2337 = cute.make_stride(%iv_2336) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_2338 = cute.make_layout(%shape_2335, %stride_2337) : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %idx_2339 = cute.crd2idx(%coord_2325, %lay_2334) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"?{i64 div=512}">
      %iter_2340 = cute.get_iter(%view_2321) : !memref_gmem_bf16_1
      %ptr_2341 = cute.add_offset(%iter_2340, %idx_2339) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_2342 = cute.make_view(%ptr_2341, %lay_2338) : !memref_gmem_bf16_2
      %iter_2343 = cute.get_iter(%view_2342) : !memref_gmem_bf16_2
      %coord_2344 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2345 = cute.get_iter(%view_2205) : !memref_smem_bf16_23
      %1414 = cute.get_scalars(%coord_2344) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_2346 = arith.constant 8 : i32
      %1415 = arith.divsi %1414, %c8_i32_2346 : i32
      %c8_i32_2347 = arith.constant 8 : i32
      %1416 = arith.remsi %1414, %c8_i32_2347 : i32
      %c8_i32_2348 = arith.constant 8 : i32
      %1417 = arith.muli %1416, %c8_i32_2348 : i32
      %c64_i32_2349 = arith.constant 64 : i32
      %1418 = arith.muli %1415, %c64_i32_2349 : i32
      %1419 = arith.addi %1417, %1418 : i32
      %iv_2350 = cute.assume(%1419) : (i32) -> !cute.i32<divby 8>
      %int_tuple_2351 = cute.make_int_tuple(%iv_2350) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_2352 = cute.add_offset(%iter_2345, %int_tuple_2351) : (!cute.ptr<bf16, smem, align<1024>, S<3,4,3>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
      %view_2353 = cute.make_view(%ptr_2352) : !memref_smem_bf16_27
      %iter_2354 = cute.get_iter(%view_2353) : !memref_smem_bf16_27
      %coord_2355 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2356 = cute.get_iter(%view_2342) : !memref_gmem_bf16_2
      %lay_2357 = cute.get_layout(%view_2342) : !memref_gmem_bf16_2
      %1420 = cute.get_scalars(%lay_2357) <{only_dynamic}> : !cute.layout<"(64,128):(?{i64 div=8},1)">
      %1421 = cute.get_scalars(%coord_2355) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_2358 = arith.constant 16 : i64
      %1422 = arith.muli %1420, %c16_i64_2358 : i64
      %c128_i64_2359 = arith.constant 128 : i64
      %1423 = arith.muli %1420, %c128_i64_2359 : i64
      %c16_i64_2360 = arith.constant 16 : i64
      %1424 = arith.muli %1420, %c16_i64_2360 : i64
      %c8_i32_2361 = arith.constant 8 : i32
      %1425 = arith.divsi %1421, %c8_i32_2361 : i32
      %c8_i32_2362 = arith.constant 8 : i32
      %1426 = arith.remsi %1421, %c8_i32_2362 : i32
      %c8_i32_2363 = arith.constant 8 : i32
      %1427 = arith.muli %1426, %c8_i32_2363 : i32
      %1428 = arith.extsi %1425 : i32 to i64
      %1429 = arith.muli %1428, %1420 : i64
      %1430 = arith.extsi %1427 : i32 to i64
      %1431 = arith.addi %1430, %1429 : i64
      %iv_2364 = cute.assume(%1431) : (i64) -> !cute.i64<divby 8>
      %int_tuple_2365 = cute.make_int_tuple(%iv_2364) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_2366 = cute.add_offset(%iter_2356, %int_tuple_2365) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_2367 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
      %iv_2368 = cute.assume(%1422) : (i64) -> !cute.i64<divby 128>
      %stride_2369 = cute.make_stride(%iv_2368) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_2370 = cute.make_layout(%shape_2367, %stride_2369) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
      %view_2371 = cute.make_view(%ptr_2366, %lay_2370) : !memref_gmem_bf16_5
      %iter_2372 = cute.get_iter(%view_2371) : !memref_gmem_bf16_5
      %lay_2373 = cute.get_layout(%view_2371) : !memref_gmem_bf16_5
      %1432 = cute.get_scalars(%lay_2373) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
      %lay_2374 = cute.make_layout() : !cute.layout<"((8,1),4,2):((1,0),16,8)">
      %rmem_2375 = cute.memref.alloca(%lay_2374) : !memref_rmem_bf16_32
      %iter_2376 = cute.get_iter(%rmem_2375) : !memref_rmem_bf16_32
      %iter_2377 = cute.get_iter(%rmem_2375) : !memref_rmem_bf16_32
      %c1_i32_2378 = arith.constant 1 : i32
      %c128_i32_2379 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_2378 number_of_threads = %c128_i32_2379
      %lay_2380 = cute.get_layout(%view_2353) : !memref_smem_bf16_27
      %1433 = cute.get_shape(%lay_2380) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2381, %e1_2382, %e2_2383, %e3_2384 = cute.get_leaves(%1433) : !cute.shape<"((8,1),4,2)">
      %lay_2385 = cute.get_layout(%rmem_2375) : !memref_rmem_bf16_32
      %1434 = cute.get_shape(%lay_2385) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2386, %e1_2387, %e2_2388, %e3_2389 = cute.get_leaves(%1434) : !cute.shape<"((8,1),4,2)">
      %lay_2390 = cute.get_layout(%view_2353) : !memref_smem_bf16_27
      %shape_2391 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2392 = cute.make_layout() : !cute.layout<"1:0">
      %append_2393 = cute.append_to_rank<2> (%lay_2390, %lay_2392) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
      %view_2394 = cute.make_view(%iter_2354, %append_2393) : !memref_smem_bf16_27
      %iter_2395 = cute.get_iter(%view_2394) : !memref_smem_bf16_27
      %lay_2396 = cute.get_layout(%view_2394) : !memref_smem_bf16_27
      %1435 = cute.get_shape(%lay_2396) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2397, %e1_2398, %e2_2399, %e3_2400 = cute.get_leaves(%1435) : !cute.shape<"((8,1),4,2)">
      %iter_2401 = cute.get_iter(%view_2394) : !memref_smem_bf16_27
      %view_2402 = cute.make_view(%iter_2401) : !memref_smem_bf16_28
      %iter_2403 = cute.get_iter(%view_2402) : !memref_smem_bf16_28
      %iter_2404 = cute.get_iter(%view_2402) : !memref_smem_bf16_28
      %lay_2405 = cute.get_layout(%rmem_2375) : !memref_rmem_bf16_32
      %shape_2406 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2407 = cute.make_layout() : !cute.layout<"1:0">
      %append_2408 = cute.append_to_rank<2> (%lay_2405, %lay_2407) : !cute.layout<"((8,1),4,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_2409 = cute.make_view(%iter_2377, %append_2408) : !memref_rmem_bf16_32
      %iter_2410 = cute.get_iter(%view_2409) : !memref_rmem_bf16_32
      %lay_2411 = cute.get_layout(%view_2409) : !memref_rmem_bf16_32
      %1436 = cute.get_shape(%lay_2411) : (!cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2412, %e1_2413, %e2_2414, %e3_2415 = cute.get_leaves(%1436) : !cute.shape<"((8,1),4,2)">
      %iter_2416 = cute.get_iter(%view_2409) : !memref_rmem_bf16_32
      %view_2417 = cute.make_view(%iter_2416) : !memref_rmem_bf16_33
      %iter_2418 = cute.get_iter(%view_2417) : !memref_rmem_bf16_33
      %iter_2419 = cute.get_iter(%view_2417) : !memref_rmem_bf16_33
      %lay_2420 = cute.get_layout(%view_2402) : !memref_smem_bf16_28
      %1437 = cute.get_shape(%lay_2420) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_2421, %e1_2422, %e2_2423, %e3_2424 = cute.get_leaves(%1437) : !cute.shape<"((8,1),(4,2))">
      %lay_2425 = cute.get_layout(%view_2417) : !memref_rmem_bf16_33
      %1438 = cute.get_shape(%lay_2425) : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_2426, %e1_2427, %e2_2428, %e3_2429 = cute.get_leaves(%1438) : !cute.shape<"((8,1),(4,2))">
      %lay_2430 = cute.get_layout(%view_2402) : !memref_smem_bf16_28
      %sz_2431 = cute.size(%lay_2430) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
      %e0_2432 = cute.get_leaves(%sz_2431) : !cute.int_tuple<"8">
      %lay_2433 = cute.get_layout(%view_2417) : !memref_rmem_bf16_33
      %sz_2434 = cute.size(%lay_2433) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(16,8))">) -> !cute.int_tuple<"8">
      %e0_2435 = cute.get_leaves(%sz_2434) : !cute.int_tuple<"8">
      %1439 = cute.static : !cute.layout<"1:0">
      %iter_2436 = cute.get_iter(%view_2402) : !memref_smem_bf16_28
      %iter_2437 = cute.get_iter(%view_2417) : !memref_rmem_bf16_33
      %lay_2438 = cute.get_layout(%view_2402) : !memref_smem_bf16_28
      %lay_2439 = cute.get_layout(%view_2417) : !memref_rmem_bf16_33
      %append_2440 = cute.append_to_rank<2> (%lay_2438, %1439) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
      %append_2441 = cute.append_to_rank<2> (%lay_2439, %1439) : !cute.layout<"((8,1),(4,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_2442 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
      %lay_2443 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">
      %sz_2444 = cute.size(%lay_2442) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"8">
      %1440 = cute.get_scalars(%sz_2444) : !cute.int_tuple<"8">
      %c0_i32_2445 = arith.constant 0 : i32
      %c1_i32_2446 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2445 to %1440 step %c1_i32_2446  : i32 {
        %coord_2734 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %1595 = cute.get_scalars(%coord_2734) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2735 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2442) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_2737 = cute.add_offset(%iter_2436, %idx_2736) : (!cute.ptr<bf16, smem, align<16>, S<3,4,3>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
        %view_2738 = cute.make_view(%ptr_2737, %lay_2735) : !memref_smem_bf16_29
        %1596 = cute.get_scalars(%coord_2734) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_2739 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_2740 = cute.crd2idx(%coord_2734, %lay_2443) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_2741 = cute.add_offset(%iter_2437, %idx_2740) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_2742 = cute.make_view(%ptr_2741, %lay_2739) : !memref_rmem_bf16_9
        %iter_2743 = cute.get_iter(%view_2738) : !memref_smem_bf16_29
        %iter_2744 = cute.get_iter(%view_2742) : !memref_rmem_bf16_9
        %swizzled = cute.apply_swizzle(%iter_2743) : !cute.ptr<bf16, smem, align<16>, S<3,4,3>>
        %1597 = builtin.unrealized_conversion_cast %swizzled : !cute.ptr<bf16, smem, align<16>, S<3,4,3>> to !llvm.ptr<3>
        %1598 = builtin.unrealized_conversion_cast %iter_2744 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        %1599 = llvm.load %1597 {alignment = 16 : i64} : !llvm.ptr<3> -> vector<8xbf16>
        llvm.store %1599, %1598 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_2447 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1441 = cute.get_shape(%lay_2447) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2448, %e1_2449, %e2_2450, %e3_2451 = cute.get_leaves(%1441) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2452 = cute.to_int_tuple(%e0_2448) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1442 = cute.get_scalars(%itup_2452) : !cute.int_tuple<"?">
      %itup_2453 = cute.to_int_tuple(%e1_2449) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1443 = cute.get_scalars(%itup_2453) : !cute.int_tuple<"?">
      %itup_2454 = cute.to_int_tuple(%e2_2450) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1444 = cute.get_scalars(%itup_2454) : !cute.int_tuple<"?">
      %itup_2455 = cute.to_int_tuple(%e3_2451) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1445 = cute.get_scalars(%itup_2455) : !cute.int_tuple<"?{div=8}">
      %shape_2456 = cute.make_shape(%itup_2452, %itup_2453, %itup_2454, %itup_2455) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_2457 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_2458 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_2459 = cute.make_layout(%shape_2456, %stride_2458) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_2460 = cute.make_view(%int_tuple_2457, %lay_2459) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_2461 = cute.get_iter(%view_2460) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_2462, %e1_2463, %e2_2464, %e3_2465 = cute.get_leaves(%iter_2461) : !cute.int_tuple<"(0,0,0,0)">
      %coord_2466 = cute.make_coord(%132, %133) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_2467 = cute.get_layout(%view_2460) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %1446:4 = cute.get_scalars(%lay_2467) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %1447:2 = cute.get_scalars(%coord_2466) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_2468 = cute.assume(%1446#3) : (i32) -> !cute.i32<divby 8>
      %shape_2469 = cute.make_shape(%1446#1, %iv_2468) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_2470 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_2471 = cute.make_layout(%shape_2469, %stride_2470) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_2472 = cute.crd2idx(%coord_2466, %lay_2467) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_2473 = cute.get_iter(%view_2460) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_2474 = cute.add_offset(%iter_2473, %idx_2472) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_2475 = cute.make_view(%tup_2474, %lay_2471) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_2476 = cute.get_iter(%view_2475) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_2477, %e1_2478, %e2_2479, %e3_2480 = cute.get_leaves(%iter_2476) : !cute.int_tuple<"(?,0,?,0)">
      %1448 = cute.get_scalars(%e0_2477) : !cute.int_tuple<"?">
      %1449 = cute.get_scalars(%e2_2479) : !cute.int_tuple<"?">
      %tile_2481 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_2482 = cute.make_coord(%sub_223) : (!cute.int_tuple<"?">) -> !cute.coord<"(?,0)">
      %1450 = cute.get_scalars(%coord_2482) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_2483 = cute.make_coord(%1450) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_2484 = cute.get_layout(%view_2475) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %1451:2 = cute.get_scalars(%lay_2484) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_2485 = arith.constant 64 : i32
      %1452 = arith.ceildivsi %1451#0, %c64_i32_2485 : i32
      %c128_i32_2486 = arith.constant 128 : i32
      %1453 = arith.ceildivsi %1451#1, %c128_i32_2486 : i32
      %shape_2487 = cute.make_shape(%1452, %1453) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_2488 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_2489 = cute.make_layout(%shape_2487, %stride_2488) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_2490 = cute.crd2idx(%coord_2483, %lay_2489) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_2491 = cute.get_iter(%view_2475) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_2492 = cute.add_offset(%iter_2491, %idx_2490) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_2493 = cute.make_view(%tup_2492) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_2494 = cute.get_iter(%view_2493) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_2495, %e1_2496, %e2_2497, %e3_2498 = cute.get_leaves(%iter_2494) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %1454 = cute.get_scalars(%e0_2495) : !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%e1_2496) : !cute.int_tuple<"?{div=64}">
      %1456 = cute.get_scalars(%e2_2497) : !cute.int_tuple<"?">
      %coord_2499 = cute.make_coord(%129) : (i32) -> !cute.coord<"?">
      %iter_2500 = cute.get_iter(%view_2493) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %1457 = cute.get_scalars(%coord_2499) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_2501 = arith.constant 8 : i32
      %1458 = arith.divsi %1457, %c8_i32_2501 : i32
      %c8_i32_2502 = arith.constant 8 : i32
      %1459 = arith.remsi %1457, %c8_i32_2502 : i32
      %c8_i32_2503 = arith.constant 8 : i32
      %1460 = arith.muli %1459, %c8_i32_2503 : i32
      %iv_2504 = cute.assume(%1460) : (i32) -> !cute.i32<divby 8>
      %int_tuple_2505 = cute.make_int_tuple(%1458, %iv_2504) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_2506 = cute.add_offset(%iter_2500, %int_tuple_2505) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2507 = cute.make_view(%tup_2506) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_2508 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_2509, %e1_2510, %e2_2511, %e3_2512 = cute.get_leaves(%iter_2508) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1461 = cute.get_scalars(%e0_2509) : !cute.int_tuple<"?">
      %1462 = cute.get_scalars(%e1_2510) : !cute.int_tuple<"?">
      %1463 = cute.get_scalars(%e2_2511) : !cute.int_tuple<"?">
      %1464 = cute.get_scalars(%e3_2512) : !cute.int_tuple<"?{div=8}">
      %lay_2513 = cute.get_layout(%view_2371) : !memref_gmem_bf16_5
      %1465 = cute.get_shape(%lay_2513) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
      %e0_2514, %e1_2515, %e2_2516, %e3_2517 = cute.get_leaves(%1465) : !cute.shape<"((8,1),4,2)">
      %shape_2518 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_2519 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_2520 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_2521 = cute.memref.alloca(%lay_2520) : !memref_rmem_i8_
      %iter_2522 = cute.get_iter(%rmem_2521) : !memref_rmem_i8_
      %iter_2523 = cute.get_iter(%rmem_2521) : !memref_rmem_i8_
      %lay_2524 = cute.get_layout(%rmem_2521) : !memref_rmem_i8_
      %1466 = cute.get_shape(%lay_2524) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_2525, %e1_2526, %e2_2527 = cute.get_leaves(%1466) : !cute.shape<"(1,4,2)">
      %int_tuple_2528 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_2529 = cute.size(%int_tuple_2528) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_2530 = cute.get_leaves(%sz_2529) : !cute.int_tuple<"2">
      %coord_2531 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_2532 = cute.get_layout(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2533 = cute.crd2idx(%coord_2531, %lay_2532) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_2534 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2535 = cute.add_offset(%iter_2534, %idx_2533) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2536 = cute.make_view(%tup_2535) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2537 = cute.get_iter(%view_2536) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2538, %e1_2539, %e2_2540, %e3_2541 = cute.get_leaves(%iter_2537) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1467 = cute.get_scalars(%e0_2538) : !cute.int_tuple<"?">
      %1468 = cute.get_scalars(%e1_2539) : !cute.int_tuple<"?">
      %1469 = cute.get_scalars(%e2_2540) : !cute.int_tuple<"?">
      %1470 = cute.get_scalars(%e3_2541) : !cute.int_tuple<"?{div=8}">
      %iter_2542 = cute.get_iter(%view_2536) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2543, %e1_2544, %e2_2545, %e3_2546 = cute.get_leaves(%iter_2542) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1471 = cute.get_scalars(%e0_2543) : !cute.int_tuple<"?">
      %1472 = cute.get_scalars(%e1_2544) : !cute.int_tuple<"?">
      %1473 = cute.get_scalars(%e2_2545) : !cute.int_tuple<"?">
      %1474 = cute.get_scalars(%e3_2546) : !cute.int_tuple<"?{div=8}">
      %iter_2547 = cute.get_iter(%view_2536) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2548, %e1_2549, %e2_2550, %e3_2551 = cute.get_leaves(%iter_2547) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1475 = cute.get_scalars(%e0_2548) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e1_2549) : !cute.int_tuple<"?">
      %1477 = cute.get_scalars(%e2_2550) : !cute.int_tuple<"?">
      %1478 = cute.get_scalars(%e3_2551) : !cute.int_tuple<"?{div=8}">
      %lay_2552 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1479 = cute.get_shape(%lay_2552) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2553, %e1_2554, %e2_2555, %e3_2556 = cute.get_leaves(%1479) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2557 = cute.to_int_tuple(%e0_2553) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1480 = cute.get_scalars(%itup_2557) : !cute.int_tuple<"?">
      %itup_2558 = cute.to_int_tuple(%e1_2554) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1481 = cute.get_scalars(%itup_2558) : !cute.int_tuple<"?">
      %itup_2559 = cute.to_int_tuple(%e2_2555) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1482 = cute.get_scalars(%itup_2559) : !cute.int_tuple<"?">
      %itup_2560 = cute.to_int_tuple(%e3_2556) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1483 = cute.get_scalars(%itup_2560) : !cute.int_tuple<"?{div=8}">
      %coord_2561 = cute.make_coord(%e3_2551) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_2562 = cute.make_coord(%itup_2560) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1484 = cute.get_scalars(%coord_2561) : !cute.coord<"?{div=8}">
      %1485 = cute.get_scalars(%coord_2562) : !cute.coord<"?{div=8}">
      %true_2563 = arith.constant true
      %1486 = arith.cmpi slt, %1484, %1485 : i32
      %1487 = arith.andi %true_2563, %1486 : i1
      %1488 = arith.extui %1487 : i1 to i8
      %coord_2564 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_2521, %coord_2564, %1488) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_2565 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_2566 = cute.get_layout(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2567 = cute.crd2idx(%coord_2565, %lay_2566) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_2568 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2569 = cute.add_offset(%iter_2568, %idx_2567) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2570 = cute.make_view(%tup_2569) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2571 = cute.get_iter(%view_2570) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2572, %e1_2573, %e2_2574, %e3_2575 = cute.get_leaves(%iter_2571) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1489 = cute.get_scalars(%e0_2572) : !cute.int_tuple<"?">
      %1490 = cute.get_scalars(%e1_2573) : !cute.int_tuple<"?">
      %1491 = cute.get_scalars(%e2_2574) : !cute.int_tuple<"?">
      %1492 = cute.get_scalars(%e3_2575) : !cute.int_tuple<"?{div=8}">
      %iter_2576 = cute.get_iter(%view_2570) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2577, %e1_2578, %e2_2579, %e3_2580 = cute.get_leaves(%iter_2576) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1493 = cute.get_scalars(%e0_2577) : !cute.int_tuple<"?">
      %1494 = cute.get_scalars(%e1_2578) : !cute.int_tuple<"?">
      %1495 = cute.get_scalars(%e2_2579) : !cute.int_tuple<"?">
      %1496 = cute.get_scalars(%e3_2580) : !cute.int_tuple<"?{div=8}">
      %iter_2581 = cute.get_iter(%view_2570) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2582, %e1_2583, %e2_2584, %e3_2585 = cute.get_leaves(%iter_2581) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1497 = cute.get_scalars(%e0_2582) : !cute.int_tuple<"?">
      %1498 = cute.get_scalars(%e1_2583) : !cute.int_tuple<"?">
      %1499 = cute.get_scalars(%e2_2584) : !cute.int_tuple<"?">
      %1500 = cute.get_scalars(%e3_2585) : !cute.int_tuple<"?{div=8}">
      %lay_2586 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1501 = cute.get_shape(%lay_2586) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2587, %e1_2588, %e2_2589, %e3_2590 = cute.get_leaves(%1501) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2591 = cute.to_int_tuple(%e0_2587) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1502 = cute.get_scalars(%itup_2591) : !cute.int_tuple<"?">
      %itup_2592 = cute.to_int_tuple(%e1_2588) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1503 = cute.get_scalars(%itup_2592) : !cute.int_tuple<"?">
      %itup_2593 = cute.to_int_tuple(%e2_2589) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1504 = cute.get_scalars(%itup_2593) : !cute.int_tuple<"?">
      %itup_2594 = cute.to_int_tuple(%e3_2590) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1505 = cute.get_scalars(%itup_2594) : !cute.int_tuple<"?{div=8}">
      %coord_2595 = cute.make_coord(%e3_2585) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_2596 = cute.make_coord(%itup_2594) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %1506 = cute.get_scalars(%coord_2595) : !cute.coord<"?{div=8}">
      %1507 = cute.get_scalars(%coord_2596) : !cute.coord<"?{div=8}">
      %true_2597 = arith.constant true
      %1508 = arith.cmpi slt, %1506, %1507 : i32
      %1509 = arith.andi %true_2597, %1508 : i1
      %1510 = arith.extui %1509 : i1 to i8
      %coord_2598 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_2521, %coord_2598, %1510) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_2599 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_2600 = cute.size(%int_tuple_2599) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_2601 = cute.get_leaves(%sz_2600) : !cute.int_tuple<"4">
      %coord_2602 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_2603 = cute.get_layout(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2604 = cute.crd2idx(%coord_2602, %lay_2603) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_2605 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2606 = cute.add_offset(%iter_2605, %idx_2604) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2607 = cute.make_view(%tup_2606) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2608 = cute.get_iter(%view_2607) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2609, %e1_2610, %e2_2611, %e3_2612 = cute.get_leaves(%iter_2608) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1511 = cute.get_scalars(%e0_2609) : !cute.int_tuple<"?">
      %1512 = cute.get_scalars(%e1_2610) : !cute.int_tuple<"?">
      %1513 = cute.get_scalars(%e2_2611) : !cute.int_tuple<"?">
      %1514 = cute.get_scalars(%e3_2612) : !cute.int_tuple<"?{div=8}">
      %iter_2613 = cute.get_iter(%view_2607) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2614, %e1_2615, %e2_2616, %e3_2617 = cute.get_leaves(%iter_2613) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1515 = cute.get_scalars(%e0_2614) : !cute.int_tuple<"?">
      %1516 = cute.get_scalars(%e1_2615) : !cute.int_tuple<"?">
      %1517 = cute.get_scalars(%e2_2616) : !cute.int_tuple<"?">
      %1518 = cute.get_scalars(%e3_2617) : !cute.int_tuple<"?{div=8}">
      %iter_2618 = cute.get_iter(%view_2607) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2619, %e1_2620, %e2_2621, %e3_2622 = cute.get_leaves(%iter_2618) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1519 = cute.get_scalars(%e0_2619) : !cute.int_tuple<"?">
      %1520 = cute.get_scalars(%e1_2620) : !cute.int_tuple<"?">
      %1521 = cute.get_scalars(%e2_2621) : !cute.int_tuple<"?">
      %1522 = cute.get_scalars(%e3_2622) : !cute.int_tuple<"?{div=8}">
      %lay_2623 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1523 = cute.get_shape(%lay_2623) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2624, %e1_2625, %e2_2626, %e3_2627 = cute.get_leaves(%1523) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2628 = cute.to_int_tuple(%e0_2624) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1524 = cute.get_scalars(%itup_2628) : !cute.int_tuple<"?">
      %itup_2629 = cute.to_int_tuple(%e1_2625) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1525 = cute.get_scalars(%itup_2629) : !cute.int_tuple<"?">
      %itup_2630 = cute.to_int_tuple(%e2_2626) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1526 = cute.get_scalars(%itup_2630) : !cute.int_tuple<"?">
      %itup_2631 = cute.to_int_tuple(%e3_2627) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1527 = cute.get_scalars(%itup_2631) : !cute.int_tuple<"?{div=8}">
      %coord_2632 = cute.make_coord(%e1_2620) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2633 = cute.make_coord(%itup_2629) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1528 = cute.get_scalars(%coord_2632) : !cute.coord<"?">
      %1529 = cute.get_scalars(%coord_2633) : !cute.coord<"?">
      %true_2634 = arith.constant true
      %1530 = arith.cmpi slt, %1528, %1529 : i32
      %1531 = arith.andi %true_2634, %1530 : i1
      scf.if %1531 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2735 = cute.get_layout(%rmem_2375) : !memref_rmem_bf16_32
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_2737 = cute.get_iter(%rmem_2375) : !memref_rmem_bf16_32
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_rmem_bf16_34
        %iter_2740 = cute.get_iter(%view_2739) : !memref_rmem_bf16_34
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2742 = cute.get_layout(%view_2371) : !memref_gmem_bf16_5
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_2744 = cute.get_iter(%view_2371) : !memref_gmem_bf16_5
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_gmem_bf16_8
        %iter_2747 = cute.get_iter(%view_2746) : !memref_gmem_bf16_8
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_2749 = cute.get_layout(%rmem_2521) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_2521) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_rmem_bf16_34
        %iter_2768 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %lay_2769 = cute.get_layout(%view_2767) : !memref_rmem_bf16_34
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %view_2774 = cute.make_view(%iter_2773) : !memref_rmem_bf16_35
        %iter_2775 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2776 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %lay_2777 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_gmem_bf16_8
        %iter_2782 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %lay_2783 = cute.get_layout(%view_2781) : !memref_gmem_bf16_8
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %view_2788 = cute.make_view(%iter_2787) : !memref_gmem_bf16_9
        %iter_2789 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %iter_2790 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2819 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2820 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %lay_2821 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_rmem_bf16_9
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_gmem_bf16_10
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_rmem_bf16_9
          %iter_2847 = cute.get_iter(%view_2841) : !memref_gmem_bf16_10
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.mlir.constant(0 : i8) : i8
          %1610 = llvm.icmp "ne" %1608, %1609 : i8
          scf.if %1610 {
            %1611 = builtin.unrealized_conversion_cast %iter_2846 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1612 = builtin.unrealized_conversion_cast %iter_2847 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1613 = llvm.load %1611 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1613, %1612 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2635 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_2636 = cute.get_layout(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2637 = cute.crd2idx(%coord_2635, %lay_2636) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_2638 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2639 = cute.add_offset(%iter_2638, %idx_2637) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2640 = cute.make_view(%tup_2639) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2641 = cute.get_iter(%view_2640) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2642, %e1_2643, %e2_2644, %e3_2645 = cute.get_leaves(%iter_2641) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1532 = cute.get_scalars(%e0_2642) : !cute.int_tuple<"?">
      %1533 = cute.get_scalars(%e1_2643) : !cute.int_tuple<"?">
      %1534 = cute.get_scalars(%e2_2644) : !cute.int_tuple<"?">
      %1535 = cute.get_scalars(%e3_2645) : !cute.int_tuple<"?{div=8}">
      %iter_2646 = cute.get_iter(%view_2640) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2647, %e1_2648, %e2_2649, %e3_2650 = cute.get_leaves(%iter_2646) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1536 = cute.get_scalars(%e0_2647) : !cute.int_tuple<"?">
      %1537 = cute.get_scalars(%e1_2648) : !cute.int_tuple<"?">
      %1538 = cute.get_scalars(%e2_2649) : !cute.int_tuple<"?">
      %1539 = cute.get_scalars(%e3_2650) : !cute.int_tuple<"?{div=8}">
      %iter_2651 = cute.get_iter(%view_2640) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2652, %e1_2653, %e2_2654, %e3_2655 = cute.get_leaves(%iter_2651) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1540 = cute.get_scalars(%e0_2652) : !cute.int_tuple<"?">
      %1541 = cute.get_scalars(%e1_2653) : !cute.int_tuple<"?">
      %1542 = cute.get_scalars(%e2_2654) : !cute.int_tuple<"?">
      %1543 = cute.get_scalars(%e3_2655) : !cute.int_tuple<"?{div=8}">
      %lay_2656 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1544 = cute.get_shape(%lay_2656) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2657, %e1_2658, %e2_2659, %e3_2660 = cute.get_leaves(%1544) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2661 = cute.to_int_tuple(%e0_2657) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1545 = cute.get_scalars(%itup_2661) : !cute.int_tuple<"?">
      %itup_2662 = cute.to_int_tuple(%e1_2658) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1546 = cute.get_scalars(%itup_2662) : !cute.int_tuple<"?">
      %itup_2663 = cute.to_int_tuple(%e2_2659) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1547 = cute.get_scalars(%itup_2663) : !cute.int_tuple<"?">
      %itup_2664 = cute.to_int_tuple(%e3_2660) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1548 = cute.get_scalars(%itup_2664) : !cute.int_tuple<"?{div=8}">
      %coord_2665 = cute.make_coord(%e1_2653) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2666 = cute.make_coord(%itup_2662) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1549 = cute.get_scalars(%coord_2665) : !cute.coord<"?">
      %1550 = cute.get_scalars(%coord_2666) : !cute.coord<"?">
      %true_2667 = arith.constant true
      %1551 = arith.cmpi slt, %1549, %1550 : i32
      %1552 = arith.andi %true_2667, %1551 : i1
      scf.if %1552 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2735 = cute.get_layout(%rmem_2375) : !memref_rmem_bf16_32
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_2737 = cute.get_iter(%rmem_2375) : !memref_rmem_bf16_32
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_rmem_bf16_34
        %iter_2740 = cute.get_iter(%view_2739) : !memref_rmem_bf16_34
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2742 = cute.get_layout(%view_2371) : !memref_gmem_bf16_5
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_2744 = cute.get_iter(%view_2371) : !memref_gmem_bf16_5
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_gmem_bf16_8
        %iter_2747 = cute.get_iter(%view_2746) : !memref_gmem_bf16_8
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_2749 = cute.get_layout(%rmem_2521) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_2521) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_rmem_bf16_34
        %iter_2768 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %lay_2769 = cute.get_layout(%view_2767) : !memref_rmem_bf16_34
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %view_2774 = cute.make_view(%iter_2773) : !memref_rmem_bf16_35
        %iter_2775 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2776 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %lay_2777 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_gmem_bf16_8
        %iter_2782 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %lay_2783 = cute.get_layout(%view_2781) : !memref_gmem_bf16_8
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %view_2788 = cute.make_view(%iter_2787) : !memref_gmem_bf16_9
        %iter_2789 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %iter_2790 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2819 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2820 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %lay_2821 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_rmem_bf16_9
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_gmem_bf16_10
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_rmem_bf16_9
          %iter_2847 = cute.get_iter(%view_2841) : !memref_gmem_bf16_10
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.mlir.constant(0 : i8) : i8
          %1610 = llvm.icmp "ne" %1608, %1609 : i8
          scf.if %1610 {
            %1611 = builtin.unrealized_conversion_cast %iter_2846 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1612 = builtin.unrealized_conversion_cast %iter_2847 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1613 = llvm.load %1611 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1613, %1612 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2668 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_2669 = cute.get_layout(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2670 = cute.crd2idx(%coord_2668, %lay_2669) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_2671 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2672 = cute.add_offset(%iter_2671, %idx_2670) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2673 = cute.make_view(%tup_2672) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2674 = cute.get_iter(%view_2673) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2675, %e1_2676, %e2_2677, %e3_2678 = cute.get_leaves(%iter_2674) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1553 = cute.get_scalars(%e0_2675) : !cute.int_tuple<"?">
      %1554 = cute.get_scalars(%e1_2676) : !cute.int_tuple<"?">
      %1555 = cute.get_scalars(%e2_2677) : !cute.int_tuple<"?">
      %1556 = cute.get_scalars(%e3_2678) : !cute.int_tuple<"?{div=8}">
      %iter_2679 = cute.get_iter(%view_2673) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2680, %e1_2681, %e2_2682, %e3_2683 = cute.get_leaves(%iter_2679) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1557 = cute.get_scalars(%e0_2680) : !cute.int_tuple<"?">
      %1558 = cute.get_scalars(%e1_2681) : !cute.int_tuple<"?">
      %1559 = cute.get_scalars(%e2_2682) : !cute.int_tuple<"?">
      %1560 = cute.get_scalars(%e3_2683) : !cute.int_tuple<"?{div=8}">
      %iter_2684 = cute.get_iter(%view_2673) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2685, %e1_2686, %e2_2687, %e3_2688 = cute.get_leaves(%iter_2684) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1561 = cute.get_scalars(%e0_2685) : !cute.int_tuple<"?">
      %1562 = cute.get_scalars(%e1_2686) : !cute.int_tuple<"?">
      %1563 = cute.get_scalars(%e2_2687) : !cute.int_tuple<"?">
      %1564 = cute.get_scalars(%e3_2688) : !cute.int_tuple<"?{div=8}">
      %lay_2689 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1565 = cute.get_shape(%lay_2689) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2690, %e1_2691, %e2_2692, %e3_2693 = cute.get_leaves(%1565) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2694 = cute.to_int_tuple(%e0_2690) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1566 = cute.get_scalars(%itup_2694) : !cute.int_tuple<"?">
      %itup_2695 = cute.to_int_tuple(%e1_2691) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1567 = cute.get_scalars(%itup_2695) : !cute.int_tuple<"?">
      %itup_2696 = cute.to_int_tuple(%e2_2692) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1568 = cute.get_scalars(%itup_2696) : !cute.int_tuple<"?">
      %itup_2697 = cute.to_int_tuple(%e3_2693) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1569 = cute.get_scalars(%itup_2697) : !cute.int_tuple<"?{div=8}">
      %coord_2698 = cute.make_coord(%e1_2686) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2699 = cute.make_coord(%itup_2695) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1570 = cute.get_scalars(%coord_2698) : !cute.coord<"?">
      %1571 = cute.get_scalars(%coord_2699) : !cute.coord<"?">
      %true_2700 = arith.constant true
      %1572 = arith.cmpi slt, %1570, %1571 : i32
      %1573 = arith.andi %true_2700, %1572 : i1
      scf.if %1573 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2735 = cute.get_layout(%rmem_2375) : !memref_rmem_bf16_32
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_2737 = cute.get_iter(%rmem_2375) : !memref_rmem_bf16_32
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_rmem_bf16_34
        %iter_2740 = cute.get_iter(%view_2739) : !memref_rmem_bf16_34
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2742 = cute.get_layout(%view_2371) : !memref_gmem_bf16_5
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_2744 = cute.get_iter(%view_2371) : !memref_gmem_bf16_5
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_gmem_bf16_8
        %iter_2747 = cute.get_iter(%view_2746) : !memref_gmem_bf16_8
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_2749 = cute.get_layout(%rmem_2521) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_2521) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_rmem_bf16_34
        %iter_2768 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %lay_2769 = cute.get_layout(%view_2767) : !memref_rmem_bf16_34
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %view_2774 = cute.make_view(%iter_2773) : !memref_rmem_bf16_35
        %iter_2775 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2776 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %lay_2777 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_gmem_bf16_8
        %iter_2782 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %lay_2783 = cute.get_layout(%view_2781) : !memref_gmem_bf16_8
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %view_2788 = cute.make_view(%iter_2787) : !memref_gmem_bf16_9
        %iter_2789 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %iter_2790 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2819 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2820 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %lay_2821 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_rmem_bf16_9
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_gmem_bf16_10
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_rmem_bf16_9
          %iter_2847 = cute.get_iter(%view_2841) : !memref_gmem_bf16_10
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.mlir.constant(0 : i8) : i8
          %1610 = llvm.icmp "ne" %1608, %1609 : i8
          scf.if %1610 {
            %1611 = builtin.unrealized_conversion_cast %iter_2846 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1612 = builtin.unrealized_conversion_cast %iter_2847 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1613 = llvm.load %1611 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1613, %1612 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_2701 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_2702 = cute.get_layout(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_2703 = cute.crd2idx(%coord_2701, %lay_2702) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_2704 = cute.get_iter(%view_2507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_2705 = cute.add_offset(%iter_2704, %idx_2703) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_2706 = cute.make_view(%tup_2705) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_2707 = cute.get_iter(%view_2706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2708, %e1_2709, %e2_2710, %e3_2711 = cute.get_leaves(%iter_2707) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1574 = cute.get_scalars(%e0_2708) : !cute.int_tuple<"?">
      %1575 = cute.get_scalars(%e1_2709) : !cute.int_tuple<"?">
      %1576 = cute.get_scalars(%e2_2710) : !cute.int_tuple<"?">
      %1577 = cute.get_scalars(%e3_2711) : !cute.int_tuple<"?{div=8}">
      %iter_2712 = cute.get_iter(%view_2706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2713, %e1_2714, %e2_2715, %e3_2716 = cute.get_leaves(%iter_2712) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1578 = cute.get_scalars(%e0_2713) : !cute.int_tuple<"?">
      %1579 = cute.get_scalars(%e1_2714) : !cute.int_tuple<"?">
      %1580 = cute.get_scalars(%e2_2715) : !cute.int_tuple<"?">
      %1581 = cute.get_scalars(%e3_2716) : !cute.int_tuple<"?{div=8}">
      %iter_2717 = cute.get_iter(%view_2706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_2718, %e1_2719, %e2_2720, %e3_2721 = cute.get_leaves(%iter_2717) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1582 = cute.get_scalars(%e0_2718) : !cute.int_tuple<"?">
      %1583 = cute.get_scalars(%e1_2719) : !cute.int_tuple<"?">
      %1584 = cute.get_scalars(%e2_2720) : !cute.int_tuple<"?">
      %1585 = cute.get_scalars(%e3_2721) : !cute.int_tuple<"?{div=8}">
      %lay_2722 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %1586 = cute.get_shape(%lay_2722) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2723, %e1_2724, %e2_2725, %e3_2726 = cute.get_leaves(%1586) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2727 = cute.to_int_tuple(%e0_2723) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1587 = cute.get_scalars(%itup_2727) : !cute.int_tuple<"?">
      %itup_2728 = cute.to_int_tuple(%e1_2724) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1588 = cute.get_scalars(%itup_2728) : !cute.int_tuple<"?">
      %itup_2729 = cute.to_int_tuple(%e2_2725) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1589 = cute.get_scalars(%itup_2729) : !cute.int_tuple<"?">
      %itup_2730 = cute.to_int_tuple(%e3_2726) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1590 = cute.get_scalars(%itup_2730) : !cute.int_tuple<"?{div=8}">
      %coord_2731 = cute.make_coord(%e1_2719) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2732 = cute.make_coord(%itup_2728) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1591 = cute.get_scalars(%coord_2731) : !cute.coord<"?">
      %1592 = cute.get_scalars(%coord_2732) : !cute.coord<"?">
      %true_2733 = arith.constant true
      %1593 = arith.cmpi slt, %1591, %1592 : i32
      %1594 = arith.andi %true_2733, %1593 : i1
      scf.if %1594 {
        %coord_2734 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2735 = cute.get_layout(%rmem_2375) : !memref_rmem_bf16_32
        %idx_2736 = cute.crd2idx(%coord_2734, %lay_2735) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_2737 = cute.get_iter(%rmem_2375) : !memref_rmem_bf16_32
        %ptr_2738 = cute.add_offset(%iter_2737, %idx_2736) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_2739 = cute.make_view(%ptr_2738) : !memref_rmem_bf16_34
        %iter_2740 = cute.get_iter(%view_2739) : !memref_rmem_bf16_34
        %coord_2741 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2742 = cute.get_layout(%view_2371) : !memref_gmem_bf16_5
        %idx_2743 = cute.crd2idx(%coord_2741, %lay_2742) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_2744 = cute.get_iter(%view_2371) : !memref_gmem_bf16_5
        %ptr_2745 = cute.add_offset(%iter_2744, %idx_2743) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_2746 = cute.make_view(%ptr_2745) : !memref_gmem_bf16_8
        %iter_2747 = cute.get_iter(%view_2746) : !memref_gmem_bf16_8
        %coord_2748 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_2749 = cute.get_layout(%rmem_2521) : !memref_rmem_i8_
        %idx_2750 = cute.crd2idx(%coord_2748, %lay_2749) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_2751 = cute.get_iter(%rmem_2521) : !memref_rmem_i8_
        %ptr_2752 = cute.add_offset(%iter_2751, %idx_2750) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_2753 = cute.make_view(%ptr_2752) : !memref_rmem_i8_1
        %iter_2754 = cute.get_iter(%view_2753) : !memref_rmem_i8_1
        %lay_2755 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %1595 = cute.get_shape(%lay_2755) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2756, %e1_2757, %e2_2758 = cute.get_leaves(%1595) : !cute.shape<"((8,1),2)">
        %lay_2759 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %1596 = cute.get_shape(%lay_2759) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2760, %e1_2761, %e2_2762 = cute.get_leaves(%1596) : !cute.shape<"((8,1),2)">
        %lay_2763 = cute.get_layout(%view_2739) : !memref_rmem_bf16_34
        %shape_2764 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2765 = cute.make_layout() : !cute.layout<"1:0">
        %append_2766 = cute.append_to_rank<2> (%lay_2763, %lay_2765) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_2767 = cute.make_view(%iter_2740, %append_2766) : !memref_rmem_bf16_34
        %iter_2768 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %lay_2769 = cute.get_layout(%view_2767) : !memref_rmem_bf16_34
        %1597 = cute.get_shape(%lay_2769) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_2770, %e1_2771, %e2_2772 = cute.get_leaves(%1597) : !cute.shape<"((8,1),2)">
        %iter_2773 = cute.get_iter(%view_2767) : !memref_rmem_bf16_34
        %view_2774 = cute.make_view(%iter_2773) : !memref_rmem_bf16_35
        %iter_2775 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2776 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %lay_2777 = cute.get_layout(%view_2746) : !memref_gmem_bf16_8
        %shape_2778 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2779 = cute.make_layout() : !cute.layout<"1:0">
        %append_2780 = cute.append_to_rank<2> (%lay_2777, %lay_2779) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_2781 = cute.make_view(%iter_2747, %append_2780) : !memref_gmem_bf16_8
        %iter_2782 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %lay_2783 = cute.get_layout(%view_2781) : !memref_gmem_bf16_8
        %1598 = cute.get_shape(%lay_2783) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_2784, %e1_2785, %e2_2786 = cute.get_leaves(%1598) : !cute.shape<"((8,1),2)">
        %iter_2787 = cute.get_iter(%view_2781) : !memref_gmem_bf16_8
        %view_2788 = cute.make_view(%iter_2787) : !memref_gmem_bf16_9
        %iter_2789 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %iter_2790 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2791 = cute.get_layout(%view_2753) : !memref_rmem_i8_1
        %shape_2792 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_2793 = cute.make_layout() : !cute.layout<"1:0">
        %append_2794 = cute.append_to_rank<2> (%lay_2791, %lay_2793) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_2795 = cute.make_view(%iter_2754, %append_2794) : !memref_rmem_i8_1
        %iter_2796 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %lay_2797 = cute.get_layout(%view_2795) : !memref_rmem_i8_1
        %1599 = cute.get_shape(%lay_2797) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_2798, %e1_2799 = cute.get_leaves(%1599) : !cute.shape<"(1,2)">
        %iter_2800 = cute.get_iter(%view_2795) : !memref_rmem_i8_1
        %view_2801 = cute.make_view(%iter_2800) : !memref_rmem_i8_2
        %iter_2802 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %iter_2803 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2804 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %1600 = cute.get_shape(%lay_2804) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_2805, %e1_2806, %e2_2807 = cute.get_leaves(%1600) : !cute.shape<"((8,1),(2))">
        %lay_2808 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %1601 = cute.get_shape(%lay_2808) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_2809, %e1_2810, %e2_2811 = cute.get_leaves(%1601) : !cute.shape<"((8,1),(2))">
        %lay_2812 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %sz_2813 = cute.size(%lay_2812) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_2814 = cute.get_leaves(%sz_2813) : !cute.int_tuple<"2">
        %lay_2815 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %sz_2816 = cute.size(%lay_2815) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_2817 = cute.get_leaves(%sz_2816) : !cute.int_tuple<"2">
        %1602 = cute.static : !cute.layout<"1:0">
        %iter_2818 = cute.get_iter(%view_2774) : !memref_rmem_bf16_35
        %iter_2819 = cute.get_iter(%view_2788) : !memref_gmem_bf16_9
        %lay_2820 = cute.get_layout(%view_2774) : !memref_rmem_bf16_35
        %lay_2821 = cute.get_layout(%view_2788) : !memref_gmem_bf16_9
        %append_2822 = cute.append_to_rank<2> (%lay_2820, %1602) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_2823 = cute.append_to_rank<2> (%lay_2821, %1602) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_2824 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_2825 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_2826 = cute.get_iter(%view_2801) : !memref_rmem_i8_2
        %lay_2827 = cute.get_layout(%view_2801) : !memref_rmem_i8_2
        %append_2828 = cute.append_to_rank<2> (%lay_2827, %1602) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_2829 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_2830 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %1603 = cute.get_scalars(%sz_2830) : !cute.int_tuple<"2">
        %c0_i32_2831 = arith.constant 0 : i32
        %c1_i32_2832 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_2831 to %1603 step %c1_i32_2832  : i32 {
          %coord_2833 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %1604 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2834 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2835 = cute.crd2idx(%coord_2833, %lay_2824) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_2836 = cute.add_offset(%iter_2818, %idx_2835) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_2837 = cute.make_view(%ptr_2836, %lay_2834) : !memref_rmem_bf16_9
          %1605 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2838 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_2839 = cute.crd2idx(%coord_2833, %lay_2825) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_2840 = cute.add_offset(%iter_2819, %idx_2839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_2841 = cute.make_view(%ptr_2840, %lay_2838) : !memref_gmem_bf16_10
          %1606 = cute.get_scalars(%coord_2833) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_2842 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_2843 = cute.crd2idx(%coord_2833, %lay_2829) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_2844 = cute.add_offset(%iter_2826, %idx_2843) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_2845 = cute.make_view(%ptr_2844, %lay_2842) : !memref_rmem_i8_3
          %iter_2846 = cute.get_iter(%view_2837) : !memref_rmem_bf16_9
          %iter_2847 = cute.get_iter(%view_2841) : !memref_gmem_bf16_10
          %iter_2848 = cute.get_iter(%view_2845) : !memref_rmem_i8_3
          %1607 = builtin.unrealized_conversion_cast %iter_2848 : !cute.ptr<i8, rmem> to !llvm.ptr
          %1608 = llvm.load %1607 : !llvm.ptr -> i8
          %1609 = llvm.mlir.constant(0 : i8) : i8
          %1610 = llvm.icmp "ne" %1608, %1609 : i8
          scf.if %1610 {
            %1611 = builtin.unrealized_conversion_cast %iter_2846 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %1612 = builtin.unrealized_conversion_cast %iter_2847 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %1613 = llvm.load %1611 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %1613, %1612 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__HSTUAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Ten(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: !memref_gmem_bf16_, %arg5: !gpu.async.token) attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_7 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_8 = cute.get_iter(%arg4) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?">
    %itup_10 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_10) : !cute.int_tuple<"?">
    %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %itup_17 = cute.to_int_tuple(%e1_13) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=8}">
    %itup_18 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_18) : !cute.int_tuple<"?{i64 div=8}">
    %lay_19 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_20, %e1_21, %e2_22, %e3_23 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_24 = cute.to_int_tuple(%e0_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e1_21) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?">
    %itup_26 = cute.to_int_tuple(%e2_22) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_26) : !cute.int_tuple<"?">
    %itup_27 = cute.to_int_tuple(%e3_23) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_27) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_19) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_28, %e1_29, %e2_30, %e3_31 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_32 = cute.to_int_tuple(%e0_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %itup_33 = cute.to_int_tuple(%e1_29) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_33) : !cute.int_tuple<"?{i64 div=8}">
    %itup_34 = cute.to_int_tuple(%e2_30) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_34) : !cute.int_tuple<"?{i64 div=8}">
    %lay_35 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_36, %e1_37, %e2_38, %e3_39 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_40 = cute.to_int_tuple(%e0_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e1_37) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?">
    %itup_42 = cute.to_int_tuple(%e2_38) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?">
    %itup_43 = cute.to_int_tuple(%e3_39) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_35) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_44, %e1_45, %e2_46, %e3_47 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_48 = cute.to_int_tuple(%e0_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %itup_49 = cute.to_int_tuple(%e1_45) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?{i64 div=8}">
    %itup_50 = cute.to_int_tuple(%e2_46) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?{i64 div=8}">
    %lay_51 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_52, %e1_53, %e2_54, %e3_55 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_56 = cute.to_int_tuple(%e0_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e1_53) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?">
    %itup_58 = cute.to_int_tuple(%e2_54) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_58) : !cute.int_tuple<"?">
    %itup_59 = cute.to_int_tuple(%e3_55) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_59) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_51) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_60, %e1_61, %e2_62, %e3_63 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_64 = cute.to_int_tuple(%e0_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %itup_65 = cute.to_int_tuple(%e1_61) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_65) : !cute.int_tuple<"?{i64 div=8}">
    %itup_66 = cute.to_int_tuple(%e2_62) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_66) : !cute.int_tuple<"?{i64 div=8}">
    %lay_67 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %36 = cute.get_shape(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_68, %e1_69, %e2_70, %e3_71 = cute.get_leaves(%36) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_72 = cute.to_int_tuple(%e0_68) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %37 = cute.get_scalars(%itup_72) : !cute.int_tuple<"?">
    %itup_73 = cute.to_int_tuple(%e1_69) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %38 = cute.get_scalars(%itup_73) : !cute.int_tuple<"?">
    %itup_74 = cute.to_int_tuple(%e2_70) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %39 = cute.get_scalars(%itup_74) : !cute.int_tuple<"?">
    %itup_75 = cute.to_int_tuple(%e3_71) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %40 = cute.get_scalars(%itup_75) : !cute.int_tuple<"?{div=8}">
    %41 = cute.get_stride(%lay_67) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_76, %e1_77, %e2_78, %e3_79 = cute.get_leaves(%41) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_80 = cute.to_int_tuple(%e0_76) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %42 = cute.get_scalars(%itup_80) : !cute.int_tuple<"?{i64 div=8}">
    %itup_81 = cute.to_int_tuple(%e1_77) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %43 = cute.get_scalars(%itup_81) : !cute.int_tuple<"?{i64 div=8}">
    %itup_82 = cute.to_int_tuple(%e2_78) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %44 = cute.get_scalars(%itup_82) : !cute.int_tuple<"?{i64 div=8}">
    %45 = cute.static : !cute.swizzle<"S<3,4,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %46 = cute.get_stride(%lay_83) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_84, %e1_85 = cute.get_leaves(%46) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_86 = cute.make_composed_layout(%45, %int_tuple, %lay_83) : !cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">
    %shape_87 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_88 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %47 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_89 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_90 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %48 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %shape_91 = cute.make_shape() : () -> !cute.shape<"(64,64)">
    %int_tuple_92 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %49 = cute.static : !cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">
    %cosz = cute.cosize(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_93 = cute.get_leaves(%cosz) : !cute.int_tuple<"8192">
    %cosz_94 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_95 = cute.get_leaves(%cosz_94) : !cute.int_tuple<"8192">
    %cosz_96 = cute.cosize(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_97 = cute.get_leaves(%cosz_96) : !cute.int_tuple<"8192">
    %cosz_98 = cute.cosize(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"4096">
    %e0_99 = cute.get_leaves(%cosz_98) : !cute.int_tuple<"4096">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = always, 128 b>
    %atom_100 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %50 = cute.composed_get_outer(%lay_86) : (!cute.composed_layout<"S<3,4,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %51 = cute.get_shape(%50) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_101, %e1_102 = cute.get_leaves(%51) : !cute.shape<"(8,64)">
    %shape_103 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_104 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_105 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_106 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_107 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %lay_108 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_109 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_110 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_111 = cute.get_leaves(%sz_110) : !cute.int_tuple<"8">
    %shape_112 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_113 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%lay_108) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_114 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %52 = cute.get_shape(%lay_108) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_115, %e1_116, %e2_117 = cute.get_leaves(%52) : !cute.shape<"(16,(8,8))">
    %int_tuple_118 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_119 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_120, %e1_121 = cute.get_leaves(%int_tuple_119) : !cute.int_tuple<"(16,64)">
    %int_tuple_122 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_123 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_124, %e1_125 = cute.get_leaves(%int_tuple_123) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %53 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %lay_126 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_127 = cute.size(%lay_105) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_128 = cute.get_leaves(%sz_127) : !cute.int_tuple<"128">
    %sz_129 = cute.size(%lay_107) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_130 = cute.get_leaves(%sz_129) : !cute.int_tuple<"8">
    %shape_131 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_132 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_133 = cute.right_inverse(%lay_126) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_134 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %54 = cute.get_shape(%lay_126) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_135, %e1_136, %e2_137 = cute.get_leaves(%54) : !cute.shape<"(16,(8,8))">
    %int_tuple_138 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_139 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_140, %e1_141 = cute.get_leaves(%int_tuple_139) : !cute.int_tuple<"(16,64)">
    %int_tuple_142 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_143 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_144, %e1_145 = cute.get_leaves(%int_tuple_143) : !cute.int_tuple<"(16,64)">
    %tile_146 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %55 = cute.make_tiled_copy(%atom_100) : !copy_simt
    %shape_147 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_148 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_149 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_150 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %56 = cute.get_shape(%lay_150) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_151, %e1_152, %e2_153 = cute.get_leaves(%56) : !cute.shape<"(4,1,1)">
    %tile_154 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %57 = cute.make_tiled_mma(%atom_148) : !mma_bf16_bf16_f32_16x8x16_
    %lay_155 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %58 = cute.get_shape(%lay_155) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_156, %e1_157, %e2_158, %e3_159 = cute.get_leaves(%58) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_160 = cute.to_int_tuple(%e0_156) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %59 = cute.get_scalars(%itup_160) : !cute.int_tuple<"?">
    %itup_161 = cute.to_int_tuple(%e1_157) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_161) : !cute.int_tuple<"?">
    %itup_162 = cute.to_int_tuple(%e2_158) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_162) : !cute.int_tuple<"?">
    %itup_163 = cute.to_int_tuple(%e3_159) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %62 = cute.get_scalars(%itup_163) : !cute.int_tuple<"?{div=8}">
    %int_tuple_164 = cute.make_int_tuple(%itup_161) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_165 = cute.make_tile() : () -> !cute.tile<"64:1">
    %63 = cute.get_scalars(%int_tuple_164) <{only_dynamic}> : !cute.int_tuple<"?">
    %c64_i32 = arith.constant 64 : i32
    %64 = arith.ceildivsi %63, %c64_i32 : i32
    %int_tuple_166 = cute.make_int_tuple(%64) : (i32) -> !cute.int_tuple<"?">
    %e0_167 = cute.get_leaves(%int_tuple_166) : !cute.int_tuple<"?">
    %65 = cute.get_scalars(%e0_167) : !cute.int_tuple<"?">
    %lay_168 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %66 = cute.get_shape(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_169, %e1_170, %e2_171, %e3_172 = cute.get_leaves(%66) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_173 = cute.to_int_tuple(%e0_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %67 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e1_170) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %68 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?">
    %itup_175 = cute.to_int_tuple(%e2_171) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_175) : !cute.int_tuple<"?">
    %itup_176 = cute.to_int_tuple(%e3_172) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %70 = cute.get_scalars(%itup_176) : !cute.int_tuple<"?{div=8}">
    %71 = cute.get_stride(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_177, %e1_178, %e2_179, %e3_180 = cute.get_leaves(%71) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_181 = cute.to_int_tuple(%e0_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %72 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %itup_182 = cute.to_int_tuple(%e1_178) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %73 = cute.get_scalars(%itup_182) : !cute.int_tuple<"?{i64 div=8}">
    %itup_183 = cute.to_int_tuple(%e2_179) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_183) : !cute.int_tuple<"?{i64 div=8}">
    %lay_184 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %75 = cute.get_shape(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_185, %e1_186, %e2_187, %e3_188 = cute.get_leaves(%75) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_189 = cute.to_int_tuple(%e0_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %76 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e1_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %77 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
    %itup_191 = cute.to_int_tuple(%e2_187) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?">
    %itup_192 = cute.to_int_tuple(%e3_188) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %79 = cute.get_scalars(%itup_192) : !cute.int_tuple<"?{div=8}">
    %80 = cute.get_stride(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_193, %e1_194, %e2_195, %e3_196 = cute.get_leaves(%80) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_197 = cute.to_int_tuple(%e0_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %81 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %itup_198 = cute.to_int_tuple(%e1_194) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %82 = cute.get_scalars(%itup_198) : !cute.int_tuple<"?{i64 div=8}">
    %itup_199 = cute.to_int_tuple(%e2_195) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_199) : !cute.int_tuple<"?{i64 div=8}">
    %lay_200 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %84 = cute.get_shape(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_201, %e1_202, %e2_203, %e3_204 = cute.get_leaves(%84) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_205 = cute.to_int_tuple(%e0_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %85 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e1_202) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %86 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?">
    %itup_207 = cute.to_int_tuple(%e2_203) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_207) : !cute.int_tuple<"?">
    %itup_208 = cute.to_int_tuple(%e3_204) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %88 = cute.get_scalars(%itup_208) : !cute.int_tuple<"?{div=8}">
    %89 = cute.get_stride(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_209, %e1_210, %e2_211, %e3_212 = cute.get_leaves(%89) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_213 = cute.to_int_tuple(%e0_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %90 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %itup_214 = cute.to_int_tuple(%e1_210) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %91 = cute.get_scalars(%itup_214) : !cute.int_tuple<"?{i64 div=8}">
    %itup_215 = cute.to_int_tuple(%e2_211) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?{i64 div=8}">
    %lay_216 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %93 = cute.get_shape(%lay_216) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_217, %e1_218, %e2_219, %e3_220 = cute.get_leaves(%93) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_221 = cute.to_int_tuple(%e0_217) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %94 = cute.get_scalars(%itup_221) : !cute.int_tuple<"?">
    %itup_222 = cute.to_int_tuple(%e1_218) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %95 = cute.get_scalars(%itup_222) : !cute.int_tuple<"?">
    %itup_223 = cute.to_int_tuple(%e2_219) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %96 = cute.get_scalars(%itup_223) : !cute.int_tuple<"?">
    %itup_224 = cute.to_int_tuple(%e3_220) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %97 = cute.get_scalars(%itup_224) : !cute.int_tuple<"?{div=8}">
    %98 = cute.get_stride(%lay_216) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_225, %e1_226, %e2_227, %e3_228 = cute.get_leaves(%98) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_229 = cute.to_int_tuple(%e0_225) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %99 = cute.get_scalars(%itup_229) : !cute.int_tuple<"?{i64 div=8}">
    %itup_230 = cute.to_int_tuple(%e1_226) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %100 = cute.get_scalars(%itup_230) : !cute.int_tuple<"?{i64 div=8}">
    %itup_231 = cute.to_int_tuple(%e2_227) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %101 = cute.get_scalars(%itup_231) : !cute.int_tuple<"?{i64 div=8}">
    %lay_232 = cute.get_layout(%arg4) : !memref_gmem_bf16_
    %102 = cute.get_shape(%lay_232) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_233, %e1_234, %e2_235, %e3_236 = cute.get_leaves(%102) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_237 = cute.to_int_tuple(%e0_233) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %103 = cute.get_scalars(%itup_237) : !cute.int_tuple<"?">
    %itup_238 = cute.to_int_tuple(%e1_234) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %104 = cute.get_scalars(%itup_238) : !cute.int_tuple<"?">
    %itup_239 = cute.to_int_tuple(%e2_235) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %105 = cute.get_scalars(%itup_239) : !cute.int_tuple<"?">
    %itup_240 = cute.to_int_tuple(%e3_236) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %106 = cute.get_scalars(%itup_240) : !cute.int_tuple<"?{div=8}">
    %107 = cute.get_stride(%lay_232) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_241, %e1_242, %e2_243, %e3_244 = cute.get_leaves(%107) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_245 = cute.to_int_tuple(%e0_241) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %108 = cute.get_scalars(%itup_245) : !cute.int_tuple<"?{i64 div=8}">
    %itup_246 = cute.to_int_tuple(%e1_242) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %109 = cute.get_scalars(%itup_246) : !cute.int_tuple<"?{i64 div=8}">
    %itup_247 = cute.to_int_tuple(%e2_243) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %110 = cute.get_scalars(%itup_247) : !cute.int_tuple<"?{i64 div=8}">
    %111 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %112 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_248 = cute.get_leaves(%112) : !cute.int_tuple<"0">
    %113 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %114 = cute.get_shape(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_249, %e1_250, %e2_251, %e3_252 = cute.get_leaves(%114) : !cute.shape<"((8,8),(64,2))">
    %115 = cute.get_stride(%113) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_253, %e1_254, %e2_255, %e3_256 = cute.get_leaves(%115) : !cute.stride<"((64,512),(1,4096))">
    %116 = cute.composed_get_inner(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %117 = cute.composed_get_offset(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_257 = cute.get_leaves(%117) : !cute.int_tuple<"0">
    %118 = cute.composed_get_outer(%48) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %119 = cute.get_shape(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_258, %e1_259, %e2_260, %e3_261 = cute.get_leaves(%119) : !cute.shape<"((8,8),(64,2))">
    %120 = cute.get_stride(%118) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_262, %e1_263, %e2_264, %e3_265 = cute.get_leaves(%120) : !cute.stride<"((64,512),(1,4096))">
    %121 = cute.composed_get_inner(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.swizzle<"S<3,4,3>">
    %122 = cute.composed_get_offset(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.int_tuple<"0">
    %e0_266 = cute.get_leaves(%122) : !cute.int_tuple<"0">
    %123 = cute.composed_get_outer(%49) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,1)):((64,512),(1,0))">) -> !cute.layout<"((8,8),(64,1)):((64,512),(1,0))">
    %124 = cute.get_shape(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.shape<"((8,8),(64,1))">
    %e0_267, %e1_268, %e2_269, %e3_270 = cute.get_leaves(%124) : !cute.shape<"((8,8),(64,1))">
    %125 = cute.get_stride(%123) : (!cute.layout<"((8,8),(64,1)):((64,512),(1,0))">) -> !cute.stride<"((64,512),(1,0))">
    %e0_271, %e1_272, %e2_273, %e3_274 = cute.get_leaves(%125) : !cute.stride<"((64,512),(1,0))">
    %126 = cute.composed_get_inner(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,4,3>">
    %127 = cute.composed_get_offset(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_275 = cute.get_leaves(%127) : !cute.int_tuple<"0">
    %128 = cute.composed_get_outer(%47) : (!cute.composed_layout<"S<3,4,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %129 = cute.get_shape(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_276, %e1_277, %e2_278, %e3_279 = cute.get_leaves(%129) : !cute.shape<"((8,8),(64,2))">
    %130 = cute.get_stride(%128) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_280, %e1_281, %e2_282, %e3_283 = cute.get_leaves(%130) : !cute.stride<"((64,512),(1,4096))">
    %131 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_284, %e1_285 = cute.get_leaves(%131) : !cute.tile<"[16:1;64:1]">
    %132 = cute.get_shape(%e0_284) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_286 = cute.get_leaves(%132) : !cute.shape<"16">
    %133 = cute.get_stride(%e0_284) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_287 = cute.get_leaves(%133) : !cute.stride<"1">
    %134 = cute.get_shape(%e1_285) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_288 = cute.get_leaves(%134) : !cute.shape<"64">
    %135 = cute.get_stride(%e1_285) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_289 = cute.get_leaves(%135) : !cute.stride<"1">
    %136 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %137 = cute.get_shape(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_290, %e1_291, %e2_292 = cute.get_leaves(%137) : !cute.shape<"((8,16),8)">
    %138 = cute.get_stride(%136) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_293, %e1_294, %e2_295 = cute.get_leaves(%138) : !cute.stride<"((128,1),16)">
    %139 = cute.static : !cute.layout<"1:0">
    %140 = cute.get_shape(%139) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_296 = cute.get_leaves(%140) : !cute.shape<"1">
    %141 = cute.get_stride(%139) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_297 = cute.get_leaves(%141) : !cute.stride<"0">
    %142 = cute.static : !cute.layout<"(1,8):(0,1)">
    %143 = cute.get_shape(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_298, %e1_299 = cute.get_leaves(%143) : !cute.shape<"(1,8)">
    %144 = cute.get_stride(%142) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_300, %e1_301 = cute.get_leaves(%144) : !cute.stride<"(0,1)">
    %145 = cute.static : !cute.layout<"(1,8):(0,1)">
    %146 = cute.get_shape(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_302, %e1_303 = cute.get_leaves(%146) : !cute.shape<"(1,8)">
    %147 = cute.get_stride(%145) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_304, %e1_305 = cute.get_leaves(%147) : !cute.stride<"(0,1)">
    %148 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_306, %e1_307 = cute.get_leaves(%148) : !cute.tile<"[16:1;64:1]">
    %149 = cute.get_shape(%e0_306) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_308 = cute.get_leaves(%149) : !cute.shape<"16">
    %150 = cute.get_stride(%e0_306) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_309 = cute.get_leaves(%150) : !cute.stride<"1">
    %151 = cute.get_shape(%e1_307) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_310 = cute.get_leaves(%151) : !cute.shape<"64">
    %152 = cute.get_stride(%e1_307) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_311 = cute.get_leaves(%152) : !cute.stride<"1">
    %153 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %154 = cute.get_shape(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_312, %e1_313, %e2_314 = cute.get_leaves(%154) : !cute.shape<"((8,16),8)">
    %155 = cute.get_stride(%153) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_315, %e1_316, %e2_317 = cute.get_leaves(%155) : !cute.stride<"((128,1),16)">
    %156 = cute.static : !cute.layout<"1:0">
    %157 = cute.get_shape(%156) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_318 = cute.get_leaves(%157) : !cute.shape<"1">
    %158 = cute.get_stride(%156) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_319 = cute.get_leaves(%158) : !cute.stride<"0">
    %159 = cute.static : !cute.layout<"(1,8):(0,1)">
    %160 = cute.get_shape(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_320, %e1_321 = cute.get_leaves(%160) : !cute.shape<"(1,8)">
    %161 = cute.get_stride(%159) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_322, %e1_323 = cute.get_leaves(%161) : !cute.stride<"(0,1)">
    %162 = cute.static : !cute.layout<"(1,8):(0,1)">
    %163 = cute.get_shape(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_324, %e1_325 = cute.get_leaves(%163) : !cute.shape<"(1,8)">
    %164 = cute.get_stride(%162) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_326, %e1_327 = cute.get_leaves(%164) : !cute.stride<"(0,1)">
    %165 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %166 = cute.get_shape(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_328, %e1_329, %e2_330, %e3_331 = cute.get_leaves(%166) : !cute.shape<"(32,4,1,1)">
    %167 = cute.get_stride(%165) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_332, %e1_333, %e2_334, %e3_335 = cute.get_leaves(%167) : !cute.stride<"(1,32,0,0)">
    %168 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_336, %e1_337, %e2_338 = cute.get_leaves(%168) : !cute.tile<"[64:1;16:1;16:1]">
    %169 = cute.get_shape(%e0_336) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_339 = cute.get_leaves(%169) : !cute.shape<"64">
    %170 = cute.get_stride(%e0_336) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_340 = cute.get_leaves(%170) : !cute.stride<"1">
    %171 = cute.get_shape(%e1_337) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_341 = cute.get_leaves(%171) : !cute.shape<"16">
    %172 = cute.get_stride(%e1_337) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_342 = cute.get_leaves(%172) : !cute.stride<"1">
    %173 = cute.get_shape(%e2_338) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_343 = cute.get_leaves(%173) : !cute.shape<"16">
    %174 = cute.get_stride(%e2_338) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_344 = cute.get_leaves(%174) : !cute.stride<"1">
    %175 = cute.static : !cute.layout<"32:1">
    %176 = cute.get_shape(%175) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_345 = cute.get_leaves(%176) : !cute.shape<"32">
    %177 = cute.get_stride(%175) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_346 = cute.get_leaves(%177) : !cute.stride<"1">
    %178 = cute.static : !cute.shape<"(16,8,16)">
    %e0_347, %e1_348, %e2_349 = cute.get_leaves(%178) : !cute.shape<"(16,8,16)">
    %179 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %180 = cute.get_shape(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_350, %e1_351, %e2_352, %e3_353, %e4 = cute.get_leaves(%180) : !cute.shape<"((4,8),(2,2,2))">
    %181 = cute.get_stride(%179) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_354, %e1_355, %e2_356, %e3_357, %e4_358 = cute.get_leaves(%181) : !cute.stride<"((32,1),(16,8,128))">
    %182 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %183 = cute.get_shape(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_359, %e1_360, %e2_361, %e3_362 = cute.get_leaves(%183) : !cute.shape<"((4,8),(2,2))">
    %184 = cute.get_stride(%182) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_363, %e1_364, %e2_365, %e3_366 = cute.get_leaves(%184) : !cute.stride<"((16,1),(8,64))">
    %185 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %186 = cute.get_shape(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_367, %e1_368, %e2_369, %e3_370 = cute.get_leaves(%186) : !cute.shape<"((4,8),(2,2))">
    %187 = cute.get_stride(%185) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_371, %e1_372, %e2_373, %e3_374 = cute.get_leaves(%187) : !cute.stride<"((32,1),(16,8))">
    %c4 = arith.constant 4 : index
    %188 = arith.index_cast %65 : i32 to index
    %c128 = arith.constant 128 : index
    %c1 = arith.constant 1 : index
    %c57344_i32 = arith.constant 57344 : i32
    %189 = gpu.launch_func async [%arg5] @kernels::@kernel_cutlass_kernel___main__HSTUAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8_0 blocks in (%c4, %c4, %188) threads in (%c128, %c1, %c1)  dynamic_shared_memory_size %c57344_i32 args(%arg0 : !memref_gmem_bf16_, %arg1 : !memref_gmem_bf16_, %arg2 : !memref_gmem_bf16_, %arg3 : !memref_gmem_bf16_, %arg4 : !memref_gmem_bf16_) {use_pdl = false}
    return
  }
}
